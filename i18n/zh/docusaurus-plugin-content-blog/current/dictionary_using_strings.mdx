---
title: 如何创建使用字符串键和值的 ClickHouse 字典
description: 了解如何使用 MergeTree 表中以字符串作为键和值的数据源创建 ClickHouse 字典，并通过示例说明其配置与使用方法。
date: 2023-07-10
tags: ['数据建模']
keywords: ['字典', '字符串键', '字符串值']
---

{frontMatter.description}

{/* 截断 */}

## 问题 \{#question\}

如何使用 MergeTree 表作为数据源创建使用字符串键和值的 ClickHouse 字典

## 解答 \{#answer\}

* 创建字典的源表

```
CREATE TABLE db1.table1_dict_source
(
  id UInt32,
  email String,
  name String
)
ENGINE = MergeTree()
ORDER BY id;
```

* 插入行

```
INSERT INTO db1.table1_dict_source
(id, email, name)
VALUES
(1, 'me@domain.com', 'me'),
(2, 'you@domain.com', 'you');
```

* 创建一个键和值均为 String 类型的字典

```
CREATE DICTIONARY db1.table1_dict
(
    email String,
    name String
)
PRIMARY KEY email
SOURCE(
CLICKHOUSE(
TABLE 'table1_dict_source'
USER 'default'
PASSWORD 'ClickHouse123!'))
LAYOUT(COMPLEX_KEY_HASHED())
LIFETIME(MIN 0 MAX 1000);
```

* 测试字典

```
clickhouse-cloud :) SELECT * from db1.table1_dict;

SELECT *
FROM db1.table1_dict

Query id: 098396ce-11dd-4c71-a0e1-40723dd67ddc

┌─email──────────┬─name─┐
│ me@domain.com  │ me   │
│ you@domain.com │ you  │
└────────────────┴──────┘

结果集包含 2 行。用时：0.001 秒。 
```

你还可以使用 dictGet 函数从中获取值，例如：

```
SELECT dictGet('db1.table1_dict', 'name', 'me@domain.com');
```

响应：

```
┌─dictGet('db1.table1_dict', 'name', 'me@domain.com')─┐
│ me                                                  │
└─────────────────────────────────────────────────────┘
```

更多详细信息 - [https://clickhouse.com/docs/sql-reference/functions/ext-dict-functions](https://clickhouse.com/docs/sql-reference/functions/ext-dict-functions)
