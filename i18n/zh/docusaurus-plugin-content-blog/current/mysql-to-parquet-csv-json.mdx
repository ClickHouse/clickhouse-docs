---
title: 如何使用 ClickHouse 将 MySQL 数据导出为 Parquet、CSV 或 JSON 格式
description: "了解如何使用 `clickhouse-local` 工具，将 MySQL 数据快速、高效地导出为 Parquet、CSV 或 JSON 等格式。"
date: 2023-03-21
tags: ['数据格式', '数据导出']
keywords: ['MySQL', 'Parquet', 'CSV', 'JSON']
---

{frontMatter.description}

{/* 截断 */}


## 使用 ClickHouse 将 MySQL 数据导出为 Parquet、CSV 或 JSON

`clickhouse-local` 工具可以快速、方便地从 MySQL 读取数据，并将数据输出为多种不同的格式，包括 Parquet、CSV 和 JSON。我们将会：

* 使用 [`mysql` 表函数](https://clickhouse.com/docs/sql-reference/table-functions/mysql) 来读取数据
* 使用 `INTO OUTFILE _filename_ FORMAT` 子句并指定所需的输出格式

`clickhouse-local` 工具是 ClickHouse 二进制文件的一部分。使用以下命令下载它：

```bash
curl https://clickhouse.com/ | sh
```


## 将 MySQL 数据导出为 Parquet

`mysql` 表函数会基于发送到 MySQL 实例的查询结果创建一张表。例如：

```bash
SELECT *
FROM
   mysql(
    'localhost:3306',
    'my_sql_database',
    'my_sql_table',
    'user',
    'password'
);
```

我们可以使用 `INTO OUTFILE` 将此查询的输出写入文件。使用 `FORMAT` 来指定要生成的文件格式。下面我们将导出一个 MySQL 表的全部数据，并将其保存为一个 Parquet 文件：

```bash
./clickhouse local -q "SELECT * FROM
   mysql(
    'localhost:3306',
    'my_sql_database',
    'my_sql_table',
    'user',
    'password'
)
INTO OUTFILE 'my_output_file.parquet'"
```

:::note
由于输出文件名使用了 `.parquet` 扩展名，ClickHouse 会认为我们要使用 Parquet 格式，因此这里省略了 `FORMAT Parquet` 子句。
:::


## 将 MySQL 导出为 CSV

这与导出为 Parquet 的方式相同，只是这次我们在文件名中使用 `.csv` 扩展名。ClickHouse 会识别出我们需要逗号分隔的输出，并以该格式将数据写入文件：

```bash
./clickhouse local -q "SELECT * FROM
   mysql(
    'localhost:3306',
    'my_sql_database',
    'my_sql_table',
    'user',
    'password'
)
INTO OUTFILE 'my_output_file.csv'"
```


## 将 MySQL 导出为 JSON

要从 MySQL 导出为 JSON 格式，只需将文件扩展名改为 `jsonl` 或 `ndjson` 即可：

```bash
./clickhouse local -q "SELECT * FROM
   mysql(
    'localhost:3306',
    'my_sql_database',
    'my_sql_table',
    'user',
    'password'
)
INTO OUTFILE 'my_output_file.ndjson'"
```

`clickhouse-local` 工具既简单又强大，实在令人印象深刻。你可以轻松地从 MySQL 等数据库读取数据，并将其导出为[各种不同的输出格式](https://clickhouse.com/docs/sql-reference/formats/)。
