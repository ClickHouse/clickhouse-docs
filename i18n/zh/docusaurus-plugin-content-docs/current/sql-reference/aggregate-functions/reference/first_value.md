---
description: '它是 `any` 的别名，为了与窗口函数兼容而引入。在窗口函数中，有时需要处理 `NULL` 值（默认情况下，所有 ClickHouse 聚合函数都会忽略 `NULL` 值）。'
slug: /sql-reference/aggregate-functions/reference/first_value
title: 'first_value'
doc_type: 'reference'
---

# first_value {#first_value}

它是 [`any`](../../../sql-reference/aggregate-functions/reference/any.md) 的别名，但之所以引入它，是为了兼容 [窗口函数](../../window-functions/index.md)，在这些场景下有时需要处理 `NULL` 值（默认情况下，所有 ClickHouse 聚合函数都会忽略 NULL 值）。

它支持声明一个用于保留 `NULL` 值的修饰符（`RESPECT NULLS`），既可以在 [窗口函数](../../window-functions/index.md) 中使用，也可以在普通聚合中使用。

与 `any` 一样，如果不在窗口函数中使用且源数据流未排序，则结果是随机的，并且返回类型与输入类型一致（只有当输入是 Nullable 或者添加了 -OrNull 组合器时，才会返回 Null）。

## 示例 {#examples}

```sql
CREATE TABLE test_data
(
    a Int64,
    b Nullable(Int64)
)
ENGINE = Memory;

INSERT INTO test_data (a, b) VALUES (1,null), (2,3), (4, 5), (6,null);
```

### 示例 1 {#example1}

默认情况下，NULL 值会被忽略。

```sql
SELECT first_value(b) FROM test_data;
```

```text
┌─any(b)─┐
│      3 │
└────────┘
```

### 示例 2 {#example2}

NULL 值会被忽略。

```sql
SELECT first_value(b) ignore nulls FROM test_data
```

```text
┌─any(b) IGNORE NULLS ─┐
│                    3 │
└──────────────────────┘
```

### 示例 3 {#example3}

允许 NULL 值。

```sql
SELECT first_value(b) respect nulls FROM test_data
```

```text
┌─any(b) RESPECT NULLS ─┐
│                  ᴺᵁᴸᴸ │
└───────────────────────┘
```

### 示例 4 {#example4}

通过在子查询中使用 `ORDER BY` 获得稳定的结果。

```sql
SELECT
    first_value_respect_nulls(b),
    first_value(b)
FROM
(
    SELECT *
    FROM test_data
    ORDER BY a ASC
)
```

```text
┌─any_respect_nulls(b)─┬─any(b)─┐
│                 ᴺᵁᴸᴸ │      3 │
└──────────────────────┴────────┘
```

{/*AUTOGENERATED_START*/ }

{/*AUTOGENERATED_END*/ }
