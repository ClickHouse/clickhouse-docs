---
'description': '聚合函数的登录页面，包含聚合函数的完整列表'
'sidebar_position': 36
'slug': '/sql-reference/aggregate-functions/reference/'
'title': '聚合函数'
'toc_folder_title': 'Reference'
'toc_hidden': true
'doc_type': 'landing-page'
---


# 聚合函数

ClickHouse 支持所有标准 SQL 聚合函数 ([sum](../reference/sum.md), [avg](../reference/avg.md), [min](../reference/min.md), [max](../reference/max.md), [count](../reference/count.md))，以及广泛的其他聚合函数。

<!-- The table of contents table for this page is automatically generated by 
https://github.com/ClickHouse/clickhouse-docs/blob/main/scripts/autogenerate-table-of-contents.sh
from the YAML front matter fields: slug, description, title.

If you've spotted an error, please edit the YML frontmatter of the pages themselves.
-->

<!--AUTOGENERATED_START-->
| 页面 | 描述 |
|-----|-----|
| [aggThrow](/sql-reference/aggregate-functions/reference/aggthrow) | 此函数可用于测试异常安全性。它将在创建时抛出异常，概率由指定。 |
| [analysisOfVariance](/sql-reference/aggregate-functions/reference/analysis_of_variance) | 提供单因素方差分析的统计测试（ANOVA 测试）。它是对几组正态分布观察值进行测试，以确定所有组的均值是否相同。 |
| [any](/sql-reference/aggregate-functions/reference/any) | 选择列中首次出现的值。 |
| [anyHeavy](/sql-reference/aggregate-functions/reference/anyheavy) | 使用重击算法选择经常出现的值。如果在每个查询执行线程中有一个值出现的次数超过一半，则返回该值。通常，结果是非确定性的。 |
| [anyLast](/sql-reference/aggregate-functions/reference/anylast) | 选择列中最后出现的值。 |
| [approx_top_k](/sql-reference/aggregate-functions/reference/approxtopk) | 返回指定列中大约最频繁值及其计数的数组。 |
| [approx_top_sum](/sql-reference/aggregate-functions/reference/approxtopsum) | 返回指定列中大约最频繁值及其计数的数组。 |
| [argMax](/sql-reference/aggregate-functions/reference/argmax) | 计算最大 `val` 值的 `arg` 值。 |
| [argMin](/sql-reference/aggregate-functions/reference/argmin) | 计算最小 `val` 值的 `arg` 值。如果有多行具有相同的最大 `val`，则返回的相关 `arg` 不具有确定性。 |
| [groupArrayArray](/sql-reference/aggregate-functions/reference/grouparrayarray) | 将数组聚合为一个更大的数组。 |
| [avg](/sql-reference/aggregate-functions/reference/avg) | 计算算术平均值。 |
| [avgWeighted](/sql-reference/aggregate-functions/reference/avgweighted) | 计算加权算术平均值。 |
| [boundingRatio](/sql-reference/aggregate-functions/reference/boundingRatio) | 计算值组的最左和最右点之间的斜率的聚合函数。 |
| [categoricalInformationValue](/sql-reference/aggregate-functions/reference/categoricalinformationvalue) | 为每个类别计算 `(P(tag = 1) - P(tag = 0))(log(P(tag = 1)) - log(P(tag = 0)))` 的值。 |
| [contingency](/sql-reference/aggregate-functions/reference/contingency) | `contingency` 函数计算应变系数，这是一个衡量表中两个列之间关联的值。计算方式类似于 `cramersV` 函数，但是在平方根中有不同的分母。 |
| [corr](/sql-reference/aggregate-functions/reference/corr) | 计算 Pearson 相关系数。 |
| [corrMatrix](/sql-reference/aggregate-functions/reference/corrmatrix) | 计算 N 个变量的相关矩阵。 |
| [corrStable](/sql-reference/aggregate-functions/reference/corrstable) | 计算 Pearson 相关系数，但使用数值稳定的算法。 |
| [count](/sql-reference/aggregate-functions/reference/count) | 计算行数或非 NULL 值的数量。 |
| [covarPop](/sql-reference/aggregate-functions/reference/covarpop) | 计算种群协方差。 |
| [covarPopMatrix](/sql-reference/aggregate-functions/reference/covarpopmatrix) | 返回 N 个变量的种群协方差矩阵。 |
| [covarPopStable](/sql-reference/aggregate-functions/reference/covarpopstable) | 计算种群协方差的值。 |
| [covarSamp](/sql-reference/aggregate-functions/reference/covarsamp) | 计算 `Σ((x - x̅)(y - y̅)) / (n - 1)` 的值。 |
| [covarSampMatrix](/sql-reference/aggregate-functions/reference/covarsampmatrix) | 返回 N 个变量的样本协方差矩阵。 |
| [covarSampStable](/sql-reference/aggregate-functions/reference/covarsampstable) | 类似于 covarSamp，但运行速度较慢且提供更低的计算误差。 |
| [cramersV](/sql-reference/aggregate-functions/reference/cramersv) | `cramersV` 函数的结果范围从 0（对应于两个变量之间没有关联）到 1，只有当每个值完全由另一个值决定时，才能达到 1。它可以被视为两个变量之间的关联程度，占其最大可能变化的百分比。 |
| [cramersVBiasCorrected](/sql-reference/aggregate-functions/reference/cramersvbiascorrected) | 计算 Cramer's V，但使用偏差校正。 |
| [deltaSum](/sql-reference/aggregate-functions/reference/deltasum) | 求连续行之间的算术差值总和。 |
| [deltaSumTimestamp](/sql-reference/aggregate-functions/reference/deltasumtimestamp) | 添加连续行的差值。如果差值为负，则被忽略。 |
| [entropy](/sql-reference/aggregate-functions/reference/entropy) | 计算列值的 Shannon 熵。 |
| [estimateCompressionRatio](/sql-reference/aggregate-functions/reference/estimateCompressionRatio) | 在不压缩的情况下估计给定列的压缩比。 |
| [exponentialMovingAverage](/sql-reference/aggregate-functions/reference/exponentialMovingAverage) | 计算确定时间段内值的指数移动平均。 |
| [exponentialTimeDecayedAvg](/sql-reference/aggregate-functions/reference/exponentialTimeDecayedAvg) | 返回时间序列在 `t` 时刻的指数平滑加权移动平均。 |
| [exponentialTimeDecayedCount](/sql-reference/aggregate-functions/reference/exponentialTimeDecayedCount) | 返回时间序列在时间索引 `t` 的累积指数衰减。 |
| [exponentialTimeDecayedMax](/sql-reference/aggregate-functions/reference/exponentialTimeDecayedMax) | 返回在时间索引 `t` 的计算指数平滑移动平均的最大值与在 `t-1` 的值比较。 |
| [exponentialTimeDecayedSum](/sql-reference/aggregate-functions/reference/exponentialTimeDecayedSum) | 返回时间序列在时间索引 `t` 的指数平滑移动平均值之和。 |
| [first_value](/sql-reference/aggregate-functions/reference/first_value) | 是任何值的别名，但引入的原因是与窗口函数的兼容性，有时必须处理 `NULL` 值（默认情况下，所有 ClickHouse 聚合函数忽略 NULL 值）。 |
| [flameGraph](/sql-reference/aggregate-functions/reference/flame_graph) | 聚合函数使用堆栈跟踪列表构建火焰图。 |
| [groupArray](/sql-reference/aggregate-functions/reference/grouparray) | 创建参数值的数组。值可以以任何（不确定）顺序添加到数组中。 |
| [groupArrayInsertAt](/sql-reference/aggregate-functions/reference/grouparrayinsertat) | 将值插入到指定位置的数组中。 |
| [groupArrayIntersect](/sql-reference/aggregate-functions/reference/grouparrayintersect) | 返回给定数组的交集（返回所有在所有给定数组中的数组项）。 |
| [groupArrayLast](/sql-reference/aggregate-functions/reference/grouparraylast) | 创建最后参数值的数组。 |
| [groupArrayMovingSum](/sql-reference/aggregate-functions/reference/grouparraymovingsum) | 计算输入值的移动和。 |
| [groupArrayMovingAvg](/sql-reference/aggregate-functions/reference/grouparraymovingavg) | 计算输入值的移动平均。 |
| [groupArraySample](/sql-reference/aggregate-functions/reference/grouparraysample) | 创建样本参数值的数组。结果数组的大小限制为 `max_size` 元素。随机选择参数值并添加到数组中。 |
| [timeSeriesGroupArray](/sql-reference/aggregate-functions/reference/timeSeriesGroupArray) | 将时间序列按时间戳升序排序。 |
| [groupArraySorted](/sql-reference/aggregate-functions/reference/grouparraysorted) | 返回按升序排列的前 N 项数组。 |
| [groupBitAnd](/sql-reference/aggregate-functions/reference/groupbitand) | 对一系列数字应用按位 `AND`。 |
| [groupBitmap](/sql-reference/aggregate-functions/reference/groupbitmap) | 从无符号整数列进行位图或聚合计算，返回类型为 UInt64 的基数，如果加上后缀 -State，则返回位图对象。 |
| [groupBitmapAnd](/sql-reference/aggregate-functions/reference/groupbitmapand) | 计算位图列的 AND，返回类型为 UInt64 的基数，如果加上后缀 -State，则返回位图对象。 |
| [groupBitmapOr](/sql-reference/aggregate-functions/reference/groupbitmapor) | 计算位图列的 OR，返回类型为 UInt64 的基数，如果加上后缀 -State，则返回位图对象。等价于 `groupBitmapMerge`。 |
| [groupBitmapXor](/sql-reference/aggregate-functions/reference/groupbitmapxor) | 计算位图列的 XOR，并返回类型为 UInt64 的基数，如果与后缀 -State 一起使用，则返回位图对象。 |
| [groupBitOr](/sql-reference/aggregate-functions/reference/groupbitor) | 对一系列数字应用按位 `OR`。 |
| [groupBitXor](/sql-reference/aggregate-functions/reference/groupbitxor) | 对一系列数字应用按位 `XOR`。 |
| [groupUniqArray](/sql-reference/aggregate-functions/reference/groupuniqarray) | 从不同的参数值创建数组。 |
| [intervalLengthSum](/sql-reference/aggregate-functions/reference/intervalLengthSum) | 计算所有范围（数字轴上的分段）联合总长度。 |
| [kolmogorovSmirnovTest](/sql-reference/aggregate-functions/reference/kolmogorovsmirnovtest) | 对来自两个总体的样本应用 Kolmogorov-Smirnov 测试。 |
| [kurtPop](/sql-reference/aggregate-functions/reference/kurtpop) | 计算序列的峰度。 |
| [kurtSamp](/sql-reference/aggregate-functions/reference/kurtsamp) | 计算序列的样本峰度。 |
| [largestTriangleThreeBuckets](/sql-reference/aggregate-functions/reference/largestTriangleThreeBuckets) | 将 Largest-Triangle-Three-Buckets 算法应用于输入数据。 |
| [last_value](/sql-reference/aggregate-functions/reference/last_value) | 选择最后出现的值，类似于 `anyLast`，但可以接受 NULL。 |
| [mannWhitneyUTest](/sql-reference/aggregate-functions/reference/mannwhitneyutest) | 对来自两个总体的样本应用 Mann-Whitney 排名测试。 |
| [max](/sql-reference/aggregate-functions/reference/max) | 聚合函数，计算一组值中的最大值。 |
| [maxIntersections](/sql-reference/aggregate-functions/reference/maxintersections) | 聚合函数，计算一组区间相互交叉的最大次数（如果所有区间至少交叉一次）。 |
| [maxIntersectionsPosition](/sql-reference/aggregate-functions/reference/maxintersectionsposition) | 聚合函数，计算 maxIntersections 函数的出现位置。 |
| [maxMap](/sql-reference/aggregate-functions/reference/maxmap) | 根据 `key` 数组中指定的键，计算 `value` 数组中的最大值。 |
| [meanZTest](/sql-reference/aggregate-functions/reference/meanztest) | 对来自两个总体的样本应用均值 Z 测试。 |
| [median](/sql-reference/aggregate-functions/reference/median) | `median*` 函数是相应 `quantile*` 函数的别名。它们计算数值数据样本的中位数。 |
| [min](/sql-reference/aggregate-functions/reference/min) | 聚合函数，计算一组值中的最小值。 |
| [minMap](/sql-reference/aggregate-functions/reference/minmap) | 根据 `key` 数组中指定的键，计算 `value` 数组中的最小值。 |
| [quantile](/sql-reference/aggregate-functions/reference/quantile) | 计算数值数据序列的近似分位数。 |
| [quantileDD](/sql-reference/aggregate-functions/reference/quantileddsketch) | 计算带有相对误差保证的样本近似分位数。 |
| [quantileBFloat16](/sql-reference/aggregate-functions/reference/quantilebfloat16) | 计算由 bfloat16 数字组成的样本的近似分位数。 |
| [quantileDeterministic](/sql-reference/aggregate-functions/reference/quantiledeterministic) | 计算数值数据序列的近似分位数。 |
| [quantileExact Functions](/sql-reference/aggregate-functions/reference/quantileexact) | quantileExact, quantileExactLow, quantileExactHigh, quantileExactExclusive, quantileExactInclusive 函数 |
| [quantileExactWeighted](/sql-reference/aggregate-functions/reference/quantileexactweighted) | 精确计算数值数据序列的分位数，考虑到每个元素的权重。 |
| [quantileGK](/sql-reference/aggregate-functions/reference/quantileGK) | 使用 Greenwald-Khanna 算法计算数值数据序列的分位数。 |
| [quantileExactWeightedInterpolated](/sql-reference/aggregate-functions/reference/quantileExactWeightedInterpolated) | 使用线性插值计算数值数据序列的分位数，考虑到每个元素的权重。 |
| [quantileInterpolatedWeighted](/sql-reference/aggregate-functions/reference/quantileInterpolatedWeighted) | 使用线性插值计算数值数据序列的分位数，考虑到每个元素的权重。 |
| [quantiles Functions](/sql-reference/aggregate-functions/reference/quantiles) | quantiles, quantilesExactExclusive, quantilesExactInclusive, quantilesGK |
| [quantileTDigest](/sql-reference/aggregate-functions/reference/quantiletdigest) | 使用 t-digest 算法计算数值数据序列的近似分位数。 |
| [quantileTDigestWeighted](/sql-reference/aggregate-functions/reference/quantiletdigestweighted) | 使用 t-digest 算法计算数值数据序列的近似分位数。 |
| [quantileTiming](/sql-reference/aggregate-functions/reference/quantiletiming) | 以确定的精度计算数值数据序列的分位数。 |
| [quantileTimingWeighted](/sql-reference/aggregate-functions/reference/quantiletimingweighted) | 以确定的精度计算根据每个序列成员权重的数值数据序列的分位数。 |
| [rankCorr](/sql-reference/aggregate-functions/reference/rankCorr) | 计算排名相关系数。 |
| [simpleLinearRegression](/sql-reference/aggregate-functions/reference/simplelinearregression) | 执行简单（单维）线性回归。 |
| [singleValueOrNull](/sql-reference/aggregate-functions/reference/singlevalueornull) | 聚合函数 `singleValueOrNull` 用于实现子查询操作符，例如 `x = ALL (SELECT ...)`。它检查数据中是否仅存在一个唯一的非 NULL 值。 |
| [skewPop](/sql-reference/aggregate-functions/reference/skewpop) | 计算序列的偏度。 |
| [skewSamp](/sql-reference/aggregate-functions/reference/skewsamp) | 计算序列的样本偏度。 |
| [sparkbar](/sql-reference/aggregate-functions/reference/sparkbar) | 函数为值 `x` 绘制频率直方图，以及这些值在区间 `[min_x, max_x]` 上的重复率 `y`。 |
| [stddevPop](/sql-reference/aggregate-functions/reference/stddevpop) | 结果等于 varPop 的平方根。 |
| [stddevPopStable](/sql-reference/aggregate-functions/reference/stddevpopstable) | 结果等于 varPop 的平方根。与 stddevPop 不同，此函数使用数值稳定的算法。 |
| [stddevSamp](/sql-reference/aggregate-functions/reference/stddevsamp) | 结果等于 varSamp 的平方根。 |
| [stddevSampStable](/sql-reference/aggregate-functions/reference/stddevsampstable) | 结果等于 varSamp 的平方根。与此函数使用数值稳定的算法。运行速度较慢，但提供更低的计算误差。 |
| [stochasticLinearRegression](/sql-reference/aggregate-functions/reference/stochasticlinearregression) | 此函数实现随机线性回归。支持学习率、L2 正则化系数、迷你批量大小的自定义参数，并具有几种更新权重的方法（Adam、简单的 SGD、动量、Nesterov）。 |
| [stochasticLogisticRegression](/sql-reference/aggregate-functions/reference/stochasticlogisticregression) | 此函数实现随机逻辑回归。可用于二元分类问题，支持与 stochasticLinearRegression 相同的自定义参数，并以相同的方式工作。 |
| [studentTTest](/sql-reference/aggregate-functions/reference/studentttest) | 对两个总体的样本应用学生 t 测试。 |
| [sum](/sql-reference/aggregate-functions/reference/sum) | 计算总和。仅对数字有效。 |
| [studentTTestOneSample](/sql-reference/aggregate-functions/reference/studentttestonesample) | 对样本和已知总体均值应用单样本学生 t 测试。 |
| [sumCount](/sql-reference/aggregate-functions/reference/sumcount) | 同时计算数字的总和并计算行数。该函数由 ClickHouse 查询优化器使用：如果查询中有多个 `sum`、`count` 或 `avg` 函数，则可以替换为单个 `sumCount` 函数以重用计算。该函数很少需要显式使用。 |
| [sumKahan](/sql-reference/aggregate-functions/reference/sumkahan) | 使用 Kahan 补偿求和算法计算数字的总和。 |
| [sumMap](/sql-reference/aggregate-functions/reference/summap) | 根据 `key` 数组中指定的键对一个或多个 `value` 数组进行求和。返回一个元组数组：按排序顺序的键，后跟按对应键求和的值，无溢出。 |
| [sumMapWithOverflow](/sql-reference/aggregate-functions/reference/summapwithoverflow) | 根据 `key` 数组中指定的键对 `value` 数组进行求和。返回两个数组的元组：按排序顺序的键，以及按对应键求和的值。与 sumMap 函数不同，它在进行求和时允许溢出。 |
| [sumWithOverflow](/sql-reference/aggregate-functions/reference/sumwithoverflow) | 计算数字的总和，计算结果与输入参数相同的数据类型。如果总和超过该数据类型的最大值，则会出现溢出计算。 |
| [theilsU](/sql-reference/aggregate-functions/reference/theilsu) | `theilsU` 函数计算 Theils' U 不确定系数，这是一个衡量表中两个列之间关联的值。 |
| [topK](/sql-reference/aggregate-functions/reference/topk) | 返回指定列中大约最频繁值的数组。结果数组按值的近似频率降序排列（而不是值本身）。 |
| [topKWeighted](/sql-reference/aggregate-functions/reference/topkweighted) | 返回指定列中大约最频繁值的数组。结果数组按值的近似频率降序排列（而不是值本身）。此外，还考虑值的权重。 |
| [uniq](/sql-reference/aggregate-functions/reference/uniq) | 计算参数的不同值的近似数量。 |
| [uniqCombined](/sql-reference/aggregate-functions/reference/uniqcombined) | 计算不同参数值的近似数量。 |
| [uniqCombined64](/sql-reference/aggregate-functions/reference/uniqcombined64) | 计算不同参数值的近似数量。它与 uniqCombined 相同，但对所有数据类型使用 64 位哈希，而不仅仅是字符串数据类型。 |
| [uniqExact](/sql-reference/aggregate-functions/reference/uniqexact) | 计算不同参数值的确切数量。 |
| [uniqHLL12](/sql-reference/aggregate-functions/reference/uniqhll12) | 使用 HyperLogLog 算法计算不同参数值的近似数量。 |
| [uniqTheta](/sql-reference/aggregate-functions/reference/uniqthetasketch) | 使用 Theta Sketch 框架计算不同参数值的近似数量。 |
| [varPop](/sql-reference/aggregate-functions/reference/varPop) | 计算种群方差。 |
| [varPopStable](/sql-reference/aggregate-functions/reference/varpopstable) | 返回种群方差。与 varPop 不同，此函数使用数值稳定的算法。它运行速度较慢，但提供更低的计算误差。 |
| [varSamp](/sql-reference/aggregate-functions/reference/varSamp) | 计算数据集的样本方差。 |
| [varSampStable](/sql-reference/aggregate-functions/reference/varsampstable) | 计算数据集的样本方差。与 `varSamp` 不同，此函数使用数值稳定的算法。它运行速度较慢，但提供更低的计算误差。 |
| [welchTTest](/sql-reference/aggregate-functions/reference/welchttest) | 对来自两个总体的样本应用 Welch 的 t 测试。 |
| [distinctDynamicTypes](/sql-reference/aggregate-functions/reference/distinctdynamictypes) | 计算存储在动态列中的不同数据类型列表。 |
| [distinctJSONPaths](/sql-reference/aggregate-functions/reference/distinctjsonpaths) | 计算存储在 JSON 列中的不同路径列表。 |
| [timeSeriesDeltaToGrid](/sql-reference/aggregate-functions/reference/timeSeriesDeltaToGrid) | 聚合函数，计算在指定网格上的时间序列数据的类似 PromQL 的增量。 |
| [timeSeriesInstantDeltaToGrid](/sql-reference/aggregate-functions/reference/timeSeriesInstantDeltaToGrid) | 聚合函数，计算在指定网格上的时间序列数据的类似 PromQL 的瞬时增量。 |
| [timeSeriesInstantRateToGrid](/sql-reference/aggregate-functions/reference/timeSeriesInstantRateToGrid) | 聚合函数，计算在指定网格上的时间序列数据的类似 PromQL 的瞬时速率。 |
| [timeSeriesLastTwoSamples](/sql-reference/aggregate-functions/reference/timeSeriesLastTwoSamples) | 聚合函数，用于重新采样时间序列数据以进行类似 PromQL 的瞬时速率和增量计算。 |
| [timeSeriesRateToGrid](/sql-reference/aggregate-functions/reference/timeSeriesRateToGrid) | 聚合函数，计算在指定网格上的时间序列数据的类似 PromQL 的速率。 |
| [timeSeriesResampleToGridWithStaleness](/sql-reference/aggregate-functions/reference/timeSeriesResampleToGridWithStaleness) | 聚合函数，将时间序列数据重新采样到指定网格。 |
| [timeSeriesDerivToGrid](/sql-reference/aggregate-functions/reference/timeSeriesDerivToGrid) | 聚合函数，计算在指定网格上的时间序列数据的类似 PromQL 的导数。 |
| [timeSeriesPredictLinearToGrid](/sql-reference/aggregate-functions/reference/timeSeriesPredictLinearToGrid) | 聚合函数，计算在指定网格上的时间序列数据的类似 PromQL 的线性预测。 |
| [timeSeriesChangesToGrid](/sql-reference/aggregate-functions/reference/timeSeriesChangesToGrid) | 聚合函数，计算在指定网格上的时间序列数据的类似 PromQL 的变化。 |
| [timeSeriesResetsToGrid](/sql-reference/aggregate-functions/reference/timeSeriesResetsToGrid) | 聚合函数，计算在指定网格上的时间序列数据的类似 PromQL 的重置。 |
| [groupConcat](/sql-reference/aggregate-functions/reference/groupconcat) | 从一组字符串计算拼接字符串，可以选择用分隔符分隔，并可以限制元素的最大数量。 |
| [quantilePrometheusHistogram](/sql-reference/aggregate-functions/reference/quantilePrometheusHistogram) | 使用线性插值计算直方图的分位数。 |
<!--AUTOGENERATED_END-->
