---
description: '计算不同参数取值的近似数量。'
slug: /sql-reference/aggregate-functions/reference/uniqcombined
title: 'uniqCombined'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## uniqCombined \{#uniqCombined\}

引入版本：v1.1

计算不同参数值的大致数量。
它以确定性的方式提供结果（不依赖于查询处理顺序）。

:::note
由于对非 String 类型使用 32 位哈希，对于明显大于 `UINT_MAX` 的基数，结果会有非常大的误差（在几十亿个不同值之后误差会迅速增大）。
如果基数大于 `UINT_MAX`，应改用 [`uniqCombined64`](https://clickhouse.com/docs/sql-reference/aggregate-functions/reference/uniqcombined64)。
:::

与 uniq 函数相比，uniqCombined 函数：

* 内存消耗减少数倍
* 计算精度提高数倍
* 通常性能略低。在某些场景下，uniqCombined 的表现可能优于 uniq，例如在通过网络传输大量聚合状态的分布式查询中

<details>
  <summary>实现细节</summary>
  此函数为聚合中的所有参数计算哈希（String 使用 64 位哈希，否则为 32 位哈希），然后在计算中使用该哈希值。
  它结合使用了三种算法：数组、哈希表和带误差校正表的 HyperLogLog：

  * 对于少量不同元素，使用数组
  * 当集合大小更大时，使用哈希表
  * 对于更多元素时，使用 HyperLogLog，它会占用固定大小的内存
</details>

**语法**

```sql
uniqCombined(HLL_precision)(x[, ...])
uniqCombined(x[, ...])
```

**参数**

* `HLL_precision` — 可选。HyperLogLog 中单元格数量的以 2 为底的对数。默认值为 17，对应约 96 KiB 的空间（2^17 个单元格，每个单元格 6 位）。取值范围：[12, 20]。[`UInt8`](/sql-reference/data-types/int-uint)

**参数说明**

* `x` — 可变数量的参数值。[`Tuple(T)`](/sql-reference/data-types/tuple) 或 [`Array(T)`](/sql-reference/data-types/array) 或 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`String`](/sql-reference/data-types/string) 或 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)

**返回值**

返回一个 `UInt64` 类型的数值，表示不同参数值的近似个数。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**基本用法**

```sql title=Query
SELECT uniqCombined(number) FROM numbers(1e6);
```

```response title=Response
┌─uniqCombined(number)─┐
│              1001148 │
└──────────────────────┘
```

**使用自定义精度**

```sql title=Query
SELECT uniqCombined(15)(number) FROM numbers(1e5);
```

```response title=Response
┌─uniqCombined(15)(number)─┐
│                   100768 │
└──────────────────────────┘
```

{/*AUTOGENERATED_END*/ }

**另请参阅**

* [uniq](/sql-reference/aggregate-functions/reference/uniq)
* [uniqCombined64](/sql-reference/aggregate-functions/reference/uniqcombined64)
* [uniqHLL12](/sql-reference/aggregate-functions/reference/uniqhll12)
* [uniqExact](/sql-reference/aggregate-functions/reference/uniqexact)
* [uniqTheta](/sql-reference/aggregate-functions/reference/uniqthetasketch)
