---
description: '选择最后出现的值，类似于 `anyLast`，但允许 NULL 值。'
slug: /sql-reference/aggregate-functions/reference/last_value
title: 'last_value'
doc_type: 'reference'
---

# last_value \{#last_value\}

选择最后出现的值，与 `anyLast` 类似，但可以接受 NULL。
它主要应与[窗口函数](../../window-functions/index.md)一起使用。
如果不使用窗口函数且源数据流未排序，则结果将是随机的。

## 示例 \{#examples\}

```sql
CREATE TABLE test_data
(
    a Int64,
    b Nullable(Int64)
)
ENGINE = Memory;

INSERT INTO test_data (a, b) VALUES (1,null), (2,3), (4, 5), (6,null)
```


### 示例 1 \{#example1\}

默认情况下会忽略 NULL 值。

```sql
SELECT last_value(b) FROM test_data
```

```text
┌─last_value_ignore_nulls(b)─┐
│                          5 │
└────────────────────────────┘
```


### 示例 2 \{#example2\}

NULL 值会被忽略。

```sql
SELECT last_value(b) ignore nulls FROM test_data
```

```text
┌─last_value_ignore_nulls(b)─┐
│                          5 │
└────────────────────────────┘
```


### 示例 3 \{#example3\}

接受 NULL 值。

```sql
SELECT last_value(b) respect nulls FROM test_data
```

```text
┌─last_value_respect_nulls(b)─┐
│                        ᴺᵁᴸᴸ │
└─────────────────────────────┘
```


### 示例 4 \{#example4\}

使用包含 `ORDER BY` 的子查询来稳定结果。

```sql
SELECT
    last_value_respect_nulls(b),
    last_value(b)
FROM
(
    SELECT *
    FROM test_data
    ORDER BY a ASC
)
```

```text
┌─last_value_respect_nulls(b)─┬─last_value(b)─┐
│                        ᴺᵁᴸᴸ │             5 │
└─────────────────────────────┴───────────────┘
```

{/*AUTOGENERATED_START*/ }

{/*AUTOGENERATED_END*/ }
