---
description: 'quantiles, quantilesExactExclusive, quantilesExactInclusive, quantilesGK'
slug: /sql-reference/aggregate-functions/reference/quantiles
title: 'quantiles 函数'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## quantiles \{#quantiles\}

引入版本：v1.1

在一次计算中，同时计算数值数据序列在不同分位点上的多个近似[分位数](https://en.wikipedia.org/wiki/Quantile)。

此函数使用[水塘抽样](https://en.wikipedia.org/wiki/Reservoir_sampling)，水塘容量最大为 8192，并使用随机数生成器进行抽样。
结果是非确定性的。

当需要多个分位数值时，使用 `quantiles` 比多次分别调用 `quantile` 函数更高效，因为所有分位数都在对数据的一次遍历中完成计算。

**语法**

```sql
quantiles(level1, level2, ...)(expr)
```

**参数**

* `level` — 分位数的级别。一个或多个 0 到 1 之间的常量浮点数。推荐使用取值范围为 `[0.01, 0.99]` 的 `level`。[`Float*`](/sql-reference/data-types/float)

**参数**

* `expr` — 基于列值的表达式，结果为数值类型、Date 或 DateTime。[`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal*`](/sql-reference/data-types/decimal) 或 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime)

**返回值**

由指定级别的近似分位数组成的数组，顺序与这些级别的指定顺序一致。[`Array(Float64)`](/sql-reference/data-types/array) 或 [`Array(Date)`](/sql-reference/data-types/array) 或 [`Array(DateTime)`](/sql-reference/data-types/array)

**示例**

**高效计算多个分位数**

```sql title=Query
CREATE TABLE t (val UInt32) ENGINE = Memory;
INSERT INTO t VALUES (1), (1), (2), (3), (4), (5), (6), (7), (8), (9), (10);

SELECT quantiles(0.25, 0.5, 0.75, 0.9)(val) FROM t;
```

```response title=Response
┌─quantiles(0.25, 0.5, 0.75, 0.9)(val)─┐
│ [3, 5.5, 8, 9.5]                     │
└──────────────────────────────────────┘
```

{/*AUTOGENERATED_END*/ }
