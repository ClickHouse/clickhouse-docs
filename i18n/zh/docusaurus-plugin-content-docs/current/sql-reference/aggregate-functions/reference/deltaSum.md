---
description: '对相邻行的算术差求和。'
slug: /sql-reference/aggregate-functions/reference/deltasum
title: 'deltaSum'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## deltaSum \{#deltaSum\}

自 v21.3 引入

对相邻行之间的算术差值求和。
如果差值为负，则会被忽略不计。

:::tip
为使该函数正常工作，底层数据必须经过排序。
如果希望在 [materialized view](/sql-reference/statements/create/view#materialized-view) 中使用该函数，通常更建议改用 [`deltaSumTimestamp`](/sql-reference/aggregate-functions/reference/deltasumtimestamp) 函数。
:::

另请参阅：

* [`runningDifference`](/sql-reference/functions/other-functions#runningDifference)

**语法**

```sql
deltaSum(x1[, x2, ...])
```

**参数**

* `x1[, x2, ...]` — 一个或多个输入值。[`Integer`](/sql-reference/data-types/int-uint) 或 [`Float`](/sql-reference/data-types/float)

**返回值**

返回输入值的累积算术差值。[`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**示例**

**仅包含正差值的基本用法**

```sql title=Query
SELECT deltaSum(arrayJoin([1, 2, 3]))
```

```response title=Response
┌─deltaSum(arrayJoin([1, 2, 3]))─┐
│                              2 │
└────────────────────────────────┘
```

**混合值（忽略为负的差值）**

```sql title=Query
SELECT deltaSum(arrayJoin([1, 2, 3, 0, 3, 4, 2, 3]))
```

```response title=Response
┌─deltaSum(arrayJoin([1, 2, 3, 0, 3, 4, 2, 3]))─┐
│                                             7 │
└───────────────────────────────────────────────┘
```

**浮点数值**

```sql title=Query
SELECT deltaSum(arrayJoin([2.25, 3, 4.5]))
```

```response title=Response
┌─deltaSum(arrayJoin([2.25, 3, 4.5]))─┐
│                                2.25 │
└─────────────────────────────────────┘
```

{/*AUTOGENERATED_END*/ }

**另请参阅**

* [`runningDifference`](/sql-reference/functions/other-functions#runningDifference)
