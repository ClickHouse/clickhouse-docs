---
description: '用于处理 Nullable 值的函数文档'
sidebar_label: 'Nullable'
slug: /sql-reference/functions/functions-for-nulls
title: '用于处理 Nullable 值的函数'
keywords: ['Nullable', '函数']
doc_type: 'reference'
---

# 用于处理可空值的函数 \\{#functions-for-working-with-nullable-values\\}

{/* 
  下面标签内的内容会在文档框架构建期间被替换为
  由 system.functions 生成的文档。请不要修改或移除这些标签。
  请参见：https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }

## assumeNotNull \\{#assumeNotNull\\}

自 v1.1 起引入

对于 [`Nullable`](../data-types/nullable.md) 类型的值，返回其对应的非 `Nullable` 类型值。
如果原始值为 `NULL`，则可能返回任意结果。

另请参阅：函数 [`ifNull`](#ifNull) 和 [`coalesce`](#coalesce)。

**语法**

```sql
assumeNotNull(x)
```

**参数**

* `x` — 任意可空类型的原始值。[`Nullable(T)`](/sql-reference/data-types/nullable)

**返回值**

如果原始值不是 `NULL`，则返回非可空值；如果输入值为 `NULL`，则返回一个任意值。[`Any`](/sql-reference/data-types)

**示例**

**用法示例**

```sql title=Query
CREATE TABLE t_null (x Int8, y Nullable(Int8))
ENGINE=MergeTree()
ORDER BY x;

INSERT INTO t_null VALUES (1, NULL), (2, 3);

SELECT assumeNotNull(y) FROM table;
SELECT toTypeName(assumeNotNull(y)) FROM t_null;
```

```response title=Response
┌─assumeNotNull(y)─┐
│                0 │
│                3 │
└──────────────────┘
┌─toTypeName(assumeNotNull(y))─┐
│ Int8                         │
│ Int8                         │
└──────────────────────────────┘
```

## coalesce \\{#coalesce\\}

引入版本：v1.1

返回从左到右第一个非 `NULL` 的参数。

**语法**

```sql
coalesce(x[, y, ...])
```

**参数**

* `x[, y, ...]` — 任意数量的非复合类型参数。所有参数的数据类型必须彼此兼容。[`Any`](/sql-reference/data-types)

**返回值**

返回第一个非 `NULL` 的参数；如果所有参数均为 `NULL`，则返回 `NULL`。[`Any`](/sql-reference/data-types) 或 [`NULL`](/sql-reference/syntax#null)

**示例**

**用法示例**

```sql title=Query
-- 假设有一个联系人列表,其中可能包含联系客户的多种方式。

CREATE TABLE aBook
(
    name String,
    mail Nullable(String),
    phone Nullable(String),
    telegram Nullable(UInt32)
)
ENGINE = MergeTree
ORDER BY tuple();

INSERT INTO aBook VALUES ('client 1', NULL, '123-45-67', 123), ('client 2', NULL, NULL, NULL);

-- mail 和 phone 字段为 String 类型,但 telegram 字段为 UInt32 类型,因此需要转换为 String。

-- 从联系人列表中获取客户的第一个可用联系方式

SELECT name, coalesce(mail, phone, CAST(telegram,'Nullable(String)')) FROM aBook;
```

```response title=Response
┌─name─────┬─coalesce(mail, phone, CAST(telegram, 'Nullable(String)'))─┐
│ client 1 │ 123-45-67                                                 │
│ client 2 │ ᴺᵁᴸᴸ                                                      │
└──────────┴───────────────────────────────────────────────────────────┘
```

## firstNonDefault \\{#firstNonDefault\\}

自 v25.9 起引入

从一组参数中返回第一个非默认值

**语法**

```sql
```

**参数**

* `arg1` — 要检查的第一个参数 - `arg2` — 要检查的第二个参数 - `...` — 要检查的其他参数

**返回值**

返回类型为所有参数的公共超类型

**示例**

**整数**

```sql title=Query
SELECT firstNonDefault(0, 1, 2)
```

```response title=Response
1
```

**字符串**

```sql title=Query
SELECT firstNonDefault('', 'hello', 'world')
```

```response title=Response
'你好'
```

**空值**

```sql title=Query
SELECT firstNonDefault(NULL, 0 :: UInt8, 1 :: UInt8)
```

```response title=Response
1
```

**可为空的零**

```sql title=Query
SELECT firstNonDefault(NULL, 0 :: Nullable(UInt8), 1 :: Nullable(UInt8))
```

```response title=Response
0
```

## ifNull \\{#ifNull\\}

自 v1.1 起引入。

当第一个参数为 `NULL` 时，返回一个替代值。

**语法**

```sql
ifNull(x, alt)
```

**参数**

* `x` — 要检查是否为 `NULL` 的值。[`Any`](/sql-reference/data-types)
* `alt` — 当 `x` 为 `NULL` 时函数返回的值。[`Any`](/sql-reference/data-types)

**返回值**

如果 `x` 不为 `NULL`，则返回 `x` 的值，否则返回 `alt`。[`Any`](/sql-reference/data-types)

**示例**

**用法示例**

```sql title=Query
SELECT ifNull('a', 'b'), ifNull(NULL, 'b');
```

```response title=Response
┌─ifNull('a', 'b')─┬─ifNull(NULL, 'b')─┐
│ a                │ b                 │
└──────────────────┴───────────────────┘
```

## isNotNull \\{#isNotNull\\}

自 v1.1 版本引入

检查参数是否为非 `NULL`。

另请参阅：运算符 [`IS NOT NULL`](/sql-reference/operators#is_not_null)。

**语法**

```sql
isNotNull(x)
```

**参数**

* `x` — 非复合数据类型的值。[`Any`](/sql-reference/data-types)

**返回值**

如果 `x` 不为 `NULL`，则返回 `1`，否则返回 `0`。[`UInt8`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
CREATE TABLE t_null
(
  x Int32,
  y Nullable(Int32)
)
ENGINE = MergeTree
ORDER BY tuple();

INSERT INTO t_null VALUES (1, NULL), (2, 3);

SELECT x FROM t_null WHERE isNotNull(y);
```

```response title=Response
┌─x─┐
│ 2 │
└───┘
```

## isNull \\{#isNull\\}

自 v1.1 版本引入

检查参数是否为 `NULL`。

另请参阅：运算符 [`IS NULL`](/sql-reference/operators#is_null)。

**语法**

```sql
isNull(x)
```

**参数**

* `x` — 一个非复合类型的值。[`Any`](/sql-reference/data-types)

**返回值**

当 `x` 为 `NULL` 时返回 `1`，否则返回 `0`。[`UInt8`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
CREATE TABLE t_null
(
  x Int32,
  y Nullable(Int32)
)
ENGINE = MergeTree
ORDER BY tuple();

INSERT INTO t_null VALUES (1, NULL), (2, 3);

SELECT x FROM t_null WHERE isNull(y);
```

```response title=Response
┌─x─┐
│ 1 │
└───┘
```

## isNullable \\{#isNullable\\}

自 v22.7 起引入

检查参数的数据类型是否为 `Nullable`（即是否允许 `NULL` 值）。

**语法**

```sql
isNullable(x)
```

**参数**

* `x` — 任意数据类型的值。[`Any`](/sql-reference/data-types)

**返回值**

当 `x` 是 `Nullable` 数据类型时返回 `1`，否则返回 `0`。[`UInt8`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
CREATE TABLE tab (
    ordinary_col UInt32,
    nullable_col Nullable(UInt32)
)
ENGINE = MergeTree
ORDER BY tuple();
INSERT INTO tab (ordinary_col, nullable_col) VALUES (1,1), (2, 2), (3,3);
SELECT isNullable(ordinary_col), isNullable(nullable_col) FROM tab;
```

```response title=Response
┌───isNullable(ordinary_col)──┬───isNullable(nullable_col)──┐
│                           0 │                           1 │
│                           0 │                           1 │
│                           0 │                           1 │
└─────────────────────────────┴─────────────────────────────┘
```

## isZeroOrNull \\{#isZeroOrNull\\}

自 v20.3 版本引入

检查参数是否为零（`0`）或 `NULL`。

**语法**

```sql
isZeroOrNull(x)
```

**参数**

* `x` — 数值。[`UInt`](/sql-reference/data-types/int-uint)

**返回值**

如果 `x` 为 `NULL` 或等于零，则返回 `1`，否则返回 `0`。[`UInt8/16/32/64`](/sql-reference/data-types/int-uint) 或 [`Float32/Float64`](/sql-reference/data-types/float)

**示例**

**用法示例**

```sql title=Query
CREATE TABLE t_null
(
  x Int32,
  y Nullable(Int32)
)
ENGINE = MergeTree
ORDER BY tuple();

INSERT INTO t_null VALUES (1, NULL), (2, 0), (3, 3);

SELECT x FROM t_null WHERE isZeroOrNull(y);
```

```response title=Response
┌─x─┐
│ 1 │
│ 2 │
└───┘
```

## nullIf \\{#nullIf\\}

自 v1.1 版本引入

如果两个参数相等，则返回 `NULL`。

**语法**

```sql
nullIf(x, y)
```

**参数**

* `x` — 第一个值。[`Any`](/sql-reference/data-types)
* `y` — 第二个值。[`Any`](/sql-reference/data-types)

**返回值**

如果两个参数相等，则返回 `NULL`，否则返回第一个参数。[`NULL`](/sql-reference/syntax#null) 或 [`Nullable(x)`](/sql-reference/data-types/nullable)

**示例**

**使用示例**

```sql title=Query
SELECT nullIf(1, 1), nullIf(1, 2);
```

```response title=Response
┌─nullIf(1, 1)─┬─nullIf(1, 2)─┐
│         ᴺᵁᴸᴸ │            1 │
└──────────────┴──────────────┘
```

## toNullable \\{#toNullable\\}

自 v1.1 起引入

将传入参数的类型转换为 `Nullable` 类型。

**语法**

```sql
toNullable(x)
```

**参数**

* `x` — 任意非复合数据类型的值。[`Any`](/sql-reference/data-types)

**返回值**

返回与输入值相同的值，但其类型为 `Nullable`。[`Nullable(Any)`](/sql-reference/data-types/nullable)

**示例**

**使用示例**

```sql title=Query
SELECT toTypeName(10), toTypeName(toNullable(10));
```

```response title=Response
┌─toTypeName(10)─┬─toTypeName(toNullable(10))─┐
│ UInt8          │ Nullable(UInt8)            │
└────────────────┴────────────────────────────┘
```

{/*AUTOGENERATED_END*/ }
