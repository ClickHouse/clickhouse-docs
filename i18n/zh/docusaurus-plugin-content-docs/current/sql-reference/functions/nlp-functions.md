---
description: '自然语言处理（NLP）函数文档'
sidebar_label: 'NLP'
slug: /sql-reference/functions/nlp-functions
title: '自然语言处理（NLP）函数'
doc_type: 'reference'
keywords: ['NLP', 'Natural Language Processing', '自然语言处理']
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import CloudNotSupportedBadge from '@theme/badges/CloudNotSupportedBadge';

# 自然语言处理（NLP）函数 {#natural-language-processing-nlp-functions}

<ExperimentalBadge />

<CloudNotSupportedBadge />

:::warning
这是一个仍在开发中的实验性特性，目前尚未准备好供广泛使用。在未来的版本中，它可能会以不可预期且不向后兼容的方式发生变化。请将 `allow_experimental_nlp_functions` 设为 1 以启用该功能。
:::

{/* 
  以下标签的内部内容会在文档框架构建期间
  被从 system.functions 生成的文档所替换。请不要修改或删除这些标签。
  参见：https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }

## detectCharset {#detectCharset}

自 v22.2 起引入

检测非 UTF-8 编码输入字符串的字符集。

**语法**

```sql
detectCharset(s)
```

**参数**

* `s` — 要分析的文本。[`String`](/sql-reference/data-types/string)

**返回值**

返回一个表示检测到的字符集编码的字符串。[`String`](/sql-reference/data-types/string)

**示例**

**基本用法**

```sql title=Query
SELECT detectCharset('我会待几天。')
```

```response title=Response
WINDOWS-1252
```



## detectLanguage {#detectLanguage}

Introduced in: v22.2


Detects the language of the UTF8-encoded input string.
The function uses the [CLD2 library](https://github.com/CLD2Owners/cld2) for detection and returns the 2-letter ISO language code.

The longer the input, the more precise the language detection will be.


**Syntax**

```sql
detectLanguage(s)
```

**Arguments**

- `text_to_be_analyzed` — The text to analyze. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the 2-letter ISO code of the detected language. Other possible results: `un` = unknown, can not detect any language, `other` = the detected language does not have 2 letter code. [`String`](/sql-reference/data-types/string)

**Examples**

**Mixed language text**

```sql title=Query
SELECT detectLanguage('我觉得我永远无法像母语者那样说法语。有志者事竟成。')
```

```response title=Response
fr
```



## detectLanguageMixed {#detectLanguageMixed}

Introduced in: v22.2


Similar to the [`detectLanguage`](#detectLanguage) function, but `detectLanguageMixed` returns a `Map` of 2-letter language codes that are mapped to the percentage of the certain language in the text.


**Syntax**

```sql
detectLanguageMixed(s)
```

**Arguments**

- `s` — The text to analyze [`String`](/sql-reference/data-types/string)


**Returned value**

Returns a map with keys which are 2-letter ISO codes and corresponding values which are a percentage of the text found for that language [`Map(String, Float32)`](/sql-reference/data-types/map)

**Examples**

**Mixed languages**

```sql title=Query
SELECT detectLanguageMixed('二兎を追う者は一兎をも得ず二兎を追う者は一兎をも得ず A vaincre sans peril, on triomphe sans gloire.')
```

```response title=Response
{'ja':0.62,'fr':0.36}
```



## detectLanguageUnknown {#detectLanguageUnknown}

Introduced in: v22.2


Similar to the [`detectLanguage`](#detectLanguage) function, except the detectLanguageUnknown function works with non-UTF8-encoded strings.
Prefer this version when your character set is UTF-16 or UTF-32.


**Syntax**

```sql
detectLanguageUnknown('s')
```

**Arguments**

- `s` — The text to analyze. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the 2-letter ISO code of the detected language. Other possible results: `un` = unknown, can not detect any language, `other` = the detected language does not have 2 letter code. [`String`](/sql-reference/data-types/string)

**Examples**

**Basic usage**

```sql title=Query
SELECT detectLanguageUnknown('Ich bleibe für ein paar Tage.')
```

```response title=Response
de
```



## detectProgrammingLanguage {#detectProgrammingLanguage}

Introduced in: v22.2


Determines the programming language from a given source code snippet.


**Syntax**

```sql
detectProgrammingLanguage('source_code')
```

**Arguments**

- `source_code` — String representation of the source code to analyze. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns programming language [`String`](/sql-reference/data-types/string)

**Examples**

**C++ code detection**

```sql title=Query
SELECT detectProgrammingLanguage('#include <iostream>')
```

```response title=Response
C++
```



## detectTonality {#detectTonality}

Introduced in: v22.2


Determines the sentiment of the provided text data.

:::note Limitation
This function is limited in its current form in that it makes use of the embedded emotional dictionary and only works for the Russian language.
:::


**Syntax**

```sql
detectTonality(s)
```

**Arguments**

- `s` — The text to be analyzed. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the average sentiment value of the words in text [`Float32`](/sql-reference/data-types/float)

**Examples**

**Russian sentiment analysis**

```sql title=Query
SELECT
    detectTonality('Шарик - хороший пёс'),
    detectTonality('Шарик - пёс'),
    detectTonality('Шарик - плохой пёс')
```

```response title=Response
0.44445, 0, -0.3
```



## lemmatize {#lemmatize}

Introduced in: v21.9


Performs lemmatization on a given word.
This function needs dictionaries to operate, which can be obtained from [github](https://github.com/vpodpecan/lemmagen3/tree/master/src/lemmagen3/models). For more details on loading a dictionary from a local file see page ["Defining Dictionaries"](/sql-reference/dictionaries#local-file).


**Syntax**

```sql
lemmatize(lang, word)
```

**Arguments**

- `lang` — Language which rules will be applied. [`String`](/sql-reference/data-types/string)
- `word` — Lowercase word that needs to be lemmatized. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the lemmatized form of the word [`String`](/sql-reference/data-types/string)

**Examples**

**English lemmatization**

```sql title=Query
SELECT lemmatize('en', 'wolves')
```

```response title=Response
wolf
```



## stem {#stem}

Introduced in: v21.9


Performs stemming on a given word.


**Syntax**

```sql
stem(lang, word)
```

**Arguments**

- `lang` — Language which rules will be applied. Use the two letter ISO 639-1 code. [`String`](/sql-reference/data-types/string)
- `word` — Lowercase word that needs to be stemmed. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the stemmed form of the word [`String`](/sql-reference/data-types/string)

**Examples**

**English stemming**

```sql title=Query
SELECT arrayMap(x -> stem('en', x),
['I', 'think', 'it', 'is', 'a', 'blessing', 'in', 'disguise']) AS res
```

```response title=Response
['I','think','it','is','a','bless','in','disguis']
```



## synonyms {#synonyms}

Introduced in: v21.9


Finds synonyms of a given word.

There are two types of synonym extensions:
- `plain`
- `wordnet`

With the `plain` extension type you need to provide a path to a simple text file, where each line corresponds to a certain synonym set.
Words in this line must be separated with space or tab characters.

With the `wordnet` extension type you need to provide a path to a directory with the WordNet thesaurus in it.
The thesaurus must contain a WordNet sense index.


**Syntax**

```sql
synonyms(ext_name, word)
```

**Arguments**

- `ext_name` — Name of the extension in which search will be performed. [`String`](/sql-reference/data-types/string)
- `word` — Word that will be searched in extension. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns array of synonyms for the given word. [`Array(String)`](/sql-reference/data-types/array)

**Examples**

**Find synonyms**

```sql title=Query
SELECT synonyms('list', 'important')
```

```response title=Response
['important','big','critical','crucial']
```

{/*AUTOGENERATED_END*/ }
