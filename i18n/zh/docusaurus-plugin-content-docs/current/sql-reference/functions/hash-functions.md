---
description: '哈希函数文档'
sidebar_label: '哈希'
slug: /sql-reference/functions/hash-functions
title: '哈希函数'
doc_type: 'reference'
---

# 哈希函数 \{#hash-functions\}

哈希函数可用于对元素进行确定性的伪随机打乱。

Simhash 是一种哈希函数，对相近（相似）的参数会返回相近的哈希值。

大多数哈希函数可以接受任意数量、任意类型的参数。

:::note
NULL 的哈希值是 NULL。要获取 Nullable 列的非 NULL 哈希值，请将其包裹在一个元组中：

```sql
SELECT cityHash64(tuple(NULL))
```

:::

:::note
要计算整张表所有内容的哈希值，请使用 `sum(cityHash64(tuple(*)))`（或其他哈希函数）。`tuple` 可确保不会跳过包含 NULL 值的行，`sum` 则可确保行的顺序不影响结果。
:::

{/* 
  下面标签内的内容会在文档框架构建期间
  被由 system.functions 生成的文档所替换。请不要修改或删除这些标签。
  参见：https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }

## BLAKE3 \{#BLAKE3\}

引入版本：v22.10

计算 BLAKE3 哈希字符串，并将得到的字节序列作为 FixedString 返回。
该密码学哈希函数借助 BLAKE3 Rust 库集成到 ClickHouse 中。
该函数速度相当快，相比 SHA-2 性能大约快两倍，同时生成的哈希长度与 SHA-256 相同。
它返回一个类型为 FixedString(32) 的字节数组形式的 BLAKE3 哈希值。

**语法**

```sql
BLAKE3(message)
```

**参数**

* `message` — 要进行哈希计算的输入字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回输入字符串的 32 字节 BLAKE3 哈希值，作为定长字符串返回。[`FixedString(32)`](/sql-reference/data-types/fixedstring)

**示例**

**hash**

```sql title=Query
SELECT hex(BLAKE3('ABC'))
```

```response title=Response
┌─hex(BLAKE3('ABC'))───────────────────────────────────────────────┐
│ D1717274597CF0289694F75D96D444B992A096F1AFD8E7BBFA6EBB1D360FEDFC │
└──────────────────────────────────────────────────────────────────┘
```

## MD4 \{#MD4\}

在 v21.11 中引入

计算给定字符串的 MD4 哈希值。

**语法**

```sql
MD4(s)
```

**参数**

* `s` — 要计算哈希值的输入字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回给定输入字符串的 MD4 哈希值，类型为固定长度字符串。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**示例**

**使用示例**

```sql title=Query
SELECT HEX(MD4('abc'));
```

```response title=Response
┌─hex(MD4('abc'))──────────────────┐
│ A448017AAF21D8525FC10AE87AA6729D │
└──────────────────────────────────┘
```

## MD5 \{#MD5\}

自 v1.1 起引入

计算给定字符串的 MD5 哈希值。

**语法**

```sql
MD5(s)
```

**参数**

* `s` — 要进行哈希运算的输入字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回给定输入字符串的 MD5 哈希值，类型为定长字符串。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**示例**

**用法示例**

```sql title=Query
SELECT HEX(MD5('abc'));
```

```response title=Response
┌─hex(MD5('abc'))──────────────────┐
│ 900150983CD24FB0D6963F7D28E17F72 │
└──────────────────────────────────┘
```

## RIPEMD160 \{#RIPEMD160\}

自 v24.10 引入

计算给定字符串的 RIPEMD-160 哈希值。

**语法**

```sql
RIPEMD160(s)
```

**参数**

* `s` — 要进行哈希计算的输入字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回给定输入字符串的 RIPEMD160 哈希值，作为定长字符串。[`FixedString(20)`](/sql-reference/data-types/fixedstring)

**示例**

**使用示例**

```sql title=Query
SELECT HEX(RIPEMD160('The quick brown fox jumps over the lazy dog'));
```

```response title=Response
┌─HEX(RIPEMD160('The quick brown fox jumps over the lazy dog'))─┐
│ 37F332F68DB77BD9D7EDD4969571AD671CF9DD3B                      │
└───────────────────────────────────────────────────────────────┘
```

## SHA1 \{#SHA1\}

自 v1.1 起引入

计算给定字符串的 SHA1 哈希值。

**语法**

```sql
SHA1(s)
```

**参数**

* `s` — 要进行哈希的输入字符串 [`String`](/sql-reference/data-types/string)

**返回值**

返回给定输入字符串的 SHA1 哈希值，作为长度为 20 的定长字符串类型返回。[`FixedString(20)`](/sql-reference/data-types/fixedstring)

**示例**

**使用示例**

```sql title=Query
SELECT HEX(SHA1('abc'));
```

```response title=Response
┌─hex(SHA1('abc'))─────────────────────────┐
│ A9993E364706816ABA3E25717850C26C9CD0D89D │
└──────────────────────────────────────────┘
```

## SHA224 \{#SHA224\}

在 v1.1 中引入

计算给定字符串的 SHA224 哈希。

**语法**

```sql
SHA224(s)
```

**参数**

* `s` — 要进行哈希的输入值。[`String`](/sql-reference/data-types/string)

**返回值**

返回给定输入字符串的 SHA224 哈希值，类型为定长字符串。[`FixedString(28)`](/sql-reference/data-types/fixedstring)

**示例**

**使用示例**

```sql title=Query
SELECT HEX(SHA224('abc'));
```

```response title=Response
┌─hex(SHA224('abc'))───────────────────────────────────────┐
│ 23097D223405D8228642A477BDA255B32AADBCE4BDA0B3F7E36C9DA7 │
└──────────────────────────────────────────────────────────┘
```

## SHA256 \{#SHA256\}

自 v1.1 起引入。

计算给定字符串的 SHA256 哈希值。

**语法**

```sql
SHA256(s)
```

**参数**

* `s` — 要进行哈希的输入字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回给定输入字符串的 SHA256 哈希值，类型为固定长度字符串。[`FixedString(32)`](/sql-reference/data-types/fixedstring)

**示例**

**使用示例**

```sql title=Query
SELECT HEX(SHA256('abc'));
```

```response title=Response
┌─hex(SHA256('abc'))───────────────────────────────────────────────┐
│ BA7816BF8F01CFEA414140DE5DAE2223B00361A396177A9CB410FF61F20015AD │
└──────────────────────────────────────────────────────────────────┘
```

## SHA384 \{#SHA384\}

引入版本：v1.1

计算给定字符串的 SHA384 哈希值。

**语法**

```sql
SHA384(s)
```

**参数**

* `s` — 输入用于计算哈希值的字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回给定输入字符串的 SHA384 哈希值，作为固定长度字符串。[`FixedString(48)`](/sql-reference/data-types/fixedstring)

**示例**

**使用示例**

```sql title=Query
SELECT HEX(SHA384('abc'));
```

```response title=Response
┌─hex(SHA384('abc'))───────────────────────────────────────────────────────────────────────────────┐
│ CB00753F45A35E8BB5A03D699AC65007272C32AB0EDED1631A8B605A43FF5BED8086072BA1E7CC2358BAECA134C825A7 │
└──────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## SHA512 \{#SHA512\}

在 v1.1 中引入

计算给定字符串的 SHA512 哈希值。

**语法**

```sql
SHA512(s)
```

**参数**

* `s` — 要进行哈希计算的输入字符串 [`String`](/sql-reference/data-types/string)

**返回值**

返回给定输入字符串的 SHA512 哈希值，类型为定长字符串 [`FixedString(64)`](/sql-reference/data-types/fixedstring)

**示例**

**用法示例**

```sql title=Query
SELECT HEX(SHA512('abc'));
```

```response title=Response
┌─hex(SHA512('abc'))───────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ DDAF35A193617ABACC417349AE20413112E6FA4E89A97EA20A9EEEE64B55D39A2192992A274FC1A836BA3C23A3FEEBBD454D4423643CE80E2A9AC94FA54CA49F │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## SHA512_256 \{#SHA512_256\}

自 v1.1 起提供

计算给定字符串的 SHA512&#95;256 哈希值。

**语法**

```sql
SHA512_256(s)
```

**参数**

* `s` — 要进行哈希运算的输入字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回给定输入字符串的 SHA512&#95;256 哈希值，类型为固定长度字符串。[`FixedString(32)`](/sql-reference/data-types/fixedstring)

**示例**

**用法示例**

```sql title=Query
SELECT HEX(SHA512_256('abc'));
```

```response title=Response
┌─hex(SHA512_256('abc'))───────────────────────────────────────────┐
│ 53048E2681941EF99B2E29B76B4C7DABE4C2D0C634FC6D46E0E2F13107E7AF23 │
└──────────────────────────────────────────────────────────────────┘
```

## URLHash \{#URLHash\}

引入版本：v1.1

一种针对从 URL 获取并经过某种规范化处理后的字符串的快速、较高质量的非加密哈希函数。

此哈希函数有两种模式：

| Mode              | Description                                                                                               |
| ----------------- | --------------------------------------------------------------------------------------------------------- |
| `URLHash(url)`    | 从字符串中计算哈希值；如果末尾存在 `/`、`?` 或 `#` 之一作为结尾符号，则先移除该符号后再进行计算。                                                   |
| `URLHash(url, N)` | 从字符串中计算哈希值，计算范围限定为 URL 层级结构中的第 N 层；如果末尾存在 `/`、`?` 或 `#` 之一作为结尾符号，则先移除该符号后再进行计算。层级的定义与 `URLHierarchy` 中相同。 |

**语法**

```sql
URLHash(url[, N])
```

**参数**

* `url` — 需要进行哈希运算的 URL 字符串。[`String`](/sql-reference/data-types/string)
* `N` — 可选。URL 层级中的级别。[`(U)Int*`](/sql-reference/data-types/int-uint)

**返回值**

返回 `url` 的计算哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT URLHash('https://www.clickhouse.com')
```

```response title=Response
┌─URLHash('htt⋯house.com')─┐
│     13614512636072854701 │
└──────────────────────────┘
```

**指定级别 URL 的哈希值**

```sql title=Query
SELECT URLHash('https://www.clickhouse.com/docs', 0);
SELECT URLHash('https://www.clickhouse.com/docs', 1);
```

```response title=Response
-- hash of https://www.clickhouse.com
┌─URLHash('htt⋯m/docs', 0)─┐
│     13614512636072854701 │
└──────────────────────────┘
-- hash of https://www.clickhouse.com/docs
┌─URLHash('htt⋯m/docs', 1)─┐
│     13167253331440520598 │
└──────────────────────────┘
```

## cityHash64 \{#cityHash64\}

引入于：v1.1

生成 64 位的 [CityHash](https://github.com/google/cityhash) 哈希值。

这是一个快速的非密码学哈希函数。
它对字符串参数使用 CityHash 算法，对其他数据类型的参数使用具体实现相关的快速非密码学哈希函数。
该函数使用 CityHash 组合器来得到最终结果。

:::info
在 CityHash 被集成到 ClickHouse 之后，Google 修改了 CityHash 的算法。
换句话说，ClickHouse 的 cityHash64 与 Google 上游的 CityHash 现在会产生不同的结果。
ClickHouse 的 cityHash64 对应 CityHash v1.0.2。
:::

:::note
对于不同参数类型但输入值相同的情况，计算得到的哈希值可能相等。
例如，这会影响不同大小的整数类型、具有相同数据的具名和非具名 `Tuple`，以及具有相同数据的 `Map` 与对应的 `Array(Tuple(key, value))` 类型。
:::

**语法**

```sql
cityHash64(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 数量可变的输入参数，用于计算哈希值。[`Any`](/sql-reference/data-types)

**返回值**

返回输入参数计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**调用示例**

```sql title=Query
SELECT cityHash64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS CityHash, toTypeName(CityHash) AS type;
```

```response title=Response
┌─────────────CityHash─┬─type───┐
│ 12072650598913549138 │ UInt64 │
└──────────────────────┴────────┘
```

**计算整张表的校验和（精确到行顺序）**

```sql title=Query
CREATE TABLE users (
    id UInt32,
    name String,
    age UInt8,
    city String
)
ENGINE = MergeTree
ORDER BY tuple();

INSERT INTO users VALUES
(1, 'Alice', 25, 'New York'),
(2, 'Bob', 30, 'London'),
(3, 'Charlie', 35, 'Tokyo');

SELECT groupBitXor(cityHash64(*)) FROM users;
```

```response title=Response
┌─groupBitXor(⋯age, city))─┐
│     11639977218258521182 │
└──────────────────────────┘
```

## farmFingerprint64 \{#farmFingerprint64\}

引入于：v20.12

使用 `Fingerprint64` 方法生成 64 位的 [FarmHash](https://github.com/google/farmhash) 值。

:::tip
与 [`farmHash64`](#farmHash64) 相比，`farmFingerprint64` 更适合用于获取稳定且可移植的值。
:::

:::note
对于不同参数类型但相同输入值，计算得到的哈希值可能会相同。
这会影响到例如不同大小的整数类型、具有相同数据的已命名和未命名 `Tuple`，以及具有相同数据的 `Map` 与对应的 `Array(Tuple(key, value))` 类型。
:::

**语法**

```sql
farmFingerprint64(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 数量可变的输入参数，用于计算哈希值。[`Any`](/sql-reference/data-types)

**返回值**

返回输入参数计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT farmFingerprint64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS FarmFingerprint, toTypeName(FarmFingerprint) AS type;
```

```response title=Response
┌─────FarmFingerprint─┬─type───┐
│ 5752020380710916328 │ UInt64 │
└─────────────────────┴────────┘
```

## farmHash64 \{#farmHash64\}

引入自：v1.1

使用 `Hash64` 方法生成 64 位的 [FarmHash](https://github.com/google/farmhash) 哈希值。

:::tip
为了获得稳定且可移植的值，推荐使用 [`farmFingerprint64`](#farmFingerprint64)。
:::

:::note
对于不同参数类型但具有相同输入值的情况，计算出的哈希值可能相同。
例如，这会影响不同大小的整数类型、具有相同数据的具名和未具名 `Tuple`，以及具有相同数据的 `Map` 与对应的 `Array(Tuple(key, value))` 类型。
:::

**语法**

```sql
farmHash64(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 数量可变的一组输入参数，用于计算哈希值。[`Any`](/sql-reference/data-types)

**返回值**

返回根据输入参数计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT farmHash64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS FarmHash, toTypeName(FarmHash) AS type;
```

```response title=Response
┌─────────────FarmHash─┬─type───┐
│ 18125596431186471178 │ UInt64 │
└──────────────────────┴────────┘
```

## gccMurmurHash \{#gccMurmurHash\}

引入版本：v20.1

使用与 [GCC](https://github.com/gcc-mirror/gcc/blob/41d6b10e96a1de98e90a7c0378437c3255814b16/libstdc%2B%2B-v3/include/bits/functional_hash.h#L191) 相同的种子，计算输入值的 64 位 [MurmurHash2](https://github.com/aappleby/smhasher) 哈希值。

在 Clang 和 GCC 的构建之间具有可移植性。

**语法**

```sql
gccMurmurHash(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 用于计算哈希值的数量可变参数。[`Any`](/sql-reference/data-types)

**返回值**

返回根据输入参数计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT
    gccMurmurHash(1, 2, 3) AS res1,
    gccMurmurHash(('a', [1, 2, 3], 4, (4, ['foo', 'bar'], 1, (1, 2)))) AS res2
```

```response title=Response
┌─────────────────res1─┬────────────────res2─┐
│ 12384823029245979431 │ 1188926775431157506 │
└──────────────────────┴─────────────────────┘
```

## halfMD5 \{#halfMD5\}

引入于：v1.1

将所有输入参数都[重新解释](/sql-reference/functions/type-conversion-functions#reinterpretAsString)为字符串，并为每个参数计算其 MD5 哈希值。然后将这些哈希组合在一起，对所得字符串再计算哈希值，取其前 8 个字节，并按大端字节序将其解释为 [UInt64](/sql-reference/data-types/int-uint)。该函数相对较慢（每个处理器核心每秒处理 500 万个短字符串）。

建议改用 [`sipHash64`](#sipHash64) 函数。

该函数接受可变数量的输入参数。
参数可以是任意受支持的数据类型。
对于某些数据类型，即使参数类型不同（例如不同大小的整数、具有相同数据的具名和匿名 Tuple、以及具有相同数据的 Map 与对应的 Array(Tuple(key, value)) 类型），只要取值相同，计算得到的哈希值也可能相同。

**语法**

```sql
halfMD5(arg1[, arg2, ..., argN])
```

**参数**

* `arg1[, arg2, ..., argN]` — 要计算哈希的可变数量的参数。[`Any`](/sql-reference/data-types)

**返回值**

返回给定输入参数计算得到的半长 MD5 哈希值，并以大端字节序的 `UInt64` 值返回。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT HEX(halfMD5('abc', 'cde', 'fgh'));
```

```response title=Response
┌─hex(halfMD5('abc', 'cde', 'fgh'))─┐
│ 2C9506B7374CFAF4                  │
└───────────────────────────────────┘
```

## hiveHash \{#hiveHash\}

引入自：v20.1

计算字符串的 “HiveHash” 值。
它只是将 [`JavaHash`](#javaHash) 的符号位清零后的结果。
此函数用于 3.0 之前版本的 [Apache Hive](https://en.wikipedia.org/wiki/Apache_Hive)。

:::caution
该哈希函数性能较差。
仅在该算法已在其他系统中使用且需要计算相同结果时才使用它。
:::

**语法**

```sql
hiveHash(arg)
```

**参数**

* `arg` — 要进行哈希计算的输入字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回输入字符串计算得到的 Hive 哈希值（“hive hash”）。[`Int32`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT hiveHash('Hello, world!');
```

```response title=Response
┌─hiveHash('Hello, world!')─┐
│                 267439093 │
└───────────────────────────┘
```

## icebergHash \{#icebergHash\}

在 v25.5 中引入

实现 Iceberg [hashing transform](https://iceberg.apache.org/spec/#appendix-b-32-bit-hash-requirements) 逻辑

**语法**

```sql
icebergHash(value)
```

**参数**

* `value` — 要计算哈希的源值，可以是 [`Integer`](/sql-reference/data-types/int-uint)、[`Bool`](/sql-reference/data-types/boolean)、[`Decimal`](/sql-reference/data-types/decimal)、[`Float*`](/sql-reference/data-types/float)、[`String`](/sql-reference/data-types/string)、[`FixedString`](/sql-reference/data-types/fixedstring)、[`UUID`](/sql-reference/data-types/uuid)、[`Date`](/sql-reference/data-types/date)、[`Time`](/sql-reference/data-types/time) 或 [`DateTime`](/sql-reference/data-types/datetime)

**返回值**

返回一个 32 位 Murmur3 哈希值（x86 变体，种子为 0），类型为 [`Int32`](/sql-reference/data-types/int-uint)

**示例**

**示例**

```sql title=Query
SELECT icebergHash(1.0 :: Float32)
```

```response title=Response
-142385009
```

## intHash32 \{#intHash32\}

自 v1.1 引入

计算 32 位整数的哈希值。

该哈希函数速度较快，但不是密码学散列函数。

**语法**

```sql
intHash32(arg)
```

**参数**

* `arg` — 要进行哈希的整数。[`(U)Int*`](/sql-reference/data-types/int-uint)

**返回值**

返回输入整数计算出的 32 位哈希值 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT intHash32(42);
```

```response title=Response
┌─intHash32(42)─┐
│    1228623923 │
└───────────────┘
```

## intHash64 \{#intHash64\}

引入版本：v1.1

计算整数的 64 位哈希值。

该哈希函数相对较快（甚至比 [`intHash32`](#intHash32) 更快），但不是密码学意义上的哈希函数。

**语法**

```sql
intHash64(int)
```

**参数**

* `int` — 要进行哈希的整数。[`(U)Int*`](/sql-reference/data-types/int-uint)

**返回值**

64 位哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT intHash64(42);
```

```response title=Response
┌────────intHash64(42)─┐
│ 11490350930367293593 │
└──────────────────────┘
```

## javaHash \{#javaHash\}

在 v20.1 中引入

从以下类型计算 JavaHash：

* [string](http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/String.java#l1452)，
* [Byte](https://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/Byte.java#l405)，
* [Short](https://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/Short.java#l410)，
* [Integer](https://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/Integer.java#l959)，
* [Long](https://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/Long.java#l1060)。

:::caution
该哈希函数性能较低。
仅在该算法已在其他系统中使用且需要计算相同结果时才使用它。
:::

:::note
Java 仅支持计算有符号整数的哈希值，
因此如果需要计算无符号整数的哈希值，必须先将它们转换（cast）为相应的有符号 ClickHouse 类型。
:::

**语法**

```sql
javaHash(arg)
```

**参数**

* `arg` — 要进行哈希运算的输入值。[`Any`](/sql-reference/data-types)

**返回值**

返回 `arg` 的哈希值 [`Int32`](/sql-reference/data-types/int-uint)

**示例**

**用法示例 1**

```sql title=Query
SELECT javaHash(toInt32(123));
```

```response title=Response
┌─javaHash(toInt32(123))─┐
│               123      │
└────────────────────────┘
```

**使用示例 2**

```sql title=Query
SELECT javaHash('Hello, world!');
```

```response title=Response
┌─javaHash('Hello, world!')─┐
│               -1880044555 │
└───────────────────────────┘
```

## javaHashUTF16LE \{#javaHashUTF16LE\}

引入版本：v20.1

从字符串计算其 [JavaHash](http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/String.java#l1452)，假定该字符串的字节内容表示为 UTF-16LE 编码的字符串。

**语法**

```sql
javaHashUTF16LE(arg)
```

**参数**

* `arg` — 使用 UTF-16LE 编码的字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回 UTF-16LE 编码字符串计算得到的哈希值。[`Int32`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT javaHashUTF16LE(convertCharset('test', 'utf-8', 'utf-16le'));
```

```response title=Response
┌─javaHashUTF16LE(convertCharset('test', 'utf-8', 'utf-16le'))─┐
│                                                      3556498 │
└──────────────────────────────────────────────────────────────┘
```

## jumpConsistentHash \{#jumpConsistentHash\}

自 v1.1 起引入

计算整数的 [jump consistent hash](https://arxiv.org/pdf/1406.2294.pdf)。

**语法**

```sql
jumpConsistentHash(key, buckets)
```

**参数**

* `key` — 输入的 key。[`UInt64`](/sql-reference/data-types/int-uint)
* `buckets` — 桶的数量。[`Int32`](/sql-reference/data-types/int-uint)

**返回值**

返回计算得到的哈希值。[`Int32`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT jumpConsistentHash(256, 4)
```

```response title=Response
┌─jumpConsistentHash(256, 4)─┐
│                          3 │
└────────────────────────────┘
```

## kafkaMurmurHash \{#kafkaMurmurHash\}

引入于：v23.4

使用与 [Kafka](https://github.com/apache/kafka/blob/461c5cfe056db0951d9b74f5adc45973670404d7/clients/src/main/java/org/apache/kafka/common/utils/Utils.java#L482) 相同的种子计算输入值的 32 位 [MurmurHash2](https://github.com/aappleby/smhasher) 哈希值，并清除最高位，以便与 [Default Partitioner](https://github.com/apache/kafka/blob/139f7709bd3f5926901a21e55043388728ccca78/clients/src/main/java/org/apache/kafka/clients/producer/internals/BuiltInPartitioner.java#L328) 兼容。

**语法**

```sql
kafkaMurmurHash(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 要计算哈希值的一组参数，参数个数可变。[`Any`](/sql-reference/data-types)

**返回值**

返回对输入参数计算得到的哈希值。[`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT
    kafkaMurmurHash('foobar') AS res1,
    kafkaMurmurHash(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS res2
```

```response title=Response
┌───────res1─┬─────res2─┐
│ 1357151166 │ 85479775 │
└────────────┴──────────┘
```

## keccak256 \{#keccak256\}

引入版本：v25.4

计算给定字符串的 Keccak-256 密码学哈希值。
此哈希函数在区块链应用中被广泛使用，尤其是在以太坊（Ethereum）中。

**语法**

```sql
keccak256(message)
```

**参数**

* `message` — 要进行哈希计算的输入字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回输入字符串的 32 字节 Keccak-256 哈希值，作为定长字符串。[`FixedString(32)`](/sql-reference/data-types/fixedstring)

**示例**

**用法示例**

```sql title=Query
SELECT hex(keccak256('hello'))
```

```response title=Response
┌─hex(keccak256('hello'))──────────────────────────────────────────┐
│ 1C8AFF950685C2ED4BC3174F3472287B56D9517B9C948127319A09A7A36DEAC8 │
└──────────────────────────────────────────────────────────────────┘
```

## kostikConsistentHash \{#kostikConsistentHash\}

引入版本：v22.6

由 Konstantin &#39;Kostik&#39; Oblakov 提出的时间和空间复杂度均为 O(1) 的一致性哈希算法。
仅当 `n <= 32768` 时效率较高。

**语法**

```sql
kostikConsistentHash(input, n)
```

**别名**: `yandexConsistentHash`

**参数**

* `input` — 整型键。[`UInt64`](/sql-reference/data-types/int-uint)
* `n` — 桶的数量。[`UInt16`](/sql-reference/data-types/int-uint)

**返回值**

返回计算得到的哈希值。[`UInt16`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT kostikConsistentHash(16045690984833335023, 2);
```

```response title=Response
┌─kostikConsistentHash(16045690984833335023, 2)─┐
│                                             1 │
└───────────────────────────────────────────────┘
```

## metroHash64 \{#metroHash64\}

引入版本：v1.1

生成一个 64 位的 [MetroHash](http://www.jandrewrogers.com/2015/05/27/metrohash/) 哈希值。

:::note
当参数类型不同但输入值相同时，计算出的哈希值可能相同。
例如，这种情况会出现在不同大小的整数类型、具有相同数据的命名和未命名 `Tuple`、以及具有相同数据的 `Map` 与对应的 `Array(Tuple(key, value))` 类型中。
:::

**语法**

```sql
metroHash64(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 若干个用于计算哈希的输入参数。[`Any`](/sql-reference/data-types)

**返回值**

返回对输入参数计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT metroHash64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS MetroHash, toTypeName(MetroHash) AS type;
```

```response title=Response
┌────────────MetroHash─┬─type───┐
│ 14235658766382344533 │ UInt64 │
└──────────────────────┴────────┘
```

## murmurHash2_32 \{#murmurHash2_32\}

引入于：v18.5

计算输入值的 [MurmurHash2](https://github.com/aappleby/smhasher) 哈希值。

:::note
对于不同参数类型的相同输入值，计算得到的哈希值可能相同。
例如，这会影响不同大小的整数类型、具有相同数据的具名和未具名 `Tuple`，以及具有相同数据的 `Map` 和对应的 `Array(Tuple(key, value))` 类型。
:::

**语法**

```sql
murmurHash2_32(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 若干个用于计算哈希的输入参数，数量可变。[`Any`](/sql-reference/data-types)

**返回值**

返回对输入参数计算得到的哈希值。[`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT murmurHash2_32(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS MurmurHash2, toTypeName(MurmurHash2) AS type;
```

```response title=Response
┌─MurmurHash2─┬─type───┐
│  3681770635 │ UInt32 │
└─────────────┴────────┘
```

## murmurHash2_64 \{#murmurHash2_64\}

引入自：v18.10

计算输入值的 [MurmurHash2](https://github.com/aappleby/smhasher) 哈希值。

:::note
对于不同参数类型但具有相同输入值的情况，计算得到的哈希值可能相同。
例如，这会影响到不同大小的整数类型、包含相同数据的命名和未命名 `Tuple`，以及包含相同数据的 `Map` 和其对应的 `Array(Tuple(key, value))` 类型。
:::

**语法**

```sql
murmurHash2_64(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 数量可变的输入参数，用于计算哈希值。[`Any`](/sql-reference/data-types)

**返回值**

返回根据输入参数计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT murmurHash2_64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS MurmurHash2, toTypeName(MurmurHash2) AS type;
```

```response title=Response
┌──────────MurmurHash2─┬─type───┐
│ 11832096901709403633 │ UInt64 │
└──────────────────────┴────────┘
```

## murmurHash3_128 \{#murmurHash3_128\}

自 v18.10 引入

计算输入值的 128 位 [MurmurHash3](https://github.com/aappleby/smhasher) 哈希值。

**语法**

```sql
murmurHash3_128(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 用于计算哈希值的可变数量输入参数。[`Any`](/sql-reference/data-types)

**返回值**

返回对输入参数计算得到的 128 位 `MurmurHash3` 哈希值。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**示例**

**用法示例**

```sql title=Query
SELECT hex(murmurHash3_128('foo', 'foo', 'foo'));
```

```response title=Response
┌─hex(murmurHash3_128('foo', 'foo', 'foo'))─┐
│ F8F7AD9B6CD4CF117A71E277E2EC2931          │
└───────────────────────────────────────────┘
```

## murmurHash3_32 \{#murmurHash3_32\}

引入于：v18.10

生成一个 [MurmurHash3](https://github.com/aappleby/smhasher) 哈希值。

:::note
对于不同参数类型的相同输入值，计算得到的哈希值可能会相同。
例如，这会影响不同大小的整数类型、具有相同数据的已命名和未命名 `Tuple`，以及具有相同数据的 `Map` 与其对应的 `Array(Tuple(key, value))` 类型。
:::

**语法**

```sql
murmurHash3_32(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 数量可变的输入参数，用于计算哈希值。[`Any`](/sql-reference/data-types)

**返回值**

返回根据输入参数计算得到的哈希值。[`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT murmurHash3_32(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS MurmurHash3, toTypeName(MurmurHash3) AS type;
```

```response title=Response
┌─MurmurHash3─┬─type───┐
│     2152717 │ UInt32 │
└─────────────┴────────┘
```

## murmurHash3_64 \{#murmurHash3_64\}

自 v18.10 起提供

计算输入值的 [MurmurHash3](https://github.com/aappleby/smhasher) 哈希值。

:::note
对于不同参数类型但相同输入值的情况，计算得到的哈希值可能相同。
例如，这会影响不同大小的整数类型、包含相同数据的具名和非具名 `Tuple`，以及包含相同数据的 `Map` 与对应的 `Array(Tuple(key, value))` 类型。
:::

**语法**

```sql
murmurHash3_64(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 数量不定的输入参数，用于计算哈希值。[`Any`](/sql-reference/data-types)

**返回值**

返回对输入参数计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT murmurHash3_64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS MurmurHash3, toTypeName(MurmurHash3) AS type;
```

```response title=Response
┌──────────MurmurHash3─┬─type───┐
│ 11832096901709403633 │ UInt64 │
└──────────────────────┴────────┘
```

## ngramMinHash \{#ngramMinHash\}

引入版本：v21.1

将一个 ASCII 字符串按 `ngramsize` 个字符拆分为 n-gram，并为每个 n-gram 计算哈希值，然后返回包含这些哈希值的元组。
使用 `hashnum` 个最小哈希来计算最小哈希，并使用 `hashnum` 个最大哈希来计算最大哈希。
区分大小写。

可以与 [`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) 一起用于检测近似重复字符串。
对于两个字符串，如果两个字符串返回的哈希完全相同，那么这两个字符串就是相同的。

**语法**

```sql
ngramMinHash(string[, ngramsize, hashnum])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 可选。n-gram 的长度，取值为从 `1` 到 `25` 的任意整数。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希值的数量，取值为从 `1` 到 `25` 的任意整数。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个包含两个哈希值的元组——最小值和最大值。[`Tuple`](/sql-reference/data-types/tuple)

**示例**

**用法示例**

```sql title=Query
SELECT ngramMinHash('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────┐
│ (18333312859352735453,9054248444481805918) │
└────────────────────────────────────────────┘
```

## ngramMinHashArg \{#ngramMinHashArg\}

引入于：v21.1

将 ASCII 字符串按 `ngramsize` 个字符拆分为 n-gram（n 元语法），并返回哈希值最小和最大的 n-gram，这些哈希值由使用相同输入的 [`ngramMinHash`](#ngramMinHash) 函数计算得到。
区分大小写。

**语法**

```sql
ngramMinHashArg(string[, ngramsize, hashnum])
```

**参数**

* `string` — 要计算哈希的字符串。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 可选。n-gram 的大小，取值为 `1` 到 `25` 之间的任意值。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希值的数量，取值为 `1` 到 `25` 之间的任意值。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个包含两个元组的元组，每个内部元组包含 `hashnum` 个 n-gram。[`Tuple(String)`](/sql-reference/data-types/tuple)

**示例**

**用法示例**

```sql title=Query
SELECT ngramMinHashArg('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────────────┐
│ (('ous','ick','lic','Hou','kHo','use'),('Hou','lic','ick','ous','ckH','Cli')) │
└───────────────────────────────────────────────────────────────────────────────┘
```

## ngramMinHashArgCaseInsensitive \{#ngramMinHashArgCaseInsensitive\}

引入版本：v21.1

将一个 ASCII 字符串按 `ngramsize` 个字符拆分为 n-gram，并返回哈希值最小和最大的 n-gram，这些哈希值由 [`ngramMinHashCaseInsensitive`](#ngramMinHashCaseInsensitive) 函数在相同输入下计算得出。
该函数对大小写不敏感。

**语法**

```sql
ngramMinHashArgCaseInsensitive(string[, ngramsize, hashnum])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 可选。n-gram 的大小，取值范围为 `1` 到 `25` 的任意整数。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小/最大哈希数量，取值范围为 `1` 到 `25` 的任意整数。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个元组，其中包含两个元组，每个元组包含 `hashnum` 个 n-gram。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**示例**

**用法示例**

```sql title=Query
SELECT ngramMinHashArgCaseInsensitive('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────────────┐
│ (('ous','ick','lic','kHo','use','Cli'),('kHo','lic','ick','ous','ckH','Hou')) │
└───────────────────────────────────────────────────────────────────────────────┘
```

## ngramMinHashArgCaseInsensitiveUTF8 \{#ngramMinHashArgCaseInsensitiveUTF8\}

引入版本：v21.1

将 UTF-8 字符串拆分为由 `ngramsize` 个字符组成的 n-gram，并返回哈希值最小和最大的 n-gram，这些哈希值由使用相同输入的 ngramMinHashCaseInsensitiveUTF8 函数计算得到。
该函数不区分大小写。

**语法**

```sql
ngramMinHashArgCaseInsensitiveUTF8(string[, ngramsize, hashnum])
```

**参数**

* `string` — 要计算哈希的字符串。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 可选。n-gram 的长度，取值范围为 `1` 到 `25`，默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希数，取值范围为 `1` 到 `25`，默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个元组，其中包含两个元组，每个内部元组各包含 `hashnum` 个 n-gram。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**示例**

**使用示例**

```sql title=Query
SELECT ngramMinHashArgCaseInsensitiveUTF8('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────────────┐
│ (('ckH','ous','ick','lic','kHo','use'),('kHo','lic','ick','ous','ckH','Hou')) │
└───────────────────────────────────────────────────────────────────────────────┘
```

## ngramMinHashArgUTF8 \{#ngramMinHashArgUTF8\}

引入版本：v21.1

将 UTF-8 字符串拆分为由 `ngramsize` 个字符组成的 n-gram，并返回哈希值最小和最大的 n-gram，这些哈希值是通过对相同输入调用 `ngramMinHashUTF8` 函数计算得到的。
该函数区分大小写。

**语法**

```sql
ngramMinHashArgUTF8(string[, ngramsize, hashnum])
```

**参数**

* `string` — 要计算哈希的字符串。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 可选。n-gram 的大小，取值为 `1` 到 `25` 之间的任意整数，默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小哈希和最大哈希的数量，取值为 `1` 到 `25` 之间的任意整数，默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个元组，内含两个元组，每个元组包含 `hashnum` 个 n-gram。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**示例**

**使用示例**

```sql title=Query
SELECT ngramMinHashArgUTF8('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────────────┐
│ (('ous','ick','lic','Hou','kHo','use'),('kHo','Hou','lic','ick','ous','ckH')) │
└───────────────────────────────────────────────────────────────────────────────┘
```

## ngramMinHashCaseInsensitive \{#ngramMinHashCaseInsensitive\}

引入于：v21.1

将一个 ASCII 字符串按长度为 `ngramsize` 的 n-gram 拆分，并计算每个 n-gram 的哈希值，返回包含这些哈希值的元组。
使用 `hashnum` 个最小哈希来计算最小哈希，使用 `hashnum` 个最大哈希来计算最大哈希。
大小写不敏感。

可与 [`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) 一起用于检测近似重复的字符串。
对于两个字符串，如果返回的哈希都完全相同，则可以认为这两个字符串是相同的。

**语法**

```sql
ngramMinHashCaseInsensitive(string[, ngramsize, hashnum])
```

**参数**

* `string` — 字符串。[String](../data-types/string.md)。- `ngramsize` — n-gram 的大小。可选。可能的取值：从 `1` 到 `25` 的任意整数。默认值：`3`。[UInt8](../data-types/int-uint.md)。- `hashnum` — 用于计算结果的最小和最大哈希值的数量。可选。可能的取值：从 `1` 到 `25` 的任意整数。默认值：`6`。[UInt8](../data-types/int-uint.md)。

**返回值**

包含两个哈希值的 Tuple——最小值和最大值。[Tuple](../data-types/tuple.md)([UInt64](../data-types/int-uint.md), [UInt64](../data-types/int-uint.md)). [`Tuple`](/sql-reference/data-types/tuple)

**示例**

**用法示例**

```sql title=Query
SELECT ngramMinHashCaseInsensitive('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────┐
│ (2106263556442004574,13203602793651726206) │
└────────────────────────────────────────────┘
```

## ngramMinHashCaseInsensitiveUTF8 \{#ngramMinHashCaseInsensitiveUTF8\}

引入版本：v21.1

将 UTF-8 字符串按 `ngramsize` 个符号拆分为 n-gram，为每个 n-gram 计算哈希值，并返回包含这些哈希的元组。
使用 `hashnum` 个最小哈希来计算最小哈希，使用 `hashnum` 个最大哈希来计算最大哈希。
该函数不区分大小写。

可与 [`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) 一起使用以检测近似重复的字符串。
对于两个字符串，如果返回的哈希完全相同，则认为这两个字符串是相同的。

**语法**

```sql
ngramMinHashCaseInsensitiveUTF8(string [, ngramsize, hashnum])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 可选。n-gram 的长度，取值范围为 `1` 到 `25`。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希值的数量，取值范围为 `1` 到 `25`。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个包含两个哈希值的元组——最小哈希值和最大发电哈希值。[`Tuple`](/sql-reference/data-types/tuple)

**示例**

**使用示例**

```sql title=Query
SELECT ngramMinHashCaseInsensitiveUTF8('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple───────────────────────────────────────┐
│ (12493625717655877135,13203602793651726206) │
└─────────────────────────────────────────────┘
```

## ngramMinHashUTF8 \{#ngramMinHashUTF8\}

引入版本：v21.1

将 UTF-8 字符串按 `ngramsize` 个字符拆分成 n-gram，为每个 n-gram 计算哈希值，并返回包含这些哈希值的元组。
使用 `hashnum` 个最小哈希来计算最小哈希，并使用 `hashnum` 个最大哈希来计算最大哈希。
区分大小写。

可与 [`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) 一起用于检测近似重复的字符串。
对于两个字符串，如果两个字符串返回的哈希相同，则这两个字符串被视为相同。

**语法**

```sql
ngramMinHashUTF8(string[, ngramsize, hashnum])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 可选。n-gram 的大小，取值为 `1` 到 `25` 之间的任意整数。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希值数量，取值为 `1` 到 `25` 之间的任意整数。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个包含两个哈希值（最小值和最大值）的元组。[`Tuple`](/sql-reference/data-types/tuple)

**示例**

**用法示例**

```sql title=Query
SELECT ngramMinHashUTF8('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────┐
│ (18333312859352735453,6742163577938632877) │
└────────────────────────────────────────────┘
```

## ngramSimHash \{#ngramSimHash\}

引入版本：v21.1

将一个 ASCII 字符串按 `ngramsize` 个字符拆分为 n-gram，并返回该 n-gram 的 `simhash`。

可与 [`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) 一起用于检测近似重复字符串。两字符串计算得到的 `simhash` 值之间的 [Hamming 距离](https://en.wikipedia.org/wiki/Hamming_distance) 越小，这两个字符串相同的可能性就越大。

**语法**

```sql
ngramSimHash(string[, ngramsize])
```

**参数**

* `string` — 要计算区分大小写的 `simhash` 的字符串。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 可选。n-gram 的长度，取值范围为 `1` 到 `25` 之间的任意整数。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回为输入字符串计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT ngramSimHash('ClickHouse') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 1627567969 │
└────────────┘
```

## ngramSimHashCaseInsensitive \{#ngramSimHashCaseInsensitive\}

引入版本：v21.1

将一个 ASCII 字符串拆分为由 `ngramsize` 个字符组成的 n-gram，并返回这些 n-gram 的 `simhash`。
大小写不敏感。

可结合 [`bitHammingDistance`](/sql-reference/functions/bit-functions#bitHammingDistance) 用于检测近似重复的字符串。
两个字符串计算得到的 `simhashes` 的 [汉明距离](https://en.wikipedia.org/wiki/Hamming_distance) 越小，这两个字符串相同的可能性就越大。

**语法**

```sql
ngramSimHashCaseInsensitive(string[, ngramsize])
```

**参数**

* `string` — 需要计算不区分大小写 `simhash` 的字符串。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 可选。n-gram 的长度，取值为 `1` 到 `25` 的任意整数。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

哈希值。[UInt64](../data-types/int-uint.md)。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT ngramSimHashCaseInsensitive('ClickHouse') AS Hash;
```

```response title=Response
┌──────Hash─┐
│ 562180645 │
└───────────┘
```

## ngramSimHashCaseInsensitiveUTF8 \{#ngramSimHashCaseInsensitiveUTF8\}

引入于：v21.1

将 UTF-8 字符串拆分为由 `ngramsize` 个字符组成的 n-gram，并返回这些 n-gram 的 `simhash` 值。
该函数对大小写不敏感。

可配合 [bitHammingDistance](../functions/bit-functions.md/#bitHammingDistance) 用于检测近似重复字符串。两个字符串计算得到的 `simhashes` 之间的 [Hamming Distance](https://en.wikipedia.org/wiki/Hamming_distance) 越小，这两个字符串相同的可能性越大。

**语法**

```sql
ngramSimHashCaseInsensitiveUTF8(string[, ngramsize])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 可选参数。n-gram 的长度，取值范围为 `1` 到 `25`，默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT ngramSimHashCaseInsensitiveUTF8('ClickHouse') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 1636742693 │
└────────────┘
```

## ngramSimHashUTF8 \{#ngramSimHashUTF8\}

引入版本：v21.1

将一个 UTF-8 编码的字符串拆分为由 `ngramsize` 个字符组成的 n-gram，并返回该 n-gram 的 `simhash` 值。
该函数区分大小写。

可结合 [`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) 用于检测近似重复字符串。
两个字符串计算得到的 `simhashes` 之间的 [Hamming 距离](https://en.wikipedia.org/wiki/Hamming_distance) 越小，这两个字符串相同的可能性就越高。

**语法**

```sql
ngramSimHashUTF8(string[, ngramsize])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 可选。n-gram 的大小，取值范围为 `1` 到 `25` 的任意数值，默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT ngramSimHashUTF8('ClickHouse') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 1628157797 │
└────────────┘
```

## sipHash128 \{#sipHash128\}

引入版本：v1.1

与 [`sipHash64`](#sipHash64) 类似，但会生成 128 位哈希值，即最终的异或折叠（xor-folding）操作会进行到 128 位。

:::tip 新项目请使用 `sipHash128Reference`
这个 128 位变种与参考实现不同，安全性更弱。
该版本存在的原因是：在其编写时，SipHash 尚没有官方的 128 位扩展。
新项目建议使用 [`sipHash128Reference`](#sipHash128Reference)。
:::

**语法**

```sql
sipHash128(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 要计算哈希值的数量可变的输入参数。[`Any`](/sql-reference/data-types)

**返回值**

返回一个 128 位的 `SipHash` 哈希值。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**示例**

**用法示例**

```sql title=Query
SELECT hex(sipHash128('foo', '\x01', 3));
```

```response title=Response
┌─hex(sipHash128('foo', '', 3))────┐
│ 9DE516A64A414D4B1B609415E4523F24 │
└──────────────────────────────────┘
```

## sipHash128Keyed \{#sipHash128Keyed\}

引入版本：v23.2

与 [`sipHash128`](#sipHash128) 相同，但额外接受一个显式密钥参数，而不是使用固定密钥。

:::tip 新项目请使用 sipHash128ReferenceKeyed
这个 128 位变体与参考实现不同，安全性更弱。
之所以存在这个版本，是因为在它编写时，SipHash 还没有官方的 128 位扩展。
新项目应优先使用 [`sipHash128ReferenceKeyed`](#sipHash128ReferenceKeyed)。
:::

**语法**

```sql
sipHash128Keyed((k0, k1), [arg1, arg2, ...])
```

**参数**

* `(k0, k1)` — 由两个 UInt64 值组成、表示密钥的元组。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)
* `arg1[, arg2, ...]` — 需要计算哈希值的一组可变数量的输入参数。[`Any`](/sql-reference/data-types)

**返回值**

类型为 [FixedString(16)](../data-types/fixedstring.md) 的 128 位 `SipHash` 哈希值。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**示例**

**用法示例**

```sql title=Query
SELECT hex(sipHash128Keyed((506097522914230528, 1084818905618843912),'foo', '\x01', 3));
```

```response title=Response
┌─hex(sipHash128Keyed((506097522914230528, 1084818905618843912), 'foo', '', 3))─┐
│ B8467F65C8B4CFD9A5F8BD733917D9BF                                              │
└───────────────────────────────────────────────────────────────────────────────┘
```

## sipHash128Reference \{#sipHash128Reference\}

引入版本：v23.2

类似于 [`sipHash128`](/sql-reference/functions/hash-functions#sipHash128)，但实现的是 SipHash 原作者提出的 128 位算法。

**语法**

```sql
sipHash128Reference(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 用于计算哈希的数量不定的输入参数。[`Any`](/sql-reference/data-types)

**返回值**

返回对输入参数计算得到的 128 位 `SipHash` 哈希值。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**示例**

**使用示例**

```sql title=Query
SELECT hex(sipHash128Reference('foo', '', 3));
```

```response title=Response
┌─hex(sipHash128Reference('foo', '', 3))─┐
│ 4D1BE1A22D7F5933C0873E1698426260       │
└────────────────────────────────────────┘
```

## sipHash128ReferenceKeyed \{#sipHash128ReferenceKeyed\}

引入于：v23.2

与 [`sipHash128Reference`](#sipHash128Reference) 相同，但此外还接收一个显式的密钥参数，而不是使用固定密钥。

**语法**

```sql
sipHash128ReferenceKeyed((k0, k1), arg1[, arg2, ...])
```

**参数**

* `(k0, k1)` — 由两个值组成的元组，用于表示密钥。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)
* `arg1[, arg2, ...]` — 需要计算哈希的数量可变的输入参数列表。[`Any`](/sql-reference/data-types)

**返回值**

返回对输入参数计算得到的 128 位 `SipHash` 哈希值。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**示例**

**使用示例**

```sql title=Query
SELECT hex(sipHash128Reference('foo', '', 3));
```

```response title=Response
┌─hex(sipHash128Reference('foo', '', 3))─┐
│ 4D1BE1A22D7F5933C0873E1698426260       │
└────────────────────────────────────────┘
```

## sipHash64 \{#sipHash64\}

引入版本：v1.1

生成一个 64 位的 [SipHash](https://en.wikipedia.org/wiki/SipHash) 哈希值。

这是一个密码学哈希函数。它的速度至少比 [`MD5`](#MD5) 哈希函数快 3 倍。

该函数会将所有输入参数[重新解释](/sql-reference/functions/type-conversion-functions#reinterpretAsString)为字符串，并为每个参数计算哈希值。
然后使用以下算法组合这些哈希值：

1. 将第一个和第二个哈希值拼接成一个数组并对其进行哈希。
2. 将前一步计算得到的哈希值与第三个输入参数的哈希值以相同方式再进行一次哈希。
3. 对原始输入的所有剩余哈希值重复此计算。

:::note
对于不同参数类型但具有相同输入值的情况，计算出的哈希值可能相同。
例如，这会影响不同大小的整数类型、具有相同数据的具名和非具名 `Tuple`，以及具有相同数据的 `Map` 与对应的 `Array(Tuple(key, value))` 类型。
:::

**语法**

```sql
sipHash64(arg1[, arg2, ...])
```

**参数**

* `arg1[, arg2, ...]` — 可变数量的输入参数。[`Any`](/sql-reference/data-types)

**返回值**

返回根据输入参数计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT sipHash64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS SipHash, toTypeName(SipHash) AS type;
```

```response title=Response
┌──────────────SipHash─┬─type───┐
│ 11400366955626497465 │ UInt64 │
└──────────────────────┴────────┘
```

## sipHash64Keyed \{#sipHash64Keyed\}

引入版本：v23.2

类似于 [`sipHash64`](#sipHash64)，但还需要显式提供一个密钥参数，而不是使用固定密钥。

**语法**

```sql
sipHash64Keyed((k0, k1), arg1[,arg2, ...])
```

**参数**

* `(k0, k1)` — 由两个值组成、表示键的元组。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)
* `arg1[,arg2, ...]` — 数量可变的输入参数。[`Any`](/sql-reference/data-types)

**返回值**

返回对输入值计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT sipHash64Keyed((506097522914230528, 1084818905618843912), array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS SipHash, toTypeName(SipHash) AS type;
```

```response title=Response
┌─────────────SipHash─┬─type───┐
│ 8017656310194184311 │ UInt64 │
└─────────────────────┴────────┘
```

## wordShingleMinHash \{#wordShingleMinHash\}

引入版本：v21.1

将一个 ASCII 字符串拆分为由 `shinglesize` 个单词组成的分区片段（shingles），为每个 shingle 计算哈希值，并返回一个包含这些哈希值的 tuple。
使用 `hashnum` 个最小哈希值来计算最小哈希，使用 `hashnum` 个最大哈希值来计算最大哈希。
大小写敏感。

可与 [`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) 一起使用来检测近似重复字符串。
对于两个字符串，如果它们返回的哈希值完全相同，则这两个字符串相同。

**语法**

```sql
wordShingleMinHash(string[, shinglesize, hashnum])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。word shingle（词片段）的大小，取值范围为 `1` 到 `25`。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希的数量，取值范围为 `1` 到 `25`。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个包含两个哈希的元组——最小值和最大值。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)

**示例**

**用法示例**

```sql title=Query
SELECT wordShingleMinHash('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).') AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────┐
│ (16452112859864147620,5844417301642981317) │
└────────────────────────────────────────────┘
```

## wordShingleMinHashArg \{#wordShingleMinHashArg\}

引入版本：v1.1

将一个 ASCII 字符串拆分为由 `shinglesize` 个单词组成的分区片段（shingles），并返回其中单词哈希值最小和最大的 shingles，这些哈希值由在相同输入下调用 wordShingleMinHash 函数计算得出。
该函数区分大小写。

**语法**

```sql
wordShingleMinHashArg(string[, shinglesize, hashnum])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。word shingle 的大小，取值为 `1` 到 `25` 之间的任意整数。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希的数量，取值为 `1` 到 `25` 之间的任意整数。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个元组，其中包含两个元组，每个元组包含 `hashnum` 个 word shingle。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**示例**

**用法示例**

```sql title=Query
SELECT wordShingleMinHashArg('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).', 1, 3) AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────┐
│ (('OLAP','database','analytical'),('online','oriented','processing')) │
└───────────────────────────────────────────────────────────────────────┘
```

## wordShingleMinHashArgCaseInsensitive \{#wordShingleMinHashArgCaseInsensitive\}

引入版本：v21.1

将一个 ASCII 字符串按每 `shinglesize` 个单词划分为若干分区片段（shingle），并返回其中单词哈希值最小和最大的分区片段。这些哈希值通过使用相同输入的 [`wordShingleMinHashCaseInsensitive`](#wordShingleMinHashCaseInsensitive) 函数计算得到。
该函数不区分大小写。

**语法**

```sql
wordShingleMinHashArgCaseInsensitive(string[, shinglesize, hashnum])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。word shingle 的大小，取值为 `1` 到 `25` 之间的任意整数。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希值的数量，取值为 `1` 到 `25` 之间的任意整数。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个元组，其中包含两个元组，每个元组包含 `hashnum` 个 word shingle。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**示例**

**用法示例**

```sql title=Query
SELECT wordShingleMinHashArgCaseInsensitive('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).', 1, 3) AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────────────────────────────────┐
│ (('queries','database','analytical'),('oriented','processing','DBMS')) │
└────────────────────────────────────────────────────────────────────────┘
```

## wordShingleMinHashArgCaseInsensitiveUTF8 \{#wordShingleMinHashArgCaseInsensitiveUTF8\}

引入版本：v21.1

将 UTF-8 字符串按每 `shinglesize` 个单词拆分为多个分区片段（shingles），并返回其中单词哈希值最小和最大的分区片段，这些哈希值是通过对相同输入调用 [`wordShingleMinHashCaseInsensitiveUTF8`](#wordShingleMinHashCaseInsensitiveUTF8) FUNCTION 计算得到的。
该函数不区分大小写。

**语法**

```sql
wordShingleMinHashArgCaseInsensitiveUTF8(string[, shinglesize, hashnum])
```

**参数**

* `string` — 要计算哈希的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。word shingle（词片段）的大小，取值范围为 `1` 到 `25`。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希数量，取值范围为 `1` 到 `25`。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个元组，其中包含两个元组，每个元组包含 `hashnum` 个 word shingle。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**示例**

**用法示例**

```sql title=Query
SELECT wordShingleMinHashArgCaseInsensitiveUTF8('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).', 1, 3) AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────────────────────────────────┐
│ (('queries','database','analytical'),('oriented','processing','DBMS')) │
└────────────────────────────────────────────────────────────────────────┘
```

## wordShingleMinHashArgUTF8 \{#wordShingleMinHashArgUTF8\}

引入版本：v21.1

将一个 UTF-8 字符串拆分为由 `shinglesize` 个单词构成的分区片段（shingles），并返回在使用相同输入调用 [`wordShingleMinHashUTF8`](#wordShingleMinHashUTF8) 函数时，其最小和最大单词哈希值所对应的 shingles。
该函数区分大小写。

**语法**

```sql
wordShingleMinHashArgUTF8(string[, shinglesize, hashnum])
```

**参数**

* `string` — 计算其哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。word shingle 的大小，取值范围为从 `1` 到 `25` 的任意整数。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希的数量，取值范围为从 `1` 到 `25` 的任意整数。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个包含两个元组的元组，每个元组包含 `hashnum` 个 word shingle。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**示例**

**使用示例**

```sql title=Query
SELECT wordShingleMinHashArgUTF8('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).', 1, 3) AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────┐
│ (('OLAP','database','analytical'),('online','oriented','processing')) │
└───────────────────────────────────────────────────────────────────────┘
```

## wordShingleMinHashCaseInsensitive \{#wordShingleMinHashCaseInsensitive\}

引入版本：v21.1

将一个 ASCII 字符串拆分为由 `shinglesize` 个单词组成的片段（shingles），为每个单词 shingle 计算哈希值，并返回包含这些哈希值的元组。
使用 `hashnum` 个最小哈希来计算最小哈希，使用 `hashnum` 个最大哈希来计算最大哈希。
该函数对大小写不敏感。

可与 [`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) 一起用于检测近似重复字符串。
对于两个字符串，如果返回的哈希值都相同，则可认为这两个字符串相同。

**语法**

```sql
wordShingleMinHashCaseInsensitive(string[, shinglesize, hashnum])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。word shingle（词片段）的大小，取值范围为 `1` 到 `25`。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小哈希和最大哈希的数量，取值范围为 `1` 到 `25`。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个包含两个哈希值的元组——最小哈希和最大哈希。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)

**示例**

**用法示例**

```sql title=Query
SELECT wordShingleMinHashCaseInsensitive('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────┐
│ (3065874883688416519,1634050779997673240) │
└───────────────────────────────────────────┘
```

## wordShingleMinHashCaseInsensitiveUTF8 \{#wordShingleMinHashCaseInsensitiveUTF8\}

引入于：v21.1

将一个 UTF-8 字符串拆分为由 `shinglesize` 个单词组成的分区片段（shingles），为每个 word shingle 计算哈希值，并返回包含这些哈希的元组。
使用 `hashnum` 个最小哈希来计算最小哈希，并使用 `hashnum` 个最大哈希来计算最大哈希。
该函数对大小写不敏感。

可与 [`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) 一起使用来检测近似重复的字符串。
对于两个字符串，如果返回的哈希在两个字符串中完全相同，则认为这两个字符串相同。

**语法**

```sql
wordShingleMinHashCaseInsensitiveUTF8(string[, shinglesize, hashnum])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。词 shingle 的大小，取值为 `1` 到 `25` 之间的任意数值。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希值的数量，取值为 `1` 到 `25` 之间的任意数值。默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个包含两个哈希值的元组 —— 最小哈希值和最大哈希值。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)

**示例**

**使用示例**

```sql title=Query
SELECT wordShingleMinHashCaseInsensitiveUTF8('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────┐
│ (3065874883688416519,1634050779997673240) │
└───────────────────────────────────────────┘
```

## wordShingleMinHashUTF8 \{#wordShingleMinHashUTF8\}

引入版本：v21.1

将一个 UTF-8 字符串拆分为由 `shinglesize` 个单词组成的分区片段（shingles），为每个单词 shingle 计算哈希值，并返回包含这些哈希值的元组。
使用 `hashnum` 个最小哈希来计算最小哈希，使用 `hashnum` 个最大哈希来计算最大哈希。
区分大小写。

可与 [`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) 一起用于检测近似重复字符串。
对于两个字符串，如果返回的哈希值在两者中都完全相同，则这两个字符串相同。

**语法**

```sql
wordShingleMinHashUTF8(string[, shinglesize, hashnum])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。word shingle（词片段）的大小，取值范围为 `1` 到 `25`，默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 可选。用于计算结果的最小和最大哈希值的数量，取值范围为 `1` 到 `25`，默认值为 `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回一个包含两个哈希值（最小值和最大值）的元组。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)

**示例**

**使用示例**

```sql title=Query
SELECT wordShingleMinHashUTF8('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).') AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────┐
│ (16452112859864147620,5844417301642981317) │
└────────────────────────────────────────────┘
```

## wordShingleSimHash \{#wordShingleSimHash\}

引入于：v21.1

将 ASCII 字符串拆分成由 `shinglesize` 个单词组成的片段（shingles），并返回这些单词 shingle 对应的 `simhash` 值。
区分大小写。

可与 [`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) 一起使用，用于检测近似重复的字符串。
两个字符串计算得到的 `simhash` 值之间的[汉明距离](https://en.wikipedia.org/wiki/Hamming_distance)越小，这两个字符串为同一内容的可能性就越大。

**语法**

```sql
wordShingleSimHash(string[, shinglesize])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。word shingle（词片段）的大小，取值为 `1` 到 `25` 之间的任意整数。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT wordShingleSimHash('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 2328277067 │
└────────────┘
```

## wordShingleSimHashCaseInsensitive \{#wordShingleSimHashCaseInsensitive\}

引入于：v21.1

将一个 ASCII 字符串拆分为由 `shinglesize` 个单词组成的片段（shingles），并返回这些词片段的 `simhash`。
该函数对大小写不敏感。

可与 [`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) 一起用于检测近似重复的字符串。
两个字符串计算得到的 `simhashes` 的[汉明距离](https://en.wikipedia.org/wiki/Hamming_distance)越小，这两个字符串相同的可能性就越大。

**语法**

```sql
wordShingleSimHashCaseInsensitive(string[, shinglesize])
```

**参数**

* `string` — 要计算哈希值的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。word shingle 的长度，取值范围为 `1` 到 `25`。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT wordShingleSimHashCaseInsensitive('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 2194812424 │
└────────────┘
```

## wordShingleSimHashCaseInsensitiveUTF8 \{#wordShingleSimHashCaseInsensitiveUTF8\}

引入于：v1.1

将 UTF-8 编码的字符串按 `shinglesize` 个单词划分为 shingles（词片段），并返回这些词片段的 `simhash`。
比较时不区分大小写。

可与 [`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) 一起用于检测近似重复字符串。
两个字符串计算得到的 `simhashes` 的[汉明距离](https://en.wikipedia.org/wiki/Hamming_distance)越小，这两个字符串越有可能相同。

**语法**

```sql
wordShingleSimHashCaseInsensitiveUTF8(string[, shinglesize])
```

**参数**

* `string` — 要计算哈希的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。词 shingle 的大小，取值范围为 `1` 到 `25` 的任意数值。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT wordShingleSimHashCaseInsensitiveUTF8('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 2194812424 │
└────────────┘
```

## wordShingleSimHashUTF8 \{#wordShingleSimHashUTF8\}

引入版本：v21.1

将 UTF-8 字符串按 `shinglesize` 个单词拆分为若干分区片段（shingles），并返回这些单词 shingle 的 `simhash`。
区分大小写。

可与 [`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) 一起用于检测部分重复的字符串。
两个字符串计算得到的 `simhashes` 的[汉明距离](https://en.wikipedia.org/wiki/Hamming_distance)越小，它们相同的可能性就越大。

**语法**

```sql
wordShingleSimHashUTF8(string[, shinglesize])
```

**参数**

* `string` — 要计算哈希的字符串。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 可选。词 shingle（词片）的大小，取值范围为 `1` 到 `25`。默认值为 `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**返回值**

返回计算得到的哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT wordShingleSimHashUTF8('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 2328277067 │
└────────────┘
```

## wyHash64 \{#wyHash64\}

自 v22.7 起引入。

计算 64 位 [wyHash64](https://github.com/wangyi-fudan/wyhash) 哈希值。

**语法**

```sql
wyHash64(arg)
```

**参数**

* `arg` — 要计算哈希值的字符串参数。[`String`](/sql-reference/data-types/string)

**返回值**

返回计算得到的 64 位哈希值，类型为 [`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT wyHash64('ClickHouse') AS Hash;
```

```response title=Response
12336419557878201794
```

## xxHash32 \{#xxHash32\}

引入版本：v20.1

计算字符串的 [xxHash](http://cyan4973.github.io/xxHash/)。

64 位版本请参阅 [`xxHash64`](#xxHash64)。

**语法**

```sql
xxHash32(arg)
```

**参数**

* `arg` — 待进行哈希计算的输入字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回输入字符串计算得到的 32 位哈希值。[`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT xxHash32('Hello, world!');
```

```response title=Response
┌─xxHash32('Hello, world!')─┐
│                 834093149 │
└───────────────────────────┘
```

## xxHash64 \{#xxHash64\}

自 v20.1 引入

根据字符串计算一个 [xxHash](http://cyan4973.github.io/xxHash/)。

32 位版本请参阅 [`xxHash32`](#xxHash32)

**语法**

```sql
xxHash64(arg)
```

**参数**

* `arg` — 要进行哈希计算的输入字符串。[`String`](/sql-reference/data-types/string)

**返回值**

返回输入字符串计算得到的 64 位哈希值。[`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT xxHash64('Hello, world!');
```

```response title=Response
┌─xxHash64('Hello, world!')─┐
│      17691043854468224118 │
└───────────────────────────┘
```

## xxh3 \{#xxh3\}

自 v22.12 引入

计算一个 [XXH3](https://github.com/Cyan4973/xxHash) 64 位哈希值。

**语法**

```sql
xxh3(expr)
```

**参数**

* `expr` — 任意数据类型的表达式列表。[`Any`](/sql-reference/data-types)

**返回值**

返回计算得到的 64 位 `xxh3` 哈希值，类型为 [`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT xxh3('ClickHouse')
```

```response title=Response
18009318874338624809
```

## xxh3_128 \{#xxh3_128\}

首次引入：v26.2

计算 [XXH3](https://github.com/Cyan4973/xxHash) 128 位哈希值。

**语法**

```sql
xxh3_128(expr)
```

**参数**

* `expr` — 任意数据类型的表达式列表。[`Any`](/sql-reference/data-types)

**返回值**

返回计算得到的 128 位 `xxh3` 哈希值 [`UInt128`](/sql-reference/data-types/int-uint)

**示例**

**使用示例**

```sql title=Query
SELECT hex(xxh3_128('ClickHouse'))
```

```response title=Response
3A038784C52804B4DBA43A038784C528
```

{/*AUTOGENERATED_END*/ }
