---
'description': '处理日期和时间的函数的文档'
'sidebar_label': '日期和时间'
'slug': '/sql-reference/functions/date-time-functions'
'title': '处理日期和时间的函数'
'doc_type': 'reference'
---


# 处理日期和时间的函数

本节中的大多数函数接受一个可选的时区参数，例如 `Europe/Amsterdam`。在这种情况下，时区是指定的，而不是本地（默认）时区。

**示例**

```sql
SELECT
    toDateTime('2016-06-15 23:00:00') AS time,
    toDate(time) AS date_local,
    toDate(time, 'Asia/Yekaterinburg') AS date_yekat,
    toString(time, 'US/Samoa') AS time_samoa
```

```text
┌────────────────time─┬─date_local─┬─date_yekat─┬─time_samoa──────────┐
│ 2016-06-15 23:00:00 │ 2016-06-15 │ 2016-06-16 │ 2016-06-15 09:00:00 │
└─────────────────────┴────────────┴────────────┴─────────────────────┘
```

<!-- 
The inner content of the tags below are replaced at doc framework build time with 
docs generated from system.functions. Please do not modify or remove the tags.
See: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
-->

<!--AUTOGENERATED_START-->
## UTCTimestamp {#UTCTimestamp}

引入于：v22.11


返回查询分析时的当前日期和时间。该函数是一个常量表达式。

这个函数给出的结果与 `now('UTC')` 相同。该函数仅为支持 MySQL 而添加。[`now`](#now) 是推荐的用法。
    

**语法**

```sql
UTCTimestamp()
```

**参数**

- 无。
**返回值**

返回查询分析时的当前日期和时间。 [`DateTime`](/sql-reference/data-types/datetime)

**示例**

**获取当前 UTC 时间戳**

```sql title=Query
SELECT UTCTimestamp()
```

```response title=Response
┌──────UTCTimestamp()─┐
│ 2024-05-28 08:32:09 │
└─────────────────────┘
```
## YYYYMMDDToDate {#YYYYMMDDToDate}

引入于：v23.9


将包含年份、月份和日期的数字转换为一个 `Date`。
此函数是函数 [`toYYYYMMDD()`](/sql-reference/functions/date-time-functions#toYYYYMMDD) 的反向操作。
如果输入不编码有效的日期值，则输出未定义。
    

**语法**

```sql
YYYYMMDDToDate(YYYYMMDD)
```

**参数**

- `YYYYMMDD` — 包含年份、月份和日期的数字。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)


**返回值**

根据提供的参数返回一个 `Date` 值 [`Date`](/sql-reference/data-types/date)

**示例**

**示例**

```sql title=Query
SELECT YYYYMMDDToDate(20230911);
```

```response title=Response
┌─toYYYYMMDD(20230911)─┐
│           2023-09-11 │
└──────────────────────┘
```
## YYYYMMDDToDate32 {#YYYYMMDDToDate32}

引入于：v23.9


将包含年份、月份和日期的数字转换为一个 `Date32`。
此函数是函数 [`toYYYYMMDD()`](/sql-reference/functions/date-time-functions#toYYYYMMDD) 的反向操作。
如果输入不编码有效的 `Date32` 值，则输出未定义。
    

**语法**

```sql
YYYYMMDDToDate32(YYYYMMDD)
```

**参数**

- `YYYYMMDD` — 包含年份、月份和日期的数字。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)


**返回值**

根据提供的参数返回一个 `Date32` 值 [`Date32`](/sql-reference/data-types/date32)

**示例**

**示例**

```sql title=Query
SELECT YYYYMMDDToDate32(20000507);
```

```response title=Response
┌─YYYYMMDDToDate32(20000507)─┐
│                 2000-05-07 │
└────────────────────────────┘
```
## YYYYMMDDhhmmssToDateTime {#YYYYMMDDhhmmssToDateTime}

引入于：v23.9


将包含年份、月份、日期、小时、分钟和秒的数字转换为一个 `DateTime`。
此函数是函数 [`toYYYYMMDDhhmmss()`](/sql-reference/functions/date-time-functions#toYYYYMMDDhhmmss) 的反向操作。
如果输入不编码有效的 `DateTime` 值，则输出未定义。
    

**语法**

```sql
YYYYMMDDhhmmssToDateTime(YYYYMMDDhhmmss[, timezone])
```

**参数**

- `YYYYMMDDhhmmss` — 包含年份、月份、日期、小时、分钟和秒的数字。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `timezone` — 时区名称。 [`String`](/sql-reference/data-types/string)


**返回值**

根据提供的参数返回一个 `DateTime` 值 [`DateTime`](/sql-reference/data-types/datetime)

**示例**

**示例**

```sql title=Query
SELECT YYYYMMDDToDateTime(20230911131415);
```

```response title=Response
┌──────YYYYMMDDhhmmssToDateTime(20230911131415)─┐
│                           2023-09-11 13:14:15 │
└───────────────────────────────────────────────┘
```
## YYYYMMDDhhmmssToDateTime64 {#YYYYMMDDhhmmssToDateTime64}

引入于：v23.9


将包含年份、月份、日期、小时、分钟和秒的数字转换为一个 `DateTime64`。
此函数是函数 [`toYYYYMMDDhhmmss()`](/sql-reference/functions/date-time-functions#toYYYYMMDDhhmmss) 的反向操作。
如果输入不编码有效的 `DateTime64` 值，则输出未定义。
    

**语法**

```sql
YYYYMMDDhhmmssToDateTime64(YYYYMMDDhhmmss[, precision[, timezone]])
```

**参数**

- `YYYYMMDDhhmmss` — 包含年份、月份、日期、小时、分钟和秒的数字。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `precision` — 小数部分的精度（0-9）。 [`UInt8`](/sql-reference/data-types/int-uint)
- `timezone` — 时区名称。 [`String`](/sql-reference/data-types/string)


**返回值**

根据提供的参数返回一个 `DateTime64` 值 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**示例**

```sql title=Query
SELECT YYYYMMDDhhmmssToDateTime64(20230911131415, 3, 'Asia/Istanbul');
```

```response title=Response
┌─YYYYMMDDhhmm⋯/Istanbul')─┐
│  2023-09-11 13:14:15.000 │
└──────────────────────────┘
```
## addDate {#addDate}

引入于：v23.9


将时间间隔添加到指定的日期、日期和时间或字符串编码的日期或日期和时间中。
如果添加的结果超出数据类型的边界，则结果未定义。
    

**语法**

```sql
addDate(datetime, interval)
```

**参数**

- `datetime` — 将要添加 `interval` 的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `interval` — 要添加的时间间隔。 [`Interval`](/sql-reference/data-types/int-uint)


**返回值**

返回通过将 `interval` 添加到 `datetime` 得到的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**向日期添加时间间隔**

```sql title=Query
SELECT addDate(toDate('2018-01-01'), INTERVAL 3 YEAR)
```

```response title=Response
┌─addDate(toDa⋯valYear(3))─┐
│               2021-01-01 │
└──────────────────────────┘
```
## addDays {#addDays}

引入于：v1.1


将指定数量的天数添加到日期、带时间的日期或字符串编码的日期或带时间的日期中。
    

**语法**

```sql
addDays(datetime, num)
```

**参数**

- `datetime` — 要添加指定天数的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要添加的天数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)


**返回值**

返回 `datetime` 加 `num` 天后的结果。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**向不同日期类型添加天数**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    addDays(date, 5) AS add_days_with_date,
    addDays(date_time, 5) AS add_days_with_date_time,
    addDays(date_time_string, 5) AS add_days_with_date_time_string
```

```response title=Response
┌─add_days_with_date─┬─add_days_with_date_time─┬─add_days_with_date_time_string─┐
│         2024-01-06 │     2024-01-06 00:00:00 │        2024-01-06 00:00:00.000 │
└────────────────────┴─────────────────────────┴────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateAdd('1998-06-16'::Date, INTERVAL 10 day)
```

```response title=Response
┌─plus(CAST('1⋯valDay(10))─┐
│               1998-06-26 │
└──────────────────────────┘
```
## addHours {#addHours}

引入于：v1.1


将指定数量的小时添加到日期、带时间的日期或字符串编码的日期或带时间的日期中。
    

**语法**

```sql
addHours(datetime, num)
```

**参数**

- `datetime` — 要添加指定小时数的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要添加的小时数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)


**返回值**

返回 `datetime` 加 `num` 小时后的结果 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64(3)`](/sql-reference/data-types/datetime64)

**示例**

**向不同日期类型添加小时**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    addHours(date, 12) AS add_hours_with_date,
    addHours(date_time, 12) AS add_hours_with_date_time,
    addHours(date_time_string, 12) AS add_hours_with_date_time_string
```

```response title=Response
┌─add_hours_with_date─┬─add_hours_with_date_time─┬─add_hours_with_date_time_string─┐
│ 2024-01-01 12:00:00 │      2024-01-01 12:00:00 │         2024-01-01 12:00:00.000 │
└─────────────────────┴──────────────────────────┴─────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateAdd('1998-06-16'::Date, INTERVAL 10 hour)
```

```response title=Response
┌─plus(CAST('1⋯alHour(10))─┐
│      1998-06-16 10:00:00 │
└──────────────────────────┘
```
## addInterval {#addInterval}

引入于：v22.11


将一个间隔添加到另一个间隔或间隔元组中。

:::note
相同类型的间隔将组合成一个单一的间隔。例如，如果传入 `toIntervalDay(1)` 和 `toIntervalDay(2)`，则结果将是 `(3)` 而不是 `(1,1)`。
:::
    

**语法**

```sql
addInterval(interval_1, interval_2)
```

**参数**

- `interval_1` — 第一个间隔或间隔元组。 [`Interval`](/sql-reference/data-types/int-uint) 或 [`Tuple(Interval)`](/sql-reference/data-types/tuple)
- `interval_2` — 要添加的第二个间隔。 [`Interval`](/sql-reference/data-types/int-uint)


**返回值**

返回一个间隔元组 [`Tuple(Interval)`](/sql-reference/data-types/tuple)

**示例**

**添加间隔**

```sql title=Query
SELECT addInterval(INTERVAL 1 DAY, INTERVAL 1 MONTH);
SELECT addInterval((INTERVAL 1 DAY, INTERVAL 1 YEAR), INTERVAL 1 MONTH);
SELECT addInterval(INTERVAL 2 DAY, INTERVAL 1 DAY)
```

```response title=Response
┌─addInterval(toIntervalDay(1), toIntervalMonth(1))─┐
│ (1,1)                                             │
└───────────────────────────────────────────────────┘
┌─addInterval((toIntervalDay(1), toIntervalYear(1)), toIntervalMonth(1))─┐
│ (1,1,1)                                                                │
└────────────────────────────────────────────────────────────────────────┘
┌─addInterval(toIntervalDay(2), toIntervalDay(1))─┐
│ (3)                                             │
└─────────────────────────────────────────────────┘
```
## addMicroseconds {#addMicroseconds}

引入于：v22.6


将指定数量的微秒添加到带时间的日期或字符串编码的带时间的日期中。
    

**语法**

```sql
addMicroseconds(datetime, num)
```

**参数**

- `datetime` — 要添加指定数量微秒的带时间的日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要添加的微秒数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)


**返回值**

返回 `date_time` 加 `num` 微秒后的结果 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**向不同的日期时间类型添加微秒**

```sql title=Query
WITH
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    addMicroseconds(date_time, 1000000) AS add_microseconds_with_date_time,
    addMicroseconds(date_time_string, 1000000) AS add_microseconds_with_date_time_string
```

```response title=Response
┌─add_microseconds_with_date_time─┬─add_microseconds_with_date_time_string─┐
│      2024-01-01 00:00:01.000000 │             2024-01-01 00:00:01.000000 │
└─────────────────────────────────┴────────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateAdd('1998-06-16'::DateTime, INTERVAL 10 microsecond)
```

```response title=Response
┌─plus(CAST('19⋯osecond(10))─┐
│ 1998-06-16 00:00:00.000010 │
└────────────────────────────┘
```
## addMilliseconds {#addMilliseconds}

引入于：v22.6


将指定数量的毫秒添加到带时间的日期或字符串编码的带时间的日期中。
    

**语法**

```sql
addMilliseconds(datetime, num)
```

**参数**

- `datetime` — 要添加指定数量毫秒的带时间的日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要添加的毫秒数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)


**返回值**

返回 `datetime` 加 `num` 毫秒后的结果 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**向不同的日期时间类型添加毫秒**

```sql title=Query
WITH
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    addMilliseconds(date_time, 1000) AS add_milliseconds_with_date_time,
    addMilliseconds(date_time_string, 1000) AS add_milliseconds_with_date_time_string
```

```response title=Response
┌─add_milliseconds_with_date_time─┬─add_milliseconds_with_date_time_string─┐
│         2024-01-01 00:00:01.000 │                2024-01-01 00:00:01.000 │
└─────────────────────────────────┴────────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateAdd('1998-06-16'::DateTime, INTERVAL 10 millisecond)
```

```response title=Response
┌─plus(CAST('1⋯second(10))─┐
│  1998-06-16 00:00:00.010 │
└──────────────────────────┘
```
## addMinutes {#addMinutes}

引入于：v1.1


将指定数量的分钟添加到日期、带时间的日期或字符串编码的日期或带时间的日期中。
    

**语法**

```sql
addMinutes(datetime, num)
```

**参数**

- `datetime` — 要添加指定分钟数的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要添加的分钟数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)


**返回值**

返回 `datetime` 加 `num` 分钟后的结果 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64(3)`](/sql-reference/data-types/datetime64)

**示例**

**向不同日期类型添加分钟**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    addMinutes(date, 20) AS add_minutes_with_date,
    addMinutes(date_time, 20) AS add_minutes_with_date_time,
    addMinutes(date_time_string, 20) AS add_minutes_with_date_time_string
```

```response title=Response
┌─add_minutes_with_date─┬─add_minutes_with_date_time─┬─add_minutes_with_date_time_string─┐
│   2024-01-01 00:20:00 │        2024-01-01 00:20:00 │           2024-01-01 00:20:00.000 │
└───────────────────────┴────────────────────────────┴───────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateAdd('1998-06-16'::Date, INTERVAL 10 minute)
```

```response title=Response
┌─plus(CAST('1⋯Minute(10))─┐
│      1998-06-16 00:10:00 │
└──────────────────────────┘
```
## addMonths {#addMonths}

引入于：v1.1


将指定数量的月份添加到日期、带时间的日期或字符串编码的日期或带时间的日期中。
    

**语法**

```sql
addMonths(datetime, num)
```

**参数**

- `datetime` — 要添加指定月份数的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要添加的月份数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)


**返回值**

返回 `datetime` 加 `num` 月份后的结果 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**向不同日期类型添加月份**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    addMonths(date, 6) AS add_months_with_date,
    addMonths(date_time, 6) AS add_months_with_date_time,
    addMonths(date_time_string, 6) AS add_months_with_date_time_string
```

```response title=Response
┌─add_months_with_date─┬─add_months_with_date_time─┬─add_months_with_date_time_string─┐
│           2024-07-01 │       2024-07-01 00:00:00 │          2024-07-01 00:00:00.000 │
└──────────────────────┴───────────────────────────┴──────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateAdd('1998-06-16'::Date, INTERVAL 10 month)
```

```response title=Response
┌─plus(CAST('1⋯lMonth(10))─┐
│               1999-04-16 │
└──────────────────────────┘
```
## addNanoseconds {#addNanoseconds}

引入于：v22.6


将指定数量的纳秒添加到带时间的日期或字符串编码的带时间的日期中。
    

**语法**

```sql
addNanoseconds(datetime, num)
```

**参数**

- `datetime` — 要添加指定数量纳秒的带时间的日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要添加的纳秒数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)


**返回值**

返回 `datetime` 加 `num` 纳秒后的结果 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**向不同的日期时间类型添加纳秒**

```sql title=Query
WITH
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    addNanoseconds(date_time, 1000) AS add_nanoseconds_with_date_time,
    addNanoseconds(date_time_string, 1000) AS add_nanoseconds_with_date_time_string
```

```response title=Response
┌─add_nanoseconds_with_date_time─┬─add_nanoseconds_with_date_time_string─┐
│  2024-01-01 00:00:00.000001000 │         2024-01-01 00:00:00.000001000 │
└────────────────────────────────┴───────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateAdd('1998-06-16'::DateTime, INTERVAL 1000 nanosecond)
```

```response title=Response
┌─plus(CAST('199⋯osecond(1000))─┐
│ 1998-06-16 00:00:00.000001000 │
└───────────────────────────────┘
```
## addQuarters {#addQuarters}

引入于：v20.1


将指定数量的季度添加到日期、带时间的日期或字符串编码的带时间的日期中。
    

**语法**

```sql
addQuarters(datetime, num)
```

**参数**

- `datetime` — 要添加指定季度数的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要添加的季度数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)


**返回值**

返回 `datetime` 加 `num` 季度后的结果 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**向不同日期类型添加季度**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    addQuarters(date, 1) AS add_quarters_with_date,
    addQuarters(date_time, 1) AS add_quarters_with_date_time,
    addQuarters(date_time_string, 1) AS add_quarters_with_date_time_string
```

```response title=Response
┌─add_quarters_with_date─┬─add_quarters_with_date_time─┬─add_quarters_with_date_time_string─┐
│             2024-04-01 │         2024-04-01 00:00:00 │            2024-04-01 00:00:00.000 │
└────────────────────────┴─────────────────────────────┴────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateAdd('1998-06-16'::Date, INTERVAL 10 quarter)
```

```response title=Response
┌─plus(CAST('1⋯uarter(10))─┐
│               2000-12-16 │
└──────────────────────────┘
```
## addSeconds {#addSeconds}

引入于：v1.1


将指定数量的秒添加到日期、带时间的日期或字符串编码的日期或带时间的日期中。
    

**语法**

```sql
addSeconds(datetime, num)
```

**参数**

- `datetime` — 要添加指定秒数的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要添加的秒数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)


**返回值**

返回 `datetime` 加 `num` 秒后的结果 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64(3)`](/sql-reference/data-types/datetime64)

**示例**

**向不同日期类型添加秒数**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    addSeconds(date, 30) AS add_seconds_with_date,
    addSeconds(date_time, 30) AS add_seconds_with_date_time,
    addSeconds(date_time_string, 30) AS add_seconds_with_date_time_string
```

```response title=Response
┌─add_seconds_with_date─┬─add_seconds_with_date_time─┬─add_seconds_with_date_time_string─┐
│   2024-01-01 00:00:30 │        2024-01-01 00:00:30 │           2024-01-01 00:00:30.000 │
└───────────────────────┴────────────────────────────┴───────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateAdd('1998-06-16'::Date, INTERVAL 10 second)
```

```response title=Response
┌─dateAdd('1998-06-16'::Date, INTERVAL 10 second)─┐
│                             1998-06-16 00:00:10 │
└─────────────────────────────────────────────────┘
```
## addTupleOfIntervals {#addTupleOfIntervals}

引入于：v22.11


连续将一组间隔添加到一个日期或带时间的日期中。
    

**语法**

```sql
addTupleOfIntervals(datetime, intervals)
```

**参数**

- `datetime` — 要添加间隔的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `intervals` — 要添加到 `datetime` 的间隔元组。 [`Tuple(Interval)`](/sql-reference/data-types/tuple)


**返回值**

返回添加了 `intervals` 的日期 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**向日期添加间隔元组**

```sql title=Query
WITH toDate('2018-01-01') AS date
SELECT addTupleOfIntervals(date, (INTERVAL 1 DAY, INTERVAL 1 MONTH, INTERVAL 1 YEAR))
```

```response title=Response
┌─addTupleOfIntervals(date, (toIntervalDay(1), toIntervalMonth(1), toIntervalYear(1)))─┐
│                                                                           2019-02-02 │
└──────────────────────────────────────────────────────────────────────────────────────┘
```
## addWeeks {#addWeeks}

引入于：v1.1


将指定数量的周数添加到日期、带时间的日期或字符串编码的日期或带时间的日期中。
    

**语法**

```sql
addWeeks(datetime, num)
```

**参数**

- `datetime` — 要添加指定周数的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要添加的周数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)


**返回值**

返回 `datetime` 加 `num` 周后的结果 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**向不同日期类型添加周数**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    addWeeks(date, 5) AS add_weeks_with_date,
    addWeeks(date_time, 5) AS add_weeks_with_date_time,
    addWeeks(date_time_string, 5) AS add_weeks_with_date_time_string
```

```response title=Response
┌─add_weeks_with_date─┬─add_weeks_with_date_time─┬─add_weeks_with_date_time_string─┐
│          2024-02-05 │      2024-02-05 00:00:00 │         2024-02-05 00:00:00.000 │
└─────────────────────┴──────────────────────────┴─────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateAdd('1998-06-16'::Date, INTERVAL 10 week)
```

```response title=Response
┌─plus(CAST('1⋯alWeek(10))─┐
│               1998-08-25 │
└──────────────────────────┘
```
## addYears {#addYears}

引入于：v1.1


将指定数量的年份添加到日期、带时间的日期或字符串编码的日期或带时间的日期中。
    

**语法**

```sql
addYears(datetime, num)
```

**参数**

- `datetime` — 要添加指定年份的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要添加的年份数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)


**返回值**

返回 `datetime` 加 `num` 年后的结果 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**向不同日期类型添加年份**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    addYears(date, 1) AS add_years_with_date,
    addYears(date_time, 1) AS add_years_with_date_time,
    addYears(date_time_string, 1) AS add_years_with_date_time_string
```

```response title=Response
┌─add_years_with_date─┬─add_years_with_date_time─┬─add_years_with_date_time_string─┐
│          2025-01-01 │      2025-01-01 00:00:00 │         2025-01-01 00:00:00.000 │
└─────────────────────┴──────────────────────────┴─────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateAdd('1998-06-16'::Date, INTERVAL 10 year)
```

```response title=Response
┌─plus(CAST('1⋯alYear(10))─┐
│               2008-06-16 │
└──────────────────────────┘
```
## age {#age}

引入于：v23.1


返回 `startdate` 和 `enddate` 之间的单位组件差异。
差异通过 1 纳秒的精度进行计算。

例如，2021-12-29 和 2022-01-01 之间的差异在天单位上是 3 天，
在月单位上是 0 个月，在年单位上是 0 年。

有关 age 的替代方法，请参见函数 [`timeDiff`](#timeDiff)。
    

**语法**

```sql
age('unit', startdate, enddate, [timezone])
```

**参数**

- `unit` — 结果的间隔类型。

| 单位       | 可能值                             |
|------------|------------------------------------|
| 纳秒      | `nanosecond`, `nanoseconds`, `ns`   |
| 微秒      | `microsecond`, `microseconds`, `us`, `u` |
| 毫秒      | `millisecond`, `milliseconds`, `ms` |
| 秒        | `second`, `seconds`, `ss`, `s`      |
| 分钟      | `minute`, `minutes`, `mi`, `n`      |
| 小时      | `hour`, `hours`, `hh`, `h`          |
| 天        | `day`, `days`, `dd`, `d`            |
| 周        | `week`, `weeks`, `wk`, `ww`         |
| 月        | `month`, `months`, `mm`, `m`        |
| 季度      | `quarter`, `quarters`, `qq`, `q`    |
| 年        | `year`, `years`, `yyyy`, `yy`       |
 - `startdate` — 第一个时间值进行减法（被减数）。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `enddate` — 第二个时间值进行减法（减数）。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。时区名称。如果指定，则将其应用于 `startdate` 和 `enddate`。如果未指定，则使用 `startdate` 和 `enddate` 的时区。如果不相同，则结果未定义。 [`String`](/sql-reference/data-types/string)


**返回值**

返回以单位表示的 `enddate` 和 `startdate` 之间的差异。 [`Int32`](/sql-reference/data-types/int-uint)

**示例**

**计算小时数的年龄**

```sql title=Query
SELECT age('hour', toDateTime('2018-01-01 22:30:00'), toDateTime('2018-01-02 23:00:00'))
```

```response title=Response
┌─age('hour', toDateTime('2018-01-01 22:30:00'), toDateTime('2018-01-02 23:00:00'))─┐
│                                                                                24 │
└───────────────────────────────────────────────────────────────────────────────────┘
```

**计算不同单位的年龄**

```sql title=Query
SELECT
    toDate('2022-01-01') AS e,
    toDate('2021-12-29') AS s,
    age('day', s, e) AS day_age,
    age('month', s, e) AS month_age,
    age('year', s, e) AS year_age
```

```response title=Response
┌──────────e─┬──────────s─┬─day_age─┬─month_age─┬─year_age─┐
│ 2022-01-01 │ 2021-12-29 │       3 │         0 │        0 │
└────────────┴────────────┴─────────┴───────────┴──────────┘
```
## changeDay {#changeDay}

引入于：v24.7

更改日期或日期时间的日部分。

**语法**

```sql
changeDay(date_or_datetime, value)
```

**参数**

- `date_or_datetime` — 要更改的值。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `value` — 新值。 [`(U)Int*`](/sql-reference/data-types/int-uint)


**返回值**

返回与 `date_or_datetime` 同类型的值，其日部分已修改。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**用法示例**

```sql title=Query
SELECT changeDay('2024-01-31'::DateTime, 15)
```

```response title=Response
2024-01-15 00:00:00
```
## changeHour {#changeHour}

引入于：v24.7

更改日期或日期时间的小时部分。

**语法**

```sql
changeHour(date_or_datetime, value)
```

**参数**

- `date_or_datetime` — 要更改的值。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `value` — 新值。 [`(U)Int*`](/sql-reference/data-types/int-uint)


**返回值**

返回与 `date_or_datetime` 同类型的值，其小时部分已修改。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**用法示例**

```sql title=Query
SELECT changeHour('2024-01-01 12:00:00'::DateTime, 5)
```

```response title=Response
2024-01-01 05:00:00
```
## changeMinute {#changeMinute}

引入于：v24.7

更改 `date or date time` 的分钟部分。

**语法**

```sql
changeMinute(date_or_datetime, value)
```

**参数**

- `date_or_datetime` — 要更改的值。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `value` — 新值。 [`(U)Int*`](/sql-reference/data-types/int-uint)


**返回值**

返回与 `date_or_datetime` 同类型的值，其分钟部分已修改。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**用法示例**

```sql title=Query
SELECT changeMinute('2024-01-01 12:30:00'::DateTime, 45)
```

```response title=Response
2024-01-01 12:45:00
```
## changeMonth {#changeMonth}

引入于：v24.7

更改日期或日期时间的月份部分。

**语法**

```sql
changeMonth(date_or_datetime, value)
```

**参数**

- `date_or_datetime` — 要更改的值。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `value` — 新值。 [`(U)Int*`](/sql-reference/data-types/int-uint)


**返回值**

返回与 `date_or_datetime` 同类型的值，其月份部分已修改。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**用法示例**

```sql title=Query
SELECT changeMonth('2024-01-01'::DateTime, 12)
```

```response title=Response
2024-12-01 00:00:00
```
## changeSecond {#changeSecond}

引入于：v24.7

更改日期或日期时间的秒部分。

**语法**

```sql
changeSecond(date_or_datetime, value)
```

**参数**

- `date_or_datetime` — 要更改的值。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `value` — 新值。 [`(U)Int*`](/sql-reference/data-types/int-uint)


**返回值**

返回与 `date_or_datetime` 同类型的值，其秒部分已修改。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**用法示例**

```sql title=Query
SELECT changeSecond('2024-01-01 12:30:45'::DateTime, 15)
```

```response title=Response
2024-01-01 12:30:15
```
## changeYear {#changeYear}

引入于：v24.7

更改日期或日期时间的年份部分。

**语法**

```sql
changeYear(date_or_datetime, value)
```

**参数**

- `date_or_datetime` — 要更改的值。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `value` — 新值。 [`(U)Int*`](/sql-reference/data-types/int-uint)


**返回值**

返回与 `date_or_datetime` 同类型的值，其年份部分已修改。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**用法示例**

```sql title=Query
SELECT changeYear('2024-01-01'::DateTime, 2023)
```

```response title=Response
2023-01-01 00:00:00
```
## dateName {#dateName}

引入于：v21.7


返回指定的日期部分。

可能值：
- 'year'
- 'quarter'
- 'month'
- 'week'
- 'dayofyear'
- 'day'
- 'weekday'
- 'hour'
- 'minute'
- 'second'
    

**语法**

```sql
dateName(date_part, date[, timezone])
```

**参数**

- `date_part` — 要提取的日期部分。 [`String`](/sql-reference/data-types/string)
- `datetime` — 日期或带时间的日期值。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。时区。 [`String`](/sql-reference/data-types/string)


**返回值**

返回指定的日期部分。 [`String`](/sql-reference/data-types/string)

**示例**

**提取不同的日期部分**

```sql title=Query
WITH toDateTime('2021-04-14 11:22:33') AS date_value
SELECT
    dateName('year', date_value),
    dateName('month', date_value),
    dateName('day', date_value)
```

```response title=Response
┌─dateName('year', date_value)─┬─dateName('month', date_value)─┬─dateName('day', date_value)─┐
│ 2021                         │ April                         │ 14                          │
└──────────────────────────────┴───────────────────────────────┴─────────────────────────────┘
```
## dateTrunc {#dateTrunc}

引入于：v20.8


将日期和时间值截断到指定的日期部分。
    

**语法**

```sql
dateTrunc(unit, datetime[, timezone])
```

**参数**

- `unit` — 
截断结果的间隔类型。 `unit` 参数不区分大小写。
| 单位         | 兼容性                     |
|--------------|-----------------------------|
| `nanosecond` | 仅与 DateTime64 兼容        |
| `microsecond`| 仅与 DateTime64 兼容        |
| `millisecond`| 仅与 DateTime64 兼容        |
| `second`     |                             |
| `minute`     |                             |
| `hour`       |                             |
| `day`        |                             |
| `week`       |                             |
| `month`      |                             |
| `quarter`    |                             |
| `year`       |                             |
 [`String`](/sql-reference/data-types/string)
- `datetime` — 日期和时间。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。返回 datetime 的时区名称。如果未指定，函数将使用 `datetime` 参数的时区。 [`String`](/sql-reference/data-types/string)


**返回值**

返回截断后的日期和时间值。

| 单位参数               | `datetime` 参数                   | 返回类型                                                             |
|-----------------------|-----------------------------------|---------------------------------------------------------------------|
| 年、季度、月、周      | `Date32` 或 `DateTime64` 或 `Date` 或 `DateTime` | [`Date32`](../data-types/date32.md) 或 [`Date`](../data-types/date.md)      |
| 天、小时、分钟、秒    | `Date32`、`DateTime64`、`Date`或`DateTime`| [`DateTime64`](../data-types/datetime64.md) 或 [`DateTime`](../data-types/datetime.md) |
| 毫秒、微秒、          | 任何                               | [`DateTime64`](../data-types/datetime64.md)                          |
| 纳秒                  |                                   | 精度为 3、6 或 9                                                     |

**示例**

**无时区截断**

```sql title=Query
SELECT now(), dateTrunc('hour', now());
```

```response title=Response
┌───────────────now()─┬─dateTrunc('hour', now())──┐
│ 2020-09-28 10:40:45 │       2020-09-28 10:00:00 │
└─────────────────────┴───────────────────────────┘
```

**带指定时区的截断**

```sql title=Query
SELECT now(), dateTrunc('hour', now(), 'Asia/Istanbul');
```

```response title=Response
┌───────────────now()─┬─dateTrunc('hour', now(), 'Asia/Istanbul')──┐
│ 2020-09-28 10:46:26 │                        2020-09-28 13:00:00 │
└─────────────────────┴────────────────────────────────────────────┘
```
## formatDateTime {#formatDateTime}

引入于：v1.1

根据给定的格式字符串格式化日期或带时间的日期。`format` 是一个常量表达式，因此你不能为单个结果列使用多个格式。

`formatDateTime` 使用 MySQL 的日期时间格式风格，详情请参阅 [mysql docs](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_date-format)。

此函数的反向操作是 [`parseDateTime`](/sql-reference/functions/type-conversion-functions#parsedatetime)。

使用替换字段，你可以定义结果字符串的模式。
下表中的示例列显示 `2018-01-02 22:33:44` 的格式化结果。

**替换字段：**

| 占位符 | 描述 | 示例 |
|-------------|-------------|---------|
| %a | 缩写的星期几名称（周一-周日） | Mon |
| %b | 缩写的月份名称（1月-12月） | Jan |
| %c | 月份的整数值（01-12） | 01 |
| %C | 年除以 100 并舍去小数部分的结果（00-99） | 20 |
| %d | 月份的天数，零填充（01-31） | 02 |
| %D | 短格式 MM/DD/YY 日期，相当于 %m/%d/%y | 01/02/18 |
| %e | 月份中的天数，空格填充（1-31） | 2 |
| %f | 小数秒 | 123456 |
| %F | 短格式 YYYY-MM-DD 日期，相当于 %Y-%m-%d | 2018-01-02 |
| %g | 两位数的年份格式，与 ISO 8601 对齐 | 18 |
| %G | ISO 周数的四位数字年份格式 | 2018 |
| %h | 12 小时格式的小时数（01-12） | 09 |
| %H | 24 小时格式的小时数（00-23） | 22 |
| %i | 分钟（00-59） | 33 |
| %I | 12 小时格式的小时数（01-12） | 10 |
| %j | 一年的第几天（001-366） | 002 |
| %k | 24 小时格式的小时数（00-23） | 14 |
| %l | 12 小时格式的小时数（01-12） | 09 |
| %m | 月份的整数值（01-12） | 01 |
| %M | 完整的月份名称（1月-12月） | January |
| %n | 换行字符 | |
| %p | AM 或 PM 标识 | PM |
| %Q | 季度（1-4） | 1 |
| %r | 12小时 HH:MM AM/PM 时间，相当于 %h:%i %p | 10:30 PM |
| %R | 24小时 HH:MM 时间，相当于 %H:%i | 22:33 |
| %s | 秒（00-59） | 44 |
| %S | 秒（00-59） | 44 |
| %t | 横向制表符 | |
| %T | ISO 8601 时间格式（HH:MM:SS），相当于 %H:%i:%S | 22:33:44 |
| %u | ISO 8601 星期几作为数字，周一为 1（1-7） | 2 |
| %V | ISO 8601 周数（01-53） | 01 |
| %w | 星期几作为整数值，周日为 0（0-6） | 2 |
| %W | 完整的星期几名称（周一-周日） | Monday |
| %y | 年的最后两位数字（00-99） | 18 |
| %Y | 年 | 2018 |
| %z | UTC 时间偏移，格式为 +HHMM 或 -HHMM | -0500 |
| %% | 百分号 | % |

- 在 v23.4 之前的 ClickHouse 版本中，如果格式化值为 Date，Date32 或 DateTime（没有小数秒）或 DateTime64 的精度为 0，则 `%f` 会打印一个零（0）。
- 在 v25.1 之前的 ClickHouse 版本中，`%f` 将打印 DateTime64 指定的位数而不是固定的 6 位数字。
- 在 v23.4 之前的 ClickHouse 版本中，`%M` 打印分钟（00-59），而不是完整的月份名称（1月-12月）。

**语法**

```sql
formatDateTime(datetime, format[, timezone])
```

**参数**

- `datetime` — 要格式化的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `format` — 带替换字段的格式字符串。 [`String`](/sql-reference/data-types/string)
- `timezone` — 可选。 格式化时间的时区名称。 [`String`](/sql-reference/data-types/string)

**返回值**

根据确定的格式返回时间和日期值。 [`String`](/sql-reference/data-types/string)

**示例**

**用年份占位符格式化日期**

```sql title=Query
SELECT formatDateTime(toDate('2010-01-04'), '%g')
```

```response title=Response
┌─formatDateTime(toDate('2010-01-04'), '%g')─┐
│ 10                                         │
└────────────────────────────────────────────┘
```

**用小数秒格式化 DateTime64**

```sql title=Query
SELECT formatDateTime(toDateTime64('2010-01-04 12:34:56.123456', 7), '%f')
```

```response title=Response
┌─formatDateTime(toDateTime64('2010-01-04 12:34:56.123456', 7), '%f')─┐
│ 1234560                                                             │
└─────────────────────────────────────────────────────────────────────┘
```

**带时区格式**

```sql title=Query
SELECT
    now() AS ts,
    time_zone,
    formatDateTime(ts, '%T', time_zone) AS str_tz_time
FROM system.time_zones
WHERE time_zone LIKE 'Europe%'
LIMIT 10
```

```response title=Response
┌──────────────────ts─┬─time_zone─────────┬─str_tz_time─┐
│ 2023-09-08 19:13:40 │ Europe/Amsterdam  │ 21:13:40    │
│ 2023-09-08 19:13:40 │ Europe/Andorra    │ 21:13:40    │
│ 2023-09-08 19:13:40 │ Europe/Astrakhan  │ 23:13:40    │
│ 2023-09-08 19:13:40 │ Europe/Athens     │ 22:13:40    │
│ 2023-09-08 19:13:40 │ Europe/Belfast    │ 20:13:40    │
│ 2023-09-08 19:13:40 │ Europe/Belgrade   │ 21:13:40    │
│ 2023-09-08 19:13:40 │ Europe/Berlin     │ 21:13:40    │
│ 2023-09-08 19:13:40 │ Europe/Bratislava │ 21:13:40    │
│ 2023-09-08 19:13:40 │ Europe/Brussels   │ 21:13:40    │
│ 2023-09-08 19:13:40 │ Europe/Bucharest  │ 22:13:40    │
└─────────────────────┴───────────────────┴─────────────┘
```
## formatDateTimeInJodaSyntax {#formatDateTimeInJodaSyntax}

引入于：v20.1

类似于 `formatDateTime`，不同的是它以 Joda 风格格式化日期时间，而不是 MySQL 风格。请参阅 [Joda Time documentation](https://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html)。

此函数的反向操作是 [`parseDateTimeInJodaSyntax`](/sql-reference/functions/type-conversion-functions#parsedatetimeinjodasyntax)。

使用替换字段，你可以定义结果字符串的模式。

**替换字段：**

| 占位符 | 描述 | 表现 | 示例 |
|-------------|-------------|-------------|----------|
| G | 纪元 | 文本 | AD |
| C | 纪元的世纪（>=0） | 数字 | 20 |
| Y | 纪元年份（>=0） | 年份 | 1996 |
| x | 周年（尚不支持） | 年份 | 1996 |
| w | 周年中的周（尚不支持） | 数字 | 27 |
| e | 星期几 | 数字 | 2 |
| E | 星期几 | 文本 | Tuesday; Tue |
| y | 年份 | 年份 | 1996 |
| D | 一年的天数 | 数字 | 189 |
| M | 月份 | 月 | July; Jul; 07 |
| d | 月份中的天数 | 数字 | 10 |
| a | 一天中的半天 | 文本 | PM |
| K | 半天中的小时数（0~11） | 数字 | 0 |
| h | 半天中的时钟小时（1~12） | 数字 | 12 |
| H | 一天中的小时数（0~23） | 数字 | 0 |
| k | 一天中的时钟小时（1~24） | 数字 | 24 |
| m | 小时中的分钟 | 数字 | 30 |
| s | 分钟中的秒 | 数字 | 55 |
| S | 秒的小数部分 | 数字 | 978 |
| z | 时区 | 文本 | Eastern Standard Time; EST |
| Z | 时区偏移 | 区域 | -0800; -0812 |
| ' | 文本的转义字符 | 分隔符 | |
| '' | 单引号 | 文本 | ' |

**语法**

```sql
formatDateTimeInJodaSyntax(datetime, format[, timezone])
```

**参数**

- `datetime` — 要格式化的日期或带时间的日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `format` — 带 Joda 风格替换字段的格式字符串。 [`String`](/sql-reference/data-types/string)
- `timezone` — 可选。 格式化时间的时区名称。 [`String`](/sql-reference/data-types/string)

**返回值**

根据确定的格式返回时间和日期值。 [`String`](/sql-reference/data-types/string)

**示例**

**使用 Joda 语法格式化日期时间**

```sql title=Query
SELECT formatDateTimeInJodaSyntax(toDateTime('2010-01-04 12:34:56'), 'yyyy-MM-dd HH:mm:ss')
```

```response title=Response
┌─formatDateTimeInJodaSyntax(toDateTime('2010-01-04 12:34:56'), 'yyyy-MM-dd HH:mm:ss')─┐
│ 2010-01-04 12:34:56                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```
## fromDaysSinceYearZero {#fromDaysSinceYearZero}

引入于：v23.11

对于自 [公元0000年1月1日](https://en.wikipedia.org/wiki/Year_zero) 以来经过的天数，返回 ISO 8601 定义的[前瞻性格里高尔日历](https://en.wikipedia.org/wiki/Gregorian_calendar#Proleptic_Gregorian_calendar) 中相应的日期。

该计算与 MySQL 的 `FROM_DAYS()` 函数相同。如果在 [Date](../data-types/date.md) 类型的范围内不能表示，结果是未定义的。

**语法**

```sql
fromDaysSinceYearZero(days)
```

**参数**

- `days` — 自公元零年起经过的天数。 [`UInt32`](/sql-reference/data-types/int-uint)

**返回值**

返回自公元零年起经过的天数对应的日期。 [`Date`](/sql-reference/data-types/date)

**示例**

**将自公元零年起的天数转换为日期**

```sql title=Query
SELECT
fromDaysSinceYearZero(739136) AS date1,
fromDaysSinceYearZero(toDaysSinceYearZero(toDate('2023-09-08'))) AS date2
```

```response title=Response
┌──────date1─┬──────date2─┐
│ 2023-09-08 │ 2023-09-08 │
└────────────┴────────────┘
```
## fromDaysSinceYearZero32 {#fromDaysSinceYearZero32}

引入于：v23.11

对于自 [公元0000年1月1日](https://en.wikipedia.org/wiki/Year_zero) 以来经过的天数，返回 ISO 8601 定义的[前瞻性格里高尔日历](https://en.wikipedia.org/wiki/Gregorian_calendar#Proleptic_Gregorian_calendar) 中相应的日期。
该计算与 MySQL 的 `FROM_DAYS()` 函数相同。如果在 [`Date32`](../data-types/date32.md) 类型的范围内不能表示，结果是未定义的。

**语法**

```sql
fromDaysSinceYearZero32(days)
```

**参数**

- `days` — 自公元零年起经过的天数。 [`UInt32`](/sql-reference/data-types/int-uint)

**返回值**

返回自公元零年起经过的天数对应的日期。 [`Date32`](/sql-reference/data-types/date32)

**示例**

**将自公元零年起的天数转换为日期**

```sql title=Query
SELECT
fromDaysSinceYearZero32(739136) AS date1,
fromDaysSinceYearZero32(toDaysSinceYearZero(toDate('2023-09-08'))) AS date2
```

```response title=Response
┌──────date1─┬──────date2─┐
│ 2023-09-08 │ 2023-09-08 │
└────────────┴────────────┘
```
## fromModifiedJulianDay {#fromModifiedJulianDay}

引入于：v21.1

将[修订过的儒略日](https://en.wikipedia.org/wiki/Julian_day#Variants)数字转换为文本形式的[前瞻性格里高尔日历](https://en.wikipedia.org/wiki/Proleptic_Gregorian_calendar) 日期 `YYYY-MM-DD`。此函数支持的天数范围为 `-678941` 到 `2973483`（分别代表 0000-01-01 和 9999-12-31）。如果天数超出支持范围，将引发异常。

**语法**

```sql
fromModifiedJulianDay(day)
```

**参数**

- `day` — 修订的儒略日数字。 [`(U)Int*`](/sql-reference/data-types/int-uint)

**返回值**

返回文本形式的日期。 [`String`](/sql-reference/data-types/string)

**示例**

**将修订的儒略日转换为日期**

```sql title=Query
SELECT fromModifiedJulianDay(58849)
```

```response title=Response
┌─fromModifiedJulianDay(58849)─┐
│ 2020-01-01                   │
└──────────────────────────────┘
```
## fromModifiedJulianDayOrNull {#fromModifiedJulianDayOrNull}

引入于：v21.1

类似于 [`fromModifiedJulianDay()`](#fromModifiedJulianDay)，但不引发异常，而是返回 `NULL`。

**语法**

```sql
fromModifiedJulianDayOrNull(day)
```

**参数**

- `day` — 修订的儒略日数字。 [`(U)Int*`](/sql-reference/data-types/int-uint)

**返回值**

对于有效的 `day` 参数，返回文本形式的日期；否则返回 `null`。 [`Nullable(String)`](/sql-reference/data-types/nullable)

**示例**

**在处理 null 时将修订的儒略日转换为日期**

```sql title=Query
SELECT fromModifiedJulianDayOrNull(58849);
SELECT fromModifiedJulianDayOrNull(60000000); -- invalid argument, returns NULL
```

```response title=Response
┌─fromModified⋯Null(58849)─┐
│ 2020-01-01               │
└──────────────────────────┘
┌─fromModified⋯l(60000000)─┐
│ ᴺᵁᴸᴸ                     │
└──────────────────────────┘
```
## fromUTCTimestamp {#fromUTCTimestamp}

引入于：v22.1

将来自 UTC 时区的日期或带时间的值转换为指定时区的日期或带时间的值。此函数主要是为了与 Apache Spark 等框架的兼容性而包含。

**语法**

```sql
fromUTCTimestamp(datetime, time_zone)
```

**参数**

- `datetime` — 常量值或表达式中的日期或带时间的日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `time_zone` — 表示时区的常量字符串类型值或表达式。 [`String`](/sql-reference/data-types/string)

**返回值**

返回指定时区的 DateTime/DateTime64。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**将 UTC 时区转换为指定时区**

```sql title=Query
SELECT fromUTCTimestamp(toDateTime64('2023-03-16 10:00:00', 3), 'Asia/Shanghai')
```

```response title=Response
┌─fromUTCTimestamp(toDateTime64('2023-03-16 10:00:00',3), 'Asia/Shanghai')─┐
│                                                 2023-03-16 18:00:00.000 │
└─────────────────────────────────────────────────────────────────────────┘
```
## fromUnixTimestamp {#fromUnixTimestamp}

引入于：v20.8

此函数将 Unix 时间戳转换为日历日期和一天中的时间。

它可以以两种方式调用：

- 当给定一个类型为 [`Integer`](../data-types/int-uint.md) 的单一参数时，它返回类型为 [`DateTime`](../data-types/datetime.md) 的值，即行为类似于 [`toDateTime`](../../sql-reference/functions/type-conversion-functions.md#todatetime)。
- 当给定两个或三个参数时，第一个参数是类型为 [`Integer`](../data-types/int-uint.md)、[`Date`](../data-types/date.md)、[`Date32`](../data-types/date32.md)、[`DateTime`](../data-types/datetime.md) 或 [`DateTime64`](../data-types/datetime64.md) 的值，第二个参数是常量格式字符串，第三个参数是可选的常量时区字符串，该函数返回类型为 [`String`](../data-types/string.md) 的值，即其行为类似于 [`formatDateTime`](#formatDateTime)。
  在这种情况下，使用 [MySQL 的日期时间格式风格](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_date-format)。

**语法**

```sql
fromUnixTimestamp(timestamp)
fromUnixTimestamp(timestamp[, format[, timezone]])
```

**参数**

- `timestamp` — Unix 时间戳或日期/带时间的值。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `format` — 可选。 输出格式的常量格式字符串。 [`String`](/sql-reference/data-types/string)
- `timezone` — 可选。 常量时区字符串。 [`String`](/sql-reference/data-types/string)

**返回值**

当以一个参数调用时返回时间戳的 `DateTime`，或以两个或三个参数调用时返回字符串。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`String`](/sql-reference/data-types/string)

**示例**

**将 Unix 时间戳转换为 DateTime**

```sql title=Query
SELECT fromUnixTimestamp(423543535)
```

```response title=Response
┌─fromUnixTimestamp(423543535)─┐
│          1983-06-04 10:58:55 │
└──────────────────────────────┘
```

**带格式的 Unix 时间戳转换**

```sql title=Query
SELECT fromUnixTimestamp(1234334543, '%Y-%m-%d %R:%S') AS DateTime
```

```response title=Response
┌─DateTime────────────┐
│ 2009-02-11 14:42:23 │
└─────────────────────┘
```
## fromUnixTimestampInJodaSyntax {#fromUnixTimestampInJodaSyntax}

引入于：v23.1

此函数将 Unix 时间戳转换为日历日期和一天中的时间。

它可以以两种方式调用：

当给定一个类型为 [`Integer`](../data-types/int-uint.md) 的单一参数时，它返回类型为 [`DateTime`](../data-types/datetime.md) 的值，即行为类似于 [`toDateTime`](../../sql-reference/functions/type-conversion-functions.md#todatetime)。

当给定两个或三个参数时，第一个参数是类型为 [`Integer`](../data-types/int-uint.md)、[`Date`](../data-types/date.md)、[`Date32`](../data-types/date32.md)、[`DateTime`](../data-types/datetime.md) 或 [`DateTime64`](../data-types/datetime64.md) 的值，第二个参数是常量格式字符串，第三个参数是可选的常量时区字符串，该函数返回类型为 [`String`](../data-types/string.md) 的值，即其行为类似于 [`formatDateTimeInJodaSyntax`](#formatDateTimeInJodaSyntax)。在这种情况下，使用 [Joda 日期时间格式风格](https://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html)。

**语法**

```sql
fromUnixTimestampInJodaSyntax(timestamp)
fromUnixTimestampInJodaSyntax(timestamp, format[, timezone])
```

**参数**

- `timestamp` — Unix 时间戳或日期/时间值。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `format` — 可选。 使用 Joda 语法的输出格式常量字符串。 [`String`](/sql-reference/data-types/string)
- `timezone` — 可选。 常量时区字符串。 [`String`](/sql-reference/data-types/string)

**返回值**

在以一个参数调用时返回带时间的日期，或在以两个或三个参数调用时返回字符串。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`String`](/sql-reference/data-types/string)

**示例**

**以 Joda 格式转换 Unix 时间戳**

```sql title=Query
SELECT fromUnixTimestampInJodaSyntax(1234334543, 'yyyy-MM-dd HH:mm:ss', 'UTC') AS DateTime
```

```response title=Response
┌─DateTime────────────┐
│ 2009-02-11 06:42:23 │
└─────────────────────┘
```
## makeDate {#makeDate}

引入于：v22.6

从以下任一项创建 `Date`：
- 一年、一个月和一天
- 一年和一年中的第几天

**语法**

```sql
makeDate(year, month, day)
makeDate(year, day_of_year)
```

**参数**

- `year` — 年份数字。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `month` — 月份数字（1-12）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `day` — 该月的天数（1-31）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `day_of_year` — 年中的天数（1-365）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)

**返回值**

返回由提供的参数构造的 `Date` 值 [`Date`](/sql-reference/data-types/date)

**示例**

**从年份、月份和日期创建日期**

```sql title=Query
SELECT makeDate(2023, 2, 28) AS date;
```

```response title=Response
┌───────date─┐
│ 2023-02-28 │
└────────────┘
```

**从年份和一年中的第几天创建日期**

```sql title=Query
SELECT makeDate(2023, 42) AS date;
```

```response title=Response
┌───────date─┐
│ 2023-02-11 │
└────────────┘
```
## makeDate32 {#makeDate32}

引入于：v22.6

从以下任一项创建 `Date32`：
- 一年、一个月和一天
- 一年和一年中的第几天

**语法**

```sql
makeDate32(year, month, day)
makeDate32(year, day_of_year)
```

**参数**

- `year` — 年份数字。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `month` — 月份数字（1-12）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `day` — 该月的天数（1-31）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `day_of_year` — 年中的天数（1-365）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)

**返回值**

返回由提供的参数构造的 `Date32` 值 [`Date32`](/sql-reference/data-types/date32)

**示例**

**从年份、月份和日期创建 Date32**

```sql title=Query
SELECT makeDate(2023, 2, 28) AS date;
```

```response title=Response
┌───────date─┐
│ 2023-02-28 │
└────────────┘
```

**从年份和一年中的第几天创建 Date32**

```sql title=Query
SELECT makeDate(2023, 42) AS date;
```

```response title=Response
┌───────date─┐
│ 2023-02-11 │
└────────────┘
```
## makeDateTime {#makeDateTime}

引入于：v22.6

从年份、月份、日期、小时、分钟和秒创建 `DateTime`，可选的时区。

**语法**

```sql
makeDateTime(year, month, day, hour, minute, second[, timezone])
```

**参数**

- `year` — 年份数字。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `month` — 月份数字（1-12）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `day` — 该月的天数（1-31）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `hour` — 小时（0-23）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `minute` — 分钟（0-59）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `second` — 秒（0-59）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `timezone` — 时区名称。 [`String`](/sql-reference/data-types/string)

**返回值**

返回由提供的参数构造的 `DateTime` 值 [`DateTime`](/sql-reference/data-types/datetime)

**示例**

**从年份、月份、日期、小时、分钟、秒创建 DateTime**

```sql title=Query
SELECT makeDateTime(2023, 2, 28, 17, 12, 33) AS DateTime;
```

```response title=Response
┌────────────DateTime─┐
│ 2023-02-28 17:12:33 │
└─────────────────────┘
```
## makeDateTime64 {#makeDateTime64}

引入于：v22.6

从年份、月份、日期、小时、分钟、秒创建 `DateTime64`，可选的小数部分、精度和时区。

**语法**

```sql
makeDateTime64(year, month, day, hour, minute, second[, fraction[, precision[, timezone]]])
```

**参数**

- `year` — 年份数字。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `month` — 月份数字（1-12）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `day` — 该月的天数（1-31）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `hour` — 小时（0-23）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `minute` — 分钟（0-59）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `second` — 秒（0-59）。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `fraction` — 秒的小数部分。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float) 或 [`Decimal`](/sql-reference/data-types/decimal)
- `precision` — 小数部分的精度（0-9）。 [`UInt8`](/sql-reference/data-types/int-uint)
- `timezone` — 时区名称。 [`String`](/sql-reference/data-types/string)

**返回值**

返回由提供的参数构造的 `DateTime64` 值 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**从年份、月份、日期、小时、分钟、秒创建 DateTime64**

```sql title=Query
SELECT makeDateTime64(2023, 5, 15, 10, 30, 45, 779, 5);
```

```response title=Response
┌─makeDateTime64(2023, 5, 15, 10, 30, 45, 779, 5)─┐
│                       2023-05-15 10:30:45.00779 │
└─────────────────────────────────────────────────┘
```
## monthName {#monthName}

引入于：v22.1

从日期或带时间的日期中返回月份名称作为字符串。

**语法**

```sql
monthName(datetime)
```

**参数**

- `datetime` — 日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回月份的名称。 [`String`](/sql-reference/data-types/string)

**示例**

**从日期中获取月份名称**

```sql title=Query
WITH toDateTime('2021-04-14 11:22:33') AS date_value
SELECT monthName(date_value)
```

```response title=Response
┌─monthName(date_value)─┐
│ April                 │
└───────────────────────┘
```
## now {#now}

引入于：v1.1

在查询分析的瞬间返回当前日期和时间。此函数为常量表达式。

**语法**

```sql
now([timezone])
```

**参数**

- `timezone` — 可选。 返回值的时区名称。 [`String`](/sql-reference/data-types/string)

**返回值**

返回当前日期和时间。 [`DateTime`](/sql-reference/data-types/datetime)

**示例**

**没有时区的查询**

```sql title=Query
SELECT now()
```

```response title=Response
┌───────────────now()─┐
│ 2020-10-17 07:42:09 │
└─────────────────────┘
```

**带指定时区的查询**

```sql title=Query
SELECT now('Asia/Istanbul')
```

```response title=Response
┌─now('Asia/Istanbul')─┐
│  2020-10-17 10:42:23 │
└──────────────────────┘
```
## now64 {#now64}

引入于：v20.1

在查询分析的瞬间返回当前日期和时间，具有亚秒级精度。此函数为常量表达式。

**语法**

```sql
now64([scale], [timezone])
```

**参数**

- `scale` — 可选。 Tick 大小（精度）： 10^-precision 秒。有效范围：[0 : 9]。通常使用 - 3（默认）（毫秒），6（微秒），9（纳秒）。 [`UInt8`](/sql-reference/data-types/int-uint)
- `timezone` — 可选。 返回值的时区名称。 [`String`](/sql-reference/data-types/string)

**返回值**

返回带有亚秒级精度的当前日期和时间。 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**使用默认和自定义精度的查询**

```sql title=Query
SELECT now64(), now64(9, 'Asia/Istanbul')
```

```response title=Response
┌─────────────────now64()─┬─────now64(9, 'Asia/Istanbul')─┐
│ 2022-08-21 19:34:26.196 │ 2022-08-21 22:34:26.196542766 │
└─────────────────────────┴───────────────────────────────┘
```
## nowInBlock {#nowInBlock}

引入于：v22.8

在处理每个数据块的瞬间返回当前日期和时间。与函数 [`now`](#now) 不同，它不是常量表达式，因此对于长时间运行的查询，不同数据块的返回值将不同。

在长时间运行的 `INSERT SELECT` 查询中使用此函数生成当前时间是有意义的。

**语法**

```sql
nowInBlock([timezone])
```

**参数**

- `timezone` — 可选。 返回值的时区名称。 [`String`](/sql-reference/data-types/string)

**返回值**

在处理每个数据块的瞬间返回当前日期和时间。 [`DateTime`](/sql-reference/data-types/datetime)

**示例**

**与 now() 函数的区别**

```sql title=Query
SELECT
    now(),
    nowInBlock(),
    sleep(1)
FROM numbers(3)
SETTINGS max_block_size = 1
FORMAT PrettyCompactMonoBlock
```

```response title=Response
┌───────────────now()─┬────────nowInBlock()─┬─sleep(1)─┐
│ 2022-08-21 19:41:19 │ 2022-08-21 19:41:19 │        0 │
│ 2022-08-21 19:41:19 │ 2022-08-21 19:41:20 │        0 │
│ 2022-08-21 19:41:19 │ 2022-08-21 19:41:21 │        0 │
└─────────────────────┴─────────────────────┴──────────┘
```
## nowInBlock64 {#nowInBlock64}

引入于：v25.8

在处理每个数据块的瞬间返回当前日期和时间，单位为毫秒。与函数 [now64](#now64) 不同，它不是常量表达式，因此对于长时间运行的查询，不同数据块的返回值将不同。

在长时间运行的 `INSERT SELECT` 查询中使用此函数生成当前时间是有意义的。

**语法**

```sql
nowInBlock([scale[, timezone]])
```

**参数**

- `scale` — 可选。 Tick 大小（精度）： 10^-precision 秒。有效范围：[0 : 9]。通常使用 - 3（默认）（毫秒），6（微秒），9（纳秒）。 [`UInt8`](/sql-reference/data-types/int-uint)
- `timezone` — 可选。 返回值的时区名称。 [`String`](/sql-reference/data-types/string)

**返回值**

在处理每个数据块的瞬间返回带有亚秒级精度的当前日期和时间。 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**与 now64() 函数的区别**

```sql title=Query
SELECT
    now64(),
    nowInBlock64(),
    sleep(1)
FROM numbers(3)
SETTINGS max_block_size = 1
FORMAT PrettyCompactMonoBlock
```

```response title=Response
┌─────────────────now64()─┬──────────nowInBlock64()─┬─sleep(1)─┐
│ 2025-07-29 17:07:29.526 │ 2025-07-29 17:07:29.534 │        0 │
│ 2025-07-29 17:07:29.526 │ 2025-07-29 17:07:30.535 │        0 │
│ 2025-07-29 17:07:29.526 │ 2025-07-29 17:07:31.535 │        0 │
└─────────────────────────┴─────────────────────────┴──────────┘
```
## serverTimezone {#serverTimezone}

引入于：v23.6

返回服务器的时区，即 [`timezone`](/operations/server-configuration-parameters/settings#timezone) 设置的值。
如果在分布式表的上下文中执行此函数，则会生成与每个分片相关的正常列的值。否则则生成一个常量值。

**语法**

```sql
serverTimeZone()
```

**参数**

- 无
**返回值**

返回服务器时区，类型为 [`String`](/sql-reference/data-types/string)

**示例**

**使用示例**

```sql title=Query
SELECT serverTimeZone()
```

```response title=Response
┌─serverTimeZone()─┐
│ UTC              │
└──────────────────┘
```
## subDate {#subDate}

引入于：v23.9

从提供的日期、带时间的日期或字符串编码的日期或带时间中减去时间间隔。
如果减法结果超出数据类型的边界，结果是未定义的。

**语法**

```sql
subDate(datetime, interval)
```

**参数**

- `datetime` — 要减去 `interval` 的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `interval` — 要减去的间隔。 [`Interval`](/sql-reference/data-types/int-uint)

**返回值**

返回通过从 `datetime` 中减去 `interval` 获得的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**从日期中减去间隔**

```sql title=Query
SELECT subDate(toDate('2018-01-01'), INTERVAL 3 YEAR)
```

```response title=Response
┌─subDate(toDate('2018-01-01'), toIntervalYear(3))─┐
│                                       2015-01-01 │
└──────────────────────────────────────────────────┘
```
## subtractDays {#subtractDays}

引入于：v1.1

从日期、带时间的日期或字符串编码的日期或带时间中减去指定的天数。

**语法**

```sql
subtractDays(datetime, num)
```

**参数**

- `datetime` — 要从中减去指定天数的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64）或 [`String`](/sql-reference/data-types/string)
- `num` — 要减去的天数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**返回值**

返回 `datetime` 减去 `num` 天 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**从不同日期类型减去天数**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    subtractDays(date, 31) AS subtract_days_with_date,
    subtractDays(date_time, 31) AS subtract_days_with_date_time,
    subtractDays(date_time_string, 31) AS subtract_days_with_date_time_string
```

```response title=Response
┌─subtract_days_with_date─┬─subtract_days_with_date_time─┬─subtract_days_with_date_time_string─┐
│              2023-12-01 │          2023-12-01 00:00:00 │             2023-12-01 00:00:00.000 │
└─────────────────────────┴──────────────────────────────┴─────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateSub('1998-06-16'::Date, INTERVAL 10 day)
```

```response title=Response
┌─minus(CAST('⋯valDay(10))─┐
│               1998-06-06 │
└──────────────────────────┘
```
## subtractHours {#subtractHours}

引入于：v1.1

从日期、带时间的日期或字符串编码的日期或带时间中减去指定的小时数。

**语法**

```sql
subtractHours(datetime, num)
```

**参数**

- `datetime` — 要从中减去指定小时的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32）或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64）或 [`String`](/sql-reference/data-types/string)
- `num` — 要减去的小时数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**返回值**

返回 `datetime` 减去 `num` 小时 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64(3)`](/sql-reference/data-types/datetime64)

**示例**

**从不同日期类型减去小时数**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    subtractHours(date, 12) AS subtract_hours_with_date,
    subtractHours(date_time, 12) AS subtract_hours_with_date_time,
    subtractHours(date_time_string, 12) AS subtract_hours_with_date_time_string
```

```response title=Response
┌─subtract_hours_with_date─┬─subtract_hours_with_date_time─┬─subtract_hours_with_date_time_string─┐
│      2023-12-31 12:00:00 │           2023-12-31 12:00:00 │              2023-12-31 12:00:00.000 │
└──────────────────────────┴───────────────────────────────┴──────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateSub('1998-06-16'::Date, INTERVAL 10 hour)
```

```response title=Response
┌─minus(CAST('⋯alHour(10))─┐
│      1998-06-15 14:00:00 │
└──────────────────────────┘
```
## subtractInterval {#subtractInterval}

引入于：v22.11

将一个间隔的负值添加到另一个间隔或间隔元组中。

注意：相同类型的间隔将合并为一个单一的间隔。例如，如果传入 `toIntervalDay(2)` 和 `toIntervalDay(1)`，则结果将是 `(1)` 而不是 `(2,1)`。

**语法**

```sql
subtractInterval(interval_1, interval_2)
```

**参数**

- `interval_1` — 第一个间隔或间隔元组。 [`Interval`](/sql-reference/data-types/int-uint) 或 [`Tuple(Interval)`](/sql-reference/data-types/tuple)
- `interval_2` — 第二个间隔，将被取负。 [`Interval`](/sql-reference/data-types/int-uint)

**返回值**

返回间隔元组 [`Tuple(T)`](/sql-reference/data-types/tuple)

**示例**

**减去间隔**

```sql title=Query
SELECT subtractInterval(INTERVAL 1 DAY, INTERVAL 1 MONTH);
SELECT subtractInterval((INTERVAL 1 DAY, INTERVAL 1 YEAR), INTERVAL 1 MONTH);
SELECT subtractInterval(INTERVAL 2 DAY, INTERVAL 1 DAY);
```

```response title=Response
┌─subtractInterval(toIntervalDay(1), toIntervalMonth(1))─┐
│ (1,-1)                                                 │
└────────────────────────────────────────────────────────┘
┌─subtractInterval((toIntervalDay(1), toIntervalYear(1)), toIntervalMonth(1))─┐
│ (1,1,-1)                                                                    │
└─────────────────────────────────────────────────────────────────────────────┘
┌─subtractInterval(toIntervalDay(2), toIntervalDay(1))─┐
│ (1)                                                  │
└──────────────────────────────────────────────────────┘
```
## subtractMicroseconds {#subtractMicroseconds}

引入于：v22.6

从带时间的日期或字符串编码的带时间的日期中减去指定的微秒数。

**语法**

```sql
subtractMicroseconds(datetime, num)
```

**参数**

- `datetime` — 带时间的日期，减去指定的微秒数。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64）或 [`String`](/sql-reference/data-types/string)
- `num` — 要减去的微秒数。 [`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**返回值**

返回 `datetime` 减去 `num` 微秒 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**从不同日期时间类型减去微秒**

```sql title=Query
WITH
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    subtractMicroseconds(date_time, 1000000) AS subtract_microseconds_with_date_time,
    subtractMicroseconds(date_time_string, 1000000) AS subtract_microseconds_with_date_time_string
```

```response title=Response
┌─subtract_microseconds_with_date_time─┬─subtract_microseconds_with_date_time_string─┐
│           2023-12-31 23:59:59.000000 │                  2023-12-31 23:59:59.000000 │
└──────────────────────────────────────┴─────────────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateSub('1998-06-16'::DateTime, INTERVAL 10 microsecond)
```

```response title=Response
┌─minus(CAST('1⋯osecond(10))─┐
│ 1998-06-15 23:59:59.999990 │
└────────────────────────────┘
```

## subtractMilliseconds {#subtractMilliseconds}

引入于：v22.6

从带有时间的日期或字符串编码的带有时间的日期中减去指定数量的毫秒。

**语法**

```sql
subtractMilliseconds(datetime, num)
```

**参数**

- `datetime` — 要减去指定毫秒数的带有时间的日期。[`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要减去的毫秒数。[`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**返回值**

返回 `datetime` 减去 `num` 毫秒后的值 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**从不同日期时间类型中减去毫秒**

```sql title=Query
WITH
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    subtractMilliseconds(date_time, 1000) AS subtract_milliseconds_with_date_time,
    subtractMilliseconds(date_time_string, 1000) AS subtract_milliseconds_with_date_time_string
```

```response title=Response
┌─subtract_milliseconds_with_date_time─┬─subtract_milliseconds_with_date_time_string─┐
│              2023-12-31 23:59:59.000 │                     2023-12-31 23:59:59.000 │
└──────────────────────────────────────┴─────────────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateSub('1998-06-16'::DateTime, INTERVAL 10 millisecond)
```

```response title=Response
┌─minus(CAST('⋯second(10))─┐
│  1998-06-15 23:59:59.990 │
└──────────────────────────┘
```
## subtractMinutes {#subtractMinutes}

引入于：v1.1

从日期、带有时间的日期或字符串编码的日期或带有时间的日期中减去指定数量的分钟。

**语法**

```sql
subtractMinutes(datetime, num)
```

**参数**

- `datetime` — 要减去指定分钟数的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要减去的分钟数。[`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**返回值**

返回 `datetime` 减去 `num` 分钟后的值 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64(3)`](/sql-reference/data-types/datetime64)

**示例**

**从不同日期类型中减去分钟**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    subtractMinutes(date, 30) AS subtract_minutes_with_date,
    subtractMinutes(date_time, 30) AS subtract_minutes_with_date_time,
    subtractMinutes(date_time_string, 30) AS subtract_minutes_with_date_time_string
```

```response title=Response
┌─subtract_minutes_with_date─┬─subtract_minutes_with_date_time─┬─subtract_minutes_with_date_time_string─┐
│        2023-12-31 23:30:00 │             2023-12-31 23:30:00 │                2023-12-31 23:30:00.000 │
└────────────────────────────┴─────────────────────────────────┴────────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateSub('1998-06-16'::Date, INTERVAL 10 minute)
```

```response title=Response
┌─minus(CAST('⋯Minute(10))─┐
│      1998-06-15 23:50:00 │
└──────────────────────────┘
```
## subtractMonths {#subtractMonths}

引入于：v1.1

从日期、带有时间的日期或字符串编码的日期或带有时间的日期中减去指定数量的月份。

**语法**

```sql
subtractMonths(datetime, num)
```

**参数**

- `datetime` — 要减去指定月份数的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要减去的月份数。[`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**返回值**

返回 `datetime` 减去 `num` 个月后的值 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**从不同日期类型中减去月份**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    subtractMonths(date, 1) AS subtract_months_with_date,
    subtractMonths(date_time, 1) AS subtract_months_with_date_time,
    subtractMonths(date_time_string, 1) AS subtract_months_with_date_time_string
```

```response title=Response
┌─subtract_months_with_date─┬─subtract_months_with_date_time─┬─subtract_months_with_date_time_string─┐
│                2023-12-01 │            2023-12-01 00:00:00 │               2023-12-01 00:00:00.000 │
└───────────────────────────┴────────────────────────────────┴───────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateSub('1998-06-16'::Date, INTERVAL 10 month)
```

```response title=Response
┌─minus(CAST('⋯lMonth(10))─┐
│               1997-08-16 │
└──────────────────────────┘
```
## subtractNanoseconds {#subtractNanoseconds}

引入于：v20.1

从带有时间的日期或字符串编码的带有时间的日期中减去指定数量的纳秒。

**语法**

```sql
subtractNanoseconds(datetime, num)
```

**参数**

- `datetime` — 要减去指定纳秒数的带有时间的日期。[`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要减去的纳秒数。[`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**返回值**

返回 `datetime` 减去 `num` 纳秒后的值 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**从不同日期时间类型中减去纳秒**

```sql title=Query
WITH
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    subtractNanoseconds(date_time, 1000) AS subtract_nanoseconds_with_date_time,
    subtractNanoseconds(date_time_string, 1000) AS subtract_nanoseconds_with_date_time_string
```

```response title=Response
┌─subtract_nanoseconds_with_date_time─┬─subtract_nanoseconds_with_date_time_string─┐
│       2023-12-31 23:59:59.999999000 │              2023-12-31 23:59:59.999999000 │
└─────────────────────────────────────┴────────────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateSub('1998-06-16'::DateTime, INTERVAL 10 nanosecond)
```

```response title=Response
┌─minus(CAST('19⋯anosecond(10))─┐
│ 1998-06-15 23:59:59.999999990 │
└───────────────────────────────┘
```
## subtractQuarters {#subtractQuarters}

引入于：v20.1

从日期、带有时间的日期或字符串编码的日期或带有时间的日期中减去指定数量的季度。

**语法**

```sql
subtractQuarters(datetime, num)
```

**参数**

- `datetime` — 要减去指定季度数的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要减去的季度数。[`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**返回值**

返回 `datetime` 减去 `num` 季度后的值 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**从不同日期类型中减去季度**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    subtractQuarters(date, 1) AS subtract_quarters_with_date,
    subtractQuarters(date_time, 1) AS subtract_quarters_with_date_time,
    subtractQuarters(date_time_string, 1) AS subtract_quarters_with_date_time_string
```

```response title=Response
┌─subtract_quarters_with_date─┬─subtract_quarters_with_date_time─┬─subtract_quarters_with_date_time_string─┐
│                  2023-10-01 │              2023-10-01 00:00:00 │                 2023-10-01 00:00:00.000 │
└─────────────────────────────┴──────────────────────────────────┴─────────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateSub('1998-06-16'::Date, INTERVAL 10 quarter)
```

```response title=Response
┌─minus(CAST('1⋯Quarter(10))─┐
│                1996-09-16 │
└───────────────────────────┘
```
## subtractSeconds {#subtractSeconds}

引入于：v1.1

从日期、带有时间的日期或字符串编码的日期或带有时间的日期中减去指定数量的秒。

**语法**

```sql
subtractSeconds(datetime, num)
```

**参数**

- `datetime` — 要减去指定秒数的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要减去的秒数。[`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**返回值**

返回 `datetime` 减去 `num` 秒后的值 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64(3)`](/sql-reference/data-types/datetime64)

**示例**

**从不同日期类型中减去秒**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    subtractSeconds(date, 60) AS subtract_seconds_with_date,
    subtractSeconds(date_time, 60) AS subtract_seconds_with_date_time,
    subtractSeconds(date_time_string, 60) AS subtract_seconds_with_date_time_string
```

```response title=Response
┌─subtract_seconds_with_date─┬─subtract_seconds_with_date_time─┬─subtract_seconds_with_date_time_string─┐
│        2023-12-31 23:59:00 │             2023-12-31 23:59:00 │                2023-12-31 23:59:00.000 │
└────────────────────────────┴─────────────────────────────────┴────────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateSub('1998-06-16'::Date, INTERVAL 10 second)
```

```response title=Response
┌─minus(CAST('⋯Second(10))─┐
│      1998-06-15 23:59:50 │
└──────────────────────────┘
```
## subtractTupleOfIntervals {#subtractTupleOfIntervals}

引入于：v22.11

连续地从日期或带有时间的日期中减去一组间隔。

**语法**

```sql
subtractTupleOfIntervals(datetime, intervals)
```

**参数**

- `datetime` — 要减去间隔的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `intervals` — 要从 `datetime` 中减去的间隔元组。[`Tuple(Interval)`](/sql-reference/data-types/tuple)

**返回值**

返回减去 `intervals` 后的日期 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**从日期中减去间隔元组**

```sql title=Query
WITH toDate('2018-01-01') AS date SELECT subtractTupleOfIntervals(date, (INTERVAL 1 DAY, INTERVAL 1 YEAR))
```

```response title=Response
┌─subtractTupl⋯alYear(1)))─┐
│               2016-12-31 │
└──────────────────────────┘
```
## subtractWeeks {#subtractWeeks}

引入于：v1.1

从日期、带有时间的日期或字符串编码的日期或带有时间的日期中减去指定数量的周。

**语法**

```sql
subtractWeeks(datetime, num)
```

**参数**

- `datetime` — 要减去指定周数的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要减去的周数。[`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**返回值**

返回 `datetime` 减去 `num` 周后的值 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**从不同日期类型中减去周**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    subtractWeeks(date, 1) AS subtract_weeks_with_date,
    subtractWeeks(date_time, 1) AS subtract_weeks_with_date_time,
    subtractWeeks(date_time_string, 1) AS subtract_weeks_with_date_time_string
```

```response title=Response
┌─subtract_weeks_with_date─┬─subtract_weeks_with_date_time─┬─subtract_weeks_with_date_time_string─┐
│               2023-12-25 │           2023-12-25 00:00:00 │              2023-12-25 00:00:00.000 │
└──────────────────────────┴───────────────────────────────┴──────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateSub('1998-06-16'::Date, INTERVAL 10 week)
```

```response title=Response
┌─minus(CAST('⋯alWeek(10))─┐
│               1998-04-07 │
└──────────────────────────┘
```
## subtractYears {#subtractYears}

引入于：v1.1

从日期、带有时间的日期或字符串编码的日期或带有时间的日期中减去指定数量的年。

**语法**

```sql
subtractYears(datetime, num)
```

**参数**

- `datetime` — 要减去指定年数的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `num` — 要减去的年数。[`(U)Int*`](/sql-reference/data-types/int-uint) 或 [`Float*`](/sql-reference/data-types/float)

**返回值**

返回 `datetime` 减去 `num` 年后的值 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**从不同日期类型中减去年**

```sql title=Query
WITH
    toDate('2024-01-01') AS date,
    toDateTime('2024-01-01 00:00:00') AS date_time,
    '2024-01-01 00:00:00' AS date_time_string
SELECT
    subtractYears(date, 1) AS subtract_years_with_date,
    subtractYears(date_time, 1) AS subtract_years_with_date_time,
    subtractYears(date_time_string, 1) AS subtract_years_with_date_time_string
```

```response title=Response
┌─subtract_years_with_date─┬─subtract_years_with_date_time─┬─subtract_years_with_date_time_string─┐
│               2023-01-01 │           2023-01-01 00:00:00 │              2023-01-01 00:00:00.000 │
└──────────────────────────┴───────────────────────────────┴──────────────────────────────────────┘
```

**使用替代的 INTERVAL 语法**

```sql title=Query
SELECT dateSub('1998-06-16'::Date, INTERVAL 10 year)
```

```response title=Response
┌─minus(CAST('⋯alYear(10))─┐
│               1988-06-16 │
└──────────────────────────┘
```
## timeDiff {#timeDiff}

引入于：v23.4

返回 `startdate` 和 `enddate` 之间跨越的指定 `unit` 边界的数量。差异通过相对单位计算。例如，2021-12-29 和 2022-01-01 之间的差异为3天，单位为天（参见 [`toRelativeDayNum`](#toRelativeDayNum）），单位为月为1个月（参见 [`toRelativeMonthNum`](#toRelativeMonthNum）），单位为年为1年（参见 [`toRelativeYearNum`](#toRelativeYearNum））。

如果指定了单位 `week`，则 `timeDiff` 假定周从星期一开始。请注意，此行为与 `toWeek()` 函数的行为不同，后者默认周从星期天开始。

关于 [`timeDiff`](#timeDiff）的替代方案，请参见函数 [`age`](#age）。

**语法**

```sql
date_diff(unit, startdate, enddate, [timezone])
```

**参数**

- `unit` — 结果的间隔类型。

| 单位        | 可能的值                                      |
|-------------|-----------------------------------------------|
| nanosecond  | `nanosecond`, `nanoseconds`, `ns`             |
| microsecond | `microsecond`, `microseconds`, `us`, `u`      |
| millisecond | `millisecond`, `milliseconds`, `ms`           |
| second      | `second`, `seconds`, `ss`, `s`                |
| minute      | `minute`, `minutes`, `mi`, `n`                |
| hour        | `hour`, `hours`, `hh`, `h`                    |
| day         | `day`, `days`, `dd`, `d`                      |
| week        | `week`, `weeks`, `wk`, `ww`                   |
| month       | `month`, `months`, `mm`, `m`                  |
| quarter     | `quarter`, `quarters`, `qq`, `q`              |
| year        | `year`, `years`, `yyyy`, `yy`                 |
- `startdate` — 第一个时间值（被减数）。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `enddate` — 从中减去的第二个时间值（被减数）。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。时区名称。如果指定，应用于 `startdate` 和 `enddate`。如果未指定，则使用 `startdate` 和 `enddate` 的时区。如果它们不相同，则结果未定义。[`String`](/sql-reference/data-types/string)

**返回值**

返回以 `unit` 表示的 `enddate` 和 `startdate` 之间的差异。[`Int64`](/sql-reference/data-types/int-uint)

**示例**

**计算以小时为单位的日期差异**

```sql title=Query
SELECT timeDiff('hour', toDateTime('2018-01-01 22:00:00'), toDateTime('2018-01-02 23:00:00')) AS res
```

```response title=Response
┌─res─┐
│  25 │
└─────┘
```

**计算不同单位的日期差异**

```sql title=Query
SELECT
    toDate('2022-01-01') AS e,
    toDate('2021-12-29') AS s,
    timeDiff('day', s, e) AS day_diff,
    timeDiff('month', s, e) AS month_diff,
    timeDiff('year', s, e) AS year_diff
```

```response title=Response
┌──────────e─┬──────────s─┬─day_diff─┬─month_diff─┬─year_diff─┐
│ 2022-01-01 │ 2021-12-29 │        3 │          1 │         1 │
└────────────┴────────────┴──────────┴────────────┴───────────┘
```
## timeSlot {#timeSlot}

引入于：v1.1

将时间四舍五入到半小时长度间隔的开始。

:::note
虽然这个函数可以接收扩展类型 `Date32` 和 `DateTime64` 的值作为参数，但将其传递一个超出正常范围（1970 年至 2149 年的年份对于 `Date` / 2106 年对于 `DateTime`）的时间将产生错误结果。
:::

**语法**

```sql
timeSlot(time[, time_zone])
```

**参数**

- `time` — 要四舍五入到半小时长度间隔开始的时间。[`DateTime`](/sql-reference/data-types/datetime) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `time_zone` — 可选。一个字符串类型常量或表示时区的表达式。[`String`](/sql-reference/data-types/string)

**返回值**

返回四舍五入到半小时长度间隔开始的时间。[`DateTime`](/sql-reference/data-types/datetime)

**示例**

**将时间四舍五入到半小时间隔**

```sql title=Query
SELECT timeSlot(toDateTime('2000-01-02 03:04:05', 'UTC'))
```

```response title=Response
┌─timeSlot(toDateTime('2000-01-02 03:04:05', 'UTC'))─┐
│                                2000-01-02 03:00:00 │
└────────────────────────────────────────────────────┘
```
## timeSlots {#timeSlots}

引入于：v1.1

对于从 `StartTime` 开始并持续 `Duration` 秒的时间间隔，返回一组时间点，该点由从此间隔中向下取整到 `Size` 秒生成。`Size` 是一个可选参数，默认为 1800（30 分钟）。

这在例如搜索对应会话中的页面视图时是必要的。

对于 `DateTime64`，返回值的比例可能与 `StartTime` 的比例不同。会取所有给定参数中最高的比例。

**语法**

```sql
timeSlots(StartTime, Duration[, Size])
```

**参数**

- `StartTime` — 时间间隔的开始时间。[`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `Duration` — 以秒为单位的时间间隔的持续时间。[`UInt32`](/sql-reference/data-types/int-uint) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `Size` — 可选。时间段大小，单位为秒。默认值为 1800（30 分钟）。[`UInt32`](/sql-reference/data-types/int-uint) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回一个 DateTime/DateTime64 数组（返回类型与 `StartTime` 的类型匹配）。对于 DateTime64，返回值的比例可能与 `StartTime` 的比例不同 - 取所有给定参数中最高的比例。[`Array(DateTime)`](/sql-reference/data-types/array) 或 [`Array(DateTime64)`](/sql-reference/data-types/array)

**示例**

**生成时间段数组**

```sql title=Query
SELECT timeSlots(toDateTime('2012-01-01 12:20:00'), toUInt32(600));
SELECT timeSlots(toDateTime('1980-12-12 21:01:02', 'UTC'), toUInt32(600), 299);
SELECT timeSlots(toDateTime64('1980-12-12 21:01:02.1234', 4, 'UTC'), toDecimal64(600.1, 1), toDecimal64(299, 0))
```

```response title=Response
┌─timeSlots(toDateTime('2012-01-01 12:20:00'), toUInt32(600))─┐
│ ['2012-01-01 12:00:00','2012-01-01 12:30:00']               │
└─────────────────────────────────────────────────────────────┘
┌─timeSlots(toDateTime('1980-12-12 21:01:02', 'UTC'), toUInt32(600), 299)─┐
│ ['1980-12-12 20:56:13','1980-12-12 21:01:12','1980-12-12 21:06:11']     │
└─────────────────────────────────────────────────────────────────────────┘
┌─timeSlots(toDateTime64('1980-12-12 21:01:02.1234', 4, 'UTC'), toDecimal64(600.1, 1), toDecimal64(299, 0))─┐
│ ['1980-12-12 20:56:13.0000','1980-12-12 21:01:12.0000','1980-12-12 21:06:11.0000']                        │
└───────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```
## timestamp {#timestamp}

引入于：v23.9

将第一个参数 `expr` 转换为 [`DateTime64(6)`](/sql-reference/data-types/datetime64)。如果提供了第二个参数 `expr_time`，则将指定的时间添加到转换后的值中。

**语法**

```sql
timestamp(expr[, expr_time])
```

**参数**

- `expr` — 日期或带有时间的日期。[`String`](/sql-reference/data-types/string)
- `expr_time` — 可选。要添加到转换值的时间。[`String`](/sql-reference/data-types/string)

**返回值**

返回转换后的 `expr` 值，或添加时间后的 `expr` [`DateTime64(6)`](/sql-reference/data-types/datetime64)

**示例**

**将日期字符串转换为 DateTime64(6)**

```sql title=Query
SELECT timestamp('2023-12-31') AS ts;
```

```response title=Response
┌─────────────────────────ts─┐
│ 2023-12-31 00:00:00.000000 │
└────────────────────────────┘
```

**将时间添加到日期字符串**

```sql title=Query
SELECT timestamp('2023-12-31 12:00:00', '12:00:00.11') AS ts;
```

```response title=Response
┌─────────────────────────ts─┐
│ 2024-01-01 00:00:00.110000 │
└────────────────────────────┘
```
## timezone {#timezone}

引入于：v21.4

返回当前会话的时区名称或将时区偏移或名称转换为规范时区名称。

**语法**

```sql
timezone()
```

**参数**

- 无。

**返回值**

返回规格化的时区名称，作为 [`String`](/sql-reference/data-types/string)

**示例**

**用法示例**

```sql title=Query
SELECT timezone()
```

```response title=Response
┌─timezone()───────┐
│ Europe/Amsterdam │
└──────────────────┘
```
## timezoneOf {#timezoneOf}

引入于：v21.4

返回 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 值的时区名称。

**语法**

```sql
timeZoneOf(datetime)
```

**参数**

- `datetime` — 类型值。[`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。要转换 `datetime` 值时区的时区名称。[`String`](/sql-reference/data-types/string)

**返回值**

返回 `datetime` 的时区名称 [`String`](/sql-reference/data-types/string)

**示例**

**用法示例**

```sql title=Query
SELECT timezoneOf(now());
```

```response title=Response
┌─timezoneOf(now())─┐
│ Europe/Amsterdam  │
└───────────────────┘
```
## timezoneOffset {#timezoneOffset}

引入于：v21.6

返回与 [UTC](https://en.wikipedia.org/wiki/Coordinated_Universal_Time) 的时区偏移（以秒为单位）。该函数考虑了在指定日期和时间的夏令时和历史时区变化。

**语法**

```sql
timeZoneOffset(datetime)
```

**参数**

- `datetime` — 要获取时区偏移的 `DateTime` 值。[`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回与 UTC 的偏移，单位为秒 [`Int32`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT toDateTime('2021-04-21 10:20:30', 'America/New_York') AS Time,
toTypeName(Time) AS Type,
timeZoneOffset(Time) AS Offset_in_seconds,
(Offset_in_seconds / 3600) AS Offset_in_hours;
```

```response title=Response
┌────────────────Time─┬─Type─────────────────────────┬─Offset_in_seconds─┬─Offset_in_hours─┐
│ 2021-04-21 10:20:30 │ DateTime('America/New_York') │            -14400 │              -4 │
└─────────────────────┴──────────────────────────────┴───────────────────┴─────────────────┘
```
## toDayOfMonth {#toDayOfMonth}

引入于：v1.1

返回 `Date` 或 `DateTime` 的月份天数（1-31）。

**语法**

```sql
toDayOfMonth(datetime)
```

**参数**

- `datetime` — 要获取月份天数的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回给定日期/时间的月份日期 [`UInt8`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT toDayOfMonth(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toDayOfMonth(toDateTime('2023-04-21 10:20:30'))─┐
│                                              21 │
└─────────────────────────────────────────────────┘
```
## toDayOfWeek {#toDayOfWeek}

引入于：v1.1

返回 `Date` 或 `DateTime` 值在一周内的星期几号。

`toDayOfWeek()` 的双参数形式使您可以指定一周是从星期一还是星期天开始，并且返回值的范围是 0 到 6 还是 1 到 7。

| 模式 | 一周的第一天 | 范围                                      |
|------|---------------|-------------------------------------------|
| 0    | 星期一       | 1-7: 星期一 = 1, 星期二 = 2, ..., 星期天 = 7  |
| 1    | 星期一       | 0-6: 星期一 = 0, 星期二 = 1, ..., 星期天 = 6  |
| 2    | 星期天       | 0-6: 星期天 = 0, 星期一 = 1, ..., 星期六 = 6 |
| 3    | 星期天       | 1-7: 星期天 = 1, 星期一 = 2, ..., 星期六 = 7 |

**语法**

```sql
toDayOfWeek(datetime[, mode[, timezone]])
```

**参数**

- `datetime` — 要获取星期几的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `mode` — 可选。指定周模式的整数（0-3）。默认值为 0。如果省略，默认为 0。[`UInt8`](/sql-reference/data-types/int-uint)
- `timezone` — 可选。用于转换的时区。[`String`](/sql-reference/data-types/string)

**返回值**

返回给定 `Date` 或 `DateTime` 的星期几 [`UInt8`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
-- The following date is April 21, 2023, which was a Friday:
SELECT
    toDayOfWeek(toDateTime('2023-04-21')),
    toDayOfWeek(toDateTime('2023-04-21'), 1)
```

```response title=Response
┌─toDayOfWeek(toDateTime('2023-04-21'))─┬─toDayOfWeek(toDateTime('2023-04-21'), 1)─┐
│                                     5 │                                        4 │
└───────────────────────────────────────┴──────────────────────────────────────────┘
```
## toDayOfYear {#toDayOfYear}

引入于：v18.4

返回 `Date` 或 `DateTime` 值在一年中的日期号（1-366）。

**语法**

```sql
toDayOfYear(datetime)
```

**参数**

- `datetime` — 要获取年份天数的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回给定日期或 DateTime 的年份天数 [`UInt16`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT toDayOfYear(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toDayOfYear(toDateTime('2023-04-21 10:20:30'))─┐
│                                            111 │
└────────────────────────────────────────────────┘
```
## toDaysSinceYearZero {#toDaysSinceYearZero}

引入于：v23.9

对于给定日期，返回自 [公元 0000 年 1 月 1 日](https://en.wikipedia.org/wiki/Year_zero) 以来的天数，使用 [ISO 8601 定义的历法](https://en.wikipedia.org/wiki/Gregorian_calendar#Proleptic_Gregorian_calendar) 计算。

计算方法与 MySQL 的 [`TO_DAYS`](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_to-days) 函数相同。

**语法**

```sql
toDaysSinceYearZero(date[, time_zone])
```

**参数**

- `date` — 要计算自公元零年起天数的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `time_zone` — 时区。[`String`](/sql-reference/data-types/string)

**返回值**

返回自日期 `0000-01-01` 以来的天数。[`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**计算自公元零年起的天数**

```sql title=Query
SELECT toDaysSinceYearZero(toDate('2023-09-08'))
```

```response title=Response
┌─toDaysSinceYearZero(toDate('2023-09-08')))─┐
│                                     713569 │
└────────────────────────────────────────────┘
```
## toHour {#toHour}

引入于：v1.1

返回 `DateTime` 或 `DateTime64` 值的小时部分（0-23）。

**语法**

```sql
toHour(datetime)
```

**参数**

- `datetime` — 要获取小时的带有时间的日期。[`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回 `datetime` 的小时（0-23）。[`UInt8`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT toHour(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toHour(toDateTime('2023-04-21 10:20:30'))─┐
│                                        10 │
└───────────────────────────────────────────┘
```
## toISOYear {#toISOYear}

引入于：v18.4

将日期或带有时间的日期转换为 ISO 年号。

**语法**

```sql
toISOYear(datetime)
```

**参数**

- `datetime` — 带有日期或时间的值。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回输入值转换为ISO年号。[`UInt16`](/sql-reference/data-types/int-uint)

**示例**

**从日期值获取ISO年**

```sql title=Query
SELECT
toISOYear(toDate('2024/10/02')) as year1,
toISOYear(toDateTime('2024-10-02 01:30:00')) as year2
```

```response title=Response
┌─week1─┬─week2─┐
│    40 │    40 │
└───────┴───────┘
```
## toLastDayOfMonth {#toLastDayOfMonth}

引入于：v1.1

将日期或带有时间的日期四舍五入到该月的最后一天。

:::note
返回类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::

**语法**

```sql
toLastDayOfMonth(value)
```

**参数**

- `value` — 要四舍五入到该月最后一天的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回给定日期或带有时间的日期的该月最后一天的日期。[`Date`](/sql-reference/data-types/date)

**示例**

**四舍五入到该月的最后一天**

```sql title=Query
SELECT toLastDayOfMonth(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toLastDayOfMonth(toDateTime('2023-04-21 10:20:30'))─┐
│                                          2023-04-30 │
└─────────────────────────────────────────────────────┘
```
## toLastDayOfWeek {#toLastDayOfWeek}

引入于：v23.5

将日期或带有时间的日期四舍五入到最近的星期六或星期天。

:::note
返回类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::

**语法**

```sql
toLastDayOfWeek(datetime[, mode[, timezone]])
```

**参数**

- `datetime` — 要转换的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `mode` — 确定一周的第一天，如 `toWeek()` 函数中所述。默认值为 `0`。[`UInt8`](/sql-reference/data-types/int-uint)
- `timezone` — 可选。用于转换的时区。如果未指定，则使用服务器的时区。[`String`](/sql-reference/data-types/string)

**返回值**

返回给定日期之后最近的星期六或星期天的日期，具体取决于模式 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**四舍五入到最近的星期六或星期天**

```sql title=Query
SELECT
    toLastDayOfWeek(toDateTime('2023-04-21 10:20:30')), /* a Friday */
    toLastDayOfWeek(toDateTime('2023-04-21 10:20:30'), 1), /* a Friday */
    toLastDayOfWeek(toDate('2023-04-23')), /* a Sunday */
    toLastDayOfWeek(toDate('2023-04-23'), 1) /* a Sunday */
FORMAT Vertical
```

```response title=Response
Row 1:
──────
toLastDayOfWeek(toDateTime('2023-04-21 10:20:30')):      2023-04-23
toLastDayOfWeek(toDateTime('2023-04-21 10:20:30'), 1):   2023-04-22
toLastDayOfWeek(toDate('2023-04-23')):                   2023-04-23
toLastDayOfWeek(toDate('2023-04-23'), 1):                2023-04-23
```
## toMillisecond {#toMillisecond}

引入于：v24.2

返回 `DateTime` 或 `DateTime64` 值的毫秒部分（0-999）。

**语法**

```sql
toMillisecond(datetime)
```

**参数**

- `datetime` — 要获取毫秒的带有时间的日期。[`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回 `datetime` 中的毫秒（0 - 999）。[`UInt16`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT toMillisecond(toDateTime64('2023-04-21 10:20:30.456', 3));
```

```response title=Response
┌──toMillisecond(toDateTime64('2023-04-21 10:20:30.456', 3))─┐
│                                                        456 │
└────────────────────────────────────────────────────────────┘
```
## toMinute {#toMinute}

引入于：v1.1

返回 `Date` 或 `DateTime` 值的分钟部分（0-59）。

**语法**

```sql
toMinute(datetime)
```

**参数**

- `datetime` — 要获取分钟的带有时间的日期。[`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回 `datetime` 的分钟数（0 - 59）。[`UInt8`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT toMinute(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toMinute(toDateTime('2023-04-21 10:20:30'))─┐
│                                          20 │
└─────────────────────────────────────────────┘
```
## toModifiedJulianDay {#toModifiedJulianDay}

引入于：v21.1

将 [Proleptic Gregorian calendar](https://en.wikipedia.org/wiki/Proleptic_Gregorian_calendar) 形式的日期 `YYYY-MM-DD` 转换为 [Modified Julian Day](https://en.wikipedia.org/wiki/Julian_day#Variants) 编号（`Int32`）。此函数支持的日期范围从 `0000-01-01` 到 `9999-12-31`。如果参数无法解析为日期或日期无效，则会引发异常。

**语法**

```sql
toModifiedJulianDay(date)
```

**参数**

- `date` — 字符串形式的日期。[`String`](/sql-reference/data-types/string) 或 [`FixedString`](/sql-reference/data-types/fixedstring)

**返回值**

返回修改后的朱利安日编号。[`Int32`](/sql-reference/data-types/int-uint)

**示例**

**将日期转换为修改后的朱利安日**

```sql title=Query
SELECT toModifiedJulianDay('2020-01-01')
```

```response title=Response
┌─toModifiedJulianDay('2020-01-01')─┐
│                             58849 │
└───────────────────────────────────┘
```
## toModifiedJulianDayOrNull {#toModifiedJulianDayOrNull}

引入于：v21.1

类似于 [`toModifiedJulianDay()`](#toModifiedJulianDay)，但不再引发异常，而是返回 `NULL`。

**语法**

```sql
toModifiedJulianDayOrNull(date)
```

**参数**

- `date` — 字符串形式的日期。[`String`](/sql-reference/data-types/string) 或 [`FixedString`](/sql-reference/data-types/fixedstring)

**返回值**

对于有效的 `date` ，返回修改后的朱利安日编号，否则返回 `null`。[`Nullable(Int32)`](/sql-reference/data-types/nullable)

**示例**

**将日期转换为修改后的朱利安日，并处理 null**

```sql title=Query
SELECT toModifiedJulianDayOrNull('2020-01-01');
SELECT toModifiedJulianDayOrNull('0000-00-00'); -- invalid date, returns NULL
```

```response title=Response
┌─toModifiedJu⋯020-01-01')─┐
│                    58849 │
└──────────────────────────┘
┌─toModifiedJu⋯000-00-00')─┐
│                     ᴺᵁᴸᴸ │
└──────────────────────────┘
```
## toMonday {#toMonday}

引入于：v1.1

将日期或带有时间的日期向下取整到同一周的星期一。返回该日期。

:::note
返回类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::

**语法**

```sql
toMonday(value)
```

**参数**

- `value` — 要向下取整到本周星期一的日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回给定日期或带有时间的日期的同一周的星期一的日期。[`Date`](/sql-reference/data-types/date)

**示例**

**向下取整到本周的星期一**

```sql title=Query
SELECT
toMonday(toDateTime('2023-04-21 10:20:30')), -- A Friday
toMonday(toDate('2023-04-24'));              -- Already a Monday
```

```response title=Response
┌─toMonday(toDateTime('2023-04-21 10:20:30'))─┬─toMonday(toDate('2023-04-24'))─┐
│                                  2023-04-17 │                     2023-04-24 │
└─────────────────────────────────────────────┴────────────────────────────────┘
```
## toMonth {#toMonth}

引入于：v1.1

返回 `Date` 或 `DateTime` 值的月份部分（1-12）。

**语法**

```sql
toMonth(datetime)
```

**参数**

- `datetime` — 要获取月份的带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回给定日期/时间的月份 [`UInt8`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT toMonth(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toMonth(toDateTime('2023-04-21 10:20:30'))─┐
│                                          4 │
└────────────────────────────────────────────┘
```
## toMonthNumSinceEpoch {#toMonthNumSinceEpoch}

引入于：v25.3

返回自 1970 年以来经历的月份数。

**语法**

```sql
toMonthNumSinceEpoch(date)
```

**参数**

- `date` — 日期或带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

正整数

**示例**

**示例**

```sql title=Query
SELECT toMonthNumSinceEpoch(toDate('2024-10-01'))
```

```response title=Response
657
```
## toQuarter {#toQuarter}

引入于：v1.1

返回给定 `Date` 或 `DateTime` 值的季度（1-4）。

**语法**

```sql
toQuarter(datetime)
```

**参数**

- `datetime` — 要获取季度的带有时间的日期。[`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**返回值**

返回给定日期/时间的季度 [`UInt8`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT toQuarter(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toQuarter(toDateTime('2023-04-21 10:20:30'))─┐
│                                            2 │
└──────────────────────────────────────────────┘
```

## toRelativeDayNum {#toRelativeDayNum}

引入于：v1.1


将日期或带时间的日期转换为自过去某个固定点以来经过的天数。
确切的时间点是实现细节，因此此函数不打算单独使用。
该函数的主要目的在于计算两个日期或带时间的日期之间的天数差，例如 `toRelativeDayNum(dt1) - toRelativeDayNum(dt2)`。
    

**语法**

```sql
toRelativeDayNum(date)
```

**参数**

- `date` — 日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回自过去某个固定参考点以来的天数。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**获取相对日期数**

```sql title=Query
SELECT toRelativeDayNum(toDate('2023-04-01')) - toRelativeDayNum(toDate('2023-01-01'))
```

```response title=Response
┌─minus(toRela⋯3-01-01')))─┐
│                       90 │
└──────────────────────────┘
```
## toRelativeHourNum {#toRelativeHourNum}

引入于：v1.1


将日期或带时间的日期转换为自过去某个固定点以来经过的小时数。
确切的时间点是实现细节，因此此函数不打算单独使用。
该函数的主要目的在于计算两个日期或带时间的日期之间的小时差，例如 `toRelativeHourNum(dt1) - toRelativeHourNum(dt2)`。
    

**语法**

```sql
toRelativeHourNum(date)
```

**参数**

- `date` — 日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回自过去某个固定参考点以来的小时数。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**获取相对小时数**

```sql title=Query
SELECT toRelativeHourNum(toDateTime('2023-01-01 12:00:00')) - toRelativeHourNum(toDateTime('2023-01-01 00:00:00')) AS hours_difference
```

```response title=Response
┌─hours_difference─┐
│               12 │
└──────────────────┘
```
## toRelativeMinuteNum {#toRelativeMinuteNum}

引入于：v1.1


将日期或带时间的日期转换为自过去某个固定点以来经过的分钟数。
确切的时间点是实现细节，因此此函数不打算单独使用。
该函数的主要目的在于计算两个日期或带时间的日期之间的分钟差，例如 `toRelativeMinuteNum(dt1) - toRelativeMinuteNum(dt2)`。
    

**语法**

```sql
toRelativeMinuteNum(date)
```

**参数**

- `date` — 日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回自过去某个固定参考点以来的分钟数。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**获取相对分钟数**

```sql title=Query
SELECT toRelativeMinuteNum(toDateTime('2023-01-01 00:30:00')) - toRelativeMinuteNum(toDateTime('2023-01-01 00:00:00')) AS minutes_difference
```

```response title=Response
┌─minutes_difference─┐
│                 30 │
└────────────────────┘
```
## toRelativeMonthNum {#toRelativeMonthNum}

引入于：v1.1


将日期或带时间的日期转换为自过去某个固定点以来经过的月份数。
确切的时间点是实现细节，因此此函数不打算单独使用。
该函数的主要目的在于计算两个日期或带时间的日期之间的月份差，例如 `toRelativeMonthNum(dt1) - toRelativeMonthNum(dt2)`。
    

**语法**

```sql
toRelativeMonthNum(date)
```

**参数**

- `date` — 日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回自过去某个固定参考点以来的月份数。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**获取相对月份数**

```sql title=Query
SELECT toRelativeMonthNum(toDate('2023-04-01')) - toRelativeMonthNum(toDate('2023-01-01')) AS months_difference
```

```response title=Response
┌─months_difference─┐
│                 3 │
└───────────────────┘
```
## toRelativeQuarterNum {#toRelativeQuarterNum}

引入于：v1.1


将日期或带时间的日期转换为自过去某个固定点以来经过的季度数。
确切的时间点是实现细节，因此此函数不打算单独使用。
该函数的主要目的在于计算两个日期或带时间的日期之间的季度差，例如 `toRelativeQuarterNum(dt1) - toRelativeQuarterNum(dt2)`。
    

**语法**

```sql
toRelativeQuarterNum(date)
```

**参数**

- `date` — 日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回自过去某个固定参考点以来的季度数。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**获取相对季度数**

```sql title=Query
SELECT toRelativeQuarterNum(toDate('2023-04-01')) - toRelativeQuarterNum(toDate('2023-01-01')) AS quarters_difference
```

```response title=Response
┌─quarters_difference─┐
│                   1 │
└─────────────────────┘
```
## toRelativeSecondNum {#toRelativeSecondNum}

引入于：v1.1


将日期或带时间的日期转换为自过去某个固定点以来经过的秒数。
确切的时间点是实现细节，因此此函数不打算单独使用。
该函数的主要目的在于计算两个日期或带时间的日期之间的秒数差，例如 `toRelativeSecondNum(dt1) - toRelativeSecondNum(dt2)`。
    

**语法**

```sql
toRelativeSecondNum(date)
```

**参数**

- `date` — 日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回自过去某个固定参考点以来的秒数。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**获取相对秒数**

```sql title=Query
SELECT toRelativeSecondNum(toDateTime('2023-01-01 00:01:00')) - toRelativeSecondNum(toDateTime('2023-01-01 00:00:00')) AS seconds_difference
```

```response title=Response
┌─seconds_difference─┐
│                 60 │
└────────────────────┘
```
## toRelativeWeekNum {#toRelativeWeekNum}

引入于：v1.1


将日期或带时间的日期转换为自过去某个固定点以来经过的周数。
确切的时间点是实现细节，因此此函数不打算单独使用。
该函数的主要目的在于计算两个日期或带时间的日期之间的周数差，例如 `toRelativeWeekNum(dt1) - toRelativeWeekNum(dt2)`。
    

**语法**

```sql
toRelativeWeekNum(date)
```

**参数**

- `date` — 日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回自过去某个固定参考点以来的周数。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**获取相对周数**

```sql title=Query
SELECT toRelativeWeekNum(toDate('2023-01-08')) - toRelativeWeekNum(toDate('2023-01-01')) AS weeks_difference
```

```response title=Response
┌─weeks_difference─┐
│                1 │
└──────────────────┘
```
## toRelativeYearNum {#toRelativeYearNum}

引入于：v1.1


将日期或带时间的日期转换为自过去某个固定点以来经过的年数。
确切的时间点是实现细节，因此此函数不打算单独使用。
该函数的主要目的在于计算两个日期或带时间的日期之间的年数差，例如 `toRelativeYearNum(dt1) - toRelativeYearNum(dt2)`。
    

**语法**

```sql
toRelativeYearNum(date)
```

**参数**

- `date` — 日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回自过去某个固定参考点以来的年数。 [`UInt16`](/sql-reference/data-types/int-uint)

**示例**

**获取相对年份数**

```sql title=Query
SELECT toRelativeYearNum('2010-10-01'::DateTime) - toRelativeYearNum('2000-01-01'::DateTime)
```

```response title=Response
┌─minus(toRela⋯ateTime')))─┐
│                       10 │
└──────────────────────────┘
```
## toSecond {#toSecond}

引入于：v1.1


返回 `DateTime` 或 `DateTime64` 值的秒部分（0-59）。
        

**语法**

```sql
toSecond(datetime)
```

**参数**

- `datetime` — 从中获取秒的带时间日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回 `datetime` 中的秒（0 - 59）。 [`UInt8`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT toSecond(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toSecond(toDateTime('2023-04-21 10:20:30'))─┐
│                                          30 │
└─────────────────────────────────────────────┘
```
## toStartOfDay {#toStartOfDay}

引入于：v1.1


将带时间的日期向下舍入到一天的开始。

:::note
返回值类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::
    

**语法**

```sql
toStartOfDay(datetime)
```

**参数**

- `datetime` — 要舍入的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime)


**返回值**

返回向下舍入到一天开始的带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**舍入到一天的开始**

```sql title=Query
SELECT toStartOfDay(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toStartOfDay(toDateTime('2023-04-21 10:20:30'))─┐
│                             2023-04-21 00:00:00 │
└─────────────────────────────────────────────────┘
```
## toStartOfFifteenMinutes {#toStartOfFifteenMinutes}

引入于：v1.1


将带时间的日期向下舍入到十五分钟间隔的开始。

:::note
返回值类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::
    

**语法**

```sql
toStartOfFifteenMinutes(datetime)
```

**参数**

- `datetime` — 要舍入的日期或带时间的日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回向下舍入到最近的十五分钟间隔的带时间的日期 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**示例**

```sql title=Query
SELECT
    toStartOfFifteenMinutes(toDateTime('2023-04-21 10:17:00')),
    toStartOfFifteenMinutes(toDateTime('2023-04-21 10:20:00')),
    toStartOfFifteenMinutes(toDateTime('2023-04-21 10:23:00'))
FORMAT Vertical
```

```response title=Response
Row 1:
──────
toStartOfFifteenMinutes(toDateTime('2023-04-21 10:17:00')): 2023-04-21 10:15:00
toStartOfFifteenMinutes(toDateTime('2023-04-21 10:20:00')): 2023-04-21 10:15:00
toStartOfFifteenMinutes(toDateTime('2023-04-21 10:23:00')): 2023-04-21 10:15:00
```
## toStartOfFiveMinutes {#toStartOfFiveMinutes}

引入于：v22.6


将带时间的日期向下舍入到最近的五分钟间隔的开始。

:::note
返回值类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::
    

**语法**

```sql
toStartOfFiveMinutes(datetime)
```

**参数**

- `datetime` — 带时间的日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回向下舍入到最近的五分钟间隔的带时间的日期 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**示例**

```sql title=Query
SELECT
    toStartOfFiveMinutes(toDateTime('2023-04-21 10:17:00')),
    toStartOfFiveMinutes(toDateTime('2023-04-21 10:20:00')),
    toStartOfFiveMinutes(toDateTime('2023-04-21 10:23:00'))
FORMAT Vertical
```

```response title=Response
Row 1:
──────
toStartOfFiveMinutes(toDateTime('2023-04-21 10:17:00')): 2023-04-21 10:15:00
toStartOfFiveMinutes(toDateTime('2023-04-21 10:20:00')): 2023-04-21 10:20:00
toStartOfFiveMinutes(toDateTime('2023-04-21 10:23:00')): 2023-04-21 10:20:00
```
## toStartOfHour {#toStartOfHour}

引入于：v1.1


将带时间的日期向下舍入到小时的开始。

:::note
返回值类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::
    

**语法**

```sql
toStartOfHour(datetime)
```

**参数**

- `datetime` — 带时间的日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回向下舍入到小时开始的带时间的日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**舍入到小时的开始**

```sql title=Query
SELECT
    toStartOfHour(toDateTime('2023-04-21 10:20:30'));
```

```response title=Response
┌─────────────────res─┬─toTypeName(res)─┐
│ 2023-04-21 10:00:00 │ DateTime        │
└─────────────────────┴─────────────────┘
```
## toStartOfISOYear {#toStartOfISOYear}

引入于：v1.1


将日期或带时间的日期向下舍入到ISO年第一天，ISO年可能与常规年份不同。请参见 [ISO week date](https://en.wikipedia.org/wiki/ISO_week_date)。

:::note
返回值类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::
    

**语法**

```sql
toStartOfISOYear(value)
```

**参数**

- `value` — 要向下舍入到ISO年第一天的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回给定日期或带时间的日期的ISO年第一天。 [`Date`](/sql-reference/data-types/date)

**示例**

**向下舍入到ISO年第一天**

```sql title=Query
SELECT toStartOfISOYear(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toStartOfISOYear(toDateTime('2023-04-21 10:20:30'))─┐
│                                          2023-01-02 │
└─────────────────────────────────────────────────────┘
```
## toStartOfInterval {#toStartOfInterval}

引入于：v20.1


此函数通过 `toStartOfInterval(date_or_date_with_time, INTERVAL x unit [, time_zone])` 语法对其他 `toStartOf*()` 函数进行了通用化。

例如，
- `toStartOfInterval(t, INTERVAL 1 YEAR)` 返回与 `toStartOfYear(t)` 相同的结果，
- `toStartOfInterval(t, INTERVAL 1 MONTH)` 返回与 `toStartOfMonth(t)` 相同的结果，
- `toStartOfInterval(t, INTERVAL 1 DAY)` 返回与 `toStartOfDay(t)` 相同的结果，
- `toStartOfInterval(t, INTERVAL 15 MINUTE)` 返回与 `toStartOfFifteenMinutes(t)` 相同的结果。

计算是相对于特定时间点进行的：

| 间隔      | 开始                   |
|-----------|------------------------|
| YEAR      | 年 0                   |
| QUARTER   | 1900 Q1                |
| MONTH     | 1900年1月             |
| WEEK      | 1970年第1周 (01-05)    |
| DAY       | 1970-01-01             |
| HOUR      | (*)                    |
| MINUTE    | 1970-01-01 00:00:00    |
| SECOND    | 1970-01-01 00:00:00    |
| MILLISECOND | 1970-01-01 00:00:00    |
| MICROSECOND | 1970-01-01 00:00:00    |
| NANOSECOND  | 1970-01-01 00:00:00    |
| (*) 小时间隔为特殊情况：计算始终相对于当天的00:00:00（午夜）进行。因此，只有1到23之间的小时值是有用的。

如果指定了单位 `WEEK`，`toStartOfInterval` 假定周从星期一开始。请注意，该行为不同于默认从星期日开始的 `toStartOfWeek` 函数。

第二个重载模拟了 TimescaleDB 的 `time_bucket()` 函数，以及 PostgreSQL 的 `date_bin()` 函数。
        

**语法**

```sql
toStartOfInterval(value, INTERVAL x unit[, time_zone])
toStartOfInterval(value, INTERVAL x unit[, origin[, time_zone]])
```

**参数**

- `value` — 要向下舍入的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `x` — 间隔长度数。 - `unit` — 间隔单位：YEAR, QUARTER, MONTH, WEEK, DAY, HOUR, MINUTE, SECOND, MILLISECOND, MICROSECOND, NANOSECOND。 - `time_zone` — 可选。作为字符串的时区名称。 - `origin` — 可选。用于计算的起点（仅适用于第二个重载）。 

**返回值**

返回包含输入值的间隔开始。 [`DateTime`](/sql-reference/data-types/datetime)

**示例**

**基本间隔舍入**

```sql title=Query
SELECT toStartOfInterval(toDateTime('2023-01-15 14:30:00'), INTERVAL 1 MONTH)
```

```response title=Response
┌─toStartOfInt⋯alMonth(1))─┐
│               2023-01-01 │
└──────────────────────────┘
```

**使用起点**

```sql title=Query
SELECT toStartOfInterval(toDateTime('2023-01-01 14:45:00'), INTERVAL 1 MINUTE, toDateTime('2023-01-01 14:35:30'))
```

```response title=Response
┌─toStartOfInt⋯14:35:30'))─┐
│      2023-01-01 14:44:30 │
└──────────────────────────┘
```
## toStartOfMicrosecond {#toStartOfMicrosecond}

引入于：v22.6


将带时间的日期向下舍入到微秒的开始。
    

**语法**

```sql
toStartOfMicrosecond(datetime, [timezone])
```

**参数**

- `datetime` — 日期和时间。 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。返回值的时区。如果未指定，函数将使用 `value` 参数的时区。 [`String`](/sql-reference/data-types/string)


**返回值**

输入值的微秒部分 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**无时区的查询**

```sql title=Query
WITH toDateTime64('2020-01-01 10:20:30.999999999', 9) AS dt64
SELECT toStartOfMicrosecond(dt64);
```

```response title=Response
┌────toStartOfMicrosecond(dt64)─┐
│ 2020-01-01 10:20:30.999999000 │
└───────────────────────────────┘
```

**带时区的查询**

```sql title=Query
WITH toDateTime64('2020-01-01 10:20:30.999999999', 9) AS dt64
SELECT toStartOfMicrosecond(dt64, 'Asia/Istanbul');
```

```response title=Response
┌─toStartOfMicrosecond(dt64, 'Asia/Istanbul')─┐
│               2020-01-01 12:20:30.999999000 │
└─────────────────────────────────────────────┘
```
## toStartOfMillisecond {#toStartOfMillisecond}

引入于：v22.6


将带时间的日期向下舍入到毫秒的开始。
    

**语法**

```sql
toStartOfMillisecond(datetime, [timezone])
```

**参数**

- `datetime` — 日期和时间。 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。返回值的时区。如果未指定，函数将使用 `value` 参数的时区。 [`String`](/sql-reference/data-types/string)


**返回值**

输入值的毫秒部分。 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**无时区的查询**

```sql title=Query
WITH toDateTime64('2020-01-01 10:20:30.999999999', 9) AS dt64
SELECT toStartOfMillisecond(dt64);
```

```response title=Response
┌────toStartOfMillisecond(dt64)─┐
│ 2020-01-01 10:20:30.999000000 │
└───────────────────────────────┘
```

**带时区的查询**

```sql title=Query
WITH toDateTime64('2020-01-01 10:20:30.999999999', 9) AS dt64
SELECT toStartOfMillisecond(dt64, 'Asia/Istanbul');
```

```response title=Response
┌─toStartOfMillisecond(dt64, 'Asia/Istanbul')─┐
│               2020-01-01 12:20:30.999000000 │
└─────────────────────────────────────────────┘
```
## toStartOfMinute {#toStartOfMinute}

引入于：v1.1


将带时间的日期向下舍入到分钟的开始。

:::note
返回值类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::
    

**语法**

```sql
toStartOfMinute(datetime)
```

**参数**

- `datetime` — 要舍入的带时间日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回向下舍入到分钟开始的带时间日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**舍入到分钟的开始**

```sql title=Query
SELECT
    toStartOfMinute(toDateTime('2023-04-21 10:20:30')),
    toStartOfMinute(toDateTime64('2023-04-21 10:20:30.5300', 8))
FORMAT Vertical
```

```response title=Response
Row 1:
──────
toStartOfMinute(toDateTime('2023-04-21 10:20:30')):           2023-04-21 10:20:00
toStartOfMinute(toDateTime64('2023-04-21 10:20:30.5300', 8)): 2023-04-21 10:20:00
```
## toStartOfMonth {#toStartOfMonth}

引入于：v1.1


将日期或带时间的日期向下舍入到本月的第一天。

:::note
返回值类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::
    

**语法**

```sql
toStartOfMonth(value)
```

**参数**

- `value` — 要向下舍入到本月第一天的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回给定日期或带时间的日期的本月第一天。 [`Date`](/sql-reference/data-types/date)

**示例**

**向下舍入到本月的第一天**

```sql title=Query
SELECT toStartOfMonth(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toStartOfMonth(toDateTime('2023-04-21 10:20:30'))─┐
│                                        2023-04-01 │
└───────────────────────────────────────────────────┘
```
## toStartOfNanosecond {#toStartOfNanosecond}

引入于：v22.6


将带时间的日期向下舍入到纳秒的开始。
        

**语法**

```sql
toStartOfNanosecond(datetime, [timezone])
```

**参数**

- `datetime` — 日期和时间。 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。返回值的时区。如果未指定，函数将使用 `value` 参数的时区。 [`String`](/sql-reference/data-types/string)


**返回值**

输入值的纳秒部分。 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**无时区的查询**

```sql title=Query
WITH toDateTime64('2020-01-01 10:20:30.999999999', 9) AS dt64
SELECT toStartOfNanosecond(dt64);
```

```response title=Response
┌─────toStartOfNanosecond(dt64)─┐
│ 2020-01-01 10:20:30.999999999 │
└───────────────────────────────┘
```

**带时区的查询**

```sql title=Query
WITH toDateTime64('2020-01-01 10:20:30.999999999', 9) AS dt64
SELECT toStartOfNanosecond(dt64, 'Asia/Istanbul');
```

```response title=Response
┌─toStartOfNanosecond(dt64, 'Asia/Istanbul')─┐
│              2020-01-01 12:20:30.999999999 │
└────────────────────────────────────────────┘
```
## toStartOfQuarter {#toStartOfQuarter}

引入于：v1.1


将日期或带时间的日期向下舍入到季度的第一天。季度的第一天是每年的1月1日、4月1日、7月1日或10月1日。

:::note
返回值类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::
    

**语法**

```sql
toStartOfQuarter(value)
```

**参数**

- `value` — 要向下舍入到季度第一天的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回给定日期或带时间的日期的季度第一天。 [`Date`](/sql-reference/data-types/date)

**示例**

**向下舍入到季度的第一天**

```sql title=Query
SELECT toStartOfQuarter(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toStartOfQuarter(toDateTime('2023-04-21 10:20:30'))─┐
│                                          2023-04-01 │
└─────────────────────────────────────────────────────┘
```
## toStartOfSecond {#toStartOfSecond}

引入于：v20.5


将带时间的日期向下舍入到秒的开始。
    

**语法**

```sql
toStartOfSecond(datetime, [timezone])
```

**参数**

- `datetime` — 日期和时间以截断亚秒。 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。返回值的时区。如果未指定，函数将使用 `value` 参数的时区。 [`String`](/sql-reference/data-types/string)


**返回值**

返回输入值，而没有亚秒部分。 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**无时区的查询**

```sql title=Query
WITH toDateTime64('2020-01-01 10:20:30.999', 3) AS dt64
SELECT toStartOfSecond(dt64);
```

```response title=Response
┌───toStartOfSecond(dt64)─┐
│ 2020-01-01 10:20:30.000 │
└─────────────────────────┘
```

**带时区的查询**

```sql title=Query
WITH toDateTime64('2020-01-01 10:20:30.999', 3) AS dt64
SELECT toStartOfSecond(dt64, 'Asia/Istanbul');
```

```response title=Response
┌─toStartOfSecond(dt64, 'Asia/Istanbul')─┐
│                2020-01-01 13:20:30.000 │
└────────────────────────────────────────┘
```
## toStartOfTenMinutes {#toStartOfTenMinutes}

引入于：v20.1


将带时间的日期向下舍入到最近的十分钟间隔的开始。

:::note
返回值类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::
    

**语法**

```sql
toStartOfTenMinutes(datetime)
```

**参数**

- `datetime` — 带时间的日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回向下舍入到最近的十分钟间隔的带时间的日期 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**示例**

```sql title=Query
SELECT
    toStartOfTenMinutes(toDateTime('2023-04-21 10:17:00')),
    toStartOfTenMinutes(toDateTime('2023-04-21 10:20:00')),
    toStartOfTenMinutes(toDateTime('2023-04-21 10:23:00'))
FORMAT Vertical
```

```response title=Response
Row 1:
──────
toStartOfTenMinutes(toDateTime('2023-04-21 10:17:00')): 2023-04-21 10:10:00
toStartOfTenMinutes(toDateTime('2023-04-21 10:20:00')): 2023-04-21 10:20:00
toStartOfTenMinutes(toDateTime('2023-04-21 10:23:00')): 2023-04-21 10:20:00
```
## toStartOfWeek {#toStartOfWeek}

引入于：v20.1


将日期或带时间的日期舍入到最近的星期日或星期一。

:::note
返回值类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::
    

**语法**

```sql
toStartOfWeek(datetime[, mode[, timezone]])
```

**参数**

- `datetime` — 要转换的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `mode` — 确定一周的第一天，如 `toWeek()` 函数中所述。 默认值为 `0`。 [`UInt8`](/sql-reference/data-types/int-uint)
- `timezone` — 用于转换的时区。如果未指定，将使用服务器的时区。 [`String`](/sql-reference/data-types/string)


**返回值**

返回在给定日期之前或最近的星期日或星期一的日期，具体取决于模式 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**舍入到最近的星期日或星期一**

```sql title=Query
SELECT
        toStartOfWeek(toDateTime('2023-04-21 10:20:30')), /* a Friday */
        toStartOfWeek(toDateTime('2023-04-21 10:20:30'), 1), /* a Friday */
        toStartOfWeek(toDate('2023-04-24')), /* a Monday */
        toStartOfWeek(toDate('2023-04-24'), 1) /* a Monday */
    FORMAT Vertical
```

```response title=Response
Row 1:
    ──────
    toStartOfWeek(toDateTime('2023-04-21 10:20:30')):      2023-04-17
    toStartOfWeek(toDateTime('2023-04-21 10:20:30'), 1):   2023-04-17
    toStartOfWeek(toDate('2023-04-24')):                   2023-04-24
    toStartOfWeek(toDate('2023-04-24'), 1):                2023-04-24
```
## toStartOfYear {#toStartOfYear}

引入于：v1.1


将日期或带时间的日期向下舍入到这一年的第一天。返回的日期为 `Date` 对象。

:::note
返回值类型可以通过设置 [`enable_extended_results_for_datetime_functions`](/operations/settings/settings#enable_extended_results_for_datetime_functions) 来配置。
:::
    

**语法**

```sql
toStartOfYear(value)
```

**参数**

- `value` — 要舍入的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回给定日期/时间的这一年的第一天 [`Date`](/sql-reference/data-types/date)

**示例**

**向下舍入到这一年的第一天**

```sql title=Query
SELECT toStartOfYear(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toStartOfYear(toDateTime('2023-04-21 10:20:30'))─┐
│                                       2023-01-01 │
└──────────────────────────────────────────────────┘
```
## toTimeWithFixedDate {#toTimeWithFixedDate}

引入于：v1.1


提取日期或带时间的日期的时间部分。
返回的结果是相对于固定时间点的偏移量，目前为 `1970-01-02`，
但确切的时间点是实现细节，将来可能会改变。

因此，`toTime` 不应单独使用。
该函数的主要目的是计算两个日期或带时间的日期之间的时间差，例如 `toTime(dt1) - toTime(dt2)`。
    

**语法**

```sql
toTime(date[, timezone])
```

**参数**

- `date` — 要转换为时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。返回值的时区。 [`String`](/sql-reference/data-types/string)


**返回值**

以偏移量的形式返回日期或带时间的日期的时间部分（选定为1970-01-02） [`DateTime`](/sql-reference/data-types/datetime)

**示例**

**计算两个日期之间的时间差**

```sql title=Query
SELECT toTime('2025-06-15 12:00:00'::DateTime) - toTime('2024-05-10 11:00:00'::DateTime) AS result, toTypeName(result)
```

```response title=Response
┌─result─┬─toTypeName(result)─┐
│   3600 │ Int32              │
└────────┴────────────────────┘
```
## toTimezone {#toTimezone}

引入于：v1.1


将 `DateTime` 或 `DateTime64` 转换为指定的时区。
数据的内部值（unix秒数）不会改变。
只有值的时区属性和字符串表示发生变化。
        

**语法**

```sql
toTimeZone(datetime, timezone)
```

**参数**

- `date` — 要转换的值。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 目标时区名称。 [`String`](/sql-reference/data-types/string)


**返回值**

返回与输入相同的时间戳，但时区为指定的时区 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**用法示例**

```sql title=Query
SELECT toDateTime('2019-01-01 00:00:00', 'UTC') AS time_utc,
toTypeName(time_utc) AS type_utc,
toInt32(time_utc) AS int32utc,
toTimeZone(time_utc, 'Asia/Yekaterinburg') AS time_yekat,
toTypeName(time_yekat) AS type_yekat,
toInt32(time_yekat) AS int32yekat,
toTimeZone(time_utc, 'US/Samoa') AS time_samoa,
toTypeName(time_samoa) AS type_samoa,
toInt32(time_samoa) AS int32samoa
FORMAT Vertical;
```

```response title=Response
Row 1:
──────
time_utc:   2019-01-01 00:00:00
type_utc:   DateTime('UTC')
int32utc:   1546300800
time_yekat: 2019-01-01 05:00:00
type_yekat: DateTime('Asia/Yekaterinburg')
int32yekat: 1546300800
time_samoa: 2018-12-31 13:00:00
type_samoa: DateTime('US/Samoa')
int32samoa: 1546300800
```
## toUTCTimestamp {#toUTCTimestamp}

引入于：v23.8


将日期或带时间的值从一个时区转换为 UTC 时区时间戳。此函数主要是为了与 Apache Spark 和类似框架的兼容性。
    

**语法**

```sql
toUTCTimestamp(datetime, time_zone)
```

**参数**

- `datetime` — 日期或带时间类型的常量值或表达式。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `time_zone` — 字符串类型常量值或表示时区的表达式。 [`String`](/sql-reference/data-types/string)


**返回值**

返回 UTC 时区中的日期或带时间的日期。 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)

**示例**

**将时区转换为 UTC**

```sql title=Query
SELECT toUTCTimestamp(toDateTime('2023-03-16'), 'Asia/Shanghai')
```

```response title=Response
┌─toUTCTimestamp(toDateTime('2023-03-16'), 'Asia/Shanghai')─┐
│                                     2023-03-15 16:00:00 │
└─────────────────────────────────────────────────────────┘
```
## toUnixTimestamp {#toUnixTimestamp}

引入于：v1.1


将 `String`、`Date` 或 `DateTime` 转换为 Unix 时间戳（自 `1970-01-01 00:00:00 UTC` 起的秒数），返回类型为 `UInt32`。
    

**语法**

```sql
toUnixTimestamp(date, [timezone])
```

**参数**

- `date` — 要转换的值。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64) 或 [`String`](/sql-reference/data-types/string)
- `timezone` — 可选。用于转换的时区。如果未指定，将使用服务器的时区。 [`String`](/sql-reference/data-types/string)


**返回值**

返回 Unix 时间戳。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT
'2017-11-05 08:07:47' AS dt_str,
toUnixTimestamp(dt_str) AS from_str,
toUnixTimestamp(dt_str, 'Asia/Tokyo') AS from_str_tokyo,
toUnixTimestamp(toDateTime(dt_str)) AS from_datetime,
toUnixTimestamp(toDateTime64(dt_str, 0)) AS from_datetime64,
toUnixTimestamp(toDate(dt_str)) AS from_date,
toUnixTimestamp(toDate32(dt_str)) AS from_date32
FORMAT Vertical;
```

```response title=Response
Row 1:
──────
dt_str:          2017-11-05 08:07:47
from_str:        1509869267
from_str_tokyo:  1509836867
from_datetime:   1509869267
from_datetime64: 1509869267
from_date:       1509840000
from_date32:     1509840000
```
## toWeek {#toWeek}

引入于：v20.1


该函数返回日期或日期时间的周数。`toWeek()` 的两个参数形式使您能够指定一周的起始日
为星期日或星期一，以及返回值是否应该在 `0` 到 `53` 的范围内，还是在 `1` 到 `53` 的范围内。

[`toISOWeek()`](#toWeek) 是一个兼容性函数，相当于 `toWeek(date,3)`。

下表描述了模式参数的运作方式。

| 模式 | 一周的第一天 | 范围 | 第1周是包含在此年的第一周...   |
|------|---------------|-----|-----------------------------------|
| 0    | 星期日        | 0-53 | 此年内包含星期日                |
| 1    | 星期一        | 0-53 | 此年内有4天及以上               |
| 2    | 星期日        | 1-53 | 此年内包含星期日                |
| 3    | 星期一        | 1-53 | 此年内有4天及以上               |
| 4    | 星期日        | 0-53 | 此年内有4天及以上               |
| 5    | 星期一        | 0-53 | 此年内包含星期一                |
| 6    | 星期日        | 1-53 | 此年内有4天及以上               |
| 7    | 星期一        | 1-53 | 此年内包含星期一                |
| 8    | 星期日        | 1-53 | 包含1月1日                      |
| 9    | 星期一        | 1-53 | 包含1月1日                      |

对于具有"此年内有4天及以上"含义的模式值，周的编号遵循 ISO 8601:1988：

- 如果包含1月1日的周在新的一年中有4天或更多，则为第1周。
- 否则，它是上一年的最后一周，下一周为第1周。

对于具有"包含1月1日"含义的模式值，包含1月1日的周为第1周。
这不论新年中包含多少天，即使只包含一天。
即，如果12月的最后一周包含下一年的1月1日，则该周将是下一年的第1周。

第一个参数也可以指定为 [`String`](../data-types/string.md)格式，该格式受到 [`parseDateTime64BestEffort()`](type-conversion-functions.md#parsedatetime64besteffort) 支持。字符串参数的支持仅出于与某些第三方工具的兼容性的目的。由于字符串参数的解析通常很慢，因此建议不要使用它。
    

**语法**

```sql
toWeek(datetime[, mode[, time_zone]])
```

**参数**

- `datetime` — 要获取周数的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime)
- `mode` — 可选。模式 `0` 到 `9` 决定一周的第一天和周数的范围。默认值 `0`。 - `time_zone` — 可选。时区。 [`String`](/sql-reference/data-types/string)


**返回值**

根据指定模式返回周数。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**使用不同模式获取周数**

```sql title=Query
SELECT toDate('2016-12-27') AS date, toWeek(date) AS week0, toWeek(date,1) AS week1, toWeek(date,9) AS week9
```

```response title=Response
┌───────date─┬─week0─┬─week1─┬─week9─┐
│ 2016-12-27 │    52 │    52 │     1 │
└────────────┴───────┴───────┴───────┘
```
## toYYYYMM {#toYYYYMM}

引入于：v1.1

将日期或带时间的日期转换为一个包含年份和月份的 `UInt32` 数字（YYYY * 100 + MM）。接受第二个可选的时区参数。如果提供，时区必须是一个字符串常量。

该函数是函数 `YYYYMMDDToDate()` 的反函数。
    

**语法**

```sql
toYYYYMM(datetime[, timezone])
```

**参数**

- `datetime` — 要转换的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。用于转换的时区。如果提供，时区必须是一个字符串常量。 [`String`](/sql-reference/data-types/string)


**返回值**

返回一个包含年份和月份的 UInt32 数字（YYYY * 100 + MM）。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**将当前日期转换为 YYYYMM 格式**

```sql title=Query
SELECT toYYYYMM(now(), 'US/Eastern')
```

```response title=Response
┌─toYYYYMM(now(), 'US/Eastern')─┐
│                        202303 │
└───────────────────────────────┘
```
## toYYYYMMDD {#toYYYYMMDD}

引入于：v1.1

将日期或带时间的日期转换为一个包含年份、月份和日期的 `UInt32` 数字（YYYY * 10000 + MM * 100 + DD）。接受第二个可选的时区参数。如果提供，时区必须是一个字符串常量。
    

**语法**

```sql
toYYYYMMDD(datetime[, timezone])
```

**参数**

- `datetime` — 要转换的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。用于转换的时区。如果提供，时区必须是一个字符串常量。 [`String`](/sql-reference/data-types/string)


**返回值**

返回一个 `UInt32` 数字，包含年份、月份和日期（YYYY * 10000 + MM * 100 + DD）。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**将当前日期转换为 YYYYMMDD 格式**

```sql title=Query
SELECT toYYYYMMDD(now(), 'US/Eastern')
```

```response title=Response
┌─toYYYYMMDD(now(), 'US/Eastern')─┐
│                        20230302 │
└─────────────────────────────────┘
```
## toYYYYMMDDhhmmss {#toYYYYMMDDhhmmss}

引入于：v1.1

将日期或带时间的日期转换为一个包含年份、月份、日期、小时、分钟和秒的 `UInt64` 数字（YYYY * 10000000000 + MM * 100000000 + DD * 1000000 + hh * 10000 + mm * 100 + ss）。接受第二个可选的时区参数。如果提供，时区必须是一个字符串常量。
    

**语法**

```sql
toYYYYMMDDhhmmss(datetime[, timezone])
```

**参数**

- `datetime` — 要转换的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)
- `timezone` — 可选。用于转换的时区。如果提供，时区必须是一个字符串常量。 [`String`](/sql-reference/data-types/string)


**返回值**

返回一个 `UInt64` 数字，包含年份、月份、日期、小时、分钟和秒（YYYY * 10000000000 + MM * 100000000 + DD * 1000000 + hh * 10000 + mm * 100 + ss）。 [`UInt64`](/sql-reference/data-types/int-uint)

**示例**

**将当前日期和时间转换为 YYYYMMDDhhmmss 格式**

```sql title=Query
SELECT toYYYYMMDDhhmmss(now(), 'US/Eastern')
```

```response title=Response
┌─toYYYYMMDDhhmmss(now(), 'US/Eastern')─┐
│                        20230302112209 │
└───────────────────────────────────────┘
```
## toYear {#toYear}

引入于：v1.1

返回 `Date` 或 `DateTime` 值的年份组成部分（公元年）。
    

**语法**

```sql
toYear(datetime)
```

**参数**

- `datetime` — 要提取年份的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`Date32`](/sql-reference/data-types/date32) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

返回给定日期或日期时间的年份 [`UInt16`](/sql-reference/data-types/int-uint)

**示例**

**用法示例**

```sql title=Query
SELECT toYear(toDateTime('2023-04-21 10:20:30'))
```

```response title=Response
┌─toYear(toDateTime('2023-04-21 10:20:30'))─┐
    │                                     2023  │
    └───────────────────────────────────────────┘
```
## toYearNumSinceEpoch {#toYearNumSinceEpoch}

引入于：v25.3

返回从1970年起经过的年份数。

**语法**

```sql
toYearNumSinceEpoch(date)
```

**参数**

- `date` — 要转换的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime) 或 [`DateTime64`](/sql-reference/data-types/datetime64)


**返回值**

正整数

**示例**

**示例**

```sql title=Query
SELECT toYearNumSinceEpoch(toDate('2024-10-01'))
```

```response title=Response
54
```
## toYearWeek {#toYearWeek}

引入于：v20.1

返回日期的年份和周数。结果中的年份可能与日期参数中的年份不同，适用于年初和年末的第一周和最后一周。

`mode` 参数的作用与[`toWeek()`](/sql-reference/functions/date-time-functions#toWeek) 的 `mode` 参数相同。

警告：`toYearWeek()` 返回的周数可能与 `toWeek()` 返回的不同。`toWeek()` 总是返回给定年份上下文中的周数，如果 `toWeek()` 返回 `0`，`toYearWeek()` 返回对应于前一年最后一周的值。请参见下面示例中的 `prev_yearWeek`。

第一个参数也可以作为 [`String`](../data-types/string.md) 以 [`parseDateTime64BestEffort()`](type-conversion-functions.md#parsedatetime64besteffort) 支持的格式指定。字符串参数的支持仅因兼容某些第三方工具的 MySQL 而存在。由于字符串参数支持未来可能依赖于新的 MySQL 兼容设置，并且字符串解析通常较慢，因此不推荐使用。
    

**语法**

```sql
toYearWeek(datetime[, mode[, timezone]])
```

**参数**

- `datetime` — 要获取年份和周数的日期或带时间的日期。 [`Date`](/sql-reference/data-types/date) 或 [`DateTime`](/sql-reference/data-types/datetime)
- `mode` — 可选。模式 `0` 到 `9` 决定每周的第一天和周数范围。默认 `0`。 - `timezone` — 可选。时区。 [`String`](/sql-reference/data-types/string)


**返回值**

以组合整数值返回年份和周数。 [`UInt32`](/sql-reference/data-types/int-uint)

**示例**

**获取具有不同模式的年-周组合**

```sql title=Query
SELECT toDate('2016-12-27') AS date, toYearWeek(date) AS yearWeek0, toYearWeek(date,1) AS yearWeek1, toYearWeek(date,9) AS yearWeek9, toYearWeek(toDate('2022-01-01')) AS prev_yearWeek
```

```response title=Response
┌───────date─┬─yearWeek0─┬─yearWeek1─┬─yearWeek9─┬─prev_yearWeek─┐
│ 2016-12-27 │    201652 │    201652 │    201701 │        202152 │
└────────────┴───────────┴───────────┴───────────┴───────────────┘
```
## today {#today}

引入于：v1.1

返回查询分析时的当前日期。与 `toDate(now())` 相同。

**语法**

```sql
today()
```

**参数**

- 无。
**返回值**

返回当前日期 [`Date`](/sql-reference/data-types/date)

**示例**

**用法示例**

```sql title=Query
SELECT today() AS today, curdate() AS curdate, current_date() AS current_date FORMAT Pretty
```

```response title=Response
┏━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃      today ┃    curdate ┃ current_date ┃
┡━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ 2025-03-03 │ 2025-03-03 │   2025-03-03 │
└────────────┴────────────┴──────────────┘
```
## yesterday {#yesterday}

引入于：v1.1

接受零个参数，并返回查询分析时的昨天日期。
    

**语法**

```sql
yesterday()
```

**参数**

- 无。
**返回值**

返回昨天的日期。 [`Date`](/sql-reference/data-types/date)

**示例**

**获取昨天的日期**

```sql title=Query
SELECT yesterday();
SELECT today() - 1;
```

```response title=Response
┌─yesterday()─┐
│  2025-06-09 │
└─────────────┘
┌─minus(today(), 1)─┐
│        2025-06-09 │
└───────────────────┘
```

<!--AUTOGENERATED_END-->
