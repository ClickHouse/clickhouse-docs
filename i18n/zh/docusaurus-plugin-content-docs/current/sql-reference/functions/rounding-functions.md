---
description: '舍入函数文档'
sidebar_label: '舍入'
slug: /sql-reference/functions/rounding-functions
title: '舍入函数'
doc_type: 'reference'
---

# 舍入函数 {#rounding-functions}

:::note
以下文档由 `system.functions` 系统表生成
:::

{/* 
  以下标签内的内容会在文档框架构建期间
  被替换为由 system.functions 生成的文档。请不要修改或删除这些标签。
  参见：https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }

## ceil {#ceil}

引入版本：v1.1

类似于 [`floor`](#floor)，但返回大于或等于 `x` 的最小舍入值。
如果舍入导致溢出（例如 `ceiling(255, -1)`），结果未定义。

**语法**

```sql
ceiling(x[, N])
```

**别名**: `ceiling`

**参数**

* `x` — 要进行舍入的值。[`Float*`](/sql-reference/data-types/float) 或 [`Decimal*`](/sql-reference/data-types/decimal) 或 [`(U)Int*`](/sql-reference/data-types/int-uint)
* `N` — 可选。要舍入到的小数位数。默认值为 0，表示舍入为整数。可以为负数。[`(U)Int*`](/sql-reference/data-types/int-uint)

**返回值**

返回与 `x` 类型相同的舍入结果。[`Float*`](/sql-reference/data-types/float) 或 [`Decimal*`](/sql-reference/data-types/decimal) 或 [`(U)Int*`](/sql-reference/data-types/int-uint)

**示例**

**基本用法**

```sql title=Query
SELECT ceiling(123.45, 1) AS rounded
```

```response title=Response
┌─rounded─┐
│   123.5 │
└─────────┘
```

**Negative precision**

```sql title=Query
SELECT ceiling(123.45, -1)
```

```response title=Response
┌─ceiling(123.45, -1)─┐
│                 130 │
└─────────────────────┘
```



## floor {#floor}

Introduced in: v1.1


Returns the largest rounded number less than or equal to `x`, where the rounded number is a multiple of `1 / 10 * N`, or the nearest number of the appropriate data type if `1 / 10 * N` isn't exact.

Integer arguments may be rounded with a negative `N` argument.
With non-negative `N` the function returns `x`.

If rounding causes an overflow (for example, `floor(-128, -1)`), the result is undefined.


**Syntax**

```sql
floor(x[, N])
```

**Arguments**

- `x` — The value to round. [`Float*`](/sql-reference/data-types/float) or [`Decimal*`](/sql-reference/data-types/decimal) or [`(U)Int*`](/sql-reference/data-types/int-uint)
- `N` — Optional. The number of decimal places to round to. Defaults to zero, which means rounding to an integer. Can be negative. [`(U)Int*`](/sql-reference/data-types/int-uint)


**Returned value**

Returns a rounded number of the same type as `x`. [`Float*`](/sql-reference/data-types/float) or [`Decimal*`](/sql-reference/data-types/decimal) or [`(U)Int*`](/sql-reference/data-types/int-uint)

**Examples**

**Usage example**

```sql title=Query
SELECT floor(123.45, 1) AS rounded
```

```response title=Response
┌─rounded─┐
│   123.4 │
└─────────┘
```

**Negative precision**

```sql title=Query
SELECT floor(123.45, -1)
```

```response title=Response
┌─floor(123.45, -1)─┐
│               120 │
└───────────────────┘
```



## round {#round}

Introduced in: v1.1


Rounds a value to a specified number of decimal places `N`.

- If `N > 0`, the function rounds to the right of the decimal point.
- If `N < 0`, the function rounds to the left of the decimal point.
- If `N = 0`, the function rounds to the next integer.

The function returns the nearest number of the specified order.
If the input value has equal distance to two neighboring numbers, the function uses banker's rounding for `Float*` inputs and rounds away from zero for the other number types (`Decimal*`).

If rounding causes an overflow (for example, `round(255, -1)`), the result is undefined.


**Syntax**

```sql
round(x[, N])
```

**Arguments**

- `x` — A number to round. [`Float*`](/sql-reference/data-types/float) or [`Decimal*`](/sql-reference/data-types/decimal) or [`(U)Int*`](/sql-reference/data-types/int-uint)
- `N` — Optional. The number of decimal places to round to. Defaults to `0`. [`(U)Int*`](/sql-reference/data-types/int-uint)


**Returned value**

Returns a rounded number of the same type as `x`. [`Float*`](/sql-reference/data-types/float) or [`Decimal*`](/sql-reference/data-types/decimal) or [`(U)Int*`](/sql-reference/data-types/int-uint)

**Examples**

**Float inputs**

```sql title=Query
SELECT number / 2 AS x, round(x) FROM system.numbers LIMIT 3;
```

```response title=Response
┌───x─┬─round(x)─┐
│   0 │        0 │
│ 0.5 │        0 │
│   1 │        1 │
└─────┴──────────┘
```

**Decimal inputs**

```sql title=Query
SELECT cast(number / 2 AS  Decimal(10,4)) AS x, round(x) FROM system.numbers LIMIT 3;
```

```response title=Response
┌───x─┬─round(x)─┐
│   0 │        0 │
│ 0.5 │        1 │
│   1 │        1 │
└─────┴──────────┘
```



## roundAge {#roundAge}

Introduced in: v1.1


Takes a number representing a human age, compares it to standard age ranges, and returns either the highest or lowest value of the range the number falls within.

- Returns `0`, for `age < 1`.
- Returns `17`, for `1 ≤ age ≤ 17`.
- Returns `18`, for `18 ≤ age ≤ 24`.
- Returns `25`, for `25 ≤ age ≤ 34`.
- Returns `35`, for `35 ≤ age ≤ 44`.
- Returns `45`, for `45 ≤ age ≤ 54`.
- Returns `55`, for `age ≥ 55`.


**Syntax**

```sql
roundAge(num)
```

**Arguments**

- `age` — A number representing an age in years. [`(U)Int*`](/sql-reference/data-types/int-uint) or [`Float*`](/sql-reference/data-types/float)


**Returned value**

Returns either the highest or lowest age of the range `age` falls within. [`UInt8`](/sql-reference/data-types/int-uint)

**Examples**

**Usage example**

```sql title=Query
SELECT *, roundAge(*) FROM system.numbers WHERE number IN (0, 5, 20, 31, 37, 54, 72);
```

```response title=Response
┌─number─┬─roundAge(number)─┐
│      0 │                0 │
│      5 │               17 │
│     20 │               18 │
│     31 │               25 │
│     37 │               35 │
│     54 │               45 │
│     72 │               55 │
└────────┴──────────────────┘
```



## roundBankers {#roundBankers}

Introduced in: v20.1


Rounds a number to a specified decimal position `N`.
If the rounding number is halfway between two numbers, the function uses a method of rounding called banker's rounding, which is the default rounding method for floating point numbers defined in IEEE 754.

- If `N > 0`, the function rounds to the right of the decimal point
- If `N < 0`, the function rounds to the left of the decimal point
- If `N = 0`, the function rounds to the next integer

:::info Notes
- When the rounding number is halfway between two numbers, it's rounded to the nearest even digit at the specified decimal position.
For example: `3.5` rounds up to `4`, `2.5` rounds down to `2`.
- The `round` function performs the same rounding for floating point numbers.
- The `roundBankers` function also rounds integers the same way, for example, `roundBankers(45, -1) = 40`.
- In other cases, the function rounds numbers to the nearest integer.
:::

:::tip Use banker's rounding for summation or subtraction of numbers
Using banker's rounding, you can reduce the effect that rounding numbers has on the results of summing or subtracting these numbers.

For example, sum numbers `1.5, 2.5, 3.5, 4.5` with different rounding:
- No rounding: `1.5 + 2.5 + 3.5 + 4.5 = 12`.
- Banker's rounding: `2 + 2 + 4 + 4 = 12`.
- Rounding to the nearest integer: `2 + 3 + 4 + 5 = 14`.
:::


**Syntax**

```sql
roundBankers(x[, N])
```

**Arguments**

- `x` — A number to round. [`(U)Int*`](/sql-reference/data-types/int-uint) or [`Decimal*`](/sql-reference/data-types/decimal) or [`Float*`](/sql-reference/data-types/float)
- `[, N]` — Optional. The number of decimal places to round to. Defaults to `0`. [`(U)Int*`](/sql-reference/data-types/int-uint)


**Returned value**

Returns a value rounded by the banker's rounding method. [`(U)Int*`](/sql-reference/data-types/int-uint) or [`Decimal*`](/sql-reference/data-types/decimal) or [`Float*`](/sql-reference/data-types/float)

**Examples**

**Basic usage**

```sql title=Query
SELECT number / 2 AS x, roundBankers(x, 0) AS b FROM system.numbers LIMIT 10
```

```response title=Response
┌───x─┬─b─┐
│   0 │ 0 │
│ 0.5 │ 0 │
│   1 │ 1 │
│ 1.5 │ 2 │
│   2 │ 2 │
│ 2.5 │ 2 │
│   3 │ 3 │
│ 3.5 │ 4 │
│   4 │ 4 │
│ 4.5 │ 4 │
└─────┴───┘
```



## roundDown {#roundDown}

Introduced in: v20.1


Rounds a number down to an element in the specified array.
If the value is less than the lower bound, the lower bound is returned.


**Syntax**

```sql
roundDown(num, arr)
```

**Arguments**

- `num` — A number to round down. [`(U)Int*`](/sql-reference/data-types/int-uint) or [`Decimal*`](/sql-reference/data-types/decimal) or [`Float*`](/sql-reference/data-types/float)
- `arr` — Array of elements to round `num` down to. [`Array((U)Int*)`](/sql-reference/data-types/array) or [`Array(Float*)`](/sql-reference/data-types/array)


**Returned value**

Returns a number rounded down to an element in `arr`. If the value is less than the lowest bound, the lowest bound is returned. [`(U)Int*`](/sql-reference/data-types/int-uint) or [`Float*`](/sql-reference/data-types/float)

**Examples**

**Usage example**

```sql title=Query
SELECT *, roundDown(*, [3, 4, 5]) FROM system.numbers WHERE number IN (0, 1, 2, 3, 4, 5)
```

```response title=Response
┌─number─┬─roundDown(number, [3, 4, 5])─┐
│      0 │                            3 │
│      1 │                            3 │
│      2 │                            3 │
│      3 │                            3 │
│      4 │                            4 │
│      5 │                            5 │
└────────┴──────────────────────────────┘
```



## roundDuration {#roundDuration}

Introduced in: v1.1


Rounds a number down to the closest from a set of commonly used durations: `1, 10, 30, 60, 120, 180, 240, 300, 600, 1200, 1800, 3600, 7200, 18000, 36000`.
If the number is less than one, it returns `0`.


**Syntax**

```sql
roundDuration(num)
```

**Arguments**

- `num` — A number to round to one of the numbers in the set of common durations. [`(U)Int*`](/sql-reference/data-types/int-uint) or [`Float*`](/sql-reference/data-types/float)


**Returned value**

Returns `0`, for `num` < 1. Otherwise, one of: `1, 10, 30, 60, 120, 180, 240, 300, 600, 1200, 1800, 3600, 7200, 18000, 36000`. [`UInt16`](/sql-reference/data-types/int-uint)

**Examples**

**Usage example**

```sql title=Query
SELECT *, roundDuration(*) FROM system.numbers WHERE number IN (0, 9, 19, 47, 101, 149, 205, 271, 421, 789, 1423, 2345, 4567, 9876, 24680, 42573)
```

```response title=Response
┌─number─┬─roundDuration(number)─┐
│      0 │                     0 │
│      9 │                     1 │
│     19 │                    10 │
│     47 │                    30 │
│    101 │                    60 │
│    149 │                   120 │
│    205 │                   180 │
│    271 │                   240 │
│    421 │                   300 │
│    789 │                   600 │
│   1423 │                  1200 │
│   2345 │                  1800 │
│   4567 │                  3600 │
│   9876 │                  7200 │
│  24680 │                 18000 │
│  42573 │                 36000 │
└────────┴───────────────────────┘
```



## roundToExp2 {#roundToExp2}

Introduced in: v1.1


Rounds a number down to the nearest (whole non-negative) power of two.
If the number is less than one, it returns `0`.


**Syntax**

```sql
roundToExp2(num)
```

**Arguments**

- `num` — A number to round. [`(U)Int*`](/sql-reference/data-types/int-uint) or [`Float*`](/sql-reference/data-types/float)


**Returned value**

Returns `num` rounded down to the nearest (whole non-negative) power of two, otherwise `0` for `num < 1`. [`(U)Int*`](/sql-reference/data-types/int-uint) or [`Float*`](/sql-reference/data-types/float)

**Examples**

**Usage example**

```sql title=Query
SELECT *, roundToExp2(*) FROM system.numbers WHERE number IN (0, 2, 5, 10, 19, 50)
```

```response title=Response
┌─number─┬─roundToExp2(number)─┐
│      0 │                   0 │
│      2 │                   2 │
│      5 │                   4 │
│     10 │                   8 │
│     19 │                  16 │
│     50 │                  32 │
└────────┴─────────────────────┘
```



## trunc {#trunc}

Introduced in: v1.1


Like [`floor`](#floor) but returns the rounded number with the largest absolute value less than or equal to that of `x`.


**Syntax**

```sql
truncate(x[, N])
```

**Aliases**: `truncate`

**Arguments**

- `x` — The value to round. [`Float*`](/sql-reference/data-types/float) or [`Decimal*`](/sql-reference/data-types/decimal) or [`(U)Int*`](/sql-reference/data-types/int-uint)
- `N` — Optional. The number of decimal places to round to. Defaults to zero, which means rounding to an integer. [`(U)Int*`](/sql-reference/data-types/int-uint)


**Returned value**

Returns a rounded number of the same type as `x`. [`Float*`](/sql-reference/data-types/float) or [`Decimal*`](/sql-reference/data-types/decimal) or [`(U)Int*`](/sql-reference/data-types/int-uint)

**Examples**

**Basic usage**

```sql title=Query
SELECT truncate(123.499, 1) AS res;
```

```response title=Response
┌───res─┐
│ 123.4 │
└───────┘
```

{/*AUTOGENERATED_END*/ }
