---
description: 'URL 函数文档'
sidebar_label: 'URL'
slug: /sql-reference/functions/url-functions
title: 'URL 相关函数'
doc_type: 'reference'
---

# 用于操作 URL 的函数 {#functions-for-working-with-urls}

## 概览 {#overview}

:::note
本节中提到的函数为获得最高性能进行了优化，大多数情况下并不遵循 RFC-3986 标准。
实现 RFC-3986 的函数在函数名后附加 `RFC`，且通常会较慢。
:::

在处理既不包含用户信息字符串也不包含 `@` 符号的公开注册域名时，一般可以使用非 `RFC` 变体函数。
下表详细说明了 URL 中的各个符号在 `RFC` 与非 `RFC` 变体中可以（`✔`）或不可以（`✗`）被解析的情况：

| Symbol      | non-`RFC` | `RFC` |   |
| ----------- | --------- | ----- | - |
| &#39; &#39; | ✗         | ✗     |   |
| \t          | ✗         | ✗     |   |
| &lt;        | ✗         | ✗     |   |
| &gt;        | ✗         | ✗     |   |
| %           | ✗         | ✔*    |   |
| &#123;      | ✗         | ✗     |   |
| &#125;      | ✗         | ✗     |   |
|             |           | ✗     | ✗ |
| \           | ✗         | ✗     |   |
| ^           | ✗         | ✗     |   |
| ~           | ✗         | ✔*    |   |
| [           | ✗         | ✗     |   |
| ]           | ✗         | ✔     |   |
| ;           | ✗         | ✔*    |   |
| =           | ✗         | ✔*    |   |
| &amp;       | ✗         | ✔*    |   |

标记为 `*` 的符号在 RFC 3986 中属于子分隔符（sub-delimiters），在 `@` 符号后的用户信息中是允许使用的。

URL 函数分为两类：

* 从 URL 中提取部分内容的函数。如果 URL 中不存在相关部分，则返回空字符串。
* 从 URL 中移除部分内容的函数。如果 URL 中没有类似内容，则 URL 保持不变。

:::note
下面的函数是根据 `system.functions` 系统表生成的。
:::

{/* 
  下方标签内部的内容会在文档框架构建期间替换为
  由 system.functions 生成的文档。请不要修改或移除这些标签。
  详见：https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }

## cutFragment {#cutFragment}

自 v1.1 版本引入

从 URL 中移除片段标识符（包括 # 号）。

**语法**

```sql
cutFragment(url)
```

**参数**

* `url` — URL。[`String`](/sql-reference/data-types/string)

**返回值**

返回移除片段标识符后的 URL。[`String`](/sql-reference/data-types/string)

**示例**

**使用示例**

```sql title=Query
SELECT cutFragment('http://example.com/path?query=value#fragment123');
```

```response title=Response
┌─cutFragment('http://example.com/path?query=value#fragment123')─┐
│ http://example.com/path?query=value                            │
└────────────────────────────────────────────────────────────────┘
```



## cutQueryString {#cutQueryString}

Introduced in: v1.1


Removes the query string, including the question mark from a URL.
    

**Syntax**

```sql
cutQueryString(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the URL with query string removed. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT cutQueryString('http://example.com/path?query=value&param=123#fragment');
```

```response title=Response
┌─cutQueryString('http://example.com/path?query=value&param=123#fragment')─┐
│ http://example.com/path#fragment                                         │
└──────────────────────────────────────────────────────────────────────────┘
```



## cutQueryStringAndFragment {#cutQueryStringAndFragment}

Introduced in: v1.1


Removes the query string and fragment identifier, including the question mark and number sign, from a URL.
    

**Syntax**

```sql
cutQueryStringAndFragment(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the URL with query string and fragment identifier removed. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT cutQueryStringAndFragment('http://example.com/path?query=value&param=123#fragment');
```

```response title=Response
┌─cutQueryStringAndFragment('http://example.com/path?query=value&param=123#fragment')─┐
│ http://example.com/path                                                             │
└─────────────────────────────────────────────────────────────────────────────────────┘
```



## cutToFirstSignificantSubdomain {#cutToFirstSignificantSubdomain}

Introduced in: v1.1


Returns the part of the domain that includes top-level subdomains up to the [first significant subdomain](/sql-reference/functions/url-functions#firstSignificantSubdomain).

    

**Syntax**

```sql
cutToFirstSignificantSubdomain(url)
```

**Arguments**

- `url` — URL or domain string to process. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the part of the domain that includes top-level subdomains up to the first significant subdomain if possible, otherwise returns an empty string. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT
    cutToFirstSignificantSubdomain('https://news.clickhouse.com.tr/'),
    cutToFirstSignificantSubdomain('www.tr'),
    cutToFirstSignificantSubdomain('tr');
```

```response title=Response
┌─cutToFirstSignificantSubdomain('https://news.clickhouse.com.tr/')─┬─cutToFirstSignificantSubdomain('www.tr')─┬─cutToFirstSignificantSubdomain('tr')─┐
│ clickhouse.com.tr                                                 │ tr                                       │                                      │
└───────────────────────────────────────────────────────────────────┴──────────────────────────────────────────┴──────────────────────────────────────┘
```



## cutToFirstSignificantSubdomainCustom {#cutToFirstSignificantSubdomainCustom}

Introduced in: v21.1


Returns the part of the domain that includes top-level subdomains up to the first significant subdomain. Accepts custom [TLD list](https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains) name. This function can be useful if you need a fresh TLD list or if you have a custom list.

**Configuration example**

```yaml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- 注意：路径位于 top_level_domains_path 下 -->
</top_level_domains_lists>
```
    

**Syntax**

```sql
cutToFirstSignificantSubdomainCustom(url, tld_list_name)
```

**Arguments**

- `url` — URL or domain string to process. [`String`](/sql-reference/data-types/string)
- `tld_list_name` — Name of the custom TLD list configured in ClickHouse. [`const String`](/sql-reference/data-types/string)


**Returned value**

Returns the part of the domain that includes top-level subdomains up to the first significant subdomain. [`String`](/sql-reference/data-types/string)

**Examples**

**Using custom TLD list for non-standard domains**

```sql title=Query
SELECT cutToFirstSignificantSubdomainCustom('bar.foo.there-is-no-such-domain', 'public_suffix_list')
```

```response title=Response
foo.there-is-no-such-domain
```



## cutToFirstSignificantSubdomainCustomRFC {#cutToFirstSignificantSubdomainCustomRFC}

Introduced in: v22.10


Returns the part of the domain that includes top-level subdomains up to the first significant subdomain.
Accepts custom [TLD list](https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains) name.
This function can be useful if you need a fresh TLD list or if you have a custom list.
Similar to [cutToFirstSignificantSubdomainCustom](#cutToFirstSignificantSubdomainCustom) but conforms to RFC 3986.

**Configuration example**

```xml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- 注意：路径位于 top_level_domains_path 下 -->
</top_level_domains_lists>
```
    

**Syntax**

```sql
cutToFirstSignificantSubdomainCustomRFC(url, tld_list_name)
```

**Arguments**

- `url` — URL or domain string to process according to RFC 3986. - `tld_list_name` — Name of the custom TLD list configured in ClickHouse. 

**Returned value**

Returns the part of the domain that includes top-level subdomains up to the first significant subdomain. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT cutToFirstSignificantSubdomainCustomRFC('www.foo', 'public_suffix_list');
```

```response title=Response
┌─cutToFirstSignificantSubdomainCustomRFC('www.foo', 'public_suffix_list')─────┐
│ www.foo                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘
```



## cutToFirstSignificantSubdomainCustomWithWWW {#cutToFirstSignificantSubdomainCustomWithWWW}

Introduced in: v21.1


Returns the part of the domain that includes top-level subdomains up to the first significant subdomain without stripping 'www'. Accepts custom TLD list name. It can be useful if you need a fresh TLD list or if you have a custom list.

**Configuration example**

````yaml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>
    

**语法**

```sql
cutToFirstSignificantSubdomainCustomWithWWW(url, tld_list_name)
````

**参数**

* `url` — 要处理的 URL 或域名字符串。
* `tld_list_name` — 在 ClickHouse 中配置的自定义 TLD 列表名称。

**返回值**

域名的一部分，包含顶层子域名，直到第一个有意义的子域名为止，并且不会去除 `www` 前缀。[`String`](/sql-reference/data-types/string)

**示例**

**用法示例**

```sql title=Query
SELECT cutToFirstSignificantSubdomainCustomWithWWW('www.foo', 'public_suffix_list');
```

```response title=Response
┌─cutToFirstSignificantSubdomainCustomWithWWW('www.foo', 'public_suffix_list')─┐
│ www.foo                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘
```



## cutToFirstSignificantSubdomainCustomWithWWWRFC {#cutToFirstSignificantSubdomainCustomWithWWWRFC}

Introduced in: v22.10


Returns the part of the domain that includes top-level subdomains up to the first significant subdomain without stripping `www`.
Accepts custom TLD list name.
It can be useful if you need a fresh TLD list or if you have a custom list.
Similar to [cutToFirstSignificantSubdomainCustomWithWWW](#cutToFirstSignificantSubdomainCustomWithWWW) but conforms to [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Configuration example**

````xml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- 注意：路径位于 top_level_domains_path 下 -->
</top_level_domains_lists>
    

**语法**

```sql
cutToFirstSignificantSubdomainCustomWithWWWRFC(url, tld_list_name)
````

**参数**

* `url` — 按 RFC 3986 进行解析的 URL 或域名字符串。
* `tld_list_name` — 在 ClickHouse 中配置的自定义 TLD 列表名称。

**返回值**

返回域名中包含顶层子域在内、直到第一个重要子域为止的部分，并且不会移除 `www`。[`String`](/sql-reference/data-types/string)

**示例**

**使用自定义 TLD 列表并保留 www 的 RFC 3986 解析**

```sql title=Query
SELECT cutToFirstSignificantSubdomainCustomWithWWWRFC('https://www.subdomain.example.custom', 'public_suffix_list')
```

```response title=Response
www.example.custom
```



## cutToFirstSignificantSubdomainRFC {#cutToFirstSignificantSubdomainRFC}

Introduced in: v22.10


Returns the part of the domain that includes top-level subdomains up to the ["first significant subdomain"](/sql-reference/functions/url-functions#firstSignificantSubdomain). Similar to [`cutToFirstSignificantSubdomain`](#cutToFirstSignificantSubdomain) but conforms to [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).
    

**Syntax**

```sql
cutToFirstSignificantSubdomainRFC(url)
```

**Arguments**

- `url` — URL or domain string to process according to RFC 3986. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the part of the domain that includes top-level subdomains up to the first significant subdomain if possible, otherwise returns an empty string. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT
    cutToFirstSignificantSubdomain('http://user:password@example.com:8080'),
    cutToFirstSignificantSubdomainRFC('http://user:password@example.com:8080');
```

```response title=Response
┌─cutToFirstSignificantSubdomain('http://user:password@example.com:8080')─┬─cutToFirstSignificantSubdomainRFC('http://user:password@example.com:8080')─┐
│                                                                         │ example.com                                                                │
└─────────────────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────────┘
```



## cutToFirstSignificantSubdomainWithWWW {#cutToFirstSignificantSubdomainWithWWW}

Introduced in: v20.12


Returns the part of the domain that includes top-level subdomains up to the "first significant subdomain", without stripping 'www.'.

Similar to [`cutToFirstSignificantSubdomain`](#cutToFirstSignificantSubdomain) but preserves the 'www.' prefix if present.
    

**Syntax**

```sql
cutToFirstSignificantSubdomainWithWWW(url)
```

**Arguments**

- `url` — URL or domain string to process. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the part of the domain that includes top-level subdomains up to the first significant subdomain (with www) if possible, otherwise returns an empty string. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT
    cutToFirstSignificantSubdomainWithWWW('https://news.clickhouse.com.tr/'),
    cutToFirstSignificantSubdomainWithWWW('www.tr'),
    cutToFirstSignificantSubdomainWithWWW('tr');
```

```response title=Response
┌─cutToFirstSignificantSubdomainWithWWW('https://news.clickhouse.com.tr/')─┬─cutToFirstSignificantSubdomainWithWWW('www.tr')─┬─cutToFirstSignificantSubdomainWithWWW('tr')─┐
│ clickhouse.com.tr                                                        │ www.tr                                          │                                             │
└──────────────────────────────────────────────────────────────────────────┴─────────────────────────────────────────────────┴─────────────────────────────────────────────┘
```



## cutToFirstSignificantSubdomainWithWWWRFC {#cutToFirstSignificantSubdomainWithWWWRFC}

Introduced in: v22.10


Returns the part of the domain that includes top-level subdomains up to the "first significant subdomain", without stripping 'www'. Similar to [`cutToFirstSignificantSubdomainWithWWW`](#cutToFirstSignificantSubdomainWithWWW) but conforms to [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).
    

**Syntax**

```sql
cutToFirstSignificantSubdomainWithWWWRFC(url)
```

**Arguments**

- `url` — URL or domain string to process according to RFC 3986. 

**Returned value**

Returns the part of the domain that includes top-level subdomains up to the first significant subdomain (with 'www') if possible, otherwise returns an empty string [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT
    cutToFirstSignificantSubdomainWithWWW('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy'),
    cutToFirstSignificantSubdomainWithWWWRFC('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy');
```

```response title=Response
┌─cutToFirstSignificantSubdomainWithWWW('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy')─┬─cutToFirstSignificantSubdomainWithWWWRFC('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy')─┐
│                                                                                       │ mail.ru                                                                                  │
└───────────────────────────────────────────────────────────────────────────────────────┴──────────────────────────────────────────────────────────────────────────────────────────┘
```



## cutURLParameter {#cutURLParameter}

Introduced in: v1.1


Removes the `name` parameter from a URL, if present.
This function does not encode or decode characters in parameter names, e.g. `Client ID` and `Client%20ID` are treated as different parameter names.
    

**Syntax**

```sql
cutURLParameter(url, name)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)
- `name` — Name of URL parameter. [`String`](/sql-reference/data-types/string) or [`Array(String)`](/sql-reference/data-types/array)


**Returned value**

URL with `name` URL parameter removed. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT
    cutURLParameter('http://bigmir.net/?a=b&c=d&e=f#g', 'a') AS url_without_a,
    cutURLParameter('http://bigmir.net/?a=b&c=d&e=f#g', ['c', 'e']) AS url_without_c_and_e;
```

```response title=Response
┌─url_without_a────────────────┬─url_without_c_and_e──────┐
│ http://bigmir.net/?c=d&e=f#g │ http://bigmir.net/?a=b#g │
└──────────────────────────────┴──────────────────────────┘
```



## cutWWW {#cutWWW}

Introduced in: v1.1


Removes the leading `www.`, if present, from the URL's domain.
    

**Syntax**

```sql
cutWWW(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the URL with leading `www.` removed from the domain. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT cutWWW('http://www.example.com/path?query=value#fragment');
```

```response title=Response
┌─cutWWW('http://www.example.com/path?query=value#fragment')─┐
│ http://example.com/path?query=value#fragment               │
└────────────────────────────────────────────────────────────┘
```



## decodeURLComponent {#decodeURLComponent}

Introduced in: v1.1


Takes a URL-encoded string as input and decodes it back to its original, readable form.
    

**Syntax**

```sql
decodeURLComponent(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the decoded URL. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT decodeURLComponent('http://127.0.0.1:8123/?query=SELECT%201%3B') AS DecodedURL;
```

```response title=Response
┌─DecodedURL─────────────────────────────┐
│ http://127.0.0.1:8123/?query=SELECT 1; │
└────────────────────────────────────────┘
```



## decodeURLFormComponent {#decodeURLFormComponent}

Introduced in: v1.1


Decodes URL-encoded strings using form encoding rules ([RFC-1866](https://www.rfc-editor.org/rfc/rfc1866.html)), where `+` signs are converted to spaces and percent-encoded characters are decoded.
    

**Syntax**

```sql
decodeURLFormComponent(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the decoded URL. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT decodeURLFormComponent('http://127.0.0.1:8123/?query=SELECT%201+2%2B3') AS DecodedURL;
```

```response title=Response
┌─DecodedURL────────────────────────────────┐
│ http://127.0.0.1:8123/?query=SELECT 1 2+3 │
└───────────────────────────────────────────┘
```



## domain {#domain}

Introduced in: v1.1


Extracts the hostname from a URL.

The URL can be specified with or without a protocol.
    

**Syntax**

```sql
domain(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the host name if the input string can be parsed as a URL, otherwise an empty string. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT domain('svn+ssh://some.svn-hosting.com:80/repo/trunk');
```

```response title=Response
┌─domain('svn+ssh://some.svn-hosting.com:80/repo/trunk')─┐
│ some.svn-hosting.com                                   │
└────────────────────────────────────────────────────────┘
```



## domainRFC {#domainRFC}

Introduced in: v22.10


Extracts the hostname from a URL.
Similar to [`domain`](#domain), but [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986) conformant.
    

**Syntax**

```sql
domainRFC(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the host name if the input string can be parsed as a URL, otherwise an empty string. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT
    domain('http://user:password@example.com:8080/path?query=value#fragment'),
    domainRFC('http://user:password@example.com:8080/path?query=value#fragment');
```

```response title=Response
┌─domain('http://user:password@example.com:8080/path?query=value#fragment')─┬─domainRFC('http://user:password@example.com:8080/path?query=value#fragment')─┐
│                                                                           │ example.com                                                                  │
└───────────────────────────────────────────────────────────────────────────┴──────────────────────────────────────────────────────────────────────────────┘
```



## domainWithoutWWW {#domainWithoutWWW}

Introduced in: v1.1


Returns the domain of a URL without leading `www.` if present.
    

**Syntax**

```sql
domainWithoutWWW(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the domain name if the input string can be parsed as a URL (without leading `www.`), otherwise an empty string. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT domainWithoutWWW('http://paul@www.example.com:80/');
```

```response title=Response
┌─domainWithoutWWW('http://paul@www.example.com:80/')─┐
│ example.com                                         │
└─────────────────────────────────────────────────────┘
```



## domainWithoutWWWRFC {#domainWithoutWWWRFC}

Introduced in: v1.1


Returns the domain without leading `www.` if present. Similar to [`domainWithoutWWW`](#domainWithoutWWW) but conforms to [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).
    

**Syntax**

```sql
domainWithoutWWWRFC(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the domain name if the input string can be parsed as a URL (without leading `www.`), otherwise an empty string. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT
    domainWithoutWWW('http://user:password@www.example.com:8080/path?query=value#fragment'),
    domainWithoutWWWRFC('http://user:password@www.example.com:8080/path?query=value#fragment');
```

```response title=Response
┌─domainWithoutWWW('http://user:password@www.example.com:8080/path?query=value#fragment')─┬─domainWithoutWWWRFC('http://user:password@www.example.com:8080/path?query=value#fragment')─┐
│                                                                                         │ example.com                                                                                │
└─────────────────────────────────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────────────────────────┘
```



## encodeURLComponent {#encodeURLComponent}

Introduced in: v22.3


Takes a regular string and converts it into a URL-encoded (percent-encoded) format where special characters are replaced with their percent-encoded equivalents.
    

**Syntax**

```sql
encodeURLComponent(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the encoded URL. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT encodeURLComponent('http://127.0.0.1:8123/?query=SELECT 1;') AS EncodedURL;
```

```response title=Response
┌─EncodedURL───────────────────────────────────────────────┐
│ http%3A%2F%2F127.0.0.1%3A8123%2F%3Fquery%3DSELECT%201%3B │
└──────────────────────────────────────────────────────────┘
```



## encodeURLFormComponent {#encodeURLFormComponent}

Introduced in: v22.3


Encodes strings using form encoding rules ([RFC-1866](https://www.rfc-editor.org/rfc/rfc1866.html)), where spaces are converted to + signs and special characters are percent-encoded.
    

**Syntax**

```sql
encodeURLFormComponent(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the encoded URL. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT encodeURLFormComponent('http://127.0.0.1:8123/?query=SELECT 1 2+3') AS EncodedURL;
```

```response title=Response
┌─编码后的 URL──────────────────────────────────────────────┐
│ http%3A%2F%2F127.0.0.1%3A8123%2F%3Fquery%3DSELECT+1+2%2B3 │
└───────────────────────────────────────────────────────────┘
```



## extractURLParameter {#extractURLParameter}

Introduced in: v1.1


Returns the value of the `name` parameter in the URL, if present, otherwise an empty string is returned.
If there are multiple parameters with this name, the first occurrence is returned.
The function assumes that the parameter in the `url` parameter is encoded in the same way as in the `name` argument.
    

**Syntax**

```sql
extractURLParameter(url, name)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)
- `name` — Parameter name. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the value of the URL parameter with the specified name. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT extractURLParameter('http://example.com/?param1=value1&param2=value2', 'param1');
```

```response title=Response
┌─extractURLPa⋯, 'param1')─┐
│ value1                   │
└──────────────────────────┘
```



## extractURLParameterNames {#extractURLParameterNames}

Introduced in: v1.1


Returns an array of name strings corresponding to the names of URL parameters.
The values are not decoded.
    

**Syntax**

```sql
extractURLParameterNames(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns an array of name strings corresponding to the names of URL parameters. [`Array(String)`](/sql-reference/data-types/array)

**Examples**

**Usage example**

```sql title=Query
SELECT extractURLParameterNames('http://example.com/?param1=value1&param2=value2');
```

```response title=Response
┌─extractURLPa⋯m2=value2')─┐
│ ['param1','param2']      │
└──────────────────────────┘
```



## extractURLParameters {#extractURLParameters}

Introduced in: v1.1


Returns an array of `name=value` strings corresponding to the URL parameters.
The values are not decoded.
    

**Syntax**

```sql
extractURLParameters(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns an array of `name=value` strings corresponding to the URL parameters. [`Array(String)`](/sql-reference/data-types/array)

**Examples**

**Usage example**

```sql title=Query
SELECT extractURLParameters('http://example.com/?param1=value1&param2=value2');
```

```response title=Response
┌─extractURLParame⋯&param2=value2')─┐
│ ['param1=value1','param2=value2'] │
└───────────────────────────────────┘
```



## firstSignificantSubdomain {#firstSignificantSubdomain}

Introduced in: v


Returns the "first significant subdomain".

The first significant subdomain is a second-level domain if it is 'com', 'net', 'org', or 'co'.
Otherwise, it is a third-level domain.

For example, firstSignificantSubdomain('https://news.clickhouse.com/') = 'clickhouse', firstSignificantSubdomain ('https://news.clickhouse.com.tr/') = 'clickhouse'.

The list of "insignificant" second-level domains and other implementation details may change in the future.
        

**Syntax**

```sql
```

**Arguments**

- None.

**Returned value**



**Examples**

**firstSignificantSubdomain**

```sql title=Query
SELECT firstSignificantSubdomain('https://news.clickhouse.com/')
```

```response title=Response
```



## firstSignificantSubdomainRFC {#firstSignificantSubdomainRFC}

Introduced in: v

Returns the "first significant subdomain" according to RFC 1034.

**Syntax**

```sql
```

**Arguments**

- None.

**Returned value**



**Examples**



## fragment {#fragment}

Introduced in: v1.1


Returns the fragment identifier without the initial hash symbol.
    

**Syntax**

```sql
片段(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the fragment identifier without the initial hash symbol. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT fragment('https://clickhouse.com/docs/getting-started/quick-start/cloud#1-create-a-clickhouse-service');
```

```response title=Response
┌─fragment('http⋯ouse-service')─┐
│ 1-创建-ClickHouse-服务        │
└───────────────────────────────┘
```



## netloc {#netloc}

Introduced in: v20.5


Extracts network locality (`username:password@host:port`) from a URL.
    

**Syntax**

```sql
netloc(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns `username:password@host:port` from a given URL. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT netloc('http://paul@www.example.com:80/');
```

```response title=Response
┌─netloc('http⋯e.com:80/')─┐
│ paul@www.example.com:80  │
└──────────────────────────┘
```



## path {#path}

Introduced in: v1.1


Returns the path without query string from a URL.
    

**Syntax**

```sql
路径(网址)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the path of the URL without query string. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT path('https://clickhouse.com/docs/sql-reference/functions/url-functions/?query=value');
```

```response title=Response
┌─path('https://clickhouse.com/en/sql-reference/functions/url-functions/?query=value')─┐
│ /docs/sql-reference/functions/url-functions/                                         │
└──────────────────────────────────────────────────────────────────────────────────────┘
```



## pathFull {#pathFull}

Introduced in: v1.1


The same as [`path`](#path), but includes the query string and fragment of the URL.
    

**Syntax**

```sql
pathFull(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the path of the URL including query string and fragment. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT pathFull('https://clickhouse.com/docs/sql-reference/functions/url-functions/?query=value#section');
```

```response title=Response
┌─pathFull('https://clickhouse.com⋯unctions/?query=value#section')─┐
│ /docs/sql-reference/functions/url-functions/?query=value#section │
└──────────────────────────────────────────────────────────────────┘
```



## port {#port}

Introduced in: v20.5


Returns the port of a URL, or the `default_port` if the URL contains no port or cannot be parsed.
    

**Syntax**

```sql
port(url[, default_port])
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)
- `default_port` — Optional. The default port number to be returned. `0` by default. [`UInt16`](/sql-reference/data-types/int-uint)


**Returned value**

Returns the port of the URL, or the default port if there is no port in the URL or in case of a validation error. [`UInt16`](/sql-reference/data-types/int-uint)

**Examples**

**Usage example**

```sql title=Query
SELECT port('https://clickhouse.com:8443/docs'), port('https://clickhouse.com/docs', 443);
```

```response title=Response
┌─port('https://clickhouse.com:8443/docs')─┬─port('https://clickhouse.com/docs', 443)─┐
│                                     8443 │                                      443 │
└──────────────────────────────────────────┴──────────────────────────────────────────┘
```



## portRFC {#portRFC}

Introduced in: v22.10


Returns the port or `default_port` if the URL contains no port or cannot be parsed.
Similar to [`port`](#port), but [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986) conformant.
    

**Syntax**

```sql
portRFC(url[, default_port])
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)
- `default_port` — Optional. The default port number to be returned. `0` by default. [`UInt16`](/sql-reference/data-types/int-uint)


**Returned value**

Returns the port or the default port if there is no port in the URL or in case of a validation error. [`UInt16`](/sql-reference/data-types/int-uint)

**Examples**

**Usage example**

```sql title=Query
SELECT port('http://user:password@example.com:8080/'), portRFC('http://user:password@example.com:8080/');
```

```response title=Response
┌─port('http:/⋯com:8080/')─┬─portRFC('htt⋯com:8080/')─┐
│                        0 │                     8080 │
└──────────────────────────┴──────────────────────────┘
```



## protocol {#protocol}

Introduced in: v1.1


Extracts the protocol from a URL.

Examples of typical returned values: http, https, ftp, mailto, tel, magnet.
    

**Syntax**

```sql
协议(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the protocol of the URL, or an empty string if it cannot be determined. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT protocol('https://clickhouse.com/');
```

```response title=Response
┌─protocol('https://clickhouse.com/')─┐
│ https                               │
└─────────────────────────────────────┘
```



## queryString {#queryString}

Introduced in: v1.1


Returns the query string of a URL without the initial question mark, `#` and everything after `#`.
    

**Syntax**

```sql
queryString(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the query string of the URL without the initial question mark and fragment. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT queryString('https://clickhouse.com/docs?query=value&param=123#section');
```

```response title=Response
┌─queryString(⋯3#section')─┐
│ query=value&param=123    │
└──────────────────────────┘
```



## queryStringAndFragment {#queryStringAndFragment}

Introduced in: v1.1


Returns the query string and fragment identifier of a URL.
    

**Syntax**

```sql
queryStringAndFragment(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the query string and fragment identifier of the URL. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT queryStringAndFragment('https://clickhouse.com/docs?query=value&param=123#section');
```

```response title=Response
┌─queryStringAnd⋯=123#section')─┐
│ query=value&param=123#section │
└───────────────────────────────┘
```



## topLevelDomain {#topLevelDomain}

Introduced in: v1.1


Extracts the the top-level domain from a URL.

:::note
The URL can be specified with or without a protocol.
For example:

```text
svn+ssh://some.svn-hosting.com:80/repo/trunk
some.svn-hosting.com:80/repo/trunk
https://clickhouse.com/time/
```
:::
    

**Syntax**

```sql
顶级域名(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the domain name if the input string can be parsed as a URL. Otherwise, an empty string. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT topLevelDomain('svn+ssh://www.some.svn-hosting.com:80/repo/trunk');
```

```response title=Response
┌─topLevelDomain('svn+ssh://www.some.svn-hosting.com:80/repo/trunk')─┐
│ com                                                                │
└────────────────────────────────────────────────────────────────────┘
```



## topLevelDomainRFC {#topLevelDomainRFC}

Introduced in: v22.10


Extracts the the top-level domain from a URL.
Similar to [`topLevelDomain`](#topLevelDomain), but conforms to [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).
    

**Syntax**

```sql
topLevelDomainRFC(url)
```

**Arguments**

- `url` — URL. [`String`](/sql-reference/data-types/string)


**Returned value**

Domain name if the input string can be parsed as a URL. Otherwise, an empty string. [`String`](/sql-reference/data-types/string)

**Examples**

**Usage example**

```sql title=Query
SELECT topLevelDomain('http://foo:foo%41bar@foo.com'), topLevelDomainRFC('http://foo:foo%41bar@foo.com');
```

```response title=Response
┌─topLevelDomain('http://foo:foo%41bar@foo.com')─┬─topLevelDomainRFC('http://foo:foo%41bar@foo.com')─┐
│                                                │ com                                               │
└────────────────────────────────────────────────┴───────────────────────────────────────────────────┘
```

{/*AUTOGENERATED_END*/ }
