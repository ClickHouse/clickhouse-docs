## 何时使用 `JSON` 类型 {#when-to-use-json-type}

`JSON` 类型专为在结构动态或不可预测的 JSON 对象中，对特定字段进行查询、过滤和聚合而设计。它通过将 JSON 对象拆分为独立的子列来实现这一点，与使用 `Map` 或解析字符串等方案相比，这种方式能显著减少数据读取量，并加速对选定字段的查询。

**不过，这也带来了重要的取舍：**

- `INSERT` 较慢 —— 将 JSON 拆分为子列、执行类型推断并管理灵活的存储结构，使得与将 JSON 作为简单的 `String` 列存储相比，写入会更慢。
- 读取完整对象时更慢 —— 如果需要检索完整的 JSON 文档（而不是特定字段），`JSON` 类型会比从 `String` 列读取更慢。从独立子列重建对象的开销，在不进行字段级查询时并没有任何收益。
- 存储开销 —— 维护独立的子列，相比将 JSON 作为单个字符串值存储，会增加结构性开销。

### 在以下情况使用 `JSON` 类型： {#use-json-type}

- 数据具有动态或不可预测的结构，不同文档之间的键名各不相同
- 字段类型或模式会随时间变化，或在不同记录之间有所差异
- 需要在结构无法事先预知的 JSON 对象中，对特定路径进行查询、过滤或聚合
- 使用场景涉及日志、事件或用户生成内容等半结构化数据，且其模式不一致

### 在以下情况使用 `String` 列（或结构化类型）： {#use-string-type}

- 你的数据结构是已知且一致的——在这种情况下，应使用普通列、`Nested`、`Tuple`、`Array`、`Dynamic` 或 `Variant` 类型来代替
- `JSON` 文档被视为不透明的数据块，只在整体上进行存储与读取，而不会进行字段级分析
- 你不需要在数据库中对单个 JSON 字段进行查询或过滤
- `JSON` 只是传输/存储格式，不会在 ClickHouse 内部进行分析

:::tip
如果 `JSON` 是不会在数据库内部被分析、仅用于存储和读取的不透明文档，则应将其存储为 `String` 字段。只有当你需要在动态的 `JSON` 结构中对特定字段进行高效查询、过滤或聚合时，`JSON` 类型的优势才会体现出来。

你也可以混合使用多种方式——对可预测的顶层字段使用标准列，对数据负载中动态部分使用 `JSON` 列。
:::