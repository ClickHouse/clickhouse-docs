---
description: '包含所有已缓存文件的 schema 信息的系统表。'
keywords: ['system table', 'schema_inference_cache']
slug: /operations/system-tables/schema_inference_cache
title: 'system.schema_inference_cache'
doc_type: 'reference'
---

import SystemTableCloud from '@site/docs/_snippets/_system_table_cloud.md';


# system.schema&#95;inference&#95;cache

<SystemTableCloud />

包含所有已缓存文件 schema 的信息。

列：

{/*AUTOGENERATED_START*/ }

* `storage` ([String](../../sql-reference/data-types/)) — 存储名称：File、URL、S3 或 HDFS。
* `source` ([String](../../sql-reference/data-types/)) — 文件来源。
* `format` ([String](../../sql-reference/data-types/)) — 格式名称。
* `additional_format_info` ([String](../../sql-reference/data-types/)) — 标识 schema 所需的附加信息，例如特定于格式的设置。
* `registration_time` ([DateTime](../../sql-reference/data-types/)) — 将 schema 添加到缓存时的时间戳。
* `schema` ([Nullable(String)](../../sql-reference/data-types/)) — 已缓存的 schema。
* `number_of_rows` ([Nullable(UInt64)](../../sql-reference/data-types/)) — 文件在给定格式下的行数。用于缓存来自数据文件的简单 count() 结果，以及在 schema 推断期间缓存从元数据获得的行数。
* `schema_inference_mode` ([Nullable(String)](../../sql-reference/data-types/)) — schema 推断方式。

{/*AUTOGENERATED_END*/ }

**示例**

假设我们有一个名为 `data.jsonl` 的文件，其内容如下：

```json
{"id" :  1, "age" :  25, "name" :  "Josh", "hobbies" :  ["足球", "烹饪", "音乐"]}
{"id" :  2, "age" :  19, "name" :  "Alan", "hobbies" :  ["网球", "艺术"]}
{"id" :  3, "age" :  32, "name" :  "Lana", "hobbies" :  ["健身", "阅读", "购物"]}
{"id" :  4, "age" :  47, "name" :  "Brayan", "hobbies" :  ["电影", "跳伞"]}
```

:::tip
请将 `data.jsonl` 放置在 `user_files_path` 目录中。可通过查看 ClickHouse 配置文件来找到该目录。默认值为：

```sql
<user_files_path>/var/lib/clickhouse/user_files/</user_files_path>
```

:::

打开 `clickhouse-client`，运行 `DESCRIBE` 查询：

```sql
DESCRIBE file('data.jsonl') SETTINGS input_format_try_infer_integers=0;
```

```response
┌─name────┬─type────────────────────┬─default_type─┬─default_expression─┬─comment─┬─codec_expression─┬─ttl_expression─┐
│ id      │ Nullable(Float64)       │              │                    │         │                  │                │
│ age     │ Nullable(Float64)       │              │                    │         │                  │                │
│ name    │ Nullable(String)        │              │                    │         │                  │                │
│ hobbies │ Array(Nullable(String)) │              │                    │         │                  │                │
└─────────┴─────────────────────────┴──────────────┴────────────────────┴─────────┴──────────────────┴────────────────┘
```

我们来看一下 `system.schema_inference_cache` 表的内容：

```sql
SELECT *
FROM system.schema_inference_cache
FORMAT Vertical
```

```response
行 1:
──────
存储:                   File
来源:                   /home/droscigno/user_files/data.jsonl
格式:                   JSONEachRow
附加格式信息:           schema_inference_hints=, max_rows_to_read_for_schema_inference=25000, schema_inference_make_columns_nullable=true, try_infer_integers=false, try_infer_dates=true, try_infer_datetimes=true, try_infer_numbers_from_strings=true, read_bools_as_numbers=true, try_infer_objects=false
注册时间:               2022-12-29 17:49:52
模式:                   id Nullable(Float64), age Nullable(Float64), name Nullable(String), hobbies Array(Nullable(String))
```

**另请参阅**

* [从输入数据自动推断表结构](/interfaces/schema-inference.md)
