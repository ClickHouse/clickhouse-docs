---
description: '系统表，包含可即时计算或表示当前值的指标。'
keywords: ['系统表', '指标']
slug: /operations/system-tables/metrics
title: 'system.metrics'
doc_type: 'reference'
---

import SystemTableCloud from '@site/i18n/zh/docusaurus-plugin-content-docs/current/_snippets/_system_table_cloud.md';


# system.metrics \{#systemmetrics\}

<SystemTableCloud />

包含可以实时计算或具有当前值的指标。例如，同时处理的查询数量或当前副本延迟。此表始终保持最新。

列：

<!--AUTOGENERATED_START-->

* `metric` ([String](../../sql-reference/data-types/)) — 指标名称。
* `value` ([Int64](../../sql-reference/data-types/)) — 指标值。
* `description` ([String](../../sql-reference/data-types/)) — 指标描述。

<!--AUTOGENERATED_END-->

可以在源文件 [src/Common/CurrentMetrics.cpp](https://github.com/ClickHouse/ClickHouse/blob/master/src/Common/CurrentMetrics.cpp) 中查阅所有受支持的指标。

**示例**

```sql
SELECT * FROM system.metrics LIMIT 10
```

```text
┌─metric───────────────────────────────┬─value─┬─description────────────────────────────────────────────────────────────┐
│ Query                                │     1 │ Number of executing queries                                            │
│ Merge                                │     0 │ Number of executing background merges                                  │
│ PartMutation                         │     0 │ Number of mutations (ALTER DELETE/UPDATE)                              │
│ ReplicatedFetch                      │     0 │ Number of data parts being fetched from replicas                       │
│ ReplicatedSend                       │     0 │ Number of data parts being sent to replicas                            │
│ ReplicatedChecks                     │     0 │ Number of data parts checking for consistency                          │
│ BackgroundMergesAndMutationsPoolTask │     0 │ Number of active merges and mutations in an associated background pool │
│ BackgroundFetchesPoolTask            │     0 │ Number of active fetches in an associated background pool              │
│ BackgroundCommonPoolTask             │     0 │ Number of active tasks in an associated background pool                │
│ BackgroundMovePoolTask               │     0 │ Number of active tasks in BackgroundProcessingPool for moves           │
└──────────────────────────────────────┴───────┴────────────────────────────────────────────────────────────────────────┘
```


## 指标说明 \{#metric-descriptions\}

| 指标                                              | 说明                                                                                          |
| ----------------------------------------------- | ------------------------------------------------------------------------------------------- |
| **AggregatorThreads**                           | Aggregator 线程池的线程数                                                                          |
| **AggregatorThreadsActive**                     | Aggregator 线程池中正在执行任务的线程数量                                                                  |
| **TablesLoaderForegroundThreads**               | 异步加载器前台线程池中的线程数                                                                             |
| **TablesLoaderForegroundThreadsActive**         | 异步加载器前台线程池中正在执行任务的线程数量                                                                      |
| **TablesLoaderBackgroundThreads**               | 异步加载器后台线程池的线程数量                                                                             |
| **TablesLoaderBackgroundThreadsActive**         | 异步加载器后台线程池中正在运行任务的线程数量                                                                      |
| **AsyncInsertCacheSize**                        | 缓存中异步插入哈希 ID 数量                                                                             |
| **AsynchronousInsertThreads**                   | AsynchronousInsert 线程池中的线程数                                                                 |
| **AsynchronousInsertThreadsActive**             | AsynchronousInsert 线程池中正在执行任务的线程数量                                                          |
| **AsynchronousReadWait**                        | 等待异步读取的线程数                                                                                  |
| **BackgroundBufferFlushSchedulePoolSize**       | BackgroundBufferFlushSchedulePool 中任务数上限                                                    |
| **BackgroundBufferFlushSchedulePoolTask**       | BackgroundBufferFlushSchedulePool 中当前活动任务数（用于定期刷新缓冲区）                                       |
| **BackgroundCommonPoolSize**                    | 关联后台池任务数量上限                                                                                 |
| **BackgroundCommonPoolTask**                    | 关联后台池中活动任务数                                                                                 |
| **BackgroundDistributedSchedulePoolSize**       | BackgroundDistributedSchedulePool 中任务数上限                                                    |
| **BackgroundDistributedSchedulePoolTask**       | BackgroundDistributedSchedulePool 中的活动任务数（用于在后台执行分布式发送）                                     |
| **BackgroundFetchesPoolSize**                   | 关联后台池中同时进行的获取操作数量上限                                                                         |
| **BackgroundFetchesPoolTask**                   | 关联后台池中正在执行的获取任务数量                                                                           |
| **BackgroundMergesAndMutationsPoolSize**        | 关联后台池中活动合并和变更数量上限                                                                           |
| **BackgroundMergesAndMutationsPoolTask**        | 关联后台池中处于活动状态的合并和变更操作数量                                                                      |
| **BackgroundMessageBrokerSchedulePoolSize**     | 用于消息流处理的 BackgroundProcessingPool 中任务数上限                                                    |
| **BackgroundMessageBrokerSchedulePoolTask**     | 用于消息流式传输的 BackgroundProcessingPool 中活动任务的数量                                                 |
| **BackgroundMovePoolSize**                      | BackgroundProcessingPool 中用于移动操作的任务数量上限                                                     |
| **BackgroundMovePoolTask**                      | BackgroundProcessingPool 中用于移动操作的活动任务数量                                                     |
| **BackgroundSchedulePoolSize**                  | BackgroundSchedulePool 中任务数量上限（用于定期执行 ReplicatedMergeTree 任务，例如清理旧分区片段、修改分区片段、重新初始化副本）      |
| **BackgroundSchedulePoolTask**                  | BackgroundSchedulePool 中活动任务的数量（用于周期性执行 ReplicatedMergeTree 相关任务，例如清理旧的分区片段、修改分区片段、重新初始化副本） |
| **BackupsIOThreads**                            | BackupsIO 线程池中的线程数                                                                          |
| **BackupsIOThreadsActive**                      | BackupsIO 线程池中正在执行任务的线程数                                                                    |
| **BackupsThreads**                              | BACKUP 线程池中的线程数量                                                                            |
| **BackupsThreadsActive**                        | BACKUP 线程池中正在执行任务的线程数量                                                                      |
| **BrokenDistributedFilesToInsert**              | 异步写入分布式表时被标记为损坏的文件数量（从 0 开始，对每个分片累加）                                                        |
| **CacheDetachedFileSegments**                   | 现有已分离缓存文件片段数                                                                                |
| **CacheDictionaryThreads**                      | CacheDictionary 线程池中的线程数量                                                                   |
| **CacheDictionaryThreadsActive**                | 正在执行任务的 CacheDictionary 线程池线程数                                                              |
| **CacheDictionaryUpdateQueueBatches**           | CacheDictionaries 中更新队列中的“批次”（一组键）数量                                                        |
| **CacheDictionaryUpdateQueueKeys**              | CacheDictionaries 中更新队列中键的精确数量                                                              |
| **CacheFileSegments**                           | 当前缓存文件段数量                                                                                   |
| **ContextLockWait**                             | 在 Context（全局锁）上等待锁的线程数                                                                      |
| **DDLWorkerThreads**                            | ON CLUSTER 查询的 DDLWorker 线程池线程数                                                             |
| **DDLWorkerThreadsActive**                      | DDLWORKER 线程池中用于 ON CLUSTER 查询、正在执行任务的线程数量                                                  |
| **DatabaseCatalogThreads**                      | DatabaseCatalog 线程池中的线程数量                                                                   |
| **DatabaseCatalogThreadsActive**                | DatabaseCatalog 线程池中处于任务执行状态的线程数量                                                           |
| **DatabaseOnDiskThreads**                       | DatabaseOnDisk 线程池中的线程数                                                                     |
| **DatabaseOnDiskThreadsActive**                 | DatabaseOnDisk 线程池中正在执行任务的线程数量                                                              |
| **DelayedInserts**                              | 在 MergeTree 表中，由于分区的活动分区片段数量过多而被延迟的 INSERT 查询数量                                             |
| **DestroyAggregatesThreads**                    | 用于销毁聚合状态的线程池线程数                                                                             |
| **DestroyAggregatesThreadsActive**              | 用于销毁聚合状态的线程池中正在执行任务的线程数                                                                     |
| **DictCacheRequests**                           | 发往缓存类型字典数据源的正在进行的请求数                                                                        |
| **DiskObjectStorageAsyncThreads**               | 用于 DiskObjectStorage 的异步线程池线程数                                                              |
| **DiskObjectStorageAsyncThreadsActive**         | 正在执行任务的 DiskObjectStorage 异步线程池线程数                                                          |
| **DiskSpaceReservedForMerge**                   | 为当前后台正在运行的合并操作预留的磁盘空间（略大于被合并分区片段的总大小）                                                       |
| **DistributedFilesToInsert**                    | 用于异步插入到分布式表时需处理的待处理文件数量（在所有分片上求和）                                                           |
| **DistributedSend**                             | 向远程服务器发送写入分布式表数据的连接数（包括同步和异步模式）                                                             |
| **EphemeralNode**                               | 在 ZooKeeper 中保存的临时节点数量                                                                      |
| **FilesystemCacheElements**                     | 文件系统缓存条目（文件段）                                                                               |
| **FilesystemCacheReadBuffers**                  | 活动缓存缓冲区数量                                                                                   |
| **FilesystemCacheSize**                         | 文件系统缓存大小（字节）                                                                                |
| **QueryCacheBytes**                             | 查询缓存总大小（字节）                                                                                 |
| **QueryCacheEntries**                           | 查询缓存中的条目总数                                                                                  |
| **UncompressedCacheBytes**                      | 未压缩缓存的总大小（以字节为单位；通常不会带来性能提升，应尽量避免使用）                                                        |
| **UncompressedCacheCells**                      | 未压缩缓存中的单元数量                                                                                 |
| **CompiledExpressionCacheBytes**                | JIT 编译代码缓存使用的总字节数                                                                           |
| **CompiledExpressionCacheCount**                | JIT 编译代码缓存中的条目总数                                                                            |
| **MMapCacheCells**                              | 使用 `mmap` 打开的文件数量（映射到内存中，与 `local_filesystem_read_method=mmap` 搭配使用，并通过缓存避免 TLB 刷新）         |
| **MarkCacheBytes**                              | mark 缓存的总大小（字节）                                                                             |
| **MarkCacheFiles**                              | 标记缓存中的标记文件总数                                                                                |
| **GlobalThread**                                | 全局线程池中的线程数                                                                                  |
| **GlobalThreadActive**                          | 全局线程池中正在执行任务的线程数量                                                                           |
| **HTTPConnection**                              | 与 HTTP 服务器的连接数                                                                              |
| **HashedDictionaryThreads**                     | HashedDictionary 线程池中的线程数量                                                                  |
| **HashedDictionaryThreadsActive**               | 正在运行任务的 HashedDictionary 线程池中的线程数                                                           |
| **IOPrefetchThreads**                           | I/O 预取线程池中的线程数量                                                                             |
| **IOPrefetchThreadsActive**                     | IO 预取线程池中正在执行任务的线程数量                                                                        |
| **IOThreads**                                   | I/O 线程池中的线程数量                                                                               |
| **IOThreadsActive**                             | IO 线程池中正在执行任务的线程数                                                                           |
| **IOUringInFlightEvents**                       | 正在执行的 io&#95;uring SQE 数量                                                                   |
| **IOUringPendingEvents**                        | 待提交的 io&#95;uring SQE 数量                                                                    |
| **IOWriterThreads**                             | IO 写入线程池中的线程数量                                                                              |
| **IOWriterThreadsActive**                       | IO 写入线程池中正在执行任务的线程数量                                                                        |
| **InterserverConnection**                       | 从其他副本拉取分区片段的连接数                                                                             |
| **KafkaAssignedPartitions**                     | Kafka 表当前被分配的分区数量                                                                           |
| **KafkaBackgroundReads**                        | 当前正在执行的后台读取任务数（用于从 Kafka 填充 materialized view）                                              |
| **KafkaConsumers**                              | 当前活跃的 Kafka 消费者数量                                                                           |
| **KafkaConsumersInUse**                         | 当前用于直接读取或后台读取的消费者数量                                                                         |
| **KafkaConsumersWithAssignment**                | 已分配分区的活动 Kafka 消费者数量                                                                        |
| **KafkaLibrdkafkaThreads**                      | 活动的 librdkafka 线程数                                                                          |
| **KafkaProducers**                              | 已创建的活跃 Kafka 生产者数量                                                                          |
| **KafkaWrites**                                 | 当前正在执行的向 Kafka 插入操作的数量                                                                      |
| **KeeperAliveConnections**                      | 存活连接数                                                                                       |
| **KeeperOutstandingRequests**                   | 未完成请求数                                                                                      |
| **LocalThread**                                 | 本地线程池中的线程数量（分配自全局线程池）                                                                       |
| **LocalThreadActive**                           | 本地线程池中正在运行任务的线程数量                                                                           |
| **MMappedAllocBytes**                           | `mmap` 分配的内存字节总量                                                                            |
| **MMappedAllocs**                               | mmapped 内存分配的总次数                                                                            |
| **MMappedFileBytes**                            | 内存映射文件区域大小总和                                                                                |
| **MMappedFiles**                                | 内存映射文件总数                                                                                    |
| **MarksLoaderThreads**                          | 标记加载线程池中的线程数量                                                                               |
| **MarksLoaderThreadsActive**                    | 用于加载标记的线程池中正在执行任务的线程数量                                                                      |
| **MaxDDLEntryID**                               | DDLWorker 已处理的最大 DDL 条目 ID                                                                  |
| **MaxPushedDDLEntryID**                         | DDLWorker 推送到 ZooKeeper 的最大 DDL 条目编号                                                        |
| **MemoryTracking**                              | 服务器已分配的内存总量（字节）                                                                             |
| **Merge**                                       | 正在执行的后台合并任务数                                                                                |
| **MergeTreeAllRangesAnnouncementsSent**         | 当前从远程服务器发送到发起方的、关于数据分区片段集合的在途通知数量（针对 MergeTree 表，在远程服务器上统计）                                 |
| **MergeTreeBackgroundExecutorThreads**          | MergeTreeBackgroundExecutor 线程池中的线程数                                                        |
| **MergeTreeBackgroundExecutorThreadsActive**    | MergeTreeBackgroundExecutor 线程池中正在执行任务的线程数量                                                 |
| **MergeTreeDataSelectExecutorThreads**          | MergeTreeDataSelectExecutor 线程池中的线程数                                                        |
| **MergeTreeDataSelectExecutorThreadsActive**    | MergeTreeDataSelectExecutor 线程池中正在执行任务的线程数量                                                 |
| **MergeTreePartsCleanerThreads**                | MergeTree 清理分区片段线程池中的线程数量                                                                   |
| **MergeTreePartsCleanerThreadsActive**          | MergeTree 分区片段清理线程池中正在执行任务的线程数                                                              |
| **MergeTreePartsLoaderThreads**                 | MergeTree 分区片段加载线程池中的线程数                                                                    |
| **MergeTreePartsLoaderThreadsActive**           | 当前正在执行任务的 MergeTree 分区片段加载器线程池中的线程数                                                         |
| **MergeTreeReadTaskRequestsSent**               | 当前从远程服务器发往发起端、用于选择读取任务的在途回调请求数量（针对 MergeTree 表，在远程服务器侧统计）                                   |
| **Move**                                        | 当前执行中的移动操作数                                                                                 |
| **MySQLConnection**                             | 使用 MySQL 协议的客户端连接数                                                                          |
| **NetworkReceive**                              | 负责从网络接收数据的线程数量（仅与 ClickHouse 相关，不包括第三方库）                                                    |
| **NetworkSend**                                 | 用于向网络发送数据的线程数量（仅与 ClickHouse 相关，不包括第三方库）                                                    |
| **OpenFileForRead**                             | 用于读取的已打开文件数                                                                                 |
| **OpenFileForWrite**                            | 当前以写入方式打开的文件数                                                                               |
| **ParallelFormattingOutputFormatThreads**       | ParallelFormattingOutputFormatThreads 线程池中的线程数                                              |
| **ParallelFormattingOutputFormatThreadsActive** | ParallelFormattingOutputFormatThreads 线程池中正在运行任务的线程数                                        |
| **PartMutation**                                | Mutation 操作次数（ALTER DELETE/UPDATE）                                                          |
| **PartsActive**                                 | 用于当前和后续 SELECT 查询的活动数据分片                                                                    |
| **PartsCommitted**                              | 已弃用。请参见 PartsActive                                                                         |
| **PartsCompact**                                | Compact 格式分区片段                                                                              |
| **PartsDeleteOnDestroy**                        | 数据分片已移动到另一块磁盘，并应在其析构函数中删除                                                                   |
| **PartsDeleting**                               | 带有独立引用计数器的非活动数据分片，当前正由清理线程删除                                                                |
| **PartsOutdated**                               | 非活跃数据部分，但可能仍仅被当前的 SELECT 使用，这些 SELECT 完成后即可删除                                               |
| **PartsPreActive**                              | 该分区片段位于 data&#95;parts 中，但未被用于任何 SELECT 查询                                                  |
| **PartsPreCommitted**                           | 已弃用。请参见 PartsPreActive                                                                      |
| **PartsTemporary**                              | 该分区片段当前正在生成，还未出现在 data&#95;parts 列表中                                                        |
| **PartsWide**                                   | 宽格式分区片段                                                                                     |
| **PendingAsyncInsert**                          | 处于等待 flush 状态的异步插入数量                                                                        |
| **PostgreSQLConnection**                        | 通过 PostgreSQL 协议的客户端连接数                                                                     |
| **查询**                                          | 正在执行的查询数                                                                                    |
| **QueryPreempted**                              | 由于 &#39;priority&#39; 设置而被暂停并等待的查询数量                                                        |
| **QueryThread**                                 | 查询处理线程数                                                                                     |
| **RWLockActiveReaders**                         | 在表的 RWLock 上持有读锁的线程数量                                                                       |
| **RWLockActiveWriters**                         | 表的 RWLock 中持有写锁的线程数                                                                         |
| **RWLockWaitingReaders**                        | 在表级 RWLock 上等待获取读锁的线程数量                                                                     |
| **RWLockWaitingWriters**                        | 在表级 RWLock 上等待写入的线程数量                                                                       |
| **Read**                                        | 正在执行的读类（read、pread、io&#95;getevents 等）系统调用数量                                                |
| **ReadTaskRequestsSent**                        | 当前从远程服务器发送到发起端、用于选择读取任务的正在进行的回调请求数量（适用于 s3Cluster 等场景，在远程服务器侧统计）                            |
| **ReadonlyReplica**                             | 在 ZooKeeper 会话丢失后重新初始化，或在未配置 ZooKeeper 的情况下启动而进入只读状态的 Replicated 表数量                        |
| **RemoteRead**                                  | 正在进行的远程读取请求数                                                                                |
| **ReplicatedChecks**                            | 处于一致性检查中的数据分区片段数量                                                                           |
| **ReplicatedFetch**                             | 当前从副本拉取的分区片段数量                                                                              |
| **ReplicatedSend**                              | 发送到各副本的分区片段数量                                                                               |
| **RestartReplicaThreads**                       | RESTART REPLICA 线程池中的线程数                                                                    |
| **RestartReplicaThreadsActive**                 | RESTART REPLICA 线程池中正在执行任务的线程数量                                                             |
| **RestoreThreads**                              | RESTORE 线程池中的线程数                                                                            |
| **RestoreThreadsActive**                        | RESTORE 线程池中正在执行任务的线程数                                                                      |
| **Revision**                                    | 服务器修订号（每次发布正式版或候选版本时递增，补丁版本除外）                                                              |
| **S3Requests**                                  | S3 请求次数                                                                                     |
| **SendExternalTables**                          | 向远程服务器发送外部表数据的连接数量（在执行带分布式子查询的 GLOBAL IN 和 GLOBAL JOIN 时使用）                                 |
| **SendScalars**                                 | 用于向远程服务器发送标量数据的连接数量                                                                         |
| **StorageBufferBytes**                          | Buffer 表缓冲区中的字节数                                                                            |
| **StorageBufferRows**                           | Buffer 表缓冲区中的行数                                                                             |
| **StorageDistributedThreads**                   | StorageDistributed 线程池中的线程数                                                                 |
| **StorageDistributedThreadsActive**             | StorageDistributed 线程池中正在执行任务的线程数量                                                          |
| **StorageHiveThreads**                          | StorageHive 线程池中的线程数                                                                        |
| **StorageHiveThreadsActive**                    | StorageHive 线程池中正在执行任务的线程数量                                                                 |
| **StorageS3Threads**                            | StorageS3 线程池中的线程数                                                                          |
| **StorageS3ThreadsActive**                      | StorageS3 线程池中正在执行任务的线程数量                                                                   |
| **SystemReplicasThreads**                       | system.replicas 线程池的线程数量                                                                    |
| **SystemReplicasThreadsActive**                 | system.replicas 线程池中正在执行任务的线程数                                                              |
| **TCPConnection**                               | 与 TCP 服务器的连接数（原生接口客户端），包括服务器之间的分布式查询连接数                                                     |
| **TablesToDropQueueSize**                       | 等待后台清理数据的已删除表数量                                                                             |
| **TemporaryFilesForAggregation**                | 用于外部聚合的临时文件数量                                                                               |
| **TemporaryFilesForJoin**                       | 为 JOIN 创建的临时文件数量                                                                            |
| **TemporaryFilesForSort**                       | 为外部排序创建的临时文件数量                                                                              |
| **TemporaryFilesUnknown**                       | 为未知用途创建的临时文件数量                                                                              |
| **ThreadPoolFSReaderThreads**                   | 用于 local&#95;filesystem&#95;read&#95;method=threadpool 的线程池线程数                              |
| **ThreadPoolFSReaderThreadsActive**             | local&#95;filesystem&#95;read&#95;method=threadpool 线程池中正在执行任务的线程数量                         |
| **ThreadPoolRemoteFSReaderThreads**             | 用于 remote&#95;filesystem&#95;read&#95;method=threadpool 的线程池中的线程数量                          |
| **ThreadPoolRemoteFSReaderThreadsActive**       | remote&#95;filesystem&#95;read&#95;method=threadpool 线程池中正在执行任务的线程数                         |
| **ThreadsInOvercommitTracker**                  | OvercommitTracker 中处于等待状态的线程数量                                                              |
| **TotalTemporaryFiles**                         | 已创建的临时文件总数                                                                                  |
| **VersionInteger**                              | 以单个以 1000 为基数的整数表示的服务器版本号（例如，版本 11.22.33 = 11022033）                                        |
| **写入**                                          | 处于进行中的写入（write、pwrite、io&#95;getevents 等）系统调用数量                                             |
| **ZooKeeperRequest**                            | 当前正在处理的 ZooKeeper 请求数量                                                                      |
| **ZooKeeperSession**                            | 与 ZooKeeper 的会话（连接）数量（由于缺乏线性一致性，应不超过一个）                                                     |
| **ZooKeeperWatch**                              | ZooKeeper 中的 watch（事件订阅）数量                                                                  |
| **ConcurrencyControlAcquired**                  | 已获取的 CPU 槽位总数                                                                               |
| **ConcurrencyControlSoftLimit**                 | CPU 槽位数的软限制值                                                                                |

**另请参阅**

- [system.asynchronous_metrics](/operations/system-tables/asynchronous_metrics) — 包含周期性计算的指标。
- [system.events](/operations/system-tables/events) — 包含已发生的各类事件。
- [system.metric_log](/operations/system-tables/metric_log) — 包含来自 `system.metrics` 和 `system.events` 表的指标值历史记录。
- [Monitoring](../../operations/monitoring.md) — ClickHouse 监控的基本概念。