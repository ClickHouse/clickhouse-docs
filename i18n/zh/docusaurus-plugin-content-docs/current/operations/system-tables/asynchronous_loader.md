---
description: '用于存储最近异步作业（例如正在加载的表）的信息和状态的系统表。该表为每个作业包含一行记录。'
keywords: ['系统表', 'asynchronous_loader']
slug: /operations/system-tables/asynchronous_loader
title: 'system.asynchronous_loader'
doc_type: 'reference'
---

import SystemTableCloud from '@site/docs/_snippets/_system_table_cloud.md';


# system.asynchronous_loader

<SystemTableCloud />

包含近期异步作业的信息和状态(例如表加载)。该表为每个作业包含一行。可使用工具 `utils/async_loader_graph` 可视化此表中的信息。

示例:

```sql
SELECT *
FROM system.asynchronous_loader
LIMIT 1
FORMAT Vertical
```

列:

<!--AUTOGENERATED_START-->

- `job` ([String](../../sql-reference/data-types/)) — 作业名称(可能不唯一)。
- `job_id` ([UInt64](../../sql-reference/data-types/)) — 作业的唯一 ID。
- `dependencies` ([Array(UInt64)](../../sql-reference/data-types/)) — 在此作业之前应完成的作业 ID 列表。
- `dependencies_left` ([UInt64](../../sql-reference/data-types/)) — 当前剩余待完成的依赖项数量。
- `status` ([Enum8('PENDING' = 0, 'OK' = 1, 'FAILED' = 2, 'CANCELED' = 3)](../../sql-reference/data-types/)) — 作业的当前加载状态:PENDING:加载作业尚未启动。OK:加载作业已执行且成功。FAILED:加载作业已执行但失败。CANCELED:由于移除或依赖项失败,加载作业将不会被执行。
- `is_executing` ([UInt8](../../sql-reference/data-types/)) — 作业当前正由工作线程执行。
- `is_blocked` ([UInt8](../../sql-reference/data-types/)) — 作业正在等待其依赖项完成。
- `is_ready` ([UInt8](../../sql-reference/data-types/)) — 作业已准备好执行并等待工作线程。
- `elapsed` ([Float64](../../sql-reference/data-types/)) — 自执行开始以来经过的秒数。如果作业未启动则为零。如果作业已完成则为总执行时间。
- `pool_id` ([UInt64](../../sql-reference/data-types/)) — 当前分配给作业的池 ID。
- `pool` ([String](../../sql-reference/data-types/)) — `pool_id` 池的名称。
- `priority` ([Int64](../../sql-reference/data-types/)) — `pool_id` 池的优先级。
- `execution_pool_id` ([UInt64](../../sql-reference/data-types/)) — 作业执行所在池的 ID。在执行开始前等于初始分配的池。
- `execution_pool` ([String](../../sql-reference/data-types/)) — `execution_pool_id` 池的名称。
- `execution_priority` ([Int64](../../sql-reference/data-types/)) — `execution_pool_id` 池的优先级。
- `ready_seqno` ([Nullable(UInt64)](../../sql-reference/data-types/)) — 对于就绪作业不为空。工作线程从其池的就绪队列中拉取下一个要执行的作业。如果有多个就绪作业,则选择 `ready_seqno` 值最低的作业。
- `waiters` ([UInt64](../../sql-reference/data-types/)) — 等待此作业的线程数。
- `exception` ([Nullable(String)](../../sql-reference/data-types/)) — 对于失败和取消的作业不为空。保存查询执行期间引发的错误消息或导致取消此作业的错误以及作业名称的依赖项失败链。
- `schedule_time` ([DateTime64(6)](../../sql-reference/data-types/)) — 作业创建并计划执行的时间(通常包括其所有依赖项)。
- `enqueue_time` ([Nullable(DateTime64(6))](../../sql-reference/data-types/)) — 作业变为就绪并入队到其池的就绪队列的时间。如果作业尚未就绪则为空。
- `start_time` ([Nullable(DateTime64(6))](../../sql-reference/data-types/)) — 工作线程从就绪队列中出队作业并开始执行的时间。如果作业尚未启动则为空。
- `finish_time` ([Nullable(DateTime64(6))](../../sql-reference/data-types/)) — 作业执行完成的时间。如果作业尚未完成则为空。
<!--AUTOGENERATED_END-->

待处理的作业可能处于以下状态之一:

- `is_executing` (`UInt8`) - 作业当前正由工作线程执行。
- `is_blocked` (`UInt8`) - 作业正在等待其依赖项完成。
- `is_ready` (`UInt8`) - 作业已准备好执行并等待工作线程。
- `elapsed` (`Float64`) - 自执行开始以来经过的秒数。如果作业未启动则为零。如果作业已完成则为总执行时间。


每个作业都关联有一个池，并在该池中启动。每个池具有固定的优先级以及可变的最大 worker 数量上限。更高优先级（`priority` 值更低）的作业会先运行。当至少有一个更高优先级的作业已就绪或正在执行时，优先级更低的作业不会被启动。可以通过对作业进行优先级提升来提高其优先级（但不能降低）。例如，如果传入查询需要某个表，那么该表的加载和启动作业会被优先处理。可以在作业执行期间提升其优先级，但作业不会从其 `execution_pool` 迁移到新分配的 `pool`。作业在创建新作业时会使用其所属的 `pool`，以避免出现优先级反转问题。已经启动的作业不会被更高优先级的作业抢占，并且一旦开始执行就会一直运行直至完成。
- `pool_id` (`UInt64`) - 当前分配给该作业的池的 ID。
- `pool` (`String`) - `pool_id` 所对应池的名称。
- `priority` (`Int64`) - `pool_id` 所对应池的优先级。
- `execution_pool_id` (`UInt64`) - 作业实际执行所在池的 ID。在执行开始前，该值等于最初分配的池。
- `execution_pool` (`String`) - `execution_pool_id` 所对应池的名称。
- `execution_priority` (`Int64`) - `execution_pool_id` 所对应池的优先级。

- `ready_seqno` (`Nullable(UInt64)`) - 对于已就绪作业为非空。worker 会从其池的就绪队列中拉取下一个要执行的作业。如果有多个已就绪作业，则选择 `ready_seqno` 值最小的作业。
- `waiters` (`UInt64`) - 等待该作业的线程数量。
- `exception` (`Nullable(String)`) - 对于失败和被取消的作业为非空。保存查询执行期间引发的错误消息，或导致该作业被取消的错误消息，以及依赖失败的作业名称链。

作业生命周期中的时间点：
- `schedule_time` (`DateTime64`) - 作业被创建并调度执行的时间（通常包括其所有依赖）。
- `enqueue_time` (`Nullable(DateTime64)`) - 作业变为就绪并被加入其池的就绪队列的时间。如果作业尚未就绪，则为 Null。
- `start_time` (`Nullable(DateTime64)`) - worker 从就绪队列中将作业出队并开始执行的时间。如果作业尚未开始，则为 Null。
- `finish_time` (`Nullable(DateTime64)`) - 作业执行完成的时间。如果作业尚未完成，则为 Null。
