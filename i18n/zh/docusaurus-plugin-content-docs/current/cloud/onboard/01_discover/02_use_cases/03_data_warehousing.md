---
slug: /cloud/get-started/cloud/use-cases/data_lake_and_warehouse
title: '数据湖仓'
description: '使用 ClickHouse Cloud 构建现代数据湖仓架构，将数据湖的灵活性与数据库级性能相结合'
keywords: ['使用场景', '数据湖与数据仓库']
sidebar_label: '数据仓库'
doc_type: 'guide'
---

import Image from '@theme/IdealImage';
import datalakehouse_01 from '@site/static/images/cloud/onboard/discover/use_cases/datalakehouse_01.png';

<iframe width="758" height="426" src="https://www.youtube.com/embed/mueG6z1mo8Y" title="数据湖仓（不到 3 分钟）" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen />

数据湖仓是一种融合架构，将数据库原理引入数据湖基础设施，同时保持云存储系统的灵活性和可扩展性。

湖仓不仅仅是把数据库拆解开来，而是在一种根本不同的基础（云对象存储）之上构建类数据库能力，旨在在统一的平台上同时支持传统分析和现代 AI/ML 工作负载。


## 数据湖仓的组成部分是什么？ {#components-of-the-data-lakehouse}

现代数据湖仓架构代表了数据仓库和数据湖技术的融合,结合了两种方法的优势。该架构由多个不同但相互关联的层组成,提供了一个灵活、强大的数据存储、管理和分析平台。

理解这些组件对于希望实施或优化数据湖仓策略的组织至关重要。分层方法允许组件替换和各层的独立演进,提供了架构灵活性和面向未来的保障。

让我们探讨典型数据湖仓架构的核心构建模块,以及它们如何交互以创建一个统一的数据管理平台。

<Image
  img={datalakehouse_01}
  alt='数据湖仓的组成部分'
  size='md'
/>

| 组件               | 描述                                                                                                                                                                                                                                                                                                                                    |
| ----------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **数据源**        | 湖仓数据源包括操作型数据库、流式平台、物联网设备、应用程序日志和外部数据提供商。                                                                                                                                                                                                              |
| **查询引擎**        | 处理针对对象存储中数据的分析查询,利用表格式层提供的元数据和优化。支持 SQL 和其他可能的查询语言,以高效分析大量数据。                                                                                     |
| **元数据目录**    | [数据目录](https://clickhouse.com/engineering-resources/data-catalog)充当元数据的中央存储库,存储和管理表定义和模式、分区信息以及访问控制策略。支持跨湖仓的数据发现、血缘追踪和治理。                             |
| **表格式层**  | [表格式层](https://clickhouse.com/engineering-resources/open-table-formats)管理数据文件到表的逻辑组织,提供类似数据库的功能,如 ACID 事务、模式强制和演进、时间旅行功能,以及数据跳过和聚簇等性能优化。 |
| **对象存储**      | 该层为所有数据文件和元数据提供可扩展、持久、经济高效的存储。它以开放格式处理数据的物理持久化,支持来自多个工具和系统的直接访问。                                                                                                                          |
| **客户端应用程序** | 连接到湖仓以查询数据、可视化洞察或构建数据产品的各种工具和应用程序。这些可以包括 BI 工具、数据科学笔记本、自定义应用程序以及 ETL/ELT 工具。                                                                                                                            |


## 数据湖仓有哪些优势？ {#benefits-of-the-data-lakehouse}

与传统数据仓库和数据湖相比，数据湖仓架构具有多项显著优势：

### 与传统数据仓库相比 {#compared-to-traditional-data-warehouses}

| #   | 优势                                          | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| --- | ------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 1   | **成本效益**                              | 湖仓采用低成本的对象存储而非专有存储格式，与对集成存储收取高额费用的数据仓库相比，可显著降低存储成本。                                                                                                                                                                                                                                          |
| 2   | **组件灵活性和可互换性** | 湖仓架构允许组织替换不同的组件。传统系统在需求变化或技术进步时需要整体替换,而湖仓则可通过更换查询引擎或表格式等单个组件来实现渐进式演进。这种灵活性降低了供应商锁定风险，使组织能够在无需进行破坏性迁移的情况下适应不断变化的需求。 |
| 3   | **开放格式支持**                          | 湖仓以 Parquet 等开放文件格式存储数据，允许各种工具直接访问而不受供应商锁定限制，这与将访问限制在其生态系统内的专有数据仓库格式形成鲜明对比。                                                                                                                                                                                                              |
| 4   | **AI/ML 集成**                            | 湖仓为机器学习框架和 Python/R 库提供对数据的直接访问，而数据仓库通常需要先提取数据才能用于高级分析。                                                                                                                                                                                                                                         |
| 5   | **独立扩展**                          | 湖仓将存储与计算分离，允许各自根据实际需求独立扩展，这与许多存储和计算捆绑扩展的数据仓库不同。                                                                                                                                                                                                                                                                              |

### 与数据湖相比 {#compared-to-data-lakes}

| #   | 优势                     | 描述                                                                                                                                                                                         |
| --- | --------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1   | **查询性能**       | 湖仓实现了索引、统计信息和数据布局优化，使 SQL 查询能够以与数据仓库相当的速度运行，克服了原始数据湖性能不佳的问题。 |
| 2   | **数据一致性**        | 通过 ACID 事务支持，湖仓可确保并发操作期间的数据一致性，解决了传统数据湖的一个主要局限性——文件冲突可能导致数据损坏。          |
| 3   | **模式管理**       | 湖仓强制执行模式验证并跟踪模式演进，防止数据湖中常见的"数据沼泽"问题——即由于模式不一致导致数据无法使用。                |
| 4   | **治理能力** | 湖仓在行/列级别提供细粒度访问控制和审计功能，弥补了基础数据湖中安全控制能力有限的不足。                                            |
| 5   | **BI 工具支持**         | 湖仓提供 SQL 接口和优化功能，使其与标准 BI 工具兼容，这与需要在可视化之前添加额外处理层的原始数据湖不同。           |


## ClickHouse 在数据湖仓架构中的定位 {#where-does-clickhouse-fit-in-the-data-lakehouse-architecture}

ClickHouse 是现代数据湖仓生态系统中的强大分析查询引擎。它为组织提供了高性能的大规模数据分析方案。凭借卓越的查询速度和效率,ClickHouse 成为极具吸引力的选择。

在湖仓架构中,ClickHouse 作为专用处理层,能够灵活地与底层数据交互。它可以直接查询存储在云对象存储系统(如 S3、Azure Blob Storage 或 Google Cloud Storage)中的 Parquet 文件,利用其优化的列式处理能力,即使面对海量数据集也能快速返回结果。这种直接查询能力使组织无需复杂的数据移动或转换流程即可分析湖中数据。

针对更复杂的数据管理需求,ClickHouse 可与开放表格式(如 Apache Iceberg、Delta Lake 或 Apache Hudi)集成。通过这种集成,ClickHouse 能够充分利用这些格式的高级特性,同时保持其一贯的卓越查询性能。组织可以直接集成这些表格式,也可以通过元数据目录(如 AWS Glue、Unity 或其他目录服务)进行连接。

将 ClickHouse 作为查询引擎集成到湖仓架构中,组织既能对数据湖执行极速分析查询,又能保持湖仓方法所强调的灵活性和开放性。这种组合既提供了专业分析数据库的性能特征,又不会牺牲湖仓模型的核心优势,包括组件可互换性、开放格式和统一数据管理。


## 混合架构:兼具两者优势 {#hybrid-architecture-the-best-of-both-worlds}

虽然 ClickHouse 在查询湖仓组件方面表现出色,但其高度优化的存储引擎还提供了额外的优势。对于需要超低延迟查询的使用场景——例如实时仪表板、运营分析或交互式用户体验——组织可以选择性地将性能关键型数据直接以 ClickHouse 的原生格式存储。这种混合方法兼具两者优势:ClickHouse 专用存储为时间敏感型分析提供无与伦比的查询速度,同时在需要时保持查询更广泛数据湖仓的灵活性。

这种双重能力使组织能够实施分层数据策略,将热数据和频繁访问的数据存储在 ClickHouse 的优化存储中以实现亚秒级查询响应,同时保持对湖仓中完整数据历史的无缝访问。团队可以基于性能需求而非技术限制做出架构决策,将 ClickHouse 用作关键工作负载的超高速分析数据库,以及更广泛数据生态系统的灵活查询引擎。
