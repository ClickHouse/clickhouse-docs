---
slug: /changelogs/25.6
title: 'v25.6 Cloud 版本更新日志'
description: 'v25.6 快速发布版本更新日志'
keywords: ['changelog', 'cloud']
sidebar_label: '25.6'
sidebar_position: 2
doc_type: 'changelog'
---



## 向后不兼容的变更 {#backward-incompatible-change}

- 函数 `geoToH3()` 现在按照 (lat, lon, res) 的顺序接受输入(这是几何函数的标准顺序)。希望保留旧版输入顺序 (lon, lat, res) 的用户可以设置 `geotoh3_lon_lat_input_order = true`。[#78852](https://github.com/ClickHouse/ClickHouse/pull/78852) ([Pratima Patel](https://github.com/pratimapatel2008))。
- 类型为 `full_text` 的索引已重命名为 `gin`。这遵循了 PostgreSQL 和其他数据库更为常见的术语。现有的 `full_text` 类型索引仍可加载,但在尝试将其用于搜索时会抛出异常(建议改用 `gin` 索引)。[#79024](https://github.com/ClickHouse/ClickHouse/pull/79024) ([Robert Schulze](https://github.com/rschu1ze))。
- 添加了文件系统缓存设置 `allow_dynamic_cache_resize`,默认值为 `false`,用于允许动态调整文件系统缓存大小。原因:在某些环境中(ClickHouse Cloud),所有扩缩容事件都通过重启进程来实现,我们希望明确禁用此功能以更好地控制行为并作为安全措施。此 PR 标记为向后不兼容,因为在旧版本中,动态缓存调整默认启用且无需特殊设置。[#79148](https://github.com/ClickHouse/ClickHouse/pull/79148) ([Kseniia Sumarokova](https://github.com/kssenii))。
- 移除了对旧版索引类型 `annoy` 和 `usearch` 的支持。这两者长期以来一直是存根,即每次尝试使用这些旧版索引都会返回错误。如果您仍有 `annoy` 和 `usearch` 索引,请删除它们。[#79802](https://github.com/ClickHouse/ClickHouse/pull/79802) ([Robert Schulze](https://github.com/rschu1ze))。#_ 移除 `format_alter_commands_with_parentheses` 服务器设置。该设置在 24.2 中引入并默认禁用。在 25.2 中默认启用。由于没有不支持新格式的 LTS 版本,我们可以移除该设置。[#79970](https://github.com/ClickHouse/ClickHouse/pull/79970) ([János Benjamin Antal](https://github.com/antaljanosbenjamin))。#_ 次要变更:强制 backup_threads 和 restore_threads 服务器设置为非零值。[#80224](https://github.com/ClickHouse/ClickHouse/pull/80224) ([Raúl Marín](https://github.com/Algunenano))。
- 修复 bitNot() 对 String 类型返回以零结尾的字符串。[#80791](https://github.com/ClickHouse/ClickHouse/pull/80791) ([Azat Khuzhin](https://github.com/azat))。


## 新功能 {#new-feature}


* 在 MergeTree 的 `SETTINGS` 中新增一个选项，用于指定默认压缩编解码器，如果 `CREATE` 查询未为给定列显式指定压缩编解码器，则使用该默认值。此改动关闭了 [#42005](https://github.com/ClickHouse/ClickHouse/issues/42005)。 [#66394](https://github.com/ClickHouse/ClickHouse/pull/66394) ([gvoelfin](https://github.com/gvoelfin))。
* 跟进 [https://github.com/ClickHouse/ClickHouse/pull/71943](https://github.com/ClickHouse/ClickHouse/pull/71943)。此 PR 实现了 `Time`/`Time64` 数据类型。新增数据类型：Time（HHH:MM:SS）和 Time64（HHH:MM:SS.`&lt;fractional&gt;`），一些基础的类型转换函数，以及用于与其他数据类型交互的函数。同时，将已有函数名 `toTime` 更名为 `toTimeWithFixedDate`，因为类型转换功能需要使用 `toTime` 这一函数名。[#75735](https://github.com/ClickHouse/ClickHouse/pull/75735)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* 在 `WHERE` 子句中的 `EXISTS` 表达式中支持将关联子查询作为参数。修复了 [#72459](https://github.com/ClickHouse/ClickHouse/issues/72459)。[#76078](https://github.com/ClickHouse/ClickHouse/pull/76078)（[Dmitry Novik](https://github.com/novikd)）。
* 允许向 Merge 表引擎写入。[#77484](https://github.com/ClickHouse/ClickHouse/pull/77484) ([Anton Ivashkin](https://github.com/ianton-ru)).
* 针对复制 MergeTree 表的分布式 `INSERT SELECT` 现在可以高效利用并行副本，通过在不同节点上选择不同数据并独立执行插入来并行化 `INSERT`。[#78041](https://github.com/ClickHouse/ClickHouse/pull/78041) ([Igor Nikonov](https://github.com/devcrafter))。
* 添加 `mapContainsValuesLike` / `mapContainsValues` / `mapExtractValuesLike` 函数，用于按 map 的值进行过滤，并在基于 Bloom filter 的索引中提供对这些函数的支持。 [#78171](https://github.com/ClickHouse/ClickHouse/pull/78171) ([UnamedRus](https://github.com/UnamedRus)).
* 添加 `system.iceberg_history` 表。[#78244](https://github.com/ClickHouse/ClickHouse/pull/78244)（[Smita Kulkarni](https://github.com/SmitaRKulkarni)）。
* 新增基于查询插槽的工作负载调度功能，详见 [https://clickhouse.com/docs/operations/workload-scheduling#query&#95;scheduling](https://clickhouse.com/docs/operations/workload-scheduling#query_scheduling)。[#78415](https://github.com/ClickHouse/ClickHouse/pull/78415)（[Sergei Trifonov](https://github.com/serxa)）。
* 新增 `getServerSetting` 和 `getMergeTreeSetting` 函数。修复 [https://github.com/clickhouse/clickhouse/issues/78318](https://github.com/clickhouse/clickhouse/issues/78318)。[#78439](https://github.com/ClickHouse/ClickHouse/pull/78439)（[NamNguyenHoai](https://github.com/NamHoaiNguyen)）。
* 在设置约束中支持配置被禁止的取值。[#78499](https://github.com/ClickHouse/ClickHouse/pull/78499)（[Bharat Nallan](https://github.com/bharatnc)）。
* 新增 `iceberg_enable_version_hint` 设置，用于利用 `version-hint.text` 文件。[#78594](https://github.com/ClickHouse/ClickHouse/pull/78594)（[Arnaud Briche](https://github.com/arnaudbriche)）。
* 支持使用 `LIKE` 关键字进行过滤，从数据库中截断特定表。[#78597](https://github.com/ClickHouse/ClickHouse/pull/78597)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* 当存在要处理的输入数据时，`clickhouse-local`（及其简写别名 `ch`）现在会隐式添加 `FROM table`。这解决了 [#65023](https://github.com/ClickHouse/ClickHouse/issues/65023)。同时，如果未指定 `--input-format` 且要处理的是常规文件，`clickhouse-local` 现在会自动推断输入格式。[#79085](https://github.com/ClickHouse/ClickHouse/pull/79085)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 新增 [`icebergHash`](https://iceberg.apache.org/spec/#appendix-b-32-bit-hash-requirements) 和 [`icebergBucketTransform`](https://iceberg.apache.org/spec/#bucket-transform-details) 函数。支持对使用 [`bucket transfom`](https://iceberg.apache.org/spec/#partitioning) 分区的 `Iceberg` 表进行数据文件剪枝。[#79262](https://github.com/ClickHouse/ClickHouse/pull/79262) ([Daniil Ivanik](https://github.com/divanik))。
* 增加对 Coalescing Merge Tree 的支持。修复了 [#78869](https://github.com/ClickHouse/ClickHouse/issues/78869)。[#79344](https://github.com/ClickHouse/ClickHouse/pull/79344)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* 添加 `stringBytesUniq` 和 `stringBytesEntropy` 函数，用于搜索可能为随机或加密的数据。[#79350](https://github.com/ClickHouse/ClickHouse/pull/79350)（[Sachin Kumar Singh](https://github.com/sachinkumarsingh092)）。
* 在 MergeTree 系列表中支持 `_part_starting_offset` 虚拟列。该列表示所有前序 part 的累积行数，在查询时基于当前的 part 列表计算得到。累积值在整个查询执行过程中都会被保留，即使在 part 剪枝之后也仍然有效。相关的内部逻辑已重构以支持此行为。 [#79417](https://github.com/ClickHouse/ClickHouse/pull/79417) ([Amos Bird](https://github.com/amosbird))。
* 新增了设置项 `enable_shared_storage_snapshot_in_query`，用于在单个查询中让所有子查询共享同一个存储快照。这样即使在查询中多次引用同一张表，也能确保从该表读取的数据保持一致。[#79471](https://github.com/ClickHouse/ClickHouse/pull/79471) ([Amos Bird](https://github.com/amosbird))。
* 支持将 CH JSON 列写入 Parquet，并将 Parquet 中的 JSON 列直接读取为 CH JSON 列。 [#79649](https://github.com/ClickHouse/ClickHouse/pull/79649) ([Nihal Z. Miaji](https://github.com/nihalzp))。
* 将 [`chdig`](https://github.com/azat/chdig/)（ClickHouse 的类 `top` 风格 TUI 界面）作为组件打包进 ClickHouse。[#79666](https://github.com/ClickHouse/ClickHouse/pull/79666)（[Azat Khuzhin](https://github.com/azat)）。
* 为 `pointInPolygon` 添加对 `MultiPolygon` 的支持。[#79773](https://github.com/ClickHouse/ClickHouse/pull/79773) ([Nihal Z. Miaji](https://github.com/nihalzp))。
* 支持 Geo Parquet。这将关闭 [#75317](https://github.com/ClickHouse/ClickHouse/issues/75317)。[#79777](https://github.com/ClickHouse/ClickHouse/pull/79777)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* 通过 `deltaLakeLocal` 表函数新增对查询本地文件系统挂载的 Delta 表的支持。 [#79781](https://github.com/ClickHouse/ClickHouse/pull/79781) ([roykim98](https://github.com/roykim98)).
* 新增了 `base32` 编码/解码功能。 [#79809](https://github.com/ClickHouse/ClickHouse/pull/79809) ([Joanna Hulboj](https://github.com/jh0x))。
* ClickHouse 向量搜索现在同时支持预过滤和后过滤，并提供相关设置以实现更细粒度的控制。（issue [#78161](https://github.com/ClickHouse/ClickHouse/issues/78161)）。[#79854](https://github.com/ClickHouse/ClickHouse/pull/79854)（[Shankar Iyer](https://github.com/shankar-iyer)）。
* 支持读取 WKB 格式的函数。此更改部分解决了 [#43941](https://github.com/ClickHouse/ClickHouse/issues/43941)。[#80139](https://github.com/ClickHouse/ClickHouse/pull/80139) ([Konstantin Vedernikov](https://github.com/scanhex12))。
* 新增设置 `cast_string_to_date_time_mode`，用于在将 String 转换为 DateTime 时选择解析模式。[#80210](https://github.com/ClickHouse/ClickHouse/pull/80210) ([Pavel Kruglov](https://github.com/Avogar)).
* 添加了 `Bech32` 和 `Bech32m` 编码与解码函数（问题 [#40381](https://github.com/ClickHouse/ClickHouse/issues/40381)）。[#80239](https://github.com/ClickHouse/ClickHouse/pull/80239)（[George Larionov](https://github.com/glarik)）。
* 为 Atomic 和 Ordinary 数据库引擎新增对 `disk` 设置的支持，用于指定存放表元数据文件的磁盘。[#80546](https://github.com/ClickHouse/ClickHouse/pull/80546) ([Tuan Pham Anh](https://github.com/tuanpach))。
* 支持用于解包和比较 MergeTree 分区的函数。 [#80573](https://github.com/ClickHouse/ClickHouse/pull/80573) ([Mikhail Artemenko](https://github.com/Michicosun)).
* `timeSeries*` 辅助函数，用于在处理时间序列数据时加速某些场景：- 按指定的起始时间戳、结束时间戳和步长将数据重新采样到时间网格上 - 计算类似 PromQL 的 `delta`、`rate`、`idelta` 和 `irate`。 [#80590](https://github.com/ClickHouse/ClickHouse/pull/80590) ([Alexander Gololobov](https://github.com/davenger))。
* 允许根据分区所在的磁盘来筛选参与查询的分区。 [#80650](https://github.com/ClickHouse/ClickHouse/pull/80650) ([tanner-bruce](https://github.com/tanner-bruce)).
* 添加一个包含嵌入式 Web 工具列表的着陆页。当由类似浏览器的用户代理请求时，将会打开该页面。 [#81129](https://github.com/ClickHouse/ClickHouse/pull/81129) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 允许在 `arrayFirst`、`arrayFirstIndex`、`arrayLast` 和 `arrayLastIndex` 中对 `NULL` 值进行过滤。修复 [#81113](https://github.com/ClickHouse/ClickHouse/issues/81113)。[#81197](https://github.com/ClickHouse/ClickHouse/pull/81197)（[Lennard Eijsackers](https://github.com/Blokje5)）。





## 实验性功能 {#experimental-feature}

- 为 Iceberg 数据湖提供 Hive metastore 目录支持。[#77677](https://github.com/ClickHouse/ClickHouse/pull/77677) ([Konstantin Vedernikov](https://github.com/scanhex12)).
- 支持通过键值对方式配置显式参数。当前支持的参数包括:必需参数 `tokenizer`,以及可选参数 `max_rows_per_postings_list` 和 `ngram_size`。[#80262](https://github.com/ClickHouse/ClickHouse/pull/80262) ([Elmi Ahmadov](https://github.com/ahmadov)).
- 实验性索引类型 `gin` 已重命名为 `text`。现有的 `gin` 类型索引仍可加载,但在搜索中使用时会抛出异常(提示应改用 `text` 索引)。[#80855](https://github.com/ClickHouse/ClickHouse/pull/80855) ([Robert Schulze](https://github.com/rschu1ze)).


## 性能提升 {#performance-improvement}


* 通过在多个 granule 上同时计算表达式来加速二级索引。[#64109](https://github.com/ClickHouse/ClickHouse/pull/64109)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 引入了一个阈值（通过设置 `parallel_hash_join_threshold` 进行控制），当右表大小低于该阈值时会回退使用 `hash` 算法。[#76185](https://github.com/ClickHouse/ClickHouse/pull/76185) ([Nikita Taranov](https://github.com/nickitat))。
* 现有的 `Pipe::resize` 实现会在流水线拓扑中插入一个 `Resize` 或 `StrictResize` 节点，该节点作为中心枢纽，将所有输入流（上游节点）连接到一组统一的输出流（下游节点）。这种设计在执行流水线图时，会引发对 `ExecutingGraph::Node::status_mutex` 的竞争，尤其是在高核数环境中。当流水线扩展到几十甚至上百个流时，这种竞争会导致：[#77562](https://github.com/ClickHouse/ClickHouse/pull/77562) ([Zhiguo Zhou](https://github.com/ZhiguoZh))。
* 通过允许并行执行 `INSERT` 写入（可通过队列设置 `parallel_inserts=true` 启用），提升 `S3Queue`/`AzureQueue` 的性能。此前，`S3Queue`/`AzureQueue` 只能在流水线的第一阶段（下载、解析）并行执行，`INSERT` 写入是单线程的，而 `INSERT` 几乎总是性能瓶颈。现在性能几乎可以随 `processing_threads_num` 线性扩展。[#77671](https://github.com/ClickHouse/ClickHouse/pull/77671) ([Azat Khuzhin](https://github.com/azat))。
* 更改 compact 部件格式，为每个子流保存标记，从而能够单独读取各个子列。旧的 compact 格式在读取时仍受支持，并且可以通过 MergeTree 设置 `write_marks_for_substreams_in_compact_parts` 在写入时启用。出于更安全升级的考虑，该设置默认禁用，因为它会改变 compact 部件的存储方式。该设置将在后续的某个版本中默认启用。[#77940](https://github.com/ClickHouse/ClickHouse/pull/77940)（[Pavel Kruglov](https://github.com/Avogar)）。
* 引入了新的设置 `use_skip_indexes_in_final_exact_mode`。如果对 `ReplacingMergeTree` 表的查询带有 `FINAL` 子句，仅根据 skip index 读取表范围可能会产生不正确的结果。启用此设置后，会额外扫描与 skip index 返回的主键范围有重叠的较新数据片段，从而确保结果正确。设置为 0 表示禁用，1 表示启用。[#78350](https://github.com/ClickHouse/ClickHouse/pull/78350)（[Shankar Iyer](https://github.com/shankar-iyer)）。
* 现在我们在启用并行副本读取时，根据副本数量来确定任务大小。当需要读取的数据量不太大时，这可以在副本之间实现更均衡的工作分配。[#78695](https://github.com/ClickHouse/ClickHouse/pull/78695)（[Nikita Taranov](https://github.com/nickitat)）。
* 允许在分布式聚合的最终阶段对 `uniqExact` 状态进行并行合并。[#78703](https://github.com/ClickHouse/ClickHouse/pull/78703)（[Nikita Taranov](https://github.com/nickitat)）。
* 修复在按键聚合时并行合并 `uniqExact` 状态可能导致的性能下降问题。 [#78724](https://github.com/ClickHouse/ClickHouse/pull/78724) ([Nikita Taranov](https://github.com/nickitat))。
  #* 将 `DELETE FROM ... WHERE 1` 查询替换为 `TRUNCATE`。（已回退）。 [#78739](https://github.com/ClickHouse/ClickHouse/pull/78739) ([Konstantin Vedernikov](https://github.com/scanhex12))。
* 减少对 Azure 存储发起 List Blobs API 调用的次数。 [#78860](https://github.com/ClickHouse/ClickHouse/pull/78860) ([Julia Kartseva](https://github.com/jkartseva)).
* 如果可能，将过滤查询计划步骤中的相等条件合并到 `JOIN` 条件中，从而可以将其用作哈希表键。[#78877](https://github.com/ClickHouse/ClickHouse/pull/78877) ([Dmitry Novik](https://github.com/novikd))。
* 通过使用 `extractKeyValuePairs` 替代正则表达式来提升 Hive 路径解析性能。[#79067](https://github.com/ClickHouse/ClickHouse/pull/79067) ([Arthur Passos](https://github.com/arthurpassos))。
* 修复使用并行副本的分布式 `INSERT SELECT` 的性能。[#79441](https://github.com/ClickHouse/ClickHouse/pull/79441) ([Azat Khuzhin](https://github.com/azat)).
* 允许将包含子列的条件移动到 `PREWHERE`。 [#79489](https://github.com/ClickHouse/ClickHouse/pull/79489) ([Pavel Kruglov](https://github.com/Avogar)).
* 对所有 Bloom Filter 类型进行了性能优化。 [#79800](https://github.com/ClickHouse/ClickHouse/pull/79800) ([Delyan Kratunov](https://github.com/dkratunov)).
* 避免 `LogSeriesLimiter` 在每次构造时都执行清理操作，从而防止在高并发场景下出现锁竞争和性能退化。 [#79864](https://github.com/ClickHouse/ClickHouse/pull/79864) ([filimonov](https://github.com/filimonov)).
* 默认启用 `compile_expressions`（针对普通表达式片段的 JIT 编译器）。这解决了 [#51264](https://github.com/ClickHouse/ClickHouse/issues/51264)、[#56386](https://github.com/ClickHouse/ClickHouse/issues/56386) 和 [#66486](https://github.com/ClickHouse/ClickHouse/issues/66486) 问题。[#79907](https://github.com/ClickHouse/ClickHouse/pull/79907)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 通过“trivial count”优化加速查询。 [#79945](https://github.com/ClickHouse/ClickHouse/pull/79945) ([Raúl Marín](https://github.com/Algunenano)).
* 在 `UniqExactSet::merge` 中新增了针对其中一个集合为空时的理想执行路径。同时，现在如果左侧集合是两级结构而右侧集合是单级结构，我们将不会再把右侧集合转换为两级结构。[#79971](https://github.com/ClickHouse/ClickHouse/pull/79971) ([Nikita Taranov](https://github.com/nickitat))。
* 为 `convertDecimalsImpl` 添加 `__attribute__((always_inline))`。 [#79999](https://github.com/ClickHouse/ClickHouse/pull/79999) ([Konstantin Bogdanov](https://github.com/thevar1able))。
* 默认将 `input_format_parquet_bloom_filter_push_down` 设置为 true。同时，修正设置变更历史中的一个错误。[#80058](https://github.com/ClickHouse/ClickHouse/pull/80058) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
  #* 默认将日志记录改为异步方式。你可以通过在 `<logger>` 下设置 `<async>false</async>` 来禁用。[#80125](https://github.com/ClickHouse/ClickHouse/pull/80125) ([Raúl Marín](https://github.com/Algunenano))。
* 在使用两级哈希表时，提高内存复用效率并减少缺页错误。 [#80245](https://github.com/ClickHouse/ClickHouse/pull/80245) ([Jiebin Sun](https://github.com/jiebinn))。
* 在 `QueryConditionCache` 中避免不必要的更新并减少锁竞争。[#80247](https://github.com/ClickHouse/ClickHouse/pull/80247) ([Jiebin Sun](https://github.com/jiebinn))。
* 对 `concatenateBlocks` 进行了小幅优化，有利于并行 Hash join。[#80328](https://github.com/ClickHouse/ClickHouse/pull/80328) ([李扬](https://github.com/taiyang-li))。
* 当从主键范围中选择标记范围时，如果主键被函数包裹，则无法使用二分查找。此 PR 改进了这一限制：当主键被一组始终单调的函数链包裹时，或者当 RPN 中包含一个恒为真的元素时，仍然可以使用二分查找。此 PR 关闭了 [#45536](https://github.com/ClickHouse/ClickHouse/issues/45536)。[#80597](https://github.com/ClickHouse/ClickHouse/pull/80597)（[zoomxi](https://github.com/zoomxi)）。
* 提升 Kafka 引擎的关闭速度（在存在多个 Kafka 表时移除额外的 3 秒延迟）。 [#80796](https://github.com/ClickHouse/ClickHouse/pull/80796) ([Azat Khuzhin](https://github.com/azat)).
* 减少异步插入的内存占用，并提升插入查询的性能。 [#80972](https://github.com/ClickHouse/ClickHouse/pull/80972) ([Raúl Marín](https://github.com/Algunenano)).
* 如果日志表已禁用，则不要对处理器进行分析。 [#81256](https://github.com/ClickHouse/ClickHouse/pull/81256) ([Raúl Marín](https://github.com/Algunenano)).
* 当源数据与所需结果完全一致时，加速 `toFixedString`。 [#81257](https://github.com/ClickHouse/ClickHouse/pull/81257) ([Raúl Marín](https://github.com/Algunenano)).
* 如果用户未受限，则不要处理配额数值。[#81549](https://github.com/ClickHouse/ClickHouse/pull/81549)（[Raúl Marín](https://github.com/Algunenano)）。
* 将 ProcfsMetricsProvider 设为 thread&#95;local，以在任务之间保持文件保持打开状态。[#81576](https://github.com/ClickHouse/ClickHouse/pull/81576) ([Raúl Marín](https://github.com/Algunenano))。
* 修复了内存跟踪中的性能回退问题。 [#81694](https://github.com/ClickHouse/ClickHouse/pull/81694) ([Michael Kolupaev](https://github.com/al13n321)).





## 改进 {#improvement}


#* 如果指定 `--path` 命令行参数,`clickhouse-local` 将在重启后保留其数据库。这解决了 [#50647](https://github.com/ClickHouse/ClickHouse/issues/50647)。这解决了 [#49947](https://github.com/ClickHouse/ClickHouse/issues/49947)。[#71722](https://github.com/ClickHouse/ClickHouse/pull/71722) ([Alexey Milovidov](https://github.com/alexey-milovidov))。

* `EXPLAIN SYNTAX` 现在使用新的分析器。它返回从查询树构建的抽象语法树（AST）。新增选项 `query_tree_passes`，用于控制在将查询树转换为 AST 之前要执行的遍数。[#74536](https://github.com/ClickHouse/ClickHouse/pull/74536) ([Vladimir Cherkasov](https://github.com/vdimir))。
  #* 在文件系统缓存中默认使用 SLRU 缓存策略。[#75072](https://github.com/ClickHouse/ClickHouse/pull/75072) ([Kseniia Sumarokova](https://github.com/kssenii))。
* 重构了推送到视图的逻辑。[#77309](https://github.com/ClickHouse/ClickHouse/pull/77309) ([Sema Checherinda](https://github.com/CheSema))。
* 对象存储集群表函数（例如 `s3Cluster`）现在会基于一致性哈希为各副本分配要读取的文件，从而提升缓存局部性。 [#77326](https://github.com/ClickHouse/ClickHouse/pull/77326) ([Andrej Hoos](https://github.com/adikus))。
* 在出现 `AuthenticationRequired` 错误后刷新 S3 认证凭据。 [#77353](https://github.com/ClickHouse/ClickHouse/pull/77353) ([Vitaly Baranov](https://github.com/vitlibar)).
* 借助构建器在部分 HTTP 缓冲区中嵌入代理配置。[#77693](https://github.com/ClickHouse/ClickHouse/pull/77693)（[Arthur Passos](https://github.com/arthurpassos)）。
* 在 `system.asynchronous_metrics` 中新增了字典相关指标 - `DictionaryMaxUpdateDelay` - 字典更新的最大延迟（单位：秒）。 - `DictionaryTotalFailedUpdates` - 自上次成功加载以来所有字典中的错误总次数。 [#78175](https://github.com/ClickHouse/ClickHouse/pull/78175) ([Vlad](https://github.com/codeworse))。
* 添加函数 `divideOrNull`、`moduloOrNull`、`intDivOrNull`、`positiveModuloOrNull`，在右侧参数为零时返回 NULL。 [#78276](https://github.com/ClickHouse/ClickHouse/pull/78276) ([kevinyhzou](https://github.com/KevinyhZou))。
* 将 `isIPAddressInRange` 函数扩展为支持 String、IPv4、IPv6、Nullable(String)、Nullable(IPv4) 和 Nullable(IPv6) 数据类型。[#78364](https://github.com/ClickHouse/ClickHouse/pull/78364)（[YjyJeff](https://github.com/YjyJeff)）。
* 动态调整 PostgreSQL 引擎的连接池设置。 [#78414](https://github.com/ClickHouse/ClickHouse/pull/78414) ([Samay Sharma](https://github.com/samay-sharma)).
* 允许在普通 projection 中指定 `_part_offset`。这是构建 projection 索引的第一步。它可以与 [#58224](https://github.com/ClickHouse/ClickHouse/issues/58224) 一起使用，并有助于改进 [#63207](https://github.com/ClickHouse/ClickHouse/pull/63207)。[#78429](https://github.com/ClickHouse/ClickHouse/pull/78429)（[Amos Bird](https://github.com/amosbird)）。
* 改进分布式查询的分片键优化。[#78452](https://github.com/ClickHouse/ClickHouse/pull/78452) ([fhw12345](https://github.com/fhw12345))。
* 为 `system.named_collections` 新增列（`create_query` 和 `source`）。修复 [#78179](https://github.com/ClickHouse/ClickHouse/issues/78179)。[#78582](https://github.com/ClickHouse/ClickHouse/pull/78582)（[MikhailBurdukov](https://github.com/MikhailBurdukov)）。
* 在系统表 `system.query_condition_cache` 中新增字段 `condition`。该字段存储其哈希值被用作查询条件缓存键的明文条件。 [#78671](https://github.com/ClickHouse/ClickHouse/pull/78671) ([Robert Schulze](https://github.com/rschu1ze)).
* 使用 ClickHouse Keeper 为 StorageKafka2 实现类似 Kafka 重新均衡的逻辑。对于每个副本，我们支持两种类型的分区锁：永久锁和临时锁。副本会尽可能长时间地持有永久锁，在任意时刻，副本上的永久锁数量不超过 `all_topic_partitions / active_replicas_count`（其中 `all_topic_partitions` 是所有分区的数量，`active_replicas_count` 是活动副本的数量）；如果超过，则该副本会释放部分分区。一些分区会被副本以临时锁的形式持有。副本上的临时锁最大数量会动态变化，以便让其他副本有机会将一些分区获取为永久锁。在更新临时锁时，副本会释放所有临时锁，并尝试重新获取其他一些分区。[#78726](https://github.com/ClickHouse/ClickHouse/pull/78726)（[Daria Fomina](https://github.com/sinfillo)）。
* 为 `Kafka` 表引擎添加用于 SASL 配置和凭据的表设置。这样可以在 `CREATE TABLE` 语句中直接配置基于 SASL 的 Kafka 及 Kafka 兼容系统的认证，而无需使用配置文件或命名集合。[#78810](https://github.com/ClickHouse/ClickHouse/pull/78810)（[Christoph Wurm](https://github.com/cwurm)）。
* 添加针对可能为保存损坏表而创建的数据库的警告。[#78841](https://github.com/ClickHouse/ClickHouse/pull/78841)（[János Benjamin Antal](https://github.com/antaljanosbenjamin)）。
* 现在可以在 `BFloat16` 列上创建向量相似度索引。[#78850](https://github.com/ClickHouse/ClickHouse/pull/78850)（[Robert Schulze](https://github.com/rschu1ze)）。
* 在“best-effort”模式的 `DateTime64` 解析中支持带有小数部分的 Unix 时间戳。[#78908](https://github.com/ClickHouse/ClickHouse/pull/78908) ([Pavel Kruglov](https://github.com/Avogar))。
* 修复存储 DeltaLake 的 delta-kernel 实现中的 `columnMappingMode.name`，并为模式演进添加测试。[#78921](https://github.com/ClickHouse/ClickHouse/pull/78921) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 通过改进数值转换方式，优化以 `Values` 格式向 `Variant` 列插入数据的行为。[#78923](https://github.com/ClickHouse/ClickHouse/pull/78923) ([Pavel Kruglov](https://github.com/Avogar)).
* 在 `S3Queue` 引擎中新增 `_time` 虚拟列。[#78926](https://github.com/ClickHouse/ClickHouse/pull/78926) ([Anton Ivashkin](https://github.com/ianton-ru))。
* `tokens` 函数已扩展为接受一个额外的 “tokenizer” 参数，以及更多与该 tokenizer 相关的特定参数。[#79001](https://github.com/ClickHouse/ClickHouse/pull/79001)（[Elmi Ahmadov](https://github.com/ahmadov)）。
* `SHOW CLUSTER` 语句现在会在其参数中展开（如有）宏。[#79006](https://github.com/ClickHouse/ClickHouse/pull/79006)（[arf42](https://github.com/arf42)）。
* 哈希函数现在支持数组、元组和映射中的 `NULL` 值（问题 [#48365](https://github.com/ClickHouse/ClickHouse/issues/48365) 和 [#48623](https://github.com/ClickHouse/ClickHouse/issues/48623)）。[#79008](https://github.com/ClickHouse/ClickHouse/pull/79008)（[Michael Kolupaev](https://github.com/al13n321)）。
* 在只读 MergeTree 表中增加对刷新操作的支持。[#79033](https://github.com/ClickHouse/ClickHouse/pull/79033) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
  #* 将 cctz 更新到 2025a。[#79043](https://github.com/ClickHouse/ClickHouse/pull/79043) ([Raúl Marín](https://github.com/Algunenano))。
* 使用于控制 CPU 过载时断开连接的设置支持热加载。 [#79052](https://github.com/ClickHouse/ClickHouse/pull/79052) ([Alexey Katsman](https://github.com/alexkats)).
* 这可以提升可用性。[#79066](https://github.com/ClickHouse/ClickHouse/pull/79066) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 默认启用查询条件缓存。 [#79080](https://github.com/ClickHouse/ClickHouse/pull/79080) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* 使 Web UI 中的标签页操作支持撤销功能。该更改关闭了 [#71284](https://github.com/ClickHouse/ClickHouse/issues/71284)。 [#79084](https://github.com/ClickHouse/ClickHouse/pull/79084) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 在执行 `recoverLostReplica` 时移除这些 `settings`，方式与[https://github.com/ClickHouse/ClickHouse/pull/78637](https://github.com/ClickHouse/ClickHouse/pull/78637) 中的做法相同。[#79113](https://github.com/ClickHouse/ClickHouse/pull/79113)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* 为 Parquet 索引裁剪添加 `ProfileEvents` 指标 `ParquetReadRowGroups` 和 `ParquetPrunedRowGroups`。[#79180](https://github.com/ClickHouse/ClickHouse/pull/79180) ([flynn](https://github.com/ucasfl)).
* 在 Azure Blob 存储中，为普通磁盘在 `system.tables` 中上报的数据路径添加容器前缀，使上报结果与 S3 和 GCP 保持一致。[#79241](https://github.com/ClickHouse/ClickHouse/pull/79241) ([Julia Kartseva](https://github.com/jkartseva)).
* 支持在集群上修改数据库。 [#79242](https://github.com/ClickHouse/ClickHouse/pull/79242) ([Tuan Pham Anh](https://github.com/tuanpach))。
* 显式跳过为 `QueryMetricLog` 收集统计信息时错过的运行，否则日志需要很长时间才能追上当前时间。[#79257](https://github.com/ClickHouse/ClickHouse/pull/79257) ([Mikhail Artemenko](https://github.com/Michicosun))。
* 增加了按需即时应用轻量级删除的能力（通过设置 `lightweight_deletes_sync = 0`、`apply_mutations_on_fly = 1` 实现）。[#79281](https://github.com/ClickHouse/ClickHouse/pull/79281) ([Anton Popov](https://github.com/CurtizJ)).
* 针对所有行都应被删除的数据片，优化了 `ALTER ... DELETE` 变更操作。现在，在这种情况下会直接创建一个空数据片来替代原始数据片，而无需实际执行变更操作。 [#79307](https://github.com/ClickHouse/ClickHouse/pull/79307) ([Anton Popov](https://github.com/CurtizJ)).
* 对 `CHColumnToArrowColumn` 进行了若干小幅优化。[#79308](https://github.com/ClickHouse/ClickHouse/pull/79308)（[Bharat Nallan](https://github.com/bharatnc)）。
* 设置 `allow_archive_path_syntax` 被误标为实验性。添加了一个测试，以防止实验性设置在默认情况下被启用。[#79320](https://github.com/ClickHouse/ClickHouse/pull/79320)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 使页面缓存设置支持按查询级别进行调整。这样可以更快速地开展试验，并针对高吞吐和低延迟查询进行精细调优。[#79337](https://github.com/ClickHouse/ClickHouse/pull/79337) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 对于大多数看起来像 64 位哈希值的数字，不再以美观格式打印数字提示。修复了 [#79334](https://github.com/ClickHouse/ClickHouse/issues/79334)。[#79338](https://github.com/ClickHouse/ClickHouse/pull/79338)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 如果在终端中以 pretty 格式显示数据，且后续数据块具有相同的列宽，则可以通过将光标上移，从上一个数据块继续输出，并将其与上一个数据块拼接起来。此更改关闭了 [#79333](https://github.com/ClickHouse/ClickHouse/issues/79333)。该功能由新设置 `output_format_pretty_glue_chunks` 控制。[#79339](https://github.com/ClickHouse/ClickHouse/pull/79339)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 高级仪表板上图表的颜色将根据对应查询的哈希值计算生成。这样可以在滚动浏览仪表板时，更容易记住并找到某个图表。[#79341](https://github.com/ClickHouse/ClickHouse/pull/79341)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 添加异步指标 `FilesystemCacheCapacity` —— `cache` 虚拟文件系统的总容量。此指标对于全局基础设施监控很有用。[#79348](https://github.com/ClickHouse/ClickHouse/pull/79348)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 优化对 `system.parts` 的访问（仅在需要时读取列/索引大小）。 [#79352](https://github.com/ClickHouse/ClickHouse/pull/79352) ([Azat Khuzhin](https://github.com/azat)).
* 对查询 `'SHOW CLUSTER <name>'` 仅选择重要字段，而非所有字段。[#79368](https://github.com/ClickHouse/ClickHouse/pull/79368) ([Tuan Pham Anh](https://github.com/tuanpach))。
* 支持为 `DatabaseCatalog` 指定存储设置。 [#79407](https://github.com/ClickHouse/ClickHouse/pull/79407) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 在 delta 内核中支持本地存储。[#79416](https://github.com/ClickHouse/ClickHouse/pull/79416) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 添加一个查询级设置以启用 delta-kernel-rs：`allow_experimental_delta_kernel_rs`。[#79418](https://github.com/ClickHouse/ClickHouse/pull/79418)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* 修复从 Azure/S3 Blob 存储列出 Blob 时可能出现的无限循环问题。 [#79425](https://github.com/ClickHouse/ClickHouse/pull/79425) ([Alexander Gololobov](https://github.com/davenger)).
* 现在，ClickHouse 除了接受以 `param_<name>`（下划线）形式的查询参数外，也接受以 `param-<name>`（短横线）形式的查询参数。这解决了 [#63093](https://github.com/ClickHouse/ClickHouse/issues/63093)。 [#79429](https://github.com/ClickHouse/ClickHouse/pull/79429)（[Engel Danila](https://github.com/aaaengel)）。
  #* 新增文件系统缓存设置 `max_size_ratio_to_total_space`。 [#79460](https://github.com/ClickHouse/ClickHouse/pull/79460)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* 在启用校验和的情况下，从本地向远程 S3 复制数据时，带宽折扣相关的警告信息更加详细。 [#79464](https://github.com/ClickHouse/ClickHouse/pull/79464) ([VicoWu](https://github.com/VicoWu)).
* 为 `clickhouse-benchmark` 重新配置 `reconnect` 选项，使其可以根据需要取 0、1 或 N 作为重连的值。[#79465](https://github.com/ClickHouse/ClickHouse/pull/79465) ([Sachin Kumar Singh](https://github.com/sachinkumarsingh092))。
* 添加设置 `input_format_max_block_size_bytes`，用于按字节限制在输入格式中创建的数据块大小。这有助于在导入包含大体积数据的行时避免过高的内存占用。[#79495](https://github.com/ClickHouse/ClickHouse/pull/79495) ([Pavel Kruglov](https://github.com/Avogar))。
* 优化 sparseGrams 的速度和内存占用。 [#79517](https://github.com/ClickHouse/ClickHouse/pull/79517) ([Konstantin Vedernikov](https://github.com/scanhex12)).
* 在可能的情况下，避免在插入到 Compact 分片时对该数据块进行额外拷贝。[#79536](https://github.com/ClickHouse/ClickHouse/pull/79536) ([Pavel Kruglov](https://github.com/Avogar)).
* 默认启用 `DeltaLake` 存储的 delta-kernel 实现。[#79541](https://github.com/ClickHouse/ClickHouse/pull/79541) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 如果从 URL 读取时涉及多次重定向，所设置的 `enable_url_encoding` 会在整个重定向链中的所有重定向上正确生效。[#79563](https://github.com/ClickHouse/ClickHouse/pull/79563)（[Shankar Iyer](https://github.com/shankar-iyer)）。
* 允许对位于不同 plain&#95;rewritable 磁盘上的表使用 `ALTER TABLE ... MOVE|REPLACE PARTITION`。[#79566](https://github.com/ClickHouse/ClickHouse/pull/79566)（[Julia Kartseva](https://github.com/jkartseva)）。
* 在 `WHERE` 子句中支持标量关联子查询。修复 [#6697](https://github.com/ClickHouse/ClickHouse/issues/6697)。[#79600](https://github.com/ClickHouse/ClickHouse/pull/79600)（[Dmitry Novik](https://github.com/novikd)）。
* 之前当 `input_format_parquet_max_block_size = 0` 时，ClickHouse 会卡死。现在这一问题已被修复。此更改关闭了 [#79394](https://github.com/ClickHouse/ClickHouse/issues/79394)。[#79601](https://github.com/ClickHouse/ClickHouse/pull/79601)（[abashkeev](https://github.com/abashkeev)）。
* 为 `startup_scripts` 添加 `throw_on_error` 设置：当 `throw_on_error` 为 true 时，只有在所有查询都成功完成的情况下，服务器才会启动。默认情况下，`throw_on_error` 为 false，从而保留原有行为。[#79732](https://github.com/ClickHouse/ClickHouse/pull/79732)（[Aleksandr Musorin](https://github.com/AVMusorin)）。
* 如果参考向量的类型为 `Array(BFloat16)`，现在也会使用向量相似性索引。[#79745](https://github.com/ClickHouse/ClickHouse/pull/79745)（[Shankar Iyer](https://github.com/shankar-iyer)）。
* 将 `last_error_message`、`last_error_trace` 和 `query_id` 添加到 `system.error_log` 表。相关工单 [#75816](https://github.com/ClickHouse/ClickHouse/issues/75816)。[#79836](https://github.com/ClickHouse/ClickHouse/pull/79836)（[Andrei Tinikov](https://github.com/Dolso)）。
  #* 默认启用崩溃报告发送功能。可以在服务器的配置文件中将其关闭。[#79838](https://github.com/ClickHouse/ClickHouse/pull/79838)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 系统表 `system.functions` 现在会显示各个函数首次在 ClickHouse 中引入的版本。[#79839](https://github.com/ClickHouse/ClickHouse/pull/79839)（[Robert Schulze](https://github.com/rschu1ze)）。
* 新增了 `access_control_improvements.enable_user_name_access_type` 设置。该设置用于启用或禁用针对用户/角色的精确授权，此功能最初在 [https://github.com/ClickHouse/ClickHouse/pull/72246](https://github.com/ClickHouse/ClickHouse/pull/72246) 中引入。如果你的集群中存在版本低于 25.1 的副本，可能需要关闭此设置。[#79842](https://github.com/ClickHouse/ClickHouse/pull/79842)（[pufit](https://github.com/pufit)）。
* `ASTSelectWithUnionQuery::clone()` 方法的正确实现现在也会考虑 `is_normalized` 字段。这可能有助于 [#77569](https://github.com/ClickHouse/ClickHouse/issues/77569)。[#79909](https://github.com/ClickHouse/ClickHouse/pull/79909)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* 在简单场景下，在投影列表中支持关联子查询。[#79925](https://github.com/ClickHouse/ClickHouse/pull/79925)（[Dmitry Novik](https://github.com/novikd)）。
* 修复某些使用 `EXCEPT` 运算符的查询在格式化时表现不一致的问题。如果 `EXCEPT` 运算符左侧以 `*` 结尾，格式化后的查询会丢失括号，随后被解析为带有 `EXCEPT` 修饰符的 `*`。这些查询是由 fuzzer 找到的，在实际使用中不太可能遇到。本次修改关闭了 [#79950](https://github.com/ClickHouse/ClickHouse/issues/79950)。[#79952](https://github.com/ClickHouse/ClickHouse/pull/79952)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 允许在任意类型的 `http_handlers` 中添加 `http_response_headers`。 [#79975](https://github.com/ClickHouse/ClickHouse/pull/79975) ([Andrey Zvonov](https://github.com/zvonand))。
* 通过缓存变体的反序列化顺序，小幅改进了 `JSON` 类型的解析性能。 [#79984](https://github.com/ClickHouse/ClickHouse/pull/79984) ([Pavel Kruglov](https://github.com/Avogar)).
* 在适用时，允许将 `GLOBAL [NOT] IN` 谓词下推到 `PREWHERE` 子句。 [#79996](https://github.com/ClickHouse/ClickHouse/pull/79996) ([Eduard Karacharov](https://github.com/korowa)).
* 新增设置项 `s3_slow_all_threads_after_network_error`。 [#80035](https://github.com/ClickHouse/ClickHouse/pull/80035) ([Vitaly Baranov](https://github.com/vitlibar))。
* 关于所选要合并分片的日志级别设置不正确（Information）。修复了 [#80061](https://github.com/ClickHouse/ClickHouse/issues/80061)。[#80062](https://github.com/ClickHouse/ClickHouse/pull/80062)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `reverse` 函数现在支持 `Tuple` 数据类型。修复了 [#80053](https://github.com/ClickHouse/ClickHouse/issues/80053)。[#80083](https://github.com/ClickHouse/ClickHouse/pull/80083)（[flynn](https://github.com/ucasfl)）。
* `enble_url_encoding` 的默认值现在为 `False`。 [#80088](https://github.com/ClickHouse/ClickHouse/pull/80088) ([Shankar Iyer](https://github.com/shankar-iyer)).
* 这个小补丁解决了 [#75817](https://github.com/ClickHouse/ClickHouse/issues/75817)：现在可以从 `system.zookeeper` 表中获取 `auxiliary_zookeepers` 数据。[#80146](https://github.com/ClickHouse/ClickHouse/pull/80146)（[Nikolay Govorov](https://github.com/mrdimidium)）。
* 基于向量相似度索引的向量搜索现已进入 beta 阶段（此前为实验特性）。 [#80164](https://github.com/ClickHouse/ClickHouse/pull/80164) ([Robert Schulze](https://github.com/rschu1ze))。
* 添加关于服务器 TCP 套接字的异步指标，以提升可观测性。修复 [#80187](https://github.com/ClickHouse/ClickHouse/issues/80187)。[#80188](https://github.com/ClickHouse/ClickHouse/pull/80188)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 函数 `tokens` 现在支持将 `string` 用作分词器。 [#80195](https://github.com/ClickHouse/ClickHouse/pull/80195) ([Robert Schulze](https://github.com/rschu1ze)).
* Parallel replicas：如果所有读取任务都已分配给其他副本，则不再等待那些未被使用且较慢的副本。[#80199](https://github.com/ClickHouse/ClickHouse/pull/80199) ([Igor Nikonov](https://github.com/devcrafter))。
* 在 `simpleAggregateFunction` 中新增对 `anylast_respect_nulls` 和 `any_respect_nulls` 的支持。 [#80219](https://github.com/ClickHouse/ClickHouse/pull/80219) ([Diskein](https://github.com/Diskein)).
* 移除针对复制数据库中不必要的 `adjustCreateQueryForBackup()` 调用。[#80282](https://github.com/ClickHouse/ClickHouse/pull/80282) ([Vitaly Baranov](https://github.com/vitlibar)).
  #* 允许在 `clickhouse-local` 中使用额外选项（那些跟在 `--` 后面的，比如 `-- --config.value='abc'`）时省略等号。修复 [#80292](https://github.com/ClickHouse/ClickHouse/issues/80292)。[#80293](https://github.com/ClickHouse/ClickHouse/pull/80293) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 在 `SHOW ... LIKE` 查询中高亮显示元字符。修复了 [#80275](https://github.com/ClickHouse/ClickHouse/issues/80275)。[#80297](https://github.com/ClickHouse/ClickHouse/pull/80297)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
  #* 使 SQL UDF 在 `clickhouse-local` 中可持久化。之前创建的函数将在启动时加载。修复了 [#80085](https://github.com/ClickHouse/ClickHouse/issues/80085)。[#80300](https://github.com/ClickHouse/ClickHouse/pull/80300)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 支持 `Time` 与 `Time64` 之间的比较。 [#80327](https://github.com/ClickHouse/ClickHouse/pull/80327) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* 修正 `explain plan` 中关于预先去重（preliminary distinct）步骤的描述。 [#80330](https://github.com/ClickHouse/ClickHouse/pull/80330) ([UnamedRus](https://github.com/UnamedRus)).
* 允许在 ODBC/JDBC 中使用命名集合。 [#80334](https://github.com/ClickHouse/ClickHouse/pull/80334) ([Andrey Zvonov](https://github.com/zvonand)).
* 启用多投影过滤支持，允许在部件级过滤中使用多个投影。此更改解决了 [#55525](https://github.com/ClickHouse/ClickHouse/issues/55525)。这是继 [#78429](https://github.com/ClickHouse/ClickHouse/issues/78429) 之后，实现投影索引的第二步。[#80343](https://github.com/ClickHouse/ClickHouse/pull/80343)（[Amos Bird](https://github.com/amosbird)）。
* 用于统计只读和损坏磁盘数量的指标。在 `DiskLocalCheckThread` 启动时记录相关日志。[#80391](https://github.com/ClickHouse/ClickHouse/pull/80391) ([VicoWu](https://github.com/VicoWu))。
* 实现对带有投影的 `s3_plain_rewritable` 存储的支持。在之前的版本中，S3 中引用投影的元数据对象在被移动时不会更新。修复了 [#70258](https://github.com/ClickHouse/ClickHouse/issues/70258)。[#80393](https://github.com/ClickHouse/ClickHouse/pull/80393)（[Sav](https://github.com/sberss)）。
* 并行副本使用单独的连接超时时间，请参见 `parallel_replicas_connect_timeout_ms` 设置。在此之前，`connect_timeout_with_failover_ms`/`connect_timeout_with_failover_secure_ms` 设置被用作并行副本查询的连接超时时间（默认值为 1 秒）。[#80421](https://github.com/ClickHouse/ClickHouse/pull/80421) ([Igor Nikonov](https://github.com/devcrafter))。
* `SYSTEM UNFREEZE` 命令将不会尝试在只读和一次写入磁盘上查找数据分片。此更改解决了 [#80430](https://github.com/ClickHouse/ClickHouse/issues/80430)。[#80432](https://github.com/ClickHouse/ClickHouse/pull/80432)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 将已合并分片消息的日志级别从 INFO 调整为 TRACE。 [#80476](https://github.com/ClickHouse/ClickHouse/pull/80476) ([Hans Krutzer](https://github.com/hkrutzer)).
* 在 Native 格式中为 Dynamic 和 JSON 实现扁平化序列化，使其能够在不使用诸如 Dynamic 的 shared variant 和 JSON 的 shared data 等特殊结构的情况下对 Dynamic 和 JSON 数据进行序列化/反序列化。可以通过设置 `output_format_native_use_flattened_dynamic_and_json_serialization` 来启用这种序列化方式。该序列化方式可用于简化通过 TCP 协议在不同语言客户端中对 Dynamic 和 JSON 的支持。[#80499](https://github.com/ClickHouse/ClickHouse/pull/80499) ([Pavel Kruglov](https://github.com/Avogar)).
* 更改 Iceberg 表的分区剪枝默认行为。 [#80583](https://github.com/ClickHouse/ClickHouse/pull/80583) ([Melvyn Peignon](https://github.com/melvynator)).
* 为索引搜索算法的可观测性新增两个 ProfileEvents：`IndexBinarySearchAlgorithm` 和 `IndexGenericExclusionSearchAlgorithm`。[#80679](https://github.com/ClickHouse/ClickHouse/pull/80679)（[Pablo Marcos](https://github.com/pamarcos)）。
* 不再在日志中抱怨旧内核不支持的 `MADV_POPULATE_WRITE`（以避免日志污染）。[#80704](https://github.com/ClickHouse/ClickHouse/pull/80704) ([Robert Schulze](https://github.com/rschu1ze)).
* 在 TTL 中新增了对 Date32 和 DateTime64 的支持。[#80710](https://github.com/ClickHouse/ClickHouse/pull/80710)（[Andrey Zvonov](https://github.com/zvonand)）。
* 调整 `max_merge_delayed_streams_for_parallel_write` 的兼容性设置值。 [#80760](https://github.com/ClickHouse/ClickHouse/pull/80760) ([Azat Khuzhin](https://github.com/azat)).
* 修复一个崩溃问题：如果在析构函数中尝试删除临时文件（用于将临时数据溢写到磁盘）时抛出异常，程序可能会终止。[#80776](https://github.com/ClickHouse/ClickHouse/pull/80776) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 为 `SYSTEM SYNC REPLICA` 命令添加 `IF EXISTS` 修饰符。[#80810](https://github.com/ClickHouse/ClickHouse/pull/80810) ([Raúl Marín](https://github.com/Algunenano)).
* 扩展关于 “Having zero bytes, but read range is not finished...” 的异常消息，在 system.filesystem&#95;cache 中添加 finished&#95;download&#95;time 列。 [#80849](https://github.com/ClickHouse/ClickHouse/pull/80849) ([Kseniia Sumarokova](https://github.com/kssenii))。
* 此前，由于需要通过在磁盘上读取和写入（`.gin_sid`）文件以实时更新 segment id，`packed` 存储不支持全文索引。在使用 packed 存储时，不支持从未提交文件中读取值，这会导致问题。[#80852](https://github.com/ClickHouse/ClickHouse/pull/80852)（[Elmi Ahmadov](https://github.com/ahmadov)）。
* 在将 `EXPLAIN` 与 `indexes = 1` 一起使用时，在其输出中新增一个搜索算法部分。该部分会显示 “binary search” 或 “generic exclusion search” 之一。[#80881](https://github.com/ClickHouse/ClickHouse/pull/80881) ([Pablo Marcos](https://github.com/pamarcos))。
* 在 2024 年初，由于新的 analyzer 默认未启用，`prefer_column_name_to_alias` 在 MySQL handler 中被硬编码为 True。现在，这一设置已不再硬编码。[#80916](https://github.com/ClickHouse/ClickHouse/pull/80916)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* 现在，`system.iceberg_history` 会显示 Glue 或 Iceberg REST 等目录（catalog）数据库的历史记录。同时，为了保持一致性，将 `system.iceberg_history` 中的 `table_name` 和 `database_name` 列分别重命名为 `table` 和 `database`。 [#80975](https://github.com/ClickHouse/ClickHouse/pull/80975) ([alesapin](https://github.com/alesapin))。
* 允许 `merge` 表函数以只读模式工作，因此在使用它时不再需要 `CREATE TEMPORARY TABLE` 授权。 [#80981](https://github.com/ClickHouse/ClickHouse/pull/80981) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* 更完善的内存缓存自省功能（在 `system.metrics` 中暴露缓存信息，以补充不完整的 `system.asynchronouse_metrics`）。在 `dashboard.html` 中新增以内存缓存字节数为单位的展示。`VectorSimilarityIndexCacheSize`/`IcebergMetadataFilesCacheSize` 已重命名为 `VectorSimilarityIndexCacheBytes`/`IcebergMetadataFilesCacheBytes`。[#81023](https://github.com/ClickHouse/ClickHouse/pull/81023) ([Azat Khuzhin](https://github.com/azat)).
* 从 `system.rocksdb` 读取时，忽略使用无法承载 RocksDB 表的引擎的数据库。 [#81083](https://github.com/ClickHouse/ClickHouse/pull/81083) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* 允许在 `clickhouse-local` 配置文件中启用 `filesystem_caches` 和 `named_collections`。 [#81105](https://github.com/ClickHouse/ClickHouse/pull/81105) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 修复 `INSERT` 查询中 `PARTITION BY` 的高亮显示。在之前的版本中，`PARTITION BY` 不会被高亮为关键字。[#81106](https://github.com/ClickHouse/ClickHouse/pull/81106) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* Web UI 中的两个小改进：正确处理没有输出的查询，例如 `CREATE`、`INSERT`（直到最近，这类查询会导致加载指示器一直转圈）；双击表时，自动滚动到顶部。[#81131](https://github.com/ClickHouse/ClickHouse/pull/81131) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* 将 `c-ares` 更新到 `v1.34.5`。[#81159](https://github.com/ClickHouse/ClickHouse/pull/81159) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* 将 curl 升级到 8.14，以修复 CVE-2025-5025 和 CVE-2025-4947。[#81171](https://github.com/ClickHouse/ClickHouse/pull/81171) ([larryluogit](https://github.com/larryluogit)).
  #* 将 libarchive 升级到 3.7.9，以修复以下问题：CVE-2024-20696 CVE-2025-25724 CVE-2024-48958 CVE-2024-57970 CVE-2025-1632 CVE-2024-48957 CVE-2024-48615。[#81174](https://github.com/ClickHouse/ClickHouse/pull/81174) ([larryluogit](https://github.com/larryluogit)).
  #* 将 libxml2 升级到 2.14.3。[#81187](https://github.com/ClickHouse/ClickHouse/pull/81187) ([larryluogit](https://github.com/larryluogit)).
* `MemoryResidentWithoutPageCache` 表示服务器进程使用的物理内存大小（以字节为单位），不包括用户态页缓存。启用用户态页缓存时，该指标能更准确地反映实际内存使用情况；禁用用户态页缓存时，该值等于 `MemoryResident`。[#81233](https://github.com/ClickHouse/ClickHouse/pull/81233) ([Jayme Bird](https://github.com/jaymebrd))。
* 在客户端、本地服务器、Keeper 客户端和 disks 应用中，将手动记录的异常标记为已记录，以避免重复写入日志。[#81271](https://github.com/ClickHouse/ClickHouse/pull/81271) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* 将 `use_skip_indexes_if_final` 和 `use_skip_indexes_if_final_exact_mode` 的默认值改为 `True`。带有 `FINAL` 子句的查询现在将使用跳过索引（如果适用）来初步筛选数据颗粒，并且还会读取与匹配主键范围对应的任何额外颗粒。需要沿用此前近似/不精确结果行为的用户，可以在经过仔细评估后将 `use_skip_indexes_if_final_exact_mode` 设置为 `False`。[#81331](https://github.com/ClickHouse/ClickHouse/pull/81331)（[Shankar Iyer](https://github.com/shankar-iyer)）。
  #* 当在 Web UI 中存在多个查询时，将运行光标所在的那个查询。延续 [#80977](https://github.com/ClickHouse/ClickHouse/issues/80977) 的工作。[#81354](https://github.com/ClickHouse/ClickHouse/pull/81354)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 此 PR 解决了在转换函数单调性检查中 `is_strict` 实现相关的问题。目前，一些转换函数（例如 toFloat64(UInt32) 和 toDate(UInt8)）在应返回 true 时错误地返回 is&#95;strict 为 false。[#81359](https://github.com/ClickHouse/ClickHouse/pull/81359) ([zoomxi](https://github.com/zoomxi))。
  #* 在带有日志的文件系统中，`mkdir` 会被写入文件系统的日志中，并持久化到磁盘。在磁盘较慢的情况下，这可能会耗费较长时间。将其移出预留锁作用域是完全有必要的。[#81371](https://github.com/ClickHouse/ClickHouse/pull/81371) ([Kseniia Sumarokova](https://github.com/kssenii))。
* 在检查 `KeyCondition` 是否匹配一个连续范围时，如果键被非严格函数链包装，可能需要将 `Constraint::POINT` 转换为 `Constraint::RANGE`。例如：`toDate(event_time) = '2025-06-03'` 蕴含了 `event_time` 的一个范围：[&#39;2025-06-03 00:00:00&#39;, &#39;2025-06-04 00:00:00&#39;)。此 PR 修复了这一行为。[#81400](https://github.com/ClickHouse/ClickHouse/pull/81400) ([zoomxi](https://github.com/zoomxi)).
  #* 使用 `postgres` 16.9。[#81437](https://github.com/ClickHouse/ClickHouse/pull/81437) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* 使用 `openssl` 3.2.4。[#81438](https://github.com/ClickHouse/ClickHouse/pull/81438) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* 使用 `abseil-cpp` 2025-01-27。[#81440](https://github.com/ClickHouse/ClickHouse/pull/81440) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* 使用 `mongo-c-driver` 1.30.4。[#81449](https://github.com/ClickHouse/ClickHouse/pull/81449) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* 使用 `krb5` 1.21.3-final。[#81453](https://github.com/ClickHouse/ClickHouse/pull/81453) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* 使用 `orc` 2.1.2。[#81455](https://github.com/ClickHouse/ClickHouse/pull/81455) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* 在 `clickhouse-local` 中增加对 `--database` 参数的支持。现在可以切换到之前创建的数据库。修复了 [#44115](https://github.com/ClickHouse/ClickHouse/issues/44115)。[#81465](https://github.com/ClickHouse/ClickHouse/pull/81465) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* 当指定 `--host` 或 `--port` 时，`clickhouse`/`ch` 别名将调用 `clickhouse-client` 而不是 `clickhouse-local`。是对 [#79422](https://github.com/ClickHouse/ClickHouse/issues/79422) 的延续，并修复了 [#65252](https://github.com/ClickHouse/ClickHouse/issues/65252)。[#81509](https://github.com/ClickHouse/ClickHouse/pull/81509) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 现在我们已经获得了 keeper 响应时间分布数据，就可以调整直方图的分桶了。[#81516](https://github.com/ClickHouse/ClickHouse/pull/81516) ([Miсhael Stetsyuk](https://github.com/mstetsyuk))。
* 将 Iceberg manifest 文件的读取延迟到查询首次读取时再进行。 [#81619](https://github.com/ClickHouse/ClickHouse/pull/81619) ([Daniil Ivanik](https://github.com/divanik)).
  #* 使用 `grpc` 1.73.0。 [#81629](https://github.com/ClickHouse/ClickHouse/pull/81629) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* 使用 `delta-kernel-rs` v0.12.1。 [#81707](https://github.com/ClickHouse/ClickHouse/pull/81707) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* 添加 `PageCacheReadBytes` 配置文件事件。 [#81742](https://github.com/ClickHouse/ClickHouse/pull/81742) ([Kseniia Sumarokova](https://github.com/kssenii))。





## Bug fix (官方稳定版本中用户可见的错误行为) {#bug-fix-user-visible-misbehavior-in-an-official-stable-release}


* 修复使用 `SELECT EXCEPT` 查询的参数化视图。修复 [#49447](https://github.com/ClickHouse/ClickHouse/issues/49447)。[#57380](https://github.com/ClickHouse/ClickHouse/pull/57380)（[Nikolay Degterinsky](https://github.com/evillique)）。
* Analyzer：修复在 `join` 中对列类型进行提升后列投影名称不正确的问题。修复 [#63345](https://github.com/ClickHouse/ClickHouse/issues/63345)。[#63519](https://github.com/ClickHouse/ClickHouse/pull/63519)（[Dmitry Novik](https://github.com/novikd)）。
* 物化视图可能会启动得太晚，例如在向其进行数据流式写入的 Kafka 表启动之后才开始工作。[#72123](https://github.com/ClickHouse/ClickHouse/pull/72123)（[Ilya Golshtein](https://github.com/ilejn)）。
* 修复了在启用 analyzer&#95;compatibility&#95;join&#95;using&#95;top&#95;level&#95;identifier 时，列名发生冲突情况下的逻辑错误。 [#75676](https://github.com/ClickHouse/ClickHouse/pull/75676) ([Vladimir Cherkasov](https://github.com/vdimir)).
* 修复了在多次异步（`alter_sync = 0`）执行 `RENAME COLUMN` 和 `ADD COLUMN` 查询后，从 `MergeTree` 表读取数据时偶发的崩溃问题。 [#76346](https://github.com/ClickHouse/ClickHouse/pull/76346) ([Anton Popov](https://github.com/CurtizJ))。
* 修复在启用 analyzer 时创建 `VIEW` 期间对 `SELECT` 查询的重写。修复 [#75956](https://github.com/ClickHouse/ClickHouse/issues/75956)。[#76356](https://github.com/ClickHouse/ClickHouse/pull/76356)（[Dmitry Novik](https://github.com/novikd)）。
* 在启用 `allow_push_predicate_ast_for_distributed_subqueries` 时，修正下推谓词中 CTE 的使用。修复 [#75647](https://github.com/ClickHouse/ClickHouse/issues/75647)。修复 [#79672](https://github.com/ClickHouse/ClickHouse/issues/79672)。[#77316](https://github.com/ClickHouse/ClickHouse/pull/77316)（[Dmitry Novik](https://github.com/novikd)）。
* 修复从服务器端应用 `async_insert`（通过 `apply_settings_from_server`）的问题，该问题此前会导致客户端出现 `Unknown packet 11 from server` 错误。[#77578](https://github.com/ClickHouse/ClickHouse/pull/77578) ([Azat Khuzhin](https://github.com/azat))。
* 修复了在复制数据库中新添加副本上无法正常工作的可刷新物化视图问题。 [#77774](https://github.com/ClickHouse/ClickHouse/pull/77774) ([Michael Kolupaev](https://github.com/al13n321)).
* 修复了可刷新 `MATERIALIZED VIEW` 导致备份损坏的问题。 [#77893](https://github.com/ClickHouse/ClickHouse/pull/77893) ([Michael Kolupaev](https://github.com/al13n321)).
* 修复 `transform` 的旧逻辑触发错误。 [#78247](https://github.com/ClickHouse/ClickHouse/pull/78247) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* 修复了一个问题：即使指定的副本不存在，`SYSTEM SYNC REPLICA LIGHTWEIGHT 'foo'` 也会报告成功。现在，该命令会在尝试同步之前，先在 Keeper 中正确验证副本是否存在。[#78405](https://github.com/ClickHouse/ClickHouse/pull/78405) ([Jayme Bird](https://github.com/jaymebrd))。
* 修复了在某些情况下使用 analyzer 时未能应用二级索引的问题。修复了 [#65607](https://github.com/ClickHouse/ClickHouse/issues/65607)、[#69373](https://github.com/ClickHouse/ClickHouse/issues/69373)。[#78485](https://github.com/ClickHouse/ClickHouse/pull/78485)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* 修复在启用压缩的 HTTP 协议下转储 profile 事件（`NetworkSendElapsedMicroseconds`/`NetworkSendBytes`）的问题（误差不应大于缓冲区大小，通常约为 1MiB）。[#78516](https://github.com/ClickHouse/ClickHouse/pull/78516) ([Azat Khuzhin](https://github.com/azat)).
  #* ```sql CREATE TABLE t0 ( key Int32, value Int32 ) ENGINE=MergeTree() PRIMARY KEY key PARTITION BY key % 2;. [#78593](https://github.com/ClickHouse/ClickHouse/pull/78593) ([Vlad](https://github.com/codeworse)).
* 修复在 `JOIN ... USING` 涉及 `ALIAS` 列时分析器抛出 `LOGICAL_ERROR` 的问题——现在会返回更合适的错误信息。[#78618](https://github.com/ClickHouse/ClickHouse/pull/78618) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* 修复 analyzer：当 `SELECT` 包含位置参数时，`CREATE VIEW ... ON CLUSTER` 会执行失败。 [#78663](https://github.com/ClickHouse/ClickHouse/pull/78663) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* 修复在向带有模式推断的表函数执行 `INSERT SELECT` 且 `SELECT` 中包含标量子查询时出现的 `Block structure mismatch` 错误。[#78677](https://github.com/ClickHouse/ClickHouse/pull/78677) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* 修复 analyzer：在 SELECT 查询中对 Distributed 表使用 `prefer_global_in_and_join=1` 时，应将 `in` 函数替换为 `globalIn`。 [#78749](https://github.com/ClickHouse/ClickHouse/pull/78749) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* 修复了多种类型的 `SELECT` 查询，这些查询从使用 `MongoDB` 引擎的表或 `mongodb` 表函数中读取数据：在 `WHERE` 子句中对常量值进行隐式转换的查询（例如 `WHERE datetime = '2025-03-10 00:00:00'`），以及带有 `LIMIT` 和 `GROUP BY` 的查询。此前，它们可能会返回错误结果。[#78777](https://github.com/ClickHouse/ClickHouse/pull/78777)（[Anton Popov](https://github.com/CurtizJ)）。
* 修复不同 JSON 类型之间的转换。现在通过先转换为 / 从 String 的简单类型转换来完成。此方式效率较低，但可以保证 100% 的准确性。[#78807](https://github.com/ClickHouse/ClickHouse/pull/78807)（[Pavel Kruglov](https://github.com/Avogar)）。
* 修复将 `Dynamic` 类型转换为 `Interval` 时的逻辑错误。 [#78813](https://github.com/ClickHouse/ClickHouse/pull/78813) ([Pavel Kruglov](https://github.com/Avogar))。
* 修复在解析 `JSON` 出错时的列回滚问题。 [#78836](https://github.com/ClickHouse/ClickHouse/pull/78836) ([Pavel Kruglov](https://github.com/Avogar)).
* 修复在使用常量别名列进行 `JOIN` 时出现的 “bad cast” 错误。[#78848](https://github.com/ClickHouse/ClickHouse/pull/78848) ([Vladimir Cherkasov](https://github.com/vdimir))。
* 禁止在物化视图中对视图与目标表列类型不一致的列使用 `PREWHERE`。 [#78889](https://github.com/ClickHouse/ClickHouse/pull/78889) ([Pavel Kruglov](https://github.com/Avogar)).
* 修复在解析 `Variant` 列异常二进制数据时的逻辑错误。 [#78982](https://github.com/ClickHouse/ClickHouse/pull/78982) ([Pavel Kruglov](https://github.com/Avogar)).
* 当 Parquet 批大小被设置为 0 时抛出异常。此前当 `output_format_parquet_batch_size = 0` 时，ClickHouse 会出现卡死。现在这一问题已被修复。[#78991](https://github.com/ClickHouse/ClickHouse/pull/78991) ([daryawessely](https://github.com/daryawessely))。
* 修复紧凑部件中使用 basic 格式时 variant 判别器的反序列化问题。该问题是在 [https://github.com/ClickHouse/ClickHouse/pull/55518](https://github.com/ClickHouse/ClickHouse/pull/55518) 中引入的。[#79000](https://github.com/ClickHouse/ClickHouse/pull/79000)（[Pavel Kruglov](https://github.com/Avogar)）。
* `complex_key_ssd_cache` 类型的字典现在会拒绝 `block_size` 和 `write_buffer_size` 参数为零或负数的配置（issue [#78314](https://github.com/ClickHouse/ClickHouse/issues/78314)）。[#79028](https://github.com/ClickHouse/ClickHouse/pull/79028)（[Elmi Ahmadov](https://github.com/ahmadov)）。
* 避免在 SummingMergeTree 中对非聚合列使用 Field。这样做可能会在 SummingMergeTree 中使用 Dynamic/Variant 类型时导致意外错误。[#79051](https://github.com/ClickHouse/ClickHouse/pull/79051)（[Pavel Kruglov](https://github.com/Avogar)）。
* 修复 analyzer 中从指向分布式目标表且表头不同的物化视图读取数据的问题。 [#79059](https://github.com/ClickHouse/ClickHouse/pull/79059) ([Pavel Kruglov](https://github.com/Avogar)).
* 修复了一个在非常特定场景下出现的崩溃问题：当在 `ON CLUSTER` 查询的 `CONSTRAINT` 部分中使用 `currentDatabase` 函数时会导致崩溃。修复了 [#78100](https://github.com/ClickHouse/ClickHouse/issues/78100)。[#79070](https://github.com/ClickHouse/ClickHouse/pull/79070)（[pufit](https://github.com/pufit)）。
* 修复了一个错误：在对表进行批量插入时，`arrayUnion()` 会返回多余（错误）的值。修复了 [#75057](https://github.com/ClickHouse/ClickHouse/issues/75057)。[#79079](https://github.com/ClickHouse/ClickHouse/pull/79079)（[Peter Nguyen](https://github.com/petern48)）。
  #* 修复 `OpenSSLInitializer` 中的段错误。关闭了 [#79092](https://github.com/ClickHouse/ClickHouse/issues/79092)。[#79097](https://github.com/ClickHouse/ClickHouse/pull/79097)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* 修复在服务器间查询中传递外部角色的方式。 [#79099](https://github.com/ClickHouse/ClickHouse/pull/79099) ([Andrey Zvonov](https://github.com/zvonand)).
* 始终为 S3 的 ListObject 操作设置前缀。 [#79114](https://github.com/ClickHouse/ClickHouse/pull/79114) ([Azat Khuzhin](https://github.com/azat)).
* 修复了一个错误：在对包含批量插入的表进行查询时，`arrayUnion()` 会返回多余（错误）的值。修复 [#79157](https://github.com/ClickHouse/ClickHouse/issues/79157)。[#79158](https://github.com/ClickHouse/ClickHouse/pull/79158)（[Peter Nguyen](https://github.com/petern48)）。
* 修复下推过滤条件后的逻辑错误。 [#79164](https://github.com/ClickHouse/ClickHouse/pull/79164) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* 尝试在 SingleValueDataGeneric 中使用 IColumn 代替 Field。这样可以修复某些聚合函数（例如针对 `Dynamic/Variant/JSON` 类型的 `argMax`）返回值不正确的问题。[#79166](https://github.com/ClickHouse/ClickHouse/pull/79166)（[Pavel Kruglov](https://github.com/Avogar)）。
* 修复在通过基于 HTTP 的端点使用 delta-kernel 实现时的 DeltaLake 表引擎问题，并修复 `NOSIGN`。关闭 [#78124](https://github.com/ClickHouse/ClickHouse/issues/78124)。[#79203](https://github.com/ClickHouse/ClickHouse/pull/79203)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* Keeper 修复：避免在失败的 multi 请求上触发 watch 事件。[#79247](https://github.com/ClickHouse/ClickHouse/pull/79247) ([Antonio Andelic](https://github.com/antonio2368))。
* 在 `IN` 中禁止使用 Dynamic 和 JSON 类型。由于当前对 `IN` 的实现，这可能会导致结果不正确。为 `IN` 提供对这些类型的完整支持比较复杂，可能会在未来实现。 [#79282](https://github.com/ClickHouse/ClickHouse/pull/79282) ([Pavel Kruglov](https://github.com/Avogar)).
* 修复在解析 `JSON` 类型时对重复路径的校验。[#79317](https://github.com/ClickHouse/ClickHouse/pull/79317) ([Pavel Kruglov](https://github.com/Avogar)).
* 修复 `SecureStreamSocket` 连接问题。[#79383](https://github.com/ClickHouse/ClickHouse/pull/79383)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* 修复包含数据的 plain&#95;rewritable 磁盘的加载。 [#79439](https://github.com/ClickHouse/ClickHouse/pull/79439) ([Julia Kartseva](https://github.com/jkartseva)).
* 修复在 MergeTree 的 Wide 部分中进行动态子列发现时的崩溃问题。 [#79466](https://github.com/ClickHouse/ClickHouse/pull/79466) ([Pavel Kruglov](https://github.com/Avogar))。
* 仅在最初的创建查询中验证表名长度。不要在后续创建时进行此验证，以避免破坏向后兼容性。 [#79488](https://github.com/ClickHouse/ClickHouse/pull/79488) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* 在多种包含稀疏列的表的场景下，修复了 `Block structure mismatch` 错误。[#79491](https://github.com/ClickHouse/ClickHouse/pull/79491) ([Anton Popov](https://github.com/CurtizJ))。
* 修复了两种会触发 `Logical Error: Can't set alias of * of Asterisk on alias` 的情况。[#79505](https://github.com/ClickHouse/ClickHouse/pull/79505)（[Raúl Marín](https://github.com/Algunenano)）。
* 修复了在 Azure Blob Storage 上应用 `use_native_copy` 和 `allow_azure_native_copy` 设置的问题，并更新为仅在凭据匹配时才使用原生复制，从而解决了 [#78964](https://github.com/ClickHouse/ClickHouse/issues/78964)。[#79561](https://github.com/ClickHouse/ClickHouse/pull/79561)（[Smita Kulkarni](https://github.com/SmitaRKulkarni)）。
* 修复在重命名 Atomic 数据库时使用错误路径的问题。[#79569](https://github.com/ClickHouse/ClickHouse/pull/79569) ([Tuan Pham Anh](https://github.com/tuanpach))。
* 修复按 JSON 列与其他列组合排序时的问题。[#79591](https://github.com/ClickHouse/ClickHouse/pull/79591) ([Pavel Kruglov](https://github.com/Avogar))。
* 在同时禁用 `use_hedged_requests` 和 `allow_experimental_parallel_reading_from_replicas` 时，修复从远程读取数据时结果重复的问题。[#79599](https://github.com/ClickHouse/ClickHouse/pull/79599) ([Eduard Karacharov](https://github.com/korowa)).
* 修复在使用 Unity Catalog 时 `delta-kernel` 实现中的崩溃问题。 [#79677](https://github.com/ClickHouse/ClickHouse/pull/79677) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 解析 autodiscovery 集群的宏。 [#79696](https://github.com/ClickHouse/ClickHouse/pull/79696) ([Anton Ivashkin](https://github.com/ianton-ru)).
* 修复在检查列是否为相关列时，由于该列来源作用域未知而导致的逻辑错误。修复 [#78183](https://github.com/ClickHouse/ClickHouse/issues/78183)。修复 [#79451](https://github.com/ClickHouse/ClickHouse/issues/79451)。[#79727](https://github.com/ClickHouse/ClickHouse/pull/79727)（[Dmitry Novik](https://github.com/novikd)）。
* 修复在使用 ColumnConst 和 Analyzer 时 `GROUPING SETS` 返回错误结果的问题。[#79743](https://github.com/ClickHouse/ClickHouse/pull/79743) ([Andrey Zvonov](https://github.com/zvonand))。
* 修复在从分布式表读取且本地副本已过期时，本地分片结果会重复的问题。[#79761](https://github.com/ClickHouse/ClickHouse/pull/79761) ([Eduard Karacharov](https://github.com/korowa)).
* 对配置错误的 `page_cache_limits` 进行合理处理。 [#79805](https://github.com/ClickHouse/ClickHouse/pull/79805) ([Bharat Nallan](https://github.com/bharatnc)).
* 修复了当可变长度格式化符（例如 `%W`，表示星期几，如 `Monday`、`Tuesday` 等）后紧跟复合格式化符（一次输出多个日期时间组件的格式化符，例如 `%D`，表示美国日期格式 `05/04/25`）时，SQL 函数 `formatDateTime` 的结果。[#79835](https://github.com/ClickHouse/ClickHouse/pull/79835)（[Robert Schulze](https://github.com/rschu1ze)）。
* IcebergS3 支持 `count` 优化，但 IcebergS3Cluster 不支持。因此，在集群模式下返回的 `count()` 结果可能会是副本数量的整数倍。[#79844](https://github.com/ClickHouse/ClickHouse/pull/79844)（[wxybear](https://github.com/wxybear)）。
* 修复带负号位的 `NaN` 值的排序次序。[#79847](https://github.com/ClickHouse/ClickHouse/pull/79847) ([Pervakov Grigorii](https://github.com/GrigoryPervakov))。
* 现在 `GROUP BY ALL` 不再考虑 `GROUPING` 子句。[#79915](https://github.com/ClickHouse/ClickHouse/pull/79915) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。
* 修复了在延迟物化中，当在投影之前的查询执行阶段未使用任何列时触发的 `AMBIGUOUS_COLUMN_NAME` 错误。例如：SELECT * FROM t ORDER BY rand() LIMIT 5。[#79926](https://github.com/ClickHouse/ClickHouse/pull/79926)（[Igor Nikonov](https://github.com/devcrafter)）。
* 修复了 `TopK` / `TopKWeighted` 函数在状态合并时的错误，该错误会在容量尚未用尽时仍导致过大的误差值。[#79939](https://github.com/ClickHouse/ClickHouse/pull/79939) ([Joel Höner](https://github.com/athre0z)).
* 对查询 `CREATE DATABASE datalake ENGINE = DataLakeCatalog(\'http://catalog:8181\', \'admin\', \'password\')` 中的密码进行隐藏。[#79941](https://github.com/ClickHouse/ClickHouse/pull/79941) ([Han Fei](https://github.com/hanfei1991))。
* 允许在 `JOIN USING` 中指定别名。如果列被重命名（例如由于 `ARRAY JOIN`），可以通过指定该别名来引用它。修复 [#73707](https://github.com/ClickHouse/ClickHouse/issues/73707)。[#79942](https://github.com/ClickHouse/ClickHouse/pull/79942)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* 在 `azure_blob_storage` 对象存储中遵循 `readonly` 设置。[#79954](https://github.com/ClickHouse/ClickHouse/pull/79954) ([Julia Kartseva](https://github.com/jkartseva)).
* 修复了在使用包含反斜杠转义字符的 `match(column, '^…')` 时出现的查询结果错误和内存不足崩溃问题。 [#79969](https://github.com/ClickHouse/ClickHouse/pull/79969) ([filimonov](https://github.com/filimonov)).
* 为数据湖禁用 Hive 分区，部分解决了 [https://github.com/issues/assigned?issue=ClickHouse%7CClickHouse%7C79937](https://github.com/issues/assigned?issue=ClickHouse%7CClickHouse%7C79937)。[#80005](https://github.com/ClickHouse/ClickHouse/pull/80005)（[Daniil Ivanik](https://github.com/divanik)）。
* 修复了无法应用带有 lambda 表达式的 skip 索引的问题，当索引定义中的高层函数与查询中的完全一致时，现在可以正确生效。 [#80025](https://github.com/ClickHouse/ClickHouse/pull/80025) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* 修复带有 `UNION` 的物化视图在新副本上无法正常工作的问题。 [#80037](https://github.com/ClickHouse/ClickHouse/pull/80037) ([Samay Sharma](https://github.com/samay-sharma)).
* 修复在副本上按复制日志执行 `ATTACH_PART` 命令时附加数据块时的元数据版本。 [#80038](https://github.com/ClickHouse/ClickHouse/pull/80038) ([Aleksei Filatov](https://github.com/aalexfvk)).
* SQL 函数 `parseDateTime` 中的格式说明符 `%e` 现在可以识别一位数的日期（例如 `3`），而之前要求使用空格填充（例如 ` 3`）。这使其行为与 MySQL 兼容。若要保留之前的行为，请将设置项 `parsedatetime_e_requires_space_padding` 设为 `1`。（issue [#78243](https://github.com/ClickHouse/ClickHouse/issues/78243)）。[#80057](https://github.com/ClickHouse/ClickHouse/pull/80057)（[Robert Schulze](https://github.com/rschu1ze)）。
* 可执行用户定义函数（Executable User Defined Functions，eUDF）的名称不会像其他函数那样被添加到 `system.query_log` 表的 `used_functions` 列中。此 PR 在请求中使用了 eUDF 时，将其名称添加到该列中。[#80073](https://github.com/ClickHouse/ClickHouse/pull/80073) ([Kyamran](https://github.com/nibblerenush))。
  #* 修复 ClickHouse 日志中的告警 `Cannot find 'kernel' in '[...]/memory.stat'`（问题 [#77410](https://github.com/ClickHouse/ClickHouse/issues/77410)）。[#80129](https://github.com/ClickHouse/ClickHouse/pull/80129) ([Robert Schulze](https://github.com/rschu1ze))。
* 修复 Arrow 格式在处理 LowCardinality(FixedString) 时的逻辑错误。 [#80156](https://github.com/ClickHouse/ClickHouse/pull/80156) ([Pavel Kruglov](https://github.com/Avogar)).
* 修复从 `Merge` 引擎读取子列时的问题。 [#80158](https://github.com/ClickHouse/ClickHouse/pull/80158) ([Pavel Kruglov](https://github.com/Avogar)).
* 修复 `KeyCondition` 中数值类型比较的一个错误。[#80207](https://github.com/ClickHouse/ClickHouse/pull/80207)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* 修复在对带有投影的表应用惰性物化时出现的 `AMBIGUOUS_COLUMN_NAME` 错误。 [#80251](https://github.com/ClickHouse/ClickHouse/pull/80251) ([Igor Nikonov](https://github.com/devcrafter)).
* 修复在使用隐式投影时，对类似 LIKE &#39;ab&#95;c%&#39; 这样的字符串前缀过滤条件进行计数时的错误优化。此修复解决了 [#80250](https://github.com/ClickHouse/ClickHouse/issues/80250)。[#80261](https://github.com/ClickHouse/ClickHouse/pull/80261)（[Amos Bird](https://github.com/amosbird)）。
* 修复在 MongoDB 文档中将嵌套数值字段错误序列化为字符串的问题。移除从 MongoDB 读取文档时的最大深度限制。[#80289](https://github.com/ClickHouse/ClickHouse/pull/80289) ([Kirill Nikiforov](https://github.com/allmazz))。
* 对 `Replicated` 数据库中的 RMT 执行不那么严格的元数据检查。修复 [#80296](https://github.com/ClickHouse/ClickHouse/issues/80296)。[#80298](https://github.com/ClickHouse/ClickHouse/pull/80298)（[Nikolay Degterinsky](https://github.com/evillique)）。
* 修复 PostgreSQL 存储中 `DateTime` 和 `DateTime64` 的文本表示形式。[#80301](https://github.com/ClickHouse/ClickHouse/pull/80301)（[Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)）。
* 在 `StripeLog` 表中允许使用带时区的 `DateTime`。此更改关闭了 [#44120](https://github.com/ClickHouse/ClickHouse/issues/44120)。[#80304](https://github.com/ClickHouse/ClickHouse/pull/80304)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 在查询计划的某个步骤会改变行数的情况下，对包含非确定性函数的谓词禁用 filter-push-down。修复了 [#40273](https://github.com/ClickHouse/ClickHouse/issues/40273)。[#80329](https://github.com/ClickHouse/ClickHouse/pull/80329)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* 修复在包含子列的投影中可能出现的逻辑错误和崩溃问题。 [#80333](https://github.com/ClickHouse/ClickHouse/pull/80333) ([Pavel Kruglov](https://github.com/Avogar)).
* 修复在 `ON` 表达式不是简单相等条件时，由逻辑 JOIN 分隔符的 filter-push-down 优化导致的 `NOT_FOUND_COLUMN_IN_BLOCK` 错误。修复 [#79647](https://github.com/ClickHouse/ClickHouse/issues/79647) 和 [#77848](https://github.com/ClickHouse/ClickHouse/issues/77848)。[#80360](https://github.com/ClickHouse/ClickHouse/pull/80360)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* 修复在分区表中按反向顺序读取键时产生错误结果的问题。此修复对应 [#79987](https://github.com/ClickHouse/ClickHouse/issues/79987)。[#80448](https://github.com/ClickHouse/ClickHouse/pull/80448)（[Amos Bird](https://github.com/amosbird)）。
* 修复了在具有可为 NULL 的键且启用了 optimize&#95;read&#95;in&#95;order 的表中出现的错误排序问题。 [#80515](https://github.com/ClickHouse/ClickHouse/pull/80515) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* 修复了在使用 SYSTEM STOP REPLICATED VIEW 暂停视图后，`refreshable materialized view` 的 DROP 操作会陷入卡顿的问题。 [#80543](https://github.com/ClickHouse/ClickHouse/pull/80543) ([Michael Kolupaev](https://github.com/al13n321)).
* 修复在分布式查询中使用常量 `tuple` 时出现的“Cannot find column”错误。[#80596](https://github.com/ClickHouse/ClickHouse/pull/80596)（[Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)）。
* 修复在分布式表中配合 `join_use_nulls` 使用时的 `shardNum` 函数。[#80612](https://github.com/ClickHouse/ClickHouse/pull/80612) ([János Benjamin Antal](https://github.com/antaljanosbenjamin))。
* 修复在 `Merge` 引擎中读取仅存在于部分表中的列时产生的不正确结果问题。 [#80643](https://github.com/ClickHouse/ClickHouse/pull/80643) ([Pavel Kruglov](https://github.com/Avogar)).
* `iceberg_history` 表中的时间戳现在应该是正确的。[#80711](https://github.com/ClickHouse/ClickHouse/pull/80711)（[Melvyn Peignon](https://github.com/melvynator)）。
* 修复对象存储表函数中仅包含单个元素的枚举 glob 的处理。 [#80716](https://github.com/ClickHouse/ClickHouse/pull/80716) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* 修复了 `Tuple(Dynamic)` 与 `String` 的比较函数返回类型错误，从而导致逻辑错误的问题。[#80728](https://github.com/ClickHouse/ClickHouse/pull/80728) ([Pavel Kruglov](https://github.com/Avogar)).
* 为 Unity Catalog 补充对 `timestamp_ntz` 数据类型的支持。修复 [#79535](https://github.com/ClickHouse/ClickHouse/issues/79535)、[#79875](https://github.com/ClickHouse/ClickHouse/issues/79875)。[#80740](https://github.com/ClickHouse/ClickHouse/pull/80740)（[alesapin](https://github.com/alesapin)）。
* 修复在带有 `IN cte` 的分布式查询中出现的 `THERE_IS_NO_COLUMN` 错误。修复了 [#75032](https://github.com/ClickHouse/ClickHouse/issues/75032)。[#80757](https://github.com/ClickHouse/ClickHouse/pull/80757)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* 修复外部 `ORDER BY` 产生过多文件（导致内存使用过多）的问题。 [#80777](https://github.com/ClickHouse/ClickHouse/pull/80777) ([Azat Khuzhin](https://github.com/azat)).
  #* 此 PR 可能会关闭 [#80742](https://github.com/ClickHouse/ClickHouse/issues/80742)。 [#80783](https://github.com/ClickHouse/ClickHouse/pull/80783) ([zoomxi](https://github.com/zoomxi)).
  #* 修复 Kafka 中的崩溃问题，该问题是由于 get&#95;member&#95;id() 从 NULL 创建 std::string 引起的（这很可能只会在连接 broker 失败的情况下发生）。 [#80793](https://github.com/ClickHouse/ClickHouse/pull/80793) ([Azat Khuzhin](https://github.com/azat)).
* 在关闭 Kafka 引擎之前正确地等待所有 consumer 完成（关闭后仍然处于活动状态的 consumer 可能会触发各种调试断言，并且在表被删除/分离后仍可能在后台从 broker 读取数据）。 [#80795](https://github.com/ClickHouse/ClickHouse/pull/80795) ([Azat Khuzhin](https://github.com/azat)).
* 修复由 `predicate-push-down` 优化导致的 `NOT_FOUND_COLUMN_IN_BLOCK` 错误。修复了 [#80443](https://github.com/ClickHouse/ClickHouse/issues/80443)。[#80834](https://github.com/ClickHouse/ClickHouse/pull/80834)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* 修复在带有 `USING` 的 `JOIN` 中解析表函数中的星号（*）通配符时的逻辑错误。 [#80894](https://github.com/ClickHouse/ClickHouse/pull/80894) ([Vladimir Cherkasov](https://github.com/vdimir)).
* 修复 Iceberg 元数据文件缓存的内存统计。 [#80904](https://github.com/ClickHouse/ClickHouse/pull/80904) ([Azat Khuzhin](https://github.com/azat)).
* 修复使用可为空分区键时的错误分区行为。 [#80913](https://github.com/ClickHouse/ClickHouse/pull/80913) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* 修复在启用下推谓词的分布式查询（`allow_push_predicate_ast_for_distributed_subqueries=1`）且源表在发起查询的节点上不存在时出现的 `Table does not exist` 错误。修复了 [#77281](https://github.com/ClickHouse/ClickHouse/issues/77281)。[#80915](https://github.com/ClickHouse/ClickHouse/pull/80915)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* 修复具名窗口中嵌套函数的逻辑错误。 [#80926](https://github.com/ClickHouse/ClickHouse/pull/80926) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* 修复可空列和浮点类型列的极值处理。 [#80970](https://github.com/ClickHouse/ClickHouse/pull/80970) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* 修复在查询 `system.tables` 时可能发生的崩溃问题（在内存紧张时更容易出现）。 [#80976](https://github.com/ClickHouse/ClickHouse/pull/80976) ([Azat Khuzhin](https://github.com/azat)).
* 修复对压缩方式由文件扩展名推断的文件进行 `truncate` 操作时的原子重命名问题。 [#80979](https://github.com/ClickHouse/ClickHouse/pull/80979) ([Pablo Marcos](https://github.com/pamarcos)).
  #* 修复 `ErrorCodes::getName`。 [#81032](https://github.com/ClickHouse/ClickHouse/pull/81032) ([RinChanNOW](https://github.com/RinChanNOWWW)).
* 修复了当用户对所有表没有权限时，无法在 Unity Catalog 中列出表的错误。现在所有表都能正确列出，尝试读取受限表时将抛出异常。 [#81044](https://github.com/ClickHouse/ClickHouse/pull/81044) ([alesapin](https://github.com/alesapin)).
* 现在，ClickHouse 在执行 `SHOW TABLES` 查询时会忽略来自数据湖目录的错误和意外响应。修复了 [#79725](https://github.com/ClickHouse/ClickHouse/issues/79725)。[#81046](https://github.com/ClickHouse/ClickHouse/pull/81046) ([alesapin](https://github.com/alesapin))。
* 修复 `JSONExtract` 和 `JSON` 类型在从整数解析为 `DateTime64` 时的问题。[#81050](https://github.com/ClickHouse/ClickHouse/pull/81050)（[Pavel Kruglov](https://github.com/Avogar)）。
* 在模式推断缓存中体现 `date_time_input_format` 设置。[#81052](https://github.com/ClickHouse/ClickHouse/pull/81052)（[Pavel Kruglov](https://github.com/Avogar)）。
* 修复在执行 `INSERT` 时，如果在查询开始之后但在发送列之前表被 `DROP` 导致的崩溃。 [#81053](https://github.com/ClickHouse/ClickHouse/pull/81053) ([Azat Khuzhin](https://github.com/azat)).
* 修复 `quantileDeterministic` 中使用未初始化值的问题。[#81062](https://github.com/ClickHouse/ClickHouse/pull/81062)（[Azat Khuzhin](https://github.com/azat)）。
* 修复 `metadatastoragefromdisk` 磁盘事务的硬链接计数管理，并添加测试。[#81066](https://github.com/ClickHouse/ClickHouse/pull/81066) ([Sema Checherinda](https://github.com/CheSema))。
* 与其他函数不同，用户自定义函数（UDF）的名称不会被添加到 `system.query_log` 表中。此 PR 实现了在请求中使用了 UDF 时，将其名称添加到 `used_executable_user_defined_functions` 或 `used_sql_user_defined_functions` 这两列之一。[#81101](https://github.com/ClickHouse/ClickHouse/pull/81101)（[Kyamran](https://github.com/nibblerenush)）。
* 修复了在通过 HTTP 协议使用文本格式（`JSON`、`Values` 等）插入数据且省略 `Enum` 字段时可能出现的 `Too large size ... passed to allocator` 错误或崩溃问题。[#81145](https://github.com/ClickHouse/ClickHouse/pull/81145)（[Anton Popov](https://github.com/CurtizJ)）。
* 修复在将包含 Sparse 列的 INSERT 数据块推送到非 MT 物化视图时出现的 `LOGICAL_ERROR`。 [#81161](https://github.com/ClickHouse/ClickHouse/pull/81161) ([Azat Khuzhin](https://github.com/azat)).
* 修复在使用交叉复制且设置 `distributed_product_mode_local=local` 时出现的 `Unknown table expression identifier` 错误。 [#81162](https://github.com/ClickHouse/ClickHouse/pull/81162) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* 修复了在过滤后错误缓存 Parquet 文件行数的问题。 [#81184](https://github.com/ClickHouse/ClickHouse/pull/81184) ([Michael Kolupaev](https://github.com/al13n321))。
* 修复在使用相对缓存路径时的 fs 缓存 `max_size_to_total_space` 设置。 [#81237](https://github.com/ClickHouse/ClickHouse/pull/81237) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 修复了在以 Parquet 格式输出常量 `tuple` 或 `map` 时导致 `clickhouse-local` 崩溃的问题。 [#81249](https://github.com/ClickHouse/ClickHouse/pull/81249) ([Michael Kolupaev](https://github.com/al13n321)).
* 校验通过网络接收的数组偏移量。[#81269](https://github.com/ClickHouse/ClickHouse/pull/81269) ([Azat Khuzhin](https://github.com/azat))。
* 修复了在连接空表并使用窗口函数的查询中的一些边缘情况。该缺陷会导致并行流数量爆炸式增长，从而引发 OOM。[#81299](https://github.com/ClickHouse/ClickHouse/pull/81299) ([Alexander Gololobov](https://github.com/davenger)).
* 针对数据湖 Cluster 函数（`deltaLakeCluster`、`icebergCluster` 等）的修复：(1) 修复在旧分析器下使用 `Cluster` 函数时 `DataLakeConfiguration` 中可能出现的段错误；(2) 移除重复的数据湖元数据更新（额外的对象存储请求）；(3) 修复在未显式指定格式时对象存储中的冗余列举操作（此前已在非 cluster 数据湖引擎中完成相同修复）。[#81300](https://github.com/ClickHouse/ClickHouse/pull/81300) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 使 `force_restore_data` 标志可以恢复丢失的 Keeper 元数据。 [#81324](https://github.com/ClickHouse/ClickHouse/pull/81324) ([Raúl Marín](https://github.com/Algunenano)).
* 修复 delta-kernel 中的 region 错误，解决了 [#79914](https://github.com/ClickHouse/ClickHouse/issues/79914)。[#81353](https://github.com/ClickHouse/ClickHouse/pull/81353)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* 禁用 `divideOrNull` 的错误 JIT 实现。 [#81370](https://github.com/ClickHouse/ClickHouse/pull/81370) ([Raúl Marín](https://github.com/Algunenano)).
* 修复当 MergeTree 表的分区列表达式列名过长时出现的插入错误。 [#81390](https://github.com/ClickHouse/ClickHouse/pull/81390) ([hy123q](https://github.com/haoyangqian)).
* 不要在内存中存储多个清单文件的内容。[#81470](https://github.com/ClickHouse/ClickHouse/pull/81470) ([Daniil Ivanik](https://github.com/divanik)).
* 修复在关闭后台池（`background_.*pool_size`）期间可能发生的崩溃。[#81473](https://github.com/ClickHouse/ClickHouse/pull/81473)（[Azat Khuzhin](https://github.com/azat)）。
* 修复在使用 `URL` 引擎向表写入时发生的 `Npy` 格式越界读取问题。关闭了 [#81356](https://github.com/ClickHouse/ClickHouse/issues/81356)。[#81502](https://github.com/ClickHouse/ClickHouse/pull/81502)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 有时 Web UI 可能会显示 `NaN%`（典型的 JavaScript 问题）。[#81507](https://github.com/ClickHouse/ClickHouse/pull/81507)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 修复在 `database_replicated_enforce_synchronous_settings=1` 配置下的 `DatabaseReplicated`。 [#81564](https://github.com/ClickHouse/ClickHouse/pull/81564) ([Azat Khuzhin](https://github.com/azat)).
* 修复 `LowCardinality(Nullable(...))` 类型的排序顺序。[#81583](https://github.com/ClickHouse/ClickHouse/pull/81583) ([Pervakov Grigorii](https://github.com/GrigoryPervakov))。
* 如果尚未从套接字中完全读取请求，服务器不应保留 HTTP 连接。[#81595](https://github.com/ClickHouse/ClickHouse/pull/81595) ([Sema Checherinda](https://github.com/CheSema))。
* 使标量相关子查询返回投影表达式的可空结果。修复相关子查询产生空结果集时的处理。 [#81632](https://github.com/ClickHouse/ClickHouse/pull/81632) ([Dmitry Novik](https://github.com/novikd)).
* 修复在对 `ReplicatedMergeTree` 执行 `ATTACH` 时出现的 `Unexpected relative path for a deduplicated part` 错误。[#81647](https://github.com/ClickHouse/ClickHouse/pull/81647) ([Azat Khuzhin](https://github.com/azat))。
* 查询设置 `use_iceberg_partition_pruning` 对 iceberg 存储不会生效，因为它使用的是全局上下文而不是查询上下文。这并不严重，因为其默认值为 true。本 PR 修复了该问题。[#81673](https://github.com/ClickHouse/ClickHouse/pull/81673) ([Han Fei](https://github.com/hanfei1991))。
* 为合并树设置 `merge_max_block_size` 添加验证，以确保其值不为零。[#81693](https://github.com/ClickHouse/ClickHouse/pull/81693) ([Bharat Nallan](https://github.com/bharatnc)).
* 修复 `clickhouse-local` 中导致 `DROP VIEW` 查询卡死的问题。[#81705](https://github.com/ClickHouse/ClickHouse/pull/81705) ([Bharat Nallan](https://github.com/bharatnc)).
* 在某些情况下修复 `StorageRedis` 的联接行为。[#81736](https://github.com/ClickHouse/ClickHouse/pull/81736)（[Pervakov Grigorii](https://github.com/GrigoryPervakov)）。
* 修复在启用旧分析器且使用空 `USING ()` 时导致 `ConcurrentHashJoin` 崩溃的问题。[#81754](https://github.com/ClickHouse/ClickHouse/pull/81754) ([Nikita Taranov](https://github.com/nickitat))。
* Keeper 修复：如果日志中存在无效条目，则阻止提交新的日志。此前，如果 leader 错误地应用了某些日志，它仍会继续提交新的日志，尽管 follower 会检测到摘要不匹配并中止。[#81780](https://github.com/ClickHouse/ClickHouse/pull/81780) ([Antonio Andelic](https://github.com/antonio2368))。