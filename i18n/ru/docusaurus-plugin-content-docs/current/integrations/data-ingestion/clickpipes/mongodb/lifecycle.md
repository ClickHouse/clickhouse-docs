---
'sidebar_label': 'Жизненный цикл MongoDB ClickPipe'
'description': 'Различные статусы трубы и их значения'
'slug': '/integrations/clickpipes/mongodb/lifecycle'
'title': 'Жизненный цикл MongoDB ClickPipe'
'doc_type': 'guide'
---
# Жизненный цикл MongoDB ClickPipe {#lifecycle}

Это документ о различных фазах MongoDB ClickPipe, различных состояниях, которые он может иметь, и их значении.

## Под Provisioning {#provisioning}

Когда вы нажимаете кнопку Создать ClickPipe, ClickPipe создается в состоянии `Provisioning`. Процесс provisioning — это процесс, в котором мы разворачиваем инфраструктуру для выполнения ClickPipe для сервиса, а также регистрируем некоторую начальную метаданные для трубы. Поскольку вычислительные ресурсы для ClickPipe в рамках сервиса общие, ваш второй ClickPipe будет создан намного быстрее, чем первый, так как инфраструктура уже наладена.

## Настройка {#setup}

После того как трубаProvisioning, она переходит в состояние `Setup`. В этом состоянии мы создаем целевые таблицы ClickHouse.

## Снимок {#snapshot}

Как только настройка завершена, мы переходим в состояние `Snapshot` (если это труба только для CDC, она перейдет в состояние `Running`). `Snapshot`, `Initial Snapshot` и `Initial Load` (более распространенный термин) — это взаимозаменяемые термины. В этом состоянии мы создаем снимок исходных коллекций MongoDB и загружаем их в ClickHouse. Настройка хранения для oplog должна учитывать время начальной загрузки. Труба также перейдет в состояние `Snapshot`, когда будет вызван ресинхронизация или когда будут добавлены новые таблицы в существующую трубу.

## Выполнение {#running}

Как только начальная загрузка завершена, труба переходит в состояние `Running` (если это труба только для снимков, она перейдет в состояние `Completed`). Это момент, когда труба начинает `Change-Data Capture`. В этом состоянии мы начинаем стримить изменения из исходного кластера MongoDB в ClickHouse. Для информации о контроле CDC смотрите [документ о контроле CDC](./sync_control).

## Приостановлено {#paused}

Как только труба находится в состоянии `Running`, вы можете ее приостановить. Это остановит процесс CDC, и труба перейдет в состояние `Paused`. В этом состоянии новые данные не извлекаются из исходного MongoDB, но существующие данные в ClickHouse остаются нетронутыми. Вы можете возобновить трубу из этого состояния.

## Приостановка {#pausing}

:::note
Это состояние скоро будет доступно. Если вы используете наш [OpenAPI](https://clickhouse.com/docs/cloud/manage/openapi), рассмотрите возможность добавления поддержки этого состояния сейчас, чтобы ваша интеграция продолжала работать после его выхода.
:::
Когда вы нажимаете кнопку Приостановить, труба переходит в состояние `Pausing`. Это переходное состояние, в котором мы находимся в процессе остановки процесса CDC. Как только процесс CDC полностью остановлен, труба перейдет в состояние `Paused`.

## Модификация {#modifying}
:::note
Это состояние скоро будет доступно. Если вы используете наш [OpenAPI](https://clickhouse.com/docs/cloud/manage/openapi), рассмотрите возможность добавления поддержки этого состояния сейчас, чтобы ваша интеграция продолжала работать после его выхода.
:::
В настоящее время это означает, что труба находится в процессе удаления таблиц.

## Ресинхронизация {#resync}
:::note
Это состояние скоро будет доступно. Если вы используете наш [OpenAPI](https://clickhouse.com/docs/cloud/manage/openapi), рассмотрите возможность добавления поддержки этого состояния сейчас, чтобы ваша интеграция продолжала работать после его выхода.
:::
Это состояние указывает на то, что труба находится в фазе ресинхронизации, где выполняется атомарная замена _resync таблиц с оригинальными таблицами. Дополнительную информацию о ресинхронизации можно найти в [документации по ресинхронизации](./resync).

## Завершено {#completed}

Это состояние относится только к трубам для снимков и указывает на то, что снимок завершен и больше нет никаких задач.

## Ошибка {#failed}

Если в трубе возникает неисправимая ошибка, она перейдет в состояние `Failed`. Вы можете обратиться в службу поддержки или [ресинхронизировать](./resync) вашу трубу, чтобы восстановиться из этого состояния.

## Ухудшено {#degraded}

:::note
Это состояние скоро будет доступно. Если вы используете наш [OpenAPI](https://clickhouse.com/docs/cloud/manage/openapi), рассмотрите возможность добавления поддержки этого состояния сейчас, чтобы ваша интеграция продолжала работать после его выхода.
:::