---
title: 'Генерируемые столбцы Postgres: подводные камни и лучшие практики'
slug: /integrations/clickpipes/postgres/generated_columns
description: 'Страница, описывающая важные моменты, которые следует учитывать при использовании генерируемых столбцов PostgreSQL в реплицируемых таблицах'
doc_type: 'guide'
keywords: ['clickpipes', 'postgresql', 'cdc', 'загрузка данных', 'синхронизация в реальном времени']
---

При использовании генерируемых столбцов PostgreSQL в таблицах, которые реплицируются, важно учитывать несколько существенных моментов. Эти подводные камни могут повлиять на процесс репликации и согласованность данных в целевых системах.



## Проблема с генерируемыми столбцами {#the-problem-with-generated-columns}

1. **Не публикуются через `pgoutput`:** Генерируемые столбцы не публикуются через плагин логической репликации `pgoutput`. Это означает, что при репликации данных из PostgreSQL в другую систему значения генерируемых столбцов не включаются в поток репликации.

2. **Проблемы с первичными ключами:** Если генерируемый столбец входит в состав первичного ключа, это может вызвать проблемы с дедупликацией на стороне получателя. Поскольку значения генерируемых столбцов не реплицируются, система-получатель не будет располагать необходимой информацией для корректной идентификации и дедупликации строк.

3. **Проблемы с изменениями схемы**: Если вы добавляете генерируемый столбец в таблицу, которая уже реплицируется, новый столбец не будет заполнен на стороне получателя, поскольку Postgres не предоставляет RelationMessage для нового столбца. Если затем вы добавите новый негенерируемый столбец в ту же таблицу, ClickPipe при попытке согласовать схему не сможет найти генерируемый столбец на стороне получателя, что приведет к сбою процесса репликации.


## Рекомендации {#best-practices}

Для обхода этих ограничений рекомендуется следовать следующим практикам:

1. **Пересоздание генерируемых столбцов на целевом сервере:** Вместо того чтобы полагаться на процесс репликации для обработки генерируемых столбцов, рекомендуется пересоздавать эти столбцы на целевом сервере с помощью таких инструментов, как dbt (data build tool), или других механизмов преобразования данных.

2. **Избегайте использования генерируемых столбцов в первичных ключах:** При проектировании таблиц, которые будут реплицироваться, рекомендуется избегать включения генерируемых столбцов в состав первичного ключа.


## Предстоящие улучшения интерфейса {#upcoming-improvements-to-ui}

В будущих версиях мы планируем добавить в интерфейс возможности, которые помогут пользователям в следующем:

1. **Определение таблиц с вычисляемыми столбцами:** В интерфейсе появится функция для определения таблиц, содержащих вычисляемые столбцы. Это позволит пользователям понять, какие таблицы подвержены данной проблеме.

2. **Документация и лучшие практики:** Интерфейс будет включать лучшие практики использования вычисляемых столбцов в реплицируемых таблицах, в том числе рекомендации по избежанию типичных ошибок.
