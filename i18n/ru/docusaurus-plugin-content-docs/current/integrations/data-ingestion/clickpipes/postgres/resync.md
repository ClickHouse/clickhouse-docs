---
title: "Повторная синхронизация ClickPipe базы данных"
description: "Документация по повторной синхронизации ClickPipe базы данных"
slug: /integrations/clickpipes/postgres/resync
sidebar_label: "Повторная синхронизация ClickPipe"
doc_type: "guide"
keywords:
  ["clickpipes", "postgresql", "cdc", "data ingestion", "real-time sync"]
---

import resync_button from "@site/static/images/integrations/data-ingestion/clickpipes/postgres/resync_button.png"
import Image from "@theme/IdealImage"

### Что делает повторная синхронизация? {#what-postgres-resync-do}

Повторная синхронизация включает следующие операции в указанном порядке:

1. Существующий ClickPipe удаляется, и запускается новый ClickPipe для повторной синхронизации. Таким образом, изменения в структуре исходных таблиц будут учтены при повторной синхронизации.
2. ClickPipe повторной синхронизации создаёт (или заменяет) новый набор целевых таблиц с теми же именами, что и исходные таблицы, но с суффиксом `_resync`.
3. Выполняется начальная загрузка данных в таблицы `_resync`.
4. Затем таблицы `_resync` заменяются на исходные таблицы. Строки с мягким удалением переносятся из исходных таблиц в таблицы `_resync` перед заменой.

Все настройки исходного ClickPipe сохраняются в ClickPipe повторной синхронизации. Статистика исходного ClickPipe очищается в пользовательском интерфейсе.

### Сценарии использования повторной синхронизации ClickPipe {#use-cases-postgres-resync}

Вот несколько сценариев:

1. Вам может потребоваться выполнить значительные изменения схемы исходных таблиц, которые нарушат работу существующего ClickPipe и потребуют перезапуска. Вы можете просто нажать кнопку повторной синхронизации после выполнения изменений.
2. Специально для ClickHouse: возможно, вам потребовалось изменить ключи ORDER BY в целевых таблицах. Вы можете выполнить повторную синхронизацию, чтобы заново заполнить данные в новую таблицу с правильным ключом сортировки.
3. Слот репликации ClickPipe стал недействительным: повторная синхронизация создаёт новый ClickPipe и новый слот в исходной базе данных.

:::note
Вы можете выполнять повторную синхронизацию несколько раз, однако учитывайте нагрузку на исходную базу данных при повторной синхронизации,
поскольку каждый раз выполняется начальная загрузка с использованием параллельных потоков.
:::

### Руководство по повторной синхронизации ClickPipe {#guide-postgres-resync}

1. На вкладке «Источники данных» выберите Postgres ClickPipe, который вы хотите повторно синхронизировать.
2. Перейдите на вкладку **Настройки**.
3. Нажмите кнопку **Повторная синхронизация**.

<Image img={resync_button} border size='md' />

4. Появится диалоговое окно для подтверждения. Нажмите «Повторная синхронизация» ещё раз.
5. Перейдите на вкладку **Метрики**.
6. Примерно через 5 секунд (а также при обновлении страницы) статус конвейера должен измениться на **Setup** или **Snapshot**.
7. Начальную загрузку повторной синхронизации можно отслеживать на вкладке **Таблицы** в разделе **Статистика начальной загрузки**.
8. После завершения начальной загрузки конвейер атомарно заменит таблицы `_resync` на исходные таблицы. Во время замены статус будет **Resync**.
9. После завершения замены конвейер перейдёт в состояние **Running** и будет выполнять CDC, если эта функция включена.
