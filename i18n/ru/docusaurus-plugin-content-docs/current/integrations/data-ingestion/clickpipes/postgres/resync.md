---
title: 'Повторная синхронизация ClickPipe для базы данных'
description: 'Руководство по повторной синхронизации ClickPipe для базы данных'
slug: /integrations/clickpipes/postgres/resync
sidebar_label: 'Повторная синхронизация ClickPipe'
doc_type: 'guide'
keywords: ['clickpipes', 'postgresql', 'cdc', 'ингестия данных', 'синхронизация в режиме реального времени']
integration:
  - support_level: 'core'
  - category: 'clickpipes'
---

import resync_button from '@site/static/images/integrations/data-ingestion/clickpipes/postgres/resync_button.png'
import Image from '@theme/IdealImage';

### Что делает Resync? \\{#what-postgres-resync-do\\}

Resync выполняет следующие операции по порядку:

1. Существующий ClickPipe удаляется, и запускается новый ClickPipe «resync». Таким образом, изменения в структурах исходных таблиц будут учтены при повторной синхронизации.
2. ClickPipe resync создает (или заменяет) новый набор целевых таблиц с теми же именами, что и исходные таблицы, но с суффиксом `_resync`.
3. Для таблиц `_resync` выполняется начальная загрузка.
4. Таблицы `_resync` затем атомарно меняются местами с исходными таблицами. Строки, помеченные как удаленные (soft delete), перед обменом переносятся из исходных таблиц в таблицы `_resync`.

Все настройки исходного ClickPipe сохраняются в ClickPipe resync. Статистика исходного ClickPipe очищается в UI.

### Примеры использования повторной синхронизации ClickPipe \\{#use-cases-postgres-resync\\}

Вот несколько сценариев:

1. Вам может понадобиться выполнить значительные изменения схемы в исходных таблицах, которые поломают существующий ClickPipe, и его пришлось бы перезапускать. В этом случае вы можете просто нажать Resync после внесения изменений.
2. В частности, для ClickHouse, возможно, вам нужно было изменить ключи ORDER BY в целевых таблицах. Вы можете выполнить Resync, чтобы заново заполнить данные в новой таблице с правильным ключом сортировки.
3. Репликационный слот ClickPipe был аннулирован: Resync создаст новый ClickPipe и новый слот в исходной базе данных.

:::note
Вы можете выполнять resync многократно, однако учитывайте нагрузку на исходную базу данных при повторной синхронизации,
поскольку каждый раз задействуется начальная загрузка с параллельными потоками.
:::

### Руководство по Resync ClickPipe \\{#guide-postgres-resync\\}

1. На вкладке Data Sources нажмите на Postgres ClickPipe, который вы хотите синхронизировать заново.
2. Перейдите на вкладку **Settings**.
3. Нажмите кнопку **Resync**.

<Image img={resync_button} border size="md"/>

4. Появится диалоговое окно для подтверждения. Нажмите Resync еще раз.
5. Перейдите на вкладку **Metrics**.
6. Примерно через 5 секунд (а также после обновления страницы) статус конвейера должен стать **Setup** или **Snapshot**.
7. Ход начальной загрузки resync можно отслеживать на вкладке **Tables** — в разделе **Initial Load Stats**.
8. После завершения начальной загрузки конвейер атомарно поменяет местами таблицы `_resync` и исходные таблицы. Во время обмена статус будет **Resync**.
9. После завершения обмена конвейер перейдет в состояние **Running** и будет выполнять CDC (фиксацию изменений данных), если она включена.