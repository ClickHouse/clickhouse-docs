---
sidebar_label: 'FAQ'
description: 'Часто задаваемые вопросы о ClickPipes для MySQL.'
slug: /integrations/clickpipes/mysql/faq
sidebar_position: 2
title: 'Часто задаваемые вопросы о ClickPipes для MySQL'
doc_type: 'reference'
keywords: ['MySQL ClickPipes FAQ', 'ClickPipes MySQL troubleshooting', 'MySQL ClickHouse replication', 'ClickPipes MySQL support', 'MySQL CDC ClickHouse']
---



# ClickPipes для MySQL: Часто задаваемые вопросы

### Поддерживает ли MySQL ClickPipe MariaDB? {#does-the-clickpipe-support-mariadb}

Да, MySQL ClickPipe поддерживает MariaDB версии 10.0 и выше. Конфигурация очень похожа на MySQL, по умолчанию используется репликация GTID.

### Поддерживает ли MySQL ClickPipe PlanetScale, Vitess или TiDB? {#does-the-clickpipe-support-planetscale-vitess}

Нет, эти системы не поддерживают binlog API MySQL.

### Как управляется репликация? {#how-is-replication-managed}

Мы поддерживаем репликацию как `GTID`, так и `FilePos`. В отличие от Postgres, здесь нет слота для управления смещением. Вместо этого необходимо настроить на сервере MySQL достаточный период хранения binlog. Если наше смещение в binlog станет недействительным _(например, канал был приостановлен слишком долго или произошло переключение базы данных при использовании репликации `FilePos`)_, потребуется повторная синхронизация канала. Обязательно оптимизируйте материализованные представления в зависимости от целевых таблиц, так как неэффективные запросы могут замедлить загрузку данных настолько, что она отстанет от периода хранения.

Также возможна ситуация, когда неактивная база данных выполнит ротацию файла журнала, не позволяя ClickPipes перейти к более свежему смещению. Возможно, потребуется настроить таблицу heartbeat с регулярно планируемыми обновлениями.

В начале первоначальной загрузки мы записываем начальное смещение binlog. Это смещение должно оставаться действительным к моменту завершения первоначальной загрузки, чтобы CDC мог продолжить работу. Если вы загружаете большой объем данных, обязательно настройте соответствующий период хранения binlog. При настройке таблиц можно ускорить первоначальную загрузку, настроив параметр _Use a custom partitioning key for initial load_ для больших таблиц в расширенных настройках, чтобы загружать одну таблицу параллельно.

### Почему возникает ошибка проверки TLS-сертификата при подключении к MySQL? {#tls-certificate-validation-error}

При подключении к MySQL могут возникать ошибки сертификата, такие как `x509: certificate is not valid for any names` или `x509: certificate signed by unknown authority`. Они возникают потому, что ClickPipes по умолчанию включает шифрование TLS.

Существует несколько способов решения этих проблем:

1. **Установите поле TLS Host** — когда имя хоста в вашем подключении отличается от сертификата (часто встречается при использовании AWS PrivateLink через Endpoint Service). Установите «TLS Host (optional)» в соответствии с Common Name (CN) или Subject Alternative Name (SAN) сертификата.

2. **Загрузите корневой CA** — для серверов MySQL, использующих внутренние центры сертификации, или Google Cloud SQL в конфигурации CA по умолчанию для каждого экземпляра. Дополнительную информацию о том, как получить доступ к сертификатам Google Cloud SQL, см. в [этом разделе](https://clickhouse.com/docs/integrations/clickpipes/mysql/source/gcp#download-root-ca-certificate-gcp-mysql).

3. **Настройте сертификат сервера** — обновите SSL-сертификат вашего сервера, чтобы включить все имена хостов подключения и использовать доверенный центр сертификации.

4. **Пропустите проверку сертификата** — для самостоятельно размещенных MySQL или MariaDB, конфигурации которых по умолчанию предоставляют самоподписанный сертификат, который мы не можем проверить ([MySQL](https://dev.mysql.com/doc/refman/8.4/en/creating-ssl-rsa-files-using-mysql.html#creating-ssl-rsa-files-using-mysql-automatic), [MariaDB](https://mariadb.com/kb/en/securing-connections-for-client-and-server/#enabling-tls-for-mariadb-server)). Использование этого сертификата шифрует данные при передаче, но создает риск подмены сервера. Мы рекомендуем использовать правильно подписанные сертификаты для производственных сред, но этот вариант полезен для тестирования на разовом экземпляре или подключения к устаревшей инфраструктуре.

### Поддерживаются ли изменения схемы? {#do-you-support-schema-changes}

Дополнительную информацию см. на странице [ClickPipes для MySQL: Поддержка распространения изменений схемы](./schema-changes).

### Поддерживается ли репликация каскадных удалений внешних ключей MySQL `ON DELETE CASCADE`? {#support-on-delete-cascade}

Из-за того, как MySQL [обрабатывает каскадные удаления](https://dev.mysql.com/doc/refman/8.0/en/innodb-and-mysql-replication.html), они не записываются в binlog. Поэтому ClickPipes (или любой другой инструмент CDC) не может их реплицировать. Это может привести к несогласованности данных. Рекомендуется использовать триггеры для поддержки каскадных удалений.

### Почему не удается реплицировать таблицу, в имени которой есть точка? {#replicate-table-dot}

В настоящее время PeerDB имеет ограничение: точки в идентификаторах исходных таблиц — то есть в имени схемы или имени таблицы — не поддерживаются для репликации, поскольку PeerDB не может определить, что является схемой, а что таблицей, так как разделение происходит по точке.
Ведется работа по поддержке раздельного ввода схемы и таблицы для обхода этого ограничения.
