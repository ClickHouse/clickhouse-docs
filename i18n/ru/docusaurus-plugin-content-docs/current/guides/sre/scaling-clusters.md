---
slug: /guides/sre/scaling-clusters
sidebar_label: 'Перебалансировка шардов'
sidebar_position: 20
description: 'ClickHouse не поддерживает автоматическую перебалансировку шардов, поэтому мы даём ряд рекомендаций по перебалансировке шардов.'
title: 'Перебалансировка данных'
doc_type: 'guide'
keywords: ['масштабирование', 'кластеры', 'горизонтальное масштабирование', 'планирование ёмкости', 'производительность']
---

# Перебалансировка данных

ClickHouse не поддерживает автоматическую перебалансировку шардов. Однако существуют способы перебалансировать шарды, перечисленные в порядке предпочтительности:

1. Изменить шард для [распределённой таблицы](/engines/table-engines/special/distributed.md), позволив направлять новые записи преимущественно в новый шард. Это может привести к дисбалансу нагрузки и появлению горячих точек в кластере, но может быть приемлемым в большинстве сценариев, где пропускная способность по записи не является чрезвычайно высокой. При этом пользователю не нужно изменять целевую таблицу для записи, т.е. ею по-прежнему может оставаться распределённая таблица. Этот подход не помогает перебалансировать уже существующие данные.

2. В качестве альтернативы пункту (1) можно модифицировать текущий кластер и выполнять записи исключительно в новый шард до тех пор, пока кластер не будет сбалансирован — вручную регулируя распределение записей. Этот способ имеет те же ограничения, что и (1).

3. Если необходимо перебалансировать существующие данные и вы используете секционирование, рассмотрите возможность отсоединения партиций и их ручного переноса на другой узел с последующим присоединением к новому шарду. Этот подход требует больше ручных действий, чем последующие техники, но может быть быстрее и менее ресурсоёмким. Это ручная операция и, следовательно, требует отдельного планирования перебалансировки данных.

4. Экспортировать данные из исходного кластера в новый кластер с помощью [INSERT FROM SELECT](/sql-reference/statements/insert-into.md/#inserting-the-results-of-select). Это будет неэффективно на очень больших наборах данных и, вероятно, приведёт к значительной нагрузке на подсистему ввода-вывода исходного кластера, а также к существенному потреблению сетевых ресурсов. Этот вариант является крайней мерой.