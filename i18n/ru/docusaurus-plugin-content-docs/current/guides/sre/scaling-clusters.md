---
slug: /guides/sre/scaling-clusters
sidebar_label: 'Перебалансировка шардов'
sidebar_position: 20
description: 'ClickHouse не поддерживает автоматическую перебалансировку шардов, поэтому мы приводим рекомендации и лучшие практики по их перебалансировке.'
title: 'Перебалансировка данных'
doc_type: 'guide'
keywords: ['scaling', 'clusters', 'horizontal scaling', 'capacity planning', 'performance']
---

# Перебалансировка данных

ClickHouse не поддерживает автоматическую перебалансировку шардов. Однако есть несколько способов перебалансировать шарды (перечислены в порядке предпочтения):

1. Настроить шард для [распределённой таблицы](/engines/table-engines/special/distributed.md), чтобы перенаправить новые записи преимущественно на новый шард. Это может привести к дисбалансу нагрузки и появлению «горячих» шардов в кластере, но в большинстве сценариев, где нет экстремально высокой нагрузки на запись, такой подход вполне применим. Он не требует от пользователя менять целевую таблицу для записи — ей по‑прежнему может оставаться распределённая таблица. Этот способ не помогает перебалансировать уже существующие данные.

2. В качестве альтернативы (1) можно изменить конфигурацию существующего кластера и записывать данные исключительно в новый шард до тех пор, пока кластер не будет сбалансирован — вручную регулируя распределение записей. У этого подхода те же ограничения, что и у (1).

3. Если необходимо перебалансировать уже существующие данные и при этом данные разбиты на партиции, рассмотрите возможность отсоединения партиций, их ручного переноса на другой узел и последующего присоединения к новому шарду. Это более ручной подход по сравнению с последующими методами, но он может быть быстрее и менее ресурсоёмким. Поскольку операция выполняется вручную, при её выполнении необходимо отдельно продумывать стратегию перебалансировки данных.

4. Экспортировать данные из исходного кластера в новый кластер с помощью [INSERT FROM SELECT](/sql-reference/statements/insert-into.md/#inserting-the-results-of-select). Это будет неэффективно на очень больших наборах данных и, вероятно, приведёт к значительной нагрузке на подсистему ввода‑вывода исходного кластера и существенному потреблению сетевых ресурсов. Этот вариант является крайней мерой.