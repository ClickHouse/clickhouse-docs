---
slug: /guides/sre/scaling-clusters
sidebar_label: 'Перебалансировка шардов'
sidebar_position: 20
description: 'ClickHouse не поддерживает автоматическую перебалансировку шардов, поэтому мы приводим ряд рекомендаций по тому, как выполнять перебалансировку шардов.'
title: 'Перебалансировка данных'
doc_type: 'guide'
keywords: ['scaling', 'clusters', 'horizontal scaling', 'capacity planning', 'performance']
---

# Балансировка данных \{#rebalancing-data\}

ClickHouse не поддерживает автоматическую перебалансировку шардов. Однако есть несколько способов перебалансировать шарды, в порядке предпочтения:

1. Скорректировать шард для [распределённой таблицы](/engines/table-engines/special/distributed.md), сместив новые записи в пользу нового шарда. Это потенциально может привести к дисбалансу нагрузки и горячим точкам в кластере, но может быть приемлемым в большинстве сценариев, когда пропускная способность записи не чрезвычайно высока. Это не требует от пользователя изменения цели записи, т. е. она может оставаться распределённой таблицей. Этот способ не помогает перебалансировать уже существующие данные.

2. В качестве альтернативы (1), изменить существующий кластер и выполнять запись исключительно в новый шард до тех пор, пока кластер не будет сбалансирован — вручную регулируя распределение записей. Этот подход имеет те же ограничения, что и (1).

3. Если необходимо перебалансировать существующие данные и у вас включено секционирование данных, рассмотрите возможность отсоединения партиций и ручного перемещения их на другой узел перед повторным присоединением к новому шару. Этот способ предполагает больше ручных действий, чем последующие техники, но может быть быстрее и менее ресурсоёмким. Это ручная операция и, следовательно, при ней необходимо явно учитывать перебалансировку данных.

4. Экспортировать данные из исходного кластера в новый кластер с помощью [INSERT FROM SELECT](/sql-reference/statements/insert-into.md/#inserting-the-results-of-select). Этот способ будет неэффективен на очень больших наборах данных и потенциально приведёт к значительной нагрузке на подсистему ввода-вывода исходного кластера и существенному использованию сетевых ресурсов. Это крайняя мера.