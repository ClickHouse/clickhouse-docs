---
description: 'Страница, описывающая использование сторонних библиотек в ClickHouse, а также способы их добавления и сопровождения.'
sidebar_label: 'Сторонние библиотеки'
sidebar_position: 60
slug: /development/contrib
title: 'Сторонние библиотеки'
doc_type: 'reference'
---



# Сторонние библиотеки

ClickHouse использует сторонние библиотеки для различных целей, например для подключения к другим базам данных, декодирования и кодирования данных при загрузке/сохранении на/с диск, а также для реализации отдельных специализированных SQL-функций.
Чтобы не зависеть от набора доступных библиотек в целевой системе, каждая сторонняя библиотека импортируется как подмодуль Git в дерево исходного кода ClickHouse и затем компилируется и компонуется вместе с ClickHouse.
Список сторонних библиотек и их лицензий можно получить с помощью следующего запроса:

```sql
SELECT library_name, license_type, license_path FROM system.licenses ORDER BY library_name COLLATE 'en';
```

Обратите внимание, что перечисленные библиотеки находятся в каталоге `contrib/` репозитория ClickHouse.
В зависимости от параметров сборки некоторые библиотеки могут не компилироваться, и, как следствие, их функциональность может быть недоступна во время работы.

[Пример](https://sql.clickhouse.com?query_id=478GCPU7LRTSZJBNY3EJT3)


## Добавление и поддержка сторонних библиотек {#adding-and-maintaining-third-party-libraries}

Каждая сторонняя библиотека должна находиться в отдельном каталоге внутри директории `contrib/` репозитория ClickHouse.
Избегайте размещения копий внешнего кода непосредственно в каталоге библиотеки.
Вместо этого создайте Git-подмодуль для получения стороннего кода из внешнего upstream-репозитория.

Все подмодули, используемые ClickHouse, перечислены в файле `.gitmodule`.

- Если библиотека может использоваться как есть (случай по умолчанию), вы можете ссылаться на upstream-репозиторий напрямую.
- Если библиотека требует внесения изменений, создайте форк upstream-репозитория в [организации ClickHouse на GitHub](https://github.com/ClickHouse).

В последнем случае мы стремимся максимально изолировать пользовательские патчи от upstream-коммитов.
Для этого создайте ветку с префиксом `ClickHouse/` из ветки или тега, который вы хотите интегрировать, например `ClickHouse/2024_2` (для ветки `2024_2`) или `ClickHouse/release/vX.Y.Z` (для тега `release/vX.Y.Z`).
Избегайте отслеживания upstream-веток разработки `master`/ `main` / `dev` (то есть веток с префиксами `ClickHouse/master` / `ClickHouse/main` / `ClickHouse/dev` в форк-репозитории).
Такие ветки являются подвижными целями, что усложняет корректное версионирование.
«Ветки с префиксами» гарантируют, что получение изменений из upstream-репозитория в форк не затронет пользовательские ветки `ClickHouse/`.
Подмодули в `contrib/` должны отслеживать только ветки `ClickHouse/` форкнутых сторонних репозиториев.

Патчи применяются только к веткам `ClickHouse/` внешних библиотек.

Существует два способа сделать это:

- вы хотите внести новое исправление в ветку с префиксом `ClickHouse/` в форкнутом репозитории, например исправление для санитайзера. В этом случае отправьте исправление как ветку с префиксом `ClickHouse/`, например `ClickHouse/fix-sanitizer-disaster`. Затем создайте PR из новой ветки в пользовательскую отслеживаемую ветку, например `ClickHouse/2024_2 <-- ClickHouse/fix-sanitizer-disaster`, и выполните слияние PR.
- вы обновляете подмодуль и вам необходимо повторно применить более ранние патчи. В этом случае повторное создание старых PR избыточно. Вместо этого просто выполните cherry-pick старых коммитов в новую ветку `ClickHouse/` (соответствующую новой версии). Можете объединить коммиты из PR, которые содержали несколько коммитов. В лучшем случае мы внесли пользовательские патчи обратно в upstream и можем опустить патчи в новой версии.

После обновления подмодуля обновите подмодуль в ClickHouse, чтобы он указывал на новый хеш в форке.

Создавайте патчи для сторонних библиотек с учетом официального репозитория и рассмотрите возможность внесения патча обратно в upstream-репозиторий.
Это гарантирует, что другие также получат пользу от патча, и он не станет дополнительной нагрузкой по поддержке для команды ClickHouse.
