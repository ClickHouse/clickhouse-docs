---
title: "Настройки сеанса"
sidebar_label: "Настройки сеанса"
slug: /operations/settings/settings
toc_max_heading_level: 2
description: "Настройки, содержащиеся в таблице ``system.settings``."
doc_type: "reference"
---

import ExperimentalBadge from "@theme/badges/ExperimentalBadge"
import BetaBadge from "@theme/badges/BetaBadge"
import CloudOnlyBadge from "@theme/badges/CloudOnlyBadge"
import SettingsInfoBlock from "@theme/SettingsInfoBlock/SettingsInfoBlock"
import VersionHistory from "@theme/VersionHistory/VersionHistory"

<!-- Autogenerated -->

Все приведённые ниже настройки также доступны в таблице [system.settings](/docs/operations/system-tables/settings). Эти настройки автоматически генерируются из [исходного кода](https://github.com/ClickHouse/ClickHouse/blob/master/src/Core/Settings.cpp).


## add_http_cors_header {#add_http_cors_header}

<SettingsInfoBlock type='Bool' default_value='0' />

Добавлять HTTP-заголовок CORS.


## additional_result_filter {#additional_result_filter}

Дополнительное выражение фильтра, применяемое к результату запроса `SELECT`.
Эта настройка не применяется ни к одному из подзапросов.

**Пример**

```sql
INSERT INTO table_1 VALUES (1, 'a'), (2, 'bb'), (3, 'ccc'), (4, 'dddd');
SElECT * FROM table_1;
```

```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 2 │ bb   │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```

```sql
SELECT *
FROM table_1
SETTINGS additional_result_filter = 'x != 2'
```

```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```


## additional_table_filters {#additional_table_filters}

<SettingsInfoBlock type='Map' default_value='{}' />

Дополнительное выражение фильтра, применяемое после чтения данных
из указанной таблицы.

**Пример**

```sql
INSERT INTO table_1 VALUES (1, 'a'), (2, 'bb'), (3, 'ccc'), (4, 'dddd');
SELECT * FROM table_1;
```

```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 2 │ bb   │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```

```sql
SELECT *
FROM table_1
SETTINGS additional_table_filters = {'table_1': 'x != 2'}
```

```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```


## aggregate_functions_null_for_empty {#aggregate_functions_null_for_empty}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает перезапись всех агрегатных функций в запросе с добавлением суффикса [-OrNull](/sql-reference/aggregate-functions/combinators#-ornull). Включите для обеспечения совместимости со стандартом SQL.
Реализуется через перезапись запроса (аналогично настройке [count_distinct_implementation](#count_distinct_implementation)) для получения согласованных результатов при выполнении распределённых запросов.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

**Пример**

Рассмотрим следующий запрос с агрегатными функциями:

```sql
SELECT SUM(-1), MAX(0) FROM system.one WHERE 0;
```

При `aggregate_functions_null_for_empty = 0` результат будет следующим:

```text
┌─SUM(-1)─┬─MAX(0)─┐
│       0 │      0 │
└─────────┴────────┘
```

При `aggregate_functions_null_for_empty = 1` результат будет следующим:

```text
┌─SUMOrNull(-1)─┬─MAXOrNull(0)─┐
│          NULL │         NULL │
└───────────────┴──────────────┘
```


## aggregation_in_order_max_block_bytes {#aggregation_in_order_max_block_bytes}

<SettingsInfoBlock type='UInt64' default_value='50000000' />

Максимальный размер блока в байтах, накапливаемого при агрегации в порядке первичного ключа. Меньший размер блока позволяет лучше распараллелить финальную стадию слияния при агрегации.


## aggregation_memory_efficient_merge_threads {#aggregation_memory_efficient_merge_threads}

<SettingsInfoBlock type='UInt64' default_value='0' />

Количество потоков для слияния промежуточных результатов агрегации в режиме эффективного использования памяти. Чем больше значение, тем больше памяти потребляется. Значение 0 означает использование того же значения, что и в параметре `max_threads`.


## allow_aggregate_partitions_independently {#allow_aggregate_partitions_independently}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает независимую агрегацию партиций в отдельных потоках, когда ключ партиционирования соответствует ключу GROUP BY. Полезно, когда количество партиций близко к количеству ядер и партиции имеют примерно одинаковый размер


## allow_archive_path_syntax {#allow_archive_path_syntax}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.8" },
        { label: "1" },
        { label: "Добавлена новая настройка для возможности отключения синтаксиса путей архивов." }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.5" },
        { label: "1" },
        { label: "Добавлена новая настройка для возможности отключения синтаксиса путей архивов." }
      ]
    }
  ]}
/>

Движки File/S3 и табличные функции будут интерпретировать пути с '::' как `<archive> :: <file>`, если архив имеет корректное расширение.


## allow_asynchronous_read_from_io_pool_for_merge_tree {#allow_asynchronous_read_from_io_pool_for_merge_tree}

<SettingsInfoBlock type='Bool' default_value='0' />

Использовать фоновый пул ввода-вывода для чтения из таблиц MergeTree. Эта настройка может повысить производительность запросов, ограниченных операциями ввода-вывода


## allow_changing_replica_until_first_data_packet {#allow_changing_replica_until_first_data_packet}

<SettingsInfoBlock type='Bool' default_value='0' />

Если параметр включен, при хеджированных запросах можно устанавливать новое соединение до получения первого пакета данных, даже если уже был достигнут определенный прогресс
(но прогресс не обновлялся в течение таймаута `receive_data_timeout`). В противном случае переключение на другую реплику отключается после первого достижения прогресса.


## allow_create_index_without_type {#allow_create_index_without_type}

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает выполнение запроса CREATE INDEX без указания TYPE. Запрос будет проигнорирован. Предназначено для тестов совместимости с SQL.


## allow_custom_error_code_in_throwif {#allow_custom_error_code_in_throwif}

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает использование пользовательских кодов ошибок в функции throwIf(). Если значение true, генерируемые исключения могут иметь нестандартные коды ошибок.


## allow_ddl {#allow_ddl}

<SettingsInfoBlock type='Bool' default_value='1' />

Если установлено значение true, пользователю разрешено выполнять DDL-запросы.


## allow_deprecated_database_ordinary {#allow_deprecated_database_ordinary}

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает создание баз данных с устаревшим движком Ordinary


## allow_deprecated_error_prone_window_functions {#allow_deprecated_error_prone_window_functions}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.5" },
        { label: "0" },
        {
          label:
            "Разрешает использование устаревших оконных функций, склонных к ошибкам (neighbor, runningAccumulate, runningDifferenceStartingWithFirstValue, runningDifference)"
        }
      ]
    }
  ]}
/>

Разрешает использование устаревших оконных функций, склонных к ошибкам (neighbor, runningAccumulate, runningDifferenceStartingWithFirstValue, runningDifference)


## allow_deprecated_snowflake_conversion_functions {#allow_deprecated_snowflake_conversion_functions}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        {
          label:
            "Отключены устаревшие функции snowflakeToDateTime[64] и dateTime[64]ToSnowflake."
        }
      ]
    }
  ]}
/>

Функции `snowflakeToDateTime`, `snowflakeToDateTime64`, `dateTimeToSnowflake` и `dateTime64ToSnowflake` устарели и по умолчанию отключены.
Используйте вместо них функции `snowflakeIDToDateTime`, `snowflakeIDToDateTime64`, `dateTimeToSnowflakeID` и `dateTime64ToSnowflakeID`.

Чтобы снова включить устаревшие функции (например, на период миграции), установите для этого параметра значение `true`.


## allow_deprecated_syntax_for_merge_tree {#allow_deprecated_syntax_for_merge_tree}

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает создание таблиц семейства \*MergeTree с использованием устаревшего синтаксиса определения движка


## allow_distributed_ddl {#allow_distributed_ddl}

<SettingsInfoBlock type='Bool' default_value='1' />

Если установлено значение true, пользователю разрешается выполнять распределённые DDL-запросы.


## allow_drop_detached {#allow_drop_detached}

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает выполнение запросов ALTER TABLE ... DROP DETACHED PART[ITION] ...


## allow_dynamic_type_in_join_keys {#allow_dynamic_type_in_join_keys}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.10" },
        { label: "0" },
        { label: "По умолчанию запрещено использование типа Dynamic в ключах JOIN" }
      ]
    }
  ]}
/>

Разрешает использование типа Dynamic в ключах JOIN. Добавлено для обеспечения совместимости. Не рекомендуется использовать тип Dynamic в ключах JOIN, так как сравнение с другими типами может привести к неожиданным результатам.


## allow_execute_multiif_columnar {#allow_execute_multiif_columnar}

<SettingsInfoBlock type='Bool' default_value='1' />

Разрешить колоночное выполнение функции multiIf


## allow_experimental_alias_table_engine {#allow_experimental_alias_table_engine}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "0" }, { label: "New setting" }]
    }
  ]}
/>

Разрешает создание таблиц с движком Alias.


## allow_experimental_analyzer {#allow_experimental_analyzer}

**Псевдонимы**: `enable_analyzer`

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "1" },
        { label: "Анализатор и планировщик включены по умолчанию." }
      ]
    }
  ]}
/>

Разрешает использование нового анализатора запросов.


## allow_experimental_codecs {#allow_experimental_codecs}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

Если установлено значение true, разрешает указание экспериментальных кодеков сжатия (однако таких кодеков пока не существует, и данная опция не имеет эффекта).


## allow_experimental_correlated_subqueries {#allow_experimental_correlated_subqueries}

<BetaBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.8" },
        { label: "1" },
        { label: "Поддержка коррелированных подзапросов помечена как бета-версия." }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "25.4" },
        { label: "0" },
        { label: "Добавлена новая настройка для разрешения выполнения коррелированных подзапросов." }
      ]
    }
  ]}
/>

Разрешает выполнение коррелированных подзапросов.


## allow_experimental_database_glue_catalog {#allow_experimental_database_glue_catalog}

<BetaBadge />

**Псевдонимы**: `allow_database_glue_catalog`

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.3" },
        { label: "0" },
        {
          label:
            "Разрешает использование экспериментального движка базы данных DataLakeCatalog с catalog_type = 'glue'"
        }
      ]
    }
  ]}
/>

Разрешает использование экспериментального движка базы данных DataLakeCatalog с catalog_type = 'glue'


## allow_experimental_database_hms_catalog {#allow_experimental_database_hms_catalog}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "0" },
        {
          label:
            "Разрешает использование экспериментального движка базы данных DataLakeCatalog с catalog_type = 'hive'"
        }
      ]
    }
  ]}
/>

Разрешает использование экспериментального движка базы данных DataLakeCatalog с catalog_type = 'hms'


## allow_experimental_database_iceberg {#allow_experimental_database_iceberg}

<BetaBadge />

**Псевдонимы**: `allow_database_iceberg`

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.12" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Разрешает использование экспериментального движка базы данных DataLakeCatalog с catalog_type = 'iceberg'


## allow_experimental_database_materialized_postgresql {#allow_experimental_database_materialized_postgresql}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает создание базы данных с движком Engine=MaterializedPostgreSQL(...).


## allow_experimental_database_unity_catalog {#allow_experimental_database_unity_catalog}

<BetaBadge />

**Псевдонимы**: `allow_database_unity_catalog`

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.3" },
        { label: "0" },
        {
          label:
            "Разрешает использование экспериментального движка базы данных DataLakeCatalog с catalog_type = 'unity'"
        }
      ]
    }
  ]}
/>

Разрешает использование экспериментального движка базы данных DataLakeCatalog с catalog_type = 'unity'


## allow_experimental_delta_kernel_rs {#allow_experimental_delta_kernel_rs}

<BetaBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.5" }, { label: "1" }, { label: "New setting" }]
    }
  ]}
/>

Разрешает использование экспериментальной реализации delta-kernel-rs.


## allow_experimental_delta_lake_writes {#allow_experimental_delta_lake_writes}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Включает возможность записи delta-kernel.


## allow_experimental_full_text_index {#allow_experimental_full_text_index}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        { label: "Включить экспериментальный полнотекстовый индекс" }
      ]
    }
  ]}
/>

Если установлено значение true, разрешает использование экспериментального полнотекстового индекса.


## allow_experimental_funnel_functions {#allow_experimental_funnel_functions}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

Включить экспериментальные функции для анализа воронок.


## allow_experimental_hash_functions {#allow_experimental_hash_functions}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

Включает экспериментальные хеш-функции


## allow_experimental_iceberg_compaction {#allow_experimental_iceberg_compaction}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "New setting " }]
    }
  ]}
/>

Разрешает явное использование команды 'OPTIMIZE' для таблиц iceberg.


## allow_experimental_insert_into_iceberg {#allow_experimental_insert_into_iceberg}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.7" }, { label: "0" }, { label: "New setting." }]
    }
  ]}
/>

Разрешает выполнение запросов `INSERT` в Iceberg.


## allow_experimental_join_right_table_sorting {#allow_experimental_join_right_table_sorting}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.9" },
        { label: "0" },
        {
          label:
            "Если установлено значение true и выполнены условия `join_to_sort_minimum_perkey_rows` и `join_to_sort_maximum_table_rows`, правая таблица переупорядочивается по ключу для улучшения производительности левого или внутреннего хеш-соединения"
        }
      ]
    }
  ]}
/>

Если установлено значение true и выполнены условия `join_to_sort_minimum_perkey_rows` и `join_to_sort_maximum_table_rows`, правая таблица переупорядочивается по ключу для улучшения производительности левого или внутреннего хеш-соединения.


## allow_experimental_kafka_offsets_storage_in_keeper {#allow_experimental_kafka_offsets_storage_in_keeper}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.8" },
        { label: "0" },
        {
          label:
            "Разрешает использование экспериментального движка хранения Kafka, который сохраняет подтверждённые смещения в ClickHouse Keeper"
        }
      ]
    }
  ]}
/>

Разрешает использование экспериментальной функции для хранения смещений Kafka в ClickHouse Keeper. При включении для движка таблиц Kafka можно указать путь в ClickHouse Keeper и имя реплики. В результате вместо стандартного движка Kafka будет использоваться новый тип движка хранения, который сохраняет подтверждённые смещения преимущественно в ClickHouse Keeper


## allow_experimental_kusto_dialect {#allow_experimental_kusto_dialect}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.1" }, { label: "0" }, { label: "A new setting" }]
    }
  ]}
/>

Включает язык запросов Kusto (KQL) — альтернативу SQL.


## allow_experimental_materialized_postgresql_table {#allow_experimental_materialized_postgresql_table}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает использование движка таблиц MaterializedPostgreSQL. Отключено по умолчанию, поскольку данная функция является экспериментальной


## allow_experimental_nlp_functions {#allow_experimental_nlp_functions}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

Включает экспериментальные функции для обработки естественного языка.


## allow_experimental_parallel_reading_from_replicas {#allow_experimental_parallel_reading_from_replicas}

<BetaBadge />

**Псевдонимы**: `enable_parallel_replicas`

<SettingsInfoBlock type='UInt64' default_value='0' />

Использовать до `max_parallel_replicas` реплик из каждого шарда для выполнения SELECT-запросов. Чтение распараллеливается и координируется динамически. 0 — отключено, 1 — включено, при ошибке автоматически отключается, 2 — включено, при ошибке генерируется исключение


## allow_experimental_prql_dialect {#allow_experimental_prql_dialect}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.1" }, { label: "0" }, { label: "A new setting" }]
    }
  ]}
/>

Включает поддержку PRQL — альтернативы SQL.


## allow_experimental_qbit_type {#allow_experimental_qbit_type}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.10" },
        { label: "0" },
        { label: "Новая экспериментальная настройка" }
      ]
    }
  ]}
/>

Разрешает создание типа данных [QBit](../../sql-reference/data-types/qbit.md).


## allow_experimental_query_deduplication {#allow_experimental_query_deduplication}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

Экспериментальная дедупликация данных для SELECT-запросов на основе UUID частей данных


## allow_experimental_statistics {#allow_experimental_statistics}

<ExperimentalBadge />

**Псевдонимы**: `allow_experimental_statistic`

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        {
          label:
            "Настройка была переименована. Прежнее название — `allow_experimental_statistic`."
        }
      ]
    }
  ]}
/>

Позволяет определять столбцы со [статистикой](../../engines/table-engines/mergetree-family/mergetree.md/#table_engine-mergetree-creating-a-table) и [манипулировать статистикой](../../engines/table-engines/mergetree-family/mergetree.md/#column-statistics).


## allow_experimental_time_series_aggregate_functions {#allow_experimental_time_series_aggregate_functions}

<ExperimentalBadge />

**Псевдонимы**: `allow_experimental_ts_to_grid_aggregate_function`

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "0" },
        {
          label:
            "Новая настройка для включения экспериментальных агрегатных функций timeSeries*."
        }
      ]
    }
  ]}
/>

Экспериментальные агрегатные функции timeSeries\* для передискретизации временных рядов в стиле Prometheus, вычисления скорости изменения и приращения.


## allow_experimental_time_series_table {#allow_experimental_time_series_table}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.8" },
        { label: "0" },
        { label: "Добавлена новая настройка для использования движка таблиц TimeSeries" }
      ]
    }
  ]}
/>

Разрешает создание таблиц с движком [TimeSeries](../../engines/table-engines/integrations/time-series.md). Возможные значения:

- 0 — движок таблиц [TimeSeries](../../engines/table-engines/integrations/time-series.md) отключён.
- 1 — движок таблиц [TimeSeries](../../engines/table-engines/integrations/time-series.md) включён.


## allow_experimental_time_time64_type {#allow_experimental_time_time64_type}

<ExperimentalBadge />

**Псевдонимы**: `enable_time_time64_type`

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "0" },
        {
          label:
            "Новая настройка. Позволяет использовать новые экспериментальные типы данных Time и Time64."
        }
      ]
    }
  ]}
/>

Разрешает создание типов данных [Time](../../sql-reference/data-types/time.md) и [Time64](../../sql-reference/data-types/time64.md).


## allow_experimental_window_view {#allow_experimental_window_view}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

Включает WINDOW VIEW. Функция недостаточно зрелая.


## allow_experimental_ytsaurus_dictionary_source {#allow_experimental_ytsaurus_dictionary_source}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

    Экспериментальный источник словаря для интеграции с YTsaurus.


## allow_experimental_ytsaurus_table_engine {#allow_experimental_ytsaurus_table_engine}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Экспериментальный движок таблиц для интеграции с YTsaurus.


## allow_experimental_ytsaurus_table_function {#allow_experimental_ytsaurus_table_function}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Экспериментальный движок таблиц для интеграции с YTsaurus.


## allow_general_join_planning {#allow_general_join_planning}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.1" },
        { label: "1" },
        {
          label:
            "Разрешает использование более общего алгоритма планирования соединений при включённом алгоритме hash join."
        }
      ]
    }
  ]}
/>

Позволяет использовать более общий алгоритм планирования соединений, способный обрабатывать более сложные условия, но работающий только с hash join. Если hash join не включён, используется стандартный алгоритм планирования соединений независимо от значения этой настройки.


## allow_get_client_http_header {#allow_get_client_http_header}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "0" },
        { label: "Введена новая функция." }
      ]
    }
  ]}
/>

Разрешает использование функции `getClientHTTPHeader`, которая позволяет получить значение заголовка текущего HTTP-запроса. По умолчанию отключена из соображений безопасности, поскольку некоторые заголовки, такие как `Cookie`, могут содержать конфиденциальную информацию. Обратите внимание, что заголовки `X-ClickHouse-*` и `Authentication` всегда недоступны и не могут быть получены с помощью этой функции.


## allow_hyperscan {#allow_hyperscan}

<SettingsInfoBlock type='Bool' default_value='1' />

Разрешает использование функций, работающих с библиотекой Hyperscan. Отключите эту настройку, чтобы избежать потенциально длительного времени компиляции и чрезмерного потребления ресурсов.


## allow_introspection_functions {#allow_introspection_functions}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает [функции интроспекции](../../sql-reference/functions/introspection.md) для профилирования запросов.

Возможные значения:

- 1 — функции интроспекции включены.
- 0 — функции интроспекции отключены.

**См. также**

- [Профилировщик запросов с семплированием](../../operations/optimizing-performance/sampling-query-profiler.md)
- Системная таблица [trace_log](/operations/system-tables/trace_log)


## allow_materialized_view_with_bad_select {#allow_materialized_view_with_bad_select}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.4" },
        { label: "0" },
        {
          label:
            "Запрещено создание материализованных представлений со ссылками на несуществующие столбцы или таблицы"
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.9" },
        { label: "1" },
        {
          label:
            "Поддержка (пока не включена) более строгой проверки в CREATE MATERIALIZED VIEW"
        }
      ]
    }
  ]}
/>

Разрешает выполнение CREATE MATERIALIZED VIEW с запросом SELECT, который ссылается на несуществующие таблицы или столбцы. Запрос должен оставаться синтаксически корректным. Не применяется к обновляемым материализованным представлениям. Не применяется, если схема материализованного представления должна быть выведена из запроса SELECT (т. е. если в CREATE отсутствует список столбцов и таблица TO). Может использоваться для создания материализованного представления до создания его исходной таблицы.


## allow_named_collection_override_by_default {#allow_named_collection_override_by_default}

<SettingsInfoBlock type='Bool' default_value='1' />

Разрешает переопределение полей именованных коллекций по умолчанию.


## allow_non_metadata_alters {#allow_non_metadata_alters}

<SettingsInfoBlock type='Bool' default_value='1' />

Разрешает выполнение операций ALTER, которые влияют не только на метаданные таблиц, но и на данные на диске


## allow_nonconst_timezone_arguments {#allow_nonconst_timezone_arguments}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.4" },
        { label: "0" },
        {
          label:
            "Разрешить неконстантные аргументы часового пояса в некоторых функциях для работы со временем, таких как toTimeZone(), fromUnixTimestamp*(), snowflakeToDateTime*()."
        }
      ]
    }
  ]}
/>

Разрешить неконстантные аргументы часового пояса в некоторых функциях для работы со временем, таких как toTimeZone(), fromUnixTimestamp*(), snowflakeToDateTime*().
Эта настройка существует исключительно для обеспечения совместимости. В ClickHouse часовой пояс является свойством типа данных, а следовательно, и столбца.
Включение этой настройки создаёт ошибочное впечатление, что различные значения внутри столбца могут иметь разные часовые пояса.
Поэтому не рекомендуется включать эту настройку.


## allow_nondeterministic_mutations {#allow_nondeterministic_mutations}

<SettingsInfoBlock type='Bool' default_value='0' />

Пользовательская настройка, позволяющая использовать недетерминированные функции, такие как `dictGet`, в мутациях реплицируемых таблиц.

Поскольку, например, словари могут быть не синхронизированы между узлами, мутации, извлекающие из них значения, по умолчанию запрещены для реплицируемых таблиц. Включение этой настройки разрешает такое поведение, возлагая на пользователя ответственность за синхронизацию используемых данных на всех узлах.

**Пример**

```xml
<profiles>
    <default>
        <allow_nondeterministic_mutations>1</allow_nondeterministic_mutations>

        <!-- ... -->
    </default>

    <!-- ... -->

</profiles>
```


## allow_nondeterministic_optimize_skip_unused_shards {#allow_nondeterministic_optimize_skip_unused_shards}

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает использование недетерминированных функций (таких как `rand` или `dictGet`, причём последняя имеет некоторые ограничения при обновлениях) в ключе шардирования.

Возможные значения:

- 0 — Запрещено.
- 1 — Разрешено.


## allow_not_comparable_types_in_comparison_functions {#allow_not_comparable_types_in_comparison_functions}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.1" },
        { label: "0" },
        {
          label:
            "По умолчанию запрещено использование несравниваемых типов в функциях сравнения"
        }
      ]
    }
  ]}
/>

Разрешает или запрещает использование несравниваемых типов (таких как JSON/AggregateFunction) в функциях сравнения `equal/less/greater/etc`.


## allow_not_comparable_types_in_order_by {#allow_not_comparable_types_in_order_by}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.1" },
        { label: "0" },
        { label: "По умолчанию запрещено использование несравниваемых типов в ORDER BY" }
      ]
    }
  ]}
/>

Разрешает или запрещает использование несравниваемых типов (например, JSON/AggregateFunction) в ключах ORDER BY.


## allow_prefetched_read_pool_for_local_filesystem {#allow_prefetched_read_pool_for_local_filesystem}

<SettingsInfoBlock type='Bool' default_value='0' />

Использовать пул потоков с предварительной выборкой, если все части находятся в локальной файловой системе


## allow_prefetched_read_pool_for_remote_filesystem {#allow_prefetched_read_pool_for_remote_filesystem}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать пул потоков с предварительной выборкой, если все части данных находятся на удалённой файловой системе


## allow_push_predicate_ast_for_distributed_subqueries {#allow_push_predicate_ast_for_distributed_subqueries}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.1" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Позволяет проталкивать предикаты на уровень AST для распределённых подзапросов при включённом анализаторе


## allow_push_predicate_when_subquery_contains_with {#allow_push_predicate_when_subquery_contains_with}

<SettingsInfoBlock type='Bool' default_value='1' />

Разрешает проталкивание предиката, когда подзапрос содержит секцию WITH


## allow_reorder_prewhere_conditions {#allow_reorder_prewhere_conditions}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.10" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

При перемещении условий из WHERE в PREWHERE разрешает изменение их порядка для оптимизации фильтрации


## allow_settings_after_format_in_insert {#allow_settings_after_format_in_insert}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "22.4" },
        { label: "0" },
        {
          label:
            "Не разрешать SETTINGS после FORMAT в запросах INSERT, так как ClickHouse интерпретирует SETTINGS как значения, что вводит в заблуждение"
        }
      ]
    }
  ]}
/>

Управляет разрешением использования `SETTINGS` после `FORMAT` в запросах `INSERT`. Не рекомендуется использовать эту возможность, так как часть `SETTINGS` может быть интерпретирована как значения.

Пример:

```sql
INSERT INTO FUNCTION null('foo String') SETTINGS max_threads=1 VALUES ('bar');
```

Однако следующий запрос будет работать только при включенной настройке `allow_settings_after_format_in_insert`:

```sql
SET allow_settings_after_format_in_insert=1;
INSERT INTO FUNCTION null('foo String') VALUES ('bar') SETTINGS max_threads=1;
```

Возможные значения:

- 0 — Запрещено.
- 1 — Разрешено.

:::note
Используйте эту настройку только для обратной совместимости, если ваши сценарии использования зависят от старого синтаксиса.
:::


## allow_simdjson {#allow_simdjson}

<SettingsInfoBlock type='Bool' default_value='1' />

Разрешает использование библиотеки simdjson в функциях 'JSON\*' при наличии инструкций AVX2. Если параметр отключён, будет использоваться библиотека rapidjson.


## allow_special_serialization_kinds_in_output_formats {#allow_special_serialization_kinds_in_output_formats}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "1" },
        {
          label:
            "Включена возможность прямого вывода специальных представлений столбцов (Sparse/Replicated) в некоторых форматах вывода"
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "25.10" },
        { label: "0" },
        {
          label:
            "Добавлена настройка для вывода специальных представлений столбцов (Sparse/Replicated) без преобразования в полные столбцы"
        }
      ]
    }
  ]}
/>

Позволяет выводить столбцы со специальными типами сериализации (Sparse, Replicated) без преобразования в полное представление столбца.
Помогает избежать избыточного копирования данных при форматировании.


## allow_statistics_optimize {#allow_statistics_optimize}

<ExperimentalBadge />

**Псевдонимы**: `allow_statistic_optimize`

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        {
          label:
            "Настройка была переименована. Прежнее название — `allow_statistic_optimize`."
        }
      ]
    }
  ]}
/>

Позволяет использовать статистику для оптимизации запросов


## allow_suspicious_codecs {#allow_suspicious_codecs}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "20.5" },
        { label: "0" },
        { label: "Запрещено указывать бессмысленные кодеки сжатия" }
      ]
    }
  ]}
/>

Если установлено значение true, разрешает указание бессмысленных кодеков сжатия.


## allow_suspicious_fixed_string_types {#allow_suspicious_fixed_string_types}

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает создание столбцов типа FixedString(n) с n > 256 в операторе CREATE TABLE. FixedString с длиной >= 256 является подозрительным и, скорее всего, указывает на неправильное использование


## allow_suspicious_indices {#allow_suspicious_indices}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.4" },
        { label: "0" },
        { label: "Если включено, индекс может быть определён с идентичными выражениями" }
      ]
    }
  ]}
/>

Запрещать первичные/вторичные индексы и ключи сортировки с идентичными выражениями


## allow_suspicious_low_cardinality_types {#allow_suspicious_low_cardinality_types}

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает или запрещает использование [LowCardinality](../../sql-reference/data-types/lowcardinality.md) с типами данных фиксированного размера 8 байт или меньше: числовыми типами данных и `FixedString(8_bytes_or_less)`.

Для небольших фиксированных значений использование `LowCardinality` обычно неэффективно, поскольку ClickHouse хранит числовой индекс для каждой строки. В результате:

- Использование дискового пространства может возрасти.
- Потребление оперативной памяти может быть выше в зависимости от размера словаря.
- Некоторые функции могут работать медленнее из-за дополнительных операций кодирования/декодирования.

Время слияния в таблицах с движком [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) может увеличиться по всем вышеописанным причинам.

Возможные значения:

- 1 — использование `LowCardinality` не ограничено.
- 0 — использование `LowCardinality` ограничено.


## allow_suspicious_primary_key {#allow_suspicious_primary_key}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "0" },
        {
          label:
            "Запрещено использование подозрительных PRIMARY KEY/ORDER BY для MergeTree (например, SimpleAggregateFunction)"
        }
      ]
    }
  ]}
/>

Разрешает использование подозрительных `PRIMARY KEY`/`ORDER BY` для MergeTree (например, SimpleAggregateFunction).


## allow_suspicious_ttl_expressions {#allow_suspicious_ttl_expressions}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.12" },
        { label: "0" },
        {
          label:
            "Это новая настройка. В предыдущих версиях поведение было эквивалентно разрешающему."
        }
      ]
    }
  ]}
/>

Отклонять TTL-выражения, не зависящие ни от одного столбца таблицы. Чаще всего это указывает на ошибку пользователя.


## allow_suspicious_types_in_group_by {#allow_suspicious_types_in_group_by}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.11" },
        { label: "0" },
        { label: "По умолчанию типы Variant/Dynamic в GROUP BY запрещены" }
      ]
    }
  ]}
/>

Разрешает или запрещает использование типов [Variant](../../sql-reference/data-types/variant.md) и [Dynamic](../../sql-reference/data-types/dynamic.md) в ключах GROUP BY.


## allow_suspicious_types_in_order_by {#allow_suspicious_types_in_order_by}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.11" },
        { label: "0" },
        { label: "По умолчанию запрещено использование типов Variant/Dynamic в ORDER BY" }
      ]
    }
  ]}
/>

Разрешает или запрещает использование типов [Variant](../../sql-reference/data-types/variant.md) и [Dynamic](../../sql-reference/data-types/dynamic.md) в ключах ORDER BY.


## allow_suspicious_variant_types {#allow_suspicious_variant_types}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "0" },
        {
          label:
            "По умолчанию запрещает создание типа Variant с подозрительными вариантами"
        }
      ]
    }
  ]}
/>

Позволяет указывать тип Variant с похожими вариантными типами в операторе CREATE TABLE (например, с различными числовыми типами или типами дат). Включение этой настройки может привести к неоднозначности при работе со значениями похожих типов.


## allow_unrestricted_reads_from_keeper {#allow_unrestricted_reads_from_keeper}

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает неограниченное чтение из таблицы system.zookeeper (без условия на путь). Может быть удобно, но небезопасно для ZooKeeper


## alter_move_to_space_execute_async {#alter_move_to_space_execute_async}

<SettingsInfoBlock type='Bool' default_value='0' />

Выполнять ALTER TABLE MOVE ... TO [DISK|VOLUME] асинхронно


## alter_partition_verbose_result {#alter_partition_verbose_result}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает вывод информации о частях, к которым были успешно применены операции с секциями и частями.
Применимо к [ATTACH PARTITION|PART](/sql-reference/statements/alter/partition#attach-partitionpart) и [FREEZE PARTITION](/sql-reference/statements/alter/partition#freeze-partition).

Возможные значения:

- 0 — отключить подробный вывод.
- 1 — включить подробный вывод.

**Пример**

```sql
CREATE TABLE test(a Int64, d Date, s String) ENGINE = MergeTree PARTITION BY toYYYYMDECLARE(d) ORDER BY a;
INSERT INTO test VALUES(1, '2021-01-01', '');
INSERT INTO test VALUES(1, '2021-01-01', '');
ALTER TABLE test DETACH PARTITION ID '202101';

ALTER TABLE test ATTACH PARTITION ID '202101' SETTINGS alter_partition_verbose_result = 1;

┌─command_type─────┬─partition_id─┬─part_name────┬─old_part_name─┐
│ ATTACH PARTITION │ 202101       │ 202101_7_7_0 │ 202101_5_5_0  │
│ ATTACH PARTITION │ 202101       │ 202101_8_8_0 │ 202101_6_6_0  │
└──────────────────┴──────────────┴──────────────┴───────────────┘

ALTER TABLE test FREEZE SETTINGS alter_partition_verbose_result = 1;

┌─command_type─┬─partition_id─┬─part_name────┬─backup_name─┬─backup_path───────────────────┬─part_backup_path────────────────────────────────────────────┐
│ FREEZE ALL   │ 202101       │ 202101_7_7_0 │ 8           │ /var/lib/clickhouse/shadow/8/ │ /var/lib/clickhouse/shadow/8/data/default/test/202101_7_7_0 │
│ FREEZE ALL   │ 202101       │ 202101_8_8_0 │ 8           │ /var/lib/clickhouse/shadow/8/ │ /var/lib/clickhouse/shadow/8/data/default/test/202101_8_8_0 │
└──────────────┴──────────────┴──────────────┴─────────────┴───────────────────────────────┴─────────────────────────────────────────────────────────────┘
```


## alter_sync {#alter_sync}

**Псевдонимы**: `replication_alter_partitions_sync`

<SettingsInfoBlock type='UInt64' default_value='1' />

Позволяет настроить ожидание выполнения действий на репликах для запросов [ALTER](../../sql-reference/statements/alter/index.md), [OPTIMIZE](../../sql-reference/statements/optimize.md) или [TRUNCATE](../../sql-reference/statements/truncate.md).

Возможные значения:

- `0` — Не ожидать.
- `1` — Ожидать собственного выполнения.
- `2` — Ожидать выполнения на всех репликах.

Значение по умолчанию в Cloud: `1`.

:::note
Настройка `alter_sync` применяется только к таблицам семейства `Replicated` и не влияет на операции изменения таблиц других типов.
:::


## alter_update_mode {#alter_update_mode}

<SettingsInfoBlock type='AlterUpdateMode' default_value='heavy' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.5" }, { label: "heavy" }, { label: "Новая настройка" }]
    }
  ]}
/>

Режим для запросов `ALTER`, содержащих команды `UPDATE`.

Возможные значения:

- `heavy` — выполнение обычной мутации.
- `lightweight` — выполнение облегчённого обновления, если возможно, в противном случае — обычной мутации.
- `lightweight_force` — выполнение облегчённого обновления, если возможно, в противном случае — генерация исключения.


## analyze_index_with_space_filling_curves {#analyze_index_with_space_filling_curves}

<SettingsInfoBlock type='Bool' default_value='1' />

Если таблица содержит кривую заполнения пространства в своём индексе, например `ORDER BY mortonEncode(x, y)` или `ORDER BY hilbertEncode(x, y)`, и запрос содержит условия на её аргументы, например `x >= 10 AND x <= 20 AND y >= 20 AND y <= 30`, то кривая заполнения пространства используется для анализа индекса.


## analyzer_compatibility_allow_compound_identifiers_in_unflatten_nested {#analyzer_compatibility_allow_compound_identifiers_in_unflatten_nested}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Позволяет добавлять составные идентификаторы во вложенные структуры. Это настройка совместимости, так как она изменяет результат запроса. При отключении запрос `SELECT a.b.c FROM table ARRAY JOIN a` не работает, а `SELECT a FROM table` не включает столбец `a.b.c` в результат `Nested a`.


## analyzer_compatibility_join_using_top_level_identifier {#analyzer_compatibility_join_using_top_level_identifier}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "0" },
        { label: "Принудительное разрешение идентификатора в JOIN USING из проекции" }
      ]
    }
  ]}
/>

Принудительное разрешение идентификатора в JOIN USING из проекции (например, в запросе `SELECT a + 1 AS b FROM t1 JOIN t2 USING (b)` соединение будет выполнено по условию `t1.a + 1 = t2.b`, а не `t1.b = t2.b`).


## any_join_distinct_right_table_keys {#any_join_distinct_right_table_keys}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "19.14" },
        { label: "0" },
        {
          label:
            "По умолчанию отключены ANY RIGHT и ANY FULL JOIN во избежание несогласованности"
        }
      ]
    }
  ]}
/>

Включает устаревшее поведение сервера ClickHouse в операциях `ANY INNER|LEFT JOIN`.

:::note
Используйте эту настройку только для обратной совместимости, если ваши сценарии использования зависят от устаревшего поведения `JOIN`.
:::

Когда устаревшее поведение включено:

- Результаты операций `t1 ANY LEFT JOIN t2` и `t2 ANY RIGHT JOIN t1` не равны, поскольку ClickHouse использует логику с отображением ключей таблиц «многие к одному» слева направо.
- Результаты операций `ANY INNER JOIN` содержат все строки из левой таблицы, как и операции `SEMI LEFT JOIN`.

Когда устаревшее поведение отключено:

- Результаты операций `t1 ANY LEFT JOIN t2` и `t2 ANY RIGHT JOIN t1` равны, поскольку ClickHouse использует логику, которая обеспечивает отображение ключей «один ко многим» в операциях `ANY RIGHT JOIN`.
- Результаты операций `ANY INNER JOIN` содержат по одной строке на ключ из левой и правой таблиц.

Возможные значения:

- 0 — Устаревшее поведение отключено.
- 1 — Устаревшее поведение включено.

См. также:

- [Строгость JOIN](/sql-reference/statements/select/join#settings)


## apply_deleted_mask {#apply_deleted_mask}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает фильтрацию строк, удалённых с помощью lightweight DELETE. Если параметр отключён, запрос сможет читать эти строки. Это полезно для отладки и сценариев восстановления удалённых данных


## apply_mutations_on_fly {#apply_mutations_on_fly}

<SettingsInfoBlock type='Bool' default_value='0' />

Если установлено значение true, мутации (UPDATE и DELETE), которые не материализованы в куске данных, будут применяться при выполнении SELECT-запросов.


## apply_patch_parts {#apply_patch_parts}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.5" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Если значение true, патч-части (представляющие легковесные обновления) применяются при выполнении SELECT-запросов.


## apply_patch_parts_join_cache_buckets {#apply_patch_parts_join_cache_buckets}

<SettingsInfoBlock type='NonZeroUInt64' default_value='8' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "8" }, { label: "Новая настройка" }]
    }
  ]}
/>

Количество сегментов во временном кэше для применения патч-частей в режиме Join.


## apply_settings_from_server {#apply_settings_from_server}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.2" },
        { label: "1" },
        {
          label:
            "Код на стороне клиента (например, парсинг входных данных INSERT и форматирование результатов запроса) будет использовать те же настройки, что и сервер, включая настройки из конфигурации сервера."
        }
      ]
    }
  ]}
/>

Определяет, должен ли клиент принимать настройки от сервера.

Эта настройка влияет только на операции, выполняемые на стороне клиента, в частности на парсинг входных данных INSERT и форматирование результатов запроса. Основная часть выполнения запроса происходит на сервере и не зависит от этой настройки.

Обычно эту настройку следует задавать в профиле пользователя (users.xml или с помощью запросов типа `ALTER USER`), а не через клиент (аргументы командной строки клиента, запрос `SET` или секция `SETTINGS` в запросе `SELECT`). Через клиент её можно изменить на false, но нельзя изменить на true (поскольку сервер не будет отправлять настройки, если в профиле пользователя установлено `apply_settings_from_server = false`).

Обратите внимание, что изначально (в версии 24.12) существовала серверная настройка (`send_settings_to_client`), но позднее она была заменена на эту клиентскую настройку для повышения удобства использования.


## arrow_flight_request_descriptor_type {#arrow_flight_request_descriptor_type}

<SettingsInfoBlock type='ArrowFlightDescriptorType' default_value='path' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "path" },
        {
          label:
            "Новая настройка. Тип дескриптора, используемого для запросов Arrow Flight: 'path' или 'command'. Для Dremio требуется 'command'."
        }
      ]
    }
  ]}
/>

Тип дескриптора, используемого для запросов Arrow Flight. Значение 'path' передаёт имя набора данных как дескриптор пути. Значение 'command' передаёт SQL-запрос как дескриптор команды (требуется для Dremio).

Возможные значения:

- 'path' — использовать FlightDescriptor::Path (по умолчанию, работает с большинством серверов Arrow Flight)
- 'command' — использовать FlightDescriptor::Command с запросом SELECT (требуется для Dremio)


## asterisk_include_alias_columns {#asterisk_include_alias_columns}

<SettingsInfoBlock type='Bool' default_value='0' />

Включать столбцы [ALIAS](../../sql-reference/statements/create/table.md/#alias) в запросы с подстановочным символом (`SELECT *`).

Возможные значения:

- 0 — отключено
- 1 — включено


## asterisk_include_materialized_columns {#asterisk_include_materialized_columns}

<SettingsInfoBlock type='Bool' default_value='0' />

Включать [MATERIALIZED](/sql-reference/statements/create/view#materialized-view) столбцы в запросы с подстановочным знаком (`SELECT *`).

Возможные значения:

- 0 — отключено
- 1 — включено


## async_insert {#async_insert}

<SettingsInfoBlock type='Bool' default_value='0' />

Если установлено значение true, данные из запроса INSERT помещаются в очередь и затем асинхронно записываются в таблицу в фоновом режиме. Если параметр wait_for_async_insert имеет значение false, запрос INSERT обрабатывается практически мгновенно, в противном случае клиент ожидает завершения записи данных в таблицу


## async_insert_busy_timeout_decrease_rate {#async_insert_busy_timeout_decrease_rate}

<SettingsInfoBlock type='Double' default_value='0.2' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "0.2" },
        {
          label:
            "Экспоненциальная скорость уменьшения адаптивного таймаута асинхронной вставки"
        }
      ]
    }
  ]}
/>

Экспоненциальная скорость уменьшения адаптивного таймаута асинхронной вставки


## async_insert_busy_timeout_increase_rate {#async_insert_busy_timeout_increase_rate}

<SettingsInfoBlock type='Double' default_value='0.2' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "0.2" },
        {
          label:
            "Скорость экспоненциального роста адаптивного таймаута асинхронной вставки"
        }
      ]
    }
  ]}
/>

Скорость экспоненциального роста адаптивного таймаута асинхронной вставки


## async_insert_busy_timeout_max_ms {#async_insert_busy_timeout_max_ms}

**Псевдонимы**: `async_insert_busy_timeout_ms`

<SettingsInfoBlock type='Milliseconds' default_value='200' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "200" },
        {
          label:
            "Минимальное значение тайм-аута асинхронной вставки в миллисекундах; async_insert_busy_timeout_ms является псевдонимом async_insert_busy_timeout_max_ms"
        }
      ]
    }
  ]}
/>

Максимальное время ожидания перед сбросом накопленных данных по запросу с момента появления первых данных.


## async_insert_busy_timeout_min_ms {#async_insert_busy_timeout_min_ms}

<SettingsInfoBlock type='Milliseconds' default_value='50' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "50" },
        {
          label:
            "Минимальное значение таймаута асинхронной вставки в миллисекундах; также служит начальным значением, которое может быть увеличено адаптивным алгоритмом"
        }
      ]
    }
  ]}
/>

Если автонастройка включена через async_insert_use_adaptive_busy_timeout, минимальное время ожидания перед сбросом накопленных данных на запрос с момента поступления первых данных. Также служит начальным значением для адаптивного алгоритма


## async_insert_deduplicate {#async_insert_deduplicate}

<SettingsInfoBlock type='Bool' default_value='0' />

Для асинхронных INSERT-запросов в реплицируемой таблице определяет, должна ли выполняться дедупликация вставляемых блоков


## async_insert_max_data_size {#async_insert_max_data_size}

<SettingsInfoBlock type='UInt64' default_value='10485760' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "10485760" },
        { label: "Предыдущее значение оказалось слишком маленьким." }
      ]
    }
  ]}
/>

Максимальный размер в байтах неразобранных данных, накопленных для одного запроса перед вставкой


## async_insert_max_query_number {#async_insert_max_query_number}

<SettingsInfoBlock type='UInt64' default_value='450' />

Максимальное количество запросов INSERT перед выполнением вставки.
Применяется только при значении настройки [`async_insert_deduplicate`](#async_insert_deduplicate) равном 1.


## async_insert_poll_timeout_ms {#async_insert_poll_timeout_ms}

<SettingsInfoBlock type='Milliseconds' default_value='10' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "10" },
        {
          label:
            "Таймаут в миллисекундах для опроса данных из очереди асинхронных вставок"
        }
      ]
    }
  ]}
/>

Таймаут опроса данных из очереди асинхронных вставок


## async_insert_use_adaptive_busy_timeout {#async_insert_use_adaptive_busy_timeout}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "1" },
        { label: "Использование адаптивного таймаута для асинхронных вставок" }
      ]
    }
  ]}
/>

Если установлено значение true, для асинхронных вставок используется адаптивный таймаут ожидания


## async_query_sending_for_remote {#async_query_sending_for_remote}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.3" },
        { label: "1" },
        { label: "Создание соединений и асинхронная отправка запросов по шардам" }
      ]
    }
  ]}
/>

Включает асинхронное создание соединений и отправку запросов при выполнении удалённых запросов.

Включено по умолчанию.


## async_socket_for_remote {#async_socket_for_remote}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "21.5" },
        { label: "1" },
        {
          label:
            "Исправлены все проблемы, асинхронное чтение из сокета для удалённых запросов снова включено по умолчанию"
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "21.3" },
        { label: "0" },
        {
          label:
            "Асинхронное чтение из сокета для удалённых запросов отключено из-за обнаруженных проблем"
        }
      ]
    }
  ]}
/>

Включает асинхронное чтение из сокета при выполнении удалённых запросов.

Включено по умолчанию.


## azure_allow_parallel_part_upload {#azure_allow_parallel_part_upload}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.4" },
        { label: "true" },
        { label: "Использовать несколько потоков для многочастной загрузки в Azure." }
      ]
    }
  ]}
/>

Использовать несколько потоков для многочастной загрузки в Azure.


## azure_check_objects_after_upload {#azure_check_objects_after_upload}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.11" },
        { label: "0" },
        {
          label:
            "Проверять каждый загруженный объект в Azure Blob Storage для подтверждения успешной загрузки"
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.10" },
        { label: "0" },
        {
          label:
            "Проверять каждый загруженный объект в Azure Blob Storage для подтверждения успешной загрузки"
        }
      ]
    }
  ]}
/>

Проверять каждый загруженный объект в Azure Blob Storage для подтверждения успешной загрузки


## azure_connect_timeout_ms {#azure_connect_timeout_ms}

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "1000" }, { label: "Новая настройка" }]
    }
  ]}
/>

Тайм-аут подключения к хосту дисков Azure.


## azure_create_new_file_on_insert {#azure_create_new_file_on_insert}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает создание нового файла при каждой операции INSERT в таблицы с движком Azure


## azure_ignore_file_doesnt_exist {#azure_ignore_file_doesnt_exist}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        {
          label:
            "Позволяет возвращать 0 строк, если запрашиваемые файлы не существуют, вместо генерации исключения в движке таблиц AzureBlobStorage"
        }
      ]
    }
  ]}
/>

Игнорировать отсутствие файла при чтении определённых ключей, если он не существует.

Возможные значения:

- 1 — `SELECT` возвращает пустой результат.
- 0 — `SELECT` генерирует исключение.


## azure_list_object_keys_size {#azure_list_object_keys_size}

<SettingsInfoBlock type='UInt64' default_value='1000' />

Максимальное количество файлов, которые могут быть возвращены в одном пакете по запросу ListObject


## azure_max_blocks_in_multipart_upload {#azure_max_blocks_in_multipart_upload}

<SettingsInfoBlock type='UInt64' default_value='50000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.5" },
        { label: "50000" },
        { label: "Максимальное количество блоков при многочастной загрузке для Azure." }
      ]
    }
  ]}
/>

Максимальное количество блоков при многочастной загрузке для Azure.


## azure_max_get_burst {#azure_max_get_burst}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Максимальное количество запросов, которые могут быть отправлены одновременно до достижения ограничения на количество запросов в секунду. По умолчанию (0) равно `azure_max_get_rps`


## azure_max_get_rps {#azure_max_get_rps}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Ограничение на количество GET-запросов к Azure в секунду до применения троттлинга. Ноль означает отсутствие ограничений.


## azure_max_inflight_parts_for_one_file {#azure_max_inflight_parts_for_one_file}

<SettingsInfoBlock type='UInt64' default_value='20' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "20" },
        {
          label:
            "Максимальное количество одновременно загружаемых частей в запросе многочастичной загрузки. 0 означает отсутствие ограничений."
        }
      ]
    }
  ]}
/>

Максимальное количество одновременно загружаемых частей в запросе многочастичной загрузки. 0 означает отсутствие ограничений.


## azure_max_put_burst {#azure_max_put_burst}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Максимальное количество запросов, которые могут быть отправлены одновременно до достижения ограничения на количество запросов в секунду. По умолчанию (0) равно `azure_max_put_rps`


## azure_max_put_rps {#azure_max_put_rps}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Ограничение на количество PUT-запросов к Azure в секунду до применения троттлинга. Ноль означает отсутствие ограничений.


## azure_max_redirects {#azure_max_redirects}

<SettingsInfoBlock type='UInt64' default_value='10' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "10" }, { label: "Новая настройка" }]
    }
  ]}
/>

Максимальное количество разрешённых переходов по перенаправлениям Azure.


## azure_max_single_part_copy_size {#azure_max_single_part_copy_size}

<SettingsInfoBlock type='UInt64' default_value='268435456' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "268435456" },
        {
          label:
            "Максимальный размер объекта для копирования в Azure Blob Storage с использованием одночастного копирования."
        }
      ]
    }
  ]}
/>

Максимальный размер объекта для копирования в Azure Blob Storage с использованием одночастного копирования.


## azure_max_single_part_upload_size {#azure_max_single_part_upload_size}

<SettingsInfoBlock type='UInt64' default_value='33554432' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.8" },
        { label: "33554432" },
        { label: "Приведено в соответствие с S3" }
      ]
    }
  ]}
/>

Максимальный размер объекта для загрузки в хранилище Azure Blob Storage с использованием однокомпонентной загрузки.


## azure_max_single_read_retries {#azure_max_single_read_retries}

<SettingsInfoBlock type='UInt64' default_value='4' />

Максимальное количество повторных попыток при одиночной операции чтения из хранилища Azure Blob Storage.


## azure_max_unexpected_write_error_retries {#azure_max_unexpected_write_error_retries}

<SettingsInfoBlock type='UInt64' default_value='4' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.1" },
        { label: "4" },
        {
          label:
            "Максимальное количество повторных попыток в случае непредвиденных ошибок при записи в хранилище Azure Blob Storage"
        }
      ]
    }
  ]}
/>

Максимальное количество повторных попыток в случае непредвиденных ошибок при записи в хранилище Azure Blob Storage


## azure_max_upload_part_size {#azure_max_upload_part_size}

<SettingsInfoBlock type='UInt64' default_value='5368709120' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "5368709120" },
        {
          label:
            "Максимальный размер части для загрузки при многочастевой загрузке в хранилище Azure Blob Storage."
        }
      ]
    }
  ]}
/>

Максимальный размер части для загрузки при многочастевой загрузке в хранилище Azure Blob Storage.


## azure_min_upload_part_size {#azure_min_upload_part_size}

<SettingsInfoBlock type='UInt64' default_value='16777216' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "16777216" },
        {
          label:
            "Минимальный размер части для загрузки при многочастевой загрузке в хранилище Azure Blob Storage."
        }
      ]
    }
  ]}
/>

Минимальный размер части для загрузки при многочастевой загрузке в хранилище Azure Blob Storage.


## azure_request_timeout_ms {#azure_request_timeout_ms}

<SettingsInfoBlock type='UInt64' default_value='30000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "30000" }, { label: "Новая настройка" }]
    }
  ]}
/>

Тайм-аут простоя при отправке и получении данных в/из Azure. Операция завершается ошибкой, если один вызов TCP read или write блокируется дольше указанного времени.


## azure_sdk_max_retries {#azure_sdk_max_retries}

<SettingsInfoBlock type='UInt64' default_value='10' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "10" },
        { label: "Максимальное количество повторных попыток в Azure SDK" }
      ]
    }
  ]}
/>

Максимальное количество повторных попыток в Azure SDK


## azure_sdk_retry_initial_backoff_ms {#azure_sdk_retry_initial_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='10' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "10" },
        { label: "Минимальная задержка между повторными попытками в Azure SDK" }
      ]
    }
  ]}
/>

Минимальная задержка между повторными попытками в Azure SDK


## azure_sdk_retry_max_backoff_ms {#azure_sdk_retry_max_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "1000" },
        { label: "Максимальная задержка между повторными попытками в Azure SDK" }
      ]
    }
  ]}
/>

Максимальная задержка между повторными попытками в Azure SDK


## azure_skip_empty_files {#azure_skip_empty_files}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        { label: "Возможность пропуска пустых файлов в движке таблиц Azure" }
      ]
    }
  ]}
/>

Включает или отключает пропуск пустых файлов в движке Azure.

Возможные значения:

- 0 — `SELECT` генерирует исключение, если пустой файл несовместим с запрошенным форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.


## azure_strict_upload_part_size {#azure_strict_upload_part_size}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "0" },
        {
          label:
            "Точный размер части для загрузки при многочастной загрузке в хранилище Azure Blob Storage."
        }
      ]
    }
  ]}
/>

Точный размер части для загрузки при многочастной загрузке в хранилище Azure Blob Storage.


## azure_throw_on_zero_files_match {#azure_throw_on_zero_files_match}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        {
          label:
            "Позволяет генерировать ошибку, когда запрос ListObjects не находит ни одного файла в движке AzureBlobStorage, вместо возврата пустого результата запроса"
        }
      ]
    }
  ]}
/>

Генерировать ошибку, если по правилам раскрытия glob-шаблонов не найдено ни одного файла.

Возможные значения:

- 1 — `SELECT` генерирует исключение.
- 0 — `SELECT` возвращает пустой результат.


## azure_truncate_on_insert {#azure_truncate_on_insert}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает очистку таблицы перед вставкой данных в таблицах с движком Azure.


## azure_upload_part_size_multiply_factor {#azure_upload_part_size_multiply_factor}

<SettingsInfoBlock type='UInt64' default_value='2' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "2" },
        {
          label:
            "Умножает azure_min_upload_part_size на этот коэффициент каждый раз, когда azure_multiply_parts_count_threshold частей загружено из одной операции записи в хранилище Azure Blob Storage."
        }
      ]
    }
  ]}
/>

Умножает azure_min_upload_part_size на этот коэффициент каждый раз, когда azure_multiply_parts_count_threshold частей загружено из одной операции записи в хранилище Azure Blob Storage.


## azure_upload_part_size_multiply_parts_count_threshold {#azure_upload_part_size_multiply_parts_count_threshold}

<SettingsInfoBlock type='UInt64' default_value='500' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "500" },
        {
          label:
            "При каждой загрузке указанного количества частей в хранилище Azure Blob Storage значение azure_min_upload_part_size умножается на azure_upload_part_size_multiply_factor."
        }
      ]
    }
  ]}
/>

При каждой загрузке указанного количества частей в хранилище Azure Blob Storage значение azure_min_upload_part_size умножается на azure_upload_part_size_multiply_factor.


## azure_use_adaptive_timeouts {#azure_use_adaptive_timeouts}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

При значении `true` для всех запросов к Azure первые две попытки выполняются с уменьшенными таймаутами отправки и получения.
При значении `false` все попытки выполняются с одинаковыми таймаутами.


## backup_restore_batch_size_for_keeper_multi {#backup_restore_batch_size_for_keeper_multi}

<SettingsInfoBlock type='UInt64' default_value='1000' />

Максимальный размер пакета для множественного запроса к [Zoo]Keeper при создании резервной копии или восстановлении


## backup_restore_batch_size_for_keeper_multiread {#backup_restore_batch_size_for_keeper_multiread}

<SettingsInfoBlock type='UInt64' default_value='10000' />

Максимальный размер пакета для запроса multiread к [Zoo]Keeper при создании резервной копии или восстановлении


## backup_restore_failure_after_host_disconnected_for_seconds {#backup_restore_failure_after_host_disconnected_for_seconds}

<SettingsInfoBlock type='UInt64' default_value='3600' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.11" }, { label: "3600" }, { label: "Новая настройка." }]
    },
    {
      id: "row-2",
      items: [{ label: "24.10" }, { label: "3600" }, { label: "Новая настройка." }]
    }
  ]}
/>

Если хост во время выполнения операции BACKUP ON CLUSTER или RESTORE ON CLUSTER не воссоздаёт свой эфемерный узел 'alive' в ZooKeeper в течение указанного времени, вся операция резервного копирования или восстановления считается неудачной.
Это значение должно превышать любое разумное время, необходимое хосту для повторного подключения к ZooKeeper после сбоя.
Нулевое значение означает отсутствие ограничений.


## backup_restore_finish_timeout_after_error_sec {#backup_restore_finish_timeout_after_error_sec}

<SettingsInfoBlock type='UInt64' default_value='180' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.11" }, { label: "180" }, { label: "Новая настройка." }]
    },
    {
      id: "row-2",
      items: [{ label: "24.10" }, { label: "180" }, { label: "Новая настройка." }]
    }
  ]}
/>

Время ожидания инициатором реакции других хостов на узел 'error' и остановки их работы в текущей операции BACKUP ON CLUSTER или RESTORE ON CLUSTER.


## backup_restore_keeper_fault_injection_probability {#backup_restore_keeper_fault_injection_probability}

<SettingsInfoBlock type='Float' default_value='0' />

Приблизительная вероятность сбоя запроса к keeper при выполнении резервного копирования или восстановления. Допустимое значение находится в интервале [0.0f, 1.0f]


## backup_restore_keeper_fault_injection_seed {#backup_restore_keeper_fault_injection_seed}

<SettingsInfoBlock type='UInt64' default_value='0' />

0 — случайное начальное значение (seed), в противном случае — значение настройки


## backup_restore_keeper_max_retries {#backup_restore_keeper_max_retries}

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.11" },
        { label: "1000" },
        {
          label:
            "Должно быть достаточно большим, чтобы вся операция BACKUP или RESTORE не завершилась ошибкой из-за временного сбоя [Zoo]Keeper в процессе её выполнения."
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.10" },
        { label: "1000" },
        {
          label:
            "Должно быть достаточно большим, чтобы вся операция BACKUP или RESTORE не завершилась ошибкой из-за временного сбоя [Zoo]Keeper в процессе её выполнения."
        }
      ]
    }
  ]}
/>

Максимальное количество повторных попыток для операций [Zoo]Keeper в процессе выполнения операции BACKUP или RESTORE.
Должно быть достаточно большим, чтобы вся операция не завершилась ошибкой из-за временного сбоя [Zoo]Keeper.


## backup_restore_keeper_max_retries_while_handling_error {#backup_restore_keeper_max_retries_while_handling_error}

<SettingsInfoBlock type='UInt64' default_value='20' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.11" }, { label: "20" }, { label: "Новая настройка." }]
    },
    {
      id: "row-2",
      items: [{ label: "24.10" }, { label: "20" }, { label: "Новая настройка." }]
    }
  ]}
/>

Максимальное количество повторных попыток операций [Zoo]Keeper при обработке ошибки операции BACKUP ON CLUSTER или RESTORE ON CLUSTER.


## backup_restore_keeper_max_retries_while_initializing {#backup_restore_keeper_max_retries_while_initializing}

<SettingsInfoBlock type='UInt64' default_value='20' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.11" }, { label: "20" }, { label: "Новая настройка." }]
    },
    {
      id: "row-2",
      items: [{ label: "24.10" }, { label: "20" }, { label: "Новая настройка." }]
    }
  ]}
/>

Максимальное количество повторных попыток выполнения операций [Zoo]Keeper при инициализации операции BACKUP ON CLUSTER или RESTORE ON CLUSTER.


## backup_restore_keeper_retry_initial_backoff_ms {#backup_restore_keeper_retry_initial_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='100' />

Начальный таймаут задержки для операций [Zoo]Keeper при резервном копировании или восстановлении


## backup_restore_keeper_retry_max_backoff_ms {#backup_restore_keeper_retry_max_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='5000' />

Максимальный таймаут задержки для операций [Zoo]Keeper при резервном копировании или восстановлении


## backup_restore_keeper_value_max_size {#backup_restore_keeper_value_max_size}

<SettingsInfoBlock type='UInt64' default_value='1048576' />

Максимальный размер данных узла [Zoo]Keeper при создании резервной копии


## backup_restore_s3_retry_attempts {#backup_restore_s3_retry_attempts}

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "1000" },
        {
          label:
            "Настройка для Aws::Client::RetryStrategy. Aws::Client самостоятельно выполняет повторные попытки, значение 0 означает отсутствие повторных попыток. Применяется только для операций резервного копирования и восстановления."
        }
      ]
    }
  ]}
/>

Настройка для Aws::Client::RetryStrategy. Aws::Client самостоятельно выполняет повторные попытки, значение 0 означает отсутствие повторных попыток. Применяется только для операций резервного копирования и восстановления.


## backup_restore_s3_retry_initial_backoff_ms {#backup_restore_s3_retry_initial_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='25' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "25" }, { label: "Новая настройка" }]
    }
  ]}
/>

    Начальная задержка в миллисекундах перед первой попыткой повтора при выполнении резервного копирования и восстановления. Каждая последующая попытка увеличивает задержку экспоненциально до максимального значения, заданного параметром `backup_restore_s3_retry_max_backoff_ms`


## backup_restore_s3_retry_jitter_factor {#backup_restore_s3_retry_jitter_factor}

<SettingsInfoBlock type='Float' default_value='0.1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0.1" }, { label: "Новая настройка" }]
    }
  ]}
/>

    Коэффициент джиттера, применяемый к задержке между повторными попытками в Aws::Client::RetryStrategy во время операций резервного копирования и восстановления. Вычисленная задержка умножается на случайный коэффициент в диапазоне [1.0, 1.0 + jitter] до максимального значения `backup_restore_s3_retry_max_backoff_ms`. Должен находиться в интервале [0.0, 1.0]


## backup_restore_s3_retry_max_backoff_ms {#backup_restore_s3_retry_max_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='5000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "5000" }, { label: "Новая настройка" }]
    }
  ]}
/>

    Максимальная задержка в миллисекундах между повторными попытками при выполнении операций резервного копирования и восстановления.


## backup_slow_all_threads_after_retryable_s3_error {#backup_slow_all_threads_after_retryable_s3_error}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка" }]
    },
    {
      id: "row-2",
      items: [{ label: "25.6" }, { label: "0" }, { label: "Новая настройка" }]
    },
    {
      id: "row-3",
      items: [
        { label: "25.10" },
        { label: "0" },
        { label: "Настройка отключена по умолчанию" }
      ]
    }
  ]}
/>

При значении `true` все потоки, выполняющие S3-запросы к одной конечной точке резервного копирования, замедляются
после того, как любой S3-запрос получает повторяемую ошибку S3, например 'Slow Down'.
При значении `false` каждый поток обрабатывает отсрочку S3-запросов независимо от остальных.


## cache_warmer_threads {#cache_warmer_threads}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='4' />

Действует только в ClickHouse Cloud. Количество фоновых потоков для упреждающей загрузки новых кусков данных в файловый кеш при включённой настройке [cache_populated_by_fetch](merge-tree-settings.md/#cache_populated_by_fetch). Укажите ноль для отключения.


## calculate_text_stack_trace {#calculate_text_stack_trace}

<SettingsInfoBlock type='Bool' default_value='1' />

Вычислять текстовый стек вызовов в случае возникновения исключений при выполнении запроса. Это поведение по умолчанию. Требует поиска символов, что может замедлить фаззинг-тесты при выполнении большого количества некорректных запросов. В обычных случаях не рекомендуется отключать эту опцию.


## cancel_http_readonly_queries_on_client_close {#cancel_http_readonly_queries_on_client_close}

<SettingsInfoBlock type='Bool' default_value='0' />

Отменяет HTTP-запросы только для чтения (например, SELECT), когда клиент закрывает соединение, не дожидаясь ответа.

Значение по умолчанию в Cloud: `0`.


## cast_ipv4_ipv6_default_on_conversion_error {#cast_ipv4_ipv6_default_on_conversion_error}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "22.3" },
        { label: "0" },
        {
          label:
            "Функции cast(value, 'IPv4') и cast(value, 'IPv6') ведут себя так же, как функции toIPv4 и toIPv6"
        }
      ]
    }
  ]}
/>

Оператор CAST в тип IPv4, оператор CAST в тип IPv6, функции toIPv4, toIPv6 возвращают значение по умолчанию вместо генерации исключения при ошибке преобразования.


## cast_keep_nullable {#cast_keep_nullable}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает сохранение типа данных `Nullable` в операциях [CAST](/sql-reference/functions/type-conversion-functions#cast).

Когда настройка включена и аргумент функции `CAST` имеет тип `Nullable`, результат также преобразуется в тип `Nullable`. Когда настройка отключена, результат всегда имеет в точности указанный целевой тип.

Возможные значения:

- 0 — Результат `CAST` имеет в точности указанный целевой тип.
- 1 — Если тип аргумента `Nullable`, результат `CAST` преобразуется в `Nullable(DestinationDataType)`.

**Примеры**

Следующий запрос возвращает в точности целевой тип данных:

```sql
SET cast_keep_nullable = 0;
SELECT CAST(toNullable(toInt32(0)) AS Int32) as x, toTypeName(x);
```

Результат:

```text
┌─x─┬─toTypeName(CAST(toNullable(toInt32(0)), 'Int32'))─┐
│ 0 │ Int32                                             │
└───┴───────────────────────────────────────────────────┘
```

Следующий запрос возвращает модификацию `Nullable` целевого типа данных:

```sql
SET cast_keep_nullable = 1;
SELECT CAST(toNullable(toInt32(0)) AS Int32) as x, toTypeName(x);
```

Результат:

```text
┌─x─┬─toTypeName(CAST(toNullable(toInt32(0)), 'Int32'))─┐
│ 0 │ Nullable(Int32)                                   │
└───┴───────────────────────────────────────────────────┘
```

**См. также**

- Функция [CAST](/sql-reference/functions/type-conversion-functions#cast)


## cast_string_to_date_time_mode {#cast_string_to_date_time_mode}

<SettingsInfoBlock type='DateTimeInputFormat' default_value='basic' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "basic" },
        {
          label:
            "Позволяет использовать различные режимы разбора DateTime при приведении типа из String в DateTime"
        }
      ]
    }
  ]}
/>

Позволяет выбрать парсер текстового представления даты и времени при приведении типа из String.

Возможные значения:

- `'best_effort'` — Включает расширенный разбор.

  ClickHouse может разбирать базовый формат `YYYY-MM-DD HH:MM:SS` и все форматы даты и времени [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601). Например, `'2018-06-08T01:02:03.000Z'`.

- `'best_effort_us'` — Аналогично `best_effort` (см. различие в [parseDateTimeBestEffortUS](../../sql-reference/functions/type-conversion-functions#parsedatetimebesteffortus))

- `'basic'` — Использует базовый парсер.

  ClickHouse может разбирать только базовый формат `YYYY-MM-DD HH:MM:SS` или `YYYY-MM-DD`. Например, `2019-08-20 10:18:56` или `2019-08-20`.

См. также:

- [Тип данных DateTime.](../../sql-reference/data-types/datetime.md)
- [Функции для работы с датами и временем.](../../sql-reference/functions/date-time-functions.md)


## cast_string_to_dynamic_use_inference {#cast_string_to_dynamic_use_inference}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.5" },
        { label: "0" },
        {
          label:
            "Добавлена настройка для преобразования String в Dynamic через парсинг"
        }
      ]
    }
  ]}
/>

Использовать вывод типов при преобразовании String в Dynamic


## cast_string_to_variant_use_inference {#cast_string_to_variant_use_inference}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.4" },
        { label: "1" },
        {
          label:
            "Новая настройка для включения/отключения вывода типов при приведении типа CAST из String в Variant"
        }
      ]
    }
  ]}
/>

Использовать вывод типов при преобразовании String в Variant.


## check_query_single_value_result {#check_query_single_value_result}

<SettingsInfoBlock type='Bool' default_value='1' />

Определяет уровень детализации результата запроса [CHECK TABLE](/sql-reference/statements/check-table) для движков семейства `MergeTree`.

Возможные значения:

- 0 — запрос выводит статус проверки для каждого отдельного куска данных таблицы.
- 1 — запрос выводит общий статус проверки таблицы.


## check_referential_table_dependencies {#check_referential_table_dependencies}

<SettingsInfoBlock type='Bool' default_value='0' />

Проверять, что DDL-запрос (такой как DROP TABLE или RENAME) не нарушит ссылочные зависимости


## check_table_dependencies {#check_table_dependencies}

<SettingsInfoBlock type='Bool' default_value='1' />

Проверять, что DDL-запрос (такой как DROP TABLE или RENAME) не нарушит зависимости


## checksum_on_read {#checksum_on_read}

<SettingsInfoBlock type='Bool' default_value='1' />

Проверять контрольные суммы при чтении. Включено по умолчанию и должно быть всегда включено в производственной среде. Не следует ожидать каких-либо преимуществ от отключения этой настройки. Она может использоваться только для экспериментов и тестирования производительности. Настройка применима только к таблицам семейства MergeTree. Контрольные суммы всегда проверяются для других движков таблиц и при получении данных по сети.


## cloud_mode {#cloud_mode}

<SettingsInfoBlock type='Bool' default_value='0' />

Облачный режим


## cloud_mode_database_engine {#cloud_mode_database_engine}

<SettingsInfoBlock type='UInt64' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "1" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Движок базы данных, разрешённый в Cloud. 1 — переписывать DDL-запросы для использования движка Replicated, 2 — переписывать DDL-запросы для использования движка Shared


## cloud_mode_engine {#cloud_mode_engine}

<SettingsInfoBlock type='UInt64' default_value='1' />

Семейство движков, разрешённых в Cloud.

- 0 — разрешить все
- 1 — переписывать DDL-запросы для использования \*ReplicatedMergeTree
- 2 — переписывать DDL-запросы для использования SharedMergeTree
- 3 — переписывать DDL-запросы для использования SharedMergeTree, кроме случаев, когда явно указан удалённый диск

UInt64 для минимизации публичной части


## cluster_for_parallel_replicas {#cluster_for_parallel_replicas}

<BetaBadge />

Кластер для шарда, в котором находится текущий сервер


## cluster_function_process_archive_on_multiple_nodes {#cluster_function_process_archive_on_multiple_nodes}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.7" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

При значении `true` повышает производительность обработки архивов в кластерных функциях. Следует установить значение `false` для обеспечения совместимости и предотвращения ошибок при обновлении до версии 25.7+, если кластерные функции с архивами использовались в более ранних версиях.


## cluster_table_function_buckets_batch_size {#cluster_table_function_buckets_batch_size}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Определяет приблизительный размер пакета (в байтах), используемого при распределённой обработке задач в табличных функциях кластера с гранулярностью разделения `bucket`. Система накапливает данные до тех пор, пока не будет достигнут как минимум этот объём. Фактический размер может быть немного больше для выравнивания по границам данных.


## cluster_table_function_split_granularity {#cluster_table_function_split_granularity}

<SettingsInfoBlock type='ObjectStorageGranularityLevel' default_value='file' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "file" }, { label: "Новая настройка." }]
    }
  ]}
/>

Управляет разделением данных на задачи при выполнении CLUSTER TABLE FUNCTION.

Эта настройка определяет степень детализации распределения работы по кластеру:

- `file` — каждая задача обрабатывает целый файл.
- `bucket` — задачи создаются для каждого внутреннего блока данных в файле (например, для групп строк Parquet).

Выбор более детальной гранулярности (например, `bucket`) может улучшить параллелизм при работе с небольшим количеством крупных файлов.
Например, если файл Parquet содержит несколько групп строк, включение гранулярности `bucket` позволяет обрабатывать каждую группу независимо разными рабочими процессами.


## collect_hash_table_stats_during_aggregation {#collect_hash_table_stats_during_aggregation}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает сбор статистики хеш-таблицы для оптимизации выделения памяти


## collect_hash_table_stats_during_joins {#collect_hash_table_stats_during_joins}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.7" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Включить сбор статистики хеш-таблицы для оптимизации выделения памяти


## compatibility {#compatibility}

Настройка `compatibility` заставляет ClickHouse использовать настройки по умолчанию из предыдущей версии ClickHouse, номер которой указывается в качестве значения настройки.

Если настройки установлены в значения, отличные от значений по умолчанию, то эти настройки сохраняются (настройка `compatibility` влияет только на те настройки, которые не были изменены).

Эта настройка принимает номер версии ClickHouse в виде строки, например `22.3`, `22.8`. Пустое значение означает, что настройка отключена.

По умолчанию отключена.

:::note
В ClickHouse Cloud настройка compatibility по умолчанию на уровне сервиса должна быть установлена службой поддержки ClickHouse Cloud. Пожалуйста, [создайте обращение](https://clickhouse.cloud/support) для её установки.
Однако настройка compatibility может быть переопределена на уровне пользователя, роли, профиля, запроса или сессии с использованием стандартных механизмов настроек ClickHouse, таких как `SET compatibility = '22.3'` в сессии или `SETTINGS compatibility = '22.3'` в запросе.
:::


## compatibility_ignore_auto_increment_in_create_table {#compatibility_ignore_auto_increment_in_create_table}

<SettingsInfoBlock type='Bool' default_value='0' />

Если установлено значение true, ключевое слово AUTO_INCREMENT в объявлении столбца игнорируется, в противном случае возвращается ошибка. Упрощает миграцию из MySQL


## compatibility_ignore_collation_in_create_table {#compatibility_ignore_collation_in_create_table}

<SettingsInfoBlock type='Bool' default_value='1' />

Игнорировать collation при создании таблицы для обеспечения совместимости


## compile_aggregate_expressions {#compile_aggregate_expressions}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает JIT-компиляцию агрегатных функций в машинный код. Включение этой настройки может повысить производительность.

Возможные значения:

- 0 — агрегация выполняется без JIT-компиляции.
- 1 — агрегация выполняется с JIT-компиляцией.

**См. также**

- [min_count_to_compile_aggregate_expression](#min_count_to_compile_aggregate_expression)


## compile_expressions {#compile_expressions}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "1" },
        {
          label:
            "Мы считаем, что инфраструктура LLVM, на которой основан JIT-компилятор, достаточно стабильна для включения этой настройки по умолчанию."
        }
      ]
    }
  ]}
/>

Компилирует некоторые скалярные функции и операторы в нативный код.


## compile_sort_description {#compile_sort_description}

<SettingsInfoBlock type='Bool' default_value='1' />

Компилировать описание сортировки в машинный код.


## connect_timeout {#connect_timeout}

<SettingsInfoBlock type='Seconds' default_value='10' />

Время ожидания подключения при отсутствии реплик.


## connect_timeout_with_failover_ms {#connect_timeout_with_failover_ms}

<SettingsInfoBlock type='Milliseconds' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.4" },
        { label: "1000" },
        { label: "Увеличено значение времени ожидания подключения по умолчанию в связи с асинхронным подключением" }
      ]
    }
  ]}
/>

Время ожидания в миллисекундах для подключения к удалённому серверу при использовании движка таблиц Distributed, если в определении кластера используются секции 'shard' и 'replica'.
При неудачном подключении выполняется несколько попыток подключения к различным репликам.


## connect_timeout_with_failover_secure_ms {#connect_timeout_with_failover_secure_ms}

<SettingsInfoBlock type='Milliseconds' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.4" },
        { label: "1000" },
        {
          label:
            "Увеличено значение по умолчанию для тайм-аута защищённого соединения в связи с асинхронным подключением"
        }
      ]
    }
  ]}
/>

Тайм-аут подключения для выбора первой доступной реплики (для защищённых соединений).


## connection_pool_max_wait_ms {#connection_pool_max_wait_ms}

<SettingsInfoBlock type='Milliseconds' default_value='0' />

Время ожидания соединения в миллисекундах при заполненном пуле соединений.

Возможные значения:

- Положительное целое число.
- 0 — бесконечное ожидание.


## connections_with_failover_max_tries {#connections_with_failover_max_tries}

<SettingsInfoBlock type='UInt64' default_value='3' />

Максимальное количество попыток подключения к каждой реплике для движка таблиц Distributed.


## convert_query_to_cnf {#convert_query_to_cnf}

<SettingsInfoBlock type='Bool' default_value='0' />

При установке значения `true` запрос `SELECT` будет преобразован в конъюнктивную нормальную форму (КНФ). Существуют сценарии, в которых переписывание запроса в КНФ может выполняться быстрее (см. объяснение в этом [Github issue](https://github.com/ClickHouse/ClickHouse/issues/11749)).

Например, обратите внимание, что следующий запрос `SELECT` не изменяется (поведение по умолчанию):

```sql
EXPLAIN SYNTAX
SELECT *
FROM
(
    SELECT number AS x
    FROM numbers(20)
) AS a
WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15))
SETTINGS convert_query_to_cnf = false;
```

Результат:

```response
┌─explain────────────────────────────────────────────────────────┐
│ SELECT x                                                       │
│ FROM                                                           │
│ (                                                              │
│     SELECT number AS x                                         │
│     FROM numbers(20)                                           │
│     WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15)) │
│ ) AS a                                                         │
│ WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15))     │
│ SETTINGS convert_query_to_cnf = 0                              │
└────────────────────────────────────────────────────────────────┘
```

Установим `convert_query_to_cnf` в значение `true` и посмотрим, что изменится:

```sql
EXPLAIN SYNTAX
SELECT *
FROM
(
    SELECT number AS x
    FROM numbers(20)
) AS a
WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15))
SETTINGS convert_query_to_cnf = true;
```

Обратите внимание, что условие `WHERE` переписано в КНФ, но результирующий набор идентичен — булева логика не изменилась:

```response
┌─explain───────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ SELECT x                                                                                                              │
│ FROM                                                                                                                  │
│ (                                                                                                                     │
│     SELECT number AS x                                                                                                │
│     FROM numbers(20)                                                                                                  │
│     WHERE ((x <= 15) OR (x <= 5)) AND ((x <= 15) OR (x >= 1)) AND ((x >= 10) OR (x <= 5)) AND ((x >= 10) OR (x >= 1)) │
│ ) AS a                                                                                                                │
│ WHERE ((x >= 10) OR (x >= 1)) AND ((x >= 10) OR (x <= 5)) AND ((x <= 15) OR (x >= 1)) AND ((x <= 15) OR (x <= 5))     │
│ SETTINGS convert_query_to_cnf = 1                                                                                     │
└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

Возможные значения: true, false


## correlated_subqueries_default_join_kind {#correlated_subqueries_default_join_kind}

<SettingsInfoBlock type='DecorrelationJoinKind' default_value='right' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "right" },
        { label: "Новая настройка. Тип соединения по умолчанию для декоррелированного плана запроса." }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "25.10" },
        { label: "right" },
        { label: "Новая настройка. Тип соединения по умолчанию для декоррелированного плана запроса." }
      ]
    }
  ]}
/>

Управляет типом соединений в декоррелированном плане запроса. Значение по умолчанию — `right`, что означает, что декоррелированный план будет содержать RIGHT JOIN с подзапросом справа.

Возможные значения:

- `left` — процесс декорреляции будет создавать LEFT JOIN, при этом входная таблица будет располагаться слева.
- `right` — процесс декорреляции будет создавать RIGHT JOIN, при этом входная таблица будет располагаться справа.


## correlated_subqueries_substitute_equivalent_expressions {#correlated_subqueries_substitute_equivalent_expressions}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.7" },
        { label: "1" },
        { label: "Новая настройка для оптимизации планирования коррелированных подзапросов." }
      ]
    }
  ]}
/>

Использовать выражения фильтрации для вывода эквивалентных выражений и их подстановки вместо создания CROSS JOIN.


## count_distinct_implementation {#count_distinct_implementation}

<SettingsInfoBlock type='String' default_value='uniqExact' />

Определяет, какая из функций `uniq*` должна использоваться для выполнения конструкции [COUNT(DISTINCT ...)](/sql-reference/aggregate-functions/reference/count).

Возможные значения:

- [uniq](/sql-reference/aggregate-functions/reference/uniq)
- [uniqCombined](/sql-reference/aggregate-functions/reference/uniqcombined)
- [uniqCombined64](/sql-reference/aggregate-functions/reference/uniqcombined64)
- [uniqHLL12](/sql-reference/aggregate-functions/reference/uniqhll12)
- [uniqExact](/sql-reference/aggregate-functions/reference/uniqexact)


## count_distinct_optimization {#count_distinct_optimization}

<SettingsInfoBlock type='Bool' default_value='0' />

Переписывает COUNT DISTINCT в подзапрос с GROUP BY


## count_matches_stop_at_empty_match {#count_matches_stop_at_empty_match}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.6" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Останавливает подсчет при обнаружении совпадения нулевой длины в функции `countMatches`.


## create_if_not_exists {#create_if_not_exists}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.9" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Включает `IF NOT EXISTS` для оператора `CREATE` по умолчанию. Если указана эта настройка или `IF NOT EXISTS`, и таблица с указанным именем уже существует, исключение не будет сгенерировано.


## create_index_ignore_unique {#create_index_ignore_unique}

<SettingsInfoBlock type='Bool' default_value='0' />

Игнорирует ключевое слово UNIQUE в CREATE UNIQUE INDEX. Предназначено для тестов совместимости SQL.


## create_replicated_merge_tree_fault_injection_probability {#create_replicated_merge_tree_fault_injection_probability}

<SettingsInfoBlock type='Float' default_value='0' />

Вероятность инъекции сбоя при создании таблицы после создания метаданных в ZooKeeper


## create_table_empty_primary_key_by_default {#create_table_empty_primary_key_by_default}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "1" }, { label: "Повышение удобства использования" }]
    }
  ]}
/>

Разрешает создавать таблицы \*MergeTree с пустым первичным ключом, если не указаны предложения ORDER BY и PRIMARY KEY


## cross_join_min_bytes_to_compress {#cross_join_min_bytes_to_compress}

<SettingsInfoBlock type='UInt64' default_value='1073741824' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.5" },
        { label: "1073741824" },
        {
          label:
            "Минимальный размер блока для сжатия в CROSS JOIN. Нулевое значение означает отключение этого порога. Блок сжимается при достижении любого из двух порогов (по строкам или по байтам)."
        }
      ]
    }
  ]}
/>

Минимальный размер блока для сжатия в CROSS JOIN. Нулевое значение означает отключение этого порога. Блок сжимается при достижении любого из двух порогов (по строкам или по байтам).


## cross_join_min_rows_to_compress {#cross_join_min_rows_to_compress}

<SettingsInfoBlock type='UInt64' default_value='10000000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.5" },
        { label: "10000000" },
        {
          label:
            "Минимальное количество строк для сжатия блока в CROSS JOIN. Нулевое значение отключает этот порог. Блок сжимается при достижении любого из двух порогов (по строкам или по байтам)."
        }
      ]
    }
  ]}
/>

Минимальное количество строк для сжатия блока в CROSS JOIN. Нулевое значение отключает этот порог. Блок сжимается при достижении любого из двух порогов (по строкам или по байтам).


## data_type_default_nullable {#data_type_default_nullable}

<SettingsInfoBlock type='Bool' default_value='0' />

Позволяет типам данных без явных модификаторов [NULL или NOT NULL](/sql-reference/statements/create/table#null-or-not-null-modifiers) в определении столбца быть [Nullable](/sql-reference/data-types/nullable).

Возможные значения:

- 1 — Типы данных в определениях столбцов по умолчанию имеют тип `Nullable`.
- 0 — Типы данных в определениях столбцов по умолчанию не имеют тип `Nullable`.


## database_atomic_wait_for_drop_and_detach_synchronously {#database_atomic_wait_for_drop_and_detach_synchronously}

<SettingsInfoBlock type='Bool' default_value='0' />

Добавляет модификатор `SYNC` ко всем запросам `DROP` и `DETACH`.

Возможные значения:

- 0 — Запросы будут выполняться с задержкой.
- 1 — Запросы будут выполняться без задержки.


## database_replicated_allow_explicit_uuid {#database_replicated_allow_explicit_uuid}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.9" },
        { label: "0" },
        {
          label:
            "Добавлена новая настройка для запрета явного указания UUID таблицы"
        }
      ]
    }
  ]}
/>

0 - Запретить явное указание UUID для таблиц в реплицируемых базах данных. 1 - Разрешить. 2 - Разрешить, но игнорировать указанный UUID и генерировать случайный.


## database_replicated_allow_heavy_create {#database_replicated_allow_heavy_create}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "0" },
        {
          label:
            "Длительные DDL-запросы (CREATE AS SELECT и POPULATE) для движка базы данных Replicated были запрещены"
        }
      ]
    }
  ]}
/>

Разрешает выполнение длительных DDL-запросов (CREATE AS SELECT и POPULATE) в движке базы данных Replicated. Обратите внимание, что это может надолго заблокировать очередь DDL.


## database_replicated_allow_only_replicated_engine {#database_replicated_allow_only_replicated_engine}

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает создание только реплицируемых таблиц в базе данных с движком Replicated


## database_replicated_allow_replicated_engine_arguments {#database_replicated_allow_replicated_engine_arguments}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.9" },
        { label: "0" },
        { label: "Явные аргументы запрещены по умолчанию" }
      ]
    }
  ]}
/>

0 - Запрещает явное указание пути ZooKeeper и имени реплики для таблиц \*MergeTree в реплицируемых базах данных. 1 - Разрешает. 2 - Разрешает, но игнорирует указанный путь и использует путь по умолчанию. 3 - Разрешает без вывода предупреждения.


## database_replicated_always_detach_permanently {#database_replicated_always_detach_permanently}

<SettingsInfoBlock type='Bool' default_value='0' />

Выполнять DETACH TABLE как DETACH TABLE PERMANENTLY, если движок базы данных Replicated


## database_replicated_enforce_synchronous_settings {#database_replicated_enforce_synchronous_settings}

<SettingsInfoBlock type='Bool' default_value='0' />

Принудительно включает синхронное ожидание для некоторых запросов (см. также database_atomic_wait_for_drop_and_detach_synchronously, mutations_sync, alter_sync). Включение этих настроек не рекомендуется.


## database_replicated_initial_query_timeout_sec {#database_replicated_initial_query_timeout_sec}

<SettingsInfoBlock type='UInt64' default_value='300' />

Устанавливает время ожидания (в секундах) для начального DDL-запроса, пока реплицируемая база данных обрабатывает предыдущие записи в очереди DDL.

Возможные значения:

- Положительное целое число.
- 0 — без ограничений.


## database_shared_drop_table_delay_seconds {#database_shared_drop_table_delay_seconds}

<SettingsInfoBlock type='UInt64' default_value='28800' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "28800" }, { label: "Новая настройка." }]
    }
  ]}
/>

Задержка в секундах перед фактическим удалением таблицы из базы данных Shared. Позволяет восстановить таблицу в течение этого времени с помощью оператора `UNDROP TABLE`.


## decimal_check_overflow {#decimal_check_overflow}

<SettingsInfoBlock type='Bool' default_value='1' />

Проверка переполнения при арифметических операциях и операциях сравнения с типом decimal


## deduplicate_blocks_in_dependent_materialized_views {#deduplicate_blocks_in_dependent_materialized_views}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает проверку дедупликации для материализованных представлений, получающих данные из таблиц семейства Replicated\*.

Возможные значения:

      0 — Отключено.
      1 — Включено.

При включении ClickHouse выполняет дедупликацию блоков в материализованных представлениях, зависящих от таблиц семейства Replicated\*.
Эта настройка полезна для предотвращения появления дублирующихся данных в материализованных представлениях при повторных попытках операции вставки из-за сбоя.

**См. также**

- [Обработка NULL в операторах IN](/guides/developer/deduplicating-inserts-on-retries#insert-deduplication-with-materialized-views)


## default_materialized_view_sql_security {#default_materialized_view_sql_security}

<SettingsInfoBlock type='SQLSecurityType' default_value='DEFINER' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "DEFINER" },
        {
          label:
            "Позволяет задать значение по умолчанию для параметра SQL SECURITY при создании материализованного представления"
        }
      ]
    }
  ]}
/>

Позволяет задать значение по умолчанию для параметра SQL SECURITY при создании материализованного представления. [Подробнее о SQL security](../../sql-reference/statements/create/view.md/#sql_security).

Значение по умолчанию — `DEFINER`.


## default_max_bytes_in_join {#default_max_bytes_in_join}

<SettingsInfoBlock type='UInt64' default_value='1000000000' />

Максимальный размер правой таблицы, если требуется ограничение, но `max_bytes_in_join` не задан.


## default_normal_view_sql_security {#default_normal_view_sql_security}

<SettingsInfoBlock type='SQLSecurityType' default_value='INVOKER' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "INVOKER" },
        {
          label:
            "Позволяет задать параметр `SQL SECURITY` по умолчанию при создании обычного представления"
        }
      ]
    }
  ]}
/>

Позволяет задать параметр `SQL SECURITY` по умолчанию при создании обычного представления. [Подробнее о SQL-безопасности](../../sql-reference/statements/create/view.md/#sql_security).

Значение по умолчанию — `INVOKER`.


## default_table_engine {#default_table_engine}

<SettingsInfoBlock type='DefaultTableEngine' default_value='MergeTree' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "MergeTree" },
        { label: "Установлен движок таблицы по умолчанию MergeTree для улучшения удобства использования" }
      ]
    }
  ]}
/>

Движок таблицы по умолчанию, который используется, когда `ENGINE` не указан в операторе `CREATE`.

Возможные значения:

- строка, представляющая любое допустимое имя движка таблицы

Значение по умолчанию в Cloud: `SharedMergeTree`.

**Пример**

Запрос:

```sql
SET default_table_engine = 'Log';

SELECT name, value, changed FROM system.settings WHERE name = 'default_table_engine';
```

Результат:

```response
┌─name─────────────────┬─value─┬─changed─┐
│ default_table_engine │ Log   │       1 │
└──────────────────────┴───────┴─────────┘
```

В этом примере любая новая таблица, для которой не указан `Engine`, будет использовать движок `Log`:

Запрос:

```sql
CREATE TABLE my_table (
    x UInt32,
    y UInt32
);

SHOW CREATE TABLE my_table;
```

Результат:

```response
┌─statement────────────────────────────────────────────────────────────────┐
│ CREATE TABLE default.my_table
(
    `x` UInt32,
    `y` UInt32
)
ENGINE = Log
└──────────────────────────────────────────────────────────────────────────┘
```


## default_temporary_table_engine {#default_temporary_table_engine}

<SettingsInfoBlock type='DefaultTableEngine' default_value='Memory' />

Аналогично [default_table_engine](#default_table_engine), но для временных таблиц.

В этом примере любая новая временная таблица, в которой не указан параметр `Engine`, будет использовать движок `Log`:

Запрос:

```sql
SET default_temporary_table_engine = 'Log';

CREATE TEMPORARY TABLE my_table (
    x UInt32,
    y UInt32
);

SHOW CREATE TEMPORARY TABLE my_table;
```

Результат:

```response
┌─statement────────────────────────────────────────────────────────────────┐
│ CREATE TEMPORARY TABLE default.my_table
(
    `x` UInt32,
    `y` UInt32
)
ENGINE = Log
└──────────────────────────────────────────────────────────────────────────┘
```


## default_view_definer {#default_view_definer}

<SettingsInfoBlock type='String' default_value='CURRENT_USER' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "CURRENT_USER" },
        {
          label: "Позволяет задать параметр `DEFINER` по умолчанию при создании представления"
        }
      ]
    }
  ]}
/>

Позволяет задать параметр `DEFINER` по умолчанию при создании представления. [Подробнее о безопасности SQL](../../sql-reference/statements/create/view.md/#sql_security).

Значение по умолчанию — `CURRENT_USER`.


## delta_lake_enable_engine_predicate {#delta_lake_enable_engine_predicate}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Включает внутреннюю очистку данных delta-kernel.


## delta_lake_enable_expression_visitor_logging {#delta_lake_enable_expression_visitor_logging}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Включает журналирование уровня Test для обработчика выражений DeltaLake. Эти журналы могут быть слишком подробными даже для тестового журналирования.


## delta_lake_insert_max_bytes_in_data_file {#delta_lake_insert_max_bytes_in_data_file}

<SettingsInfoBlock type='NonZeroUInt64' default_value='1073741824' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.9" },
        { label: "1073741824" },
        { label: "Новая настройка." }
      ]
    }
  ]}
/>

Определяет ограничение размера в байтах для одного вставляемого файла данных в Delta Lake.


## delta_lake_insert_max_rows_in_data_file {#delta_lake_insert_max_rows_in_data_file}

<SettingsInfoBlock type='NonZeroUInt64' default_value='1000000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.9" },
        { label: "1000000" },
        { label: "Новая настройка." }
      ]
    }
  ]}
/>

Определяет ограничение на количество строк для одного вставляемого файла данных в Delta Lake.


## delta_lake_log_metadata {#delta_lake_log_metadata}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Включает запись файлов метаданных Delta Lake в системную таблицу.


## delta_lake_snapshot_version {#delta_lake_snapshot_version}

<SettingsInfoBlock type='Int64' default_value='-1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "-1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Версия снимка Delta Lake для чтения. Значение -1 означает чтение последней версии (значение 0 является допустимой версией снимка).


## delta_lake_throw_on_engine_predicate_error {#delta_lake_throw_on_engine_predicate_error}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Включает генерацию исключения при возникновении ошибки во время анализа предиката сканирования в delta-kernel.


## describe_compact_output {#describe_compact_output}

<SettingsInfoBlock type='Bool' default_value='0' />

Если true, в результат запроса DESCRIBE включаются только имена и типы столбцов


## describe_include_subcolumns {#describe_include_subcolumns}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает описание подстолбцов в запросе [DESCRIBE](../../sql-reference/statements/describe-table.md). Например, элементы [Tuple](../../sql-reference/data-types/tuple.md) или подстолбцы типов данных [Map](/sql-reference/data-types/map#reading-subcolumns-of-map), [Nullable](../../sql-reference/data-types/nullable.md/#finding-null) или [Array](../../sql-reference/data-types/array.md/#array-size).

Возможные значения:

- 0 — подстолбцы не включаются в запросы `DESCRIBE`;
- 1 — подстолбцы включаются в запросы `DESCRIBE`.

**Пример**

См. пример для оператора [DESCRIBE](../../sql-reference/statements/describe-table.md).


## describe_include_virtual_columns {#describe_include_virtual_columns}

<SettingsInfoBlock type='Bool' default_value='0' />

Если установлено значение true, виртуальные столбцы таблицы будут включены в результат запроса DESCRIBE


## dialect {#dialect}

<SettingsInfoBlock type='Dialect' default_value='clickhouse' />

Какой диалект будет использован для разбора запроса


## dictionary_validate_primary_key_type {#dictionary_validate_primary_key_type}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "0" },
        {
          label:
            "Проверять тип первичного ключа для словарей. По умолчанию тип идентификатора для простых структур будет неявно преобразован в UInt64."
        }
      ]
    }
  ]}
/>

Проверять тип первичного ключа для словарей. По умолчанию тип идентификатора для простых структур будет неявно преобразован в UInt64.


## distinct_overflow_mode {#distinct_overflow_mode}

<SettingsInfoBlock type='OverflowMode' default_value='throw' />

Определяет поведение при превышении объёма данных одного из ограничений.

Возможные значения:

- `throw`: выбросить исключение (по умолчанию).
- `break`: прекратить выполнение запроса и вернуть частичный результат, как если бы
  исходные данные закончились.


## distributed_aggregation_memory_efficient {#distributed_aggregation_memory_efficient}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает режим распределенной агрегации с экономией памяти.


## distributed_background_insert_batch {#distributed_background_insert_batch}

**Псевдонимы**: `distributed_directory_monitor_batch_inserts`

<SettingsInfoBlock type='Bool' default_value='0' />

Включает/отключает пакетную отправку вставляемых данных.

Когда пакетная отправка включена, движок таблиц [Distributed](../../engines/table-engines/special/distributed.md) пытается отправить несколько файлов вставляемых данных за одну операцию вместо их отдельной отправки. Пакетная отправка повышает производительность кластера за счёт более эффективного использования ресурсов сервера и сети.

Возможные значения:

- 1 — включено.
- 0 — отключено.


## distributed_background_insert_max_sleep_time_ms {#distributed_background_insert_max_sleep_time_ms}

**Псевдонимы**: `distributed_directory_monitor_max_sleep_time_ms`

<SettingsInfoBlock type='Milliseconds' default_value='30000' />

Максимальный интервал отправки данных движком таблиц [Distributed](../../engines/table-engines/special/distributed.md). Ограничивает экспоненциальный рост интервала, заданного в настройке [distributed_background_insert_sleep_time_ms](#distributed_background_insert_sleep_time_ms).

Возможные значения:

- Положительное целое число миллисекунд.


## distributed_background_insert_sleep_time_ms {#distributed_background_insert_sleep_time_ms}

**Псевдонимы**: `distributed_directory_monitor_sleep_time_ms`

<SettingsInfoBlock type='Milliseconds' default_value='100' />

Базовый интервал отправки данных для движка таблиц [Distributed](../../engines/table-engines/special/distributed.md). При возникновении ошибок фактический интервал увеличивается экспоненциально.

Возможные значения:

- Положительное целое число миллисекунд.


## distributed_background_insert_split_batch_on_failure {#distributed_background_insert_split_batch_on_failure}

**Псевдонимы**: `distributed_directory_monitor_split_batch_on_failure`

<SettingsInfoBlock type='Bool' default_value='0' />

Включает/отключает разделение пакетов при сбоях.

Иногда отправка определённого пакета на удалённый шард может завершиться неудачей из-за сложного конвейера обработки данных (например, `MATERIALIZED VIEW` с `GROUP BY`) вследствие ошибки `Memory limit exceeded` или аналогичных ошибок. В этом случае повторные попытки не помогут (и это заблокирует распределённые отправки для таблицы), но отправка файлов из этого пакета по одному может успешно выполнить INSERT.

Таким образом, установка этого параметра в `1` отключит пакетную обработку для таких пакетов (т.е. временно отключит `distributed_background_insert_batch` для неудавшихся пакетов).

Возможные значения:

- 1 — включено.
- 0 — отключено.

:::note
Этот параметр также влияет на повреждённые пакеты (которые могут появиться из-за аварийного завершения работы сервера (машины) и отсутствия `fsync_after_insert`/`fsync_directories` для движка таблиц [Distributed](../../engines/table-engines/special/distributed.md)).
:::

:::note
Не следует полагаться на автоматическое разделение пакетов, так как это может негативно сказаться на производительности.
:::


## distributed_background_insert_timeout {#distributed_background_insert_timeout}

**Псевдонимы**: `insert_distributed_timeout`

<SettingsInfoBlock type='UInt64' default_value='0' />

Таймаут для запроса INSERT в распределённую таблицу. Настройка используется только при включённой настройке insert_distributed_sync. Нулевое значение означает отсутствие таймаута.


## distributed_cache_alignment {#distributed_cache_alignment}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.7" },
        { label: "0" },
        { label: "Переименование из distributed_cache_read_alignment" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Настройка для тестирования, не изменяйте её


## distributed_cache_bypass_connection_pool {#distributed_cache_bypass_connection_pool}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "0" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Позволяет обходить пул соединений распределённого кэша


## distributed_cache_connect_backoff_max_ms {#distributed_cache_connect_backoff_max_ms}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='50' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "50" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Максимальное время отсрочки в миллисекундах при создании соединения с распределённым кэшем.


## distributed_cache_connect_backoff_min_ms {#distributed_cache_connect_backoff_min_ms}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Минимальное время задержки в миллисекундах перед повторной попыткой создания соединения с распределённым кешем.


## distributed_cache_connect_max_tries {#distributed_cache_connect_max_tries}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='5' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.8" },
        { label: "5" },
        { label: "Изменено значение настройки" }
      ]
    },
    {
      id: "row-2",
      items: [{ label: "25.1" }, { label: "20" }, { label: "Только для Cloud" }]
    },
    {
      id: "row-3",
      items: [
        { label: "24.10" },
        { label: "20" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Количество попыток подключения к распределённому кешу при неудачном соединении


## distributed_cache_connect_timeout_ms {#distributed_cache_connect_timeout_ms}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='50' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "50" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Время ожидания подключения к серверу распределённого кэша.


## distributed_cache_credentials_refresh_period_seconds {#distributed_cache_credentials_refresh_period_seconds}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='5' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "5" },
        { label: "Новая внутренняя настройка" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Период обновления учётных данных.


## distributed_cache_data_packet_ack_window {#distributed_cache_data_packet_ack_window}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='5' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "5" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Окно для отправки подтверждений (ACK) последовательности пакетов данных (DataPacket) в рамках одного запроса на чтение из распределённого кэша


## distributed_cache_discard_connection_if_unread_data {#distributed_cache_discard_connection_if_unread_data}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.11" }, { label: "1" }, { label: "Новая настройка" }]
    },
    {
      id: "row-2",
      items: [{ label: "24.10" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Разрывать соединение при наличии непрочитанных данных.


## distributed_cache_fetch_metrics_only_from_current_az {#distributed_cache_fetch_metrics_only_from_current_az}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "1" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Получать метрики только из текущей зоны доступности в таблицах system.distributed_cache_metrics, system.distributed_cache_events


## distributed_cache_log_mode {#distributed_cache_log_mode}

<CloudOnlyBadge />

<SettingsInfoBlock type='DistributedCacheLogMode' default_value='on_error' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "on_error" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Режим записи в system.distributed_cache_log


## distributed_cache_max_unacked_inflight_packets {#distributed_cache_max_unacked_inflight_packets}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='10' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "10" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Максимальное количество неподтверждённых пакетов в процессе передачи для одного запроса на чтение из распределённого кеша


## distributed_cache_min_bytes_for_seek {#distributed_cache_min_bytes_for_seek}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.1" },
        { label: "0" },
        { label: "Новая внутренняя настройка." }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Минимальное количество байтов для выполнения поиска в распределённом кеше.


## distributed_cache_pool_behaviour_on_limit {#distributed_cache_pool_behaviour_on_limit}

<CloudOnlyBadge />

<SettingsInfoBlock
  type='DistributedCachePoolBehaviourOnLimit'
  default_value='wait'
/>

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.1" }, { label: "wait" }, { label: "Cloud only" }]
    },
    {
      id: "row-2",
      items: [
        { label: "24.10" },
        { label: "allocate_bypassing_pool" },
        { label: "A setting for ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Определяет поведение подключения к распределённому кэшу при достижении лимита пула


## distributed_cache_prefer_bigger_buffer_size {#distributed_cache_prefer_bigger_buffer_size}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Аналогична настройке filesystem_cache_prefer_bigger_buffer_size, но применяется для распределённого кэша.


## distributed_cache_read_only_from_current_az {#distributed_cache_read_only_from_current_az}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.5" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Позволяет выполнять чтение только из текущей зоны доступности. Если отключено, чтение будет выполняться со всех серверов кэша во всех зонах доступности.


## distributed_cache_read_request_max_tries {#distributed_cache_read_request_max_tries}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='10' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.8" },
        { label: "10" },
        { label: "Изменено значение настройки" }
      ]
    },
    {
      id: "row-2",
      items: [{ label: "25.4" }, { label: "20" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Количество попыток выполнения запроса к распределённому кешу при неудачном выполнении


## distributed_cache_receive_response_wait_milliseconds {#distributed_cache_receive_response_wait_milliseconds}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='60000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "60000" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Время ожидания в миллисекундах для получения данных запроса из распределённого кэша


## distributed_cache_receive_timeout_milliseconds {#distributed_cache_receive_timeout_milliseconds}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='10000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "10000" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Время ожидания в миллисекундах для получения любого типа ответа от распределённого кеша


## distributed_cache_receive_timeout_ms {#distributed_cache_receive_timeout_ms}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='3000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "3000" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Таймаут получения данных от сервера распределённого кеша в миллисекундах. Если в течение этого интервала не было получено ни одного байта, генерируется исключение.


## distributed_cache_send_timeout_ms {#distributed_cache_send_timeout_ms}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='3000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "3000" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Таймаут отправки данных на сервер распределённого кэша в миллисекундах. Если клиент должен отправить данные, но не может отправить ни одного байта в течение этого интервала, выбрасывается исключение.


## distributed_cache_tcp_keep_alive_timeout_ms {#distributed_cache_tcp_keep_alive_timeout_ms}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='2900' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "2900" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Время в миллисекундах, в течение которого соединение с сервером распределённого кэша должно оставаться неактивным, прежде чем TCP начнёт отправлять keepalive-зонды.


## distributed_cache_throw_on_error {#distributed_cache_throw_on_error}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "0" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Повторно выбрасывает исключение, возникшее при взаимодействии с распределённым кешем, или исключение, полученное от распределённого кеша. В противном случае при ошибке распределённый кеш пропускается


## distributed_cache_wait_connection_from_pool_milliseconds {#distributed_cache_wait_connection_from_pool_milliseconds}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='100' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "100" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Время ожидания в миллисекундах для получения соединения из пула соединений, если параметр distributed_cache_pool_behaviour_on_limit имеет значение wait


## distributed_connections_pool_size {#distributed_connections_pool_size}

<SettingsInfoBlock type='UInt64' default_value='1024' />

Максимальное количество одновременных соединений с удалёнными серверами для распределённой обработки всех запросов к одной таблице с движком Distributed. Рекомендуется устанавливать значение не менее количества серверов в кластере.


## distributed_ddl_entry_format_version {#distributed_ddl_entry_format_version}

<SettingsInfoBlock type='UInt64' default_value='5' />

Версия совместимости распределённых DDL-запросов (ON CLUSTER)


## distributed_ddl_output_mode {#distributed_ddl_output_mode}

<SettingsInfoBlock type='DistributedDDLOutputMode' default_value='throw' />

Задаёт формат результата распределённого DDL-запроса.

Возможные значения:

- `throw` — Возвращает набор результатов со статусом выполнения запроса для всех хостов, на которых запрос завершён. Если запрос завершился с ошибкой на некоторых хостах, будет повторно выброшено первое исключение. Если запрос ещё не завершён на некоторых хостах и превышен таймаут [distributed_ddl_task_timeout](#distributed_ddl_task_timeout), выбрасывается исключение `TIMEOUT_EXCEEDED`.
- `none` — Аналогично `throw`, но распределённый DDL-запрос не возвращает набор результатов.
- `null_status_on_timeout` — Возвращает `NULL` в качестве статуса выполнения в некоторых строках набора результатов вместо выбрасывания исключения `TIMEOUT_EXCEEDED`, если запрос не завершён на соответствующих хостах.
- `never_throw` — Не выбрасывает исключение `TIMEOUT_EXCEEDED` и не выбрасывает повторно исключения, если запрос завершился с ошибкой на некоторых хостах.
- `none_only_active` — аналогично `none`, но не ожидает неактивные реплики базы данных `Replicated`. Примечание: в этом режиме невозможно определить, что запрос не был выполнен на некоторой реплике и будет выполнен в фоновом режиме.
- `null_status_on_timeout_only_active` — аналогично `null_status_on_timeout`, но не ожидает неактивные реплики базы данных `Replicated`.
- `throw_only_active` — аналогично `throw`, но не ожидает неактивные реплики базы данных `Replicated`.

Значение по умолчанию в Cloud: `throw`.


## distributed_ddl_task_timeout {#distributed_ddl_task_timeout}

<SettingsInfoBlock type='Int64' default_value='180' />

Устанавливает время ожидания ответов на DDL-запросы от всех хостов в кластере. Если DDL-запрос не был выполнен на всех хостах, ответ будет содержать ошибку превышения времени ожидания, и запрос будет выполнен в асинхронном режиме. Отрицательное значение означает бесконечное время ожидания.

Возможные значения:

- Положительное целое число.
- 0 — асинхронный режим.
- Отрицательное целое число — бесконечное время ожидания.


## distributed_foreground_insert {#distributed_foreground_insert}

**Псевдонимы**: `insert_distributed_sync`

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает синхронную вставку данных в таблицу [Distributed](/engines/table-engines/special/distributed).

По умолчанию при вставке данных в таблицу `Distributed` сервер ClickHouse отправляет данные на узлы кластера в фоновом режиме. При `distributed_foreground_insert=1` данные обрабатываются синхронно, и операция `INSERT` завершается успешно только после того, как все данные будут сохранены на всех шардах (как минимум на одной реплике для каждого шарда, если `internal_replication` имеет значение true).

Возможные значения:

- `0` — данные вставляются в фоновом режиме.
- `1` — данные вставляются в синхронном режиме.

Значение по умолчанию в Cloud: `0`.

**См. также**

- [Движок таблиц Distributed](/engines/table-engines/special/distributed)
- [Управление распределёнными таблицами](/sql-reference/statements/system#managing-distributed-tables)


## distributed_group_by_no_merge {#distributed_group_by_no_merge}

<SettingsInfoBlock type='UInt64' default_value='0' />

Не объединять состояния агрегации с разных серверов при распределённой обработке запросов. Можно использовать, когда точно известно, что на разных шардах находятся различные ключи.

Возможные значения:

- `0` — Отключено (финальная обработка запроса выполняется на узле-инициаторе).
- `1` — Не объединять состояния агрегации с разных серверов при распределённой обработке запросов (запрос полностью обрабатывается на шарде, инициатор только проксирует данные). Можно использовать, когда точно известно, что на разных шардах находятся различные ключи.
- `2` — То же, что и `1`, но с применением `ORDER BY` и `LIMIT` на инициаторе (это невозможно при полной обработке запроса на удалённом узле, как в случае `distributed_group_by_no_merge=1`). Можно использовать для запросов с `ORDER BY` и/или `LIMIT`.

**Пример**

```sql
SELECT *
FROM remote('127.0.0.{2,3}', system.one)
GROUP BY dummy
LIMIT 1
SETTINGS distributed_group_by_no_merge = 1
FORMAT PrettyCompactMonoBlock

┌─dummy─┐
│     0 │
│     0 │
└───────┘
```

```sql
SELECT *
FROM remote('127.0.0.{2,3}', system.one)
GROUP BY dummy
LIMIT 1
SETTINGS distributed_group_by_no_merge = 2
FORMAT PrettyCompactMonoBlock

┌─dummy─┐
│     0 │
└───────┘
```


## distributed_insert_skip_read_only_replicas {#distributed_insert_skip_read_only_replicas}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "0" },
        {
          label: "Если включено, INSERT в Distributed пропускает реплики только для чтения"
        }
      ]
    }
  ]}
/>

Включает пропуск реплик только для чтения при выполнении запросов INSERT в таблицы Distributed.

Возможные значения:

- 0 — INSERT выполняется обычным образом; если запрос направляется на реплику только для чтения, возникает ошибка
- 1 — Инициатор пропускает реплики только для чтения перед отправкой данных на шарды.


## distributed_plan_default_reader_bucket_count {#distributed_plan_default_reader_bucket_count}

<ExperimentalBadge />

<SettingsInfoBlock type='UInt64' default_value='8' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "8" },
        { label: "Новая экспериментальная настройка." }
      ]
    }
  ]}
/>

Количество задач по умолчанию для параллельного чтения в распределённом запросе. Задачи распределяются между репликами.


## distributed_plan_default_shuffle_join_bucket_count {#distributed_plan_default_shuffle_join_bucket_count}

<ExperimentalBadge />

<SettingsInfoBlock type='UInt64' default_value='8' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "8" },
        { label: "Новая экспериментальная настройка." }
      ]
    }
  ]}
/>

Количество сегментов по умолчанию для распределённого shuffle-hash-соединения.


## distributed_plan_execute_locally {#distributed_plan_execute_locally}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "0" },
        { label: "Новая экспериментальная настройка." }
      ]
    }
  ]}
/>

Выполнять все задачи распределённого плана запроса локально. Полезно для тестирования и отладки.


## distributed_plan_force_exchange_kind {#distributed_plan_force_exchange_kind}

<ExperimentalBadge />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "" },
        { label: "Новая экспериментальная настройка." }
      ]
    }
  ]}
/>

Принудительно задаёт указанный тип операторов Exchange между этапами распределённого запроса.

Возможные значения:

- '' — не принуждать к использованию какого-либо типа операторов Exchange, позволить оптимизатору выбрать самостоятельно,
- 'Persisted' — использовать временные файлы в объектном хранилище,
- 'Streaming' — передавать данные обмена по сети в потоковом режиме.


## distributed_plan_force_shuffle_aggregation {#distributed_plan_force_shuffle_aggregation}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.7" },
        { label: "0" },
        { label: "Новый экспериментальный параметр" }
      ]
    }
  ]}
/>

Использовать стратегию агрегации Shuffle вместо PartialAggregation + Merge в плане распределённого запроса.


## distributed_plan_max_rows_to_broadcast {#distributed_plan_max_rows_to_broadcast}

<ExperimentalBadge />

<SettingsInfoBlock type='UInt64' default_value='20000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.7" },
        { label: "20000" },
        { label: "Новая экспериментальная настройка." }
      ]
    }
  ]}
/>

Максимальное количество строк для использования broadcast-соединения вместо shuffle-соединения в распределённом плане запроса.


## distributed_plan_optimize_exchanges {#distributed_plan_optimize_exchanges}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "1" },
        { label: "Новая экспериментальная настройка." }
      ]
    }
  ]}
/>

Удаляет ненужные операции обмена данными в плане распределённого запроса. Отключите для отладки.


## distributed_product_mode {#distributed_product_mode}

<SettingsInfoBlock type='DistributedProductMode' default_value='deny' />

Изменяет поведение [распределённых подзапросов](../../sql-reference/operators/in.md).

ClickHouse применяет эту настройку, когда запрос содержит произведение распределённых таблиц, т. е. когда запрос к распределённой таблице содержит подзапрос без GLOBAL к распределённой таблице.

Ограничения:

- Применяется только для подзапросов IN и JOIN.
- Только если в секции FROM используется распределённая таблица, содержащая более одного шарда.
- Если подзапрос обращается к распределённой таблице, содержащей более одного шарда.
- Не используется для табличной функции [remote](../../sql-reference/table-functions/remote.md).

Возможные значения:

- `deny` — Значение по умолчанию. Запрещает использование таких подзапросов (возвращает исключение "Double-distributed in/JOIN subqueries is denied").
- `local` — Заменяет базу данных и таблицу в подзапросе на локальные для целевого сервера (шарда), оставляя обычные `IN`/`JOIN`.
- `global` — Заменяет запрос `IN`/`JOIN` на `GLOBAL IN`/`GLOBAL JOIN`.
- `allow` — Разрешает использование таких подзапросов.


## distributed_push_down_limit {#distributed_push_down_limit}

<SettingsInfoBlock type='UInt64' default_value='1' />

Включает или отключает применение [LIMIT](#limit) на каждом шарде отдельно.

Это позволяет избежать:

- Отправки лишних строк по сети;
- Обработки строк сверх лимита на инициаторе.

Начиная с версии 21.9 получение неточных результатов невозможно, поскольку `distributed_push_down_limit` изменяет выполнение запроса только при выполнении хотя бы одного из условий:

- [distributed_group_by_no_merge](#distributed_group_by_no_merge) > 0.
- Запрос **не содержит** `GROUP BY`/`DISTINCT`/`LIMIT BY`, но содержит `ORDER BY`/`LIMIT`.
- Запрос **содержит** `GROUP BY`/`DISTINCT`/`LIMIT BY` вместе с `ORDER BY`/`LIMIT` и:
  - Включена настройка [optimize_skip_unused_shards](#optimize_skip_unused_shards).
  - Включена настройка [optimize_distributed_group_by_sharding_key](#optimize_distributed_group_by_sharding_key).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

См. также:

- [distributed_group_by_no_merge](#distributed_group_by_no_merge)
- [optimize_skip_unused_shards](#optimize_skip_unused_shards)
- [optimize_distributed_group_by_sharding_key](#optimize_distributed_group_by_sharding_key)


## distributed_replica_error_cap {#distributed_replica_error_cap}

<SettingsInfoBlock type='UInt64' default_value='1000' />

- Тип: беззнаковое целое
- Значение по умолчанию: 1000

Количество ошибок каждой реплики ограничивается этим значением, что предотвращает накопление слишком большого количества ошибок на одной реплике.

См. также:

- [load_balancing](#load_balancing-round_robin)
- [Движок таблиц Distributed](../../engines/table-engines/special/distributed.md)
- [distributed_replica_error_half_life](#distributed_replica_error_half_life)
- [distributed_replica_max_ignored_errors](#distributed_replica_max_ignored_errors)


## distributed_replica_error_half_life {#distributed_replica_error_half_life}

<SettingsInfoBlock type='Seconds' default_value='60' />

- Type: seconds
- Default value: 60 seconds

Управляет скоростью обнуления ошибок в распределённых таблицах. Если реплика недоступна в течение некоторого времени и накапливает 5 ошибок, а параметр distributed_replica_error_half_life установлен в 1 секунду, то реплика считается нормальной через 3 секунды после последней ошибки.

См. также:

- [load_balancing](#load_balancing-round_robin)
- [Движок таблиц Distributed](../../engines/table-engines/special/distributed.md)
- [distributed_replica_error_cap](#distributed_replica_error_cap)
- [distributed_replica_max_ignored_errors](#distributed_replica_max_ignored_errors)


## distributed_replica_max_ignored_errors {#distributed_replica_max_ignored_errors}

<SettingsInfoBlock type='UInt64' default_value='0' />

- Тип: беззнаковое целое
- Значение по умолчанию: 0

Количество ошибок, которые будут игнорироваться при выборе реплик (согласно алгоритму `load_balancing`).

См. также:

- [load_balancing](#load_balancing-round_robin)
- [Движок таблиц Distributed](../../engines/table-engines/special/distributed.md)
- [distributed_replica_error_cap](#distributed_replica_error_cap)
- [distributed_replica_error_half_life](#distributed_replica_error_half_life)


## do_not_merge_across_partitions_select_final {#do_not_merge_across_partitions_select_final}

<SettingsInfoBlock type='Bool' default_value='0' />

Объединять части только в пределах одной партиции при использовании SELECT FINAL


## empty_result_for_aggregation_by_constant_keys_on_empty_set {#empty_result_for_aggregation_by_constant_keys_on_empty_set}

<SettingsInfoBlock type='Bool' default_value='1' />

Возвращать пустой результат при агрегировании по константным ключам на пустом наборе данных.


## empty_result_for_aggregation_by_empty_set {#empty_result_for_aggregation_by_empty_set}

<SettingsInfoBlock type='Bool' default_value='0' />

Возвращать пустой результат при агрегировании без ключей по пустому набору данных.


## enable_adaptive_memory_spill_scheduler {#enable_adaptive_memory_spill_scheduler}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.2" },
        { label: "0" },
        {
          label:
            "Новая настройка. Включает адаптивную выгрузку данных из памяти во внешнее хранилище."
        }
      ]
    }
  ]}
/>

Запускает адаптивную выгрузку данных процессором во внешнее хранилище. В настоящее время поддерживается grace join.


## enable_add_distinct_to_in_subqueries {#enable_add_distinct_to_in_subqueries}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.8" },
        { label: "0" },
        {
          label:
            "Новая настройка для уменьшения размера временных таблиц, передаваемых при выполнении распределённых подзапросов IN."
        }
      ]
    }
  ]}
/>

Включает `DISTINCT` в подзапросах `IN`. Это компромиссная настройка: её включение может значительно уменьшить размер временных таблиц, передаваемых при выполнении распределённых подзапросов IN, и существенно ускорить передачу данных между шардами благодаря тому, что передаются только уникальные значения.
Однако включение этой настройки увеличивает нагрузку на слияние данных на каждом узле, поскольку необходимо выполнять дедупликацию (DISTINCT). Используйте эту настройку, когда передача данных по сети является узким местом, а дополнительные затраты на слияние приемлемы.


## enable_blob_storage_log {#enable_blob_storage_log}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "1" },
        {
          label:
            "Записывать информацию об операциях с blob-хранилищем в системную таблицу system.blob_storage_log"
        }
      ]
    }
  ]}
/>

Записывать информацию об операциях с blob-хранилищем в системную таблицу system.blob_storage_log


## enable_deflate_qpl_codec {#enable_deflate_qpl_codec}

<SettingsInfoBlock type='Bool' default_value='0' />

Если включено, для сжатия столбцов может использоваться кодек DEFLATE_QPL.


## enable_early_constant_folding {#enable_early_constant_folding}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает оптимизацию запросов, при которой анализируются результаты функций и подзапросов, и запрос переписывается, если в них обнаружены константы


## enable_extended_results_for_datetime_functions {#enable_extended_results_for_datetime_functions}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает возврат результатов типа `Date32` с расширенным диапазоном (по сравнению с типом `Date`) или `DateTime64` с расширенным диапазоном (по сравнению с типом `DateTime`).

Возможные значения:

- `0` — Функции возвращают `Date` или `DateTime` для всех типов аргументов.
- `1` — Функции возвращают `Date32` или `DateTime64` для аргументов `Date32` или `DateTime64`, и `Date` или `DateTime` в остальных случаях.

В таблице ниже показано поведение этой настройки для различных функций работы с датой и временем.


| Функция                   | `enable_extended_results_for_datetime_functions = 0`                                                                                   | `enable_extended_results_for_datetime_functions = 1`                                                                                                           |
| ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `toStartOfYear`           | Возвращает значение типа `Date` или `DateTime`                                                                                         | Возвращает `Date`/`DateTime` для аргумента типа `Date`/`DateTime`<br />Возвращает `Date32`/`DateTime64` для аргумента типа `Date32`/`DateTime64`               |
| `toStartOfISOYear`        | Возвращает `Date` или `DateTime`                                                                                                       | Возвращает `Date`/`DateTime` для аргументов `Date`/`DateTime`<br />Возвращает `Date32`/`DateTime64` для аргументов `Date32`/`DateTime64`                       |
| `toStartOfQuarter`        | Возвращает значение типа `Date` или `DateTime`                                                                                         | Возвращает `Date`/`DateTime` для аргумента типа `Date`/`DateTime`<br />Возвращает `Date32`/`DateTime64` для аргумента типа `Date32`/`DateTime64`               |
| `toStartOfMonth`          | Возвращает `Date` или `DateTime`                                                                                                       | Возвращает `Date`/`DateTime` для аргументов типа `Date`/`DateTime`<br />Возвращает `Date32`/`DateTime64` для аргументов типа `Date32`/`DateTime64`             |
| `toStartOfWeek`           | Возвращает `Date` или `DateTime`                                                                                                       | Возвращает `Date`/`DateTime` для аргумента типа `Date`/`DateTime`<br />Возвращает `Date32`/`DateTime64` для аргумента типа `Date32`/`DateTime64`               |
| `toLastDayOfWeek`         | Возвращает `Date` или `DateTime`                                                                                                       | Возвращает `Date`/`DateTime` для аргумента типа `Date`/`DateTime`<br />Возвращает `Date32`/`DateTime64` для аргумента типа `Date32`/`DateTime64`               |
| `toLastDayOfMonth`        | Возвращает `Date` или `DateTime`                                                                                                       | Возвращает `Date`/`DateTime` для аргумента типа `Date`/`DateTime`<br />Возвращает `Date32`/`DateTime64` для аргумента типа `Date32`/`DateTime64`               |
| `toMonday`                | Возвращает `Date` или `DateTime`                                                                                                       | Возвращает `Date`/`DateTime` для входных значений типа `Date`/`DateTime`<br />Возвращает `Date32`/`DateTime64` для входных значений типа `Date32`/`DateTime64` |
| `toStartOfDay`            | Возвращает `DateTime`<br />*Примечание: При значениях вне диапазона 1970–2149 годов возвращает некорректные результаты*                | Возвращает значение типа `DateTime` для аргумента типа `Date`/`DateTime`<br />Возвращает значение типа `DateTime64` для аргумента типа `Date32`/`DateTime64`   |
| `toStartOfHour`           | Возвращает значение типа `DateTime`<br />*Примечание: будут возвращены неверные результаты для значений вне диапазона 1970–2149 годов* | Возвращает `DateTime` для аргументов типа `Date`/`DateTime`<br />Возвращает `DateTime64` для аргументов типа `Date32`/`DateTime64`                             |
| `toStartOfFifteenMinutes` | Возвращает `DateTime`<br />*Примечание: Неверные результаты для значений вне диапазона 1970–2149 годов*                                | Возвращает `DateTime` для аргументов типа `Date`/`DateTime`<br />Возвращает `DateTime64` для аргументов типа `Date32`/`DateTime64`                             |
| `toStartOfTenMinutes`     | Возвращает значение типа `DateTime`<br />*Примечание: неверные результаты для значений вне диапазона 1970–2149 годов*                  | Возвращает `DateTime` для аргументов типов `Date`/`DateTime`<br />Возвращает `DateTime64` для аргументов типов `Date32`/`DateTime64`                           |
| `toStartOfFiveMinutes`    | Возвращает `DateTime`<br />*Примечание: Может возвращать некорректные результаты для значений вне диапазона 1970–2149 годов*           | Возвращает `DateTime` для аргумента типа `Date`/`DateTime`<br />Возвращает `DateTime64` для аргумента типа `Date32`/`DateTime64`                               |
| `toStartOfMinute`         | Возвращает `DateTime`<br />*Примечание: Может возвращать неверные результаты для значений вне диапазона 1970–2149 годов*               | Возвращает `DateTime` для аргументов типов `Date`/`DateTime`<br />Возвращает `DateTime64` для аргументов типов `Date32`/`DateTime64`                           |
| `timeSlot`                | Возвращает `DateTime`<br />*Примечание: неверные результаты для значений вне диапазона 1970–2149 годов*                                | Возвращает `DateTime` для аргумента типа `Date`/`DateTime`<br />Возвращает `DateTime64` для аргумента типа `Date32`/`DateTime64`                               |





## enable_filesystem_cache {#enable_filesystem_cache}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать кэш для удалённой файловой системы. Эта настройка не включает и не отключает кэш для дисков (это необходимо делать через конфигурацию диска), но позволяет обходить кэш для некоторых запросов при необходимости


## enable_filesystem_cache_log {#enable_filesystem_cache_log}

<SettingsInfoBlock type='Bool' default_value='0' />

Позволяет записывать журнал кэширования файловой системы для каждого запроса


## enable_filesystem_cache_on_write_operations {#enable_filesystem_cache_on_write_operations}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает кеш `write-through`. При значении `false` кеш `write-through` отключается для операций записи. При значении `true` кеш `write-through` включается, если параметр `cache_on_write_operations` включен в разделе конфигурации кеш-диска серверной конфигурации.
Подробнее см. в разделе [«Использование локального кеша»](/operations/storing-data#using-local-cache).


## enable_filesystem_read_prefetches_log {#enable_filesystem_read_prefetches_log}

<SettingsInfoBlock type='Bool' default_value='0' />

Записывать данные в system.filesystem_prefetch_log во время выполнения запроса. Следует использовать только для тестирования или отладки, не рекомендуется включать по умолчанию


## enable_global_with_statement {#enable_global_with_statement}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "21.2" },
        { label: "1" },
        {
          label:
            "Распространять WITH-выражения на UNION-запросы и все подзапросы по умолчанию"
        }
      ]
    }
  ]}
/>

Распространять WITH-выражения на UNION-запросы и все подзапросы


## enable_hdfs_pread {#enable_hdfs_pread}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.4" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Включает или отключает использование pread для файлов HDFS. По умолчанию используется `hdfsPread`. При отключении для чтения файлов HDFS будут использоваться `hdfsRead` и `hdfsSeek`.


## enable_http_compression {#enable_http_compression}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.10" },
        { label: "1" },
        { label: "Должно быть полезным в общем случае" }
      ]
    }
  ]}
/>

Включает или отключает сжатие данных в ответе на HTTP-запрос.

Дополнительную информацию см. в [описании HTTP-интерфейса](../../interfaces/http.md).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.


## enable_job_stack_trace {#enable_job_stack_trace}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "0" },
        {
          label:
            "Настройка отключена по умолчанию для предотвращения снижения производительности."
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.11" },
        { label: "0" },
        {
          label:
            "Включает сбор трассировок стека при планировании задач. Отключено по умолчанию для предотвращения снижения производительности."
        }
      ]
    }
  ]}
/>

Выводит трассировку стека создателя задачи при возникновении исключения. Отключено по умолчанию для предотвращения снижения производительности.


## enable_join_runtime_filters {#enable_join_runtime_filters}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "0" }, { label: "New setting" }]
    }
  ]}
/>

Фильтрует левую сторону по набору ключей JOIN, собранных из правой стороны во время выполнения.


## enable_lazy_columns_replication {#enable_lazy_columns_replication}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "1" },
        {
          label:
            "Ленивая репликация столбцов в JOIN и ARRAY JOIN включена по умолчанию"
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "25.10" },
        { label: "0" },
        {
          label:
            "Добавлена настройка для включения ленивой репликации столбцов в JOIN и ARRAY JOIN"
        }
      ]
    }
  ]}
/>

Включает ленивую репликацию столбцов в операциях JOIN и ARRAY JOIN, что позволяет избежать избыточного многократного копирования одних и тех же строк в памяти.


## enable_lightweight_delete {#enable_lightweight_delete}

**Псевдонимы**: `allow_experimental_lightweight_delete`

<SettingsInfoBlock type='Bool' default_value='1' />

Включает облегчённые DELETE-мутации для таблиц семейства MergeTree.


## enable_lightweight_update {#enable_lightweight_update}

<BetaBadge />

**Псевдонимы**: `allow_experimental_lightweight_update`

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.8" },
        { label: "1" },
        {
          label:
            "Легковесные обновления переведены в статус Beta. Добавлен псевдоним настройки 'allow_experimental_lightweight_update'."
        }
      ]
    }
  ]}
/>

    Разрешает использование легковесных обновлений.


## enable_memory_bound_merging_of_aggregation_results {#enable_memory_bound_merging_of_aggregation_results}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает стратегию слияния результатов агрегации с ограничением по памяти.


## enable_multiple_prewhere_read_steps {#enable_multiple_prewhere_read_steps}

<SettingsInfoBlock type='Bool' default_value='1' />

Переносить больше условий из WHERE в PREWHERE и выполнять чтение с диска и фильтрацию в несколько этапов при наличии нескольких условий, объединённых оператором AND


## enable_named_columns_in_function_tuple {#enable_named_columns_in_function_tuple}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "0" },
        {
          label:
            "Генерировать именованные кортежи в функции tuple(), когда все имена уникальны и могут использоваться как идентификаторы без кавычек."
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.10" },
        { label: "0" },
        { label: "Отключено в ожидании улучшений удобства использования" }
      ]
    }
  ]}
/>

Генерировать именованные кортежи в функции tuple(), когда все имена уникальны и могут использоваться как идентификаторы без кавычек.


## enable_optimize_predicate_expression {#enable_optimize_predicate_expression}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "18.12.17" },
        { label: "1" },
        { label: "Оптимизация предикатов в подзапросах по умолчанию" }
      ]
    }
  ]}
/>

Включает проталкивание предикатов в запросах `SELECT`.

Проталкивание предикатов может значительно сократить сетевой трафик для распределённых запросов.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

Использование

Рассмотрим следующие запросы:

1.  `SELECT count() FROM test_table WHERE date = '2018-10-10'`
2.  `SELECT count() FROM (SELECT * FROM test_table) WHERE date = '2018-10-10'`

Если `enable_optimize_predicate_expression = 1`, то время выполнения этих запросов одинаково, поскольку ClickHouse применяет условие `WHERE` к подзапросу при его обработке.

Если `enable_optimize_predicate_expression = 0`, то время выполнения второго запроса значительно больше, поскольку условие `WHERE` применяется ко всем данным после завершения выполнения подзапроса.


## enable_optimize_predicate_expression_to_final_subquery {#enable_optimize_predicate_expression_to_final_subquery}

<SettingsInfoBlock type='Bool' default_value='1' />

Разрешает проталкивание предиката в финальный подзапрос.


## enable_order_by_all {#enable_order_by_all}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает сортировку с использованием синтаксиса `ORDER BY ALL`, см. [ORDER BY](../../sql-reference/statements/select/order-by.md).

Возможные значения:

- 0 — отключить ORDER BY ALL.
- 1 — включить ORDER BY ALL.

**Пример**

Запрос:

```sql
CREATE TABLE TAB(C1 Int, C2 Int, ALL Int) ENGINE=Memory();

INSERT INTO TAB VALUES (10, 20, 30), (20, 20, 10), (30, 10, 20);

SELECT * FROM TAB ORDER BY ALL; -- возвращает ошибку о том, что ALL неоднозначно

SELECT * FROM TAB ORDER BY ALL SETTINGS enable_order_by_all = 0;
```

Результат:

```text
┌─C1─┬─C2─┬─ALL─┐
│ 20 │ 20 │  10 │
│ 30 │ 10 │  20 │
│ 10 │ 20 │  30 │
└────┴────┴─────┘
```


## enable_parallel_blocks_marshalling {#enable_parallel_blocks_marshalling}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.6" }, { label: "true" }, { label: "Новая настройка" }]
    }
  ]}
/>

Влияет только на распределённые запросы. Если включено, блоки будут сериализованы/десериализованы и сжаты/распакованы в потоках конвейера (т. е. с более высоким параллелизмом, чем по умолчанию) до и после отправки инициатору.


## enable_parsing_to_custom_serialization {#enable_parsing_to_custom_serialization}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.10" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Если значение true, данные могут парситься напрямую в столбцы с пользовательской сериализацией (например, Sparse) согласно подсказкам по сериализации, полученным из таблицы.


## enable_positional_arguments {#enable_positional_arguments}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "22.7" },
        { label: "1" },
        { label: "Позиционные аргументы включены по умолчанию" }
      ]
    }
  ]}
/>

Включает или отключает поддержку позиционных аргументов в операторах [GROUP BY](/sql-reference/statements/select/group-by), [LIMIT BY](../../sql-reference/statements/select/limit-by.md), [ORDER BY](../../sql-reference/statements/select/order-by.md).

Возможные значения:

- 0 — Позиционные аргументы не поддерживаются.
- 1 — Позиционные аргументы поддерживаются: можно использовать номера столбцов вместо их имён.

**Пример**

Запрос:

```sql
CREATE TABLE positional_arguments(one Int, two Int, three Int) ENGINE=Memory();

INSERT INTO positional_arguments VALUES (10, 20, 30), (20, 20, 10), (30, 10, 20);

SELECT * FROM positional_arguments ORDER BY 2,3;
```

Результат:

```text
┌─one─┬─two─┬─three─┐
│  30 │  10 │   20  │
│  20 │  20 │   10  │
│  10 │  20 │   30  │
└─────┴─────┴───────┘
```


## enable_producing_buckets_out_of_order_in_aggregation {#enable_producing_buckets_out_of_order_in_aggregation}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Позволяет экономичной по памяти агрегации (см. `distributed_aggregation_memory_efficient`) создавать сегменты в произвольном порядке.
Это может улучшить производительность при неравномерном распределении размеров сегментов агрегации, позволяя реплике отправлять сегменты с более высокими идентификаторами инициатору, пока тот все еще обрабатывает тяжелые сегменты с более низкими идентификаторами.
Недостатком является потенциально более высокое потребление памяти.


## enable_reads_from_query_cache {#enable_reads_from_query_cache}

<SettingsInfoBlock type='Bool' default_value='1' />

Если параметр включен, результаты запросов `SELECT` извлекаются из [кэша запросов](../query-cache.md).

Возможные значения:

- 0 — отключено
- 1 — включено


## enable_s3_requests_logging {#enable_s3_requests_logging}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает детальное логирование S3-запросов. Имеет смысл только для отладки.


## enable_scalar_subquery_optimization {#enable_scalar_subquery_optimization}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "19.18" },
        { label: "1" },
        {
          label:
            "Предотвращает сериализацию и десериализацию больших скалярных значений в скалярных подзапросах и позволяет избежать повторного выполнения одного и того же подзапроса"
        }
      ]
    }
  ]}
/>

Если установлено значение true, предотвращает сериализацию и десериализацию больших скалярных значений в скалярных подзапросах и позволяет избежать повторного выполнения одного и того же подзапроса.


## enable_scopes_for_with_statement {#enable_scopes_for_with_statement}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.7" },
        { label: "1" },
        {
          label: "Новая настройка для обратной совместимости со старым анализатором."
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "25.6" },
        { label: "1" },
        {
          label: "Новая настройка для обратной совместимости со старым анализатором."
        }
      ]
    },
    {
      id: "row-3",
      items: [
        { label: "25.5" },
        { label: "1" },
        {
          label: "Новая настройка для обратной совместимости со старым анализатором."
        }
      ]
    },
    {
      id: "row-4",
      items: [
        { label: "25.4" },
        { label: "1" },
        {
          label: "Новая настройка для обратной совместимости со старым анализатором."
        }
      ]
    }
  ]}
/>

Если отключено, объявления в родительских предложениях WITH будут обрабатываться в той же области видимости, как если бы они были объявлены в текущей области видимости.

Обратите внимание, что это настройка совместимости для нового анализатора, которая позволяет выполнять некоторые некорректные запросы, которые мог выполнять старый анализатор.


## enable_shared_storage_snapshot_in_query {#enable_shared_storage_snapshot_in_query}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "0" },
        { label: "Новая настройка для использования общего снимка хранилища в запросе" }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "25.11" },
        { label: "1" },
        { label: "Улучшенные гарантии согласованности." }
      ]
    }
  ]}
/>

Если включено, все подзапросы в рамках одного запроса будут использовать один и тот же StorageSnapshot для каждой таблицы.
Это обеспечивает согласованное представление данных во всём запросе, даже если одна и та же таблица используется многократно.

Это необходимо для запросов, где важна внутренняя согласованность частей данных. Пример:

```sql
SELECT
    count()
FROM events
WHERE (_part, _part_offset) IN (
    SELECT _part, _part_offset
    FROM events
    WHERE user_id = 42
)
```

Без этой настройки внешний и внутренний запросы могут работать с разными снимками данных, что приводит к некорректным результатам.

:::note
Включение этой настройки отключает оптимизацию, которая удаляет ненужные части данных из снимков после завершения этапа планирования.
В результате долго выполняющиеся запросы могут удерживать устаревшие части на протяжении всего времени своего выполнения, задерживая очистку частей и увеличивая нагрузку на хранилище.

Эта настройка в настоящее время применяется только к таблицам семейства MergeTree.
:::

Возможные значения:

- 0 — Отключено
- 1 — Включено


## enable_sharing_sets_for_mutations {#enable_sharing_sets_for_mutations}

<SettingsInfoBlock type='Bool' default_value='1' />

Разрешает совместное использование объектов множеств, построенных для подзапросов IN, между различными задачами одной мутации. Это снижает потребление памяти и процессора


## enable_software_prefetch_in_aggregation {#enable_software_prefetch_in_aggregation}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает использование программной предвыборки в агрегации


## enable_unaligned_array_join {#enable_unaligned_array_join}

<SettingsInfoBlock type='Bool' default_value='0' />

Разрешает использование ARRAY JOIN с несколькими массивами различного размера. При включении этой настройки массивы будут расширены до размера самого длинного.


## enable_url_encoding {#enable_url_encoding}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "0" },
        { label: "Изменено значение по умолчанию для существующей настройки" }
      ]
    }
  ]}
/>

Позволяет включать и отключать декодирование и кодирование пути в URI для таблиц движка [URL](../../engines/table-engines/special/url.md).

Отключено по умолчанию.


## enable_vertical_final {#enable_vertical_final}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "1" },
        { label: "Вертикальный FINAL снова включен по умолчанию после исправления ошибки" }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.1" },
        { label: "1" },
        { label: "Вертикальный FINAL используется по умолчанию" }
      ]
    }
  ]}
/>

Если включено, дублирующиеся строки удаляются во время выполнения FINAL путем пометки строк как удаленных и их последующей фильтрации вместо слияния строк


## enable_writes_to_query_cache {#enable_writes_to_query_cache}

<SettingsInfoBlock type='Bool' default_value='1' />

Если параметр включен, результаты запросов `SELECT` сохраняются в [кеше запросов](../query-cache.md).

Возможные значения:

- 0 — отключено
- 1 — включено


## enable_zstd_qat_codec {#enable_zstd_qat_codec}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.1" },
        { label: "0" },
        { label: "Добавлен новый кодек ZSTD_QAT" }
      ]
    }
  ]}
/>

При включении кодек ZSTD_QAT может использоваться для сжатия столбцов.


## enforce_strict_identifier_format {#enforce_strict_identifier_format}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.10" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Если включено, разрешены только идентификаторы, содержащие буквенно-цифровые символы и символы подчёркивания.


## engine_file_allow_create_multiple_files {#engine_file_allow_create_multiple_files}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает создание нового файла при каждой вставке в таблицы с движком File, если формат имеет суффикс (`JSON`, `ORC`, `Parquet` и т. д.). Если параметр включен, при каждой вставке будет создаваться новый файл с именем по следующему шаблону:

`data.Parquet` -> `data.1.Parquet` -> `data.2.Parquet`, etc.

Возможные значения:

- 0 — запрос `INSERT` добавляет новые данные в конец файла.
- 1 — запрос `INSERT` создаёт новый файл.


## engine_file_empty_if_not_exists {#engine_file_empty_if_not_exists}

<SettingsInfoBlock type='Bool' default_value='0' />

Позволяет выполнять выборку данных из таблицы с движком File при отсутствии файла.

Возможные значения:

- 0 — `SELECT` выбрасывает исключение.
- 1 — `SELECT` возвращает пустой результат.


## engine_file_skip_empty_files {#engine_file_skip_empty_files}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает пропуск пустых файлов в таблицах с движком [File](../../engines/table-engines/special/file.md).

Возможные значения:

- 0 — `SELECT` генерирует исключение, если пустой файл несовместим с запрошенным форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.


## engine_file_truncate_on_insert {#engine_file_truncate_on_insert}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает очистку файла перед вставкой данных в таблицы движка [File](../../engines/table-engines/special/file.md).

Возможные значения:

- 0 — запрос `INSERT` добавляет новые данные в конец файла.
- 1 — запрос `INSERT` заменяет существующее содержимое файла новыми данными.


## engine_url_skip_empty_files {#engine_url_skip_empty_files}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает пропуск пустых файлов в таблицах с движком [URL](../../engines/table-engines/special/url.md).

Возможные значения:

- 0 — `SELECT` генерирует исключение, если пустой файл несовместим с запрошенным форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.


## except_default_mode {#except_default_mode}

<SettingsInfoBlock type='SetOperationMode' default_value='ALL' />

Задает режим по умолчанию для запроса EXCEPT. Возможные значения: пустая строка, 'ALL', 'DISTINCT'. Если параметр пустой, запрос без явного указания режима вызовет исключение.


## exclude_materialize_skip_indexes_on_insert {#exclude_materialize_skip_indexes_on_insert}

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "" }, { label: "Новая настройка." }]
    }
  ]}
/>

Исключает указанные индексы пропуска из построения и сохранения во время операций INSERT. Исключённые индексы пропуска всё равно будут построены и сохранены [во время слияний](merge-tree-settings.md/#materialize_skip_indexes_on_merge) или при выполнении явного запроса
[MATERIALIZE INDEX](/sql-reference/statements/alter/skipping-index.md/#materialize-index).

Не действует, если [materialize_skip_indexes_on_insert](#materialize_skip_indexes_on_insert) имеет значение false.

Пример:

```sql
CREATE TABLE tab
(
    a UInt64,
    b UInt64,
    INDEX idx_a a TYPE minmax,
    INDEX idx_b b TYPE set(3)
)
ENGINE = MergeTree ORDER BY tuple();

SET exclude_materialize_skip_indexes_on_insert='idx_a'; -- idx_a не будет обновляться при вставке
--SET exclude_materialize_skip_indexes_on_insert='idx_a, idx_b'; -- ни один из индексов не будет обновляться при вставке

INSERT INTO tab SELECT number, number / 50 FROM numbers(100); -- обновляется только idx_b

-- поскольку это настройка сессии, её можно задать на уровне отдельного запроса
INSERT INTO tab SELECT number, number / 50 FROM numbers(100, 100) SETTINGS exclude_materialize_skip_indexes_on_insert='idx_b';

ALTER TABLE tab MATERIALIZE INDEX idx_a; -- этот запрос можно использовать для явной материализации индекса

SET exclude_materialize_skip_indexes_on_insert = DEFAULT; -- сброс настройки к значению по умолчанию
```


## execute_exists_as_scalar_subquery {#execute_exists_as_scalar_subquery}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Выполнять некоррелированные подзапросы EXISTS как скалярные подзапросы. Как и для скалярных подзапросов, используется кэш и применяется свёртка констант к результату.


## external_storage_connect_timeout_sec {#external_storage_connect_timeout_sec}

<SettingsInfoBlock type='UInt64' default_value='10' />

Таймаут подключения в секундах. В настоящее время поддерживается только для MySQL


## external_storage_max_read_bytes {#external_storage_max_read_bytes}

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничивает максимальное количество байтов, при достижении которого таблица с внешним движком должна сбрасывать исторические данные. В настоящее время поддерживается только для табличного движка MySQL, движка баз данных и словарей. Если значение равно 0, настройка отключена


## external_storage_max_read_rows {#external_storage_max_read_rows}

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничивает максимальное количество строк при сбросе исторических данных таблицей с внешним движком. В настоящее время поддерживается только для табличного движка MySQL, движка баз данных и словарей. Если значение равно 0, настройка отключена


## external_storage_rw_timeout_sec {#external_storage_rw_timeout_sec}

<SettingsInfoBlock type='UInt64' default_value='300' />

Тайм-аут операций чтения/записи в секундах. В настоящее время поддерживается только для MySQL


## external_table_functions_use_nulls {#external_table_functions_use_nulls}

<SettingsInfoBlock type='Bool' default_value='1' />

Определяет, как табличные функции [mysql](../../sql-reference/table-functions/mysql.md), [postgresql](../../sql-reference/table-functions/postgresql.md) и [odbc](../../sql-reference/table-functions/odbc.md) работают со столбцами типа Nullable.

Возможные значения:

- 0 — Табличная функция явно использует столбцы типа Nullable.
- 1 — Табличная функция неявно использует столбцы типа Nullable.

**Использование**

Если настройка установлена в `0`, табличная функция не создаёт столбцы типа Nullable и вставляет значения по умолчанию вместо NULL. Это также применимо к значениям NULL внутри массивов.


## external_table_strict_query {#external_table_strict_query}

<SettingsInfoBlock type='Bool' default_value='0' />

Если установлено значение true, преобразование выражений в локальные фильтры запрещено для запросов к внешним таблицам.


## extract_key_value_pairs_max_pairs_per_row {#extract_key_value_pairs_max_pairs_per_row}

**Псевдонимы**: `extract_kvp_max_pairs_per_row`

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "0" },
        {
          label:
            "Максимальное количество пар, которое может быть возвращено функцией `extractKeyValuePairs`. Используется для защиты от чрезмерного потребления памяти."
        }
      ]
    }
  ]}
/>

Максимальное количество пар, которое может быть возвращено функцией `extractKeyValuePairs`. Используется для защиты от чрезмерного потребления памяти.


## extremes {#extremes}

<SettingsInfoBlock type='Bool' default_value='0' />

Определяет, следует ли вычислять экстремальные значения (минимумы и максимумы в столбцах результата запроса). Принимает значения 0 или 1. По умолчанию: 0 (отключено).
Подробнее см. в разделе «Экстремальные значения».


## fallback_to_stale_replicas_for_distributed_queries {#fallback_to_stale_replicas_for_distributed_queries}

<SettingsInfoBlock type='Bool' default_value='1' />

Принудительно направляет запрос к устаревшей реплике, если актуальные данные недоступны. См. [Репликация](../../engines/table-engines/mergetree-family/replication.md).

ClickHouse выбирает наиболее актуальную из устаревших реплик таблицы.

Используется при выполнении запроса `SELECT` к распределённой таблице, которая ссылается на реплицируемые таблицы.

По умолчанию: 1 (включено).


## filesystem_cache_allow_background_download {#filesystem_cache_allow_background_download}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "1" },
        {
          label:
            "Новая настройка для управления фоновыми загрузками в кэше файловой системы на уровне запроса."
        }
      ]
    }
  ]}
/>

Разрешает кэшу файловой системы ставить в очередь фоновые загрузки данных, считываемых из удалённого хранилища. Отключите, чтобы загрузки выполнялись в основном потоке для текущего запроса/сессии.


## filesystem_cache_boundary_alignment {#filesystem_cache_boundary_alignment}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.11" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Выравнивание границ кэша файловой системы. Эта настройка применяется только для чтения не с диска (например, для кэша удалённых движков таблиц и табличных функций, но не для конфигурации хранилища таблиц MergeTree). Значение 0 означает отсутствие выравнивания.


## filesystem_cache_enable_background_download_during_fetch {#filesystem_cache_enable_background_download_during_fetch}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.11" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Время ожидания блокировки кеша для резервирования пространства в файловом кеше


## filesystem_cache_enable_background_download_for_metadata_files_in_packed_storage {#filesystem_cache_enable_background_download_for_metadata_files_in_packed_storage}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.11" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Время ожидания блокировки кеша для резервирования пространства в кеше файловой системы


## filesystem_cache_max_download_size {#filesystem_cache_max_download_size}

<SettingsInfoBlock type='UInt64' default_value='137438953472' />

Максимальный размер кэша удалённой файловой системы, который может быть загружен одним запросом


## filesystem_cache_name {#filesystem_cache_name}

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "" },
        {
          label:
            "Имя кэша файловой системы для использования с stateless-движками таблиц или озёрами данных"
        }
      ]
    }
  ]}
/>

Имя кэша файловой системы для использования с stateless-движками таблиц или озёрами данных


## filesystem_cache_prefer_bigger_buffer_size {#filesystem_cache_prefer_bigger_buffer_size}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.11" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Использовать больший размер буфера при включенном кэше файловой системы, чтобы избежать записи небольших сегментов файлов, которые снижают производительность кэша. С другой стороны, включение этой настройки может увеличить потребление памяти.


## filesystem_cache_reserve_space_wait_lock_timeout_milliseconds {#filesystem_cache_reserve_space_wait_lock_timeout_milliseconds}

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "1000" },
        {
          label:
            "Время ожидания блокировки кеша для резервирования пространства в файловом кеше"
        }
      ]
    }
  ]}
/>

Время ожидания блокировки кеша для резервирования пространства в файловом кеше


## filesystem_cache_segments_batch_size {#filesystem_cache_segments_batch_size}

<SettingsInfoBlock type='UInt64' default_value='20' />

Ограничение на размер одного пакета файловых сегментов, который буфер чтения может запросить из кеша. Слишком низкое значение приведёт к избыточным запросам к кешу, слишком большое может замедлить вытеснение из кеша


## filesystem_cache_skip_download_if_exceeds_per_query_cache_write_limit {#filesystem_cache_skip_download_if_exceeds_per_query_cache_write_limit}

**Псевдонимы**: `skip_download_if_exceeds_query_cache`

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.11" },
        { label: "1" },
        {
          label: "Переименование настройки skip_download_if_exceeds_query_cache_limit"
        }
      ]
    }
  ]}
/>

Пропускать загрузку из удалённой файловой системы, если объём превышает размер кеша запроса


## filesystem_prefetch_max_memory_usage {#filesystem_prefetch_max_memory_usage}

<SettingsInfoBlock type='NonZeroUInt64' default_value='1073741824' />

Максимальный объем памяти для предварительной загрузки.


## filesystem_prefetch_step_bytes {#filesystem_prefetch_step_bytes}

<SettingsInfoBlock type='UInt64' default_value='0' />

Шаг предварительной загрузки в байтах. Ноль означает `auto` — приблизительно оптимальный шаг предварительной загрузки будет определён автоматически, но может не быть на 100% оптимальным. Фактическое значение может отличаться из-за настройки filesystem_prefetch_min_bytes_for_single_read_task


## filesystem_prefetch_step_marks {#filesystem_prefetch_step_marks}

<SettingsInfoBlock type='UInt64' default_value='0' />

Шаг предварительной загрузки в метках. Ноль означает `auto` — оптимальный шаг предварительной загрузки будет определён автоматически, но может не быть абсолютно оптимальным. Фактическое значение может отличаться из-за параметра filesystem_prefetch_min_bytes_for_single_read_task


## filesystem_prefetches_limit {#filesystem_prefetches_limit}

<SettingsInfoBlock type='UInt64' default_value='200' />

Максимальное количество предварительных загрузок. Ноль означает отсутствие ограничений. Для ограничения количества предварительных загрузок рекомендуется использовать настройку `filesystem_prefetches_max_memory_usage`


## final {#final}

<SettingsInfoBlock type='Bool' default_value='0' />

Автоматически применяет модификатор [FINAL](../../sql-reference/statements/select/from.md/#final-modifier) ко всем таблицам в запросе, к которым применим [FINAL](../../sql-reference/statements/select/from.md/#final-modifier), включая объединённые таблицы, таблицы в подзапросах и распределённые таблицы.

Возможные значения:

- 0 — отключено
- 1 — включено

Пример:

```sql
CREATE TABLE test
(
    key Int64,
    some String
)
ENGINE = ReplacingMergeTree
ORDER BY key;

INSERT INTO test FORMAT Values (1, 'first');
INSERT INTO test FORMAT Values (1, 'second');

SELECT * FROM test;
┌─key─┬─some───┐
│   1 │ second │
└─────┴────────┘
┌─key─┬─some──┐
│   1 │ first │
└─────┴───────┘

SELECT * FROM test SETTINGS final = 1;
┌─key─┬─some───┐
│   1 │ second │
└─────┴────────┘

SET final = 1;
SELECT * FROM test;
┌─key─┬─some───┐
│   1 │ second │
└─────┴────────┘
```


## flatten_nested {#flatten_nested}

<SettingsInfoBlock type='Bool' default_value='1' />

Задает формат данных для столбцов типа [Nested](../../sql-reference/data-types/nested-data-structures/index.md).

Возможные значения:

- 1 — столбец Nested разворачивается в отдельные массивы.
- 0 — столбец Nested остается единым массивом кортежей.

**Использование**

При значении настройки `0` можно использовать произвольный уровень вложенности.

**Примеры**

Запрос:

```sql
SET flatten_nested = 1;
CREATE TABLE t_nest (`n` Nested(a UInt32, b UInt32)) ENGINE = MergeTree ORDER BY tuple();

SHOW CREATE TABLE t_nest;
```

Результат:

```text
┌─statement───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ CREATE TABLE default.t_nest
(
    `n.a` Array(UInt32),
    `n.b` Array(UInt32)
)
ENGINE = MergeTree
ORDER BY tuple()
SETTINGS index_granularity = 8192 │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

Запрос:

```sql
SET flatten_nested = 0;

CREATE TABLE t_nest (`n` Nested(a UInt32, b UInt32)) ENGINE = MergeTree ORDER BY tuple();

SHOW CREATE TABLE t_nest;
```

Результат:

```text
┌─statement──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ CREATE TABLE default.t_nest
(
    `n` Nested(a UInt32, b UInt32)
)
ENGINE = MergeTree
ORDER BY tuple()
SETTINGS index_granularity = 8192 │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```


## force_aggregate_partitions_independently {#force_aggregate_partitions_independently}

<SettingsInfoBlock type='Bool' default_value='0' />

Принудительно использовать оптимизацию, когда она применима, но эвристический анализ решил её не использовать


## force_aggregation_in_order {#force_aggregation_in_order}

<SettingsInfoBlock type='Bool' default_value='0' />

Эта настройка используется самим сервером для поддержки распределённых запросов. Не изменяйте её вручную, так как это приведёт к нарушению нормальной работы. (Принудительно включает упорядоченную агрегацию на удалённых узлах при распределённой агрегации).


## force_data_skipping_indices {#force_data_skipping_indices}

Отключает выполнение запроса, если указанные индексы пропуска данных не были использованы.

Рассмотрим следующий пример:

```sql
CREATE TABLE data
(
    key Int,
    d1 Int,
    d1_null Nullable(Int),
    INDEX d1_idx d1 TYPE minmax GRANULARITY 1,
    INDEX d1_null_idx assumeNotNull(d1_null) TYPE minmax GRANULARITY 1
)
Engine=MergeTree()
ORDER BY key;

SELECT * FROM data_01515;
SELECT * FROM data_01515 SETTINGS force_data_skipping_indices=''; -- запрос вернёт ошибку CANNOT_PARSE_TEXT.
SELECT * FROM data_01515 SETTINGS force_data_skipping_indices='d1_idx'; -- запрос вернёт ошибку INDEX_NOT_USED.
SELECT * FROM data_01515 WHERE d1 = 0 SETTINGS force_data_skipping_indices='d1_idx'; -- Ok.
SELECT * FROM data_01515 WHERE d1 = 0 SETTINGS force_data_skipping_indices='`d1_idx`'; -- Ok (пример полнофункционального парсера).
SELECT * FROM data_01515 WHERE d1 = 0 SETTINGS force_data_skipping_indices='`d1_idx`, d1_null_idx'; -- запрос вернёт ошибку INDEX_NOT_USED, так как d1_null_idx не используется.
SELECT * FROM data_01515 WHERE d1 = 0 AND assumeNotNull(d1_null) = 0 SETTINGS force_data_skipping_indices='`d1_idx`, d1_null_idx'; -- Ok.
```


## force_grouping_standard_compatibility {#force_grouping_standard_compatibility}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "22.9" },
        { label: "1" },
        {
          label:
            "Приведение вывода функции GROUPING в соответствие со стандартом SQL и другими СУБД"
        }
      ]
    }
  ]}
/>

Функция GROUPING возвращает 1, когда аргумент не используется в качестве ключа агрегации


## force_index_by_date {#force_index_by_date}

<SettingsInfoBlock type='Bool' default_value='0' />

Отключает выполнение запроса, если индекс не может использоваться по дате.

Работает с таблицами семейства MergeTree.

Если `force_index_by_date=1`, ClickHouse проверяет наличие в запросе условия на ключ даты, которое может использоваться для ограничения диапазонов данных. Если подходящее условие отсутствует, генерируется исключение. Однако не проверяется, уменьшает ли условие объём читаемых данных. Например, условие `Date != ' 2000-01-01 '` является допустимым, даже если оно соответствует всем данным в таблице (т. е. выполнение запроса требует полного сканирования). Дополнительную информацию о диапазонах данных в таблицах MergeTree см. в разделе [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).


## force_optimize_projection {#force_optimize_projection}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает обязательное использование [проекций](../../engines/table-engines/mergetree-family/mergetree.md/#projections) в запросах `SELECT` при включённой оптимизации проекций (см. настройку [optimize_use_projections](#optimize_use_projections)).

Возможные значения:

- 0 — Оптимизация проекций не обязательна.
- 1 — Оптимизация проекций обязательна.


## force_optimize_projection_name {#force_optimize_projection_name}

Если установлено непустое строковое значение, проверяется, что указанная проекция используется в запросе хотя бы один раз.

Возможные значения:

- string: имя проекции, используемой в запросе


## force_optimize_skip_unused_shards {#force_optimize_skip_unused_shards}

<SettingsInfoBlock type='UInt64' default_value='0' />

Включает или отключает выполнение запроса, если включена настройка [optimize_skip_unused_shards](#optimize_skip_unused_shards) и пропуск неиспользуемых шардов невозможен. Если пропуск невозможен и данная настройка включена, будет выброшено исключение.

Возможные значения:

- 0 — Отключено. ClickHouse не выбрасывает исключение.
- 1 — Включено. Выполнение запроса отключается только в том случае, если таблица имеет ключ шардирования.
- 2 — Включено. Выполнение запроса отключается независимо от того, определён ли ключ шардирования для таблицы.


## force_optimize_skip_unused_shards_nesting {#force_optimize_skip_unused_shards_nesting}

<SettingsInfoBlock type='UInt64' default_value='0' />

Управляет работой [`force_optimize_skip_unused_shards`](#force_optimize_skip_unused_shards) (для этого по-прежнему требуется включённая настройка [`force_optimize_skip_unused_shards`](#force_optimize_skip_unused_shards)) в зависимости от уровня вложенности распределённого запроса (когда таблица `Distributed` обращается к другой таблице `Distributed`).

Возможные значения:

- 0 — Отключено, `force_optimize_skip_unused_shards` работает всегда.
- 1 — Включает `force_optimize_skip_unused_shards` только для первого уровня.
- 2 — Включает `force_optimize_skip_unused_shards` до второго уровня включительно.


## force_primary_key {#force_primary_key}

<SettingsInfoBlock type='Bool' default_value='0' />

Запрещает выполнение запроса, если использование индекса по первичному ключу невозможно.

Работает с таблицами семейства MergeTree.

Если `force_primary_key=1`, ClickHouse проверяет наличие в запросе условия по первичному ключу, которое может использоваться для ограничения диапазонов данных. Если подходящее условие отсутствует, генерируется исключение. Однако не проверяется, действительно ли условие сокращает объём читаемых данных. Подробнее о диапазонах данных в таблицах MergeTree см. [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).


## force_remove_data_recursively_on_drop {#force_remove_data_recursively_on_drop}

<SettingsInfoBlock type='Bool' default_value='0' />

Рекурсивно удалять данные при выполнении запроса DROP. Позволяет избежать ошибки «Directory not empty», но может незаметно удалить отсоединённые данные


## formatdatetime_e_with_space_padding {#formatdatetime_e_with_space_padding}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "0" },
        { label: "Улучшена совместимость с функциями MySQL DATE_FORMAT/STR_TO_DATE" }
      ]
    }
  ]}
/>

Форматтер '%e' в функции 'formatDateTime' выводит однозначные числа дней с начальным пробелом, например ' 2' вместо '2'.


## formatdatetime_f_prints_scale_number_of_digits {#formatdatetime_f_prints_scale_number_of_digits}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.1" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Форматтер '%f' в функции 'formatDateTime' выводит только то количество цифр, которое соответствует масштабу DateTime64, вместо фиксированных 6 цифр.


## formatdatetime_f_prints_single_zero {#formatdatetime_f_prints_single_zero}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.4" },
        { label: "0" },
        {
          label: "Улучшена совместимость с MySQL DATE_FORMAT()/STR_TO_DATE()"
        }
      ]
    }
  ]}
/>

Форматтер '%f' в функции 'formatDateTime' выводит один ноль вместо шести нулей, если форматируемое значение не имеет дробной части секунд.


## formatdatetime_format_without_leading_zeros {#formatdatetime_format_without_leading_zeros}

<SettingsInfoBlock type='Bool' default_value='0' />

Форматеры '%c', '%l' и '%k' в функции 'formatDateTime' выводят месяцы и часы без ведущих нулей.


## formatdatetime_parsedatetime_m_is_month_name {#formatdatetime_parsedatetime_m_is_month_name}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.4" },
        { label: "1" },
        { label: "Улучшена совместимость с MySQL DATE_FORMAT/STR_TO_DATE" }
      ]
    }
  ]}
/>

Форматтер '%M' в функциях 'formatDateTime' и 'parseDateTime' выводит/парсит название месяца вместо минут.


## fsync_metadata {#fsync_metadata}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает [fsync](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fsync.html) при записи файлов `.sql`. По умолчанию включено.

Имеет смысл отключить этот параметр, если на сервере миллионы небольших таблиц, которые постоянно создаются и удаляются.


## function_date_trunc_return_type_behavior {#function_date_trunc_return_type_behavior}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.7" },
        { label: "0" },
        {
          label:
            "Добавлена новая настройка для сохранения прежнего поведения функции dateTrunc"
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "25.4" },
        { label: "0" },
        {
          label:
            "Изменен тип возвращаемого значения функции dateTrunc для аргументов DateTime64/Date32 на DateTime64/Date32 независимо от единицы времени для корректной обработки отрицательных значений"
        }
      ]
    }
  ]}
/>

Позволяет изменить поведение типа возвращаемого значения функции `dateTrunc`.

Возможные значения:

- 0 — Если второй аргумент имеет тип `DateTime64/Date32`, возвращаемый тип будет `DateTime64/Date32` независимо от единицы времени в первом аргументе.
- 1 — Для `Date32` результат всегда имеет тип `Date`. Для `DateTime64` результат имеет тип `DateTime` для единиц времени `second` и выше.


## function_implementation {#function_implementation}

Выбор реализации функции для конкретной целевой платформы или варианта (экспериментальная функция). Если параметр не задан, включаются все доступные реализации.


## function_json_value_return_type_allow_complex {#function_json_value_return_type_allow_complex}

<SettingsInfoBlock type='Bool' default_value='0' />

Управляет возможностью возврата сложных типов данных (таких как struct, array, map) функцией json_value.

```sql
SELECT JSON_VALUE('{"hello":{"world":"!"}}', '$.hello') settings function_json_value_return_type_allow_complex=true

┌─JSON_VALUE('{"hello":{"world":"!"}}', '$.hello')─┐
│ {"world":"!"}                                    │
└──────────────────────────────────────────────────┘

1 row in set. Elapsed: 0.001 sec.
```

Возможные значения:

- true — Разрешено.
- false — Запрещено.


## function_json_value_return_type_allow_nullable {#function_json_value_return_type_allow_nullable}

<SettingsInfoBlock type='Bool' default_value='0' />

Управляет возможностью возврата `NULL`, если значение отсутствует в функции JSON_VALUE.

```sql
SELECT JSON_VALUE('{"hello":"world"}', '$.b') settings function_json_value_return_type_allow_nullable=true;

┌─JSON_VALUE('{"hello":"world"}', '$.b')─┐
│ ᴺᵁᴸᴸ                                   │
└────────────────────────────────────────┘

1 row in set. Elapsed: 0.001 sec.
```

Возможные значения:

- true — Разрешено.
- false — Запрещено.


## function_locate_has_mysql_compatible_argument_order {#function_locate_has_mysql_compatible_argument_order}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "1" },
        { label: "Повышена совместимость с функцией locate MySQL." }
      ]
    }
  ]}
/>

Управляет порядком аргументов в функции [locate](../../sql-reference/functions/string-search-functions.md/#locate).

Возможные значения:

- 0 — Функция `locate` принимает аргументы `(haystack, needle[, start_pos])`.
- 1 — Функция `locate` принимает аргументы `(needle, haystack[, start_pos])` (поведение, совместимое с MySQL)


## function_range_max_elements_in_block {#function_range_max_elements_in_block}

<SettingsInfoBlock type='UInt64' default_value='500000000' />

Устанавливает пороговое значение безопасности для объёма данных, генерируемых функцией [range](/sql-reference/functions/array-functions#range). Определяет максимальное количество значений, генерируемых функцией на блок данных (сумма размеров массивов для каждой строки в блоке).

Возможные значения:

- Положительное целое число.

**См. также**

- [`max_block_size`](#max_block_size)
- [`min_insert_block_size_rows`](#min_insert_block_size_rows)


## function_sleep_max_microseconds_per_block {#function_sleep_max_microseconds_per_block}

<SettingsInfoBlock type='UInt64' default_value='3000000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.7" },
        { label: "3000000" },
        {
          label:
            "В предыдущих версиях максимальное время ожидания в 3 секунды применялось только к функции `sleep`, но не к функции `sleepEachRow`. В новой версии введена данная настройка. При установке совместимости с предыдущими версиями ограничение будет полностью отключено."
        }
      ]
    }
  ]}
/>

Максимальное количество микросекунд, на которое функция `sleep` может приостановить выполнение для каждого блока. Если пользователь вызывает функцию с большим значением, генерируется исключение. Это пороговое значение безопасности.


## function_visible_width_behavior {#function_visible_width_behavior}

<SettingsInfoBlock type='UInt64' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.1" },
        { label: "1" },
        {
          label:
            "Изменено поведение `visibleWidth` по умолчанию для повышения точности"
        }
      ]
    }
  ]}
/>

Версия поведения `visibleWidth`. 0 — подсчитывается только количество кодовых точек; 1 — корректно подсчитываются символы нулевой ширины и комбинирующие символы, полноширинные символы считаются как два, оценивается ширина табуляции, учитываются символы удаления.


## geo_distance_returns_float64_on_float64_arguments {#geo_distance_returns_float64_on_float64_arguments}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "1" },
        { label: "Увеличена точность по умолчанию." }
      ]
    }
  ]}
/>

Если все четыре аргумента функций `geoDistance`, `greatCircleDistance`, `greatCircleAngle` имеют тип Float64, то возвращается Float64 и для внутренних вычислений используется двойная точность. В предыдущих версиях ClickHouse эти функции всегда возвращали Float32.


## geotoh3_argument_order {#geotoh3_argument_order}

<BetaBadge />

<SettingsInfoBlock type='GeoToH3ArgumentOrder' default_value='lat_lon' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "lat_lon" },
        {
          label:
            "Новая настройка для поддержки устаревшего поведения, задающая порядок аргументов lon и lat"
        }
      ]
    }
  ]}
/>

Функция `geoToH3` принимает аргументы в порядке (lon, lat) при значении 'lon_lat' и в порядке (lat, lon) при значении 'lat_lon'.


## glob_expansion_max_elements {#glob_expansion_max_elements}

<SettingsInfoBlock type='UInt64' default_value='1000' />

Максимальное количество допустимых адресов (для внешних хранилищ, табличных функций и т. д.).


## grace_hash_join_initial_buckets {#grace_hash_join_initial_buckets}

<ExperimentalBadge />

<SettingsInfoBlock type='NonZeroUInt64' default_value='1' />

Начальное количество корзин для grace hash join


## grace_hash_join_max_buckets {#grace_hash_join_max_buckets}

<ExperimentalBadge />

<SettingsInfoBlock type='NonZeroUInt64' default_value='1024' />

Ограничение на количество сегментов для grace hash join


## group_by_overflow_mode {#group_by_overflow_mode}

<SettingsInfoBlock type='OverflowModeGroupBy' default_value='throw' />

Определяет, что происходит при превышении лимита количества уникальных ключей для агрегации:

- `throw`: выбросить исключение
- `break`: остановить выполнение запроса и вернуть частичный результат
- `any`: продолжить агрегацию для ключей, которые попали в набор, но не добавлять в набор новые ключи.

Использование значения 'any' позволяет выполнить приближённую агрегацию GROUP BY. Качество
этого приближения зависит от статистических свойств данных.


## group_by_two_level_threshold {#group_by_two_level_threshold}

<SettingsInfoBlock type='UInt64' default_value='100000' />

Количество ключей, при достижении которого начинается двухуровневая агрегация. 0 — порог не установлен.


## group_by_two_level_threshold_bytes {#group_by_two_level_threshold_bytes}

<SettingsInfoBlock type='UInt64' default_value='50000000' />

Размер состояния агрегации в байтах, начиная с которого используется двухуровневая агрегация. 0 — порог не установлен. Двухуровневая агрегация используется при срабатывании хотя бы одного из порогов.


## group_by_use_nulls {#group_by_use_nulls}

<SettingsInfoBlock type='Bool' default_value='0' />

Изменяет способ обработки типов ключей агрегации в [секции GROUP BY](/sql-reference/statements/select/group-by).
При использовании модификаторов `ROLLUP`, `CUBE` или `GROUPING SETS` некоторые ключи агрегации могут не использоваться для формирования отдельных строк результата.
Столбцы для этих ключей заполняются либо значением по умолчанию, либо `NULL` в соответствующих строках в зависимости от этой настройки.

Возможные значения:

- 0 — для формирования отсутствующих значений используется значение по умолчанию для типа ключа агрегации.
- 1 — ClickHouse выполняет `GROUP BY` в соответствии со стандартом SQL. Типы ключей агрегации преобразуются в [Nullable](/sql-reference/data-types/nullable). Столбцы для соответствующих ключей агрегации заполняются значением [NULL](/sql-reference/syntax#null) для строк, в которых эти ключи не использовались.

См. также:

- [Секция GROUP BY](/sql-reference/statements/select/group-by)


## h3togeo_lon_lat_result_order {#h3togeo_lon_lat_result_order}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.1" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Функция `h3ToGeo` возвращает (lon, lat), если значение истинно, иначе (lat, lon).


## handshake_timeout_ms {#handshake_timeout_ms}

<SettingsInfoBlock type='Milliseconds' default_value='10000' />

Тайм-аут в миллисекундах для получения пакета Hello от реплик во время рукопожатия.


## hdfs_create_new_file_on_insert {#hdfs_create_new_file_on_insert}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает создание нового файла при каждой вставке в таблицы с движком HDFS. Если параметр включён, при каждой вставке будет создаваться новый файл HDFS с именем по следующему шаблону:

исходный: `data.Parquet.gz` -> `data.1.Parquet.gz` -> `data.2.Parquet.gz` и т. д.

Возможные значения:

- 0 — запрос `INSERT` добавляет новые данные в конец файла.
- 1 — запрос `INSERT` создаёт новый файл.


## hdfs_ignore_file_doesnt_exist {#hdfs_ignore_file_doesnt_exist}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        {
          label:
            "Позволяет возвращать 0 строк, если запрашиваемые файлы не существуют, вместо генерации исключения в движке таблиц HDFS"
        }
      ]
    }
  ]}
/>

Игнорировать отсутствие файла при чтении определённых ключей, если он не существует.

Возможные значения:

- 1 — `SELECT` возвращает пустой результат.
- 0 — `SELECT` генерирует исключение.


## hdfs_replication {#hdfs_replication}

<SettingsInfoBlock type='UInt64' default_value='0' />

Фактическое количество реплик может быть указано при создании файла HDFS.


## hdfs_skip_empty_files {#hdfs_skip_empty_files}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает пропуск пустых файлов в таблицах с движком [HDFS](../../engines/table-engines/integrations/hdfs.md).

Возможные значения:

- 0 — `SELECT` генерирует исключение, если пустой файл несовместим с запрошенным форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.


## hdfs_throw_on_zero_files_match {#hdfs_throw_on_zero_files_match}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        {
          label:
            "Позволяет генерировать ошибку, когда запрос ListObjects не находит ни одного файла в движке HDFS вместо возврата пустого результата запроса"
        }
      ]
    }
  ]}
/>

Генерировать ошибку, если по правилам раскрытия glob-шаблона не найдено ни одного файла.

Возможные значения:

- 1 — `SELECT` генерирует исключение.
- 0 — `SELECT` возвращает пустой результат.


## hdfs_truncate_on_insert {#hdfs_truncate_on_insert}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает усечение перед вставкой в таблицы с движком hdfs. Если отключено, при попытке вставки в уже существующий файл в HDFS будет выброшено исключение.

Возможные значения:

- 0 — запрос `INSERT` добавляет новые данные в конец файла.
- 1 — запрос `INSERT` заменяет существующее содержимое файла на новые данные.


## hedged_connection_timeout_ms {#hedged_connection_timeout_ms}

<SettingsInfoBlock type='Milliseconds' default_value='50' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.4" },
        { label: "50" },
        {
          label:
            "Начало нового соединения в hedged-запросах через 50 мс вместо 100 для соответствия предыдущему таймауту подключения"
        }
      ]
    }
  ]}
/>

Таймаут подключения для установления соединения с репликой при выполнении hedged-запросов


## hnsw_candidate_list_size_for_search {#hnsw_candidate_list_size_for_search}

<SettingsInfoBlock type='UInt64' default_value='256' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "256" },
        {
          label:
            "Новая настройка. Ранее значение можно было указать в CREATE INDEX, по умолчанию оно составляло 64."
        }
      ]
    }
  ]}
/>

Размер динамического списка кандидатов при поиске по индексу векторного подобия, также известный как 'ef_search'.


## hsts_max_age {#hsts_max_age}

<SettingsInfoBlock type='UInt64' default_value='0' />

Время действия для HSTS. Значение 0 отключает HSTS.


## http_connection_timeout {#http_connection_timeout}

<SettingsInfoBlock type='Seconds' default_value='1' />

Тайм-аут подключения HTTP (в секундах).

Возможные значения:

- Любое положительное целое число.
- 0 — отключено (бесконечный тайм-аут).


## http_headers_progress_interval_ms {#http_headers_progress_interval_ms}

<SettingsInfoBlock type='UInt64' default_value='100' />

Не отправлять HTTP-заголовки X-ClickHouse-Progress чаще указанного интервала.


## http_make_head_request {#http_make_head_request}

<SettingsInfoBlock type='Bool' default_value='1' />

Настройка `http_make_head_request` позволяет выполнять `HEAD`-запрос при чтении данных по HTTP для получения информации о читаемом файле, например его размера. Поскольку эта настройка включена по умолчанию, её может потребоваться отключить в случаях, когда сервер не поддерживает `HEAD`-запросы.


## http_max_field_name_size {#http_max_field_name_size}

<SettingsInfoBlock type='UInt64' default_value='131072' />

Максимальная длина имени поля в заголовке HTTP


## http_max_field_value_size {#http_max_field_value_size}

<SettingsInfoBlock type='UInt64' default_value='131072' />

Максимальная длина значения поля в заголовке HTTP


## http_max_fields {#http_max_fields}

<SettingsInfoBlock type='UInt64' default_value='1000000' />

Максимальное количество полей в заголовке HTTP


## http_max_multipart_form_data_size {#http_max_multipart_form_data_size}

<SettingsInfoBlock type='UInt64' default_value='1073741824' />

Ограничение на размер содержимого multipart/form-data. Эта настройка не может быть передана через параметры URL и должна быть установлена в профиле пользователя. Обратите внимание, что содержимое парсится и внешние таблицы создаются в памяти до начала выполнения запроса. Это единственное ограничение, которое действует на данном этапе (ограничения на максимальное использование памяти и максимальное время выполнения не применяются при чтении данных HTTP-формы).


## http_max_request_param_data_size {#http_max_request_param_data_size}

<SettingsInfoBlock type='UInt64' default_value='10485760' />

Ограничение размера данных запроса, используемых в качестве параметра запроса в предопределённых HTTP-запросах.


## http_max_tries {#http_max_tries}

<SettingsInfoBlock type='UInt64' default_value='10' />

Максимальное количество попыток чтения по протоколу HTTP.


## http_max_uri_size {#http_max_uri_size}

<SettingsInfoBlock type='UInt64' default_value='1048576' />

Задает максимальную длину URI HTTP-запроса.

Возможные значения:

- Положительное целое число.


## http_native_compression_disable_checksumming_on_decompress {#http_native_compression_disable_checksumming_on_decompress}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает проверку контрольной суммы при распаковке данных HTTP POST от клиента. Используется только для нативного формата сжатия ClickHouse (не применяется для `gzip` или `deflate`).

Дополнительную информацию см. в [описании HTTP-интерфейса](../../interfaces/http.md).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.


## http_receive_timeout {#http_receive_timeout}

<SettingsInfoBlock type='Seconds' default_value='30' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.6" },
        { label: "30" },
        { label: "См. http_send_timeout." }
      ]
    }
  ]}
/>

Тайм-аут приёма HTTP (в секундах).

Возможные значения:

- Любое положительное целое число.
- 0 — отключено (бесконечный тайм-аут).


## http_response_buffer_size {#http_response_buffer_size}

<SettingsInfoBlock type='UInt64' default_value='0' />

Количество байтов для буферизации в памяти сервера перед отправкой HTTP-ответа клиенту или записью на диск (когда включена настройка http_wait_end_of_query).


## http_response_headers {#http_response_headers}

<SettingsInfoBlock type='Map' default_value='{}' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.12" }, { label: "" }, { label: "Новая настройка." }]
    }
  ]}
/>

Позволяет добавлять или переопределять HTTP-заголовки, которые сервер возвращает в ответе при успешном выполнении запроса.
Действует только для HTTP-интерфейса.

Если заголовок уже установлен по умолчанию, указанное значение переопределит его.
Если заголовок не был установлен по умолчанию, он будет добавлен в список заголовков.
Заголовки, установленные сервером по умолчанию и не переопределённые этой настройкой, останутся без изменений.

Настройка позволяет задать заголовку константное значение. В настоящее время отсутствует возможность задать заголовку динамически вычисляемое значение.

Ни имена, ни значения не могут содержать управляющие символы ASCII.

Если вы разрабатываете UI-приложение, которое позволяет пользователям изменять настройки, но при этом принимает решения на основе возвращаемых заголовков, рекомендуется ограничить эту настройку режимом только для чтения.

Example: `SET http_response_headers = '{"Content-Type": "image/png"}'`


## http_retry_initial_backoff_ms {#http_retry_initial_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='100' />

Минимальное количество миллисекунд для отсрочки при повторной попытке чтения через HTTP


## http_retry_max_backoff_ms {#http_retry_max_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='10000' />

Максимальное количество миллисекунд для отсрочки при повторных попытках чтения через HTTP


## http_send_timeout {#http_send_timeout}

<SettingsInfoBlock type='Seconds' default_value='30' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.6" },
        { label: "30" },
        {
          label:
            "3 минуты — это слишком долго. Обратите внимание, что это таймаут для одного вызова сетевой записи, а не для всей операции выгрузки."
        }
      ]
    }
  ]}
/>

Таймаут отправки HTTP (в секундах).

Возможные значения:

- Любое положительное целое число.
- 0 — отключено (бесконечный таймаут).

:::note
Применяется только к профилю по умолчанию. Для вступления изменений в силу требуется перезагрузка сервера.
:::


## http_skip_not_found_url_for_globs {#http_skip_not_found_url_for_globs}

<SettingsInfoBlock type='Bool' default_value='1' />

Пропускать URL-адреса для glob-шаблонов с ошибкой HTTP_NOT_FOUND


## http_wait_end_of_query {#http_wait_end_of_query}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает буферизацию HTTP-ответа на стороне сервера.


## http_write_exception_in_output_format {#http_write_exception_in_output_format}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "0" },
        { label: "Изменено для обеспечения согласованности между форматами" }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "23.9" },
        { label: "1" },
        { label: "Вывод корректного JSON/XML при возникновении исключения в HTTP-потоковой передаче." }
      ]
    }
  ]}
/>

Записывать исключение в выходном формате для формирования корректного вывода. Работает с форматами JSON и XML.


## http_zlib_compression_level {#http_zlib_compression_level}

<SettingsInfoBlock type='Int64' default_value='3' />

Задаёт уровень сжатия данных в ответе на HTTP-запрос, если [enable_http_compression = 1](#enable_http_compression).

Возможные значения: числа от 1 до 9.


## iceberg_delete_data_on_drop {#iceberg_delete_data_on_drop}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Определяет, следует ли удалять все файлы Iceberg при удалении таблицы.


## iceberg_insert_max_bytes_in_data_file {#iceberg_insert_max_bytes_in_data_file}

<SettingsInfoBlock type='UInt64' default_value='1073741824' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.9" },
        { label: "1073741824" },
        { label: "Новая настройка." }
      ]
    }
  ]}
/>

Максимальный размер файла данных Iceberg Parquet в байтах при операции INSERT.


## iceberg_insert_max_partitions {#iceberg_insert_max_partitions}

<SettingsInfoBlock type='UInt64' default_value='100' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "100" }, { label: "New setting." }]
    }
  ]}
/>

Максимально допустимое количество партиций на одну операцию вставки для движка таблиц Iceberg.


## iceberg_insert_max_rows_in_data_file {#iceberg_insert_max_rows_in_data_file}

<SettingsInfoBlock type='UInt64' default_value='1000000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.9" },
        { label: "1000000" },
        { label: "Новая настройка." }
      ]
    }
  ]}
/>

Максимальное количество строк в файле данных Iceberg Parquet при операции INSERT.


## iceberg_metadata_compression_method {#iceberg_metadata_compression_method}

<ExperimentalBadge />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "" }, { label: "Новая настройка" }]
    }
  ]}
/>

Метод сжатия файла `.metadata.json`.


## iceberg_metadata_log_level {#iceberg_metadata_log_level}

<SettingsInfoBlock type='IcebergMetadataLogLevel' default_value='none' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "none" }, { label: "Новая настройка." }]
    }
  ]}
/>

Управляет уровнем логирования метаданных таблиц Iceberg в system.iceberg_metadata_log.
Обычно эта настройка изменяется для целей отладки.

Возможные значения:

- none - Логирование метаданных отключено.
- metadata - Корневой файл metadata.json.
- manifest_list_metadata - Всё вышеперечисленное + метаданные из списка манифестов avro, соответствующего снимку состояния.
- manifest_list_entry - Всё вышеперечисленное + записи из списка манифестов avro.
- manifest_file_metadata - Всё вышеперечисленное + метаданные из обрабатываемых файлов манифестов avro.
- manifest_file_entry - Всё вышеперечисленное + записи из обрабатываемых файлов манифестов avro.


## iceberg_snapshot_id {#iceberg_snapshot_id}

<SettingsInfoBlock type='Int64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.4" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Выполнение запроса к таблице Iceberg с использованием указанного идентификатора снимка.


## iceberg_timestamp_ms {#iceberg_timestamp_ms}

<SettingsInfoBlock type='Int64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.4" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Запрос к таблице Iceberg с использованием снимка, который был актуален на указанную временную метку.


## idle_connection_timeout {#idle_connection_timeout}

<SettingsInfoBlock type='UInt64' default_value='3600' />

Таймаут закрытия неактивных TCP-соединений после указанного количества секунд.

Возможные значения:

- Положительное целое число (0 — закрыть немедленно).


## ignore_cold_parts_seconds {#ignore_cold_parts_seconds}

<CloudOnlyBadge />

<SettingsInfoBlock type='Int64' default_value='0' />

Действует только в ClickHouse Cloud. Исключает новые части данных из запросов SELECT до тех пор, пока они не будут предварительно прогреты (см. [cache_populated_by_fetch](merge-tree-settings.md/#cache_populated_by_fetch)) или пока не истечет указанное количество секунд. Только для Replicated-/SharedMergeTree.


## ignore_data_skipping_indices {#ignore_data_skipping_indices}

Игнорирует указанные индексы пропуска данных, если они используются в запросе.

Рассмотрим следующий пример:

```sql
CREATE TABLE data
(
    key Int,
    x Int,
    y Int,
    INDEX x_idx x TYPE minmax GRANULARITY 1,
    INDEX y_idx y TYPE minmax GRANULARITY 1,
    INDEX xy_idx (x,y) TYPE minmax GRANULARITY 1
)
Engine=MergeTree()
ORDER BY key;

INSERT INTO data VALUES (1, 2, 3);

SELECT * FROM data;
SELECT * FROM data SETTINGS ignore_data_skipping_indices=''; -- запрос выдаст ошибку CANNOT_PARSE_TEXT.
SELECT * FROM data SETTINGS ignore_data_skipping_indices='x_idx'; -- OK.
SELECT * FROM data SETTINGS ignore_data_skipping_indices='na_idx'; -- OK.

SELECT * FROM data WHERE x = 1 AND y = 1 SETTINGS ignore_data_skipping_indices='xy_idx',force_data_skipping_indices='xy_idx' ; -- запрос выдаст ошибку INDEX_NOT_USED, поскольку xy_idx явно игнорируется.
SELECT * FROM data WHERE x = 1 AND y = 2 SETTINGS ignore_data_skipping_indices='xy_idx';
```

Запрос без игнорирования индексов:

```sql
EXPLAIN indexes = 1 SELECT * FROM data WHERE x = 1 AND y = 2;

Expression ((Projection + Before ORDER BY))
  Filter (WHERE)
    ReadFromMergeTree (default.data)
    Indexes:
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Skip
        Name: x_idx
        Description: minmax GRANULARITY 1
        Parts: 0/1
        Granules: 0/1
      Skip
        Name: y_idx
        Description: minmax GRANULARITY 1
        Parts: 0/0
        Granules: 0/0
      Skip
        Name: xy_idx
        Description: minmax GRANULARITY 1
        Parts: 0/0
        Granules: 0/0
```

При игнорировании индекса `xy_idx`:

```sql
EXPLAIN indexes = 1 SELECT * FROM data WHERE x = 1 AND y = 2 SETTINGS ignore_data_skipping_indices='xy_idx';

Expression ((Projection + Before ORDER BY))
  Filter (WHERE)
    ReadFromMergeTree (default.data)
    Indexes:
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Skip
        Name: x_idx
        Description: minmax GRANULARITY 1
        Parts: 0/1
        Granules: 0/1
      Skip
        Name: y_idx
        Description: minmax GRANULARITY 1
        Parts: 0/0
        Granules: 0/0
```

Работает с таблицами семейства MergeTree.


## ignore_drop_queries_probability {#ignore_drop_queries_probability}

<SettingsInfoBlock type='Float' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.4" },
        { label: "0" },
        {
          label:
            "Позволяет игнорировать запросы DROP на сервере с указанной вероятностью для целей тестирования"
        }
      ]
    }
  ]}
/>

Если включено, сервер будет игнорировать все запросы DROP TABLE с указанной вероятностью (для движков Memory и JOIN заменяет DROP на TRUNCATE). Используется для целей тестирования


## ignore_materialized_views_with_dropped_target_table {#ignore_materialized_views_with_dropped_target_table}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.1" },
        { label: "0" },
        {
          label:
            "Добавлена новая настройка, позволяющая игнорировать материализованные представления с удалённой целевой таблицей"
        }
      ]
    }
  ]}
/>

Игнорировать материализованные представления с удалённой целевой таблицей при отправке данных в представления


## ignore_on_cluster_for_replicated_access_entities_queries {#ignore_on_cluster_for_replicated_access_entities_queries}

<SettingsInfoBlock type='Bool' default_value='0' />

Игнорировать конструкцию ON CLUSTER для запросов управления реплицируемыми объектами контроля доступа.


## ignore_on_cluster_for_replicated_named_collections_queries {#ignore_on_cluster_for_replicated_named_collections_queries}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "0" },
        {
          label:
            "Игнорировать конструкцию ON CLUSTER для запросов управления реплицируемыми именованными коллекциями."
        }
      ]
    }
  ]}
/>

Игнорировать конструкцию ON CLUSTER для запросов управления реплицируемыми именованными коллекциями.


## ignore_on_cluster_for_replicated_udf_queries {#ignore_on_cluster_for_replicated_udf_queries}

<SettingsInfoBlock type='Bool' default_value='0' />

Игнорировать конструкцию ON CLUSTER для запросов управления реплицируемыми пользовательскими функциями (UDF).


## implicit_select {#implicit_select}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.10" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Позволяет писать простые SELECT-запросы без начального ключевого слова SELECT, что упрощает использование в режиме калькулятора, например `1 + 2` становится корректным запросом.

В `clickhouse-local` данная настройка включена по умолчанию и может быть явно отключена.


## implicit_table_at_top_level {#implicit_table_at_top_level}

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "" },
        { label: "Новая настройка, используется в clickhouse-local" }
      ]
    }
  ]}
/>

Если не пусто, запросы без FROM на верхнем уровне будут читать данные из этой таблицы вместо system.one.

Используется в clickhouse-local для обработки входных данных.
Настройка может быть задана пользователем явно, но не предназначена для такого использования.

Подзапросы не затрагиваются этой настройкой (ни скалярные, ни подзапросы FROM или IN).
SELECT на верхнем уровне цепочек UNION, INTERSECT, EXCEPT обрабатываются единообразно и затрагиваются этой настройкой независимо от группировки в скобках.
Не определено, как эта настройка влияет на представления и распределённые запросы.

Настройка принимает имя таблицы (в этом случае таблица разрешается из текущей базы данных) или квалифицированное имя в форме 'database.table'.
Имена базы данных и таблицы должны быть без кавычек — допускаются только простые идентификаторы.


## implicit_transaction {#implicit_transaction}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

Если параметр включен и запрос еще не выполняется внутри транзакции, оборачивает запрос в полную транзакцию (begin + commit или rollback)


## inject_random_order_for_select_without_order_by {#inject_random_order_for_select_without_order_by}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

При включении добавляет `ORDER BY rand()` в SELECT-запросы без предложения ORDER BY.
Применяется только при глубине подзапроса = 0. Подзапросы и `INSERT INTO ... SELECT` не затрагиваются.
Если конструкция верхнего уровня — UNION, `ORDER BY rand()` добавляется независимо во все дочерние элементы.
Полезно только для тестирования и разработки (отсутствие ORDER BY приводит к недетерминированным результатам запроса).


## input_format_parallel_parsing {#input_format_parallel_parsing}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает параллельный парсинг форматов данных с сохранением порядка. Поддерживается только для форматов [TabSeparated (TSV)](/interfaces/formats/TabSeparated), [TSKV](/interfaces/formats/TSKV), [CSV](/interfaces/formats/CSV) и [JSONEachRow](/interfaces/formats/JSONEachRow).

Возможные значения:

- 1 — Включено.
- 0 — Отключено.


## insert_allow_materialized_columns {#insert_allow_materialized_columns}

<SettingsInfoBlock type='Bool' default_value='0' />

Если настройка включена, разрешает использование материализованных столбцов в INSERT.


## insert_deduplicate {#insert_deduplicate}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает дедупликацию блоков `INSERT` (для таблиц семейства Replicated\*).

Возможные значения:

- 0 — отключено.
- 1 — включено.

По умолчанию блоки, вставляемые в реплицируемые таблицы оператором `INSERT`, дедуплицируются (см. [Репликация данных](../../engines/table-engines/mergetree-family/replication.md)).
Для реплицируемых таблиц по умолчанию дедуплицируются только 100 самых последних блоков для каждой партиции (см. [replicated_deduplication_window](merge-tree-settings.md/#replicated_deduplication_window), [replicated_deduplication_window_seconds](merge-tree-settings.md/#replicated_deduplication_window_seconds)).
Для нереплицируемых таблиц см. [non_replicated_deduplication_window](merge-tree-settings.md/#non_replicated_deduplication_window).


## insert_deduplication_token {#insert_deduplication_token}

Настройка позволяет пользователю определить собственную семантику дедупликации в MergeTree/ReplicatedMergeTree.
Например, указывая уникальное значение для этой настройки в каждом операторе INSERT,
пользователь может предотвратить дедупликацию одних и тех же вставляемых данных.

Возможные значения:

- Любая строка

`insert_deduplication_token` используется для дедупликации _только_ если не пуст.

Для реплицируемых таблиц по умолчанию дедуплицируются только 100 последних вставок для каждой партиции (см. [replicated_deduplication_window](merge-tree-settings.md/#replicated_deduplication_window), [replicated_deduplication_window_seconds](merge-tree-settings.md/#replicated_deduplication_window_seconds)).
Для нереплицируемых таблиц см. [non_replicated_deduplication_window](merge-tree-settings.md/#non_replicated_deduplication_window).

:::note
`insert_deduplication_token` работает на уровне партиции (так же, как контрольная сумма `insert_deduplication`). Несколько партиций могут иметь одинаковый `insert_deduplication_token`.
:::

Пример:

```sql
CREATE TABLE test_table
( A Int64 )
ENGINE = MergeTree
ORDER BY A
SETTINGS non_replicated_deduplication_window = 100;

INSERT INTO test_table SETTINGS insert_deduplication_token = 'test' VALUES (1);

-- следующая вставка не будет дедуплицирована, так как insert_deduplication_token отличается
INSERT INTO test_table SETTINGS insert_deduplication_token = 'test1' VALUES (1);

-- следующая вставка будет дедуплицирована, так как insert_deduplication_token
-- совпадает с одним из предыдущих
INSERT INTO test_table SETTINGS insert_deduplication_token = 'test' VALUES (2);

SELECT * FROM test_table

┌─A─┐
│ 1 │
└───┘
┌─A─┐
│ 1 │
└───┘
```


## insert_keeper_fault_injection_probability {#insert_keeper_fault_injection_probability}

<SettingsInfoBlock type='Float' default_value='0' />

Приблизительная вероятность отказа запроса к keeper при выполнении вставки. Допустимое значение находится в интервале [0.0f, 1.0f]


## insert_keeper_fault_injection_seed {#insert_keeper_fault_injection_seed}

<SettingsInfoBlock type='UInt64' default_value='0' />

0 — случайное начальное значение (seed), иначе — значение настройки


## insert_keeper_max_retries {#insert_keeper_max_retries}

<SettingsInfoBlock type='UInt64' default_value='20' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.2" },
        { label: "20" },
        {
          label: "Включены переподключения к Keeper при INSERT, повышена надёжность"
        }
      ]
    }
  ]}
/>

Настройка задаёт максимальное количество повторных попыток для запросов к ClickHouse Keeper (или ZooKeeper) при вставке данных в реплицируемую таблицу MergeTree. Повторным попыткам подлежат только те запросы к Keeper, которые завершились неудачей из-за сетевой ошибки, истечения времени сеанса Keeper или превышения времени ожидания запроса.

Возможные значения:

- Положительное целое число.
- 0 — повторные попытки отключены.

Значение по умолчанию в Cloud: `20`.

Повторные попытки запросов к Keeper выполняются после определённой задержки. Задержка управляется следующими настройками: `insert_keeper_retry_initial_backoff_ms`, `insert_keeper_retry_max_backoff_ms`.
Первая повторная попытка выполняется после задержки `insert_keeper_retry_initial_backoff_ms`. Последующие задержки рассчитываются по формуле:

```
timeout = min(insert_keeper_retry_max_backoff_ms, latest_timeout * 2)
```

Например, если `insert_keeper_retry_initial_backoff_ms=100`, `insert_keeper_retry_max_backoff_ms=10000` и `insert_keeper_max_retries=8`, то задержки составят `100, 200, 400, 800, 1600, 3200, 6400, 10000`.

Помимо отказоустойчивости, повторные попытки улучшают пользовательский опыт — они позволяют избежать возврата ошибки при выполнении INSERT в случае перезапуска Keeper, например, при обновлении.


## insert_keeper_retry_initial_backoff_ms {#insert_keeper_retry_initial_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='100' />

Начальное значение тайм-аута (в миллисекундах) для повторной попытки выполнения неудавшегося запроса к Keeper во время выполнения запроса INSERT

Возможные значения:

- Положительное целое число.
- 0 — без тайм-аута


## insert_keeper_retry_max_backoff_ms {#insert_keeper_retry_max_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='10000' />

Максимальный таймаут (в миллисекундах) для повторных попыток неудавшегося запроса к Keeper при выполнении запроса INSERT

Возможные значения:

- Положительное целое число.
- 0 — максимальный таймаут не ограничен


## insert_null_as_default {#insert_null_as_default}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает вставку [значений по умолчанию](/sql-reference/statements/create/table#default_values) вместо [NULL](/sql-reference/syntax#null) в столбцы с типом данных, не являющимся [nullable](/sql-reference/data-types/nullable).
Если тип столбца не является nullable и эта настройка отключена, то вставка `NULL` вызывает исключение. Если тип столбца является nullable, то значения `NULL` вставляются как есть, независимо от этой настройки.

Эта настройка применима к запросам [INSERT ... SELECT](../../sql-reference/statements/insert-into.md/#inserting-the-results-of-select). Обратите внимание, что подзапросы `SELECT` могут быть объединены с помощью конструкции `UNION ALL`.

Возможные значения:

- 0 — Вставка `NULL` в столбец, не являющийся nullable, вызывает исключение.
- 1 — Вместо `NULL` вставляется значение столбца по умолчанию.


## insert_quorum {#insert_quorum}

<SettingsInfoBlock type='UInt64Auto' default_value='0' />

:::note
Эта настройка не применима к SharedMergeTree, подробнее см. [Согласованность SharedMergeTree](/cloud/reference/shared-merge-tree#consistency).
:::

Включает запись с кворумом.

- Если `insert_quorum < 2`, запись с кворумом отключена.
- Если `insert_quorum >= 2`, запись с кворумом включена.
- Если `insert_quorum = 'auto'`, в качестве числа кворума используется большинство (`number_of_replicas / 2 + 1`).

Запись с кворумом

`INSERT` выполняется успешно только в том случае, если ClickHouse успевает корректно записать данные в `insert_quorum` реплик в течение `insert_quorum_timeout`. Если по какой-либо причине количество реплик с успешной записью не достигает `insert_quorum`, запись считается неудачной, и ClickHouse удалит вставленный блок со всех реплик, в которые данные уже были записаны.

Когда `insert_quorum_parallel` отключен, все реплики в кворуме согласованы, т. е. они содержат данные из всех предыдущих запросов `INSERT` (последовательность `INSERT` линеаризована). При чтении данных, записанных с использованием `insert_quorum` при отключенном `insert_quorum_parallel`, можно включить последовательную согласованность для запросов `SELECT` с помощью [select_sequential_consistency](#select_sequential_consistency).

ClickHouse генерирует исключение:

- Если количество доступных реплик на момент выполнения запроса меньше `insert_quorum`.
- Когда `insert_quorum_parallel` отключен и выполняется попытка записи данных в то время, когда предыдущий блок еще не был вставлен в `insert_quorum` реплик. Эта ситуация может возникнуть, если пользователь пытается выполнить еще один запрос `INSERT` в ту же таблицу до завершения предыдущего запроса с `insert_quorum`.

См. также:

- [insert_quorum_timeout](#insert_quorum_timeout)
- [insert_quorum_parallel](#insert_quorum_parallel)
- [select_sequential_consistency](#select_sequential_consistency)


## insert_quorum_parallel {#insert_quorum_parallel}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "21.1" },
        { label: "1" },
        {
          label:
            "По умолчанию используются параллельные вставки с кворумом. Это значительно удобнее последовательных вставок с кворумом"
        }
      ]
    }
  ]}
/>

:::note
Эта настройка неприменима к SharedMergeTree, подробнее см. в разделе [Согласованность SharedMergeTree](/cloud/reference/shared-merge-tree#consistency).
:::

Включает или отключает параллелизм для запросов `INSERT` с кворумом. Если параметр включён, дополнительные запросы `INSERT` могут отправляться до завершения предыдущих запросов. Если параметр отключён, дополнительные записи в ту же таблицу будут отклонены.

Возможные значения:

- 0 — отключено.
- 1 — включено.

См. также:

- [insert_quorum](#insert_quorum)
- [insert_quorum_timeout](#insert_quorum_timeout)
- [select_sequential_consistency](#select_sequential_consistency)


## insert_quorum_timeout {#insert_quorum_timeout}

<SettingsInfoBlock type='Milliseconds' default_value='600000' />

Таймаут записи с кворумом в миллисекундах. Если таймаут истёк, а запись ещё не выполнена, ClickHouse сгенерирует исключение, и клиент должен повторить запрос для записи того же блока данных в ту же или любую другую реплику.

См. также:

- [insert_quorum](#insert_quorum)
- [insert_quorum_parallel](#insert_quorum_parallel)
- [select_sequential_consistency](#select_sequential_consistency)


## insert_shard_id {#insert_shard_id}

<SettingsInfoBlock type='UInt64' default_value='0' />

Если значение не равно `0`, указывает шард таблицы [Distributed](/engines/table-engines/special/distributed), в который данные будут вставлены синхронно.

Если значение `insert_shard_id` некорректно, сервер вернёт исключение.

Чтобы получить количество шардов в `requested_cluster`, можно проверить конфигурацию сервера или использовать следующий запрос:

```sql
SELECT uniq(shard_num) FROM system.clusters WHERE cluster = 'requested_cluster';
```

Возможные значения:

- 0 — отключено.
- Любое число от `1` до `shards_num` соответствующей таблицы [Distributed](/engines/table-engines/special/distributed).

**Пример**

Запрос:

```sql
CREATE TABLE x AS system.numbers ENGINE = MergeTree ORDER BY number;
CREATE TABLE x_dist AS x ENGINE = Distributed('test_cluster_two_shards_localhost', currentDatabase(), x);
INSERT INTO x_dist SELECT * FROM numbers(5) SETTINGS insert_shard_id = 1;
SELECT * FROM x_dist ORDER BY number ASC;
```

Результат:

```text
┌─number─┐
│      0 │
│      0 │
│      1 │
│      1 │
│      2 │
│      2 │
│      3 │
│      3 │
│      4 │
│      4 │
└────────┘
```


## interactive_delay {#interactive_delay}

<SettingsInfoBlock type='UInt64' default_value='100000' />

Интервал в микросекундах для проверки отмены выполнения запроса и отправки информации о прогрессе.


## intersect_default_mode {#intersect_default_mode}

<SettingsInfoBlock type='SetOperationMode' default_value='ALL' />

Устанавливает режим по умолчанию для запроса INTERSECT. Возможные значения: пустая строка, 'ALL', 'DISTINCT'. Если параметр пустой, запрос без явного указания режима вызовет исключение.


## jemalloc_collect_profile_samples_in_trace_log {#jemalloc_collect_profile_samples_in_trace_log}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Собирать образцы выделения и освобождения памяти jemalloc в журнале трассировки.


## jemalloc_enable_profiler {#jemalloc_enable_profiler}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Включает профилировщик jemalloc для запроса. Jemalloc будет производить выборку выделений памяти и всех освобождений для выбранных выделений.
Профили можно сбросить с помощью SYSTEM JEMALLOC FLUSH PROFILE, что позволяет анализировать выделение памяти.
Образцы также можно сохранять в system.trace_log с помощью конфигурационного параметра jemalloc_collect_global_profile_samples_in_trace_log или настройки запроса jemalloc_collect_profile_samples_in_trace_log.
См. [Профилирование выделения памяти](/operations/allocation-profiling)


## join_algorithm {#join_algorithm}

<SettingsInfoBlock
  type='JoinAlgorithm'
  default_value='direct,parallel_hash,hash'
/>

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.12" },
        { label: "direct,parallel_hash,hash" },
        {
          label:
            "Значение 'default' объявлено устаревшим в пользу явного указания алгоритмов соединения, также parallel_hash теперь предпочтительнее hash"
        }
      ]
    }
  ]}
/>

Определяет, какой алгоритм [JOIN](../../sql-reference/statements/select/join.md) используется.

Можно указать несколько алгоритмов, и для конкретного запроса будет выбран подходящий на основе типа/строгости соединения и движка таблицы.

Возможные значения:

- grace_hash

Используется [Grace hash join](https://en.wikipedia.org/wiki/Hash_join#Grace_hash_join). Grace hash предоставляет вариант алгоритма, обеспечивающий производительные сложные соединения при ограниченном использовании памяти.

На первой фазе grace join правая таблица считывается и разделяется на N сегментов в зависимости от хеш-значения ключевых столбцов (изначально N равно `grace_hash_join_initial_buckets`). Это выполняется таким образом, чтобы каждый сегмент мог обрабатываться независимо. Строки из первого сегмента добавляются в хеш-таблицу в памяти, остальные сохраняются на диск. Если хеш-таблица превышает лимит памяти (например, установленный параметром [`max_bytes_in_join`](/operations/settings/settings#max_bytes_in_join)), количество сегментов увеличивается и назначенный сегмент для каждой строки пересчитывается. Строки, не принадлежащие текущему сегменту, сбрасываются и переназначаются.

Поддерживает `INNER/LEFT/RIGHT/FULL ALL/ANY JOIN`.

- hash

Используется [алгоритм Hash join](https://en.wikipedia.org/wiki/Hash_join). Наиболее универсальная реализация, поддерживающая все комбинации типов и строгости соединения, а также несколько ключей соединения, объединённых через `OR` в секции `JOIN ON`.

При использовании алгоритма `hash` правая часть `JOIN` загружается в оперативную память.

- parallel_hash

Вариант `hash` join, который разделяет данные на сегменты и параллельно строит несколько хеш-таблиц вместо одной для ускорения процесса.

При использовании алгоритма `parallel_hash` правая часть `JOIN` загружается в оперативную память.

- partial_merge

Вариант [алгоритма sort-merge](https://en.wikipedia.org/wiki/Sort-merge_join), при котором полностью сортируется только правая таблица.

`RIGHT JOIN` и `FULL JOIN` поддерживаются только со строгостью `ALL` (`SEMI`, `ANTI`, `ANY` и `ASOF` не поддерживаются).

При использовании алгоритма `partial_merge` ClickHouse сортирует данные и сбрасывает их на диск. Алгоритм `partial_merge` в ClickHouse немного отличается от классической реализации. Сначала ClickHouse сортирует правую таблицу по ключам соединения в блоках и создаёт min-max индекс для отсортированных блоков. Затем сортирует части левой таблицы по `join key` и соединяет их с правой таблицей. Min-max индекс также используется для пропуска ненужных блоков правой таблицы.

- direct

Этот алгоритм применим, когда хранилище правой таблицы поддерживает запросы типа ключ-значение.

Алгоритм `direct` выполняет поиск в правой таблице, используя строки из левой таблицы в качестве ключей. Поддерживается только специальными хранилищами, такими как [Dictionary](/engines/table-engines/special/dictionary) или [EmbeddedRocksDB](../../engines/table-engines/integrations/embedded-rocksdb.md), и только для `LEFT` и `INNER` JOIN.

- auto

При установке значения `auto` сначала используется `hash` join, и алгоритм переключается на лету на другой алгоритм при превышении лимита памяти.

- full_sorting_merge

[Алгоритм sort-merge](https://en.wikipedia.org/wiki/Sort-merge_join) с полной сортировкой соединяемых таблиц перед соединением.

- prefer_partial_merge

ClickHouse всегда пытается использовать `partial_merge` join, если это возможно, в противном случае использует `hash`. _Устарело_, эквивалентно `partial_merge,hash`.

- default (устарело)

Устаревшее значение, не рекомендуется к использованию.
Эквивалентно `direct,hash`, т. е. попытка использовать direct join и hash join (в указанном порядке).


## join_any_take_last_row {#join_any_take_last_row}

<SettingsInfoBlock type='Bool' default_value='0' />

Изменяет поведение операций соединения со строгостью `ANY`.

:::note
Эта настройка применяется только к операциям `JOIN` с таблицами движка [Join](../../engines/table-engines/special/join.md).
:::

Возможные значения:

- 0 — Если в правой таблице найдено более одной совпадающей строки, присоединяется только первая.
- 1 — Если в правой таблице найдено более одной совпадающей строки, присоединяется только последняя.

См. также:

- [Секция JOIN](/sql-reference/statements/select/join)
- [Движок таблиц Join](../../engines/table-engines/special/join.md)
- [join_default_strictness](#join_default_strictness)


## join_default_strictness {#join_default_strictness}

<SettingsInfoBlock type='JoinStrictness' default_value='ALL' />

Устанавливает строгость по умолчанию для [конструкций JOIN](/sql-reference/statements/select/join).

Возможные значения:

- `ALL` — если в правой таблице найдено несколько совпадающих строк, ClickHouse создаёт [декартово произведение](https://en.wikipedia.org/wiki/Cartesian_product) из совпадающих строк. Это стандартное поведение `JOIN` из SQL.
- `ANY` — если в правой таблице найдено несколько совпадающих строк, присоединяется только первая найденная. Если в правой таблице только одна совпадающая строка, результаты `ANY` и `ALL` идентичны.
- `ASOF` — для соединения последовательностей с неточным совпадением.
- `Пустая строка` — если в запросе не указано `ALL` или `ANY`, ClickHouse генерирует исключение.


## join_on_disk_max_files_to_merge {#join_on_disk_max_files_to_merge}

<SettingsInfoBlock type='UInt64' default_value='64' />

Ограничивает количество файлов, разрешённых для параллельной сортировки в операциях MergeJoin при выполнении на диске.

Чем больше значение настройки, тем больше используется оперативной памяти и тем меньше требуется дисковых операций ввода-вывода.

Возможные значения:

- Любое положительное целое число начиная с 2.


## join_output_by_rowlist_perkey_rows_threshold {#join_output_by_rowlist_perkey_rows_threshold}

<SettingsInfoBlock type='UInt64' default_value='5' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.9" },
        { label: "5" },
        {
          label:
            "Нижний порог среднего количества строк на ключ в правой таблице для определения того, следует ли выводить результат в виде списка строк при hash join."
        }
      ]
    }
  ]}
/>

Нижний порог среднего количества строк на ключ в правой таблице для определения того, следует ли выводить результат в виде списка строк при hash join.


## join_overflow_mode {#join_overflow_mode}

<SettingsInfoBlock type='OverflowMode' default_value='throw' />

Определяет действие, которое выполняет ClickHouse при достижении любого из следующих ограничений соединения:

- [max_bytes_in_join](/operations/settings/settings#max_bytes_in_join)
- [max_rows_in_join](/operations/settings/settings#max_rows_in_join)

Возможные значения:

- `THROW` — ClickHouse выбрасывает исключение и прерывает операцию.
- `BREAK` — ClickHouse прерывает операцию без выброса исключения.

Значение по умолчанию: `THROW`.

**См. также**

- [Секция JOIN](/sql-reference/statements/select/join)
- [Движок таблиц Join](/engines/table-engines/special/join)


## join_runtime_bloom_filter_bytes {#join_runtime_bloom_filter_bytes}

<ExperimentalBadge />

<SettingsInfoBlock type='UInt64' default_value='524288' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "524288" }, { label: "Новая настройка" }]
    }
  ]}
/>

Размер в байтах фильтра Блума, используемого в качестве runtime-фильтра JOIN (см. настройку enable_join_runtime_filters).


## join_runtime_bloom_filter_hash_functions {#join_runtime_bloom_filter_hash_functions}

<ExperimentalBadge />

<SettingsInfoBlock type='UInt64' default_value='3' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "3" }, { label: "Новая настройка" }]
    }
  ]}
/>

Количество хеш-функций в фильтре Блума, используемом в качестве фильтра времени выполнения для JOIN (см. настройку enable_join_runtime_filters).


## join_runtime_filter_exact_values_limit {#join_runtime_filter_exact_values_limit}

<ExperimentalBadge />

<SettingsInfoBlock type='UInt64' default_value='10000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "10000" }, { label: "New setting" }]
    }
  ]}
/>

Максимальное количество элементов в runtime-фильтре, которые хранятся в виде множества. При превышении этого порога происходит переключение на bloom-фильтр.


## join_to_sort_maximum_table_rows {#join_to_sort_maximum_table_rows}

<ExperimentalBadge />

<SettingsInfoBlock type='UInt64' default_value='10000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.9" },
        { label: "10000" },
        {
          label:
            "Максимальное количество строк в правой таблице для определения необходимости пересортировки правой таблицы по ключу при выполнении LEFT или INNER JOIN"
        }
      ]
    }
  ]}
/>

Максимальное количество строк в правой таблице для определения необходимости пересортировки правой таблицы по ключу при выполнении LEFT или INNER JOIN.


## join_to_sort_minimum_perkey_rows {#join_to_sort_minimum_perkey_rows}

<ExperimentalBadge />

<SettingsInfoBlock type='UInt64' default_value='40' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.9" },
        { label: "40" },
        {
          label:
            "Нижний предел среднего количества строк на ключ в правой таблице для определения необходимости переупорядочивания правой таблицы по ключу при левом или внутреннем соединении. Эта настройка гарантирует, что оптимизация не применяется для разреженных ключей таблицы"
        }
      ]
    }
  ]}
/>

Нижний предел среднего количества строк на ключ в правой таблице для определения необходимости переупорядочивания правой таблицы по ключу при левом или внутреннем соединении. Эта настройка гарантирует, что оптимизация не применяется для разреженных ключей таблицы


## join_use_nulls {#join_use_nulls}

<SettingsInfoBlock type='Bool' default_value='0' />

Определяет тип поведения [JOIN](../../sql-reference/statements/select/join.md). При объединении таблиц могут появляться пустые ячейки. ClickHouse заполняет их по-разному в зависимости от этой настройки.

Возможные значения:

- 0 — Пустые ячейки заполняются значением по умолчанию соответствующего типа поля.
- 1 — `JOIN` ведёт себя так же, как в стандартном SQL. Тип соответствующего поля преобразуется в [Nullable](/sql-reference/data-types/nullable), а пустые ячейки заполняются значением [NULL](/sql-reference/syntax).


## joined_block_split_single_row {#joined_block_split_single_row}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Позволяет разбивать результат хеш-соединения на блоки по строкам, соответствующим одной строке из левой таблицы.
Это может снизить потребление памяти в случае строки с большим количеством совпадений в правой таблице, но может увеличить нагрузку на процессор.
Обратите внимание, что для работы этой настройки обязательно условие `max_joined_block_size_rows != 0`.
Настройка `max_joined_block_size_bytes` в сочетании с данной настройкой помогает избежать чрезмерного потребления памяти в случае несбалансированных данных с большими строками, имеющими много совпадений в правой таблице.


## joined_subquery_requires_alias {#joined_subquery_requires_alias}

<SettingsInfoBlock type='Bool' default_value='1' />

Требовать указание псевдонимов для объединяемых подзапросов и табличных функций для корректной квалификации имён.


## kafka_disable_num_consumers_limit {#kafka_disable_num_consumers_limit}

<SettingsInfoBlock type='Bool' default_value='0' />

Отключает ограничение на kafka_num_consumers, которое зависит от количества доступных ядер процессора.


## kafka_max_wait_ms {#kafka_max_wait_ms}

<SettingsInfoBlock type='Milliseconds' default_value='5000' />

Время ожидания в миллисекундах при чтении сообщений из [Kafka](/engines/table-engines/integrations/kafka) перед повторной попыткой.

Возможные значения:

- Положительное целое число.
- 0 — бесконечное время ожидания.

См. также:

- [Apache Kafka](https://kafka.apache.org/)


## keeper_map_strict_mode {#keeper_map_strict_mode}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает дополнительные проверки при операциях с KeeperMap. Например, генерирует исключение при попытке вставки ключа, который уже существует


## keeper_max_retries {#keeper_max_retries}

<SettingsInfoBlock type='UInt64' default_value='10' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "10" },
        { label: "Максимальное количество повторных попыток для общих операций keeper" }
      ]
    }
  ]}
/>

Максимальное количество повторных попыток для общих операций keeper


## keeper_retry_initial_backoff_ms {#keeper_retry_initial_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='100' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "100" },
        { label: "Начальный таймаут задержки для общих операций keeper" }
      ]
    }
  ]}
/>

Начальный таймаут задержки для общих операций keeper


## keeper_retry_max_backoff_ms {#keeper_retry_max_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='5000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "5000" },
        { label: "Максимальный таймаут отсрочки для общих операций keeper" }
      ]
    }
  ]}
/>

Максимальный таймаут отсрочки для общих операций keeper


## least_greatest_legacy_null_behavior {#least_greatest_legacy_null_behavior}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.12" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Если включено, функции 'least' и 'greatest' возвращают NULL, если один из их аргументов имеет значение NULL.


## legacy_column_name_of_tuple_literal {#legacy_column_name_of_tuple_literal}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "21.7" },
        { label: "0" },
        {
          label:
            "Добавьте эту настройку только для обеспечения совместимости. Имеет смысл установить значение 'true' при выполнении последовательного обновления кластера с версии ниже 21.7 до более поздней"
        }
      ]
    }
  ]}
/>

Перечислять все имена элементов больших кортежных литералов в именах столбцов вместо хеша. Эта настройка существует только для обеспечения совместимости. Имеет смысл установить значение 'true' при выполнении последовательного обновления кластера с версии ниже 21.7 до более поздней.


## lightweight_delete_mode {#lightweight_delete_mode}

<SettingsInfoBlock type='LightweightDeleteMode' default_value='alter_update' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "alter_update" },
        { label: "Новая настройка" }
      ]
    }
  ]}
/>

Режим внутреннего запроса обновления, выполняемого в рамках облегченного удаления.

Возможные значения:

- `alter_update` — выполнить запрос `ALTER UPDATE`, создающий тяжеловесную мутацию.
- `lightweight_update` — выполнить облегченное обновление, если возможно, в противном случае выполнить `ALTER UPDATE`.
- `lightweight_update_force` — выполнить облегченное обновление, если возможно, в противном случае выбросить исключение.


## lightweight_deletes_sync {#lightweight_deletes_sync}

<SettingsInfoBlock type='UInt64' default_value='2' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.4" },
        { label: "2" },
        {
          label:
            "Аналогично 'mutation_sync', но управляет только выполнением легковесных удалений"
        }
      ]
    }
  ]}
/>

Аналогично [`mutations_sync`](#mutations_sync), но управляет только выполнением легковесных удалений.

Возможные значения:

| Значение | Описание                                                                                                                                                      |
| -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `0`      | Мутации выполняются асинхронно.                                                                                                                               |
| `1`      | Запрос ожидает завершения легковесных удалений на текущем сервере.                                                                                            |
| `2`      | Запрос ожидает завершения легковесных удалений на всех репликах (если они существуют).                                                                        |
| `3`      | Запрос ожидает только активных реплик. Поддерживается только для `SharedMergeTree`. Для `ReplicatedMergeTree` ведёт себя так же, как `mutations_sync = 2`. |

**См. также**

- [Синхронность запросов ALTER](../../sql-reference/statements/alter/index.md/#synchronicity-of-alter-queries)
- [Мутации](../../sql-reference/statements/alter/index.md/#mutations)


## limit {#limit}

<SettingsInfoBlock type='UInt64' default_value='0' />

Устанавливает максимальное количество строк, получаемых из результата запроса. Корректирует значение, заданное конструкцией [LIMIT](/sql-reference/statements/select/limit), так что лимит, указанный в запросе, не может превышать лимит, установленный данной настройкой.

Возможные значения:

- 0 — количество строк не ограничено.
- Положительное целое число.


## load_balancing {#load_balancing}

<SettingsInfoBlock type='LoadBalancing' default_value='random' />

Определяет алгоритм выбора реплик для обработки распределённых запросов.

ClickHouse поддерживает следующие алгоритмы выбора реплик:

- [Random](#load_balancing-random) (по умолчанию)
- [Nearest hostname](#load_balancing-nearest_hostname)
- [Hostname levenshtein distance](#load_balancing-hostname_levenshtein_distance)
- [In order](#load_balancing-in_order)
- [First or random](#load_balancing-first_or_random)
- [Round robin](#load_balancing-round_robin)

См. также:

- [distributed_replica_max_ignored_errors](#distributed_replica_max_ignored_errors)

### Random (по умолчанию) {#load_balancing-random}

```sql
load_balancing = random
```

Для каждой реплики подсчитывается количество ошибок. Запрос отправляется на реплику с наименьшим количеством ошибок, а если таких несколько — на любую из них.
Недостатки: близость серверов не учитывается; если реплики содержат разные данные, результаты также будут различаться.

### Nearest Hostname {#load_balancing-nearest_hostname}

```sql
load_balancing = nearest_hostname
```

Для каждой реплики подсчитывается количество ошибок. Каждые 5 минут количество ошибок делится нацело на 2. Таким образом, количество ошибок рассчитывается за недавний период времени с экспоненциальным сглаживанием. Если есть одна реплика с минимальным количеством ошибок (т.е. ошибки недавно произошли на других репликах), запрос отправляется на неё. Если есть несколько реплик с одинаковым минимальным количеством ошибок, запрос отправляется на реплику с именем хоста, наиболее похожим на имя хоста сервера в конфигурационном файле (по количеству различающихся символов в идентичных позициях, до минимальной длины обоих имён хостов).

Например, example01-01-1 и example01-01-2 различаются в одной позиции, в то время как example01-01-1 и example01-02-2 различаются в двух позициях.
Этот метод может показаться примитивным, но он не требует внешних данных о топологии сети и не сравнивает IP-адреса, что было бы сложно для IPv6-адресов.

Таким образом, если есть эквивалентные реплики, предпочтение отдаётся ближайшей по имени.
Также можно предположить, что при отправке запроса на один и тот же сервер в отсутствие сбоев распределённый запрос также будет направлен на те же серверы. Поэтому даже если на репликах размещены разные данные, запрос вернёт в основном одинаковые результаты.

### Hostname levenshtein distance {#load_balancing-hostname_levenshtein_distance}

```sql
load_balancing = hostname_levenshtein_distance
```

Аналогично `nearest_hostname`, но сравнивает имена хостов с использованием [расстояния Левенштейна](https://en.wikipedia.org/wiki/Levenshtein_distance). Например:

```text
example-clickhouse-0-0 ample-clickhouse-0-0
1

example-clickhouse-0-0 example-clickhouse-1-10
2

example-clickhouse-0-0 example-clickhouse-12-0
3
```

### In Order {#load_balancing-in_order}

```sql
load_balancing = in_order
```

Реплики с одинаковым количеством ошибок опрашиваются в том же порядке, в котором они указаны в конфигурации.
Этот метод подходит, когда вы точно знаете, какая реплика предпочтительнее.

### First or Random {#load_balancing-first_or_random}

```sql
load_balancing = first_or_random
```

Этот алгоритм выбирает первую реплику в наборе или случайную реплику, если первая недоступна. Он эффективен в топологиях с перекрёстной репликацией, но бесполезен в других конфигурациях.

Алгоритм `first_or_random` решает проблему алгоритма `in_order`. При использовании `in_order`, если одна реплика выходит из строя, следующая получает двойную нагрузку, в то время как остальные реплики обрабатывают обычный объём трафика. При использовании алгоритма `first_or_random` нагрузка равномерно распределяется между доступными репликами.

Можно явно определить, какая реплика является первой, используя настройку `load_balancing_first_offset`. Это даёт больше контроля для перебалансировки нагрузки запросов между репликами.

### Round Robin {#load_balancing-round_robin}

```sql
load_balancing = round_robin
```

Этот алгоритм использует политику циклического перебора между репликами с одинаковым количеством ошибок (учитываются только запросы с политикой `round_robin`).


## load_balancing_first_offset {#load_balancing_first_offset}

<SettingsInfoBlock type='UInt64' default_value='0' />

Какую реплику предпочтительно использовать для отправки запроса при использовании стратегии балансировки нагрузки FIRST_OR_RANDOM.


## load_marks_asynchronously {#load_marks_asynchronously}

<SettingsInfoBlock type='Bool' default_value='0' />

Асинхронная загрузка меток MergeTree


## local_filesystem_read_method {#local_filesystem_read_method}

<SettingsInfoBlock type='String' default_value='pread_threadpool' />

Метод чтения данных из локальной файловой системы. Возможные значения: read, pread, mmap, io_uring, pread_threadpool.

Метод 'io_uring' является экспериментальным и не работает для таблиц Log, TinyLog, StripeLog, File, Set и Join, а также других таблиц с файлами, допускающими добавление данных, при одновременном выполнении операций чтения и записи.
Если вы читаете различные статьи об 'io_uring' в интернете, не стоит безоговорочно им доверять. Это не лучший метод чтения файлов, за исключением случаев с большим количеством мелких запросов ввода-вывода, что нехарактерно для ClickHouse. Нет оснований включать 'io_uring'.


## local_filesystem_read_prefetch {#local_filesystem_read_prefetch}

<SettingsInfoBlock type='Bool' default_value='0' />

Использовать ли предварительную загрузку при чтении данных из локальной файловой системы.


## lock_acquire_timeout {#lock_acquire_timeout}

<SettingsInfoBlock type='Seconds' default_value='120' />

Определяет, сколько секунд запрос на блокировку ожидает перед тем, как завершиться с ошибкой.

Тайм-аут блокировки используется для защиты от взаимных блокировок при выполнении операций чтения/записи с таблицами. Когда тайм-аут истекает и запрос на блокировку завершается с ошибкой, сервер ClickHouse выбрасывает исключение "Locking attempt timed out! Possible deadlock avoided. Client should retry." с кодом ошибки `DEADLOCK_AVOIDED`.

Возможные значения:

- Положительное целое число (в секундах).
- 0 — без тайм-аута блокировки.


## log_comment {#log_comment}

Задает значение для поля `log_comment` таблицы [system.query_log](../system-tables/query_log.md) и текст комментария для лога сервера.

Может использоваться для улучшения читаемости логов сервера. Кроме того, помогает выбирать запросы, связанные с тестом, из `system.query_log` после запуска [clickhouse-test](../../development/tests.md).

Возможные значения:

- Любая строка длиной не более [max_query_size](#max_query_size). Если значение max_query_size превышено, сервер генерирует исключение.

**Пример**

Запрос:

```sql
SET log_comment = 'log_comment test', log_queries = 1;
SELECT 1;
SYSTEM FLUSH LOGS;
SELECT type, query FROM system.query_log WHERE log_comment = 'log_comment test' AND event_date >= yesterday() ORDER BY event_time DESC LIMIT 2;
```

Результат:

```text
┌─type────────┬─query─────┐
│ QueryStart  │ SELECT 1; │
│ QueryFinish │ SELECT 1; │
└─────────────┴───────────┘
```


## log_formatted_queries {#log_formatted_queries}

<SettingsInfoBlock type='Bool' default_value='0' />

Позволяет записывать отформатированные запросы в системную таблицу [system.query_log](../../operations/system-tables/query_log.md) (заполняет столбец `formatted_query` в [system.query_log](../../operations/system-tables/query_log.md)).

Возможные значения:

- 0 — отформатированные запросы не записываются в системную таблицу.
- 1 — отформатированные запросы записываются в системную таблицу.


## log_processors_profiles {#log_processors_profiles}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.3" }, { label: "1" }, { label: "Включено по умолчанию" }]
    }
  ]}
/>

Записывать в таблицу `system.processors_profile_log` время, затраченное процессором на выполнение и ожидание данных.

См. также:

- [`system.processors_profile_log`](../../operations/system-tables/processors_profile_log.md)
- [`EXPLAIN PIPELINE`](../../sql-reference/statements/explain.md/#explain-pipeline)


## log_profile_events {#log_profile_events}

<SettingsInfoBlock type='Bool' default_value='1' />

Записывать статистику производительности запросов в query_log, query_thread_log и query_views_log.


## log_queries {#log_queries}

<SettingsInfoBlock type='Bool' default_value='1' />

Настройка журналирования запросов.

Запросы, отправленные в ClickHouse при включенной настройке, записываются в журнал согласно правилам, определённым в параметре конфигурации сервера [query_log](../../operations/server-configuration-parameters/settings.md/#query_log).

Пример:

```text
log_queries=1
```


## log_queries_cut_to_length {#log_queries_cut_to_length}

<SettingsInfoBlock type='UInt64' default_value='100000' />

Если длина запроса превышает указанный порог (в байтах), запрос обрезается при записи в журнал запросов. Также ограничивается длина выводимого запроса в обычном текстовом журнале.


## log_queries_min_query_duration_ms {#log_queries_min_query_duration_ms}

<SettingsInfoBlock type='Milliseconds' default_value='0' />

Если включено (не равно нулю), запросы, выполняющиеся быстрее указанного значения, не будут записываться в лог (это можно рассматривать как аналог `long_query_time` для [MySQL Slow Query Log](https://dev.mysql.com/doc/refman/5.7/slow-query-log.html)), что означает, что вы не найдёте их в следующих таблицах:

- `system.query_log`
- `system.query_thread_log`

В лог попадут только запросы следующих типов:

- `QUERY_FINISH`
- `EXCEPTION_WHILE_PROCESSING`

- Тип: миллисекунды
- Значение по умолчанию: 0 (любой запрос)


## log_queries_min_type {#log_queries_min_type}

<SettingsInfoBlock type='LogQueriesType' default_value='QUERY_START' />

Минимальный тип событий для записи в `query_log`.

Возможные значения:

- `QUERY_START` (`=1`)
- `QUERY_FINISH` (`=2`)
- `EXCEPTION_BEFORE_START` (`=3`)
- `EXCEPTION_WHILE_PROCESSING` (`=4`)

Позволяет ограничить, какие события будут записываться в `query_log`. Например, если вас интересуют только ошибки, используйте `EXCEPTION_WHILE_PROCESSING`:

```text
log_queries_min_type='EXCEPTION_WHILE_PROCESSING'
```


## log_queries_probability {#log_queries_probability}

<SettingsInfoBlock type='Float' default_value='1' />

Позволяет записывать в системные таблицы [query_log](../../operations/system-tables/query_log.md), [query_thread_log](../../operations/system-tables/query_thread_log.md) и [query_views_log](../../operations/system-tables/query_views_log.md) только выборку запросов, случайно отобранных с заданной вероятностью. Помогает снизить нагрузку при большом объёме запросов в секунду.

Возможные значения:

- 0 — запросы не записываются в системные таблицы.
- Положительное число с плавающей точкой в диапазоне [0..1]. Например, если значение настройки равно `0.5`, примерно половина запросов записывается в системные таблицы.
- 1 — все запросы записываются в системные таблицы.


## log_query_settings {#log_query_settings}

<SettingsInfoBlock type='Bool' default_value='1' />

Записывать настройки запроса в query_log и журнал span-ов OpenTelemetry.


## log_query_threads {#log_query_threads}

<SettingsInfoBlock type='Bool' default_value='0' />

Настройка логирования потоков запросов.

Потоки запросов записываются в таблицу [system.query_thread_log](../../operations/system-tables/query_thread_log.md). Эта настройка действует только при значении [log_queries](#log_queries) равном true. Потоки запросов, выполняемые ClickHouse при включенной настройке, логируются согласно правилам, определенным в параметре конфигурации сервера [query_thread_log](/operations/server-configuration-parameters/settings#query_thread_log).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

**Пример**

```text
log_query_threads=1
```


## log_query_views {#log_query_views}

<SettingsInfoBlock type='Bool' default_value='1' />

Настройка логирования представлений запросов.

Когда запрос, выполняемый ClickHouse с включённой этой настройкой, имеет связанные представления (материализованные или live-представления), они записываются в лог, указанный в параметре конфигурации сервера [query_views_log](/operations/server-configuration-parameters/settings#query_views_log).

Пример:

```text
log_query_views=1
```


## low_cardinality_allow_in_native_format {#low_cardinality_allow_in_native_format}

<SettingsInfoBlock type='Bool' default_value='1' />

Разрешает или запрещает использование типа данных [LowCardinality](../../sql-reference/data-types/lowcardinality.md) с форматом [Native](/interfaces/formats/Native).

Если использование `LowCardinality` запрещено, сервер ClickHouse преобразует столбцы `LowCardinality` в обычные для запросов `SELECT` и преобразует обычные столбцы в столбцы `LowCardinality` для запросов `INSERT`.

Эта настройка необходима в основном для сторонних клиентов, которые не поддерживают тип данных `LowCardinality`.

Возможные значения:

- 1 — использование `LowCardinality` не ограничено.
- 0 — использование `LowCardinality` ограничено.


## low_cardinality_max_dictionary_size {#low_cardinality_max_dictionary_size}

<SettingsInfoBlock type='UInt64' default_value='8192' />

Задает максимальный размер в строках общего глобального словаря для типа данных [LowCardinality](../../sql-reference/data-types/lowcardinality.md), который может быть записан в файловую систему хранилища. Эта настройка предотвращает проблемы с оперативной памятью при неограниченном росте словаря. Все данные, которые невозможно закодировать из-за ограничения максимального размера словаря, ClickHouse записывает обычным способом.

Возможные значения:

- Любое положительное целое число.


## low_cardinality_use_single_dictionary_for_part {#low_cardinality_use_single_dictionary_for_part}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает использование единого словаря для части данных.

По умолчанию сервер ClickHouse отслеживает размер словарей, и если словарь переполняется, сервер начинает записывать следующий. Чтобы запретить создание нескольких словарей, установите `low_cardinality_use_single_dictionary_for_part = 1`.

Возможные значения:

- 1 — Создание нескольких словарей для части данных запрещено.
- 0 — Создание нескольких словарей для части данных разрешено.


## low_priority_query_wait_time_ms {#low_priority_query_wait_time_ms}

<BetaBadge />

<SettingsInfoBlock type='Milliseconds' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.4" }, { label: "1000" }, { label: "Новая настройка." }]
    }
  ]}
/>

При использовании механизма приоритизации запросов (см. настройку `priority`) запросы с низким приоритетом ожидают завершения запросов с более высоким приоритетом. Эта настройка определяет продолжительность ожидания.


## make_distributed_plan {#make_distributed_plan}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "0" },
        { label: "Новая экспериментальная настройка." }
      ]
    }
  ]}
/>

Создавать распределённый план запроса.


## materialize_skip_indexes_on_insert {#materialize_skip_indexes_on_insert}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "1" },
        {
          label:
            "Добавлена новая настройка, позволяющая отключить материализацию индексов пропуска данных при вставке"
        }
      ]
    }
  ]}
/>

Определяет, будут ли при выполнении INSERT создаваться и сохраняться индексы пропуска данных. Если отключено, индексы пропуска будут создаваться и сохраняться только [во время слияний](merge-tree-settings.md/#materialize_skip_indexes_on_merge) или при явном выполнении команды [MATERIALIZE INDEX](/sql-reference/statements/alter/skipping-index.md/#materialize-index).

См. также [exclude_materialize_skip_indexes_on_insert](#exclude_materialize_skip_indexes_on_insert).


## materialize_statistics_on_insert {#materialize_statistics_on_insert}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "1" },
        {
          label:
            "Добавлена новая настройка, позволяющая отключить материализацию статистики при вставке"
        }
      ]
    }
  ]}
/>

Определяет, будут ли операции INSERT создавать и сохранять статистику. Если отключено, статистика будет создаваться и сохраняться во время слияний или при явном выполнении команды MATERIALIZE STATISTICS


## materialize_ttl_after_modify {#materialize_ttl_after_modify}

<SettingsInfoBlock type='Bool' default_value='1' />

Применять TTL к старым данным после запроса ALTER MODIFY TTL


## materialized_views_ignore_errors {#materialized_views_ignore_errors}

<SettingsInfoBlock type='Bool' default_value='0' />

Позволяет игнорировать ошибки в MATERIALIZED VIEW и записывать исходный блок данных в таблицу независимо от материализованных представлений


## materialized_views_squash_parallel_inserts {#materialized_views_squash_parallel_inserts}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.10" },
        { label: "1" },
        { label: "Добавлена настройка для сохранения прежнего поведения при необходимости." }
      ]
    }
  ]}
/>

Объединяет вставки в целевую таблицу материализованных представлений из одного запроса INSERT при параллельных вставках для уменьшения количества создаваемых кусков данных.
Если установлено значение false и включена настройка `parallel_view_processing`, запрос INSERT будет создавать отдельный кусок данных в целевой таблице для каждого потока `max_insert_thread`.


## max_analyze_depth {#max_analyze_depth}

<SettingsInfoBlock type='UInt64' default_value='5000' />

Максимальное количество анализов, выполняемых интерпретатором.


## max_ast_depth {#max_ast_depth}

<SettingsInfoBlock type='UInt64' default_value='1000' />

Максимальная глубина вложенности синтаксического дерева запроса. При превышении генерируется исключение.

:::note
В настоящее время проверка выполняется не во время разбора запроса, а только после его завершения.
Это означает, что слишком глубокое синтаксическое дерево может быть создано в процессе разбора,
но выполнение запроса завершится ошибкой.
:::


## max_ast_elements {#max_ast_elements}

<SettingsInfoBlock type='UInt64' default_value='50000' />

Максимальное количество элементов в синтаксическом дереве запроса. При превышении генерируется исключение.

:::note
В настоящее время проверка выполняется не во время парсинга, а только после парсинга запроса.
Это означает, что слишком глубокое синтаксическое дерево может быть создано во время парсинга,
но выполнение запроса завершится с ошибкой.
:::


## max_autoincrement_series {#max_autoincrement_series}

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.1" }, { label: "1000" }, { label: "Новая настройка" }]
    }
  ]}
/>

Ограничение на количество последовательностей, создаваемых функцией `generateSerialID`.

Поскольку каждая последовательность представляет собой узел в Keeper, рекомендуется использовать не более нескольких миллионов последовательностей.


## max_backup_bandwidth {#max_backup_bandwidth}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальная скорость чтения в байтах в секунду для конкретного резервного копирования на сервере. Ноль означает отсутствие ограничений.


## max_block_size {#max_block_size}

<SettingsInfoBlock type='NonZeroUInt64' default_value='65409' />

В ClickHouse данные обрабатываются блоками, которые представляют собой наборы частей столбцов. Внутренние циклы обработки отдельного блока эффективны, однако обработка каждого блока сопряжена с заметными издержками.

Настройка `max_block_size` определяет рекомендуемое максимальное количество строк в одном блоке при загрузке данных из таблиц. Блоки размером `max_block_size` загружаются из таблицы не всегда: если ClickHouse определяет, что требуется извлечь меньший объём данных, обрабатывается блок меньшего размера.

Размер блока не должен быть слишком маленьким, чтобы избежать заметных издержек при обработке каждого блока. Он также не должен быть слишком большим, чтобы запросы с предложением LIMIT выполнялись быстро после обработки первого блока. При установке `max_block_size` следует избегать чрезмерного потребления памяти при извлечении большого количества столбцов в нескольких потоках и сохранять хотя бы некоторую локальность кэша.


## max_bytes_before_external_group_by {#max_bytes_before_external_group_by}

<SettingsInfoBlock type='UInt64' default_value='0' />

Значение по умолчанию в Cloud: половина объёма памяти на реплику.

Включает или отключает выполнение операций `GROUP BY` с использованием внешней памяти.
(См. [GROUP BY с использованием внешней памяти](/sql-reference/statements/select/group-by#group-by-in-external-memory))

Возможные значения:

- Максимальный объём оперативной памяти (в байтах), который может использоваться одной операцией [GROUP BY](/sql-reference/statements/select/group-by).
- `0` — выполнение `GROUP BY` с использованием внешней памяти отключено.

:::note
Если использование памяти во время выполнения операций GROUP BY превышает этот порог в байтах,
активируется режим «внешней агрегации» (данные сбрасываются на диск).

Рекомендуемое значение — половина доступной системной памяти.
:::


## max_bytes_before_external_sort {#max_bytes_before_external_sort}

<SettingsInfoBlock type='UInt64' default_value='0' />

Значение по умолчанию в Cloud: половина объёма памяти на реплику.

Включает или отключает выполнение операций `ORDER BY` с использованием внешней памяти. См. [Детали реализации ORDER BY](../../sql-reference/statements/select/order-by.md#implementation-details)
Если использование памяти во время выполнения операции ORDER BY превышает этот порог в байтах, активируется режим «внешней сортировки» (выгрузка данных на диск).

Возможные значения:

- Максимальный объём оперативной памяти (в байтах), который может использоваться одной операцией [ORDER BY](../../sql-reference/statements/select/order-by.md).
  Рекомендуемое значение — половина доступной системной памяти
- `0` — `ORDER BY` с использованием внешней памяти отключён.


## max_bytes_before_remerge_sort {#max_bytes_before_remerge_sort}

<SettingsInfoBlock type='UInt64' default_value='1000000000' />

При использовании ORDER BY с LIMIT, когда потребление памяти превышает указанный порог, выполняются дополнительные этапы слияния блоков перед финальным слиянием, чтобы сохранить только первые LIMIT строк.


## max_bytes_in_distinct {#max_bytes_in_distinct}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальный объём памяти (в несжатых байтах) для хранения состояния хеш-таблицы при использовании DISTINCT.


## max_bytes_in_join {#max_bytes_in_join}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальный размер хеш-таблицы в байтах, используемой при объединении таблиц.

Эта настройка применяется к операциям [SELECT ... JOIN](/sql-reference/statements/select/join)
и [движку таблиц Join](/engines/table-engines/special/join).

Если запрос содержит объединения, ClickHouse проверяет эту настройку для каждого промежуточного результата.

ClickHouse может выполнять различные действия при достижении лимита. Используйте
настройку [join_overflow_mode](/operations/settings/settings#join_overflow_mode) для выбора действия.

Возможные значения:

- Положительное целое число.
- 0 — контроль памяти отключён.


## max_bytes_in_set {#max_bytes_in_set}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество байт (несжатых данных), используемое множеством в операторе IN,
созданным из подзапроса.


## max_bytes_ratio_before_external_group_by {#max_bytes_ratio_before_external_group_by}

<SettingsInfoBlock type='Double' default_value='0.5' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.1" },
        { label: "0.5" },
        { label: "Включить автоматический сброс на диск по умолчанию." }
      ]
    },
    {
      id: "row-2",
      items: [{ label: "24.12" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Доля доступной памяти, разрешённая для `GROUP BY`. При достижении этого порога
для агрегации используется внешняя память.

Например, при значении `0.6` операция `GROUP BY` будет использовать 60% доступной памяти
(для сервера/пользователя/слияний) в начале выполнения, после чего перейдёт
на внешнюю агрегацию.


## max_bytes_ratio_before_external_sort {#max_bytes_ratio_before_external_sort}

<SettingsInfoBlock type='Double' default_value='0.5' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.1" },
        { label: "0.5" },
        { label: "Автоматическая выгрузка на диск включена по умолчанию." }
      ]
    },
    {
      id: "row-2",
      items: [{ label: "24.12" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Доля доступной памяти, разрешённая для операции `ORDER BY`. При достижении этого порога используется внешняя сортировка.

Например, при значении `0.6` операция `ORDER BY` может использовать `60%` доступной памяти (сервера/пользователя/слияний) в начале выполнения, после чего начинает использовать внешнюю сортировку.

Обратите внимание, что параметр `max_bytes_before_external_sort` по-прежнему учитывается — выгрузка на диск выполняется только в том случае, если размер блока сортировки превышает значение `max_bytes_before_external_sort`.


## max_bytes_to_read {#max_bytes_to_read}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество байтов (несжатых данных), которые могут быть прочитаны из таблицы при выполнении запроса.
Ограничение проверяется для каждого обрабатываемого блока данных, применяется только к самому глубокому табличному выражению и при чтении с удалённого сервера проверяется только на удалённом сервере.


## max_bytes_to_read_leaf {#max_bytes_to_read_leaf}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество байт (несжатых данных), которое может быть прочитано из локальной
таблицы на конечном узле при выполнении распределённого запроса. Хотя распределённые запросы
могут отправлять несколько подзапросов к каждому шарду (конечному узлу), это ограничение
проверяется только на этапе чтения на конечных узлах и игнорируется на
этапе объединения результатов на корневом узле.

Например, кластер состоит из 2 шардов, и каждый шард содержит таблицу со
100 байтами данных. Распределённый запрос, который должен прочитать все данные
из обеих таблиц с настройкой `max_bytes_to_read=150`, завершится ошибкой, так как в сумме это
составит 200 байт. Запрос с `max_bytes_to_read_leaf=150` выполнится успешно, поскольку
конечные узлы прочитают максимум 100 байт.

Ограничение проверяется для каждого обрабатываемого блока данных.

:::note
Эта настройка работает нестабильно при `prefer_localhost_replica=1`.
:::


## max_bytes_to_sort {#max_bytes_to_sort}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество байтов перед сортировкой. Если для операции ORDER BY требуется обработать больше указанного количества несжатых байтов, поведение будет определяться параметром `sort_overflow_mode`, который по умолчанию имеет значение `throw`.


## max_bytes_to_transfer {#max_bytes_to_transfer}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество байтов (несжатых данных), которое может быть передано на удалённый
сервер или сохранено во временной таблице при выполнении секции GLOBAL IN/JOIN.


## max_columns_to_read {#max_columns_to_read}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество столбцов, которые можно прочитать из таблицы в одном запросе.
Если запрос требует чтения большего количества столбцов, чем указано, генерируется исключение.

:::tip
Эта настройка полезна для предотвращения слишком сложных запросов.
:::

Значение `0` означает отсутствие ограничений.


## max_compress_block_size {#max_compress_block_size}

<SettingsInfoBlock type='UInt64' default_value='1048576' />

Максимальный размер блоков несжатых данных перед сжатием при записи в таблицу. По умолчанию 1 048 576 (1 МиБ). Указание меньшего размера блока обычно приводит к незначительному снижению степени сжатия, при этом скорость сжатия и распаковки немного увеличивается благодаря локальности кэша, а потребление памяти снижается.

:::note
Это настройка экспертного уровня, не изменяйте её, если вы только начинаете работать с ClickHouse.
:::

Не путайте блоки для сжатия (фрагмент памяти, состоящий из байтов) с блоками для обработки запросов (набор строк таблицы).


## max_concurrent_queries_for_all_users {#max_concurrent_queries_for_all_users}

<SettingsInfoBlock type='UInt64' default_value='0' />

Генерирует исключение, если значение этой настройки меньше или равно текущему количеству одновременно выполняемых запросов.

Пример: `max_concurrent_queries_for_all_users` можно установить в 99 для всех пользователей, а администратор базы данных может установить значение 100 для себя, чтобы выполнять запросы для исследования проблем даже при перегрузке сервера.

Изменение настройки для одного запроса или пользователя не влияет на другие запросы.

Возможные значения:

- Положительное целое число.
- 0 — без ограничений.

**Пример**

```xml
<max_concurrent_queries_for_all_users>99</max_concurrent_queries_for_all_users>
```

**См. также**

- [max_concurrent_queries](/operations/server-configuration-parameters/settings#max_concurrent_queries)


## max_concurrent_queries_for_user {#max_concurrent_queries_for_user}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество одновременно обрабатываемых запросов для одного пользователя.

Возможные значения:

- Положительное целое число.
- 0 — без ограничений.

**Пример**

```xml
<max_concurrent_queries_for_user>5</max_concurrent_queries_for_user>
```


## max_distributed_connections {#max_distributed_connections}

<SettingsInfoBlock type='UInt64' default_value='1024' />

Максимальное количество одновременных соединений с удалёнными серверами для распределённой обработки одного запроса к одной таблице типа Distributed. Рекомендуется устанавливать значение не меньше, чем количество серверов в кластере.

Следующие параметры используются только при создании таблиц Distributed (и при запуске сервера), поэтому нет смысла изменять их во время выполнения.


## max_distributed_depth {#max_distributed_depth}

<SettingsInfoBlock type='UInt64' default_value='5' />

Ограничивает максимальную глубину рекурсивных запросов для таблиц [Distributed](../../engines/table-engines/special/distributed.md).

При превышении значения сервер генерирует исключение.

Возможные значения:

- Положительное целое число.
- 0 — неограниченная глубина.


## max_download_buffer_size {#max_download_buffer_size}

<SettingsInfoBlock type='UInt64' default_value='10485760' />

Максимальный размер буфера для параллельной загрузки (например, для движка URL) для каждого потока.


## max_download_threads {#max_download_threads}

<SettingsInfoBlock type='MaxThreads' default_value='4' />

Максимальное количество потоков для скачивания данных (например, для движка URL).


## max_estimated_execution_time {#max_estimated_execution_time}

<SettingsInfoBlock type='Seconds' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.1" },
        { label: "0" },
        {
          label: "Разделение max_execution_time и max_estimated_execution_time"
        }
      ]
    }
  ]}
/>

Максимальное оценочное время выполнения запроса в секундах. Проверяется на каждом блоке данных
после истечения [`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed).


## max_execution_speed {#max_execution_speed}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество строк, обрабатываемых в секунду. Проверяется на каждом блоке данных после истечения времени ожидания
[`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed).
Если скорость выполнения превышает заданное значение, она будет снижена.


## max_execution_speed_bytes {#max_execution_speed_bytes}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество байтов, обрабатываемых в секунду. Проверяется на каждом блоке данных после истечения времени ожидания
[`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed).
Если скорость выполнения слишком высокая, она будет снижена.


## max_execution_time {#max_execution_time}

<SettingsInfoBlock type='Seconds' default_value='0' />

Максимальное время выполнения запроса в секундах.

Параметр `max_execution_time` может быть не совсем очевидным в понимании.
Он работает на основе интерполяции относительно текущей скорости выполнения запроса
(это поведение контролируется параметром [`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed)).

ClickHouse прервёт запрос, если прогнозируемое время выполнения превысит
указанное значение `max_execution_time`. По умолчанию `timeout_before_checking_execution_speed`
установлен в 10 секунд. Это означает, что после 10 секунд выполнения запроса ClickHouse
начнёт оценивать общее время выполнения. Например, если `max_execution_time`
установлен в 3600 секунд (1 час), ClickHouse завершит запрос, если оценочное
время превысит этот лимит в 3600 секунд. Если установить `timeout_before_checking_execution_speed`
в 0, ClickHouse будет использовать реальное время как основу для `max_execution_time`.

Если время выполнения запроса превысит указанное количество секунд, поведение будет
определяться параметром `timeout_overflow_mode`, который по умолчанию установлен в `throw`.

:::note
Проверка таймаута выполняется, и запрос может быть остановлен только в определённых точках во время обработки данных.
В настоящее время он не может быть остановлен во время слияния состояний агрегации или во время анализа запроса,
и фактическое время выполнения будет превышать значение этого параметра.
:::


## max_execution_time_leaf {#max_execution_time_leaf}

<SettingsInfoBlock type='Seconds' default_value='0' />

По смыслу аналогичен [`max_execution_time`](#max_execution_time), но применяется
только на конечных узлах для распределённых или удалённых запросов.

Например, если нужно ограничить время выполнения на конечном узле до `10s`, но
не устанавливать ограничение на начальном узле, вместо указания `max_execution_time` в
настройках вложенного подзапроса:

```sql
SELECT count()
FROM cluster(cluster, view(SELECT * FROM t SETTINGS max_execution_time = 10));
```

Можно использовать `max_execution_time_leaf` в настройках запроса:

```sql
SELECT count()
FROM cluster(cluster, view(SELECT * FROM t)) SETTINGS max_execution_time_leaf = 10;
```


## max_expanded_ast_elements {#max_expanded_ast_elements}

<SettingsInfoBlock type='UInt64' default_value='500000' />

Максимальный размер синтаксического дерева запроса в узлах после раскрытия псевдонимов и звёздочки.


## max_fetch_partition_retries_count {#max_fetch_partition_retries_count}

<SettingsInfoBlock type='UInt64' default_value='5' />

Количество повторных попыток при получении партиции с другого хоста.


## max_final_threads {#max_final_threads}

<SettingsInfoBlock type='MaxThreads' default_value="'auto(N)'" />

Задаёт максимальное количество параллельных потоков для фазы чтения данных в запросе `SELECT` с модификатором [FINAL](/sql-reference/statements/select/from#final-modifier).

Возможные значения:

- Положительное целое число.
- 0 или 1 — отключено. Запросы `SELECT` выполняются в одном потоке.


## max_http_get_redirects {#max_http_get_redirects}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество разрешённых переходов по перенаправлениям HTTP GET. Обеспечивает дополнительные меры безопасности для предотвращения перенаправления запросов вредоносным сервером на неожиданные службы.\n\nТакая ситуация возникает, когда внешний сервер перенаправляет на другой адрес, который оказывается внутренним адресом инфраструктуры компании. Отправляя HTTP-запрос на внутренний сервер, можно получить доступ к внутреннему API из внутренней сети в обход аутентификации или даже обратиться к другим службам, таким как Redis или Memcached. Если у вас нет внутренней инфраструктуры (включая службы, работающие на localhost) или вы доверяете серверу, разрешать перенаправления безопасно. Однако учитывайте, что если URL использует HTTP вместо HTTPS, придётся доверять не только удалённому серверу, но также интернет-провайдеру и всем промежуточным сетям.


## max_hyperscan_regexp_length {#max_hyperscan_regexp_length}

<SettingsInfoBlock type='UInt64' default_value='0' />

Определяет максимальную длину каждого регулярного выражения в [функциях множественного поиска hyperscan](/sql-reference/functions/string-search-functions#multiMatchAny).

Возможные значения:

- Положительное целое число.
- 0 — длина не ограничена.

**Пример**

Запрос:

```sql
SELECT multiMatchAny('abcd', ['ab','bcd','c','d']) SETTINGS max_hyperscan_regexp_length = 3;
```

Результат:

```text
┌─multiMatchAny('abcd', ['ab', 'bcd', 'c', 'd'])─┐
│                                              1 │
└────────────────────────────────────────────────┘
```

Запрос:

```sql
SELECT multiMatchAny('abcd', ['ab','bcd','c','d']) SETTINGS max_hyperscan_regexp_length = 2;
```

Результат:

```text
Exception: Regexp length too large.
```

**См. также**

- [max_hyperscan_regexp_total_length](#max_hyperscan_regexp_total_length)


## max_hyperscan_regexp_total_length {#max_hyperscan_regexp_total_length}

<SettingsInfoBlock type='UInt64' default_value='0' />

Устанавливает максимальную суммарную длину всех регулярных выражений в каждой [функции множественного сопоставления hyperscan](/sql-reference/functions/string-search-functions#multiMatchAny).

Возможные значения:

- Положительное целое число.
- 0 — длина не ограничена.

**Пример**

Запрос:

```sql
SELECT multiMatchAny('abcd', ['a','b','c','d']) SETTINGS max_hyperscan_regexp_total_length = 5;
```

Результат:

```text
┌─multiMatchAny('abcd', ['a', 'b', 'c', 'd'])─┐
│                                           1 │
└─────────────────────────────────────────────┘
```

Запрос:

```sql
SELECT multiMatchAny('abcd', ['ab','bc','c','d']) SETTINGS max_hyperscan_regexp_total_length = 5;
```

Результат:

```text
Exception: Total regexp lengths too large.
```

**См. также**

- [max_hyperscan_regexp_length](#max_hyperscan_regexp_length)


## max_insert_block_size {#max_insert_block_size}

<SettingsInfoBlock type='NonZeroUInt64' default_value='1048449' />

Размер блоков (в количестве строк), формируемых при вставке в таблицу.
Эта настройка применяется только в тех случаях, когда блоки формирует сервер.
Например, при выполнении INSERT через HTTP-интерфейс сервер разбирает формат данных и формирует блоки указанного размера.
Однако при использовании clickhouse-client клиент самостоятельно разбирает данные, и настройка 'max_insert_block_size' на сервере не влияет на размер вставляемых блоков.
Эта настройка также не имеет смысла при использовании INSERT SELECT, поскольку данные вставляются теми же блоками, которые формируются после выполнения SELECT.

Значение по умолчанию немного больше, чем `max_block_size`. Причина в том, что некоторые движки таблиц (`*MergeTree`) формируют на диске кусок данных для каждого вставляемого блока, что является довольно крупной сущностью. Аналогично, таблицы `*MergeTree` сортируют данные во время вставки, и достаточно большой размер блока позволяет отсортировать больше данных в оперативной памяти.


## max_insert_delayed_streams_for_parallel_write {#max_insert_delayed_streams_for_parallel_write}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество потоков (столбцов), для которых откладывается финальная запись части. По умолчанию — auto (100, если базовое хранилище поддерживает параллельную запись, например S3, и отключено в противном случае)


## max_insert_threads {#max_insert_threads}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество потоков для выполнения запроса `INSERT SELECT`.

Возможные значения:

- 0 (или 1) — `INSERT SELECT` выполняется без распараллеливания.
- Положительное целое число больше 1.

Значение по умолчанию в Cloud:

- `1` для узлов с 8 ГиБ памяти
- `2` для узлов с 16 ГиБ памяти
- `4` для более крупных узлов

Параллельное выполнение `INSERT SELECT` работает только в том случае, если часть `SELECT` выполняется параллельно, см. настройку [`max_threads`](#max_threads).
Более высокие значения приводят к увеличению потребления памяти.


## max_joined_block_size_bytes {#max_joined_block_size_bytes}

<SettingsInfoBlock type='UInt64' default_value='4194304' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "4194304" }, { label: "Новая настройка" }]
    }
  ]}
/>

Максимальный размер блока в байтах для результата JOIN (если алгоритм соединения поддерживает эту возможность). Значение 0 означает отсутствие ограничений.


## max_joined_block_size_rows {#max_joined_block_size_rows}

<SettingsInfoBlock type='UInt64' default_value='65409' />

Максимальный размер блока для результата JOIN (если алгоритм соединения это поддерживает). Значение 0 означает отсутствие ограничений.


## max_limit_for_vector_search_queries {#max_limit_for_vector_search_queries}

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.5" }, { label: "1000" }, { label: "Новая настройка" }]
    }
  ]}
/>

Запросы SELECT с LIMIT, превышающим это значение, не могут использовать индексы векторного подобия. Помогает предотвратить переполнение памяти в индексах векторного подобия.


## max_local_read_bandwidth {#max_local_read_bandwidth}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальная скорость локального чтения в байтах в секунду.


## max_local_write_bandwidth {#max_local_write_bandwidth}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальная скорость локальной записи в байтах в секунду.


## max_memory_usage {#max_memory_usage}

<SettingsInfoBlock type='UInt64' default_value='0' />

Значение по умолчанию в Cloud: зависит от объёма оперативной памяти на реплике.

Максимальный объём оперативной памяти для выполнения запроса на одном сервере.
Значение `0` означает отсутствие ограничений.

Эта настройка не учитывает объём доступной памяти или общий объём
памяти на машине. Ограничение применяется к отдельному запросу в рамках
одного сервера.

Для просмотра текущего потребления памяти каждым запросом можно использовать `SHOW PROCESSLIST`.
Пиковое потребление памяти отслеживается для каждого запроса и записывается в журнал.

Использование памяти не полностью отслеживается для состояний следующих агрегатных функций
с аргументами типа `String` и `Array`:

- `min`
- `max`
- `any`
- `anyLast`
- `argMin`
- `argMax`

Потребление памяти также ограничивается параметрами [`max_memory_usage_for_user`](/operations/settings/settings#max_memory_usage_for_user)
и [`max_server_memory_usage`](/operations/server-configuration-parameters/settings#max_server_memory_usage).


## max_memory_usage_for_user {#max_memory_usage_for_user}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальный объем оперативной памяти для выполнения запросов пользователя на одном сервере. Нулевое значение означает отсутствие ограничений.

По умолчанию объем не ограничен (`max_memory_usage_for_user = 0`).

См. также описание параметра [`max_memory_usage`](/operations/settings/settings#max_memory_usage).

Например, чтобы установить значение `max_memory_usage_for_user` равным 1000 байт для пользователя `clickhouse_read`, используйте следующий запрос

```sql
ALTER USER clickhouse_read SETTINGS max_memory_usage_for_user = 1000;
```

Проверить применение настройки можно, выйдя из клиента и снова войдя в систему, после чего использовать функцию `getSetting`:

```sql
SELECT getSetting('max_memory_usage_for_user');
```


## max_network_bandwidth {#max_network_bandwidth}

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничивает скорость обмена данными по сети в байтах в секунду. Настройка применяется к каждому запросу.

Возможные значения:

- Положительное целое число.
- 0 — управление пропускной способностью отключено.


## max_network_bandwidth_for_all_users {#max_network_bandwidth_for_all_users}

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничивает скорость обмена данными по сети в байтах в секунду. Настройка применяется ко всем одновременно выполняемым запросам на сервере.

Возможные значения:

- Положительное целое число.
- 0 — контроль скорости передачи данных отключён.


## max_network_bandwidth_for_user {#max_network_bandwidth_for_user}

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничивает скорость обмена данными по сети в байтах в секунду. Настройка применяется ко всем одновременно выполняемым запросам одного пользователя.

Возможные значения:

- Положительное целое число.
- 0 — контроль скорости передачи данных отключён.


## max_network_bytes {#max_network_bytes}

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничивает объём данных (в байтах), которые принимаются или передаются по сети при выполнении запроса. Настройка применяется к каждому отдельному запросу.

Возможные значения:

- Положительное целое число.
- 0 — контроль объёма данных отключён.


## max_number_of_partitions_for_independent_aggregation {#max_number_of_partitions_for_independent_aggregation}

<SettingsInfoBlock type='UInt64' default_value='128' />

Максимальное количество партиций в таблице для применения оптимизации


## max_os_cpu_wait_time_ratio_to_throw {#max_os_cpu_wait_time_ratio_to_throw}

<SettingsInfoBlock type='Float' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "0" },
        { label: "Значения настройки были изменены и портированы в версию 25.4" }
      ]
    },
    {
      id: "row-2",
      items: [{ label: "25.4" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Максимальное соотношение между временем ожидания ЦП операционной системы (метрика OSCPUWaitMicroseconds) и временем активной работы (метрика OSCPUVirtualTimeMicroseconds), при котором рассматривается отклонение запросов. Для вычисления вероятности используется линейная интерполяция между минимальным и максимальным соотношением; в данной точке вероятность равна 1.


## max_parallel_replicas {#max_parallel_replicas}

<SettingsInfoBlock type='NonZeroUInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.1" },
        { label: "1000" },
        { label: "По умолчанию используется до 1000 параллельных реплик." }
      ]
    }
  ]}
/>

Максимальное количество реплик для каждого шарда при выполнении запроса.

Возможные значения:

- Положительное целое число.

**Дополнительная информация**

Эта настройка будет давать различные результаты в зависимости от используемых параметров.

:::note
Эта настройка будет давать некорректные результаты при использовании объединений или подзапросов, если не все таблицы соответствуют определённым требованиям. Подробнее см. [Распределённые подзапросы и max_parallel_replicas](/operations/settings/settings#max_parallel_replicas).
:::

### Параллельная обработка с использованием ключа `SAMPLE`

Запрос может обрабатываться быстрее при параллельном выполнении на нескольких серверах. Однако производительность запроса может снизиться в следующих случаях:

- Позиция ключа сэмплирования в ключе партиционирования не позволяет эффективно выполнять диапазонное сканирование.
- Добавление ключа сэмплирования к таблице снижает эффективность фильтрации по другим столбцам.
- Ключ сэмплирования является выражением, вычисление которого требует больших затрат.
- Распределение задержек в кластере имеет длинный хвост, поэтому запросы к большему количеству серверов увеличивают общую задержку запроса.

### Параллельная обработка с использованием [parallel_replicas_custom_key](#parallel_replicas_custom_key)

Эта настройка полезна для любой реплицируемой таблицы.


## max_parser_backtracks {#max_parser_backtracks}

<SettingsInfoBlock type='UInt64' default_value='1000000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "1000000" },
        { label: "Ограничение сложности разбора" }
      ]
    }
  ]}
/>

Максимальное количество откатов парсера (сколько раз он пытается применить различные альтернативы в процессе рекурсивного нисходящего разбора).


## max_parser_depth {#max_parser_depth}

<SettingsInfoBlock type='UInt64' default_value='1000' />

Ограничивает максимальную глубину рекурсии в рекурсивно-нисходящем парсере. Позволяет управлять размером стека.

Возможные значения:

- Положительное целое число.
- 0 — глубина рекурсии не ограничена.


## max_parsing_threads {#max_parsing_threads}

<SettingsInfoBlock type='MaxThreads' default_value="'auto(N)'" />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.4" },
        { label: "0" },
        {
          label:
            "Добавлена отдельная настройка для управления количеством потоков при параллельном парсинге из файлов"
        }
      ]
    }
  ]}
/>

Максимальное количество потоков для парсинга данных во входных форматах, поддерживающих параллельный парсинг. По умолчанию определяется автоматически.


## max_partition_size_to_drop {#max_partition_size_to_drop}

<SettingsInfoBlock type='UInt64' default_value='50000000000' />

Ограничение на удаление партиций во время выполнения запроса. Значение `0` означает, что партиции можно удалять без ограничений.

Значение по умолчанию в Cloud: 1 ТБ.

:::note
Эта настройка запроса переопределяет соответствующую серверную настройку, см. [max_partition_size_to_drop](/operations/server-configuration-parameters/settings#max_partition_size_to_drop)
:::


## max_partitions_per_insert_block {#max_partitions_per_insert_block}

<SettingsInfoBlock type='UInt64' default_value='100' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "19.5" },
        { label: "100" },
        { label: "Добавлено ограничение на количество партиций в одном блоке" }
      ]
    }
  ]}
/>

Ограничивает максимальное количество партиций в одном вставляемом блоке.
При превышении этого значения выбрасывается исключение.

- Положительное целое число.
- `0` — количество партиций не ограничено.

**Подробности**

При вставке данных ClickHouse вычисляет количество партиций во
вставляемом блоке. Если количество партиций превышает значение
`max_partitions_per_insert_block`, ClickHouse либо записывает предупреждение в лог, либо выбрасывает
исключение в зависимости от настройки `throw_on_max_partitions_per_insert_block`. Текст исключения:

> "Too many partitions for a single INSERT block (`partitions_count` partitions, limit is " + toString(max_partitions) + ").
> The limit is controlled by the 'max_partitions_per_insert_block' setting.
> A large number of partitions is a common misconception. It will lead to severe
> negative performance impact, including slow server startup, slow INSERT queries
> and slow SELECT queries. Recommended total number of partitions for a table is
> under 1000..10000. Please note, that partitioning is not intended to speed up
> SELECT queries (ORDER BY key is sufficient to make range queries fast).
> Partitions are intended for data manipulation (DROP PARTITION, etc)."

:::note
Эта настройка является защитным порогом, так как использование большого количества партиций — распространённое заблуждение.
:::


## max_partitions_to_read {#max_partitions_to_read}

<SettingsInfoBlock type='Int64' default_value='-1' />

Ограничивает максимальное количество партиций, к которым можно получить доступ в одном запросе.

Значение настройки, указанное при создании таблицы, может быть переопределено настройкой на уровне запроса.

Возможные значения:

- Положительное целое число
- `-1` — без ограничений (по умолчанию)

:::note
Вы также можете указать настройку MergeTree [`max_partitions_to_read`](/operations/settings/settings#max_partitions_to_read) в настройках таблицы.
:::


## max_parts_to_move {#max_parts_to_move}

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.10" }, { label: "1000" }, { label: "Новая настройка" }]
    }
  ]}
/>

Ограничивает количество частей данных, которые могут быть перемещены в одном запросе. Ноль означает отсутствие ограничений.


## max_projection_rows_to_use_projection_index {#max_projection_rows_to_use_projection_index}

<SettingsInfoBlock type='UInt64' default_value='1000000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "1000000" },
        { label: "Новая настройка" }
      ]
    }
  ]}
/>

Если количество строк для чтения из индекса проекции меньше или равно этому порогу, ClickHouse попытается применить индекс проекции во время выполнения запроса.


## max_query_size {#max_query_size}

<SettingsInfoBlock type='UInt64' default_value='262144' />

Максимальное количество байтов строки запроса, разбираемой SQL-парсером.
Данные в секции VALUES запросов INSERT обрабатываются отдельным потоковым парсером (который потребляет O(1) оперативной памяти) и не подвержены этому ограничению.

:::note
`max_query_size` нельзя установить внутри SQL-запроса (например, `SELECT now() SETTINGS max_query_size=10000`), поскольку ClickHouse необходимо выделить буфер для разбора запроса, а размер этого буфера определяется настройкой `max_query_size`, которая должна быть настроена до выполнения запроса.
:::


## max_read_buffer_size {#max_read_buffer_size}

<SettingsInfoBlock type='NonZeroUInt64' default_value='1048576' />

Максимальный размер буфера для чтения из файловой системы.


## max_read_buffer_size_local_fs {#max_read_buffer_size_local_fs}

<SettingsInfoBlock type='UInt64' default_value='131072' />

Максимальный размер буфера для чтения из локальной файловой системы. Если установлено значение 0, будет использоваться параметр max_read_buffer_size.


## max_read_buffer_size_remote_fs {#max_read_buffer_size_remote_fs}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальный размер буфера для чтения из удалённой файловой системы. Если установлено значение 0, будет использоваться значение max_read_buffer_size.


## max_recursive_cte_evaluation_depth {#max_recursive_cte_evaluation_depth}

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.4" },
        { label: "1000" },
        { label: "Максимальный лимит глубины вычисления рекурсивного CTE" }
      ]
    }
  ]}
/>

Максимальный лимит глубины вычисления рекурсивного CTE


## max_remote_read_network_bandwidth {#max_remote_read_network_bandwidth}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальная скорость обмена данными по сети в байтах в секунду для чтения.


## max_remote_write_network_bandwidth {#max_remote_write_network_bandwidth}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальная скорость обмена данными по сети в байтах в секунду для записи.


## max_replica_delay_for_distributed_queries {#max_replica_delay_for_distributed_queries}

<SettingsInfoBlock type='UInt64' default_value='300' />

Отключает отстающие реплики для распределённых запросов. См. [Репликация](../../engines/table-engines/mergetree-family/replication.md).

Задаёт время в секундах. Если отставание реплики больше или равно заданному значению, эта реплика не используется.

Возможные значения:

- Положительное целое число.
- 0 — отставание реплик не проверяется.

Чтобы предотвратить использование любой реплики с ненулевым отставанием, установите значение параметра равным 1.

Используется при выполнении `SELECT` из распределённой таблицы, которая ссылается на реплицируемые таблицы.


## max_result_bytes {#max_result_bytes}

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничивает размер результата в байтах (без сжатия). Запрос остановится после обработки блока данных при достижении порога,
но не обрежет последний блок результата, поэтому итоговый размер результата может превысить пороговое значение.

**Важные замечания**

При проверке этого порога учитывается размер результата в памяти.
Даже если размер результата небольшой, он может ссылаться на более крупные структуры данных в памяти,
представляющие словари столбцов LowCardinality и арены столбцов AggregateFunction,
поэтому порог может быть превышен, несмотря на небольшой размер результата.

:::warning
Эта настройка является низкоуровневой и должна использоваться с осторожностью
:::


## max_result_rows {#max_result_rows}

<SettingsInfoBlock type='UInt64' default_value='0' />

Cloud default value: `0`.

Ограничивает количество строк в результате. Также проверяется для подзапросов и на удалённых серверах при выполнении частей распределённого запроса.
Если значение равно `0`, ограничение не применяется.

Запрос остановится после обработки блока данных при достижении порога, но
последний блок результата не будет обрезан, поэтому размер результата может
превысить пороговое значение.


## max_reverse_dictionary_lookup_cache_size_bytes {#max_reverse_dictionary_lookup_cache_size_bytes}

<SettingsInfoBlock type='UInt64' default_value='104857600' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "104857600" },
        {
          label:
            "Новая настройка. Максимальный размер в байтах кэша обратного поиска в словаре для каждого запроса, используемого функцией `dictGetKeys`. Кэш хранит сериализованные кортежи ключей для каждого значения атрибута, чтобы избежать повторного сканирования словаря в рамках одного запроса."
        }
      ]
    }
  ]}
/>

Максимальный размер в байтах кэша обратного поиска в словаре для каждого запроса, используемого функцией `dictGetKeys`. Кэш хранит сериализованные кортежи ключей для каждого значения атрибута, чтобы избежать повторного сканирования словаря в рамках одного запроса. При достижении лимита записи вытесняются по алгоритму LRU. Установите значение 0 для отключения кэширования.


## max_rows_in_distinct {#max_rows_in_distinct}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество различных строк при использовании DISTINCT.


## max_rows_in_join {#max_rows_in_join}

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничивает количество строк в хеш-таблице, используемой при объединении таблиц.

Эта настройка применяется к операциям [SELECT ... JOIN](/sql-reference/statements/select/join)
и движку таблиц [Join](/engines/table-engines/special/join).

Если запрос содержит несколько объединений, ClickHouse проверяет эту настройку для каждого промежуточного результата.

При достижении лимита ClickHouse может выполнять различные действия. Используйте настройку
[`join_overflow_mode`](/operations/settings/settings#join_overflow_mode) для выбора действия.

Возможные значения:

- Положительное целое число.
- `0` — неограниченное количество строк.


## max_rows_in_set {#max_rows_in_set}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество строк для набора данных в условии IN, созданного из подзапроса.


## max_rows_in_set_to_optimize_join {#max_rows_in_set_to_optimize_join}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.1" },
        { label: "0" },
        {
          label:
            "Отключить оптимизацию объединений, так как она препятствует оптимизации чтения в порядке сортировки"
        }
      ]
    }
  ]}
/>

Максимальный размер набора для фильтрации объединяемых таблиц по наборам строк друг друга перед объединением.

Возможные значения:

- 0 — отключено.
- Любое положительное целое число.


## max_rows_to_group_by {#max_rows_to_group_by}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество уникальных ключей, получаемых при агрегации. Эта настройка позволяет
ограничить потребление памяти при агрегации.

Если при агрегации с использованием GROUP BY генерируется больше указанного количества
строк (уникальных ключей GROUP BY), поведение определяется настройкой
'group_by_overflow_mode', которая по умолчанию имеет значение `throw`, но может быть переключена
в режим приблизительной агрегации GROUP BY.


## max_rows_to_read {#max_rows_to_read}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество строк, которое может быть прочитано из таблицы при выполнении запроса.
Ограничение проверяется для каждого обработанного блока данных, применяется только к
самому глубокому табличному выражению и при чтении с удалённого сервера проверяется только на
удалённом сервере.


## max_rows_to_read_leaf {#max_rows_to_read_leaf}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество строк, которое может быть прочитано из локальной таблицы на конечном узле при
выполнении распределённого запроса. Хотя распределённые запросы могут отправлять несколько подзапросов
на каждый шард (конечный узел), это ограничение проверяется только на этапе чтения на
конечных узлах и игнорируется на этапе объединения результатов на корневом узле.

Например, кластер состоит из 2 шардов, и каждый шард содержит таблицу со
100 строками. Распределённый запрос, который должен прочитать все данные из обеих
таблиц с настройкой `max_rows_to_read=150`, завершится с ошибкой, так как в общей сложности будет
200 строк. Запрос с `max_rows_to_read_leaf=150` выполнится успешно, поскольку конечные узлы
прочитают максимум 100 строк.

Ограничение проверяется для каждого обрабатываемого блока данных.

:::note
Эта настройка работает нестабильно при `prefer_localhost_replica=1`.
:::


## max_rows_to_sort {#max_rows_to_sort}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество строк перед сортировкой. Позволяет ограничить потребление памяти при сортировке.
Если для операции ORDER BY требуется обработать больше указанного количества записей,
поведение определяется настройкой `sort_overflow_mode`, которая по умолчанию имеет значение `throw`.


## max_rows_to_transfer {#max_rows_to_transfer}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальный размер (в строках), который может быть передан на удалённый сервер или сохранён во временной таблице при выполнении секции GLOBAL IN/JOIN.


## max_sessions_for_user {#max_sessions_for_user}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество одновременных сеансов на одного аутентифицированного пользователя сервера ClickHouse.

Пример:

```xml
<profiles>
    <single_session_profile>
        <max_sessions_for_user>1</max_sessions_for_user>
    </single_session_profile>
    <two_sessions_profile>
        <max_sessions_for_user>2</max_sessions_for_user>
    </two_sessions_profile>
    <unlimited_sessions_profile>
        <max_sessions_for_user>0</max_sessions_for_user>
    </unlimited_sessions_profile>
</profiles>
<users>
    <!-- Пользователь Alice может подключаться к серверу ClickHouse не более одного раза одновременно. -->
    <Alice>
        <profile>single_session_user</profile>
    </Alice>
    <!-- Пользователь Bob может использовать 2 одновременных сеанса. -->
    <Bob>
        <profile>two_sessions_profile</profile>
    </Bob>
    <!-- Пользователь Charles может использовать неограниченное количество одновременных сеансов. -->
    <Charles>
        <profile>unlimited_sessions_profile</profile>
    </Charles>
</users>
```

Возможные значения:

- Положительное целое число
- `0` — неограниченное количество одновременных сеансов (по умолчанию)


## max_size_to_preallocate_for_aggregation {#max_size_to_preallocate_for_aggregation}

<SettingsInfoBlock type='UInt64' default_value='1000000000000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.12" },
        { label: "1000000000000" },
        { label: "Включить оптимизацию для больших таблиц." }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "22.12" },
        { label: "100000000" },
        { label: "Оптимизирует производительность" }
      ]
    }
  ]}
/>

Для какого количества элементов допускается предварительное выделение памяти во всех хеш-таблицах суммарно перед агрегацией


## max_size_to_preallocate_for_joins {#max_size_to_preallocate_for_joins}

<SettingsInfoBlock type='UInt64' default_value='1000000000000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "100000000" },
        { label: "Новая настройка." }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.12" },
        { label: "1000000000000" },
        { label: "Включена оптимизация для больших таблиц." }
      ]
    }
  ]}
/>

Для какого количества элементов допускается предварительное выделение памяти во всех хеш-таблицах суммарно перед соедине


## max_streams_for_merge_tree_reading {#max_streams_for_merge_tree_reading}

<SettingsInfoBlock type='UInt64' default_value='0' />

Если значение не равно нулю, ограничивает количество потоков чтения для таблиц MergeTree.


## max_streams_multiplier_for_merge_tables {#max_streams_multiplier_for_merge_tables}

<SettingsInfoBlock type='Float' default_value='5' />

Запрашивать больше потоков при чтении из таблицы Merge. Потоки будут распределены по таблицам, которые использует таблица Merge. Это позволяет более равномерно распределить нагрузку между потоками и особенно полезно, когда объединяемые таблицы имеют разный размер.


## max_streams_to_max_threads_ratio {#max_streams_to_max_threads_ratio}

<SettingsInfoBlock type='Float' default_value='1' />

Позволяет использовать больше источников данных, чем потоков выполнения, для более равномерного распределения нагрузки между потоками. Это временное решение: в будущем планируется сделать количество источников равным количеству потоков, при этом каждый источник будет динамически выбирать доступную работу.


## max_subquery_depth {#max_subquery_depth}

<SettingsInfoBlock type='UInt64' default_value='100' />

Если запрос содержит больше указанного количества вложенных подзапросов, выбрасывается
исключение.

:::tip
Это позволяет установить проверку для защиты от написания пользователями
кластера чрезмерно сложных запросов.
:::


## max_table_size_to_drop {#max_table_size_to_drop}

<SettingsInfoBlock type='UInt64' default_value='50000000000' />

Ограничение на удаление таблиц во время выполнения запроса. Значение `0` означает, что можно удалять все таблицы без ограничений.

Значение по умолчанию в Cloud: 1 ТБ.

:::note
Эта настройка запроса переопределяет соответствующую серверную настройку, см. [max_table_size_to_drop](/operations/server-configuration-parameters/settings#max_table_size_to_drop)
:::


## max_temporary_columns {#max_temporary_columns}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество временных столбцов, которые должны одновременно храниться в оперативной памяти при выполнении запроса, включая константные столбцы. Если в результате промежуточных вычислений запрос создаёт в памяти больше указанного количества временных столбцов, возникает исключение.

:::tip
Эта настройка полезна для предотвращения выполнения слишком сложных запросов.
:::

Значение `0` означает отсутствие ограничений.


## max_temporary_data_on_disk_size_for_query {#max_temporary_data_on_disk_size_for_query}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальный объём данных в байтах, занимаемых временными файлами на диске для всех одновременно выполняющихся запросов.

Возможные значения:

- Положительное целое число.
- `0` — без ограничений (по умолчанию)


## max_temporary_data_on_disk_size_for_user {#max_temporary_data_on_disk_size_for_user}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальный объем данных в байтах, занимаемых временными файлами на диске для всех одновременно выполняемых пользовательских запросов.

Возможные значения:

- Положительное целое число.
- `0` — без ограничений (по умолчанию)


## max_temporary_non_const_columns {#max_temporary_non_const_columns}

<SettingsInfoBlock type='UInt64' default_value='0' />

Аналогично `max_temporary_columns`, максимальное количество временных столбцов, которые должны
одновременно храниться в оперативной памяти при выполнении запроса, но без учёта константных
столбцов.

:::note
Константные столбцы формируются достаточно часто при выполнении запроса, но требуют
практически нулевых вычислительных ресурсов.
:::


## max_threads {#max_threads}

<SettingsInfoBlock type='MaxThreads' default_value="'auto(N)'" />

Максимальное количество потоков обработки запроса, за исключением потоков для получения данных с удалённых серверов (см. параметр 'max_distributed_connections').

Этот параметр применяется к потокам, которые параллельно выполняют одни и те же стадии конвейера обработки запроса.
Например, при чтении из таблицы, если возможно параллельно вычислять выражения с функциями, фильтровать с помощью WHERE и выполнять предварительную агрегацию для GROUP BY, используя как минимум 'max_threads' потоков, то используется именно 'max_threads' потоков.

Для запросов, которые завершаются быстро благодаря LIMIT, можно установить меньшее значение 'max_threads'. Например, если необходимое количество записей содержится в каждом блоке и max_threads = 8, то будет извлечено 8 блоков, хотя достаточно было бы прочитать только один.

Чем меньше значение `max_threads`, тем меньше потребляется памяти.

Значение по умолчанию в Cloud: `auto(3)`


## max_threads_for_indexes {#max_threads_for_indexes}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество потоков для обработки индексов.


## max_untracked_memory {#max_untracked_memory}

<SettingsInfoBlock type='UInt64' default_value='4194304' />

Небольшие выделения и освобождения памяти группируются в локальной переменной потока и отслеживаются или профилируются только когда их объём (по абсолютному значению) превышает указанное значение. Если значение больше 'memory_profiler_step', оно будет автоматически снижено до 'memory_profiler_step'.


## memory_overcommit_ratio_denominator {#memory_overcommit_ratio_denominator}

<SettingsInfoBlock type='UInt64' default_value='1073741824' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "22.5" },
        { label: "1073741824" },
        { label: "Функция превышения лимита памяти включена по умолчанию" }
      ]
    }
  ]}
/>

Представляет мягкое ограничение памяти при достижении жёсткого ограничения на глобальном уровне.
Это значение используется для вычисления коэффициента превышения лимита для запроса.
Нулевое значение означает пропуск запроса.
Подробнее см. [превышение лимита памяти](memory-overcommit.md).


## memory_overcommit_ratio_denominator_for_user {#memory_overcommit_ratio_denominator_for_user}

<SettingsInfoBlock type='UInt64' default_value='1073741824' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "22.5" },
        { label: "1073741824" },
        { label: "Функция memory overcommit включена по умолчанию" }
      ]
    }
  ]}
/>

Представляет собой мягкое ограничение памяти при достижении жёсткого ограничения на уровне пользователя.
Это значение используется для вычисления коэффициента overcommit для запроса.
Нулевое значение означает пропуск запроса.
Подробнее см. [memory overcommit](memory-overcommit.md).


## memory_profiler_sample_max_allocation_size {#memory_profiler_sample_max_allocation_size}

<SettingsInfoBlock type='UInt64' default_value='0' />

Собирать случайные выделения памяти размером, меньшим или равным указанному значению, с вероятностью, равной `memory_profiler_sample_probability`. Значение 0 означает отключение функции. Для корректной работы этого порога может потребоваться установить параметр 'max_untracked_memory' в 0.


## memory_profiler_sample_min_allocation_size {#memory_profiler_sample_min_allocation_size}

<SettingsInfoBlock type='UInt64' default_value='0' />

Собирать случайные выделения памяти размером больше или равным указанному значению с вероятностью, равной `memory_profiler_sample_probability`. Значение 0 означает отключение. Для корректной работы этого порога рекомендуется установить параметр 'max_untracked_memory' в 0.


## memory_profiler_sample_probability {#memory_profiler_sample_probability}

<SettingsInfoBlock type='Float' default_value='0' />

Собирает случайные выделения и освобождения памяти и записывает их в system.trace_log с типом трассировки 'MemorySample'. Вероятность применяется к каждой операции выделения/освобождения независимо от размера выделяемой памяти (можно изменить с помощью параметров `memory_profiler_sample_min_allocation_size` и `memory_profiler_sample_max_allocation_size`). Обратите внимание, что сэмплирование выполняется только когда объём неотслеживаемой памяти превышает значение 'max_untracked_memory'. Для более детальной выборки рекомендуется установить 'max_untracked_memory' в 0.


## memory_profiler_step {#memory_profiler_step}

<SettingsInfoBlock type='UInt64' default_value='4194304' />

Задаёт шаг профилировщика памяти. Каждый раз, когда использование памяти запросом становится больше очередного шага (в байтах), профилировщик памяти собирает трассировку стека выделения и записывает её в [trace_log](/operations/system-tables/trace_log).

Возможные значения:

- Положительное целое число байтов.

- 0 — отключает профилировщик памяти.


## memory_tracker_fault_probability {#memory_tracker_fault_probability}

<SettingsInfoBlock type='Float' default_value='0' />

Для тестирования `безопасности обработки исключений` — генерировать исключение при каждом выделении памяти с заданной вероятностью.


## memory_usage_overcommit_max_wait_microseconds {#memory_usage_overcommit_max_wait_microseconds}

<SettingsInfoBlock type='UInt64' default_value='5000000' />

Максимальное время ожидания потоком освобождения памяти в случае превышения лимита памяти на уровне пользователя.
Если таймаут достигнут, а память не освобождена, генерируется исключение.
Подробнее см. [превышение лимита памяти](memory-overcommit.md).


## merge_table_max_tables_to_look_for_schema_inference {#merge_table_max_tables_to_look_for_schema_inference}

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.1" }, { label: "1000" }, { label: "A new setting" }]
    }
  ]}
/>

При создании таблицы `Merge` без явного указания схемы или при использовании табличной функции `merge` схема определяется как объединение не более указанного количества подходящих таблиц.
Если количество таблиц превышает указанное значение, схема будет определена на основе первых таблиц в указанном количестве.


## merge_tree_coarse_index_granularity {#merge_tree_coarse_index_granularity}

<SettingsInfoBlock type='UInt64' default_value='8' />

При поиске данных ClickHouse проверяет метки данных в файле индекса. Если ClickHouse обнаруживает, что требуемые ключи находятся в определённом диапазоне, он разделяет этот диапазон на `merge_tree_coarse_index_granularity` поддиапазонов и рекурсивно выполняет поиск требуемых ключей в них.

Возможные значения:

- Любое положительное чётное целое число.


## merge_tree_compact_parts_min_granules_to_multibuffer_read {#merge_tree_compact_parts_min_granules_to_multibuffer_read}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='16' />

Действует только в ClickHouse Cloud. Количество гранул в полосе компактной части таблиц MergeTree для использования многобуферного читателя, который поддерживает параллельное чтение и предзагрузку. При чтении из удалённой файловой системы использование многобуферного читателя увеличивает количество запросов на чтение.


## merge_tree_determine_task_size_by_prewhere_columns {#merge_tree_determine_task_size_by_prewhere_columns}

<SettingsInfoBlock type='Bool' default_value='1' />

Определять ли размер задачи чтения только по размеру столбцов prewhere.


## merge_tree_max_bytes_to_use_cache {#merge_tree_max_bytes_to_use_cache}

<SettingsInfoBlock type='UInt64' default_value='2013265920' />

Если ClickHouse необходимо прочитать более `merge_tree_max_bytes_to_use_cache` байт в одном запросе, кеш несжатых блоков не используется.

Кеш несжатых блоков хранит данные, извлеченные при выполнении запросов. ClickHouse использует этот кеш для ускорения ответов на повторяющиеся небольшие запросы. Данная настройка защищает кеш от переполнения запросами, читающими большой объем данных. Размер кеша несжатых блоков определяется серверной настройкой [uncompressed_cache_size](/operations/server-configuration-parameters/settings#uncompressed_cache_size).

Возможные значения:

- Любое положительное целое число.


## merge_tree_max_rows_to_use_cache {#merge_tree_max_rows_to_use_cache}

<SettingsInfoBlock type='UInt64' default_value='1048576' />

Если ClickHouse читает более `merge_tree_max_rows_to_use_cache` строк в одном запросе, кеш несжатых блоков не используется.

Кеш несжатых блоков хранит данные, извлечённые для запросов. ClickHouse использует этот кеш для ускорения ответов на повторяющиеся небольшие запросы. Данная настройка защищает кеш от переполнения запросами, читающими большой объём данных. Серверная настройка [uncompressed_cache_size](/operations/server-configuration-parameters/settings#uncompressed_cache_size) определяет размер кеша несжатых блоков.

Возможные значения:

- Любое положительное целое число.


## merge_tree_min_bytes_for_concurrent_read {#merge_tree_min_bytes_for_concurrent_read}

<SettingsInfoBlock type='UInt64' default_value='251658240' />

Если количество байтов, которые необходимо прочитать из одного файла таблицы с движком [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md), превышает `merge_tree_min_bytes_for_concurrent_read`, то ClickHouse пытается выполнить параллельное чтение этого файла в нескольких потоках.

Возможное значение:

- Положительное целое число.


## merge_tree_min_bytes_for_concurrent_read_for_remote_filesystem {#merge_tree_min_bytes_for_concurrent_read_for_remote_filesystem}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "0" },
        { label: "Настройка устарела" }
      ]
    }
  ]}
/>

Минимальное количество байтов для чтения из одного файла, после которого движок [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) может распараллелить чтение при работе с удалённой файловой системой. Не рекомендуется использовать эту настройку.

Возможные значения:

- Положительное целое число.


## merge_tree_min_bytes_for_seek {#merge_tree_min_bytes_for_seek}

<SettingsInfoBlock type='UInt64' default_value='0' />

Если расстояние между двумя блоками данных для чтения в одном файле меньше `merge_tree_min_bytes_for_seek` байт, то ClickHouse последовательно читает диапазон файла, содержащий оба блока, избегая таким образом дополнительного seek.

Возможные значения:

- Любое положительное целое число.


## merge_tree_min_bytes_per_task_for_remote_reading {#merge_tree_min_bytes_per_task_for_remote_reading}

**Псевдонимы**: `filesystem_prefetch_min_bytes_for_single_read_task`

<SettingsInfoBlock type='UInt64' default_value='2097152' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.8" },
        { label: "2097152" },
        {
          label:
            "Значение унифицировано с `filesystem_prefetch_min_bytes_for_single_read_task`"
        }
      ]
    }
  ]}
/>

Минимальное количество байтов для чтения на одну задачу.


## merge_tree_min_read_task_size {#merge_tree_min_read_task_size}

<SettingsInfoBlock type='NonZeroUInt64' default_value='8' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.10" }, { label: "8" }, { label: "Новая настройка" }]
    }
  ]}
/>

Жёсткий нижний порог размера задачи (даже при малом количестве гранул и большом количестве доступных потоков задачи меньшего размера выделяться не будут


## merge_tree_min_rows_for_concurrent_read {#merge_tree_min_rows_for_concurrent_read}

<SettingsInfoBlock type='UInt64' default_value='163840' />

Если количество строк, которые необходимо прочитать из файла таблицы [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md), превышает значение `merge_tree_min_rows_for_concurrent_read`, ClickHouse пытается выполнить параллельное чтение этого файла в нескольких потоках.

Возможные значения:

- Положительное целое число.


## merge_tree_min_rows_for_concurrent_read_for_remote_filesystem {#merge_tree_min_rows_for_concurrent_read_for_remote_filesystem}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "0" },
        { label: "Настройка устарела" }
      ]
    }
  ]}
/>

Минимальное количество строк для чтения из одного файла, прежде чем движок [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) сможет распараллелить чтение при чтении из удалённой файловой системы. Не рекомендуется использовать эту настройку.

Возможные значения:

- Положительное целое число.


## merge_tree_min_rows_for_seek {#merge_tree_min_rows_for_seek}

<SettingsInfoBlock type='UInt64' default_value='0' />

Если расстояние между двумя блоками данных для чтения в одном файле меньше `merge_tree_min_rows_for_seek` строк, то ClickHouse не выполняет позиционирование в файле, а читает данные последовательно.

Возможные значения:

- Любое положительное целое число.


## merge_tree_read_split_ranges_into_intersecting_and_non_intersecting_injection_probability {#merge_tree_read_split_ranges_into_intersecting_and_non_intersecting_injection_probability}

<SettingsInfoBlock type='Float' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "0" },
        {
          label:
            "Для тестирования `PartsSplitter` — разделяет диапазоны чтения на пересекающиеся и непересекающиеся при каждом чтении из MergeTree с заданной вероятностью."
        }
      ]
    }
  ]}
/>

Для тестирования `PartsSplitter` — разделяет диапазоны чтения на пересекающиеся и непересекающиеся при каждом чтении из MergeTree с заданной вероятностью.


## merge_tree_storage_snapshot_sleep_ms {#merge_tree_storage_snapshot_sleep_ms}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "0" },
        {
          label: "Новая настройка для отладки согласованности снимков хранилища в запросах"
        }
      ]
    }
  ]}
/>

Добавляет искусственную задержку (в миллисекундах) при создании снимка хранилища для таблиц MergeTree.
Используется только для тестирования и отладки.

Возможные значения:

- 0 — без задержки (по умолчанию)
- N — задержка в миллисекундах


## merge_tree_use_const_size_tasks_for_remote_reading {#merge_tree_use_const_size_tasks_for_remote_reading}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать ли задачи фиксированного размера для чтения из удалённой таблицы.


## merge_tree_use_deserialization_prefixes_cache {#merge_tree_use_deserialization_prefixes_cache}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.2" },
        { label: "1" },
        {
          label:
            "Новая настройка для управления использованием кэша префиксов десериализации в MergeTree"
        }
      ]
    }
  ]}
/>

Включает кэширование метаданных столбцов из префиксов файлов при чтении с удалённых дисков в MergeTree.


## merge_tree_use_prefixes_deserialization_thread_pool {#merge_tree_use_prefixes_deserialization_thread_pool}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.2" },
        { label: "1" },
        {
          label:
            "Новая настройка для управления использованием пула потоков при параллельной десериализации префиксов в MergeTree"
        }
      ]
    }
  ]}
/>

Включает использование пула потоков для параллельного чтения префиксов в Wide-частях MergeTree. Размер пула потоков задаётся серверной настройкой `max_prefixes_deserialization_thread_pool_size`.


## merge_tree_use_v1_object_and_dynamic_serialization {#merge_tree_use_v1_object_and_dynamic_serialization}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.11" },
        { label: "0" },
        { label: "Добавлена новая версия сериализации V2 для типов JSON и Dynamic" }
      ]
    }
  ]}
/>

При включении этой настройки в MergeTree будет использоваться версия сериализации V1 для типов JSON и Dynamic вместо V2. Изменение этой настройки вступает в силу только после перезапуска сервера.


## metrics_perf_events_enabled {#metrics_perf_events_enabled}

<SettingsInfoBlock type='Bool' default_value='0' />

Если включено, некоторые события perf будут измеряться на протяжении выполнения запросов.


## metrics_perf_events_list {#metrics_perf_events_list}

Список метрик производительности, разделённых запятыми, которые будут измеряться в ходе выполнения запросов. Пустое значение означает все события. Список доступных событий см. в PerfEventInfo в исходном коде.


## min_bytes_to_use_direct_io {#min_bytes_to_use_direct_io}

<SettingsInfoBlock type='UInt64' default_value='0' />

Минимальный объём данных, необходимый для использования прямого доступа I/O к диску хранилища.

ClickHouse использует эту настройку при чтении данных из таблиц. Если общий объём всех данных для чтения превышает `min_bytes_to_use_direct_io` байт, то ClickHouse читает данные с диска хранилища с опцией `O_DIRECT`.

Возможные значения:

- 0 — прямой I/O отключён.
- Положительное целое число.


## min_bytes_to_use_mmap_io {#min_bytes_to_use_mmap_io}

<SettingsInfoBlock type='UInt64' default_value='0' />

Это экспериментальная настройка. Задаёт минимальный объём памяти для чтения больших файлов без копирования данных из ядра в пространство пользователя. Рекомендуемое пороговое значение составляет около 64 МБ, поскольку [mmap/munmap](https://en.wikipedia.org/wiki/Mmap) работает медленно. Имеет смысл только для больших файлов и эффективна только в том случае, если данные находятся в кэше страниц.

Возможные значения:

- Положительное целое число.
- 0 — большие файлы читаются с копированием данных из ядра в пространство пользователя.


## min_chunk_bytes_for_parallel_parsing {#min_chunk_bytes_for_parallel_parsing}

<SettingsInfoBlock type='NonZeroUInt64' default_value='10485760' />

- Тип: unsigned int
- Значение по умолчанию: 1 МиБ

Минимальный размер фрагмента в байтах, который будет обрабатываться каждым потоком при параллельном парсинге.


## min_compress_block_size {#min_compress_block_size}

<SettingsInfoBlock type='UInt64' default_value='65536' />

Для таблиц [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md). Чтобы снизить задержки при обработке запросов, блок сжимается при записи следующей метки, если его размер составляет не менее `min_compress_block_size`. Значение по умолчанию — 65 536.

Фактический размер блока, если несжатые данные меньше `max_compress_block_size`, составляет не менее этого значения и не менее объёма данных для одной метки.

Рассмотрим пример. Предположим, что при создании таблицы параметр `index_granularity` был установлен равным 8192.

Записывается столбец типа UInt32 (4 байта на значение). При записи 8192 строк общий объём составит 32 КБ данных. Поскольку min_compress_block_size = 65 536, сжатый блок будет формироваться на каждые две метки.

Записывается столбец URL типа String (средний размер 60 байт на значение). При записи 8192 строк средний объём составит немного менее 500 КБ данных. Поскольку это больше 65 536, сжатый блок будет формироваться для каждой метки. В этом случае при чтении данных с диска в диапазоне одной метки лишние данные не будут распаковываться.

:::note
Это настройка экспертного уровня, её не следует изменять, если вы только начинаете работать с ClickHouse.
:::


## min_count_to_compile_aggregate_expression {#min_count_to_compile_aggregate_expression}

<SettingsInfoBlock type='UInt64' default_value='3' />

Минимальное количество идентичных агрегатных выражений для запуска JIT-компиляции. Работает только при включённой настройке [compile_aggregate_expressions](#compile_aggregate_expressions).

Возможные значения:

- Положительное целое число.
- 0 — идентичные агрегатные выражения всегда JIT-компилируются.


## min_count_to_compile_expression {#min_count_to_compile_expression}

<SettingsInfoBlock type='UInt64' default_value='3' />

Минимальное количество выполнений одного и того же выражения до его компиляции.


## min_count_to_compile_sort_description {#min_count_to_compile_sort_description}

<SettingsInfoBlock type='UInt64' default_value='3' />

Количество идентичных описаний сортировки до их JIT-компиляции


## min_execution_speed {#min_execution_speed}

<SettingsInfoBlock type='UInt64' default_value='0' />

Минимальная скорость выполнения в строках в секунду. Проверяется на каждом блоке данных после истечения времени ожидания
[`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed).
Если скорость выполнения ниже заданной, выбрасывается исключение.


## min_execution_speed_bytes {#min_execution_speed_bytes}

<SettingsInfoBlock type='UInt64' default_value='0' />

Минимальное количество байтов, обрабатываемых в секунду. Проверяется на каждом блоке данных после истечения
[`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed).
Если скорость обработки ниже указанного значения, генерируется исключение.


## min_external_table_block_size_bytes {#min_external_table_block_size_bytes}

<SettingsInfoBlock type='UInt64' default_value='268402944' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "268402944" },
        {
          label:
            "Объединять блоки, передаваемые во внешнюю таблицу, до указанного размера в байтах, если блоки недостаточно велики."
        }
      ]
    }
  ]}
/>

Объединять блоки, передаваемые во внешнюю таблицу, до указанного размера в байтах, если блоки недостаточно велики.


## min_external_table_block_size_rows {#min_external_table_block_size_rows}

<SettingsInfoBlock type='UInt64' default_value='1048449' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "1048449" },
        {
          label:
            "Объединяет блоки, передаваемые во внешнюю таблицу, до указанного размера в строках, если блоки недостаточно велики"
        }
      ]
    }
  ]}
/>

Объединяет блоки, передаваемые во внешнюю таблицу, до указанного размера в строках, если блоки недостаточно велики.


## min_free_disk_bytes_to_perform_insert {#min_free_disk_bytes_to_perform_insert}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.9" },
        { label: "0" },
        {
          label:
            "Поддержание минимального объема свободного места на диске при вставках с сохранением возможности временной записи."
        }
      ]
    },
    {
      id: "row-2",
      items: [{ label: "24.10" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Минимальный объем свободного места на диске (в байтах) для выполнения вставки.


## min_free_disk_ratio_to_perform_insert {#min_free_disk_ratio_to_perform_insert}

<SettingsInfoBlock type='Float' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.9" },
        { label: "0" },
        {
          label:
            "Сохранение минимального объема свободного дискового пространства (в виде доли от общего объема диска) при выполнении вставок с возможностью временной записи."
        }
      ]
    },
    {
      id: "row-2",
      items: [{ label: "24.10" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Минимальная доля свободного дискового пространства, необходимая для выполнения вставки.


## min_free_disk_space_for_temporary_data {#min_free_disk_space_for_temporary_data}

<SettingsInfoBlock type='UInt64' default_value='0' />

Минимальный объем свободного дискового пространства, который необходимо сохранять при записи временных данных, используемых для внешней сортировки и агрегации.


## min_hit_rate_to_use_consecutive_keys_optimization {#min_hit_rate_to_use_consecutive_keys_optimization}

<SettingsInfoBlock type='Float' default_value='0.5' />

Минимальный коэффициент попаданий в кэш для сохранения оптимизации последовательных ключей при агрегации


## min_insert_block_size_bytes {#min_insert_block_size_bytes}

<SettingsInfoBlock type='UInt64' default_value='268402944' />

Устанавливает минимальное количество байтов в блоке, который может быть вставлен в таблицу запросом `INSERT`. Блоки меньшего размера объединяются в более крупные.

Возможные значения:

- Положительное целое число.
- 0 — объединение отключено.


## min_insert_block_size_bytes_for_materialized_views {#min_insert_block_size_bytes_for_materialized_views}

<SettingsInfoBlock type='UInt64' default_value='0' />

Задаёт минимальное количество байтов в блоке, который может быть вставлен в таблицу запросом `INSERT`. Блоки меньшего размера объединяются в более крупные. Эта настройка применяется только для блоков, вставляемых в [материализованное представление](../../sql-reference/statements/create/view.md). Изменяя этот параметр, вы управляете объединением блоков при отправке данных в материализованное представление и предотвращаете избыточное потребление памяти.

Возможные значения:

- Любое положительное целое число.
- 0 — объединение отключено.

**См. также**

- [min_insert_block_size_bytes](#min_insert_block_size_bytes)


## min_insert_block_size_rows {#min_insert_block_size_rows}

<SettingsInfoBlock type='UInt64' default_value='1048449' />

Задаёт минимальное количество строк в блоке, который может быть вставлен в таблицу запросом `INSERT`. Блоки меньшего размера объединяются в более крупные.

Возможные значения:

- Положительное целое число.
- 0 — объединение отключено.


## min_insert_block_size_rows_for_materialized_views {#min_insert_block_size_rows_for_materialized_views}

<SettingsInfoBlock type='UInt64' default_value='0' />

Задаёт минимальное количество строк в блоке, который может быть вставлен в таблицу запросом `INSERT`. Блоки меньшего размера объединяются в более крупные. Эта настройка применяется только к блокам, вставляемым в [материализованное представление](../../sql-reference/statements/create/view.md). Изменяя эту настройку, вы управляете объединением блоков при отправке данных в материализованное представление и предотвращаете избыточное потребление памяти.

Возможные значения:

- Любое положительное целое число.
- 0 — объединение отключено.

**См. также**

- [min_insert_block_size_rows](#min_insert_block_size_rows)


## min_joined_block_size_bytes {#min_joined_block_size_bytes}

<SettingsInfoBlock type='UInt64' default_value='524288' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.11" },
        { label: "524288" },
        { label: "Новая настройка." }
      ]
    }
  ]}
/>

Минимальный размер блока в байтах для входных и выходных блоков JOIN (если алгоритм соединения поддерживает эту возможность). Небольшие блоки будут объединены. Значение 0 означает отсутствие ограничений.


## min_joined_block_size_rows {#min_joined_block_size_rows}

<SettingsInfoBlock type='UInt64' default_value='65409' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.7" }, { label: "65409" }, { label: "Новая настройка." }]
    }
  ]}
/>

Минимальный размер блока в строках для входных и выходных блоков JOIN (если алгоритм соединения поддерживает эту возможность). Небольшие блоки будут объединены. Значение 0 означает отсутствие ограничений.


## min_os_cpu_wait_time_ratio_to_throw {#min_os_cpu_wait_time_ratio_to_throw}

<SettingsInfoBlock type='Float' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "0" },
        { label: "Значения настройки были изменены и портированы в версию 25.4" }
      ]
    },
    {
      id: "row-2",
      items: [{ label: "25.4" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Минимальное соотношение между временем ожидания процессора операционной системы (метрика OSCPUWaitMicroseconds) и временем его занятости (метрика OSCPUVirtualTimeMicroseconds), при котором рассматривается возможность отклонения запросов. Для вычисления вероятности используется линейная интерполяция между минимальным и максимальным соотношением; в данной точке вероятность равна 0.


## min_outstreams_per_resize_after_split {#min_outstreams_per_resize_after_split}

<SettingsInfoBlock type='UInt64' default_value='24' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.6" }, { label: "24" }, { label: "Новая настройка." }]
    }
  ]}
/>

Задает минимальное количество выходных потоков процессора `Resize` или `StrictResize` после выполнения разделения во время генерации конвейера. Если результирующее количество потоков меньше этого значения, операция разделения не выполняется.

### Что такое узел Resize

Узел `Resize` — это процессор в конвейере запросов, который регулирует количество потоков данных, проходящих через конвейер. Он может увеличивать или уменьшать количество потоков для балансировки рабочей нагрузки между несколькими потоками или процессорами. Например, если запрос требует большего параллелизма, узел `Resize` может разделить один поток на несколько потоков. И наоборот, он может объединить несколько потоков в меньшее количество для консолидации обработки данных.

Узел `Resize` обеспечивает равномерное распределение данных по потокам, сохраняя структуру блоков данных. Это помогает оптимизировать использование ресурсов и повысить производительность запросов.

### Зачем нужно разделять узел Resize

Во время выполнения конвейера ExecutingGraph::Node::status_mutex центрального узла `Resize` подвергается интенсивной конкуренции, особенно в средах с большим количеством ядер, и эта конкуренция приводит к:

1. Увеличению задержки для ExecutingGraph::updateNode, что напрямую влияет на производительность запросов.
2. Избыточным тратам циклов процессора на конкуренцию за spin-lock (native_queued_spin_lock_slowpath), что снижает эффективность.
3. Снижению использования процессора, что ограничивает параллелизм и пропускную способность.

### Как происходит разделение узла Resize

1. Проверяется количество выходных потоков, чтобы убедиться, что разделение может быть выполнено: выходные потоки каждого разделенного процессора соответствуют или превышают пороговое значение `min_outstreams_per_resize_after_split`.
2. Узел `Resize` разделяется на меньшие узлы `Resize` с равным количеством портов, каждый из которых обрабатывает подмножество входных и выходных потоков.
3. Каждая группа обрабатывается независимо, что снижает конкуренцию за блокировки.

### Разделение узла Resize с произвольными входами/выходами

В некоторых случаях, когда входы/выходы не делятся нацело на количество разделенных узлов `Resize`, некоторые входы подключаются к `NullSource`, а некоторые выходы — к `NullSink`. Это позволяет выполнить разделение без влияния на общий поток данных.

### Назначение настройки

Настройка `min_outstreams_per_resize_after_split` гарантирует, что разделение узлов `Resize` является осмысленным и предотвращает создание слишком малого количества потоков, что может привести к неэффективной параллельной обработке. Устанавливая минимальное количество выходных потоков, эта настройка помогает поддерживать баланс между параллелизмом и накладными расходами, оптимизируя выполнение запросов в сценариях, связанных с разделением и объединением потоков.

### Отключение настройки

Чтобы отключить разделение узлов `Resize`, установите эту настройку в 0. Это предотвратит разделение узлов `Resize` во время генерации конвейера, позволяя им сохранить исходную структуру без разделения на меньшие узлы.


## min_table_rows_to_use_projection_index {#min_table_rows_to_use_projection_index}

<SettingsInfoBlock type='UInt64' default_value='1000000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "1000000" },
        { label: "Новая настройка" }
      ]
    }
  ]}
/>

Если предполагаемое количество строк для чтения из таблицы больше или равно этому порогу, ClickHouse попытается использовать индекс проекции во время выполнения запроса.


## mongodb_throw_on_unsupported_query {#mongodb_throw_on_unsupported_query}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.9" }, { label: "1" }, { label: "Новая настройка." }]
    },
    {
      id: "row-2",
      items: [{ label: "24.10" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Если включено, таблицы MongoDB будут возвращать ошибку, когда невозможно построить запрос MongoDB. В противном случае ClickHouse читает всю таблицу и обрабатывает её локально. Эта настройка не применяется при 'allow_experimental_analyzer=0'.


## move_all_conditions_to_prewhere {#move_all_conditions_to_prewhere}

<SettingsInfoBlock type='Bool' default_value='1' />

Перемещать все применимые условия из WHERE в PREWHERE


## move_primary_key_columns_to_end_of_prewhere {#move_primary_key_columns_to_end_of_prewhere}

<SettingsInfoBlock type='Bool' default_value='1' />

Перемещает условия PREWHERE, содержащие столбцы первичного ключа, в конец цепочки AND. Вероятно, эти условия уже учитываются при анализе первичного ключа и поэтому не окажут существенного влияния на фильтрацию PREWHERE.


## multiple_joins_try_to_keep_original_names {#multiple_joins_try_to_keep_original_names}

<SettingsInfoBlock type='Bool' default_value='0' />

Не добавлять псевдонимы в список выражений верхнего уровня при переписывании множественных JOIN


## mutations_execute_nondeterministic_on_initiator {#mutations_execute_nondeterministic_on_initiator}

<SettingsInfoBlock type='Bool' default_value='0' />

Если установлено значение true, константные недетерминированные функции (например, функция `now()`) выполняются на инициаторе и заменяются на литералы в запросах `UPDATE` и `DELETE`. Это помогает поддерживать синхронизацию данных между репликами при выполнении мутаций с константными недетерминированными функциями. Значение по умолчанию: `false`.


## mutations_execute_subqueries_on_initiator {#mutations_execute_subqueries_on_initiator}

<SettingsInfoBlock type='Bool' default_value='0' />

Если значение true, скалярные подзапросы выполняются на узле-инициаторе и заменяются литералами в запросах `UPDATE` и `DELETE`. Значение по умолчанию: `false`.


## mutations_max_literal_size_to_replace {#mutations_max_literal_size_to_replace}

<SettingsInfoBlock type='UInt64' default_value='16384' />

Максимальный размер сериализованного литерала в байтах для замены в запросах `UPDATE` и `DELETE`. Действует только при включении хотя бы одной из двух настроек, указанных выше. Значение по умолчанию: 16384 (16 КиБ).


## mutations_sync {#mutations_sync}

<SettingsInfoBlock type='UInt64' default_value='0' />

Позволяет выполнять запросы `ALTER TABLE ... UPDATE|DELETE|MATERIALIZE INDEX|MATERIALIZE PROJECTION|MATERIALIZE COLUMN|MATERIALIZE STATISTICS` ([мутации](../../sql-reference/statements/alter/index.md/#mutations)) синхронно.

Возможные значения:

| Значение | Описание                                                                                                                                            |
| ----- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `0`   | Мутации выполняются асинхронно.                                                                                                                      |
| `1`   | Запрос ожидает завершения всех мутаций на текущем сервере.                                                                                   |
| `2`   | Запрос ожидает завершения всех мутаций на всех репликах (если они существуют).                                                                         |
| `3`   | Запрос ожидает завершения мутаций только на активных репликах. Поддерживается только для `SharedMergeTree`. Для `ReplicatedMergeTree` работает так же, как `mutations_sync = 2`. |


## mysql_datatypes_support_level {#mysql_datatypes_support_level}

Определяет, как типы данных MySQL преобразуются в соответствующие типы ClickHouse. Список значений через запятую в любой комбинации: `decimal`, `datetime64`, `date2Date32` или `date2String`.

- `decimal`: преобразовывать типы `NUMERIC` и `DECIMAL` в `Decimal`, если позволяет точность.
- `datetime64`: преобразовывать типы `DATETIME` и `TIMESTAMP` в `DateTime64` вместо `DateTime`, если точность не равна `0`.
- `date2Date32`: преобразовывать `DATE` в `Date32` вместо `Date`. Имеет приоритет над `date2String`.
- `date2String`: преобразовывать `DATE` в `String` вместо `Date`. Переопределяется `datetime64`.


## mysql_map_fixed_string_to_text_in_show_columns {#mysql_map_fixed_string_to_text_in_show_columns}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "1" },
        {
          label:
            "Упрощение настройки подключения ClickHouse к инструментам бизнес-аналитики."
        }
      ]
    }
  ]}
/>

При включении тип данных ClickHouse [FixedString](../../sql-reference/data-types/fixedstring.md) отображается как `TEXT` в [SHOW COLUMNS](../../sql-reference/statements/show.md/#show_columns).

Действует только при подключении через протокол MySQL wire protocol.

- 0 — Использовать `BLOB`.
- 1 — Использовать `TEXT`.


## mysql_map_string_to_text_in_show_columns {#mysql_map_string_to_text_in_show_columns}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "1" },
        {
          label:
            "Упрощение настройки подключения ClickHouse к BI-инструментам."
        }
      ]
    }
  ]}
/>

При включении тип данных ClickHouse [String](../../sql-reference/data-types/string.md) будет отображаться как `TEXT` в [SHOW COLUMNS](../../sql-reference/statements/show.md/#show_columns).

Действует только при подключении через протокол MySQL.

- 0 — использовать `BLOB`.
- 1 — использовать `TEXT`.


## mysql_max_rows_to_insert {#mysql_max_rows_to_insert}

<SettingsInfoBlock type='UInt64' default_value='65536' />

Максимальное количество строк в пакетной вставке MySQL движка хранения MySQL


## network_compression_method {#network_compression_method}

<SettingsInfoBlock type='String' default_value='LZ4' />

Кодек для сжатия данных при обмене между клиентом и сервером, а также между серверами.

Возможные значения:

- `NONE` — без сжатия.
- `LZ4` — использовать кодек LZ4.
- `LZ4HC` — использовать кодек LZ4HC.
- `ZSTD` — использовать кодек ZSTD.

**См. также**

- [network_zstd_compression_level](#network_zstd_compression_level)


## network_zstd_compression_level {#network_zstd_compression_level}

<SettingsInfoBlock type='Int64' default_value='1' />

Настраивает уровень сжатия ZSTD. Используется только при установке [network_compression_method](#network_compression_method) в значение `ZSTD`.

Возможные значения:

- Положительное целое число от 1 до 15.


## normalize_function_names {#normalize_function_names}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "21.3" },
        { label: "1" },
        {
          label:
            "Нормализовать имена функций к их каноническим именам, это было необходимо для маршрутизации запросов проекций"
        }
      ]
    }
  ]}
/>

Нормализовать имена функций к их каноническим именам


## number_of_mutations_to_delay {#number_of_mutations_to_delay}

<SettingsInfoBlock type='UInt64' default_value='0' />

Если таблица содержит как минимум указанное количество незавершённых мутаций, искусственно замедляется выполнение мутаций этой таблицы. 0 — отключено


## number_of_mutations_to_throw {#number_of_mutations_to_throw}

<SettingsInfoBlock type='UInt64' default_value='0' />

Если таблица содержит как минимум указанное количество незавершённых мутаций, выбрасывается исключение 'Too many mutations ...'. 0 — отключено


## odbc_bridge_connection_pool_size {#odbc_bridge_connection_pool_size}

<SettingsInfoBlock type='UInt64' default_value='16' />

Размер пула соединений для каждой строки параметров подключения в ODBC-мосте.


## odbc_bridge_use_connection_pooling {#odbc_bridge_use_connection_pooling}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать пулирование соединений в ODBC bridge. Если установлено значение false, при каждом обращении создается новое соединение.


## offset {#offset}

<SettingsInfoBlock type='UInt64' default_value='0' />

Задает количество строк, которые необходимо пропустить перед началом возврата строк из запроса. Корректирует смещение, установленное конструкцией [OFFSET](/sql-reference/statements/select/offset), так что эти два значения суммируются.

Возможные значения:

- 0 — строки не пропускаются.
- Положительное целое число.

**Пример**

Входная таблица:

```sql
CREATE TABLE test (i UInt64) ENGINE = MergeTree() ORDER BY i;
INSERT INTO test SELECT number FROM numbers(500);
```

Запрос:

```sql
SET limit = 5;
SET offset = 7;
SELECT * FROM test LIMIT 10 OFFSET 100;
```

Результат:

```text
┌───i─┐
│ 107 │
│ 108 │
│ 109 │
└─────┘
```


## opentelemetry_start_trace_probability {#opentelemetry_start_trace_probability}

<SettingsInfoBlock type='Float' default_value='0' />

Задает вероятность того, что ClickHouse начнет трассировку для выполняемых запросов (если не предоставлен родительский [контекст трассировки](https://www.w3.org/TR/trace-context/)).

Возможные значения:

- 0 — трассировка для всех выполняемых запросов отключена (если не предоставлен родительский контекст трассировки).
- Положительное число с плавающей точкой в диапазоне [0..1]. Например, если значение настройки равно `0,5`, ClickHouse будет начинать трассировку в среднем для половины запросов.
- 1 — трассировка для всех выполняемых запросов включена.


## opentelemetry_trace_cpu_scheduling {#opentelemetry_trace_cpu_scheduling}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.8" },
        { label: "0" },
        { label: "Новая настройка для трассировки функции `cpu_slot_preemption`." }
      ]
    }
  ]}
/>

Собирать OpenTelemetry spans для вытесняющего планирования CPU рабочей нагрузки.


## opentelemetry_trace_processors {#opentelemetry_trace_processors}

<SettingsInfoBlock type='Bool' default_value='0' />

Собирать спаны OpenTelemetry для процессоров.


## optimize_aggregation_in_order {#optimize_aggregation_in_order}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает оптимизацию [GROUP BY](/sql-reference/statements/select/group-by) в запросах [SELECT](../../sql-reference/statements/select/index.md) для агрегирования данных в соответствующем порядке в таблицах [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).

Возможные значения:

- 0 — оптимизация `GROUP BY` отключена.
- 1 — оптимизация `GROUP BY` включена.

**См. также**

- [Оптимизация GROUP BY](/sql-reference/statements/select/group-by#group-by-optimization-depending-on-table-sorting-key)


## optimize_aggregators_of_group_by_keys {#optimize_aggregators_of_group_by_keys}

<SettingsInfoBlock type='Bool' default_value='1' />

Исключает агрегаторы min/max/any/anyLast для ключей GROUP BY в секции SELECT


## optimize_and_compare_chain {#optimize_and_compare_chain}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.2" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Дополняет цепочки сравнений с константами в выражениях AND для повышения эффективности фильтрации. Поддерживаются операторы `<`, `<=`, `>`, `>=`, `=` и их комбинации. Например, выражение `(a < b) AND (b < c) AND (c < 5)` будет преобразовано в `(a < b) AND (b < c) AND (c < 5) AND (b < 5) AND (a < 5)`.


## optimize_append_index {#optimize_append_index}

<SettingsInfoBlock type='Bool' default_value='0' />

Использовать [ограничения](../../sql-reference/statements/create/table.md/#constraints) для добавления условия индекса. Значение по умолчанию — `false`.

Возможные значения:

- true, false


## optimize_arithmetic_operations_in_aggregate_functions {#optimize_arithmetic_operations_in_aggregate_functions}

<SettingsInfoBlock type='Bool' default_value='1' />

Выносить арифметические операции за пределы агрегатных функций


## optimize_const_name_size {#optimize_const_name_size}

<SettingsInfoBlock type='Int64' default_value='256' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "256" },
        {
          label:
            "Заменять скаляром и использовать хеш в качестве имени для больших констант (размер определяется длиной имени)"
        }
      ]
    }
  ]}
/>

Заменять скаляром и использовать хеш в качестве имени для больших констант (размер определяется длиной имени).

Возможные значения:

- положительное целое число — максимальная длина имени,
- 0 — всегда,
- отрицательное целое число — никогда.


## optimize_count_from_files {#optimize_count_from_files}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает оптимизацию подсчёта количества строк из файлов в различных входных форматах. Применяется к табличным функциям и движкам `file`/`s3`/`url`/`hdfs`/`azureBlobStorage`.

Возможные значения:

- 0 — Оптимизация отключена.
- 1 — Оптимизация включена.


## optimize_distinct_in_order {#optimize_distinct_in_order}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает оптимизацию DISTINCT, если некоторые столбцы в DISTINCT образуют префикс сортировки. Например, префикс ключа сортировки в таблицах семейства MergeTree или в операторе ORDER BY


## optimize_distributed_group_by_sharding_key {#optimize_distributed_group_by_sharding_key}

<SettingsInfoBlock type='Bool' default_value='1' />

Оптимизирует запросы `GROUP BY sharding_key`, избегая ресурсоёмкой агрегации на сервере-инициаторе (что снижает потребление памяти для запроса на сервере-инициаторе).

Поддерживаются следующие типы запросов (и все их комбинации):

- `SELECT DISTINCT [..., ]sharding_key[, ...] FROM dist`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...]`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...] ORDER BY x`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...] LIMIT 1`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...] LIMIT 1 BY x`

Следующие типы запросов не поддерживаются (поддержка некоторых из них может быть добавлена позднее):

- `SELECT ... GROUP BY sharding_key[, ...] WITH TOTALS`
- `SELECT ... GROUP BY sharding_key[, ...] WITH ROLLUP`
- `SELECT ... GROUP BY sharding_key[, ...] WITH CUBE`
- `SELECT ... GROUP BY sharding_key[, ...] SETTINGS extremes=1`

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

См. также:

- [distributed_group_by_no_merge](#distributed_group_by_no_merge)
- [distributed_push_down_limit](#distributed_push_down_limit)
- [optimize_skip_unused_shards](#optimize_skip_unused_shards)

:::note
В настоящее время требуется настройка `optimize_skip_unused_shards` (причина в том, что в будущем она может быть включена по умолчанию, и корректная работа возможна только при условии, что данные были вставлены через таблицу типа Distributed, т.е. данные распределены в соответствии с sharding_key).
:::


## optimize_empty_string_comparisons {#optimize_empty_string_comparisons}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Преобразует выражения вида col = '' или '' = col в empty(col), а col != '' или '' != col в notEmpty(col),
только когда col имеет тип String или FixedString.


## optimize_extract_common_expressions {#optimize_extract_common_expressions}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.1" },
        { label: "1" },
        {
          label:
            "Оптимизация выражений WHERE, PREWHERE, ON, HAVING и QUALIFY путём извлечения общих выражений из дизъюнкции конъюнкций."
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.12" },
        { label: "0" },
        {
          label:
            "Введена настройка для оптимизации выражений WHERE, PREWHERE, ON, HAVING и QUALIFY путём извлечения общих выражений из дизъюнкции конъюнкций."
        }
      ]
    }
  ]}
/>

Позволяет извлекать общие выражения из дизъюнкций в выражениях WHERE, PREWHERE, ON, HAVING и QUALIFY. Логическое выражение вида `(A AND B) OR (A AND C)` может быть преобразовано в `A AND (B OR C)`, что позволяет использовать:

- индексы в простых выражениях фильтрации
- оптимизацию перекрёстного соединения во внутреннее соединение


## optimize_functions_to_subcolumns {#optimize_functions_to_subcolumns}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.8" },
        { label: "1" },
        { label: "Настройка включена по умолчанию" }
      ]
    }
  ]}
/>

Включает или отключает оптимизацию путём преобразования некоторых функций для чтения подстолбцов. Это сокращает объём считываемых данных.

Могут быть преобразованы следующие функции:

- [length](/sql-reference/functions/array-functions#length) для чтения подстолбца [size0](../../sql-reference/data-types/array.md/#array-size).
- [empty](/sql-reference/functions/array-functions#empty) для чтения подстолбца [size0](../../sql-reference/data-types/array.md/#array-size).
- [notEmpty](/sql-reference/functions/array-functions#notEmpty) для чтения подстолбца [size0](../../sql-reference/data-types/array.md/#array-size).
- [isNull](/sql-reference/functions/functions-for-nulls#isNull) для чтения подстолбца [null](../../sql-reference/data-types/nullable.md/#finding-null).
- [isNotNull](/sql-reference/functions/functions-for-nulls#isNotNull) для чтения подстолбца [null](../../sql-reference/data-types/nullable.md/#finding-null).
- [count](/sql-reference/aggregate-functions/reference/count) для чтения подстолбца [null](../../sql-reference/data-types/nullable.md/#finding-null).
- [mapKeys](/sql-reference/functions/tuple-map-functions#mapkeys) для чтения подстолбца [keys](/sql-reference/data-types/map#reading-subcolumns-of-map).
- [mapValues](/sql-reference/functions/tuple-map-functions#mapvalues) для чтения подстолбца [values](/sql-reference/data-types/map#reading-subcolumns-of-map).

Возможные значения:

- 0 — оптимизация отключена.
- 1 — оптимизация включена.


## optimize_group_by_constant_keys {#optimize_group_by_constant_keys}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.9" },
        { label: "1" },
        { label: "Оптимизация группировки по константным ключам по умолчанию" }
      ]
    }
  ]}
/>

Оптимизация GROUP BY, когда все ключи в блоке являются константами


## optimize_group_by_function_keys {#optimize_group_by_function_keys}

<SettingsInfoBlock type='Bool' default_value='1' />

Исключает функции других ключей в секции GROUP BY


## optimize_if_chain_to_multiif {#optimize_if_chain_to_multiif}

<SettingsInfoBlock type='Bool' default_value='0' />

Заменяет цепочки вида if(cond1, then1, if(cond2, ...)) на multiIf. В настоящее время не дает преимуществ для числовых типов.


## optimize_if_transform_strings_to_enum {#optimize_if_transform_strings_to_enum}

<SettingsInfoBlock type='Bool' default_value='0' />

Заменяет строковые аргументы в функциях If и Transform на тип enum. По умолчанию отключено, так как это может привести к несогласованным изменениям в распределённом запросе и вызвать его сбой.


## optimize_injective_functions_in_group_by {#optimize_injective_functions_in_group_by}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.1" },
        { label: "1" },
        {
          label:
            "Замена инъективных функций на их аргументы в секции GROUP BY в анализаторе"
        }
      ]
    }
  ]}
/>

Заменяет инъективные функции на их аргументы в секции GROUP BY


## optimize_injective_functions_inside_uniq {#optimize_injective_functions_inside_uniq}

<SettingsInfoBlock type='Bool' default_value='1' />

Удаляет инъективные функции с одним аргументом внутри функций uniq\*().


## optimize_min_equality_disjunction_chain_length {#optimize_min_equality_disjunction_chain_length}

<SettingsInfoBlock type='UInt64' default_value='3' />

Минимальная длина выражения `expr = x1 OR ... expr = xN` для оптимизации


## optimize_min_inequality_conjunction_chain_length {#optimize_min_inequality_conjunction_chain_length}

<SettingsInfoBlock type='UInt64' default_value='3' />

Минимальная длина выражения `expr <> x1 AND ... expr <> xN` для оптимизаци


## optimize_move_to_prewhere {#optimize_move_to_prewhere}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает автоматическую оптимизацию [PREWHERE](../../sql-reference/statements/select/prewhere.md) в запросах [SELECT](../../sql-reference/statements/select/index.md).

Работает только для таблиц семейства [\*MergeTree](../../engines/table-engines/mergetree-family/index.md).

Возможные значения:

- 0 — автоматическая оптимизация `PREWHERE` отключена.
- 1 — автоматическая оптимизация `PREWHERE` включена.


## optimize_move_to_prewhere_if_final {#optimize_move_to_prewhere_if_final}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает автоматическую оптимизацию [PREWHERE](../../sql-reference/statements/select/prewhere.md) в запросах [SELECT](../../sql-reference/statements/select/index.md) с модификатором [FINAL](/sql-reference/statements/select/from#final-modifier).

Работает только для таблиц семейства [\*MergeTree](../../engines/table-engines/mergetree-family/index.md).

Возможные значения:

- 0 — автоматическая оптимизация `PREWHERE` в запросах `SELECT` с модификатором `FINAL` отключена.
- 1 — автоматическая оптимизация `PREWHERE` в запросах `SELECT` с модификатором `FINAL` включена.

**См. также**

- настройка [optimize_move_to_prewhere](#optimize_move_to_prewhere)


## optimize_multiif_to_if {#optimize_multiif_to_if}

<SettingsInfoBlock type='Bool' default_value='1' />

Заменяет 'multiIf' с одним условием на 'if'.


## optimize_normalize_count_variants {#optimize_normalize_count_variants}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "21.3" },
        { label: "1" },
        {
          label:
            "Преобразовывать агрегатные функции, семантически эквивалентные count(), в count() по умолчанию"
        }
      ]
    }
  ]}
/>

Преобразовывать агрегатные функции, семантически эквивалентные count(), в count().


## optimize_on_insert {#optimize_on_insert}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "21.1" },
        { label: "1" },
        {
          label:
            "Включение оптимизации данных при INSERT по умолчанию для улучшения пользовательского опыта"
        }
      ]
    }
  ]}
/>

Включает или отключает преобразование данных перед вставкой, как если бы для этого блока было выполнено слияние (в соответствии с движком таблицы).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

**Пример**

Разница между включенным и отключенным режимом:

Запрос:

```sql
SET optimize_on_insert = 1;

CREATE TABLE test1 (`FirstTable` UInt32) ENGINE = ReplacingMergeTree ORDER BY FirstTable;

INSERT INTO test1 SELECT number % 2 FROM numbers(5);

SELECT * FROM test1;

SET optimize_on_insert = 0;

CREATE TABLE test2 (`SecondTable` UInt32) ENGINE = ReplacingMergeTree ORDER BY SecondTable;

INSERT INTO test2 SELECT number % 2 FROM numbers(5);

SELECT * FROM test2;
```

Результат:

```text
┌─FirstTable─┐
│          0 │
│          1 │
└────────────┘

┌─SecondTable─┐
│           0 │
│           0 │
│           0 │
│           1 │
│           1 │
└─────────────┘
```

Обратите внимание, что эта настройка влияет на поведение [материализованных представлений](/sql-reference/statements/create/view#materialized-view).


## optimize_or_like_chain {#optimize_or_like_chain}

<SettingsInfoBlock type='Bool' default_value='0' />

Оптимизирует множественные условия OR LIKE в multiMatchAny. Эта оптимизация не должна быть включена по умолчанию, так как в некоторых случаях она мешает анализу индексов.


## optimize_qbit_distance_function_reads {#optimize_qbit_distance_function_reads}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Заменяет функции расстояния для типа данных `QBit` эквивалентными функциями, которые читают из хранилища только столбцы, необходимые для вычислений.


## optimize_read_in_order {#optimize_read_in_order}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает оптимизацию [ORDER BY](/sql-reference/statements/select/order-by#optimization-of-data-reading) в запросах [SELECT](../../sql-reference/statements/select/index.md) для чтения данных из таблиц [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).

Возможные значения:

- 0 — оптимизация `ORDER BY` отключена.
- 1 — оптимизация `ORDER BY` включена.

**См. также**

- [Секция ORDER BY](/sql-reference/statements/select/order-by#optimization-of-data-reading)


## optimize_read_in_window_order {#optimize_read_in_window_order}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает оптимизацию ORDER BY в оконном выражении для чтения данных в соответствующем порядке из таблиц семейства MergeTree.


## optimize_redundant_functions_in_order_by {#optimize_redundant_functions_in_order_by}

<SettingsInfoBlock type='Bool' default_value='1' />

Удаляет функции из ORDER BY, если их аргумент также присутствует в ORDER BY


## optimize_respect_aliases {#optimize_respect_aliases}

<SettingsInfoBlock type='Bool' default_value='1' />

Если установлено значение true, псевдонимы в WHERE/GROUP BY/ORDER BY будут учитываться, что способствует отсечению партиций/работе вторичных индексов/optimize_aggregation_in_order/optimize_read_in_order/optimize_trivial_count


## optimize_rewrite_aggregate_function_with_if {#optimize_rewrite_aggregate_function_with_if}

<SettingsInfoBlock type='Bool' default_value='1' />

Переписывает агрегатные функции с выражением if в качестве аргумента, если это логически эквивалентно.
Например, `avg(if(cond, col, null))` можно переписать как `avgOrNullIf(cond, col)`. Это может повысить производительность.

:::note
Поддерживается только при использовании анализатора (`enable_analyzer = 1`).
:::


## optimize_rewrite_array_exists_to_has {#optimize_rewrite_array_exists_to_has}

<SettingsInfoBlock type='Bool' default_value='0' />

Преобразует функции arrayExists() в has(), когда они логически эквивалентны. Например, arrayExists(x -> x = 1, arr) можно преобразовать в has(arr, 1)


## optimize_rewrite_like_perfect_affix {#optimize_rewrite_like_perfect_affix}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Преобразует выражения LIKE с точным префиксом или суффиксом (например, `col LIKE 'ClickHouse%'`) в функции startsWith или endsWith (например, `startsWith(col, 'ClickHouse')`).


## optimize_rewrite_regexp_functions {#optimize_rewrite_regexp_functions}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Преобразует функции для работы с регулярными выражениями в более простые и эффективные формы


## optimize_rewrite_sum_if_to_count_if {#optimize_rewrite_sum_if_to_count_if}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.4" },
        { label: "1" },
        { label: "Доступно только для анализатора, где функция работает корректно" }
      ]
    }
  ]}
/>

Преобразует функции sumIf() и sum(if()) в функцию countIf(), когда они логически эквивалентны


## optimize_skip_merged_partitions {#optimize_skip_merged_partitions}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает оптимизацию для запроса [OPTIMIZE TABLE ... FINAL](../../sql-reference/statements/optimize.md), если существует только один парт с уровнем > 0 и у него нет истёкшего TTL.

- `OPTIMIZE TABLE ... FINAL SETTINGS optimize_skip_merged_partitions=1`

По умолчанию запрос `OPTIMIZE TABLE ... FINAL` перезаписывает единственный парт, даже если он один.

Возможные значения:

- 1 — включить оптимизацию.
- 0 — отключить оптимизацию.


## optimize_skip_unused_shards {#optimize_skip_unused_shards}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает пропуск неиспользуемых шардов для запросов [SELECT](../../sql-reference/statements/select/index.md), содержащих условие по ключу шардирования в `WHERE/PREWHERE` (при условии, что данные распределены по ключу шардирования; в противном случае запрос вернёт некорректный результат).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.


## optimize_skip_unused_shards_limit {#optimize_skip_unused_shards_limit}

<SettingsInfoBlock type='UInt64' default_value='1000' />

Ограничение на количество значений ключа шардирования. Отключает `optimize_skip_unused_shards` при достижении лимита.

Слишком большое количество значений может потребовать значительных ресурсов для обработки, при этом польза сомнительна, поскольку при наличии большого количества значений в `IN (...)` запрос, скорее всего, всё равно будет отправлен на все шарды.


## optimize_skip_unused_shards_nesting {#optimize_skip_unused_shards_nesting}

<SettingsInfoBlock type='UInt64' default_value='0' />

Управляет настройкой [`optimize_skip_unused_shards`](#optimize_skip_unused_shards) (для работы по-прежнему требуется включённая [`optimize_skip_unused_shards`](#optimize_skip_unused_shards)) в зависимости от уровня вложенности распределённого запроса (когда таблица `Distributed` обращается к другой таблице `Distributed`).

Возможные значения:

- 0 — Отключено, `optimize_skip_unused_shards` работает всегда.
- 1 — Включает `optimize_skip_unused_shards` только для первого уровня.
- 2 — Включает `optimize_skip_unused_shards` до второго уровня включительно.


## optimize_skip_unused_shards_rewrite_in {#optimize_skip_unused_shards_rewrite_in}

<SettingsInfoBlock type='Bool' default_value='1' />

Переписывает условие IN в запросе для удалённых шардов, исключая значения, не относящиеся к данному шарду (требует включения optimize_skip_unused_shards).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.


## optimize_sorting_by_input_stream_properties {#optimize_sorting_by_input_stream_properties}

<SettingsInfoBlock type='Bool' default_value='1' />

Оптимизировать сортировку на основе свойств сортировки входного потока


## optimize_substitute_columns {#optimize_substitute_columns}

<SettingsInfoBlock type='Bool' default_value='0' />

Использовать [ограничения](../../sql-reference/statements/create/table.md/#constraints) для подстановки столбцов. Значение по умолчанию — `false`.

Возможные значения:

- true, false


## optimize_syntax_fuse_functions {#optimize_syntax_fuse_functions}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает объединение агрегатных функций с одинаковыми аргументами. Переписывает запросы, содержащие как минимум две агрегатные функции из [sum](/sql-reference/aggregate-functions/reference/sum), [count](/sql-reference/aggregate-functions/reference/count) или [avg](/sql-reference/aggregate-functions/reference/avg) с одинаковыми аргументами, в [sumCount](/sql-reference/aggregate-functions/reference/sumcount).

Возможные значения:

- 0 — Функции с одинаковыми аргументами не объединяются.
- 1 — Функции с одинаковыми аргументами объединяются.

**Пример**

Запрос:

```sql
CREATE TABLE fuse_tbl(a Int8, b Int8) Engine = Log;
SET optimize_syntax_fuse_functions = 1;
EXPLAIN SYNTAX SELECT sum(a), sum(b), count(b), avg(b) from fuse_tbl FORMAT TSV;
```

Результат:

```text
SELECT
    sum(a),
    sumCount(b).1,
    sumCount(b).2,
    (sumCount(b).1) / (sumCount(b).2)
FROM fuse_tbl
```


## optimize_throw_if_noop {#optimize_throw_if_noop}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает генерацию исключения, если запрос [OPTIMIZE](../../sql-reference/statements/optimize.md) не выполнил слияние.

По умолчанию `OPTIMIZE` завершается успешно, даже если не было выполнено никаких действий. Эта настройка позволяет различать такие ситуации и получать информацию о причине в сообщении об исключении.

Возможные значения:

- 1 — генерация исключения включена.
- 0 — генерация исключения отключена.


## optimize_time_filter_with_preimage {#optimize_time_filter_with_preimage}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "1" },
        {
          label:
            "Оптимизирует предикаты Date и DateTime, преобразуя функции в эквивалентные сравнения без преобразований (например, toYear(col) = 2023 -> col >= '2023-01-01' AND col <= '2023-12-31')"
        }
      ]
    }
  ]}
/>

Optimize Date and DateTime predicates by converting functions into equivalent comparisons without conversions (e.g. `toYear(col) = 2023 -> col >= '2023-01-01' AND col <= '2023-12-31'`)


## optimize_trivial_approximate_count_query {#optimize_trivial_approximate_count_query}

<SettingsInfoBlock type='Bool' default_value='0' />

Использовать приблизительное значение для оптимизации тривиальных запросов подсчёта в движках хранения, поддерживающих такую оценку, например, EmbeddedRocksDB.

Возможные значения:

- 0 — Оптимизация отключена.
- 1 — Оптимизация включена.


## optimize_trivial_count_query {#optimize_trivial_count_query}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает оптимизацию простого запроса `SELECT count() FROM table` с использованием метаданных MergeTree. Если требуется использовать защиту на уровне строк, отключите эту настройку.

Возможные значения:

- 0 — Оптимизация отключена.
- 1 — Оптимизация включена.

См. также:

- [optimize_functions_to_subcolumns](#optimize_functions_to_subcolumns)


## optimize_trivial_insert_select {#optimize_trivial_insert_select}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "0" },
        { label: "Оптимизация не имеет смысла во многих случаях." }
      ]
    }
  ]}
/>

Оптимизация тривиальных запросов вида 'INSERT INTO table SELECT ... FROM TABLES'


## optimize_uniq_to_count {#optimize_uniq_to_count}

<SettingsInfoBlock type='Bool' default_value='1' />

Переписывает `uniq` и его варианты (за исключением `uniqUpTo`) в `count`, если подзапрос содержит `DISTINCT` или `GROUP BY`.


## optimize_use_implicit_projections {#optimize_use_implicit_projections}

<SettingsInfoBlock type='Bool' default_value='1' />

Автоматически выбирать неявные проекции для выполнения SELECT-запросов


## optimize_use_projection_filtering {#optimize_use_projection_filtering}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.6" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Включает использование проекций для фильтрации диапазонов кусков данных, даже если проекции не выбраны для выполнения SELECT-запроса.


## optimize_use_projections {#optimize_use_projections}

**Псевдонимы**: `allow_experimental_projection_optimization`

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает оптимизацию [проекций](../../engines/table-engines/mergetree-family/mergetree.md/#projections) при обработке запросов `SELECT`.

Возможные значения:

- 0 — оптимизация проекций отключена.
- 1 — оптимизация проекций включена.


## optimize_using_constraints {#optimize_using_constraints}

<SettingsInfoBlock type='Bool' default_value='0' />

Использовать [ограничения](../../sql-reference/statements/create/table.md/#constraints) для оптимизации запросов. Значение по умолчанию — `false`.

Возможные значения:

- true, false


## os_threads_nice_value_materialized_view {#os_threads_nice_value_materialized_view}

<SettingsInfoBlock type='Int32' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Значение nice в Linux для потоков материализованных представлений. Меньшие значения означают более высокий приоритет процессора.

Требуется capability CAP_SYS_NICE, в противном случае операция не выполняется.

Возможные значения: от -20 до 19.


## os_threads_nice_value_query {#os_threads_nice_value_query}

**Псевдонимы**: `os_thread_priority`

<SettingsInfoBlock type='Int32' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Значение nice в Linux для потоков обработки запросов. Меньшие значения означают более высокий приоритет процессора.

Требуется capability CAP_SYS_NICE, в противном случае не выполняет никаких действий.

Возможные значения: от -20 до 19.


## output_format_compression_level {#output_format_compression_level}

<SettingsInfoBlock type='UInt64' default_value='3' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.1" },
        { label: "3" },
        { label: "Позволяет изменить уровень сжатия в выводе запроса" }
      ]
    }
  ]}
/>

Уровень сжатия по умолчанию для сжатого вывода запроса. Настройка применяется, когда запрос `SELECT` содержит `INTO OUTFILE` или при записи в табличные функции `file`, `url`, `hdfs`, `s3` или `azureBlobStorage`.

Возможные значения: от `1` до `22`


## output_format_compression_zstd_window_log {#output_format_compression_zstd_window_log}

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.1" },
        { label: "0" },
        {
          label:
            "Позволяет изменять логарифм окна zstd в выводе запроса при использовании сжатия zstd"
        }
      ]
    }
  ]}
/>

Может использоваться, когда метод сжатия вывода — `zstd`. Если значение больше `0`, эта настройка явно задаёт размер окна сжатия (степень числа `2`) и включает режим дальнего действия для сжатия zstd. Это может помочь достичь более высокого коэффициента сжатия.

Возможные значения: неотрицательные числа. Обратите внимание, что если значение слишком мало или слишком велико, `zstdlib` выбросит исключение. Типичные значения — от `20` (размер окна = `1MB`) до `30` (размер окна = `1GB`).


## output_format_parallel_formatting {#output_format_parallel_formatting}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает параллельное форматирование данных. Поддерживается только для форматов [TSV](/interfaces/formats/TabSeparated), [TSKV](/interfaces/formats/TSKV), [CSV](/interfaces/formats/CSV) и [JSONEachRow](/interfaces/formats/JSONEachRow).

Возможные значения:

- 1 — Включено.
- 0 — Отключено.


## page_cache_block_size {#page_cache_block_size}

<SettingsInfoBlock type='UInt64' default_value='1048576' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "1048576" },
        { label: "Настройка стала изменяемой на уровне запроса." }
      ]
    }
  ]}
/>

Размер фрагментов файла для хранения в пользовательском кэше страниц, в байтах. Все операции чтения через кэш будут округлены до значения, кратного этому размеру.

Эту настройку можно изменять на уровне отдельного запроса, но записи кэша с разными размерами блоков не могут быть использованы повторно. Изменение этой настройки фактически аннулирует существующие записи в кэше.

Более высокое значение, например 1 МиБ, подходит для запросов с высокой пропускной способностью, а более низкое значение, например 64 КиБ, подходит для точечных запросов с низкой задержкой.


## page_cache_inject_eviction {#page_cache_inject_eviction}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "0" },
        { label: "Добавлен кэш страниц в пространстве пользователя" }
      ]
    }
  ]}
/>

Кэш страниц в пространстве пользователя будет периодически инвалидировать случайные страницы. Предназначено для тестирования.


## page_cache_lookahead_blocks {#page_cache_lookahead_blocks}

<SettingsInfoBlock type='UInt64' default_value='16' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "16" },
        { label: "Настройка стала доступна для изменения на уровне запроса." }
      ]
    }
  ]}
/>

При промахе кэша страниц в пользовательском пространстве из базового хранилища считывается до указанного количества последовательных блоков одновременно, если они также отсутствуют в кэше. Размер каждого блока составляет page_cache_block_size байт.

Более высокое значение подходит для запросов с высокой пропускной способностью, тогда как точечные запросы с низкой задержкой работают лучше без упреждающего чтения.


## parallel_distributed_insert_select {#parallel_distributed_insert_select}

<SettingsInfoBlock type='UInt64' default_value='2' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.7" },
        { label: "2" },
        { label: "Параллельный распределённый INSERT SELECT включён по умолчанию" }
      ]
    }
  ]}
/>

Включает параллельное выполнение распределённого запроса `INSERT ... SELECT`.

Если выполняется запрос `INSERT INTO distributed_table_a SELECT ... FROM distributed_table_b`, и обе таблицы используют один и тот же кластер, и обе таблицы либо [реплицированные](../../engines/table-engines/mergetree-family/replication.md), либо нереплицированные, то такой запрос обрабатывается локально на каждом шарде.

Возможные значения:

- `0` — отключено.
- `1` — `SELECT` выполняется на каждом шарде из базовой таблицы распределённого движка.
- `2` — `SELECT` и `INSERT` выполняются на каждом шарде из/в базовую таблицу распределённого движка.

При использовании этой настройки необходимо установить `enable_parallel_replicas = 1`.


## parallel_hash_join_threshold {#parallel_hash_join_threshold}

<SettingsInfoBlock type='UInt64' default_value='100000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.5" }, { label: "100000" }, { label: "Новая настройка" }]
    },
    {
      id: "row-2",
      items: [{ label: "25.4" }, { label: "0" }, { label: "Новая настройка" }]
    },
    {
      id: "row-3",
      items: [{ label: "25.3" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

При применении алгоритма соединения на основе хеш-таблиц этот порог помогает выбрать между `hash` и `parallel_hash` (только при наличии оценки размера правой таблицы).
Первый вариант используется, когда размер правой таблицы меньше порогового значения.


## parallel_replica_offset {#parallel_replica_offset}

<BetaBadge />

<SettingsInfoBlock type='UInt64' default_value='0' />

Это внутренняя настройка, которую не следует использовать напрямую. Она представляет собой деталь реализации режима параллельных реплик ('parallel replicas'). Данная настройка автоматически устанавливается сервером-инициатором для распределённых запросов и указывает на индекс реплики, участвующей в обработке запроса среди параллельных реплик.


## parallel_replicas_allow_in_with_subquery {#parallel_replicas_allow_in_with_subquery}

<BetaBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "1" },
        {
          label:
            "Если установлено значение true, подзапрос для IN будет выполняться на каждой реплике-последователе"
        }
      ]
    }
  ]}
/>

Если установлено значение true, подзапрос для IN будет выполняться на каждой реплике-последователе.


## parallel_replicas_connect_timeout_ms {#parallel_replicas_connect_timeout_ms}

<BetaBadge />

<SettingsInfoBlock type='Миллисекунды' default_value='300' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "300" },
        { label: "Отдельный таймаут соединения для запросов с параллельными репликами" }
      ]
    }
  ]}
/>

Таймаут в миллисекундах для установки соединения с удалённой репликой при выполнении запроса с параллельными репликами. Если таймаут истекает, соответствующая реплика не используется для выполнения запроса


## parallel_replicas_count {#parallel_replicas_count}

<BetaBadge />

<SettingsInfoBlock type='UInt64' default_value='0' />

Это внутренняя настройка, которую не следует использовать напрямую. Она представляет собой деталь реализации режима параллельных реплик ('parallel replicas'). Данная настройка автоматически устанавливается сервером-инициатором для распределённых запросов и соответствует количеству параллельных реплик, участвующих в обработке запроса.


## parallel_replicas_custom_key {#parallel_replicas_custom_key}

<BetaBadge />

Произвольное целочисленное выражение, которое можно использовать для распределения работы между репликами конкретной таблицы.
Значением может быть любое целочисленное выражение.

Рекомендуется использовать простые выражения на основе первичных ключей.

Если настройка применяется к кластеру, состоящему из одного шарда с несколькими репликами, эти реплики будут преобразованы в виртуальные шарды.
В противном случае поведение будет аналогично ключу `SAMPLE` — будут использоваться несколько реплик каждого шарда.


## parallel_replicas_custom_key_range_lower {#parallel_replicas_custom_key_range_lower}

<BetaBadge />

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        {
          label:
            "Добавлены настройки для управления фильтром диапазона при использовании параллельных реплик с динамическими шардами"
        }
      ]
    }
  ]}
/>

Позволяет фильтру типа `range` равномерно распределять работу между репликами на основе заданного диапазона `[parallel_replicas_custom_key_range_lower, INT_MAX]`.

При совместном использовании с [parallel_replicas_custom_key_range_upper](#parallel_replicas_custom_key_range_upper) позволяет фильтру равномерно распределять работу между репликами для диапазона `[parallel_replicas_custom_key_range_lower, parallel_replicas_custom_key_range_upper]`.

Примечание: данная настройка не приводит к фильтрации дополнительных данных при обработке запроса, а изменяет точки, в которых фильтр диапазона разбивает диапазон `[0, INT_MAX]` для параллельной обработки.


## parallel_replicas_custom_key_range_upper {#parallel_replicas_custom_key_range_upper}

<BetaBadge />

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        {
          label:
            "Добавлены настройки для управления фильтром диапазона при использовании параллельных реплик с динамическими шардами. Значение 0 отключает верхнее ограничение"
        }
      ]
    }
  ]}
/>

Позволяет фильтру типа `range` равномерно распределять работу между репликами на основе пользовательского диапазона `[0, parallel_replicas_custom_key_range_upper]`. Значение 0 отключает верхнюю границу, устанавливая её равной максимальному значению выражения пользовательского ключа.

При использовании совместно с [parallel_replicas_custom_key_range_lower](#parallel_replicas_custom_key_range_lower) позволяет фильтру равномерно распределять работу между репликами для диапазона `[parallel_replicas_custom_key_range_lower, parallel_replicas_custom_key_range_upper]`.

Примечание: эта настройка не приводит к фильтрации дополнительных данных во время обработки запроса, а изменяет точки, в которых фильтр диапазона разбивает диапазон `[0, INT_MAX]` для параллельной обработки.


## parallel_replicas_for_cluster_engines {#parallel_replicas_for_cluster_engines}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.3" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Заменяет движки табличных функций на их альтернативы с суффиксом -Cluster


## parallel_replicas_for_non_replicated_merge_tree {#parallel_replicas_for_non_replicated_merge_tree}

<BetaBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

Если значение true, ClickHouse будет использовать алгоритм параллельных реплик также для нереплицируемых таблиц MergeTree


## parallel_replicas_index_analysis_only_on_coordinator {#parallel_replicas_index_analysis_only_on_coordinator}

<BetaBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.12" },
        { label: "1" },
        {
          label:
            "Анализ индексов выполняется только на реплике-координаторе и пропускается на остальных репликах. Эффективен только при включённой настройке parallel_replicas_local_plan"
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.10" },
        { label: "1" },
        {
          label:
            "Анализ индексов выполняется только на реплике-координаторе и пропускается на остальных репликах. Эффективен только при включённой настройке parallel_replicas_local_plan"
        }
      ]
    }
  ]}
/>

Index analysis done only on replica-coordinator and skipped on other replicas. Effective only with enabled parallel_replicas_local_pla


## parallel_replicas_insert_select_local_pipeline {#parallel_replicas_insert_select_local_pipeline}

<BetaBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "1" },
        {
          label:
            "Использовать локальный конвейер при распределённом INSERT SELECT с параллельными репликами. В настоящее время отключено из-за проблем с производительностью"
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "25.4" },
        { label: "0" },
        {
          label:
            "Использовать локальный конвейер при распределённом INSERT SELECT с параллельными репликами. В настоящее время отключено из-за проблем с производительностью"
        }
      ]
    }
  ]}
/>

Использовать локальный конвейер при распределённом INSERT SELECT с параллельными репликами


## parallel_replicas_local_plan {#parallel_replicas_local_plan}

<BetaBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.9" },
        { label: "0" },
        {
          label:
            "Использование локального плана для локальной реплики в запросах с параллельными репликами"
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.11" },
        { label: "1" },
        {
          label:
            "Использование локального плана для локальной реплики в запросах с параллельными репликами"
        }
      ]
    },
    {
      id: "row-3",
      items: [
        { label: "24.10" },
        { label: "1" },
        {
          label:
            "Использование локального плана для локальной реплики в запросах с параллельными репликами"
        }
      ]
    }
  ]}
/>

Построение локального плана для локальной реплики


## parallel_replicas_mark_segment_size {#parallel_replicas_mark_segment_size}

<BetaBadge />

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.9" },
        { label: "0" },
        { label: "Значение этой настройки теперь определяется автоматически" }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.1" },
        { label: "128" },
        {
          label:
            "Добавлена новая настройка для управления размером сегмента в новой реализации координатора параллельных реплик"
        }
      ]
    }
  ]}
/>

Части виртуально разделяются на сегменты для распределения между репликами при параллельном чтении. Эта настройка управляет размером этих сегментов. Не рекомендуется изменять, пока вы не будете полностью уверены в том, что делаете. Значение должно находиться в диапазоне [128; 16384]


## parallel_replicas_min_number_of_rows_per_replica {#parallel_replicas_min_number_of_rows_per_replica}

<BetaBadge />

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничивает количество реплик, используемых в запросе, значением (предполагаемое количество строк для чтения / min_number_of_rows_per_replica). Максимум по-прежнему ограничен параметром 'max_parallel_replicas'


## parallel_replicas_mode {#parallel_replicas_mode}

<BetaBadge />

<SettingsInfoBlock type='ParallelReplicasMode' default_value='read_tasks' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "read_tasks" },
        {
          label:
            "Настройка добавлена в рамках перевода функции параллельных реплик в статус Beta"
        }
      ]
    }
  ]}
/>

Тип фильтра, используемого с пользовательским ключом для параллельных реплик. default — использовать операцию взятия остатка от деления по пользовательскому ключу, range — использовать диапазонный фильтр по пользовательскому ключу, применяя все возможные значения для типа данных пользовательского ключа.


## parallel_replicas_only_with_analyzer {#parallel_replicas_only_with_analyzer}

<BetaBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.2" },
        { label: "1" },
        { label: "Параллельные реплики поддерживаются только при включенном анализаторе" }
      ]
    }
  ]}
/>

Для использования параллельных реплик необходимо включить анализатор. При отключенном анализаторе выполнение запроса переключается на локальное выполнение, даже если включено параллельное чтение из реплик. Использование параллельных реплик без включенного анализатора не поддерживается


## parallel_replicas_prefer_local_join {#parallel_replicas_prefer_local_join}

<BetaBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "1" },
        {
          label:
            "Если значение true, и JOIN может быть выполнено с использованием алгоритма параллельных реплик, и все хранилища правой части JOIN относятся к семейству *MergeTree, будет использоваться локальное соединение (local JOIN) вместо глобального (GLOBAL JOIN)."
        }
      ]
    }
  ]}
/>

If true, and JOIN can be executed with parallel replicas algorithm, and all storages of right JOIN part are \*MergeTree, local JOIN will be used instead of GLOBAL JOIN.


## parallel_replicas_support_projection {#parallel_replicas_support_projection}

<BetaBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.8" },
        { label: "1" },
        {
          label:
            "Новая настройка. Оптимизация проекций может применяться при использовании параллельных реплик. Действует только при включенной настройке parallel_replicas_local_plan и отключенной aggregation_in_order."
        }
      ]
    }
  ]}
/>

Оптимизация проекций может применяться при использовании параллельных реплик. Действует только при включенной настройке parallel_replicas_local_plan и отключенной aggregation_in_order.


## parallel_view_processing {#parallel_view_processing}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает параллельную отправку данных в присоединённые представления вместо последовательной отправки.


## parallelize_output_from_storages {#parallelize_output_from_storages}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.5" },
        { label: "1" },
        {
          label:
            "Разрешает параллелизм при выполнении запросов, которые читают из file/url/s3/и т. д. Это может изменить порядок строк."
        }
      ]
    }
  ]}
/>

Параллелизация вывода на этапе чтения из хранилища. Позволяет распараллелить обработку запроса сразу после чтения из хранилища, если это возможно


## parsedatetime_e_requires_space_padding {#parsedatetime_e_requires_space_padding}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "0" },
        { label: "Улучшена совместимость с MySQL DATE_FORMAT/STR_TO_DATE" }
      ]
    }
  ]}
/>

Спецификатор формата '%e' в функции 'parseDateTime' требует, чтобы однозначные дни дополнялись пробелом слева, например, ' 2' допустимо, а '2' вызывает ошибку.


## parsedatetime_parse_without_leading_zeros {#parsedatetime_parse_without_leading_zeros}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.11" },
        { label: "1" },
        { label: "Улучшена совместимость с MySQL DATE_FORMAT/STR_TO_DATE" }
      ]
    }
  ]}
/>

Спецификаторы формата '%c', '%l' и '%k' в функции 'parseDateTime' обрабатывают месяцы и часы без ведущих нулей.


## partial_merge_join_left_table_buffer_bytes {#partial_merge_join_left_table_buffer_bytes}

<SettingsInfoBlock type='UInt64' default_value='0' />

Если значение не равно 0, группирует блоки левой таблицы в более крупные блоки при частичном соединении слиянием. Использует до двукратного указанного объёма памяти на каждый поток соединения.


## partial_merge_join_rows_in_right_blocks {#partial_merge_join_rows_in_right_blocks}

<SettingsInfoBlock type='UInt64' default_value='65536' />

Ограничивает размер блоков данных правой таблицы в алгоритме частичного слияния соединений для запросов [JOIN](../../sql-reference/statements/select/join.md).

Сервер ClickHouse:

1.  Разбивает данные правой таблицы на блоки с указанным максимальным количеством строк.
2.  Индексирует каждый блок по его минимальным и максимальным значениям.
3.  Выгружает подготовленные блоки на диск при возможности.

Возможные значения:

- Любое положительное целое число. Рекомендуемый диапазон значений: \[1000, 100000\].


## partial_result_on_first_cancel {#partial_result_on_first_cancel}

<SettingsInfoBlock type='Bool' default_value='0' />

Позволяет запросу возвращать частичный результат после отмены.


## parts_to_delay_insert {#parts_to_delay_insert}

<SettingsInfoBlock type='UInt64' default_value='0' />

Если целевая таблица содержит как минимум указанное количество активных кусков в одной партиции, вставка в таблицу искусственно замедляется.


## parts_to_throw_insert {#parts_to_throw_insert}

<SettingsInfoBlock type='UInt64' default_value='0' />

Если количество активных частей в одной партиции целевой таблицы превышает это значение, генерируется исключение 'Too many parts ...'.


## per_part_index_stats {#per_part_index_stats}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

        Записывает статистику индексов для каждой части


## poll_interval {#poll_interval}

<SettingsInfoBlock type='UInt64' default_value='10' />

Блокировать в цикле ожидания запроса на сервере на указанное количество секунд.


## postgresql_connection_attempt_timeout {#postgresql_connection_attempt_timeout}

<SettingsInfoBlock type='UInt64' default_value='2' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "2" },
        {
          label:
            "Позволяет управлять параметром 'connect_timeout' соединения с PostgreSQL."
        }
      ]
    }
  ]}
/>

Время ожидания подключения в секундах для одной попытки соединения с конечной точкой PostgreSQL.
Значение передается как параметр `connect_timeout` URL-адреса подключения.


## postgresql_connection_pool_auto_close_connection {#postgresql_connection_pool_auto_close_connection}

<SettingsInfoBlock type='Bool' default_value='0' />

Закрывать соединение перед возвратом в пул.


## postgresql_connection_pool_retries {#postgresql_connection_pool_retries}

<SettingsInfoBlock type='UInt64' default_value='2' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "2" },
        {
          label:
            "Позволяет управлять количеством повторных попыток в пуле соединений PostgreSQL."
        }
      ]
    }
  ]}
/>

Количество повторных попыток добавления/извлечения соединений из пула для табличного движка PostgreSQL и движка базы данных.


## postgresql_connection_pool_size {#postgresql_connection_pool_size}

<SettingsInfoBlock type='UInt64' default_value='16' />

Размер пула соединений для табличного движка PostgreSQL и движка базы данных.


## postgresql_connection_pool_wait_timeout {#postgresql_connection_pool_wait_timeout}

<SettingsInfoBlock type='UInt64' default_value='5000' />

Тайм-аут ожидания при получении/возврате соединения из пустого пула для движка таблиц PostgreSQL и движка баз данных. По умолчанию операция блокируется при пустом пуле.


## postgresql_fault_injection_probability {#postgresql_fault_injection_probability}

<SettingsInfoBlock type='Float' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.2" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Приблизительная вероятность отказа внутренних запросов PostgreSQL (для репликации). Допустимое значение находится в интервале [0.0f, 1.0f]


## prefer_column_name_to_alias {#prefer_column_name_to_alias}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает использование исходных имён столбцов вместо псевдонимов в выражениях и предложениях запроса. Это особенно важно, когда псевдоним совпадает с именем столбца, см. [Псевдонимы выражений](/sql-reference/syntax#notes-on-usage). Включите эту настройку, чтобы правила синтаксиса псевдонимов в ClickHouse были более совместимы с большинством других СУБД.

Возможные значения:

- 0 — Имя столбца заменяется псевдонимом.
- 1 — Имя столбца не заменяется псевдонимом.

**Пример**

Разница между включённым и отключённым состоянием:

Запрос:

```sql
SET prefer_column_name_to_alias = 0;
SELECT avg(number) AS number, max(number) FROM numbers(10);
```

Результат:

```text
Received exception from server (version 21.5.1):
Code: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function avg(number) is found inside another aggregate function in query: While processing avg(number) AS number.
```

Запрос:

```sql
SET prefer_column_name_to_alias = 1;
SELECT avg(number) AS number, max(number) FROM numbers(10);
```

Результат:

```text
┌─number─┬─max(number)─┐
│    4.5 │           9 │
└────────┴─────────────┘
```


## prefer_external_sort_block_bytes {#prefer_external_sort_block_bytes}

<SettingsInfoBlock type='UInt64' default_value='16744704' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.5" },
        { label: "16744704" },
        {
          label:
            "Предпочтительный максимальный размер блока в байтах для внешней сортировки, уменьшает использование памяти при слиянии."
        }
      ]
    }
  ]}
/>

Предпочтительный максимальный размер блока в байтах для внешней сортировки, уменьшает использование памяти при слиянии.


## prefer_global_in_and_join {#prefer_global_in_and_join}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает замену операторов `IN`/`JOIN` на `GLOBAL IN`/`GLOBAL JOIN`.

Возможные значения:

- 0 — Отключено. Операторы `IN`/`JOIN` не заменяются на `GLOBAL IN`/`GLOBAL JOIN`.
- 1 — Включено. Операторы `IN`/`JOIN` заменяются на `GLOBAL IN`/`GLOBAL JOIN`.

**Использование**

Хотя `SET distributed_product_mode=global` может изменить поведение запросов для распределённых таблиц, эта настройка не подходит для локальных таблиц или таблиц из внешних источников. Именно в таких случаях используется настройка `prefer_global_in_and_join`.

Например, имеются узлы обработки запросов, содержащие локальные таблицы, которые не предназначены для распределения. Необходимо распределить их данные на лету во время распределённой обработки с помощью ключевого слова `GLOBAL` — `GLOBAL IN`/`GLOBAL JOIN`.

Другой вариант использования `prefer_global_in_and_join` — доступ к таблицам, созданным внешними движками. Эта настройка помогает сократить количество обращений к внешним источникам при объединении таких таблиц: только одно обращение на запрос.

**См. также:**

- [Распределённые подзапросы](/sql-reference/operators/in#distributed-subqueries) — дополнительная информация об использовании `GLOBAL IN`/`GLOBAL JOIN`


## prefer_localhost_replica {#prefer_localhost_replica}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает/отключает предпочтительное использование локальной реплики при обработке распределённых запросов.

Возможные значения:

- 1 — ClickHouse всегда отправляет запрос на локальную реплику, если она существует.
- 0 — ClickHouse использует стратегию балансировки, заданную настройкой [load_balancing](#load_balancing).

:::note
Отключите эту настройку, если используете [max_parallel_replicas](#max_parallel_replicas) без [parallel_replicas_custom_key](#parallel_replicas_custom_key).
Если параметр [parallel_replicas_custom_key](#parallel_replicas_custom_key) задан, отключайте эту настройку только при использовании в кластере с несколькими шардами, содержащими несколько реплик.
При использовании в кластере с одним шардом и несколькими репликами отключение этой настройки приведёт к негативным последствиям.
:::


## prefer_warmed_unmerged_parts_seconds {#prefer_warmed_unmerged_parts_seconds}

<CloudOnlyBadge />

<SettingsInfoBlock type='Int64' default_value='0' />

Действует только в ClickHouse Cloud. Если объединённый кусок данных создан менее указанного количества секунд назад и не был предварительно прогрет (см. [cache_populated_by_fetch](merge-tree-settings.md/#cache_populated_by_fetch)), но все его исходные куски доступны и прогреты, запросы SELECT будут читать данные из этих исходных кусков. Применяется только для движков Replicated-/SharedMergeTree. Обратите внимание, что проверяется только факт обработки куска компонентом CacheWarmer; если кусок был загружен в кэш другим способом, он будет считаться холодным до обработки CacheWarmer; если он был прогрет, а затем вытеснен из кэша, он всё равно будет считаться тёплым.


## preferred_block_size_bytes {#preferred_block_size_bytes}

<SettingsInfoBlock type='UInt64' default_value='1000000' />

Эта настройка регулирует размер блока данных для обработки запросов и представляет собой дополнительную тонкую настройку по отношению к более грубой настройке 'max_block_size'. Если столбцы имеют большой размер и при 'max_block_size' строках размер блока может превысить указанное количество байтов, он будет уменьшен для улучшения локальности кэша процессора.


## preferred_max_column_in_block_size_bytes {#preferred_max_column_in_block_size_bytes}

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничение максимального размера столбца в блоке при чтении. Помогает снизить количество промахов кэша. Значение должно быть близко к размеру кэша L2.


## preferred_optimize_projection_name {#preferred_optimize_projection_name}

Если задана непустая строка, ClickHouse попытается применить указанную проекцию в запросе.

Возможные значения:

- string: имя предпочтительной проекции


## prefetch_buffer_size {#prefetch_buffer_size}

<SettingsInfoBlock type='UInt64' default_value='1048576' />

Максимальный размер буфера упреждающей загрузки для чтения из файловой системы.


## print_pretty_type_names {#print_pretty_type_names}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.1" },
        { label: "1" },
        { label: "Улучшен пользовательский опыт." }
      ]
    }
  ]}
/>

Позволяет выводить глубоко вложенные имена типов в удобочитаемом виде с отступами в запросе `DESCRIBE` и в функции `toTypeName()`.

Пример:

```sql
CREATE TABLE test (a Tuple(b String, c Tuple(d Nullable(UInt64), e Array(UInt32), f Array(Tuple(g String, h Map(String, Array(Tuple(i String, j UInt64))))), k Date), l Nullable(String))) ENGINE=Memory;
DESCRIBE TABLE test FORMAT TSVRaw SETTINGS print_pretty_type_names=1;
```

```
a   Tuple(
    b String,
    c Tuple(
        d Nullable(UInt64),
        e Array(UInt32),
        f Array(Tuple(
            g String,
            h Map(
                String,
                Array(Tuple(
                    i String,
                    j UInt64
                ))
            )
        )),
        k Date
    ),
    l Nullable(String)
)
```


## priority {#priority}

<SettingsInfoBlock type='UInt64' default_value='0' />

Приоритет запроса. 1 — наивысший приоритет, чем больше значение — тем ниже приоритет; 0 — приоритеты не используются.


## promql_database {#promql_database}

<ExperimentalBadge />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.8" },
        { label: "" },
        { label: "Новый экспериментальный параметр" }
      ]
    }
  ]}
/>

Задаёт имя базы данных, используемой диалектом 'promql'. Пустая строка означает текущую базу данных.


## promql_evaluation_time {#promql_evaluation_time}

<ExperimentalBadge />

**Псевдонимы**: `evaluation_time`

<SettingsInfoBlock type='FloatAuto' default_value='auto' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.9" },
        { label: "auto" },
        {
          label:
            "Настройка была переименована. Прежнее название — `evaluation_time`."
        }
      ]
    }
  ]}
/>

Задаёт время вычисления для использования с диалектом promql. Значение 'auto' означает текущее время.


## promql_table {#promql_table}

<ExperimentalBadge />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.8" },
        { label: "" },
        { label: "Новая экспериментальная настройка" }
      ]
    }
  ]}
/>

Задаёт имя таблицы TimeSeries, используемой диалектом 'promql'.


## push_external_roles_in_interserver_queries {#push_external_roles_in_interserver_queries}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.11" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Включает передачу пользовательских ролей с узла-инициатора на другие узлы при выполнении запроса.


## query_cache_compress_entries {#query_cache_compress_entries}

<SettingsInfoBlock type='Bool' default_value='1' />

Сжимать записи в [кэше запросов](../query-cache.md). Уменьшает потребление памяти кэшем запросов за счёт замедления операций записи и чтения.

Возможные значения:

- 0 — Отключено
- 1 — Включено


## query_cache_max_entries {#query_cache_max_entries}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество результатов запросов, которые текущий пользователь может сохранить в [кеше запросов](../query-cache.md). Значение 0 означает отсутствие ограничений.

Возможные значения:

- Неотрицательное целое число.


## query_cache_max_size_in_bytes {#query_cache_max_size_in_bytes}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальный объём памяти (в байтах), который текущий пользователь может выделить в [кеше запросов](../query-cache.md). Значение 0 означает отсутствие ограничений.

Возможные значения:

- Неотрицательное целое число.


## query_cache_min_query_duration {#query_cache_min_query_duration}

<SettingsInfoBlock type='Milliseconds' default_value='0' />

Минимальная длительность выполнения запроса в миллисекундах, при которой его результат сохраняется в [кеше запросов](../query-cache.md).

Возможные значения:

- Неотрицательное целое число.


## query_cache_min_query_runs {#query_cache_min_query_runs}

<SettingsInfoBlock type='UInt64' default_value='0' />

Минимальное количество выполнений запроса `SELECT` перед сохранением его результата в [кеше запросов](../query-cache.md).

Возможные значения:

- Целое неотрицательное число >= 0.


## query_cache_nondeterministic_function_handling {#query_cache_nondeterministic_function_handling}

<SettingsInfoBlock
  type='QueryResultCacheNondeterministicFunctionHandling'
  default_value='throw'
/>

Определяет, как [кеш запросов](../query-cache.md) обрабатывает запросы `SELECT` с недетерминированными функциями, такими как `rand()` или `now()`.

Возможные значения:

- `'throw'` — Выбросить исключение и не кешировать результат запроса.
- `'save'` — Кешировать результат запроса.
- `'ignore'` — Не кешировать результат запроса и не выбрасывать исключение.


## query_cache_share_between_users {#query_cache_share_between_users}

<SettingsInfoBlock type='Bool' default_value='0' />

Если включено, результаты запросов `SELECT`, кэшированные в [кэше запросов](../query-cache.md), могут быть доступны другим пользователям.
Не рекомендуется включать эту настройку из соображений безопасности.

Возможные значения:

- 0 — Отключено
- 1 — Включено


## query_cache_squash_partial_results {#query_cache_squash_partial_results}

<SettingsInfoBlock type='Bool' default_value='1' />

Объединяет блоки частичных результатов в блоки размером [max_block_size](#max_block_size). Снижает производительность вставок в [кеш запросов](../query-cache.md), но улучшает сжимаемость записей кеша (см. [query_cache_compress_entries](#query_cache_compress_entries)).

Возможные значения:

- 0 — Отключено
- 1 — Включено


## query_cache_system_table_handling {#query_cache_system_table_handling}

<SettingsInfoBlock
  type='QueryResultCacheSystemTableHandling'
  default_value='throw'
/>

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.4" },
        { label: "throw" },
        {
          label:
            "Кеш запросов больше не кеширует результаты запросов к системным таблицам"
        }
      ]
    }
  ]}
/>

Управляет тем, как [кеш запросов](../query-cache.md) обрабатывает `SELECT`-запросы к системным таблицам, т. е. таблицам в базах данных `system.*` и `information_schema.*`.

Возможные значения:

- `'throw'` — выбросить исключение и не кешировать результат запроса.
- `'save'` — кешировать результат запроса.
- `'ignore'` — не кешировать результат запроса и не выбрасывать исключение.


## query_cache_tag {#query_cache_tag}

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.8" },
        { label: "" },
        { label: "Новая настройка для маркировки записей кэша запросов." }
      ]
    }
  ]}
/>

Строка, которая служит меткой для записей [кэша запросов](../query-cache.md).
Одинаковые запросы с разными тегами считаются различными для кэша запросов.

Возможные значения:

- Любая строка


## query_cache_ttl {#query_cache_ttl}

<SettingsInfoBlock type='Seconds' default_value='60' />

По истечении этого времени (в секундах) записи в [кеше запросов](../query-cache.md) становятся устаревшими.

Возможные значения:

- Положительное целое число ≥ 0.


## query_condition_cache_store_conditions_as_plaintext {#query_condition_cache_store_conditions_as_plaintext}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.4" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Сохраняет условие фильтрации для [кеша условий запросов](/operations/query-condition-cache) в виде открытого текста.
Если включено, system.query_condition_cache отображает точное условие фильтрации, что упрощает отладку проблем с кешем.
По умолчанию отключено, так как условия фильтрации в виде открытого текста могут раскрывать конфиденциальную информацию.

Возможные значения:

- 0 — Отключено
- 1 — Включено


## query_metric_log_interval {#query_metric_log_interval}

<SettingsInfoBlock type='Int64' default_value='-1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.10" }, { label: "-1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Интервал в миллисекундах, с которым собирается [query_metric_log](../../operations/system-tables/query_metric_log.md) для отдельных запросов.

Если установлено отрицательное значение, будет использовано значение `collect_interval_milliseconds` из [настройки query_metric_log](/operations/server-configuration-parameters/settings#query_metric_log) или значение по умолчанию 1000, если параметр отсутствует.

Чтобы отключить сбор метрик для отдельного запроса, установите `query_metric_log_interval` в 0.

Значение по умолчанию: -1


## query_plan_aggregation_in_order {#query_plan_aggregation_in_order}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "22.12" },
        { label: "1" },
        { label: "Включена часть рефакторинга плана запроса" }
      ]
    }
  ]}
/>

Включает или отключает оптимизацию агрегации с сохранением порядка на уровне плана запроса.
Действует только при значении настройки [`query_plan_enable_optimizations`](#query_plan_enable_optimizations) равном 1.

:::note
Это настройка экспертного уровня, которая должна использоваться только разработчиками для отладки. В будущем настройка может быть изменена несовместимым образом или удалена.
:::

Возможные значения:

- 0 — отключено
- 1 — включено


## query_plan_convert_any_join_to_semi_or_anti_join {#query_plan_convert_any_join_to_semi_or_anti_join}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Разрешает преобразование ANY JOIN в SEMI или ANTI JOIN, если фильтр после JOIN всегда возвращает false для несопоставленных или сопоставленных строк


## query_plan_convert_join_to_in {#query_plan_convert_join_to_in}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.4" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Позволяет преобразовать `JOIN` в подзапрос с `IN`, если выходные столбцы связаны только с левой таблицей. Может привести к неверным результатам при использовании соединений, отличных от ANY (например, ALL JOIN, которые используются по умолчанию).


## query_plan_convert_outer_join_to_inner_join {#query_plan_convert_outer_join_to_inner_join}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.4" },
        { label: "1" },
        {
          label:
            "Разрешает преобразование OUTER JOIN в INNER JOIN, если фильтр после JOIN всегда отфильтровывает значения по умолчанию"
        }
      ]
    }
  ]}
/>

Allow to convert `OUTER JOIN` to `INNER JOIN` if filter after `JOIN` always filters default values


## query_plan_direct_read_from_text_index {#query_plan_direct_read_from_text_index}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Позволяет выполнять фильтрацию полнотекстового поиска с использованием только инвертированного индекса в плане запроса.


## query_plan_display_internal_aliases {#query_plan_display_internal_aliases}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Отображать внутренние псевдонимы (например, \_\_table1) в EXPLAIN PLAN вместо псевдонимов, указанных в исходном запросе.


## query_plan_enable_multithreading_after_window_functions {#query_plan_enable_multithreading_after_window_functions}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает многопоточность после вычисления оконных функций для параллельной обработки потоков


## query_plan_enable_optimizations {#query_plan_enable_optimizations}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает оптимизацию запросов на уровне плана выполнения.

:::note
Это экспертная настройка, которая должна использоваться только разработчиками для отладки. В будущем настройка может быть изменена несовместимым образом или удалена.
:::

Возможные значения:

- 0 — Отключить все оптимизации на уровне плана выполнения запроса
- 1 — Включить оптимизации на уровне плана выполнения запроса (при этом отдельные оптимизации всё ещё могут быть отключены через соответствующие настройки)


## query_plan_execute_functions_after_sorting {#query_plan_execute_functions_after_sorting}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает оптимизацию на уровне плана запроса, которая перемещает вычисление выражений после этапов сортировки.
Действует только при значении настройки [`query_plan_enable_optimizations`](#query_plan_enable_optimizations) равном 1.

:::note
Это настройка экспертного уровня, которая должна использоваться только разработчиками для отладки. Настройка может быть изменена в будущем несовместимым образом или удалена.
:::

Возможные значения:

- 0 — Отключено
- 1 — Включено


## query_plan_filter_push_down {#query_plan_filter_push_down}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает оптимизацию на уровне плана запроса, которая перемещает фильтры ниже по плану выполнения.
Действует только при значении настройки [query_plan_enable_optimizations](#query_plan_enable_optimizations) равном 1.

:::note
Это настройка экспертного уровня, которая должна использоваться только разработчиками для отладки. Настройка может быть изменена в будущем несовместимым образом или удалена.
:::

Возможные значения:

- 0 — Отключено
- 1 — Включено


## query_plan_join_shard_by_pk_ranges {#query_plan_join_shard_by_pk_ranges}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.4" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Применять шардирование для JOIN, если ключи соединения содержат префикс PRIMARY KEY для обеих таблиц. Поддерживается для алгоритмов hash, parallel_hash и full_sorting_merge. Обычно не ускоряет выполнение запросов, но может снизить потребление памяти.


## query_plan_join_swap_table {#query_plan_join_swap_table}

<SettingsInfoBlock type='BoolAuto' default_value='auto' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.12" },
        { label: "auto" },
        { label: "Новая настройка. Ранее всегда выбиралась правая таблица." }
      ]
    }
  ]}
/>

    Определяет, какая сторона соединения должна быть таблицей сборки (также называемой внутренней — той, которая загружается в хеш-таблицу для хеш-соединения) в плане запроса. Эта настройка поддерживается только для строгости соединения `ALL` с условием `JOIN ON`. Возможные значения:
    - 'auto': Планировщик самостоятельно решает, какую таблицу использовать в качестве таблицы сборки.
    - 'false': Никогда не менять таблицы местами (правая таблица является таблицей сборки).
    - 'true': Всегда менять таблицы местами (левая таблица является таблицей сборки).


## query_plan_lift_up_array_join {#query_plan_lift_up_array_join}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает оптимизацию на уровне плана запроса, которая перемещает операции ARRAY JOIN выше в плане выполнения.
Действует только при значении настройки [query_plan_enable_optimizations](#query_plan_enable_optimizations), равном 1.

:::note
Это настройка экспертного уровня, которая должна использоваться только разработчиками для отладки. Настройка может быть изменена в будущем несовместимым образом или удалена.
:::

Возможные значения:

- 0 — Отключено
- 1 — Включено


## query_plan_lift_up_union {#query_plan_lift_up_union}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает оптимизацию на уровне плана запроса, которая перемещает крупные поддеревья плана запроса в union для применения дальнейших оптимизаций.
Действует только при значении настройки [`query_plan_enable_optimizations`](#query_plan_enable_optimizations) равном 1.

:::note
Это настройка экспертного уровня, которая должна использоваться только разработчиками для отладки. Настройка может быть изменена в будущем несовместимым образом или удалена.
:::

Возможные значения:

- 0 — Отключено
- 1 — Включено


## query_plan_max_limit_for_lazy_materialization {#query_plan_max_limit_for_lazy_materialization}

<SettingsInfoBlock type='UInt64' default_value='100' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.4" },
        { label: "10" },
        {
          label:
            "Добавлена новая настройка для управления максимальным значением лимита, при котором используется план запроса для оптимизации отложенной материализации. При нулевом значении лимит не применяется"
        }
      ]
    },
    {
      id: "row-2",
      items: [{ label: "25.11" }, { label: "100" }, { label: "Более оптимальное значение" }]
    }
  ]}
/>

Управляет максимальным значением лимита, при котором используется план запроса для оптимизации отложенной материализации. При нулевом значении лимит не применяется.


## query_plan_max_optimizations_to_apply {#query_plan_max_optimizations_to_apply}

<SettingsInfoBlock type='UInt64' default_value='10000' />

Ограничивает общее количество оптимизаций, применяемых к плану запроса. См. настройку [query_plan_enable_optimizations](#query_plan_enable_optimizations).
Полезна для предотвращения длительной оптимизации сложных запросов.
В запросе EXPLAIN PLAN применение оптимизаций прекращается после достижения этого лимита, и план возвращается в текущем виде.
При обычном выполнении запроса, если фактическое количество оптимизаций превышает это значение, генерируется исключение.

:::note
Это настройка экспертного уровня, которая должна использоваться только разработчиками для отладки. Настройка может быть изменена в будущем несовместимым образом или удалена.
:::


## query_plan_max_step_description_length {#query_plan_max_step_description_length}

<SettingsInfoBlock type='UInt64' default_value='500' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "500" }, { label: "New setting" }]
    }
  ]}
/>

Максимальная длина описания шага в EXPLAIN PLAN.


## query_plan_merge_expressions {#query_plan_merge_expressions}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает оптимизацию на уровне плана запроса, которая объединяет последовательные фильтры.
Действует только при значении настройки [query_plan_enable_optimizations](#query_plan_enable_optimizations), равном 1.

:::note
Это экспертная настройка, которая должна использоваться только разработчиками для отладки. В будущем настройка может быть изменена несовместимым образом или удалена.
:::

Возможные значения:

- 0 — отключено
- 1 — включено


## query_plan_merge_filter_into_join_condition {#query_plan_merge_filter_into_join_condition}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.4" },
        { label: "1" },
        { label: "Добавлена новая настройка для слияния фильтра с условием соединения" }
      ]
    }
  ]}
/>

Позволяет объединить фильтр с условием `JOIN` и преобразовать `CROSS JOIN` в `INNER`.


## query_plan_merge_filters {#query_plan_merge_filters}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "0" },
        { label: "Разрешает объединение фильтров в плане запроса" }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.11" },
        { label: "1" },
        {
          label:
            "Разрешает объединение фильтров в плане запроса. Это необходимо для корректной поддержки проталкивания фильтров при использовании нового анализатора."
        }
      ]
    }
  ]}
/>

Разрешает объединение фильтров в плане запроса.


## query_plan_optimize_join_order_limit {#query_plan_optimize_join_order_limit}

<SettingsInfoBlock type='UInt64' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

    Оптимизирует порядок соединений (JOIN) в рамках одного подзапроса. В настоящее время поддерживается только для очень ограниченного числа случаев.
    Значение — максимальное количество таблиц для оптимизации.


## query_plan_optimize_lazy_materialization {#query_plan_optimize_lazy_materialization}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.4" },
        { label: "1" },
        {
          label:
            "Добавлена новая настройка для использования плана запроса при оптимизации ленивой материализации"
        }
      ]
    }
  ]}
/>

Использовать план запроса для оптимизации ленивой материализации.


## query_plan_optimize_prewhere {#query_plan_optimize_prewhere}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "1" },
        {
          label:
            "Разрешает проталкивание фильтра в выражение PREWHERE для поддерживаемых движков хранения"
        }
      ]
    }
  ]}
/>

Разрешает проталкивание фильтра в выражение PREWHERE для поддерживаемых движков хранения


## query_plan_push_down_limit {#query_plan_push_down_limit}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает оптимизацию на уровне плана запроса, которая перемещает операторы LIMIT ниже по плану выполнения.
Действует только при значении настройки [query_plan_enable_optimizations](#query_plan_enable_optimizations), равном 1.

:::note
Это настройка экспертного уровня, которая должна использоваться только разработчиками для отладки. В будущем настройка может быть изменена несовместимым образом или удалена.
:::

Возможные значения:

- 0 — Отключено
- 1 — Включено


## query_plan_read_in_order {#query_plan_read_in_order}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает оптимизацию чтения в порядке сортировки на уровне плана запроса.
Действует только при значении настройки [`query_plan_enable_optimizations`](#query_plan_enable_optimizations) равном 1.

:::note
Это экспертная настройка, которая должна использоваться только разработчиками для отладки. В будущем настройка может быть изменена несовместимым образом или удалена.
:::

Возможные значения:

- 0 — Отключено
- 1 — Включено


## query_plan_remove_redundant_distinct {#query_plan_remove_redundant_distinct}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.2" },
        { label: "1" },
        { label: "Удаление избыточного шага Distinct в плане запроса" }
      ]
    }
  ]}
/>

Включает или отключает оптимизацию на уровне плана запроса, которая удаляет избыточные шаги DISTINCT.
Действует только при значении настройки [`query_plan_enable_optimizations`](#query_plan_enable_optimizations) равном 1.

:::note
Это настройка экспертного уровня, которая должна использоваться только разработчиками для отладки. Настройка может быть изменена в будущем несовместимым образом или удалена.
:::

Возможные значения:

- 0 — отключено
- 1 — включено


## query_plan_remove_redundant_sorting {#query_plan_remove_redundant_sorting}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.1" },
        { label: "1" },
        {
          label:
            "Удаление избыточной сортировки в плане запроса. Например, шагов сортировки, связанных с предложениями ORDER BY в подзапросах"
        }
      ]
    }
  ]}
/>

Включает или отключает оптимизацию на уровне плана запроса, которая удаляет избыточные шаги сортировки, например, в подзапросах.
Действует только при значении настройки [`query_plan_enable_optimizations`](#query_plan_enable_optimizations) равном 1.

:::note
Это настройка экспертного уровня, которая должна использоваться только разработчиками для отладки. Настройка может быть изменена в будущем несовместимым образом или удалена.
:::

Возможные значения:

- 0 — отключено
- 1 — включено


## query_plan_remove_unused_columns {#query_plan_remove_unused_columns}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "1" },
        {
          label:
            "Новая настройка. Добавлена оптимизация для удаления неиспользуемых столбцов из плана запроса."
        }
      ]
    }
  ]}
/>

Включает или отключает оптимизацию на уровне плана запроса, которая удаляет неиспользуемые столбцы (как входные, так и выходные) из шагов плана запроса.
Действует только при значении настройки [query_plan_enable_optimizations](#query_plan_enable_optimizations) равном 1.

:::note
Это экспертная настройка, которая должна использоваться только разработчиками для отладки. В будущем настройка может быть изменена несовместимым образом или удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить


## query_plan_reuse_storage_ordering_for_window_functions {#query_plan_reuse_storage_ordering_for_window_functions}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает или отключает оптимизацию на уровне плана запроса, которая использует порядок сортировки данных в хранилище при выполнении сортировки для оконных функций.
Действует только при значении настройки [`query_plan_enable_optimizations`](#query_plan_enable_optimizations) равном 1.

:::note
Это настройка экспертного уровня, которая должна использоваться только разработчиками для отладки. Настройка может быть изменена в будущем несовместимым образом или удалена.
:::

Возможные значения:

- 0 — отключена
- 1 — включена


## query_plan_split_filter {#query_plan_split_filter}

<SettingsInfoBlock type='Bool' default_value='1' />

:::note
Это экспертная настройка, которая должна использоваться только разработчиками для отладки. В будущем настройка может быть изменена несовместимым образом или удалена.
:::

Включает или отключает оптимизацию на уровне плана запроса, которая разбивает фильтры на выражения.
Действует только при значении настройки [query_plan_enable_optimizations](#query_plan_enable_optimizations), равном 1.

Возможные значения:

- 0 — отключено
- 1 — включено


## query_plan_try_use_vector_search {#query_plan_try_use_vector_search}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.1" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Включает оптимизацию на уровне плана запроса, которая пытается использовать индекс векторного сходства.
Действует только при значении настройки [`query_plan_enable_optimizations`](#query_plan_enable_optimizations) равном 1.

:::note
Это настройка экспертного уровня, которая должна использоваться только разработчиками для отладки. Настройка может быть изменена в будущем несовместимым образом или удалена.
:::

Возможные значения:

- 0 — Отключено
- 1 — Включено


## query_plan_use_new_logical_join_step {#query_plan_use_new_logical_join_step}

**Псевдонимы**: `query_plan_use_logical_join_step`

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.2" }, { label: "1" }, { label: "Включён новый шаг" }]
    },
    {
      id: "row-2",
      items: [
        { label: "25.1" },
        { label: "0" },
        { label: "Новый шаг соединения, внутреннее изменение" }
      ]
    }
  ]}
/>

Использовать логический шаг соединения в плане запроса.
Примечание: настройка `query_plan_use_new_logical_join_step` устарела, вместо неё используйте `query_plan_use_logical_join_step`.


## query_profiler_cpu_time_period_ns {#query_profiler_cpu_time_period_ns}

<SettingsInfoBlock type='UInt64' default_value='1000000000' />

Задает период для таймера процессорного времени [профилировщика запросов](../../operations/optimizing-performance/sampling-query-profiler.md). Этот таймер учитывает только процессорное время.

Возможные значения:

- Положительное целое число наносекунд.

  Рекомендуемые значения:

            - 10000000 (100 раз в секунду) наносекунд и более для отдельных запросов.
            - 1000000000 (раз в секунду) для профилирования на уровне кластера.

- 0 для отключения таймера.

**Временно отключено в ClickHouse Cloud.**

См. также:

- Системная таблица [trace_log](/operations/system-tables/trace_log)


## query_profiler_real_time_period_ns {#query_profiler_real_time_period_ns}

<SettingsInfoBlock type='UInt64' default_value='1000000000' />

Задает период для таймера реального времени [профилировщика запросов](../../operations/optimizing-performance/sampling-query-profiler.md). Таймер реального времени измеряет астрономическое время.

Возможные значения:

- Положительное целое число в наносекундах.

  Рекомендуемые значения:

            - 10000000 (100 раз в секунду) наносекунд и менее для отдельных запросов.
            - 1000000000 (раз в секунду) для профилирования на уровне кластера.

- 0 для отключения таймера.

**Временно отключено в ClickHouse Cloud.**

См. также:

- Системная таблица [trace_log](/operations/system-tables/trace_log)


## queue_max_wait_ms {#queue_max_wait_ms}

<SettingsInfoBlock type='Milliseconds' default_value='0' />

Время ожидания в очереди запросов при превышении максимального количества одновременных запросов.


## rabbitmq_max_wait_ms {#rabbitmq_max_wait_ms}

<SettingsInfoBlock type='Milliseconds' default_value='5000' />

Время ожидания чтения из RabbitMQ перед повторной попыткой.


## read_backoff_max_throughput {#read_backoff_max_throughput}

<SettingsInfoBlock type='UInt64' default_value='1048576' />

Настройка для уменьшения количества потоков при медленном чтении. Учитываются события, когда пропускная способность чтения меньше указанного количества байтов в секунду.


## read_backoff_min_concurrency {#read_backoff_min_concurrency}

<SettingsInfoBlock type='UInt64' default_value='1' />

Настройка для попытки сохранения минимального количества потоков при медленном чтении.


## read_backoff_min_events {#read_backoff_min_events}

<SettingsInfoBlock type='UInt64' default_value='2' />

Настройка для уменьшения количества потоков при медленном чтении. Определяет количество событий, после которого число потоков будет уменьшено.


## read_backoff_min_interval_between_events_ms {#read_backoff_min_interval_between_events_ms}

<SettingsInfoBlock type='Milliseconds' default_value='1000' />

Настройка для уменьшения количества потоков при медленном чтении. Событие игнорируется, если с момента предыдущего события прошло менее указанного времени.


## read_backoff_min_latency_ms {#read_backoff_min_latency_ms}

<SettingsInfoBlock type='Milliseconds' default_value='1000' />

Настройка для уменьшения количества потоков при медленном чтении. Учитываются только операции чтения, которые заняли не менее указанного времени.


## read_from_distributed_cache_if_exists_otherwise_bypass_cache {#read_from_distributed_cache_if_exists_otherwise_bypass_cache}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Имеет эффект только в ClickHouse Cloud. Аналогична настройке read_from_filesystem_cache_if_exists_otherwise_bypass_cache, но для распределённого кэша.


## read_from_filesystem_cache_if_exists_otherwise_bypass_cache {#read_from_filesystem_cache_if_exists_otherwise_bypass_cache}

<SettingsInfoBlock type='Bool' default_value='0' />

Позволяет использовать кеш файловой системы в пассивном режиме — использовать существующие записи кеша, но не добавлять в него новые записи. Если включить эту настройку для тяжёлых разовых запросов и оставить её отключённой для коротких запросов в реальном времени, это позволит избежать вытеснения данных из кеша слишком тяжёлыми запросами и повысить общую эффективность системы.


## read_from_page_cache_if_exists_otherwise_bypass_cache {#read_from_page_cache_if_exists_otherwise_bypass_cache}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "0" },
        { label: "Добавлен кеш страниц в пространстве пользователя" }
      ]
    }
  ]}
/>

Использовать кеш страниц в пространстве пользователя в пассивном режиме, аналогично read_from_filesystem_cache_if_exists_otherwise_bypass_cache.


## read_in_order_two_level_merge_threshold {#read_in_order_two_level_merge_threshold}

<SettingsInfoBlock type='UInt64' default_value='100' />

Минимальное количество частей для чтения, при котором выполняется предварительный этап слияния во время многопоточного чтения в порядке первичного ключа.


## read_in_order_use_buffering {#read_in_order_use_buffering}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.7" },
        { label: "1" },
        {
          label:
            "Использовать буферизацию перед слиянием при чтении в порядке первичного ключа"
        }
      ]
    }
  ]}
/>

Использовать буферизацию перед слиянием при чтении в порядке первичного ключа. Повышает степень параллелизма выполнения запросов


## read_in_order_use_virtual_row {#read_in_order_use_virtual_row}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.11" },
        { label: "0" },
        {
          label:
            "Использовать виртуальную строку при чтении в порядке первичного ключа или его монотонной функции. Полезно при поиске по нескольким частям данных, так как обрабатываются только релевантные части."
        }
      ]
    }
  ]}
/>

Использовать виртуальную строку при чтении в порядке первичного ключа или его монотонной функции. Полезно при поиске по нескольким частям данных, так как обрабатываются только релевантные части.


## read_overflow_mode {#read_overflow_mode}

<SettingsInfoBlock type='OverflowMode' default_value='throw' />

Что делать при превышении ограничения.


## read_overflow_mode_leaf {#read_overflow_mode_leaf}

<SettingsInfoBlock type='OverflowMode' default_value='throw' />

Определяет поведение при превышении объёма прочитанных данных одного из листовых лимитов.

Возможные значения:

- `throw` — выбросить исключение (по умолчанию).
- `break` — остановить выполнение запроса и вернуть частичный результат.


## read_priority {#read_priority}

<SettingsInfoBlock type='Int64' default_value='0' />

Приоритет чтения данных из локальной или удалённой файловой системы. Поддерживается только для метода `pread_threadpool` в локальной файловой системе и для метода `threadpool` в удалённой файловой системе.


## read_through_distributed_cache {#read_through_distributed_cache}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "0" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Разрешает чтение из распределённого кеша


## readonly {#readonly}

<SettingsInfoBlock type='UInt64' default_value='0' />

0 — без ограничений режима «только для чтения». 1 — разрешены только запросы на чтение, а также изменение явно разрешённых настроек. 2 — разрешены только запросы на чтение и изменение настроек, за исключением настройки 'readonly'.


## receive_data_timeout_ms {#receive_data_timeout_ms}

<SettingsInfoBlock type='Milliseconds' default_value='2000' />

Тайм-аут соединения для получения первого пакета данных или пакета с положительным прогрессом от реплики


## receive_timeout {#receive_timeout}

<SettingsInfoBlock type='Seconds' default_value='300' />

Таймаут для получения данных из сети, в секундах. Если в течение этого интервала не было получено ни одного байта, генерируется исключение. Если эта настройка установлена на клиенте, параметр 'send_timeout' для сокета также будет установлен на соответствующей стороне соединения на сервере.


## regexp_max_matches_per_row {#regexp_max_matches_per_row}

<SettingsInfoBlock type='UInt64' default_value='1000' />

Устанавливает максимальное количество совпадений для одного регулярного выражения на строку. Используйте эту настройку для защиты от переполнения памяти при использовании жадных регулярных выражений в функции [extractAllGroupsHorizontal](/sql-reference/functions/string-search-functions#extractAllGroupsHorizontal).

Возможные значения:

- Положительное целое число.


## reject_expensive_hyperscan_regexps {#reject_expensive_hyperscan_regexps}

<SettingsInfoBlock type='Bool' default_value='1' />

Отклонять шаблоны, которые могут потребовать значительных вычислительных ресурсов при обработке hyperscan (из-за экспоненциального роста состояний NFA)


## remerge_sort_lowered_memory_bytes_ratio {#remerge_sort_lowered_memory_bytes_ratio}

<SettingsInfoBlock type='Float' default_value='2' />

Если использование памяти после повторного слияния не уменьшилось в это количество раз, повторное слияние будет отключено.


## remote_filesystem_read_method {#remote_filesystem_read_method}

<SettingsInfoBlock type='String' default_value='threadpool' />

Метод чтения данных из удалённой файловой системы. Возможные значения: read, threadpool.


## remote_filesystem_read_prefetch {#remote_filesystem_read_prefetch}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать ли предварительную загрузку при чтении данных из удалённой файловой системы.


## remote_fs_read_backoff_max_tries {#remote_fs_read_backoff_max_tries}

<SettingsInfoBlock type='UInt64' default_value='5' />

Максимальное количество попыток чтения с отсрочкой


## remote_fs_read_max_backoff_ms {#remote_fs_read_max_backoff_ms}

<SettingsInfoBlock type='UInt64' default_value='10000' />

Максимальное время ожидания при попытке чтения данных с удалённого диска


## remote_read_min_bytes_for_seek {#remote_read_min_bytes_for_seek}

<SettingsInfoBlock type='UInt64' default_value='4194304' />

Минимальное количество байтов для удалённого чтения (url, s3), при котором выполняется операция seek вместо чтения с пропуском данных.


## rename_files_after_processing {#rename_files_after_processing}

- **Тип:** String

- **Значение по умолчанию:** Пустая строка

Эта настройка позволяет задать шаблон переименования для файлов, обрабатываемых табличной функцией `file`. Если параметр установлен, все файлы, прочитанные табличной функцией `file`, будут переименованы согласно указанному шаблону с подстановочными символами только в случае успешной обработки файлов.

### Подстановочные символы

- `%a` — Полное исходное имя файла (например, "sample.csv").
- `%f` — Исходное имя файла без расширения (например, "sample").
- `%e` — Исходное расширение файла с точкой (например, ".csv").
- `%t` — Временная метка (в микросекундах).
- `%%` — Знак процента ("%").

### Пример

- Параметр: `--rename_files_after_processing="processed_%f_%t%e"`

- Запрос: `SELECT * FROM file('sample.csv')`

Если чтение `sample.csv` выполнено успешно, файл будет переименован в `processed_sample_1683473210851438.csv`


## replace_running_query {#replace_running_query}

<SettingsInfoBlock type='Bool' default_value='0' />

При использовании HTTP-интерфейса можно передать параметр `query_id`. Это произвольная строка, которая служит идентификатором запроса.
Если в данный момент уже выполняется запрос от того же пользователя с тем же `query_id`, поведение определяется параметром `replace_running_query`.

`0` (по умолчанию) – Выбросить исключение (не разрешать выполнение запроса, если запрос с тем же `query_id` уже выполняется).

`1` – Отменить старый запрос и начать выполнение нового.

Установите этот параметр в значение 1 для реализации подсказок по условиям сегментации. После ввода следующего символа, если старый запрос еще не завершился, он должен быть отменен.


## replace_running_query_max_wait_ms {#replace_running_query_max_wait_ms}

<SettingsInfoBlock type='Milliseconds' default_value='5000' />

Время ожидания завершения выполняющегося запроса с тем же `query_id` при активной настройке [replace_running_query](#replace_running_query).

Возможные значения:

- Положительное целое число.
- 0 — Генерируется исключение, запрещающее запуск нового запроса, если сервер уже выполняет запрос с тем же `query_id`.


## replication_wait_for_inactive_replica_timeout {#replication_wait_for_inactive_replica_timeout}

<SettingsInfoBlock type='Int64' default_value='120' />

Определяет, как долго (в секундах) ожидать выполнения запросов [`ALTER`](../../sql-reference/statements/alter/index.md), [`OPTIMIZE`](../../sql-reference/statements/optimize.md) или [`TRUNCATE`](../../sql-reference/statements/truncate.md) неактивными репликами.

Возможные значения:

- `0` — не ожидать.
- Отрицательное целое число — ожидать неограниченное время.
- Положительное целое число — количество секунд ожидания.


## restore_replace_external_dictionary_source_to_null {#restore_replace_external_dictionary_source_to_null}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.10" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Заменяет источники внешних словарей на Null при восстановлении. Полезно для тестирования


## restore_replace_external_engines_to_null {#restore_replace_external_engines_to_null}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.8" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Для целей тестирования. Заменяет все внешние движки на Null, чтобы не инициировать внешние подключения.


## restore_replace_external_table_functions_to_null {#restore_replace_external_table_functions_to_null}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.8" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Для целей тестирования. Заменяет все внешние табличные функции на Null, чтобы не инициировать внешние подключения.


## restore_replicated_merge_tree_to_shared_merge_tree {#restore_replicated_merge_tree_to_shared_merge_tree}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.2" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Заменяет движок таблицы с Replicated*MergeTree на Shared*MergeTree при выполнении RESTORE.


## result_overflow_mode {#result_overflow_mode}

<SettingsInfoBlock type='OverflowMode' default_value='throw' />

Значение по умолчанию в Cloud: `throw`

Определяет, что делать, если объём результата превышает один из лимитов.

Возможные значения:

- `throw`: выбросить исключение (по умолчанию).
- `break`: остановить выполнение запроса и вернуть частичный результат, как если бы исходные данные закончились.

Использование `break` аналогично использованию LIMIT. `Break` прерывает выполнение только на уровне блока. Это означает, что количество возвращённых строк больше
[`max_result_rows`](/operations/settings/settings#max_result_rows), кратно [`max_block_size`](/operations/settings/settings#max_block_size)
и зависит от [`max_threads`](/operations/settings/settings#max_threads).

**Пример**

```sql title="Запрос"
SET max_threads = 3, max_block_size = 3333;
SET max_result_rows = 3334, result_overflow_mode = 'break';

SELECT *
FROM numbers_mt(100000)
FORMAT Null;
```

```text title="Результат"
6666 rows in set. ...
```


## rewrite_count_distinct_if_with_count_distinct_implementation {#rewrite_count_distinct_if_with_count_distinct_implementation}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.8" },
        { label: "1" },
        {
          label:
            "Перезапись countDistinctIf с использованием конфигурации count_distinct_implementation"
        }
      ]
    }
  ]}
/>

Позволяет переписывать `countDistcintIf` с использованием настройки [count_distinct_implementation](#count_distinct_implementation).

Возможные значения:

- true — Разрешено.
- false — Запрещено.


## rewrite_in_to_join {#rewrite_in_to_join}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.10" },
        { label: "0" },
        { label: "Новая экспериментальная настройка" }
      ]
    }
  ]}
/>

Преобразует выражения вида 'x IN subquery' в JOIN. Может быть полезно для оптимизации всего запроса путём изменения порядка соединений.


## s3_allow_multipart_copy {#s3_allow_multipart_copy}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.2" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Разрешает многочастное копирование в S3.


## s3_allow_parallel_part_upload {#s3_allow_parallel_part_upload}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать несколько потоков для многочастной загрузки в S3. Может привести к незначительному увеличению потребления памяти


## s3_check_objects_after_upload {#s3_check_objects_after_upload}

<SettingsInfoBlock type='Bool' default_value='0' />

Проверять каждый загруженный в S3 объект с помощью HEAD-запроса для подтверждения успешной загрузки


## s3_connect_timeout_ms {#s3_connect_timeout_ms}

<SettingsInfoBlock type='UInt64' default_value='1000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "1000" },
        { label: "Добавлена отдельная настройка для тайм-аута подключения к S3" }
      ]
    }
  ]}
/>

Тайм-аут подключения к хосту дисков S3.


## s3_create_new_file_on_insert {#s3_create_new_file_on_insert}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает создание нового файла при каждой вставке в таблицы с движком s3. Если параметр включён, при каждой вставке будет создаваться новый объект S3 с ключом по следующему шаблону:

исходный: `data.Parquet.gz` -> `data.1.Parquet.gz` -> `data.2.Parquet.gz` и т. д.

Возможные значения:

- 0 — запрос `INSERT` создаёт новый файл или завершается с ошибкой, если файл существует и параметр s3_truncate_on_insert не установлен.
- 1 — запрос `INSERT` создаёт новый файл при каждой вставке с использованием суффикса (начиная со второго файла), если параметр s3_truncate_on_insert не установлен.

Подробнее см. [здесь](/integrations/s3#inserting-data).


## s3_disable_checksum {#s3_disable_checksum}

<SettingsInfoBlock type='Bool' default_value='0' />

Не вычислять контрольную сумму при отправке файла в S3. Это ускоряет запись, исключая избыточные проходы обработки файла. В целом это безопасно, поскольку данные таблиц MergeTree всё равно проверяются контрольными суммами самим ClickHouse, а при доступе к S3 через HTTPS уровень TLS уже обеспечивает целостность данных при передаче по сети. Тем не менее дополнительные контрольные суммы в S3 обеспечивают многоуровневую защиту.


## s3_ignore_file_doesnt_exist {#s3_ignore_file_doesnt_exist}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "0" },
        {
          label:
            "Позволяет возвращать 0 строк, если запрашиваемые файлы не существуют, вместо генерации исключения в движке таблиц S3"
        }
      ]
    }
  ]}
/>

Игнорировать отсутствие файла при чтении определённых ключей, если он не существует.

Возможные значения:

- 1 — `SELECT` возвращает пустой результат.
- 0 — `SELECT` генерирует исключение.


## s3_list_object_keys_size {#s3_list_object_keys_size}

<SettingsInfoBlock type='UInt64' default_value='1000' />

Максимальное количество файлов, которые могут быть возвращены в одном пакете запросом ListObject


## s3_max_connections {#s3_max_connections}

<SettingsInfoBlock type='UInt64' default_value='1024' />

Максимальное количество подключений к серверу.


## s3_max_get_burst {#s3_max_get_burst}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество запросов, которые могут быть отправлены одновременно до достижения ограничения на количество запросов в секунду. По умолчанию (0) равно `s3_max_get_rps`


## s3_max_get_rps {#s3_max_get_rps}

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничение на частоту GET-запросов к S3 в секунду до применения троттлинга. Ноль означает отсутствие ограничений.


## s3_max_inflight_parts_for_one_file {#s3_max_inflight_parts_for_one_file}

<SettingsInfoBlock type='UInt64' default_value='20' />

Максимальное количество одновременно загружаемых частей в запросе многочастной загрузки. Значение 0 означает отсутствие ограничений.


## s3_max_part_number {#s3_max_part_number}

<SettingsInfoBlock type='UInt64' default_value='10000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "10000" },
        { label: "Максимальный номер части для многочастной загрузки в S3" }
      ]
    }
  ]}
/>

Максимальный номер части для многочастной загрузки в S3.


## s3_max_put_burst {#s3_max_put_burst}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальное количество запросов, которые могут быть отправлены одновременно до достижения ограничения на количество запросов в секунду. По умолчанию (0) равно значению `s3_max_put_rps`


## s3_max_put_rps {#s3_max_put_rps}

<SettingsInfoBlock type='UInt64' default_value='0' />

Ограничение на частоту PUT-запросов к S3 в секунду до применения троттлинга. Ноль означает отсутствие ограничений.


## s3_max_single_operation_copy_size {#s3_max_single_operation_copy_size}

<SettingsInfoBlock type='UInt64' default_value='33554432' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "33554432" },
        { label: "Максимальный размер для одиночной операции копирования в S3" }
      ]
    }
  ]}
/>

Максимальный размер для одиночной операции копирования в S3. Эта настройка используется только при значении s3_allow_multipart_copy равном true.


## s3_max_single_part_upload_size {#s3_max_single_part_upload_size}

<SettingsInfoBlock type='UInt64' default_value='33554432' />

Максимальный размер объекта для загрузки в S3 с использованием одночастной загрузки.


## s3_max_single_read_retries {#s3_max_single_read_retries}

<SettingsInfoBlock type='UInt64' default_value='4' />

Максимальное количество повторных попыток при одном чтении из S3.


## s3_max_unexpected_write_error_retries {#s3_max_unexpected_write_error_retries}

<SettingsInfoBlock type='UInt64' default_value='4' />

Максимальное количество повторных попыток при возникновении неожиданных ошибок во время записи в S3.


## s3_max_upload_part_size {#s3_max_upload_part_size}

<SettingsInfoBlock type='UInt64' default_value='5368709120' />

Максимальный размер части для загрузки при многочастевой загрузке в S3.


## s3_min_upload_part_size {#s3_min_upload_part_size}

<SettingsInfoBlock type='UInt64' default_value='16777216' />

Минимальный размер части для загрузки при многочастевой загрузке в S3.


## s3_request_timeout_ms {#s3_request_timeout_ms}

<SettingsInfoBlock type='UInt64' default_value='30000' />

Таймаут простоя при отправке и получении данных в/из S3. Операция завершается с ошибкой, если один вызов TCP read или write блокируется на это время или дольше.


## s3_skip_empty_files {#s3_skip_empty_files}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.11" },
        { label: "1" },
        { label: "Мы надеемся, что это улучшит пользовательский опыт" }
      ]
    }
  ]}
/>

Включает или отключает пропуск пустых файлов в таблицах движка [S3](../../engines/table-engines/integrations/s3.md).

Возможные значения:

- 0 — `SELECT` генерирует исключение, если пустой файл несовместим с запрошенным форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.


## s3_slow_all_threads_after_network_error {#s3_slow_all_threads_after_network_error}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.5" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

При значении `true` все потоки, выполняющие S3-запросы к одной и той же конечной точке резервного копирования, замедляются
после того, как любой отдельный S3-запрос столкнётся с повторяемой сетевой ошибкой, например, таймаутом сокета.
При значении `false` каждый поток обрабатывает задержку повторных попыток S3-запросов независимо от других.


## s3_strict_upload_part_size {#s3_strict_upload_part_size}

<SettingsInfoBlock type='UInt64' default_value='0' />

Точный размер части для загрузки при многочастной загрузке в S3 (некоторые реализации не поддерживают части переменного размера).


## s3_throw_on_zero_files_match {#s3_throw_on_zero_files_match}

<SettingsInfoBlock type='Bool' default_value='0' />

Выбрасывать ошибку, если запрос ListObjects не находит ни одного файла


## s3_truncate_on_insert {#s3_truncate_on_insert}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает очистку файла перед вставкой данных в таблицы движка s3. Если отключено, при попытке вставки будет выброшено исключение, если объект S3 уже существует.

Возможные значения:

- 0 — запрос `INSERT` создаёт новый файл или завершается с ошибкой, если файл существует и параметр s3_create_new_file_on_insert не установлен.
- 1 — запрос `INSERT` заменяет существующее содержимое файла новыми данными.

Подробнее см. [здесь](/integrations/s3#inserting-data).


## s3_upload_part_size_multiply_factor {#s3_upload_part_size_multiply_factor}

<SettingsInfoBlock type='UInt64' default_value='2' />

Умножает s3_min_upload_part_size на этот коэффициент каждый раз, когда из одной операции записи в S3 загружается s3_multiply_parts_count_threshold частей.


## s3_upload_part_size_multiply_parts_count_threshold {#s3_upload_part_size_multiply_parts_count_threshold}

<SettingsInfoBlock type='UInt64' default_value='500' />

Каждый раз при загрузке в S3 указанного количества частей значение s3_min_upload_part_size умножается на s3_upload_part_size_multiply_factor.


## s3_use_adaptive_timeouts {#s3_use_adaptive_timeouts}

<SettingsInfoBlock type='Bool' default_value='1' />

Если установлено значение `true`, то для всех S3-запросов первые две попытки выполняются с уменьшенными таймаутами отправки и получения.
Если установлено значение `false`, то все попытки выполняются с одинаковыми таймаутами.


## s3_validate_request_settings {#s3_validate_request_settings}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.6" },
        { label: "1" },
        { label: "Возможность отключения проверки настроек запросов S3" }
      ]
    }
  ]}
/>

Включает проверку настроек запросов S3.
Возможные значения:

- 1 — проверять настройки.
- 0 — не проверять настройки.


## s3queue_default_zookeeper_path {#s3queue_default_zookeeper_path}

<SettingsInfoBlock type='String' default_value='/clickhouse/s3queue/' />

Префикс пути ZooKeeper по умолчанию для движка S3Queue


## s3queue_enable_logging_to_s3queue_log {#s3queue_enable_logging_to_s3queue_log}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает запись в system.s3queue_log. Значение может быть переопределено для каждой таблицы с помощью настроек таблицы


## s3queue_keeper_fault_injection_probability {#s3queue_keeper_fault_injection_probability}

<SettingsInfoBlock type='Float' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Вероятность инъекции отказов Keeper для S3Queue.


## s3queue_migrate_old_metadata_to_buckets {#s3queue_migrate_old_metadata_to_buckets}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.1" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Миграция старой структуры метаданных таблицы S3Queue на новую


## schema_inference_cache_require_modification_time_for_url {#schema_inference_cache_require_modification_time_for_url}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать схему из кэша для URL с валидацией времени последнего изменения (для URL с заголовком Last-Modified)


## schema_inference_use_cache_for_azure {#schema_inference_use_cache_for_azure}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать кэш при выводе схемы для табличной функции azure


## schema_inference_use_cache_for_file {#schema_inference_use_cache_for_file}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать кэш при выводе схемы при работе с табличной функцией file


## schema_inference_use_cache_for_hdfs {#schema_inference_use_cache_for_hdfs}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать кэш при выводе схемы для табличной функции hdfs


## schema_inference_use_cache_for_s3 {#schema_inference_use_cache_for_s3}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать кэш при выводе схемы для табличной функции s3


## schema_inference_use_cache_for_url {#schema_inference_use_cache_for_url}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать кэш при выводе схемы для табличной функции url


## secondary_indices_enable_bulk_filtering {#secondary_indices_enable_bulk_filtering}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.5" },
        { label: "1" },
        { label: "Новый алгоритм фильтрации по индексам с пропуском данных" }
      ]
    }
  ]}
/>

Включает алгоритм пакетной фильтрации для индексов. Ожидается, что он всегда работает лучше, но эта настройка предусмотрена для обеспечения совместимости и контроля.


## select_sequential_consistency {#select_sequential_consistency}

<SettingsInfoBlock type='UInt64' default_value='0' />

:::note
Поведение этой настройки различается для SharedMergeTree и ReplicatedMergeTree. Подробнее о поведении `select_sequential_consistency` в SharedMergeTree см. в разделе [Согласованность SharedMergeTree](/cloud/reference/shared-merge-tree#consistency).
:::

Включает или отключает последовательную согласованность для запросов `SELECT`. Требует отключения `insert_quorum_parallel` (по умолчанию включена).

Возможные значения:

- 0 — отключено.
- 1 — включено.

Использование

При включенной последовательной согласованности ClickHouse позволяет клиенту выполнять запрос `SELECT` только на тех репликах, которые содержат данные из всех предыдущих запросов `INSERT`, выполненных с `insert_quorum`. Если клиент обращается к частичной реплике, ClickHouse генерирует исключение. Запрос SELECT не будет включать данные, которые еще не были записаны в кворум реплик.

Когда `insert_quorum_parallel` включена (по умолчанию), `select_sequential_consistency` не работает. Это связано с тем, что параллельные запросы `INSERT` могут записываться в разные наборы реплик кворума, поэтому нет гарантии, что одна реплика получит все записи.

См. также:

- [insert_quorum](#insert_quorum)
- [insert_quorum_timeout](#insert_quorum_timeout)
- [insert_quorum_parallel](#insert_quorum_parallel)


## send_logs_level {#send_logs_level}

<SettingsInfoBlock type='LogsLevel' default_value='fatal' />

Отправлять текстовые логи сервера клиенту с указанным минимальным уровнем. Допустимые значения: 'trace', 'debug', 'information', 'warning', 'error', 'fatal', 'none'


## send_logs_source_regexp {#send_logs_source_regexp}

Отправлять текстовые логи сервера, соответствующие указанному регулярному выражению для имени источника лога. Пустое значение означает все источники.


## send_profile_events {#send_profile_events}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.11" },
        { label: "1" },
        { label: "Новая настройка. Определяет, отправлять ли события профилирования клиентам." }
      ]
    }
  ]}
/>

Включает или отключает отправку пакетов [ProfileEvents](/native-protocol/server.md#profile-events) клиенту.

Можно отключить для снижения сетевого трафика у клиентов, которым не требуются события профилирования.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.


## send_progress_in_http_headers {#send_progress_in_http_headers}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает заголовки HTTP-ответа `X-ClickHouse-Progress` в ответах `clickhouse-server`.

Подробнее см. в [описании HTTP-интерфейса](../../interfaces/http.md).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.


## send_timeout {#send_timeout}

<SettingsInfoBlock type='Seconds' default_value='300' />

Таймаут для отправки данных в сеть, в секундах. Если клиенту необходимо отправить данные, но он не может отправить ни одного байта в течение этого интервала, генерируется исключение. Если этот параметр установлен на клиенте, то `receive_timeout` для сокета также будет установлен на соответствующей стороне соединения на сервере.


## serialize_query_plan {#serialize_query_plan}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.4" }, { label: "0" }, { label: "NewSetting" }]
    }
  ]}
/>

Сериализовать план запроса для распределённой обработки


## session_timezone {#session_timezone}

<BetaBadge />

Устанавливает неявный часовой пояс текущей сессии или запроса.
Неявный часовой пояс — это часовой пояс, применяемый к значениям типов DateTime/DateTime64, для которых часовой пояс не указан явно.
Эта настройка имеет приоритет над глобально настроенным (на уровне сервера) неявным часовым поясом.
Значение '' (пустая строка) означает, что неявный часовой пояс текущей сессии или запроса совпадает с [часовым поясом сервера](../server-configuration-parameters/settings.md/#timezone).

Для получения часового пояса сессии и часового пояса сервера можно использовать функции `timeZone()` и `serverTimeZone()`.

Возможные значения:

- Любое название часового пояса из `system.time_zones`, например `Europe/Berlin`, `UTC` или `Zulu`

Примеры:

```sql
SELECT timeZone(), serverTimeZone() FORMAT CSV

"Europe/Berlin","Europe/Berlin"
```

```sql
SELECT timeZone(), serverTimeZone() SETTINGS session_timezone = 'Asia/Novosibirsk' FORMAT CSV

"Asia/Novosibirsk","Europe/Berlin"
```

Присвоение часового пояса сессии 'America/Denver' внутреннему значению DateTime без явно указанного часового пояса:

```sql
SELECT toDateTime64(toDateTime64('1999-12-12 23:23:23.123', 3), 3, 'Europe/Zurich') SETTINGS session_timezone = 'America/Denver' FORMAT TSV

1999-12-13 07:23:23.123
```

:::warning
Не все функции, выполняющие разбор DateTime/DateTime64, учитывают `session_timezone`. Это может привести к неочевидным ошибкам.
См. следующий пример и объяснение.
:::

```sql
CREATE TABLE test_tz (`d` DateTime('UTC')) ENGINE = Memory AS SELECT toDateTime('2000-01-01 00:00:00', 'UTC');

SELECT *, timeZone() FROM test_tz WHERE d = toDateTime('2000-01-01 00:00:00') SETTINGS session_timezone = 'Asia/Novosibirsk'
0 rows in set.

SELECT *, timeZone() FROM test_tz WHERE d = '2000-01-01 00:00:00' SETTINGS session_timezone = 'Asia/Novosibirsk'
┌───────────────────d─┬─timeZone()───────┐
│ 2000-01-01 00:00:00 │ Asia/Novosibirsk │
└─────────────────────┴──────────────────┘
```

Это происходит из-за различий в процессе разбора:

- Функция `toDateTime()` без явно указанного часового пояса, используемая в первом запросе `SELECT`, учитывает настройку `session_timezone` и глобальный часовой пояс.
- Во втором запросе значение DateTime разбирается из строки и наследует тип и часовой пояс существующего столбца `d`. Таким образом, настройка `session_timezone` и глобальный часовой пояс не учитываются.

**См. также**

- [timezone](../server-configuration-parameters/settings.md/#timezone)


## set_overflow_mode {#set_overflow_mode}

<SettingsInfoBlock type='OverflowMode' default_value='throw' />

Определяет поведение при превышении одного из лимитов на объем данных.

Возможные значения:

- `throw`: выбрасывать исключение (по умолчанию).
- `break`: прекратить выполнение запроса и вернуть частичный результат, как если бы исходные данные закончились.


## shared_merge_tree_sync_parts_on_partition_operations {#shared_merge_tree_sync_parts_on_partition_operations}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.12" },
        { label: "1" },
        { label: "Новая настройка. По умолчанию куски всегда синхронизируются" }
      ]
    }
  ]}
/>

Автоматически синхронизировать набор кусков данных после операций MOVE|REPLACE|ATTACH над партициями в таблицах SMT. Только для Cloud


## short_circuit_function_evaluation {#short_circuit_function_evaluation}

<SettingsInfoBlock
  type='ShortCircuitFunctionEvaluation'
  default_value='enable'
/>

Позволяет вычислять функции [if](../../sql-reference/functions/conditional-functions.md/#if), [multiIf](../../sql-reference/functions/conditional-functions.md/#multiIf), [and](/sql-reference/functions/logical-functions#and) и [or](/sql-reference/functions/logical-functions#or) по [схеме с коротким замыканием](https://en.wikipedia.org/wiki/Short-circuit_evaluation). Это помогает оптимизировать выполнение сложных выражений в этих функциях и предотвращать возможные исключения (например, деление на ноль в случаях, когда оно не предполагается).

Возможные значения:

- `enable` — Включает вычисление с коротким замыканием для функций, для которых это целесообразно (функции, которые могут вызвать исключение или являются вычислительно затратными).
- `force_enable` — Включает вычисление с коротким замыканием для всех функций.
- `disable` — Отключает вычисление с коротким замыканием.


## short_circuit_function_evaluation_for_nulls {#short_circuit_function_evaluation_for_nulls}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.1" },
        { label: "1" },
        {
          label:
            "Разрешает выполнение функций с Nullable-аргументами только для строк, в которых все аргументы имеют не-NULL значения"
        }
      ]
    }
  ]}
/>

Оптимизирует вычисление функций, возвращающих NULL при наличии хотя бы одного NULL-аргумента. Когда доля значений NULL в аргументах функции превышает порог short_circuit_function_evaluation_for_nulls_threshold, система пропускает построчное вычисление функции и сразу возвращает NULL для всех строк, избегая ненужных вычислений.


## short_circuit_function_evaluation_for_nulls_threshold {#short_circuit_function_evaluation_for_nulls_threshold}

<SettingsInfoBlock type='Double' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.1" },
        { label: "1" },
        {
          label:
            "Пороговое значение доли NULL-значений для выполнения функций с Nullable-аргументами только на строках, где все аргументы имеют не-NULL значения. Применяется при включенной настройке short_circuit_function_evaluation_for_nulls."
        }
      ]
    }
  ]}
/>

Пороговое значение доли NULL-значений для выполнения функций с Nullable-аргументами только на строках, где все аргументы имеют не-NULL значения. Применяется при включенной настройке short_circuit_function_evaluation_for_nulls.
Когда доля строк, содержащих NULL-значения, от общего количества строк превышает этот порог, такие строки с NULL-значениями не будут вычисляться.


## show_data_lake_catalogs_in_system_tables {#show_data_lake_catalogs_in_system_tables}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "1" }, { label: "Новая настройка" }]
    },
    {
      id: "row-2",
      items: [
        { label: "25.10" },
        { label: "0" },
        { label: "Отключение каталогов в системных таблицах по умолчанию" }
      ]
    }
  ]}
/>

Включает отображение каталогов озера данных в системных таблицах.


## show_processlist_include_internal {#show_processlist_include_internal}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Отображать внутренние вспомогательные процессы в результатах запроса `SHOW PROCESSLIST`.

К внутренним процессам относятся перезагрузка словарей, обновление обновляемых материализованных представлений, вспомогательные запросы `SELECT`, выполняемые в запросах `SHOW ...`, вспомогательные запросы `CREATE DATABASE ...`, выполняемые внутренне для работы с поврежденными таблицами, и другие.


## show_table_uuid_in_table_create_query_if_not_nil {#show_table_uuid_in_table_create_query_if_not_nil}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "20.7" },
        { label: "0" },
        {
          label:
            "Прекращён вывод UUID таблицы в её запросе CREATE для Engine=Atomic"
        }
      ]
    }
  ]}
/>

Управляет отображением UUID таблицы в результате запроса `SHOW TABLE`.

Возможные значения:

- 0 — UUID таблицы не отображается в запросе.
- 1 — UUID таблицы отображается в запросе.


## single_join_prefer_left_table {#single_join_prefer_left_table}

<SettingsInfoBlock type='Bool' default_value='1' />

Для одиночного JOIN при неоднозначности идентификатора использовать левую таблицу


## skip_redundant_aliases_in_udf {#skip_redundant_aliases_in_udf}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.12" },
        { label: "0" },
        {
          label:
            "При включении позволяет использовать одну и ту же пользовательскую функцию несколько раз для нескольких материализованных столбцов в одной таблице."
        }
      ]
    }
  ]}
/>

Избыточные псевдонимы не используются (не подставляются) в пользовательских функциях для упрощения их использования.

Возможные значения:

- 1 — Псевдонимы пропускаются (подставляются) в пользовательских функциях.
- 0 — Псевдонимы не пропускаются (не подставляются) в пользовательских функциях.

**Пример**

Разница между включенным и выключенным состоянием:

Запрос:

```sql
SET skip_redundant_aliases_in_udf = 0;
CREATE FUNCTION IF NOT EXISTS test_03274 AS ( x ) -> ((x + 1 as y, y + 2));

EXPLAIN SYNTAX SELECT test_03274(4 + 2);
```

Результат:

```text
SELECT ((4 + 2) + 1 AS y, y + 2)
```

Запрос:

```sql
SET skip_redundant_aliases_in_udf = 1;
CREATE FUNCTION IF NOT EXISTS test_03274 AS ( x ) -> ((x + 1 as y, y + 2));

EXPLAIN SYNTAX SELECT test_03274(4 + 2);
```

Результат:

```text
SELECT ((4 + 2) + 1, ((4 + 2) + 1) + 2)
```


## skip_unavailable_shards {#skip_unavailable_shards}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает автоматический пропуск недоступных шардов.

Шард считается недоступным, если все его реплики недоступны. Реплика считается недоступной в следующих случаях:

- ClickHouse не может подключиться к реплике по какой-либо причине.

  При подключении к реплике ClickHouse выполняет несколько попыток. Если все попытки завершаются неудачей, реплика считается недоступной.

- Имя хоста реплики не разрешается через DNS.

  Если имя хоста реплики не разрешается через DNS, это может указывать на следующие ситуации:
  - У хоста реплики отсутствует DNS-запись. Это может происходить в системах с динамическим DNS, например [Kubernetes](https://kubernetes.io), где узлы могут быть недоступны для разрешения во время простоя, и это не является ошибкой.

  - Ошибка конфигурации. Конфигурационный файл ClickHouse содержит неверное имя хоста.

Возможные значения:

- 1 — пропуск включен.

  Если шард недоступен, ClickHouse возвращает результат на основе частичных данных и не сообщает о проблемах с доступностью узлов.

- 0 — пропуск отключен.

  Если шард недоступен, ClickHouse генерирует исключение.


## sleep_after_receiving_query_ms {#sleep_after_receiving_query_ms}

<SettingsInfoBlock type='Milliseconds' default_value='0' />

Время ожидания после получения запроса в TCPHandler


## sleep_in_send_data_ms {#sleep_in_send_data_ms}

<SettingsInfoBlock type='Milliseconds' default_value='0' />

Время задержки при отправке данных в TCPHandler


## sleep_in_send_tables_status_ms {#sleep_in_send_tables_status_ms}

<SettingsInfoBlock type='Milliseconds' default_value='0' />

Время задержки при отправке ответа о статусе таблиц в TCPHandler


## sort_overflow_mode {#sort_overflow_mode}

<SettingsInfoBlock type='OverflowMode' default_value='throw' />

Определяет поведение в случае, если количество строк, полученных перед сортировкой, превышает одно из ограничений.

Возможные значения:

- `throw`: выбросить исключение.
- `break`: прервать выполнение запроса и вернуть частичный результат.


## split_intersecting_parts_ranges_into_layers_final {#split_intersecting_parts_ranges_into_layers_final}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "1" },
        {
          label:
            "Разрешить разделение диапазонов пересекающихся кусков на слои при оптимизации FINAL"
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.1" },
        { label: "1" },
        {
          label:
            "Разрешить разделение диапазонов пересекающихся кусков на слои при оптимизации FINAL"
        }
      ]
    }
  ]}
/>

Разделение диапазонов пересекающихся кусков на слои при оптимизации FINAL


## split_parts_ranges_into_intersecting_and_non_intersecting_final {#split_parts_ranges_into_intersecting_and_non_intersecting_final}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.2" },
        { label: "1" },
        {
          label:
            "Разрешает разделение диапазонов кусков на пересекающиеся и непересекающиеся при оптимизации FINAL"
        }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.1" },
        { label: "1" },
        {
          label:
            "Разрешает разделение диапазонов кусков на пересекающиеся и непересекающиеся при оптимизации FINAL"
        }
      ]
    }
  ]}
/>

Разделяет диапазоны кусков на пересекающиеся и непересекающиеся при оптимизации FINAL


## splitby_max_substrings_includes_remaining_string {#splitby_max_substrings_includes_remaining_string}

<SettingsInfoBlock type='Bool' default_value='0' />

Определяет, будет ли функция [splitBy\*()](../../sql-reference/functions/splitting-merging-functions.md) с аргументом `max_substrings` > 0 включать остаток строки в последний элемент результирующего массива.

Возможные значения:

- `0` — Остаток строки не будет включён в последний элемент результирующего массива.
- `1` — Остаток строки будет включён в последний элемент результирующего массива. Это поведение соответствует функции [`split()`](https://spark.apache.org/docs/3.1.2/api/python/reference/api/pyspark.sql.functions.split.html) в Spark и методу ['string.split()'](https://docs.python.org/3/library/stdtypes.html#str.split) в Python.


## stop_refreshable_materialized_views_on_startup {#stop_refreshable_materialized_views_on_startup}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

При запуске сервера предотвращает планирование обновления материализованных представлений с автообновлением, как при выполнении команды SYSTEM STOP VIEWS. Вы можете вручную запустить их с помощью команд `SYSTEM START VIEWS` или `SYSTEM START VIEW <name>`. Также применяется к вновь создаваемым представлениям. Не влияет на материализованные представления без автообновления.


## storage_file_read_method {#storage_file_read_method}

<SettingsInfoBlock type='LocalFSReadMethod' default_value='pread' />

Метод чтения данных из файла хранилища. Возможные значения: `read`, `pread`, `mmap`. Метод mmap не применим к clickhouse-server (он предназначен для clickhouse-local).


## storage_system_stack_trace_pipe_read_timeout_ms {#storage_system_stack_trace_pipe_read_timeout_ms}

<SettingsInfoBlock type='Milliseconds' default_value='100' />

Максимальное время чтения из канала для получения информации от потоков при выполнении запроса к таблице `system.stack_trace`. Эта настройка используется для тестирования и не предназначена для изменения пользователями.


## stream_flush_interval_ms {#stream_flush_interval_ms}

<SettingsInfoBlock type='Milliseconds' default_value='7500' />

Применяется для таблиц с потоковой передачей данных при истечении времени ожидания или когда поток генерирует [max_insert_block_size](#max_insert_block_size) строк.

Значение по умолчанию: 7500.

Чем меньше значение, тем чаще происходит сброс данных в таблицу. Слишком низкое значение приводит к снижению производительности.


## stream_like_engine_allow_direct_select {#stream_like_engine_allow_direct_select}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "21.12" },
        { label: "0" },
        {
          label:
            "По умолчанию запрещены прямые SELECT-запросы для Kafka/RabbitMQ/FileLog"
        }
      ]
    }
  ]}
/>

Разрешает прямые SELECT-запросы для движков Kafka, RabbitMQ, FileLog, Redis Streams и NATS. Если к таблице подключены материализованные представления, SELECT-запросы запрещены, даже если эта настройка включена.


## stream_like_engine_insert_queue {#stream_like_engine_insert_queue}

Когда потоковый движок читает из нескольких очередей, пользователю необходимо выбрать одну очередь для вставки при записи. Используется движками Redis Streams и NATS.


## stream_poll_timeout_ms {#stream_poll_timeout_ms}

<SettingsInfoBlock type='Milliseconds' default_value='500' />

Таймаут опроса данных из потоковых хранилищ и записи в них.


## system_events_show_zero_values {#system_events_show_zero_values}

<SettingsInfoBlock type='Bool' default_value='0' />

Позволяет выбирать события с нулевыми значениями из [`system.events`](../../operations/system-tables/events.md).

Некоторые системы мониторинга требуют передачи им всех значений метрик на каждой контрольной точке, даже если значение метрики равно нулю.

Возможные значения:

- 0 — отключено.
- 1 — включено.

**Примеры**

Запрос

```sql
SELECT * FROM system.events WHERE event='QueryMemoryLimitExceeded';
```

Результат

```text
Ok.
```

Запрос

```sql
SET system_events_show_zero_values = 1;
SELECT * FROM system.events WHERE event='QueryMemoryLimitExceeded';
```

Результат

```text
┌─event────────────────────┬─value─┬─description───────────────────────────────────────────┐
│ QueryMemoryLimitExceeded │     0 │ Количество превышений лимита памяти для запроса. │
└──────────────────────────┴───────┴───────────────────────────────────────────────────────┘
```


## table_engine_read_through_distributed_cache {#table_engine_read_through_distributed_cache}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.7" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Разрешает чтение из распределённого кеша через движки таблиц и табличные функции (s3, azure и т. д.)


## table_function_remote_max_addresses {#table_function_remote_max_addresses}

<SettingsInfoBlock type='UInt64' default_value='1000' />

Задаёт максимальное количество адресов, генерируемых из шаблонов для функции [remote](../../sql-reference/table-functions/remote.md).

Возможные значения:

- Положительное целое число.


## tcp_keep_alive_timeout {#tcp_keep_alive_timeout}

<SettingsInfoBlock type='Seconds' default_value='290' />

Время в секундах, в течение которого соединение должно оставаться неактивным перед тем, как TCP начнёт отправлять keepalive-пробы


## temporary_data_in_cache_reserve_space_wait_lock_timeout_milliseconds {#temporary_data_in_cache_reserve_space_wait_lock_timeout_milliseconds}

<SettingsInfoBlock type='UInt64' default_value='600000' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.4" },
        { label: "600000" },
        {
          label:
            "Время ожидания блокировки кеша для резервирования места для временных данных в файловом кеше"
        }
      ]
    }
  ]}
/>

Время ожидания блокировки кеша для резервирования места для временных данных в файловом кеше


## temporary_files_buffer_size {#temporary_files_buffer_size}

<SettingsInfoBlock type='UInt64' default_value='1048576' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.10" },
        { label: "1048576" },
        { label: "Новая настройка" }
      ]
    }
  ]}
/>

Размер буфера для записи временных файлов. Больший размер буфера означает меньше системных вызовов, но большее потребление памяти.


## temporary_files_codec {#temporary_files_codec}

<SettingsInfoBlock type='String' default_value='LZ4' />

Задает кодек сжатия для временных файлов, используемых при операциях сортировки и соединения на диске.

Возможные значения:

- LZ4 — применяется сжатие [LZ4](<https://en.wikipedia.org/wiki/LZ4_(compression_algorithm)>).
- NONE — сжатие не применяется.


## text_index_use_bloom_filter {#text_index_use_bloom_filter}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "1" }, { label: "Новая настройка." }]
    }
  ]}
/>

Для целей тестирования включает или отключает использование фильтра Блума в текстовом индексе.


## throw_if_deduplication_in_dependent_materialized_views_enabled_with_async_insert {#throw_if_deduplication_in_dependent_materialized_views_enabled_with_async_insert}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "1" },
        {
          label:
            "Дедупликация в зависимых материализованных представлениях несовместима с асинхронными вставками."
        }
      ]
    }
  ]}
/>

Генерировать исключение при выполнении запроса INSERT, если настройка `deduplicate_blocks_in_dependent_materialized_views` включена одновременно с `async_insert`. Это гарантирует корректность работы, так как эти функции несовместимы.


## throw_if_no_data_to_insert {#throw_if_no_data_to_insert}

<SettingsInfoBlock type='Bool' default_value='1' />

Разрешает или запрещает пустые операции INSERT, по умолчанию включена (генерирует ошибку при попытке пустой вставки). Применяется только к операциям INSERT, выполняемым через [`clickhouse-client`](/interfaces/cli) или через [интерфейс gRPC](/interfaces/grpc).


## throw_on_error_from_cache_on_write_operations {#throw_on_error_from_cache_on_write_operations}

<SettingsInfoBlock type='Bool' default_value='0' />

Игнорировать ошибки кэша при кэшировании во время операций записи (INSERT, слияния)


## throw_on_max_partitions_per_insert_block {#throw_on_max_partitions_per_insert_block}

<SettingsInfoBlock type='Bool' default_value='1' />

Позволяет управлять поведением при достижении `max_partitions_per_insert_block`.

Возможные значения:

- `true` — При достижении блоком вставки значения `max_partitions_per_insert_block` возникает исключение.
- `false` — При достижении `max_partitions_per_insert_block` в лог записывается предупреждение.

:::tip
Это может быть полезно при анализе влияния на пользователей при изменении [`max_partitions_per_insert_block`](/operations/settings/settings#max_partitions_per_insert_block).
:::


## throw_on_unsupported_query_inside_transaction {#throw_on_unsupported_query_inside_transaction}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='1' />

Выбрасывать исключение, если внутри транзакции используется неподдерживаемый запрос


## timeout_before_checking_execution_speed {#timeout_before_checking_execution_speed}

<SettingsInfoBlock type='Seconds' default_value='10' />

Проверяет, что скорость выполнения не слишком низкая (не менее `min_execution_speed`),
по истечении указанного времени в секундах.


## timeout_overflow_mode {#timeout_overflow_mode}

<SettingsInfoBlock type='OverflowMode' default_value='throw' />

Определяет действие, если запрос выполняется дольше, чем `max_execution_time`, или расчётное время выполнения превышает `max_estimated_execution_time`.

Возможные значения:

- `throw`: выбросить исключение (по умолчанию).
- `break`: остановить выполнение запроса и вернуть частичный результат, как если бы исходные данные закончились.


## timeout_overflow_mode_leaf {#timeout_overflow_mode_leaf}

<SettingsInfoBlock type='OverflowMode' default_value='throw' />

Определяет поведение при превышении времени выполнения запроса на конечном узле, заданного параметром `max_execution_time_leaf`.

Возможные значения:

- `throw` — выбросить исключение (по умолчанию).
- `break` — остановить выполнение запроса и вернуть частичный результат, как если бы исходные данные закончились.


## totals_auto_threshold {#totals_auto_threshold}

<SettingsInfoBlock type='Float' default_value='0.5' />

Пороговое значение для `totals_mode = 'auto'`.
См. раздел «Модификатор WITH TOTALS».


## totals_mode {#totals_mode}

<SettingsInfoBlock type='TotalsMode' default_value='after_having_exclusive' />

Определяет способ вычисления TOTALS при наличии HAVING, а также при наличии max_rows_to_group_by и group_by_overflow_mode = 'any'.
См. раздел «Модификатор WITH TOTALS».


## trace_profile_events {#trace_profile_events}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает или отключает сбор трассировок стека при каждом обновлении событий профилирования вместе с именем события и значением приращения, а также их отправку в [trace_log](/operations/system-tables/trace_log).

Возможные значения:

- 1 — трассировка событий профилирования включена.
- 0 — трассировка событий профилирования отключена.


## transfer_overflow_mode {#transfer_overflow_mode}

<SettingsInfoBlock type='OverflowMode' default_value='throw' />

Определяет поведение при превышении объема данных одного из ограничений.

Возможные значения:

- `throw`: вызвать исключение (по умолчанию).
- `break`: прервать выполнение запроса и вернуть частичный результат, как если бы исходные данные закончились.


## transform_null_in {#transform_null_in}

<SettingsInfoBlock type='Bool' default_value='0' />

Включает равенство значений [NULL](/sql-reference/syntax#null) для оператора [IN](../../sql-reference/operators/in.md).

По умолчанию значения `NULL` не могут сравниваться, так как `NULL` означает неопределённое значение. Таким образом, сравнение `expr = NULL` всегда должно возвращать `false`. При включении этой настройки `NULL = NULL` возвращает `true` для оператора `IN`.

Возможные значения:

- 0 — Сравнение значений `NULL` в операторе `IN` возвращает `false`.
- 1 — Сравнение значений `NULL` в операторе `IN` возвращает `true`.

**Пример**

Рассмотрим таблицу `null_in`:

```text
┌──idx─┬─────i─┐
│    1 │     1 │
│    2 │  NULL │
│    3 │     3 │
└──────┴───────┘
```

Запрос:

```sql
SELECT idx, i FROM null_in WHERE i IN (1, NULL) SETTINGS transform_null_in = 0;
```

Результат:

```text
┌──idx─┬────i─┐
│    1 │    1 │
└──────┴──────┘
```

Запрос:

```sql
SELECT idx, i FROM null_in WHERE i IN (1, NULL) SETTINGS transform_null_in = 1;
```

Результат:

```text
┌──idx─┬─────i─┐
│    1 │     1 │
│    2 │  NULL │
└──────┴───────┘
```

**См. также**

- [Обработка NULL в операторах IN](/sql-reference/operators/in#null-processing)


## traverse_shadow_remote_data_paths {#traverse_shadow_remote_data_paths}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "0" },
        {
          label:
            "Обходить теневой каталог при запросе system.remote_data_paths."
        }
      ]
    }
  ]}
/>

Обходить замороженные данные (теневой каталог) в дополнение к актуальным данным таблицы при запросе system.remote_data_paths


## union_default_mode {#union_default_mode}

Устанавливает режим объединения результатов запросов `SELECT`. Настройка используется только при использовании с [UNION](../../sql-reference/statements/select/union.md) без явного указания `UNION ALL` или `UNION DISTINCT`.

Возможные значения:

- `'DISTINCT'` — ClickHouse выводит строки как результат объединения запросов с удалением дубликатов.
- `'ALL'` — ClickHouse выводит все строки как результат объединения запросов, включая дубликаты.
- `''` — ClickHouse генерирует исключение при использовании с `UNION`.

См. примеры в разделе [UNION](../../sql-reference/statements/select/union.md).


## unknown_packet_in_send_data {#unknown_packet_in_send_data}

<SettingsInfoBlock type='UInt64' default_value='0' />

Отправлять неизвестный пакет вместо N-го пакета данных


## update_parallel_mode {#update_parallel_mode}

<SettingsInfoBlock type='UpdateParallelMode' default_value='auto' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.5" }, { label: "auto" }, { label: "Новая настройка" }]
    }
  ]}
/>

Определяет поведение одновременно выполняемых запросов UPDATE.

Возможные значения:

- `sync` — выполнять все запросы `UPDATE` последовательно.
- `auto` — выполнять последовательно только те запросы `UPDATE`, между которыми существуют зависимости по столбцам: когда столбцы, обновляемые в одном запросе, используются в выражениях другого запроса.
- `async` — не синхронизировать запросы UPDATE.


## update_sequential_consistency {#update_sequential_consistency}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.5" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Если значение true, набор частей обновляется до последней версии перед выполнением обновления.


## use_async_executor_for_materialized_views {#use_async_executor_for_materialized_views}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "24.12" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Использовать асинхронное и потенциально многопоточное выполнение запросов материализованных представлений. Может ускорить обработку представлений во время INSERT, но также потребляет больше памяти.


## use_cache_for_count_from_files {#use_cache_for_count_from_files}

<SettingsInfoBlock type='Bool' default_value='1' />

Включает кэширование количества строк при подсчёте из файлов в табличных функциях `file`/`s3`/`url`/`hdfs`/`azureBlobStorage`.

Включено по умолчанию.


## use_client_time_zone {#use_client_time_zone}

<SettingsInfoBlock type='Bool' default_value='0' />

Использовать часовой пояс клиента для интерпретации строковых значений DateTime вместо часового пояса сервера.


## use_compact_format_in_distributed_parts_names {#use_compact_format_in_distributed_parts_names}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "21.1" },
        { label: "1" },
        {
          label:
            "По умолчанию использовать компактный формат для асинхронных INSERT в таблицы Distributed"
        }
      ]
    }
  ]}
/>

Использует компактный формат для хранения блоков при фоновых (`distributed_foreground_insert`) операциях INSERT в таблицы с движком `Distributed`.

Возможные значения:

- 0 — Использует формат каталога `user[:password]@host:port#default_database`.
- 1 — Использует формат каталога `[shard{shard_index}[_replica{replica_index}]]`.

:::note

- при `use_compact_format_in_distributed_parts_names=0` изменения в определении кластера не будут применяться для фоновых операций INSERT.
- при `use_compact_format_in_distributed_parts_names=1` изменение порядка узлов в определении кластера приведет к изменению `shard_index`/`replica_index`, учитывайте это.
  :::


## use_concurrency_control {#use_concurrency_control}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.12" },
        { label: "1" },
        { label: "Включить управление параллелизмом по умолчанию" }
      ]
    }
  ]}
/>

Соблюдать управление параллелизмом сервера (см. глобальные настройки сервера `concurrent_threads_soft_limit_num` и `concurrent_threads_soft_limit_ratio_to_cores`). При отключении позволяет использовать большее количество потоков, даже если сервер перегружен (не рекомендуется для обычного использования, необходимо в основном для тестов).


## use_hedged_requests {#use_hedged_requests}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "21.9" },
        { label: "1" },
        { label: "Функция хеджированных запросов включена по умолчанию" }
      ]
    }
  ]}
/>

Включает логику хеджированных запросов для удалённых запросов. Позволяет устанавливать несколько соединений с различными репликами для одного запроса.
Новое соединение устанавливается, если существующие соединения с репликами не были установлены в течение `hedged_connection_timeout`
или данные не были получены в течение `receive_data_timeout`. Запрос использует первое соединение, отправившее непустой пакет прогресса (или пакет данных, если установлен параметр `allow_changing_replica_until_first_data_packet`);
остальные соединения отменяются. Поддерживаются запросы с `max_parallel_replicas > 1`.

Включено по умолчанию.

Значение по умолчанию в Cloud: `1`


## use_hive_partitioning {#use_hive_partitioning}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.1" },
        { label: "1" },
        { label: "Настройка включена по умолчанию." }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "24.8" },
        { label: "0" },
        {
          label:
            "Позволяет использовать партиционирование в стиле Hive для движков File, URL, S3, AzureBlobStorage и HDFS."
        }
      ]
    }
  ]}
/>

При включении данной настройки ClickHouse будет автоматически определять партиционирование в стиле Hive в путях (`/name=value/`) для файловых движков таблиц [File](/sql-reference/table-functions/file#hive-style-partitioning)/[S3](/sql-reference/table-functions/s3#hive-style-partitioning)/[URL](/sql-reference/table-functions/url#hive-style-partitioning)/[HDFS](/sql-reference/table-functions/hdfs#hive-style-partitioning)/[AzureBlobStorage](/sql-reference/table-functions/azureBlobStorage#hive-style-partitioning) и позволит использовать столбцы партиций в качестве виртуальных столбцов в запросах. Эти виртуальные столбцы будут иметь те же имена, что и в партиционированном пути, но с префиксом `_`.


## use_iceberg_metadata_files_cache {#use_iceberg_metadata_files_cache}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.4" }, { label: "1" }, { label: "Новая настройка" }]
    }
  ]}
/>

Если включено, табличная функция iceberg и движок таблиц iceberg могут использовать кэш файлов метаданных iceberg.

Возможные значения:

- 0 — отключено
- 1 — включено


## use_iceberg_partition_pruning {#use_iceberg_partition_pruning}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "1" },
        { label: "Включить отсечение партиций Iceberg по умолчанию." }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "25.1" },
        { label: "0" },
        { label: "Новая настройка для отсечения партиций Iceberg." }
      ]
    }
  ]}
/>

Использовать отсечение партиций Iceberg для таблиц Iceberg.


## use_index_for_in_with_subqueries {#use_index_for_in_with_subqueries}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать индекс, если справа от оператора IN находится подзапрос или табличное выражение.


## use_index_for_in_with_subqueries_max_values {#use_index_for_in_with_subqueries_max_values}

<SettingsInfoBlock type='UInt64' default_value='0' />

Максимальный размер множества в правой части оператора IN для использования индекса таблицы при фильтрации. Позволяет избежать снижения производительности и повышенного использования памяти из-за подготовки дополнительных структур данных для больших запросов. Значение 0 означает отсутствие ограничения.


## use_join_disjunctions_push_down {#use_join_disjunctions_push_down}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.10" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Включает проталкивание частей условий JOIN, соединённых через OR, к соответствующим входным сторонам («частичное проталкивание»).
Это позволяет движкам хранения выполнять фильтрацию на более ранней стадии, что может сократить объём считываемых данных.
Оптимизация сохраняет семантику и применяется только в том случае, когда каждая ветвь OR верхнего уровня содержит хотя бы один детерминированный предикат для целевой стороны.


## use_legacy_to_time {#use_legacy_to_time}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "1" },
        {
          label:
            "Новая настройка. Позволяет использовать старую логику функции toTime, которая работает как toTimeWithFixedDate."
        }
      ]
    }
  ]}
/>

При включении позволяет использовать устаревшую функцию toTime, которая преобразует дату со временем в определённую фиксированную дату, сохраняя при этом время.
В противном случае используется новая функция toTime, которая преобразует различные типы данных в тип Time.
Старая устаревшая функция также доступна без ограничений как toTimeWithFixedDate.


## use_page_cache_for_disks_without_file_cache {#use_page_cache_for_disks_without_file_cache}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.3" },
        { label: "0" },
        { label: "Добавлен кеш страниц в пространстве пользователя" }
      ]
    }
  ]}
/>

Использовать кеш страниц в пространстве пользователя для удалённых дисков, для которых не включён кеш файловой системы.


## use_page_cache_with_distributed_cache {#use_page_cache_with_distributed_cache}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.3" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Использовать кеш страниц в пространстве пользователя при использовании распределённого кеша.


## use_paimon_partition_pruning {#use_paimon_partition_pruning}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Использовать отсечение партиций Paimon для табличных функций Paimon


## use_query_cache {#use_query_cache}

<SettingsInfoBlock type='Bool' default_value='0' />

При включении запросы `SELECT` могут использовать [кеш запросов](../query-cache.md). Параметры [enable_reads_from_query_cache](#enable_reads_from_query_cache)
и [enable_writes_to_query_cache](#enable_writes_to_query_cache) обеспечивают более детальное управление использованием кеша.

Возможные значения:

- 0 — Отключено
- 1 — Включено


## use_query_condition_cache {#use_query_condition_cache}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.4" },
        { label: "1" },
        { label: "Новая оптимизация" }
      ]
    },
    {
      id: "row-2",
      items: [{ label: "25.3" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Включает [кэш условий запроса](/operations/query-condition-cache). Кэш сохраняет диапазоны гранул в частях данных, которые не удовлетворяют условию в секции `WHERE`,
и использует эту информацию повторно в качестве эфемерного индекса для последующих запросов.

Возможные значения:

- 0 — отключено
- 1 — включено


## use_roaring_bitmap_iceberg_positional_deletes {#use_roaring_bitmap_iceberg_positional_deletes}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Использовать roaring bitmap для позиционных удалений Iceberg.


## use_skip_indexes {#use_skip_indexes}

<SettingsInfoBlock type='Bool' default_value='1' />

Использовать индексы пропуска данных при выполнении запроса.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.


## use_skip_indexes_if_final {#use_skip_indexes_if_final}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "1" },
        { label: "Изменение значения по умолчанию" }
      ]
    }
  ]}
/>

Управляет применением индексов пропуска при выполнении запросов с модификатором FINAL.

Индексы пропуска могут исключать строки (гранулы), содержащие актуальные данные, что может привести к некорректным результатам запроса с модификатором FINAL. При включении этой настройки индексы пропуска применяются даже с модификатором FINAL, что потенциально повышает производительность, но создаёт риск пропуска последних обновлений. Эту настройку следует включать совместно с настройкой use_skip_indexes_if_final_exact_mode (по умолчанию включена).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.


## use_skip_indexes_if_final_exact_mode {#use_skip_indexes_if_final_exact_mode}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.6" },
        { label: "1" },
        { label: "Изменение значения настройки по умолчанию" }
      ]
    },
    {
      id: "row-2",
      items: [
        { label: "25.5" },
        { label: "0" },
        {
          label:
            "Настройка введена для обеспечения корректных результатов запросов с FINAL при использовании индексов пропуска"
        }
      ]
    }
  ]}
/>

Управляет расширением гранул, возвращаемых индексом пропуска, в более новых частях для получения корректных результатов при выполнении запросов с модификатором FINAL.

Использование индексов пропуска может исключить строки (гранулы), содержащие актуальные данные, что приведет к некорректным результатам. Данная настройка обеспечивает возврат корректных результатов путем сканирования более новых частей, пересекающихся с диапазонами, возвращаемыми индексом пропуска. Отключать эту настройку следует только в том случае, если приложение допускает приблизительные результаты на основе поиска по индексу пропуска.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.


## use_skip_indexes_on_data_read {#use_skip_indexes_on_data_read}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.9" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Включает использование индексов пропуска данных при чтении данных.

При включении индексы пропуска вычисляются динамически в момент чтения каждой гранулы данных, а не анализируются заранее до начала выполнения запроса. Это может уменьшить задержку запуска запроса.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.


## use_statistics_cache {#use_statistics_cache}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Использовать кэш статистики в запросе для предотвращения накладных расходов на загрузку статистики каждой части


## use_structure_from_insertion_table_in_table_functions {#use_structure_from_insertion_table_in_table_functions}

<SettingsInfoBlock type='UInt64' default_value='2' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "22.11" },
        { label: "2" },
        {
          label:
            "Улучшено использование структуры из таблицы назначения в табличных функциях"
        }
      ]
    }
  ]}
/>

Использовать структуру из таблицы назначения вместо автоматического определения схемы из данных. Возможные значения: 0 — отключено, 1 — включено, 2 — автоматически


## use_text_index_dictionary_cache {#use_text_index_dictionary_cache}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Определяет, использовать ли кэш десериализованных блоков словаря текстового индекса.
Использование кэша блоков словаря текстового индекса может значительно снизить задержки и повысить пропускную способность при работе с большим количеством запросов к текстовым индексам.


## use_text_index_header_cache {#use_text_index_header_cache}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Определяет, использовать ли кэш десериализованных заголовков текстовых индексов.
Использование кэша заголовков текстовых индексов может значительно сократить задержки и повысить пропускную способность при работе с большим количеством запросов к текстовым индексам.


## use_text_index_postings_cache {#use_text_index_postings_cache}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.11" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Определяет, использовать ли кэш десериализованных списков постингов текстового индекса.
Использование кэша постингов текстового индекса может существенно снизить задержку и повысить пропускную способность при работе с большим количеством запросов к текстовым индексам.


## use_uncompressed_cache {#use_uncompressed_cache}

<SettingsInfoBlock type='Bool' default_value='0' />

Использовать ли кэш несжатых блоков. Принимает значения 0 или 1. По умолчанию 0 (отключено).
Использование кэша несжатых блоков (только для таблиц семейства MergeTree) может значительно снизить задержку и повысить пропускную способность при работе с большим количеством коротких запросов. Включите эту настройку для пользователей, отправляющих частые короткие запросы. Также обратите внимание на конфигурационный параметр [uncompressed_cache_size](/operations/server-configuration-parameters/settings#uncompressed_cache_size) (задается только в конфигурационном файле) — размер блоков кэша несжатых данных. По умолчанию составляет 8 ГиБ. Кэш несжатых блоков заполняется по мере необходимости, наименее используемые данные автоматически удаляются.

Для запросов, читающих достаточно большой объем данных (один миллион строк или более), кэш несжатых блоков автоматически отключается, чтобы освободить место для действительно небольших запросов. Это означает, что настройку 'use_uncompressed_cache' можно всегда держать установленной в значение 1.


## use_variant_as_common_type {#use_variant_as_common_type}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.1" },
        { label: "0" },
        {
          label: "Разрешено использование Variant в if/multiIf при отсутствии общего типа"
        }
      ]
    }
  ]}
/>

Позволяет использовать тип `Variant` в качестве результирующего типа для функций [if](../../sql-reference/functions/conditional-functions.md/#if)/[multiIf](../../sql-reference/functions/conditional-functions.md/#multiIf)/[array](../../sql-reference/functions/array-functions.md)/[map](../../sql-reference/functions/tuple-map-functions.md), когда для типов аргументов отсутствует общий тип.

Пример:

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(if(number % 2, number, range(number))) as variant_type FROM numbers(1);
SELECT if(number % 2, number, range(number)) as variant FROM numbers(5);
```

```text
┌─variant_type───────────────────┐
│ Variant(Array(UInt64), UInt64) │
└────────────────────────────────┘
┌─variant───┐
│ []        │
│ 1         │
│ [0,1]     │
│ 3         │
│ [0,1,2,3] │
└───────────┘
```

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(multiIf((number % 4) = 0, 42, (number % 4) = 1, [1, 2, 3], (number % 4) = 2, 'Hello, World!', NULL)) AS variant_type FROM numbers(1);
SELECT multiIf((number % 4) = 0, 42, (number % 4) = 1, [1, 2, 3], (number % 4) = 2, 'Hello, World!', NULL) AS variant FROM numbers(4);
```

```text
─variant_type─────────────────────────┐
│ Variant(Array(UInt8), String, UInt8) │
└──────────────────────────────────────┘

┌─variant───────┐
│ 42            │
│ [1,2,3]       │
│ Hello, World! │
│ ᴺᵁᴸᴸ          │
└───────────────┘
```

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(array(range(number), number, 'str_' || toString(number))) as array_of_variants_type from numbers(1);
SELECT array(range(number), number, 'str_' || toString(number)) as array_of_variants FROM numbers(3);
```

```text
┌─array_of_variants_type────────────────────────┐
│ Array(Variant(Array(UInt64), String, UInt64)) │
└───────────────────────────────────────────────┘

┌─array_of_variants─┐
│ [[],0,'str_0']    │
│ [[0],1,'str_1']   │
│ [[0,1],2,'str_2'] │
└───────────────────┘
```

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(map('a', range(number), 'b', number, 'c', 'str_' || toString(number))) as map_of_variants_type from numbers(1);
SELECT map('a', range(number), 'b', number, 'c', 'str_' || toString(number)) as map_of_variants FROM numbers(3);
```

```text
┌─map_of_variants_type────────────────────────────────┐
│ Map(String, Variant(Array(UInt64), String, UInt64)) │
└─────────────────────────────────────────────────────┘

┌─map_of_variants───────────────┐
│ {'a':[],'b':0,'c':'str_0'}    │
│ {'a':[0],'b':1,'c':'str_1'}   │
│ {'a':[0,1],'b':2,'c':'str_2'} │
└───────────────────────────────┘
```


## use_with_fill_by_sorting_prefix {#use_with_fill_by_sorting_prefix}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "23.5" },
        { label: "1" },
        {
          label:
            "Столбцы, расположенные перед столбцами WITH FILL в предложении ORDER BY, формируют префикс сортировки. Строки с разными значениями в префиксе сортировки заполняются независимо друг от друга"
        }
      ]
    }
  ]}
/>

Столбцы, расположенные перед столбцами WITH FILL в предложении ORDER BY, формируют префикс сортировки. Строки с разными значениями в префиксе сортировки заполняются независимо друг от друга


## validate_enum_literals_in_operators {#validate_enum_literals_in_operators}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.1" }, { label: "0" }, { label: "Новая настройка" }]
    }
  ]}
/>

Если включено, выполняется проверка литералов перечислений в операторах `IN`, `NOT IN`, `==`, `!=` на соответствие типу перечисления, и генерируется исключение, если литерал не является допустимым значением перечисления.


## validate_mutation_query {#validate_mutation_query}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.11" },
        { label: "1" },
        { label: "Новая настройка для проверки запросов мутации по умолчанию." }
      ]
    }
  ]}
/>

Проверять запросы мутации перед их принятием. Мутации выполняются в фоновом режиме, и выполнение некорректного запроса приведёт к зависанию мутаций, что потребует ручного вмешательства.

Изменяйте эту настройку только при обнаружении ошибки, нарушающей обратную совместимость.


## validate_polygons {#validate_polygons}

<SettingsInfoBlock type='Bool' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "20.4" },
        { label: "1" },
        {
          label:
            "По умолчанию выбрасывается исключение, если полигон некорректен в функции pointInPolygon, вместо возврата потенциально неверных результатов"
        }
      ]
    }
  ]}
/>

Включает или отключает выброс исключения в функции [pointInPolygon](/sql-reference/functions/geo/coordinates#pointinpolygon), если полигон самопересекающийся или самокасающийся.

Возможные значения:

- 0 — Выброс исключения отключен. `pointInPolygon` принимает некорректные полигоны и возвращает потенциально неверные результаты.
- 1 — Выброс исключения включен.


## vector_search_filter_strategy {#vector_search_filter_strategy}

<SettingsInfoBlock type='VectorSearchFilterStrategy' default_value='auto' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.5" }, { label: "auto" }, { label: "Новая настройка" }]
    }
  ]}
/>

Если запрос векторного поиска содержит условие WHERE, эта настройка определяет, что выполняется первым: оценка условия (префильтрация) или проверка индекса векторного сходства (постфильтрация). Возможные значения:

- 'auto' - Постфильтрация (точная семантика может измениться в будущем).
- 'postfilter' - Использование индекса векторного сходства для определения ближайших соседей с последующим применением остальных фильтров
- 'prefilter' - Сначала применяются остальные фильтры, затем выполняется полный перебор для определения соседей.


## vector_search_index_fetch_multiplier {#vector_search_index_fetch_multiplier}

**Псевдонимы**: `vector_search_postfilter_multiplier`

<SettingsInfoBlock type='Float' default_value='1' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "25.8" },
        { label: "1" },
        { label: "Псевдоним для настройки 'vector_search_postfilter_multiplier'" }
      ]
    }
  ]}
/>

Умножает количество извлекаемых ближайших соседей из индекса векторного сходства на указанное число. Применяется только при постфильтрации с другими предикатами или если настройка 'vector_search_with_rescoring = 1'.


## vector_search_with_rescoring {#vector_search_with_rescoring}

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Определяет, выполняет ли ClickHouse повторное ранжирование для запросов, использующих индекс векторного сходства.
Без повторного ранжирования индекс векторного сходства возвращает строки с наилучшими совпадениями напрямую.
При повторном ранжировании строки экстраполируются до уровня гранулы, и все строки в грануле проверяются заново.
В большинстве случаев повторное ранжирование лишь незначительно повышает точность, но при этом существенно снижает производительность запросов векторного поиска.
Примечание: запрос, выполняемый без повторного ранжирования и с включёнными параллельными репликами, может переключиться на повторное ранжирование.


## wait_changes_become_visible_after_commit_mode {#wait_changes_become_visible_after_commit_mode}

<ExperimentalBadge />

<SettingsInfoBlock
  type='TransactionsWaitCSNMode'
  default_value='wait_unknown'
/>

Ожидать, пока зафиксированные изменения станут видимыми в последнем снимке состояния


## wait_for_async_insert {#wait_for_async_insert}

<SettingsInfoBlock type='Bool' default_value='1' />

Если true, ожидать завершения обработки асинхронной вставки


## wait_for_async_insert_timeout {#wait_for_async_insert_timeout}

<SettingsInfoBlock type='Seconds' default_value='120' />

Время ожидания обработки асинхронной вставки


## wait_for_window_view_fire_signal_timeout {#wait_for_window_view_fire_signal_timeout}

<ExperimentalBadge />

<SettingsInfoBlock type='Seconds' default_value='10' />

Таймаут ожидания сигнала запуска оконного представления при обработке событийного времени


## window_view_clean_interval {#window_view_clean_interval}

<ExperimentalBadge />

<SettingsInfoBlock type='Seconds' default_value='60' />

Интервал очистки window view в секундах для удаления устаревших данных.


## window_view_heartbeat_interval {#window_view_heartbeat_interval}

<ExperimentalBadge />

<SettingsInfoBlock type='Seconds' default_value='15' />

Интервал отправки контрольного сигнала в секундах для индикации активности запроса watch.


## workload {#workload}

<SettingsInfoBlock type='String' default_value='default' />

Имя рабочей нагрузки для доступа к ресурсам


## write_full_path_in_iceberg_metadata {#write_full_path_in_iceberg_metadata}

<ExperimentalBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.8" }, { label: "0" }, { label: "Новая настройка." }]
    }
  ]}
/>

Записывать полные пути (включая s3://) в файлы метаданных Iceberg.


## write_through_distributed_cache {#write_through_distributed_cache}

<CloudOnlyBadge />

<SettingsInfoBlock type='Bool' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [
        { label: "24.10" },
        { label: "0" },
        { label: "Настройка для ClickHouse Cloud" }
      ]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Разрешает запись в распределённый кеш (запись в S3 также будет выполняться через распределённый кеш)


## write_through_distributed_cache_buffer_size {#write_through_distributed_cache_buffer_size}

<CloudOnlyBadge />

<SettingsInfoBlock type='UInt64' default_value='0' />

<VersionHistory
  rows={[
    {
      id: "row-1",
      items: [{ label: "25.7" }, { label: "0" }, { label: "Новая настройка Cloud" }]
    }
  ]}
/>

Действует только в ClickHouse Cloud. Задаёт размер буфера для распределённого кеша со сквозной записью. Если значение равно 0, будет использован размер буфера, который использовался бы при отсутствии распределённого кеша.


## zstd_window_log_max {#zstd_window_log_max}

<SettingsInfoBlock type='Int64' default_value='0' />

Позволяет задать максимальное значение window log для ZSTD (не применяется к движкам семейства MergeTree)
