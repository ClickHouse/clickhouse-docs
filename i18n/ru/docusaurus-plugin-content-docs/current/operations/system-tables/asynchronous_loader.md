---
description: 'Системная таблица, содержащая информацию о состоянии недавних асинхронных
  заданий (например, для таблиц, которые в данный момент загружаются). Таблица содержит по одной строке на каждое задание.'
keywords: ['системная таблица', 'asynchronous_loader']
slug: /operations/system-tables/asynchronous_loader
title: 'system.asynchronous_loader'
doc_type: 'reference'
---

import SystemTableCloud from '@site/docs/_snippets/_system_table_cloud.md';


# system.asynchronous_loader

<SystemTableCloud />

Содержит информацию и статус последних асинхронных заданий (например, для загрузки таблиц). Таблица содержит по одной строке для каждого задания. Для визуализации информации из этой таблицы существует инструмент `utils/async_loader_graph`.

Пример:

```sql
SELECT *
FROM system.asynchronous_loader
LIMIT 1
FORMAT Vertical
```

Столбцы:

<!--AUTOGENERATED_START-->

- `job` ([String](../../sql-reference/data-types/)) — Имя задания (может быть не уникальным).
- `job_id` ([UInt64](../../sql-reference/data-types/)) — Уникальный идентификатор задания.
- `dependencies` ([Array(UInt64)](../../sql-reference/data-types/)) — Список идентификаторов заданий, которые должны быть выполнены перед данным заданием.
- `dependencies_left` ([UInt64](../../sql-reference/data-types/)) — Текущее количество невыполненных зависимостей.
- `status` ([Enum8('PENDING' = 0, 'OK' = 1, 'FAILED' = 2, 'CANCELED' = 3)](../../sql-reference/data-types/)) — Текущий статус загрузки задания: PENDING: задание загрузки еще не запущено. OK: задание загрузки выполнено успешно. FAILED: задание загрузки завершилось с ошибкой. CANCELED: задание загрузки не будет выполнено из-за удаления или сбоя зависимости.
- `is_executing` ([UInt8](../../sql-reference/data-types/)) — Задание в данный момент выполняется рабочим потоком.
- `is_blocked` ([UInt8](../../sql-reference/data-types/)) — Задание ожидает завершения своих зависимостей.
- `is_ready` ([UInt8](../../sql-reference/data-types/)) — Задание готово к выполнению и ожидает рабочий поток.
- `elapsed` ([Float64](../../sql-reference/data-types/)) — Количество секунд, прошедших с начала выполнения. Ноль, если задание не запущено. Общее время выполнения, если задание завершено.
- `pool_id` ([UInt64](../../sql-reference/data-types/)) — Идентификатор пула, назначенного заданию в данный момент.
- `pool` ([String](../../sql-reference/data-types/)) — Имя пула `pool_id`.
- `priority` ([Int64](../../sql-reference/data-types/)) — Приоритет пула `pool_id`.
- `execution_pool_id` ([UInt64](../../sql-reference/data-types/)) — Идентификатор пула, в котором выполняется задание. Равен изначально назначенному пулу до начала выполнения.
- `execution_pool` ([String](../../sql-reference/data-types/)) — Имя пула `execution_pool_id`.
- `execution_priority` ([Int64](../../sql-reference/data-types/)) — Приоритет пула `execution_pool_id`.
- `ready_seqno` ([Nullable(UInt64)](../../sql-reference/data-types/)) — Не NULL для готовых заданий. Рабочий поток извлекает следующее задание для выполнения из очереди готовых заданий своего пула. Если имеется несколько готовых заданий, выбирается задание с наименьшим значением `ready_seqno`.
- `waiters` ([UInt64](../../sql-reference/data-types/)) — Количество потоков, ожидающих данное задание.
- `exception` ([Nullable(String)](../../sql-reference/data-types/)) — Не NULL для завершившихся с ошибкой и отмененных заданий. Содержит сообщение об ошибке, возникшей во время выполнения запроса, или ошибку, приведшую к отмене данного задания, вместе с цепочкой сбоев зависимостей с именами заданий.
- `schedule_time` ([DateTime64(6)](../../sql-reference/data-types/)) — Время создания задания и планирования его выполнения (обычно со всеми его зависимостями).
- `enqueue_time` ([Nullable(DateTime64(6))](../../sql-reference/data-types/)) — Время, когда задание стало готовым и было помещено в очередь готовых заданий своего пула. NULL, если задание еще не готово.
- `start_time` ([Nullable(DateTime64(6))](../../sql-reference/data-types/)) — Время, когда рабочий поток извлекает задание из очереди готовых заданий и начинает его выполнение. NULL, если задание еще не запущено.
- `finish_time` ([Nullable(DateTime64(6))](../../sql-reference/data-types/)) — Время завершения выполнения задания. NULL, если задание еще не завершено.
<!--AUTOGENERATED_END-->

Ожидающее задание может находиться в одном из следующих состояний:

- `is_executing` (`UInt8`) — Задание в данный момент выполняется рабочим потоком.
- `is_blocked` (`UInt8`) — Задание ожидает завершения своих зависимостей.
- `is_ready` (`UInt8`) — Задание готово к выполнению и ожидает рабочий поток.
- `elapsed` (`Float64`) — Количество секунд, прошедших с начала выполнения. Ноль, если задание не запущено. Общее время выполнения, если задание завершено.


Каждая задача привязана к пулу и запускается в этом пуле. Каждый пул имеет фиксированный приоритет и изменяемое максимальное число рабочих потоков. Задачи с более высоким приоритетом (меньшее значение `priority`) выполняются первыми. Ни одна задача с более низким приоритетом не запускается, пока существует хотя бы одна задача с более высоким приоритетом, готовая к выполнению или выполняющаяся. Приоритет задачи может быть повышен (но не может быть понижен) путём повышения её приоритета. Например, задачи загрузки и инициализации таблицы будут повышены в приоритете, если входящий запрос требует эту таблицу. Можно повысить приоритет задачи и во время её выполнения, но задача не переносится из своего `execution_pool` во вновь назначенный `pool`. Для создания новых задач используется `pool` задачи, чтобы избежать инверсии приоритетов. Уже запущенные задачи не вытесняются задачами с более высоким приоритетом и всегда выполняются до завершения после старта.
- `pool_id` (`UInt64`) - ID пула, который в данный момент назначен задаче.
- `pool` (`String`) - Имя пула `pool_id`.
- `priority` (`Int64`) - Приоритет пула `pool_id`.
- `execution_pool_id` (`UInt64`) - ID пула, в котором выполняется задача. Совпадает с изначально назначенным пулом до начала выполнения.
- `execution_pool` (`String`) - Имя пула `execution_pool_id`.
- `execution_priority` (`Int64`) - Приоритет пула `execution_pool_id`.

- `ready_seqno` (`Nullable(UInt64)`) - Не `null` для готовых задач. Воркер выбирает следующую задачу для выполнения из очереди готовых задач своего пула. Если есть несколько готовых задач, выбирается задача с наименьшим значением `ready_seqno`.
- `waiters` (`UInt64`) - Число потоков, ожидающих завершения этой задачи.
- `exception` (`Nullable(String)`) - Не `null` для завершившихся с ошибкой и отменённых задач. Содержит сообщение об ошибке, возникшей во время выполнения запроса, или ошибку, приведшую к отмене этой задачей, вместе с цепочкой отказов по зависимостям (имен задач).

Моменты времени в течение жизненного цикла задачи:
- `schedule_time` (`DateTime64`) - Время, когда задача была создана и поставлена в план на выполнение (обычно со всеми её зависимостями).
- `enqueue_time` (`Nullable(DateTime64)`) - Время, когда задача стала готовой и была поставлена в очередь готовых задач своего пула. `Null`, если задача ещё не готова.
- `start_time` (`Nullable(DateTime64)`) - Время, когда воркер выбирает задачу из очереди готовых задач и начинает её выполнение. `Null`, если задача ещё не запущена.
- `finish_time` (`Nullable(DateTime64)`) - Время завершения выполнения задачи. `Null`, если задача ещё не завершена.
