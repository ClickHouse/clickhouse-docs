---
description: 'Системная таблица, содержащая метрики, которые периодически
  рассчитываются в фоновом режиме. Например, объём задействованной оперативной памяти.'
keywords: ['системная таблица', 'asynchronous_metrics']
slug: /operations/system-tables/asynchronous_metrics
title: 'system.asynchronous_metrics'
doc_type: 'reference'
---

import SystemTableCloud from '@site/docs/_snippets/_system_table_cloud.md';


# system.asynchronous_metrics {#system-asynchronous-metrics}

<SystemTableCloud />

Содержит метрики, которые периодически вычисляются в фоновом режиме. Например, объём используемой оперативной памяти.

Столбцы:

- `metric` ([String](../../sql-reference/data-types/string.md)) — имя метрики.
- `value` ([Float64](../../sql-reference/data-types/float.md)) — значение метрики.
- `description` ([String](../../sql-reference/data-types/string.md)) — описание метрики.

**Пример**

```sql
SELECT * FROM system.asynchronous_metrics LIMIT 10
```

```text
┌─metric──────────────────────────────────┬──────value─┬─description────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ AsynchronousMetricsCalculationTimeSpent │ 0.00179053 │ Время в секундах, затраченное на вычисление асинхронных метрик (накладные расходы на асинхронные метрики).                                                                                                                                              │
│ NumberOfDetachedByUserParts             │          0 │ Общее количество кусков данных, отсоединённых от таблиц MergeTree пользователями с помощью запроса `ALTER TABLE DETACH` (в отличие от неожиданных, повреждённых или игнорируемых кусков). Сервер не обрабатывает отсоединённые куски, и они могут быть удалены.                          │
│ NumberOfDetachedParts                   │          0 │ Общее количество кусков данных, отсоединённых от таблиц MergeTree. Кусок может быть отсоединён пользователем с помощью запроса `ALTER TABLE DETACH` или самим сервером, если кусок повреждён, неожидан или не нужен. Сервер не обрабатывает отсоединённые куски, и они могут быть удалены. │
│ TotalRowsOfMergeTreeTables              │    2781309 │ Общее количество строк (записей), хранящихся во всех таблицах семейства MergeTree.                                                                                                                                                                                   │
│ TotalBytesOfMergeTreeTables             │    7741926 │ Общий объём данных в байтах (сжатых, включая данные и индексы), хранящихся во всех таблицах семейства MergeTree.                                                                                                                                                   │
│ NumberOfTables                          │         93 │ Общее количество таблиц во всех базах данных на сервере, за исключением баз данных, которые не могут содержать таблицы MergeTree. Исключаются движки баз данных, которые генерируют набор таблиц динамически, такие как `Lazy`, `MySQL`, `PostgreSQL`, `SQlite`. │
│ NumberOfDatabases                       │          6 │ Общее количество баз данных на сервере.                                                                                                                                                                                                                   │
│ MaxPartCountForPartition                │          6 │ Максимальное количество кусков данных на партицию среди всех партиций всех таблиц семейства MergeTree. Значения больше 300 указывают на неправильную конфигурацию, перегрузку или массовую загрузку данных.                                                                       │
│ ReplicasSumMergesInQueue                │          0 │ Сумма операций слияния в очереди (ещё не применённых) по всем реплицируемым таблицам.                                                                                                                                                                       │
│ ReplicasSumInsertsInQueue               │          0 │ Сумма операций INSERT в очереди (ещё не реплицированных) по всем реплицируемым таблицам.                                                                                                                                                                   │
└─────────────────────────────────────────┴────────────┴────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

<!--- Unlike with system.events and system.metrics, the asynchronous metrics are not gathered in a simple list in a source code file - they
      are mixed with logic in src/Interpreters/ServerAsynchronousMetrics.cpp.
      Listing them here explicitly for reader convenience. --->


## Описания метрик {#metric-descriptions}

### AsynchronousHeavyMetricsCalculationTimeSpent {#asynchronousheavymetricscalculationtimespent}

Время в секундах, затраченное на вычисление асинхронных тяжёлых метрик (связанных с таблицами). Это накладные расходы асинхронных метрик.

### AsynchronousHeavyMetricsUpdateInterval {#asynchronousheavymetricsupdateinterval}

Интервал обновления тяжёлых метрик (связанных с таблицами)

### AsynchronousMetricsCalculationTimeSpent {#asynchronousmetricscalculationtimespent}

Время в секундах, затраченное на вычисление асинхронных метрик. Это накладные расходы асинхронных метрик.

### AsynchronousMetricsUpdateInterval {#asynchronousmetricsupdateinterval}

Интервал обновления метрик

### BlockActiveTime\__name_ {#blockactivetime_name}

Время в секундах, в течение которого блочное устройство имело запросы ввода-вывода в очереди. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardBytes\__name_ {#blockdiscardbytes_name}

Количество отброшенных байтов на блочном устройстве. Эти операции актуальны для SSD. Операции отбрасывания не используются ClickHouse, но могут использоваться другими процессами в системе. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardMerges\__name_ {#blockdiscardmerges_name}

Количество операций отбрасывания, запрошенных у блочного устройства и объединённых планировщиком ввода-вывода ОС. Эти операции актуальны для SSD. Операции отбрасывания не используются ClickHouse, но могут использоваться другими процессами в системе. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardOps\__name_ {#blockdiscardops_name}

Количество операций отбрасывания, запрошенных у блочного устройства. Эти операции актуальны для SSD. Операции отбрасывания не используются ClickHouse, но могут использоваться другими процессами в системе. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardTime\__name_ {#blockdiscardtime_name}

Время в секундах, затраченное на операции отбрасывания, запрошенные у блочного устройства, суммированное по всем операциям. Эти операции актуальны для SSD. Операции отбрасывания не используются ClickHouse, но могут использоваться другими процессами в системе. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockInFlightOps\__name_ {#blockinflightops_name}

Это значение подсчитывает количество запросов ввода-вывода, которые были отправлены драйверу устройства, но ещё не завершены. Оно не включает запросы ввода-вывода, находящиеся в очереди, но ещё не отправленные драйверу устройства. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockQueueTime\__name_ {#blockqueuetime_name}

Это значение подсчитывает количество миллисекунд, которые запросы ввода-вывода ожидали на этом блочном устройстве. Если ожидает несколько запросов ввода-вывода, это значение будет увеличиваться как произведение количества миллисекунд на количество ожидающих запросов. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadBytes\__name_ {#blockreadbytes_name}

Количество байтов, прочитанных с блочного устройства. Оно может быть меньше количества байтов, прочитанных из файловой системы, из-за использования кеша страниц ОС, который экономит операции ввода-вывода. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadMerges\__name_ {#blockreadmerges_name}

Количество операций чтения, запрошенных у блочного устройства и объединённых планировщиком ввода-вывода ОС. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadOps\__name_ {#blockreadops_name}


Количество операций чтения, запрошенных к блочному устройству. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadTime\__name_ {#blockreadtime_name}

Время в секундах, затраченное на операции чтения, запрошенные к блочному устройству, суммированное по всем операциям. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteBytes\__name_ {#blockwritebytes_name}

Количество байтов, записанных на блочное устройство. Может быть меньше количества байтов, записанных в файловую систему, из-за использования кеша страниц ОС, который сокращает операции ввода-вывода. Запись на блочное устройство может произойти позже соответствующей записи в файловую систему из-за сквозного кеширования. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteMerges\__name_ {#blockwritemerges_name}

Количество операций записи, запрошенных к блочному устройству и объединенных планировщиком ввода-вывода ОС. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteOps\__name_ {#blockwriteops_name}

Количество операций записи, запрошенных к блочному устройству. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteTime\__name_ {#blockwritetime_name}

Время в секундах, затраченное на операции записи, запрошенные к блочному устройству, суммированное по всем операциям. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### CPUFrequencyMHz\__name_ {#cpufrequencymhz_name}

Текущая частота процессора в МГц. Большинство современных процессоров динамически регулируют частоту для энергосбережения и работы в режиме Turbo Boost.

### DictionaryMaxUpdateDelay {#dictionarymaxlastsuccessfulupdatetime}

Максимальная задержка обновления словаря (в секундах).

### DictionaryTotalFailedUpdates {#dictionaryloadfailed}

Количество ошибок с момента последней успешной загрузки по всем словарям.

### DiskAvailable\__name_ {#diskavailable_name}

Доступное количество байтов на диске (виртуальная файловая система). Удаленные файловые системы могут показывать большие значения, например 16 EiB.

### DiskTotal\__name_ {#disktotal_name}

Общий размер диска в байтах (виртуальная файловая система). Удаленные файловые системы могут показывать большие значения, например 16 EiB.

### DiskUnreserved\__name_ {#diskunreserved_name}

Доступное количество байтов на диске (виртуальная файловая система) без учета резервирований для слияний, загрузок и перемещений. Удаленные файловые системы могут показывать большие значения, например 16 EiB.

### DiskUsed\__name_ {#diskused_name}

Использованное количество байтов на диске (виртуальная файловая система). Удаленные файловые системы не всегда предоставляют эту информацию.

### FilesystemCacheBytes {#filesystemcachebytes}

Общее количество байтов в виртуальной файловой системе `cache`. Этот кеш хранится на диске.

### FilesystemCacheFiles {#filesystemcachefiles}

Общее количество кешированных сегментов файлов в виртуальной файловой системе `cache`. Этот кеш хранится на диске.

### FilesystemLogsPathAvailableBytes {#filesystemlogspathavailablebytes}

Доступное количество байтов на томе, где смонтирован путь к журналам ClickHouse. Если это значение приближается к нулю, следует настроить ротацию журналов в конфигурационном файле.

### FilesystemLogsPathAvailableINodes {#filesystemlogspathavailableinodes}

Количество доступных инодов на томе, где смонтирован путь к журналам ClickHouse.

### FilesystemLogsPathTotalBytes {#filesystemlogspathtotalbytes}

Размер тома, где смонтирован путь к журналам ClickHouse, в байтах. Рекомендуется выделить не менее 10 ГБ для журналов.

### FilesystemLogsPathTotalINodes {#filesystemlogspathtotalinodes}

Общее количество инодов на томе, где смонтирован путь к журналам ClickHouse.

### FilesystemLogsPathUsedBytes {#filesystemlogspathusedbytes}

Использованное количество байтов на томе, где смонтирован путь к журналам ClickHouse.

### FilesystemLogsPathUsedINodes {#filesystemlogspathusedinodes}

Количество использованных инодов на томе, где смонтирован путь к журналам ClickHouse.


### FilesystemMainPathAvailableBytes {#filesystemmainpathavailablebytes}

Количество доступных байтов на томе, где смонтирован основной путь ClickHouse.

### FilesystemMainPathAvailableINodes {#filesystemmainpathavailableinodes}

Количество доступных inodes на томе, где смонтирован основной путь ClickHouse. Если значение близко к нулю, это указывает на неправильную конфигурацию, и вы получите ошибку «no space left on device» даже при наличии свободного места на диске.

### FilesystemMainPathTotalBytes {#filesystemmainpathtotalbytes}

Размер тома, где смонтирован основной путь ClickHouse, в байтах.

### FilesystemMainPathTotalINodes {#filesystemmainpathtotalinodes}

Общее количество inodes на томе, где смонтирован основной путь ClickHouse. Если значение меньше 25 миллионов, это указывает на неправильную конфигурацию.

### FilesystemMainPathUsedBytes {#filesystemmainpathusedbytes}

Количество использованных байтов на томе, где смонтирован основной путь ClickHouse.

### FilesystemMainPathUsedINodes {#filesystemmainpathusedinodes}

Количество использованных inodes на томе, где смонтирован основной путь ClickHouse. Это значение в основном соответствует количеству файлов.

### HTTPThreads {#httpthreads}

Количество потоков в сервере HTTP-интерфейса (без TLS).

### InterserverThreads {#interserverthreads}

Количество потоков в сервере протокола межсерверного взаимодействия реплик (без TLS).

### Jitter {#jitter}

Разница во времени между запланированным пробуждением потока для вычисления асинхронных метрик и фактическим временем пробуждения. Косвенный индикатор общей задержки и отзывчивости системы.

### LoadAverage*N* {#loadaveragen}

Нагрузка на всю систему, усредненная с экспоненциальным сглаживанием за 1 минуту. Нагрузка представляет собой количество потоков во всех процессах (планируемых сущностей ядра ОС), которые в данный момент выполняются процессором, ожидают операций ввода-вывода или готовы к выполнению, но не запланированы в данный момент времени. Это число включает все процессы, а не только clickhouse-server. Значение может превышать количество ядер процессора, если система перегружена и многие процессы готовы к выполнению, но ожидают процессор или операции ввода-вывода.

### MaxPartCountForPartition {#maxpartcountforpartition}

Максимальное количество кусков на партицию среди всех партиций всех таблиц семейства MergeTree. Значения больше 300 указывают на неправильную конфигурацию, перегрузку или массовую загрузку данных.

### MemoryCode {#memorycode}

Объем виртуальной памяти, отображенной для страниц машинного кода серверного процесса, в байтах.

### MemoryDataAndStack {#memorydataandstack}

Объем виртуальной памяти, отображенной для использования стека и выделенной памяти, в байтах. Не определено, включает ли это стеки отдельных потоков и большую часть выделенной памяти, которая выделяется системным вызовом «mmap». Эта метрика существует только для полноты. Рекомендуется использовать метрику `MemoryResident` для мониторинга.

### MemoryResidentMax {#memoryresidentmax}

Максимальный объем физической памяти, используемой серверным процессом, в байтах.

### MemoryResident {#memoryresident}

Объем физической памяти, используемой серверным процессом, в байтах.

### MemoryShared {#memoryshared}

Объем памяти, используемой серверным процессом, которая также используется другими процессами, в байтах. ClickHouse не использует разделяемую память, но некоторая память может быть помечена ОС как разделяемая по собственным причинам. Эта метрика не имеет большого смысла для мониторинга и существует только для полноты.

### MemoryVirtual {#memoryvirtual}

Размер виртуального адресного пространства, выделенного серверным процессом, в байтах. Размер виртуального адресного пространства обычно намного больше потребления физической памяти и не должен использоваться для оценки потребления памяти. Большие значения этой метрики совершенно нормальны и имеют только техническое значение.

### MySQLThreads {#mysqlthreads}

Количество потоков в сервере протокола совместимости с MySQL.

### NetworkReceiveBytes\__name_ {#networkreceivebytes_name}

Количество байтов, полученных через сетевой интерфейс. Это общесистемная метрика, она включает все процессы на хост-машине, а не только clickhouse-server.

### NetworkReceiveDrop\__name_ {#networkreceivedrop_name}

Количество байтов в пакетах, которые были отброшены при получении через сетевой интерфейс. Это общесистемная метрика, она включает все процессы на хост-машине, а не только clickhouse-server.

### NetworkReceiveErrors\__name_ {#networkreceiveerrors_name}

Количество ошибок, произошедших при получении данных через сетевой интерфейс. Это общесистемная метрика, она включает все процессы на хост-машине, а не только clickhouse-server.


### NetworkReceivePackets\__name_ {#networkreceivepackets_name}

Количество сетевых пакетов, полученных через сетевой интерфейс. Это общесистемная метрика, которая включает все процессы на хост-машине, а не только clickhouse-server.

### NetworkSendBytes\__name_ {#networksendbytes_name}

Количество байтов, отправленных через сетевой интерфейс. Это общесистемная метрика, которая включает все процессы на хост-машине, а не только clickhouse-server.

### NetworkSendDrop\__name_ {#networksenddrop_name}

Количество случаев, когда пакет был отброшен при отправке через сетевой интерфейс. Это общесистемная метрика, которая включает все процессы на хост-машине, а не только clickhouse-server.

### NetworkSendErrors\__name_ {#networksenderrors_name}

Количество ошибок (например, повторная передача TCP), возникших при отправке через сетевой интерфейс. Это общесистемная метрика, которая включает все процессы на хост-машине, а не только clickhouse-server.

### NetworkSendPackets\__name_ {#networksendpackets_name}

Количество сетевых пакетов, отправленных через сетевой интерфейс. Это общесистемная метрика, которая включает все процессы на хост-машине, а не только clickhouse-server.

### NumberOfDatabases {#numberofdatabases}

Общее количество баз данных на сервере.

### NumberOfDetachedByUserParts {#numberofdetachedbyuserparts}

Общее количество кусков, отсоединенных от таблиц MergeTree пользователями с помощью запроса `ALTER TABLE DETACH` (в отличие от неожиданных, поврежденных или игнорируемых кусков). Сервер не обрабатывает отсоединенные куски, они могут быть удалены.

### NumberOfDetachedParts {#numberofdetachedparts}

Общее количество кусков, отсоединенных от таблиц MergeTree. Кусок может быть отсоединен пользователем с помощью запроса `ALTER TABLE DETACH` или самим сервером, если кусок поврежден, неожидан или не нужен. Сервер не обрабатывает отсоединенные куски, они могут быть удалены.

### NumberOfTables {#numberoftables}

Общее количество таблиц по всем базам данных на сервере, за исключением баз данных, которые не могут содержать таблицы MergeTree. Исключенные движки баз данных — это те, которые генерируют набор таблиц динамически, такие как `Lazy`, `MySQL`, `PostgreSQL`, `SQlite`.

### OSContextSwitches {#oscontextswitches}

Количество переключений контекста, произошедших в системе на хост-машине. Это общесистемная метрика, которая включает все процессы на хост-машине, а не только clickhouse-server.

### OSGuestNiceTime {#osguestnicetime}

Доля времени, затраченного на выполнение виртуального процессора для гостевых операционных систем под управлением ядра Linux, когда гостевая система была установлена с более высоким приоритетом (см. `man procfs`). Это общесистемная метрика, которая включает все процессы на хост-машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но существует для полноты. Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как сумма по ним [0..количество ядер].

### OSGuestNiceTimeCPU\__N_ {#osguestnicetimecpu_n}

Доля времени, затраченного на выполнение виртуального процессора для гостевых операционных систем под управлением ядра Linux, когда гостевая система была установлена с более высоким приоритетом (см. `man procfs`). Это общесистемная метрика, которая включает все процессы на хост-машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но существует для полноты. Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как сумма по ним [0..количество ядер].

### OSGuestNiceTimeNormalized {#osguestnicetimenormalized}

Значение аналогично `OSGuestNiceTime`, но разделено на количество ядер процессора для измерения в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неоднородно, и при этом получать среднюю метрику использования ресурсов.

### OSGuestTime {#osguesttime}

Доля времени, затраченного на выполнение виртуального процессора для гостевых операционных систем под управлением ядра Linux (см. `man procfs`). Это общесистемная метрика, которая включает все процессы на хост-машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но существует для полноты. Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как сумма по ним [0..количество ядер].

### OSGuestTimeCPU\__N_ {#osguesttimecpu_n}


Доля времени, затраченного на выполнение виртуального процессора для гостевых операционных систем под управлением ядра Linux (см. `man procfs`). Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Эта метрика не относится к ClickHouse, но присутствует для полноты. Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как их сумма [0..число ядер].

### OSGuestTimeNormalized {#osguesttimenormalized}

Значение аналогично `OSGuestTime`, но разделённое на количество ядер процессора для измерения в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер различается, и при этом получать среднюю метрику использования ресурсов.

### OSIOWaitTime {#osiowaittime}

Доля времени, когда ядро процессора не выполняло код, но при этом ядро ОС не запускало никакой другой процесс на этом процессоре, поскольку процессы ожидали завершения операций ввода-вывода. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как их сумма [0..число ядер].

### OSIOWaitTimeCPU\__N_ {#osiowaittimecpu_n}

Доля времени, когда ядро процессора не выполняло код, но при этом ядро ОС не запускало никакой другой процесс на этом процессоре, поскольку процессы ожидали завершения операций ввода-вывода. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как их сумма [0..число ядер].

### OSIOWaitTimeNormalized {#osiowaittimenormalized}

Значение аналогично `OSIOWaitTime`, но разделённое на количество ядер процессора для измерения в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер различается, и при этом получать среднюю метрику использования ресурсов.

### OSIdleTime {#osidletime}

Доля времени, когда ядро процессора простаивало (даже не было готово запустить процесс, ожидающий завершения операций ввода-вывода) с точки зрения ядра ОС. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Сюда не входит время, когда процессор был недостаточно загружен по внутренним причинам процессора (загрузка памяти, остановки конвейера, ошибки предсказания ветвлений, выполнение другого ядра SMT). Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как их сумма [0..число ядер].

### OSIdleTimeCPU\__N_ {#osidletimecpu_n}

Доля времени, когда ядро процессора простаивало (даже не было готово запустить процесс, ожидающий завершения операций ввода-вывода) с точки зрения ядра ОС. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Сюда не входит время, когда процессор был недостаточно загружен по внутренним причинам процессора (загрузка памяти, остановки конвейера, ошибки предсказания ветвлений, выполнение другого ядра SMT). Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как их сумма [0..число ядер].

### OSIdleTimeNormalized {#osidletimenormalized}

Значение аналогично `OSIdleTime`, но разделённое на количество ядер процессора для измерения в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер различается, и при этом получать среднюю метрику использования ресурсов.

### OSInterrupts {#osinterrupts}

Количество прерываний на хост-машине. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server.

### OSIrqTime {#osirqtime}

Доля времени, затраченного на обработку аппаратных запросов прерываний на процессоре. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Высокое значение этой метрики может указывать на неправильную конфигурацию оборудования или очень высокую сетевую нагрузку. Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как их сумма [0..число ядер].


### OSIrqTimeCPU\__N_ {#osirqtimecpu_n}

Доля времени, затраченного на обработку аппаратных прерываний процессором. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Высокое значение этой метрики может указывать на неправильную конфигурацию оборудования или очень высокую сетевую нагрузку. Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как сумма по ним [0..количество ядер].

### OSIrqTimeNormalized {#osirqtimenormalized}

Значение аналогично `OSIrqTime`, но нормализовано делением на количество ядер процессора для измерения в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер различается, и при этом получать среднюю метрику использования ресурсов.

### OSMemoryAvailable {#osmemoryavailable}

Объем памяти, доступной для использования программами, в байтах. Эта метрика очень похожа на `OSMemoryFreePlusCached`. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server.

### OSMemoryBuffers {#osmemorybuffers}

Объем памяти, используемой буферами ядра ОС, в байтах. Обычно это значение должно быть небольшим, большие значения могут указывать на неправильную конфигурацию ОС. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server.

### OSMemoryCached {#osmemorycached}

Объем памяти, используемой кешем страниц ОС, в байтах. Обычно почти вся доступная память используется кешем страниц ОС — высокие значения этой метрики являются нормальными и ожидаемыми. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server.

### OSMemoryFreePlusCached {#osmemoryfreepluscached}

Объем свободной памяти плюс память кеша страниц ОС на хост-системе, в байтах. Эта память доступна для использования программами. Значение должно быть очень близко к `OSMemoryAvailable`. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server.

### OSMemoryFreeWithoutCached {#osmemoryfreewithoutcached}

Объем свободной памяти на хост-системе, в байтах. Не включает память, используемую кешем страниц ОС. Память кеша страниц также доступна для использования программами, поэтому значение этой метрики может вводить в заблуждение. Вместо этого используйте метрику `OSMemoryAvailable`. Для удобства также предоставляется метрика `OSMemoryFreePlusCached`, которая должна быть близка к OSMemoryAvailable. См. также https://www.linuxatemyram.com/. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server.

### OSMemoryTotal {#osmemorytotal}

Общий объем памяти на хост-системе, в байтах.

### OSNiceTime {#osnicetime}

Доля времени, в течение которого ядро процессора выполняло код пользовательского пространства с повышенным приоритетом. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как сумма по ним [0..количество ядер].

### OSNiceTimeCPU\__N_ {#osnicetimecpu_n}

Доля времени, в течение которого ядро процессора выполняло код пользовательского пространства с повышенным приоритетом. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как сумма по ним [0..количество ядер].

### OSNiceTimeNormalized {#osnicetimenormalized}

Значение аналогично `OSNiceTime`, но нормализовано делением на количество ядер процессора для измерения в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер различается, и при этом получать среднюю метрику использования ресурсов.

### OSOpenFiles {#osopenfiles}

Общее количество открытых файлов на хост-машине. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server.

### OSProcessesBlocked {#osprocessesblocked}

Количество потоков, заблокированных в ожидании завершения операций ввода-вывода (`man procfs`). Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server.


### OSProcessesCreated {#osprocessescreated}

Количество созданных процессов. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server.

### OSProcessesRunning {#osprocessesrunning}

Количество исполняемых (выполняющихся или готовых к выполнению) потоков операционной системы. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server.

### OSSoftIrqTime {#ossoftirqtime}

The ratio of time spent for running software interrupt requests on the CPU. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. A high number of this metric may indicate inefficient software running on the system. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по ним [0..число ядер].

### OSSoftIrqTimeCPU\__N_ {#ossoftirqtimecpu_n}

The ratio of time spent for running software interrupt requests on the CPU. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. A high number of this metric may indicate inefficient software running on the system. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по ним [0..число ядер].

### OSSoftIrqTimeNormalized {#ossoftirqtimenormalized}

Значение аналогично `OSSoftIrqTime`, но разделено на количество ядер CPU для измерения в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неодинаково, и при этом получать среднюю метрику использования ресурсов.

### OSStealTime {#osstealtime}

The ratio of time spent in other operating systems by the CPU when running in a virtualized environment. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Not every virtualized environments present this metric, and most of them don't. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по ним [0..число ядер].

### OSStealTimeCPU\__N_ {#osstealtimecpu_n}

The ratio of time spent in other operating systems by the CPU when running in a virtualized environment. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Not every virtualized environments present this metric, and most of them don't. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по ним [0..число ядер].

### OSStealTimeNormalized {#osstealtimenormalized}

Значение аналогично `OSStealTime`, но разделено на количество ядер CPU для измерения в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неодинаково, и при этом получать среднюю метрику использования ресурсов.

### OSSystemTime {#ossystemtime}

The ratio of time the CPU core was running OS kernel (system) code. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по ним [0..число ядер].

### OSSystemTimeCPU\__N_ {#ossystemtimecpu_n}

The ratio of time the CPU core was running OS kernel (system) code. Это общесистемная метрика, включающая все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по ним [0..число ядер].

### OSSystemTimeNormalized {#ossystemtimenormalized}

Значение аналогично `OSSystemTime`, но разделено на количество ядер CPU для измерения в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неодинаково, и при этом получать среднюю метрику использования ресурсов.

### OSThreadsRunnable {#osthreadsrunnable}

Общее количество «исполняемых» потоков с точки зрения планировщика ядра ОС.

### OSThreadsTotal {#osthreadstotal}


Общее количество потоков с точки зрения планировщика ядра ОС.

### OSUptime {#osuptime}

Время работы хост-сервера (машины, на которой работает ClickHouse), в секундах.

### OSUserTime {#osusertime}

Доля времени, в течение которого ядро процессора выполняло код в пространстве пользователя. Это общесистемная метрика, которая включает все процессы на хост-машине, а не только clickhouse-server. Сюда также входит время, когда процессор был недогружен по внутренним причинам (загрузка из памяти, простои конвейера, ошибки предсказания ветвлений, выполнение другого SMT-ядра). Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как их сумма [0..количество ядер].

### OSUserTimeCPU\__N_ {#osusertimecpu_n}

Доля времени, в течение которого ядро процессора выполняло код в пространстве пользователя. Это общесистемная метрика, которая включает все процессы на хост-машине, а не только clickhouse-server. Сюда также входит время, когда процессор был недогружен по внутренним причинам (загрузка из памяти, простои конвейера, ошибки предсказания ветвлений, выполнение другого SMT-ядра). Значение для одного ядра процессора находится в интервале [0..1]. Значение для всех ядер процессора вычисляется как их сумма [0..количество ядер].

### OSUserTimeNormalized {#osusertimenormalized}

Значение аналогично `OSUserTime`, но разделено на количество ядер процессора для измерения в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения данной метрики по нескольким серверам в кластере, даже если количество ядер различается, и при этом получать среднюю метрику использования ресурсов.

### PostgreSQLThreads {#postgresqlthreads}

Количество потоков в сервере протокола совместимости с PostgreSQL.

### ReplicasMaxAbsoluteDelay {#replicasmaxabsolutedelay}

Максимальная разница в секундах между самой свежей реплицированной частью и самой свежей частью данных, которую еще предстоит реплицировать, по всем реплицируемым таблицам. Очень высокое значение указывает на реплику без данных.

### ReplicasMaxInsertsInQueue {#replicasmaxinsertsinqueue}

Максимальное количество операций INSERT в очереди (ожидающих репликации) по всем реплицируемым таблицам.

### ReplicasMaxMergesInQueue {#replicasmaxmergesinqueue}

Максимальное количество операций слияния в очереди (ожидающих применения) по всем реплицируемым таблицам.

### ReplicasMaxQueueSize {#replicasmaxqueuesize}

Максимальный размер очереди (в количестве операций, таких как get, merge) по всем реплицируемым таблицам.

### ReplicasMaxRelativeDelay {#replicasmaxrelativedelay}

Максимальная разница между задержкой реплики и задержкой наиболее актуальной реплики той же таблицы по всем реплицируемым таблицам.

### ReplicasSumInsertsInQueue {#replicassuminsertsinqueue}

Суммарное количество операций INSERT в очереди (ожидающих репликации) по всем реплицируемым таблицам.

### ReplicasSumMergesInQueue {#replicassummergesinqueue}

Суммарное количество операций слияния в очереди (ожидающих применения) по всем реплицируемым таблицам.

### ReplicasSumQueueSize {#replicassumqueuesize}

Суммарный размер очереди (в количестве операций, таких как get, merge) по всем реплицируемым таблицам.

### TCPThreads {#tcpthreads}

Количество потоков в сервере протокола TCP (без TLS).

### Temperature\__N_ {#temperature_n}

Температура соответствующего устройства в ℃. Датчик может возвращать нереалистичное значение. Источник: `/sys/class/thermal`

### Temperature\__name_ {#temperature_name}

Температура, сообщаемая соответствующим аппаратным монитором и датчиком в ℃. Датчик может возвращать нереалистичное значение. Источник: `/sys/class/hwmon`

### TotalBytesOfMergeTreeTables {#totalbytesofmergetreetables}

Общий объем байтов (сжатых, включая данные и индексы), хранящихся во всех таблицах семейства MergeTree.

### TotalPartsOfMergeTreeTables {#totalpartsofmergetreetables}

Общее количество частей данных во всех таблицах семейства MergeTree. Значения больше 10 000 негативно влияют на время запуска сервера и могут указывать на неудачный выбор ключа партиционирования.

### TotalPrimaryKeyBytesInMemory {#totalprimarykeybytesinmemory}

Общий объем памяти (в байтах), используемый значениями первичного ключа (учитываются только активные части).

### TotalPrimaryKeyBytesInMemoryAllocated {#totalprimarykeybytesinmemoryallocated}

Общий объем памяти (в байтах), зарезервированный для значений первичного ключа (учитываются только активные части).


### TotalRowsOfMergeTreeTables {#totalrowsofmergetreetables}

Общее количество строк (записей), хранящихся во всех таблицах семейства MergeTree.

### Uptime {#uptime}

Время работы сервера в секундах. Включает время, затраченное на инициализацию сервера до начала приёма соединений.

### jemalloc.active {#jemallocactive}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.allocated {#jemallocallocated}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.dirty_purged {#jemallocarenasalldirty_purged}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.muzzy_purged {#jemallocarenasallmuzzy_purged}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.pactive {#jemallocarenasallpactive}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.pdirty {#jemallocarenasallpdirty}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.pmuzzy {#jemallocarenasallpmuzzy}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.background_thread.num_runs {#jemallocbackground_threadnum_runs}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.background_thread.num_threads {#jemallocbackground_threadnum_threads}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.background_thread.run_intervals {#jemallocbackground_threadrun_intervals}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.epoch {#jemallocepoch}

Внутренний инкрементный номер обновления статистики jemalloc (аллокатор памяти Джейсона Эванса), используемый во всех остальных метриках `jemalloc`.

### jemalloc.mapped {#jemallocmapped}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.metadata {#jemallocmetadata}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.metadata_thp {#jemallocmetadata_thp}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.resident {#jemallocresident}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.retained {#jemallocretained}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.prof.active {#jemallocprofactive}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

**См. также**

- [Мониторинг](../../operations/monitoring.md) — Базовые концепции мониторинга ClickHouse.
- [system.metrics](/operations/system-tables/metrics) — Содержит мгновенно вычисляемые метрики.
- [system.events](/operations/system-tables/events) — Содержит количество произошедших событий.
- [system.metric_log](/operations/system-tables/metric_log) — Содержит историю значений метрик из таблиц `system.metrics` и `system.events`.
