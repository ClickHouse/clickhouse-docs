---
description: 'Системная таблица, содержащая метрики, которые периодически рассчитываются
  в фоновом режиме. Например, объем используемой оперативной памяти.'
keywords: ['системная таблица', 'asynchronous_metrics']
slug: /operations/system-tables/asynchronous_metrics
title: 'system.asynchronous_metrics'
doc_type: 'reference'
---

import SystemTableCloud from '@site/i18n/ru/docusaurus-plugin-content-docs/current/_snippets/_system_table_cloud.md';

# system.asynchronous&#95;metrics {#systemasynchronous_metrics}

<SystemTableCloud />

Содержит метрики, которые периодически вычисляются в фоновом режиме. Например, объём используемой оперативной памяти.

Столбцы:

* `metric` ([String](../../sql-reference/data-types/string.md)) — имя метрики.
* `value` ([Float64](../../sql-reference/data-types/float.md)) — значение метрики.
* `description` ([String](../../sql-reference/data-types/string.md)) — описание метрики.

**Пример**

```sql
SELECT * FROM system.asynchronous_metrics LIMIT 10
```

```text
┌─metric──────────────────────────────────┬──────value─┬─description────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ AsynchronousMetricsCalculationTimeSpent │ 0.00179053 │ Время в секундах, затраченное на вычисление асинхронных метрик (накладные расходы асинхронных метрик).                                                                                                                                              │
│ NumberOfDetachedByUserParts             │          0 │ Общее количество кусков, отсоединённых от таблиц MergeTree пользователями с помощью запроса `ALTER TABLE DETACH` (в отличие от неожиданных, повреждённых или игнорируемых кусков). Сервер не учитывает отсоединённые куски, и они могут быть удалены.                          │
│ NumberOfDetachedParts                   │          0 │ Общее количество кусков, отсоединённых от таблиц MergeTree. Кусок может быть отсоединён пользователем с помощью запроса `ALTER TABLE DETACH` или самим сервером, если кусок повреждён, неожиданный или не нужен. Сервер не учитывает отсоединённые куски, и они могут быть удалены. │
│ TotalRowsOfMergeTreeTables              │    2781309 │ Общее количество строк (записей), хранящихся во всех таблицах семейства MergeTree.                                                                                                                                                                                   │
│ TotalBytesOfMergeTreeTables             │    7741926 │ Общий объём данных в байтах (сжатых, включая данные и индексы), хранящихся во всех таблицах семейства MergeTree.                                                                                                                                                   │
│ NumberOfTables                          │         93 │ Общее количество таблиц по всем базам данных на сервере, за исключением баз данных, которые не могут содержать таблицы MergeTree. Исключаемые движки баз данных — это те, которые генерируют набор таблиц динамически, такие как `Lazy`, `MySQL`, `PostgreSQL`, `SQlite`. │
│ NumberOfDatabases                       │          6 │ Общее количество баз данных на сервере.                                                                                                                                                                                                                   │
│ MaxPartCountForPartition                │          6 │ Максимальное количество кусков на партицию среди всех партиций всех таблиц семейства MergeTree. Значения больше 300 указывают на неправильную конфигурацию, перегрузку или массовую загрузку данных.                                                                       │
│ ReplicasSumMergesInQueue                │          0 │ Сумма операций слияния в очереди (ещё не применённых) по всем реплицируемым таблицам.                                                                                                                                                                       │
│ ReplicasSumInsertsInQueue               │          0 │ Сумма операций INSERT в очереди (ещё не реплицированных) по всем реплицируемым таблицам.                                                                                                                                                                   │
└─────────────────────────────────────────┴────────────┴────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

{/*- В отличие от system.events и system.metrics, асинхронные метрики не собраны в простой список в файле исходного кода — они
      смешаны с логикой в src/Interpreters/ServerAsynchronousMetrics.cpp.
      Для удобства читателя мы явно перечислили их здесь. -*/ }

## Описание метрик {#metric-descriptions}

### AsynchronousHeavyMetricsCalculationTimeSpent {#asynchronousheavymetricscalculationtimespent}

Время в секундах, затраченное на вычисление асинхронных тяжёлых метрик (связанных с таблицами) (это накладные расходы на асинхронные метрики).

### AsynchronousHeavyMetricsUpdateInterval {#asynchronousheavymetricsupdateinterval}

Интервал обновления тяжёлых метрик (связанных с таблицами).

### AsynchronousMetricsCalculationTimeSpent {#asynchronousmetricscalculationtimespent}

Время в секундах, затраченное на вычисление асинхронных метрик (это накладные расходы на асинхронные метрики).

### AsynchronousMetricsUpdateInterval {#asynchronousmetricsupdateinterval}

Интервал обновления метрик.

### BlockActiveTime_*name* {#blockactivetime_name}

Время в секундах, в течение которого на блочном устройстве находились в очереди I/O‑запросы. Это метрика на уровне всей системы, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardBytes_*name* {#blockdiscardbytes_name}

Количество отброшенных байт на блочном устройстве. Эти операции актуальны для SSD. Операции discard не используются ClickHouse, но могут использоваться другими процессами в системе. Это метрика на уровне всей системы, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardMerges_*name* {#blockdiscardmerges_name}

Количество операций discard для блочного устройства, которые были объединены планировщиком ввода-вывода ОС. Эти операции актуальны для SSD. Операции discard не используются ClickHouse, но могут использоваться другими процессами в системе. Это метрика на уровне всей системы, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardOps_*name* {#blockdiscardops_name}

Количество операций discard для блочного устройства. Эти операции актуальны для SSD. Операции discard не используются ClickHouse, но могут использоваться другими процессами в системе. Это метрика на уровне всей системы, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardTime_*name* {#blockdiscardtime_name}

Время в секундах, затраченное на операции discard для блочного устройства, суммарно по всем операциям. Эти операции актуальны для SSD. Операции discard не используются ClickHouse, но могут использоваться другими процессами в системе. Это метрика на уровне всей системы, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockInFlightOps_*name* {#blockinflightops_name}

Это значение показывает количество запросов ввода-вывода, которые были отправлены драйверу устройства, но ещё не завершены. Оно не включает I/O‑запросы, которые находятся в очереди, но ещё не отправлены драйверу устройства. Это метрика на уровне всей системы, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockQueueTime_*name* {#blockqueuetime_name}

Это значение показывает количество миллисекунд, в течение которых I/O‑запросы ожидали на этом блочном устройстве. Если одновременно ожидает несколько I/O‑запросов, это значение увеличивается как произведение количества миллисекунд на количество ожидающих запросов. Это метрика на уровне всей системы, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadBytes_*name* {#blockreadbytes_name}

Количество байт, прочитанных с блочного устройства. Оно может быть меньше, чем количество байт, прочитанных из файловой системы, из-за использования страничного кэша ОС, который сокращает обращения к I/O. Это метрика на уровне всей системы, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadMerges_*name* {#blockreadmerges_name}

Количество операций чтения для блочного устройства, которые были объединены планировщиком ввода-вывода ОС. Это метрика на уровне всей системы, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadOps_*name* {#blockreadops_name}

Количество операций чтения, запрошенных у блочного устройства. Это системная метрика: она учитывает все процессы на хостовой машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadTime_*name* {#blockreadtime_name}

Время в секундах, затраченное на операции чтения, запрошенные у блочного устройства, суммарно по всем операциям. Это системная метрика: она учитывает все процессы на хостовой машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteBytes_*name* {#blockwritebytes_name}

Количество байт, записанных на блочное устройство. Оно может быть меньше количества байт, записанных в файловую систему, из‑за использования страничного кэша ОС, который сокращает операции ввода‑вывода. Запись на блочное устройство может произойти позже соответствующей записи в файловую систему из‑за write-through‑кэширования. Это системная метрика: она учитывает все процессы на хостовой машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteMerges_*name* {#blockwritemerges_name}

Количество операций записи, запрошенных у блочного устройства и объединённых планировщиком ввода‑вывода ОС. Это системная метрика: она учитывает все процессы на хостовой машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteOps_*name* {#blockwriteops_name}

Количество операций записи, запрошенных у блочного устройства. Это системная метрика: она учитывает все процессы на хостовой машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteTime_*name* {#blockwritetime_name}

Время в секундах, затраченное на операции записи, запрошенные у блочного устройства, суммарно по всем операциям. Это системная метрика: она учитывает все процессы на хостовой машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### CPUFrequencyMHz_*name* {#cpufrequencymhz_name}

Текущая частота CPU в МГц. Большинство современных CPU динамически регулируют частоту для энергосбережения и Turbo Boost.

### DictionaryMaxUpdateDelay {#dictionarymaxlastsuccessfulupdatetime}

Максимальная задержка (в секундах) обновления словаря.

### DictionaryTotalFailedUpdates {#dictionaryloadfailed}

Количество ошибок с момента последней успешной загрузки во всех словарях.

### DiskAvailable_*name* {#diskavailable_name}

Доступное количество байт на диске (виртуальная файловая система). Удалённые файловые системы могут показывать большое значение, например 16 EiB.

### DiskTotal_*name* {#disktotal_name}

Общий размер диска (виртуальной файловой системы) в байтах. Удалённые файловые системы могут показывать большое значение, например 16 EiB.

### DiskUnreserved_*name* {#diskunreserved_name}

Доступное количество байт на диске (виртуальная файловая система) без учёта резервов под слияния, выборки и перемещения. Удалённые файловые системы могут показывать большое значение, например 16 EiB.

### DiskUsed_*name* {#diskused_name}

Количество использованных байт на диске (виртуальная файловая система). Удалённые файловые системы не всегда предоставляют эту информацию.

### FilesystemCacheBytes {#filesystemcachebytes}

Общее количество байт в виртуальной файловой системе `cache`. Этот кэш хранится на диске.

### FilesystemCacheFiles {#filesystemcachefiles}

Общее количество кэшированных сегментов файлов в виртуальной файловой системе `cache`. Этот кэш хранится на диске.

### FilesystemLogsPathAvailableBytes {#filesystemlogspathavailablebytes}

Доступное количество байт на томе, где смонтирован путь к логам ClickHouse. Если это значение приближается к нулю, следует настроить ротацию логов в конфигурационном файле.

### FilesystemLogsPathAvailableINodes {#filesystemlogspathavailableinodes}

Количество доступных inode на томе, где смонтирован путь к логам ClickHouse.

### FilesystemLogsPathTotalBytes {#filesystemlogspathtotalbytes}

Размер тома, где смонтирован путь к логам ClickHouse, в байтах. Рекомендуется иметь не менее 10 ГБ под логи.

### FilesystemLogsPathTotalINodes {#filesystemlogspathtotalinodes}

Общее количество inode на томе, где смонтирован путь к логам ClickHouse.

### FilesystemLogsPathUsedBytes {#filesystemlogspathusedbytes}

Количество использованных байт на томе, где смонтирован путь к логам ClickHouse.

### FilesystemLogsPathUsedINodes {#filesystemlogspathusedinodes}

Количество использованных inode на томе, где смонтирован путь к логам ClickHouse.

### FilesystemMainPathAvailableBytes {#filesystemmainpathavailablebytes}

Доступное количество байт на томе, где смонтирован основной путь ClickHouse.

### FilesystemMainPathAvailableINodes {#filesystemmainpathavailableinodes}

Количество доступных inode на томе, где смонтирован основной путь ClickHouse. Если значение близко к нулю, это указывает на ошибочную конфигурацию, и вы получите ошибку `no space left on device`, даже если диск не заполнен.

### FilesystemMainPathTotalBytes {#filesystemmainpathtotalbytes}

Размер тома, где смонтирован основной путь ClickHouse, в байтах.

### FilesystemMainPathTotalINodes {#filesystemmainpathtotalinodes}

Общее количество inode на томе, где смонтирован основной путь ClickHouse. Если оно меньше 25 миллионов, это указывает на ошибочную конфигурацию.

### FilesystemMainPathUsedBytes {#filesystemmainpathusedbytes}

Используемое количество байт на томе, где смонтирован основной путь ClickHouse.

### FilesystemMainPathUsedINodes {#filesystemmainpathusedinodes}

Количество использованных inode на томе, где смонтирован основной путь ClickHouse. Это значение в основном соответствует количеству файлов.

### HTTPThreads {#httpthreads}

Количество потоков в сервере HTTP-интерфейса (без TLS).

### InterserverThreads {#interserverthreads}

Количество потоков в сервере протокола взаимодействия реплик (без TLS).

### Jitter {#jitter}

Разница между моментом времени, когда поток для расчета асинхронных метрик должен был быть запланирован к пробуждению, и моментом времени, когда он фактически был пробуждён. Косвенный индикатор общей задержки и отзывчивости системы.

### LoadAverage*N* {#loadaveragen}

Нагрузка на всю систему, усреднённая с экспоненциальным сглаживанием за 1 минуту. Нагрузка представляет собой количество потоков во всех процессах (сущностей, планируемых ядром ОС), которые в данный момент выполняются на CPU, ожидают IO или готовы к выполнению, но в данный момент не запланированы. Это число включает в себя все процессы, а не только clickhouse-server. Значение может быть больше количества ядер CPU, если система перегружена и многие процессы готовы к выполнению, но ожидают CPU или IO.

### MaxPartCountForPartition {#maxpartcountforpartition}

Максимальное количество кусков (parts) на партицию среди всех партиций всех таблиц семейства MergeTree. Значения больше 300 указывают на ошибочную конфигурацию, перегрузку или массовую загрузку данных.

### MemoryCode {#memorycode}

Объём виртуальной памяти, отображённой на страницы машинного кода процесса сервера, в байтах.

### MemoryDataAndStack {#memorydataandstack}

Объём виртуальной памяти, отображённой для использования стека и выделенной памяти, в байтах. Не указано, включает ли он стеки отдельных потоков и большую часть выделенной памяти, которая выделяется с помощью системного вызова `mmap`. Эта метрика существует только для полноты. Рекомендуется использовать метрику `MemoryResident` для мониторинга.

### MemoryResidentMax {#memoryresidentmax}

Максимальный объём физической памяти, используемой процессом сервера, в байтах.

### MemoryResident {#memoryresident}

Объём физической памяти, используемой процессом сервера, в байтах.

### MemoryShared {#memoryshared}

Объём памяти, используемой процессом сервера и одновременно разделяемой с другими процессами, в байтах. ClickHouse не использует разделяемую память, но часть памяти может быть помечена ОС как разделяемая по её собственным причинам. За этой метрикой нет большого смысла наблюдать, она существует только для полноты.

### MemoryVirtual {#memoryvirtual}

Размер виртуального адресного пространства, выделенного процессом сервера, в байтах. Размер виртуального адресного пространства обычно значительно больше фактического потребления физической памяти и не должен использоваться как оценка потребления памяти. Большие значения этой метрики являются совершенно нормальными и имеют лишь технический смысл.

### MySQLThreads {#mysqlthreads}

Количество потоков в сервере протокола совместимости с MySQL.

### NetworkReceiveBytes_*name* {#networkreceivebytes_name}

Количество байт, полученных через сетевой интерфейс. Это системная метрика, она включает все процессы на хостовой машине, а не только clickhouse-server.

### NetworkReceiveDrop_*name* {#networkreceivedrop_name}

Количество байт, потерянных при приёме пакетов через сетевой интерфейс. Это системная метрика, она включает все процессы на хостовой машине, а не только clickhouse-server.

### NetworkReceiveErrors_*name* {#networkreceiveerrors_name}

Количество случаев возникновения ошибок при приёме через сетевой интерфейс. Это системная метрика, она включает все процессы на хостовой машине, а не только clickhouse-server.

### NetworkReceivePackets_*name* {#networkreceivepackets_name}

 Количество сетевых пакетов, полученных через сетевой интерфейс. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server.

### NetworkSendBytes_*name* {#networksendbytes_name}

 Количество байт, отправленных через сетевой интерфейс. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server.

### NetworkSendDrop_*name* {#networksenddrop_name}

 Количество случаев, когда пакет был отброшен при отправке через сетевой интерфейс. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server.

### NetworkSendErrors_*name* {#networksenderrors_name}

 Количество случаев возникновения ошибки (например, повторная передача TCP) при отправке через сетевой интерфейс. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server.

### NetworkSendPackets_*name* {#networksendpackets_name}

 Количество сетевых пакетов, отправленных через сетевой интерфейс. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server.

### NumberOfDatabases {#numberofdatabases}

Общее количество баз данных на сервере.

### NumberOfDetachedByUserParts {#numberofdetachedbyuserparts}

Общее количество частей, отделённых от таблиц MergeTree пользователями с помощью запроса `ALTER TABLE DETACH` (в отличие от неожиданных, повреждённых или игнорируемых частей). Сервер не отслеживает отделённые части, и их можно удалить.

### NumberOfDetachedParts {#numberofdetachedparts}

Общее количество частей, отделённых от таблиц MergeTree. Часть может быть отделена пользователем с помощью запроса `ALTER TABLE DETACH` или самим сервером, если часть повреждена, неожиданна или не нужна. Сервер не отслеживает отделённые части, и их можно удалить.

### NumberOfTables {#numberoftables}

Общее количество таблиц, суммированное по всем базам данных на сервере, за исключением баз данных, которые не могут содержать таблицы MergeTree. Исключены движки баз данных, которые формируют набор таблиц «на лету», такие как `Lazy`, `MySQL`, `PostgreSQL`, `SQlite`.

### OSContextSwitches {#oscontextswitches}

Количество переключений контекста, которые произошли в системе на хостовой машине. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server.

### OSGuestNiceTime {#osguestnicetime}

Доля времени, затраченного на работу виртуального CPU для гостевых операционных систем под управлением ядра Linux, когда для гостя был установлен более высокий приоритет (см. `man procfs`). Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но присутствует для полноты. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по ним [0..количество ядер].

### OSGuestNiceTimeCPU_*N* {#osguestnicetimecpu_n}

Доля времени, затраченного на работу виртуального CPU для гостевых операционных систем под управлением ядра Linux, когда для гостя был установлен более высокий приоритет (см. `man procfs`). Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но присутствует для полноты. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по ним [0..количество ядер].

### OSGuestNiceTimeNormalized {#osguestnicetimenormalized}

Значение аналогично `OSGuestNiceTime`, но поделено на количество ядер CPU, чтобы измеряться в интервале [0..1] независимо от числа ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если число ядер неоднородно, и всё равно получать среднюю метрику использования ресурсов.

### OSGuestTime {#osguesttime}

Доля времени, затраченного на работу виртуального CPU для гостевых операционных систем под управлением ядра Linux (см. `man procfs`). Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но присутствует для полноты. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по ним [0..количество ядер].

### OSGuestTimeCPU_*N* {#osguesttimecpu_n}

Отношение времени, затраченного на выполнение виртуального CPU для гостевых операционных систем под управлением ядра Linux (см. `man procfs`). Это системная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но приведена для полноты. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как их сумма [0..num cores].

### OSGuestTimeNormalized {#osguesttimenormalized}

Значение аналогично `OSGuestTime`, но делится на количество ядер CPU, чтобы измеряться в интервале [0..1] независимо от их числа. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере даже при неодинаковом количестве ядер и при этом получать среднюю метрику использования ресурсов.

### OSIOWaitTime {#osiowaittime}

Отношение времени, в течение которого ядро CPU не выполняло код, но при этом ядро ОС не запускало на этом CPU никакой другой процесс, так как процессы ожидали I/O. Это системная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как их сумма [0..num cores].

### OSIOWaitTimeCPU_*N* {#osiowaittimecpu_n}

Отношение времени, в течение которого ядро CPU не выполняло код, но при этом ядро ОС не запускало на этом CPU никакой другой процесс, так как процессы ожидали I/O. Это системная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как их сумма [0..num cores].

### OSIOWaitTimeNormalized {#osiowaittimenormalized}

Значение аналогично `OSIOWaitTime`, но делится на количество ядер CPU, чтобы измеряться в интервале [0..1] независимо от их числа. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере даже при неодинаковом количестве ядер и при этом получать среднюю метрику использования ресурсов.

### OSIdleTime {#osidletime}

Отношение времени, в течение которого ядро CPU простаивало (даже не было готово выполнить процесс, ожидающий I/O) с точки зрения ядра ОС. Это системная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server. Она не включает время, когда CPU был недоиспользован по причинам, внутренним для самого CPU (загрузки памяти, простои конвейера, ошибочные предсказания переходов, выполнение другого SMT-ядра). Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как их сумма [0..num cores].

### OSIdleTimeCPU_*N* {#osidletimecpu_n}

Отношение времени, в течение которого ядро CPU простаивало (даже не было готово выполнить процесс, ожидающий I/O) с точки зрения ядра ОС. Это системная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server. Она не включает время, когда CPU был недоиспользован по причинам, внутренним для самого CPU (загрузки памяти, простои конвейера, ошибочные предсказания переходов, выполнение другого SMT-ядра). Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как их сумма [0..num cores].

### OSIdleTimeNormalized {#osidletimenormalized}

Значение аналогично `OSIdleTime`, но делится на количество ядер CPU, чтобы измеряться в интервале [0..1] независимо от их числа. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере даже при неодинаковом количестве ядер и при этом получать среднюю метрику использования ресурсов.

### OSInterrupts {#osinterrupts}

Количество прерываний на хостовой машине. Это системная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server.

### OSIrqTime {#osirqtime}

Отношение времени, затраченного на обработку аппаратных прерываний на CPU. Это системная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server. Высокое значение этой метрики может указывать на некорректную конфигурацию оборудования или очень высокую сетевую нагрузку. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как их сумма [0..num cores].

### OSIrqTimeCPU_*N* {#osirqtimecpu_n}

Доля времени, затраченного на обработку аппаратных прерываний на CPU. Это системная метрика: она включает все процессы на хост-системе, а не только clickhouse-server. Высокое значение этой метрики может указывать на некорректную конфигурацию оборудования или очень высокую сетевую нагрузку. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по ним [0..num cores].

### OSIrqTimeNormalized {#osirqtimenormalized}

Значение аналогично `OSIrqTime`, но поделено на количество ядер CPU, чтобы укладываться в интервал [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер различается, и при этом получать усреднённую метрику использования ресурсов.

### OSMemoryAvailable {#osmemoryavailable}

Объём памяти, доступной для использования программами, в байтах. Эта метрика очень похожа на `OSMemoryFreePlusCached`. Это системная метрика: она включает все процессы на хост-системе, а не только clickhouse-server.

### OSMemoryBuffers {#osmemorybuffers}

Объём памяти, используемой буферами ядра ОС, в байтах. Обычно это значение должно быть небольшим, а большие значения могут указывать на некорректную конфигурацию ОС. Это системная метрика: она включает все процессы на хост-системе, а не только clickhouse-server.

### OSMemoryCached {#osmemorycached}

Объём памяти, используемой страничным кэшем ОС, в байтах. Как правило, почти вся доступная память используется страничным кэшем ОС — высокие значения этой метрики являются нормальными и ожидаемыми. Это системная метрика: она включает все процессы на хост-системе, а не только clickhouse-server.

### OSMemoryFreePlusCached {#osmemoryfreepluscached}

Объём свободной памяти плюс память страничного кэша ОС на хост-системе, в байтах. Эта память доступна для использования программами. Значение должно быть очень близко к `OSMemoryAvailable`. Это системная метрика: она включает все процессы на хост-системе, а не только clickhouse-server.

### OSMemoryFreeWithoutCached {#osmemoryfreewithoutcached}

Объём свободной памяти на хост-системе, в байтах. Это значение не включает память, используемую страничным кэшем ОС. Память страничного кэша также доступна для использования программами, поэтому значение этой метрики может быть неоднозначным. Вместо неё см. метрику `OSMemoryAvailable`. Для удобства также предоставляется метрика `OSMemoryFreePlusCached`, которая должна быть примерно аналогична `OSMemoryAvailable`. См. также https://www.linuxatemyram.com/. Это системная метрика: она включает все процессы на хост-системе, а не только clickhouse-server.

### OSMemoryTotal {#osmemorytotal}

Общий объём памяти на хост-системе, в байтах.

### OSNiceTime {#osnicetime}

Доля времени, когда ядро CPU выполняло пользовательский код с повышенным приоритетом. Это системная метрика: она включает все процессы на хост-системе, а не только clickhouse-server. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по ним [0..num cores].

### OSNiceTimeCPU_*N* {#osnicetimecpu_n}

Доля времени, когда указанное ядро CPU выполняло пользовательский код с повышенным приоритетом. Это системная метрика: она включает все процессы на хост-системе, а не только clickhouse-server. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по ним [0..num cores].

### OSNiceTimeNormalized {#osnicetimenormalized}

Значение аналогично `OSNiceTime`, но поделено на количество ядер CPU, чтобы укладываться в интервал [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер различается, и при этом получать усреднённую метрику использования ресурсов.

### OSOpenFiles {#osopenfiles}

Общее количество открытых файлов на хост-системе. Это системная метрика: она включает все процессы на хост-системе, а не только clickhouse-server.

### OSProcessesBlocked {#osprocessesblocked}

Количество потоков, заблокированных в ожидании завершения операций ввода-вывода (`man procfs`). Это системная метрика: она включает все процессы на хост-системе, а не только clickhouse-server.

### OSProcessesCreated {#osprocessescreated}

Количество созданных процессов. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server.

### OSProcessesRunning {#osprocessesrunning}

Количество потоков, которые могут выполняться (запущены или готовы к запуску), по данным операционной системы. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server.

### OSSoftIrqTime {#ossoftirqtime}

Доля времени, затраченного на обработку программных запросов прерываний на CPU. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server. Высокое значение этой метрики может указывать на неэффективно работающее программное обеспечение в системе. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSSoftIrqTimeCPU_*N* {#ossoftirqtimecpu_n}

Доля времени, затраченного на обработку программных запросов прерываний на CPU. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server. Высокое значение этой метрики может указывать на неэффективно работающее программное обеспечение в системе. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSSoftIrqTimeNormalized {#ossoftirqtimenormalized}

Значение аналогично `OSSoftIrqTime`, но разделено на количество ядер CPU, чтобы измеряться в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер отличается, и при этом получать усреднённую метрику использования ресурсов.

### OSStealTime {#osstealtime}

Доля времени, которое CPU проводит в других операционных системах при работе в виртуализованной среде. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server. Не все виртуализованные среды предоставляют эту метрику, и большинство — нет. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSStealTimeCPU_*N* {#osstealtimecpu_n}

Доля времени, которое CPU проводит в других операционных системах при работе в виртуализованной среде. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server. Не все виртуализованные среды предоставляют эту метрику, и большинство — нет. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSStealTimeNormalized {#osstealtimenormalized}

Значение аналогично `OSStealTime`, но разделено на количество ядер CPU, чтобы измеряться в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер отличается, и при этом получать усреднённую метрику использования ресурсов.

### OSSystemTime {#ossystemtime}

Доля времени, в течение которого ядро CPU выполняло код ядра ОС (системный код). Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSSystemTimeCPU_*N* {#ossystemtimecpu_n}

Доля времени, в течение которого ядро CPU выполняло код ядра ОС (системный код). Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSSystemTimeNormalized {#ossystemtimenormalized}

Значение аналогично `OSSystemTime`, но разделено на количество ядер CPU, чтобы измеряться в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер отличается, и при этом получать усреднённую метрику использования ресурсов.

### OSThreadsRunnable {#osthreadsrunnable}

Общее количество потоков в состоянии «runnable», как его видит планировщик ядра ОС.

### OSThreadsTotal {#osthreadstotal}

Общее количество потоков, с точки зрения планировщика ядра ОС.

### OSUptime {#osuptime}

Время непрерывной работы хост-сервера (машины, на которой запущен ClickHouse), в секундах.

### OSUserTime {#osusertime}

Доля времени, когда ядро CPU выполняло пользовательский код (userspace). Это метрика для всей системы, она включает все процессы на хост-машине, а не только clickhouse-server. Сюда также входит время, когда CPU был недоиспользован по причинам, внутренним для самого CPU (загрузки из памяти, остановки конвейера, ошибочные предсказания переходов, выполнение другого SMT-ядра). Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..число ядер].

### OSUserTimeCPU_*N* {#osusertimecpu_n}

Доля времени, когда ядро CPU выполняло пользовательский код (userspace). Это метрика для всей системы, она включает все процессы на хост-машине, а не только clickhouse-server. Сюда также входит время, когда CPU был недоиспользован по причинам, внутренним для самого CPU (загрузки из памяти, остановки конвейера, ошибочные предсказания переходов, выполнение другого SMT-ядра). Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..число ядер].

### OSUserTimeNormalized {#osusertimenormalized}

Значение аналогично `OSUserTime`, но делится на количество ядер CPU, чтобы оставаться в интервале [0..1] независимо от числа ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если число ядер неоднородно, и при этом получать корректную усреднённую метрику использования ресурсов.

### PostgreSQLThreads {#postgresqlthreads}

Количество потоков в сервере протокола совместимости с PostgreSQL.

### ReplicasMaxAbsoluteDelay {#replicasmaxabsolutedelay}

Максимальная разница в секундах между самой свежей реплицированной частью и самой свежей частью данных, ещё не реплицированной, по всем Replicated-таблицам. Очень большое значение указывает на реплику без данных.

### ReplicasMaxInsertsInQueue {#replicasmaxinsertsinqueue}

Максимальное количество операций INSERT в очереди (ещё не реплицированных) по всем Replicated-таблицам.

### ReplicasMaxMergesInQueue {#replicasmaxmergesinqueue}

Максимальное количество операций слияния в очереди (ещё не применённых) по всем Replicated-таблицам.

### ReplicasMaxQueueSize {#replicasmaxqueuesize}

Максимальный размер очереди (по количеству операций типа get, merge) по всем Replicated-таблицам.

### ReplicasMaxRelativeDelay {#replicasmaxrelativedelay}

Максимальная разница между задержкой реплики и задержкой самой актуальной реплики той же таблицы по всем Replicated-таблицам.

### ReplicasSumInsertsInQueue {#replicassuminsertsinqueue}

Суммарное количество операций INSERT в очереди (ещё не реплицированных) по всем Replicated-таблицам.

### ReplicasSumMergesInQueue {#replicassummergesinqueue}

Суммарное количество операций слияния в очереди (ещё не применённых) по всем Replicated-таблицам.

### ReplicasSumQueueSize {#replicassumqueuesize}

Суммарный размер очереди (по количеству операций типа get, merge) по всем Replicated-таблицам.

### TCPThreads {#tcpthreads}

Количество потоков в сервере протокола TCP (без TLS).

### Temperature_*N* {#temperature_n}

Температура соответствующего устройства в ℃. Датчик может возвращать нереалистичное значение. Источник: `/sys/class/thermal`

### Temperature_*name* {#temperature_name}

Температура, сообщаемая соответствующим аппаратным монитором и соответствующим датчиком, в ℃. Датчик может возвращать нереалистичное значение. Источник: `/sys/class/hwmon`

### TotalBytesOfMergeTreeTables {#totalbytesofmergetreetables}

Общее количество байт (сжатых, включая данные и индексы), хранящихся во всех таблицах семейства MergeTree.

### TotalPartsOfMergeTreeTables {#totalpartsofmergetreetables}

Общее количество частей данных во всех таблицах семейства MergeTree. Значения больше 10 000 будут отрицательно влиять на время запуска сервера и могут указывать на неудачный выбор ключа партиционирования.

### TotalPrimaryKeyBytesInMemory {#totalprimarykeybytesinmemory}

Объём памяти (в байтах), используемой значениями первичного ключа (учитываются только активные части).

### TotalPrimaryKeyBytesInMemoryAllocated {#totalprimarykeybytesinmemoryallocated}

Объём памяти (в байтах), зарезервированной под значения первичного ключа (учитываются только активные части).

### TotalRowsOfMergeTreeTables {#totalrowsofmergetreetables}

Общее количество строк (записей), хранимых во всех таблицах семейства MergeTree.

### Uptime {#uptime}

Время работы сервера в секундах. Включает время, затраченное на инициализацию сервера до начала приёма подключений.

### jemalloc.active {#jemallocactive}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.allocated {#jemallocallocated}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.dirty_purged {#jemallocarenasalldirty_purged}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.muzzy_purged {#jemallocarenasallmuzzy_purged}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.pactive {#jemallocarenasallpactive}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.pdirty {#jemallocarenasallpdirty}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.pmuzzy {#jemallocarenasallpmuzzy}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.background_thread.num_runs {#jemallocbackground_threadnum_runs}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.background_thread.num_threads {#jemallocbackground_threadnum_threads}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.background_thread.run_intervals {#jemallocbackground_threadrun_intervals}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.epoch {#jemallocepoch}

Внутренний инкрементальный номер обновления статистики jemalloc (распределителя памяти Джейсона Эванса), используемый во всех остальных метриках `jemalloc`.

### jemalloc.mapped {#jemallocmapped}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.metadata {#jemallocmetadata}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.metadata_thp {#jemallocmetadata_thp}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.resident {#jemallocresident}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.retained {#jemallocretained}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.prof.active {#jemallocprofactive}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

**См. также**

- [Monitoring](../../operations/monitoring.md) — Базовые концепции мониторинга ClickHouse.
- [system.metrics](/operations/system-tables/metrics) — Содержит мгновенно вычисляемые метрики.
- [system.events](/operations/system-tables/events) — Содержит количество произошедших событий.
- [system.metric_log](/operations/system-tables/metric_log) — Содержит историю значений метрик из таблиц `system.metrics` и `system.events`.
