---
description: 'Системная таблица, содержащая метрики, которые периодически вычисляются в фоновом режиме. Например, объем используемой оперативной памяти.'
keywords: ['system table', 'asynchronous_metrics']
slug: /operations/system-tables/asynchronous_metrics
title: 'system.asynchronous_metrics'
doc_type: 'reference'
---

import SystemTableCloud from '@site/i18n/ru/docusaurus-plugin-content-docs/current/_snippets/_system_table_cloud.md';


# system.asynchronous&#95;metrics {#systemasynchronous_metrics}

<SystemTableCloud />

Содержит метрики, которые периодически вычисляются в фоновом режиме. Например, объём используемой оперативной памяти.

Столбцы:

* `metric` ([String](../../sql-reference/data-types/string.md)) — имя метрики.
* `value` ([Float64](../../sql-reference/data-types/float.md)) — значение метрики.
* `description` ([String](../../sql-reference/data-types/string.md)) — описание метрики.

**Пример**

```sql
SELECT * FROM system.asynchronous_metrics LIMIT 10
```

```text
┌─metric──────────────────────────────────┬──────value─┬─description────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ AsynchronousMetricsCalculationTimeSpent │ 0.00179053 │ Time in seconds spent for calculation of asynchronous metrics (this is the overhead of asynchronous metrics).                                                                                                                                              │
│ NumberOfDetachedByUserParts             │          0 │ The total number of parts detached from MergeTree tables by users with the `ALTER TABLE DETACH` query (as opposed to unexpected, broken or ignored parts). The server does not care about detached parts and they can be removed.                          │
│ NumberOfDetachedParts                   │          0 │ The total number of parts detached from MergeTree tables. A part can be detached by a user with the `ALTER TABLE DETACH` query or by the server itself it the part is broken, unexpected or unneeded. The server does not care about detached parts and they can be removed. │
│ TotalRowsOfMergeTreeTables              │    2781309 │ Total amount of rows (records) stored in all tables of MergeTree family.                                                                                                                                                                                   │
│ TotalBytesOfMergeTreeTables             │    7741926 │ Total amount of bytes (compressed, including data and indices) stored in all tables of MergeTree family.                                                                                                                                                   │
│ NumberOfTables                          │         93 │ Total number of tables summed across the databases on the server, excluding the databases that cannot contain MergeTree tables. The excluded database engines are those who generate the set of tables on the fly, like `Lazy`, `MySQL`, `PostgreSQL`, `SQlite`. │
│ NumberOfDatabases                       │          6 │ Total number of databases on the server.                                                                                                                                                                                                                   │
│ MaxPartCountForPartition                │          6 │ Maximum number of parts per partition across all partitions of all tables of MergeTree family. Values larger than 300 indicates misconfiguration, overload, or massive data loading.                                                                       │
│ ReplicasSumMergesInQueue                │          0 │ Sum of merge operations in the queue (still to be applied) across Replicated tables.                                                                                                                                                                       │
│ ReplicasSumInsertsInQueue               │          0 │ Sum of INSERT operations in the queue (still to be replicated) across Replicated tables.                                                                                                                                                                   │
└─────────────────────────────────────────┴────────────┴────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

{/*- В отличие от system.events и system.metrics, асинхронные метрики не собираются в виде простого списка в файле исходного кода — они
      переплетены с логикой в src/Interpreters/ServerAsynchronousMetrics.cpp.
      Здесь они приведены в явном виде для удобства читателя. -*/ }


## Описания метрик {#metric-descriptions}

### AsynchronousHeavyMetricsCalculationTimeSpent {#asynchronousheavymetricscalculationtimespent}

Время в секундах, затраченное на вычисление тяжёлых асинхронных метрик, связанных с таблицами (это накладные расходы, связанные с асинхронными метриками).

### AsynchronousHeavyMetricsUpdateInterval {#asynchronousheavymetricsupdateinterval}

Интервал обновления «тяжёлых» метрик, связанных с таблицами

### AsynchronousMetricsCalculationTimeSpent {#asynchronousmetricscalculationtimespent}

Время в секундах, затраченное на вычисление асинхронных метрик (накладные расходы на асинхронные метрики).

### AsynchronousMetricsUpdateInterval {#asynchronousmetricsupdateinterval}

Интервал обновления метрик

### BlockActiveTime_*name* {#blockactivetime_name}

Время в секундах, в течение которого для блочного устройства были поставлены в очередь запросы ввода-вывода (I/O). Это системная метрика: она учитывает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardBytes_*name* {#blockdiscardbytes_name}

Объём отброшенных байт на блочном устройстве. Эти операции актуальны для SSD. Операции discard не используются ClickHouse, но могут использоваться другими процессами в системе. Это метрика на уровне всей системы, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardMerges_*name* {#blockdiscardmerges_name}

Количество операций сброса (discard), запрошенных для блочного устройства и объединённых планировщиком ввода-вывода ОС. Эти операции актуальны для SSD. Операции сброса не используются ClickHouse, но могут использоваться другими процессами в системе. Это системная метрика, она включает все процессы на хостовой машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardOps_*name* {#blockdiscardops_name}

Количество операций сброса (discard), запрошенных у блочного устройства. Эти операции актуальны для SSD. Операции сброса не используются ClickHouse, но могут использоваться другими процессами в системе. Это системная метрика, она включает все процессы на хостовой машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockDiscardTime_*name* {#blockdiscardtime_name}

Время в секундах, затраченное на операции discard, запрошенные у блочного устройства, суммарно по всем операциям. Эти операции актуальны для SSD. Операции discard не используются ClickHouse, но могут использоваться другими процессами в системе. Это системная метрика, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockInFlightOps_*name* {#blockinflightops_name}

Это значение показывает количество запросов ввода-вывода (I/O), которые были переданы драйверу устройства, но еще не завершены. Оно не включает запросы ввода-вывода, которые находятся в очереди, но еще не переданы драйверу устройства. Это системная метрика; она охватывает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockQueueTime_*name* {#blockqueuetime_name}

Это значение показывает количество миллисекунд, в течение которых запросы ввода-вывода (I/O) ожидали на этом блочном устройстве. Если одновременно ожидает несколько запросов ввода-вывода, это значение увеличивается как произведение числа миллисекунд на число ожидающих запросов. Это системная метрика; она учитывает все процессы на хостовой системе, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadBytes_*name* {#blockreadbytes_name}

Количество байт, прочитанных с блочного устройства. Может быть меньше количества байт, прочитанных из файловой системы, из-за использования кэша страниц ОС, который уменьшает объем операций ввода-вывода (I/O). Это системная метрика, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadMerges_*name* {#blockreadmerges_name}

Количество операций чтения, запрошенных у блочного устройства и объединённых планировщиком ввода-вывода ОС. Это системная метрика; она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadOps_*name* {#blockreadops_name}

Количество операций чтения, запрошенных у блочного устройства. Это системная метрика, она включает все процессы на хостовой машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockReadTime_*name* {#blockreadtime_name}

Время в секундах, затраченное на операции чтения, выполняемые блочным устройством, суммированное по всем операциям. Это метрика уровня всей системы: она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteBytes_*name* {#blockwritebytes_name}

Количество байт, записанных на блочное устройство. Это значение может быть меньше количества байт, записанных в файловую систему, из‑за использования кэша страниц ОС, который уменьшает объем операций ввода‑вывода (I/O). Запись на блочное устройство может произойти позже соответствующей записи в файловую систему из‑за кэширования с прямой записью (write-through caching). Это метрика на уровне всей системы, она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteMerges_*name* {#blockwritemerges_name}

Количество операций записи, запрошенных у блочного устройства и объединённых планировщиком ввода-вывода ОС. Это системная метрика, охватывающая все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteOps_*name* {#blockwriteops_name}

Количество операций записи, запрошенных у блочного устройства. Это метрика на уровне всей системы: она включает все процессы на хосте, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### BlockWriteTime_*name* {#blockwritetime_name}

Время в секундах, затраченное на операции записи, выполняемые блочным устройством, суммарно по всем операциям. Это метрика на уровне всей системы: она учитывает все процессы на хост‑машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt

### CPUFrequencyMHz_*name* {#cpufrequencymhz_name}

Текущая частота процессора в МГц. Большинство современных CPU динамически изменяют частоту для экономии энергии и работы в режиме Turbo Boost.

### DictionaryMaxUpdateDelay {#dictionarymaxlastsuccessfulupdatetime}

Максимально допустимая задержка (в секундах) обновления словаря.

### DictionaryTotalFailedUpdates {#dictionaryloadfailed}

Количество ошибок с момента последней успешной загрузки во всех словарях.

### DiskAvailable_*name* {#diskavailable_name}

Доступное количество байт на диске (на виртуальной файловой системе). Удалённые файловые системы могут показывать очень большие значения, например 16 EiB.

### DiskTotal_*name* {#disktotal_name}

Общий размер диска (виртуальной файловой системы) в байтах. Удалённые файловые системы могут показывать очень большое значение, например 16 EiB.

### DiskUnreserved_*name* {#diskunreserved_name}

Доступное количество байт на диске (на виртуальной файловой системе) без учёта резервов для слияний, выборок и перемещений. Удалённые файловые системы могут показывать очень большое значение, например 16 EiB.

### DiskUsed_*name* {#diskused_name}

Количество использованных байт на диске (виртуальная файловая система). Удалённые файловые системы могут не предоставлять эту информацию.

### FilesystemCacheBytes {#filesystemcachebytes}

Общее количество байт в виртуальной файловой системе `cache`. Этот кэш хранится на диске.

### FilesystemCacheFiles {#filesystemcachefiles}

Общее количество сегментов кэшированных файлов в виртуальной файловой системе `cache`. Этот кэш хранится на диске.

### FilesystemLogsPathAvailableBytes {#filesystemlogspathavailablebytes}

Доступное количество байт на томе, где расположен каталог журналов ClickHouse. Если это значение приближается к нулю, следует настроить ротацию журналов в конфигурационном файле.

### FilesystemLogsPathAvailableINodes {#filesystemlogspathavailableinodes}

Количество доступных inode на томе, где примонтирован каталог с журналами ClickHouse.

### FilesystemLogsPathTotalBytes {#filesystemlogspathtotalbytes}

Размер тома, на который смонтирован каталог с логами ClickHouse, в байтах. Рекомендуется выделять под логи не менее 10 ГБ.

### FilesystemLogsPathTotalINodes {#filesystemlogspathtotalinodes}

Общее количество инодов на томе, где смонтирован каталог с логами ClickHouse.

### FilesystemLogsPathUsedBytes {#filesystemlogspathusedbytes}

Занято байт на томе, где смонтирован путь к логам ClickHouse.

### FilesystemLogsPathUsedINodes {#filesystemlogspathusedinodes}

Количество использованных инодов на томе, где смонтирован каталог журналов ClickHouse.

### FilesystemMainPathAvailableBytes {#filesystemmainpathavailablebytes}

Доступное количество байт на томе, где смонтирован основной каталог ClickHouse.

### FilesystemMainPathAvailableINodes {#filesystemmainpathavailableinodes}

Количество доступных inode на томе, где смонтирован основной каталог ClickHouse. Если это значение близко к нулю, это указывает на некорректную конфигурацию, и вы получите сообщение об ошибке «no space left on device», даже если диск не заполнен.

### FilesystemMainPathTotalBytes {#filesystemmainpathtotalbytes}

Размер тома, на который смонтирован основной каталог ClickHouse, в байтах.

### FilesystemMainPathTotalINodes {#filesystemmainpathtotalinodes}

Общее количество inode на томе файловой системы, где смонтирован основной путь ClickHouse. Если оно меньше 25 миллионов, это говорит о некорректной конфигурации.

### FilesystemMainPathUsedBytes {#filesystemmainpathusedbytes}

Количество использованных байт на томе, где смонтирован основной путь ClickHouse.

### FilesystemMainPathUsedINodes {#filesystemmainpathusedinodes}

Количество использованных инодов на томе, где смонтирован основной каталог ClickHouse. Это значение, как правило, соответствует количеству файлов.

### HTTPThreads {#httpthreads}

Количество потоков сервера HTTP-интерфейса (без TLS).

### InterserverThreads {#interserverthreads}

Количество потоков в сервере протокола взаимодействия реплик (без TLS).

### Джиттер {#jitter}

Разница между моментом времени, когда было запланировано пробуждение потока, выполняющего вычисление асинхронных метрик, и моментом времени, когда он был фактически пробуждён. Является косвенным индикатором общей задержки и отзывчивости системы.

### LoadAverage*N* {#loadaveragen}

Суммарная нагрузка на всю систему, усреднённая с помощью экспоненциального сглаживания за 1 минуту. Нагрузка представляет собой количество потоков во всех процессах (сущностях планировщика ядра ОС), которые в данный момент выполняются на CPU, ожидают I/O или готовы к выполнению, но прямо сейчас не запланированы к исполнению. Это число включает все процессы, а не только clickhouse-server. Значение может быть больше количества ядер CPU, если система перегружена и многие процессы готовы к выполнению, но ожидают CPU или I/O.

### MaxPartCountForPartition {#maxpartcountforpartition}

Максимальное количество частей на партицию во всех партициях всех таблиц семейства MergeTree. Значения более 300 указывают на неверную конфигурацию, перегрузку или массовую загрузку данных.

### MemoryCode {#memorycode}

Объём виртуальной памяти, сопоставленной со страницами машинного кода серверного процесса, в байтах.

### MemoryDataAndStack {#memorydataandstack}

Объём виртуальной памяти, отображённой под стек и динамически выделяемую память, в байтах. Не определено, включает ли он стеки отдельных потоков и большую часть памяти, выделяемой системным вызовом `mmap`. Эта метрика существует только для полноты описания. Для мониторинга рекомендуется использовать метрику `MemoryResident`.

### MemoryResidentMax {#memoryresidentmax}

Максимальный объем физической памяти, используемой серверным процессом, в байтах.

### MemoryResident {#memoryresident}

Объём физической памяти, потребляемый серверным процессом, в байтах.

### MemoryShared {#memoryshared}

Объём памяти, используемой серверным процессом и одновременно другими процессами, в байтах. ClickHouse не использует разделяемую память, но часть памяти может помечаться ОС как разделяемая по её собственным причинам. Эта метрика почти не имеет смысла для мониторинга и существует только для полноты.

### MemoryVirtual {#memoryvirtual}

Размер виртуального адресного пространства, выделенного серверным процессом, в байтах. Размер виртуального адресного пространства, как правило, значительно больше фактического потребления физической памяти и не должен использоваться для оценки реального потребления памяти. Большие значения этой метрики являются совершенно нормальными и имеют только технический смысл.

### MySQLThreads {#mysqlthreads}

Количество потоков на сервере протокола совместимости с MySQL.

### NetworkReceiveBytes_*name* {#networkreceivebytes_name}

Количество байт, полученных через сетевой интерфейс. Это метрика на уровне всей системы: она учитывает все процессы на хосте, а не только clickhouse-server.

### NetworkReceiveDrop_*name* {#networkreceivedrop_name}

Объём данных в байтах в пакетах, отброшенных при приёме через сетевой интерфейс. Это системная метрика: она включает все процессы на хосте, а не только clickhouse-server.

### NetworkReceiveErrors_*name* {#networkreceiveerrors_name}

Количество случаев возникновения ошибок при приёме данных через сетевой интерфейс. Это общесистемная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server.

### NetworkReceivePackets_*name* {#networkreceivepackets_name}

Количество сетевых пакетов, полученных через сетевой интерфейс. Это системная метрика: она включает все процессы на хосте, а не только clickhouse-server.

### NetworkSendBytes_*name* {#networksendbytes_name}

Количество байт, отправленных через сетевой интерфейс. Это метрика уровня всей системы; она учитывает все процессы на хосте, а не только clickhouse-server.

### NetworkSendDrop_*name* {#networksenddrop_name}

Количество раз, когда пакет был отброшен при отправке через сетевой интерфейс. Это системная метрика, она включает все процессы на хостовой машине, а не только clickhouse-server.

### NetworkSendErrors_*name* {#networksenderrors_name}

Количество ошибок (например, повторных передач TCP), возникших при отправке данных через сетевой интерфейс. Это метрика на уровне всей системы: она учитывает все процессы на хосте, а не только clickhouse-server.

### NetworkSendPackets_*name* {#networksendpackets_name}

Количество сетевых пакетов, отправленных через сетевой интерфейс. Это системная метрика: она включает все процессы на хосте, а не только clickhouse-server.

### NumberOfDatabases {#numberofdatabases}

Общее количество баз данных на сервере.

### NumberOfDetachedByUserParts {#numberofdetachedbyuserparts}

Общее количество частей, отсоединённых от таблиц MergeTree пользователями с помощью запроса `ALTER TABLE DETACH` (в отличие от неожиданных, повреждённых или игнорируемых частей). Сервер не отслеживает отсоединённые части, и их можно удалить.

### NumberOfDetachedParts {#numberofdetachedparts}

Общее количество частей, отсоединённых от таблиц MergeTree. Часть может быть отсоединена пользователем с помощью запроса `ALTER TABLE DETACH` или самим сервером, если часть повреждена, появилась неожиданно или не требуется. Сервер не использует отсоединённые части, и их можно удалить.

### NumberOfTables {#numberoftables}

Общее суммарное количество таблиц по всем базам данных на сервере, за исключением баз данных, которые не могут содержать таблицы MergeTree. Исключаемые движки баз данных — это те, которые формируют набор таблиц «на лету», такие как `Lazy`, `MySQL`, `PostgreSQL`, `SQlite`.

### OSContextSwitches {#oscontextswitches}

Количество переключений контекста, которые система выполнила на хостовой машине. Это метрика на уровне всей системы: она включает все процессы на данном хосте, а не только clickhouse-server.

### OSGuestNiceTime {#osguestnicetime}

Отношение времени, проведённого на выполнении виртуального CPU для гостевых операционных систем под управлением ядра Linux, когда гостевая система была переведена на более высокий приоритет (см. `man procfs`). Это системная метрика; она включает все процессы на хостовой машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но приводится для полноты. Значение для одного ядра CPU будет в диапазоне [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSGuestNiceTimeCPU_*N* {#osguestnicetimecpu_n}

Отношение времени, затраченного на работу виртуального CPU для гостевых операционных систем под управлением ядра Linux, когда для гостевой системы был установлен более высокий приоритет (см. `man procfs`). Это системная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server. Эта метрика не имеет прямого отношения к ClickHouse, но приведена для полноты. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма значений по всем ядрам [0..число ядер].

### OSGuestNiceTimeNormalized {#osguestnicetimenormalized}

Значение аналогично `OSGuestNiceTime`, но делится на количество ядер CPU, чтобы находиться в интервале [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неоднородно, и при этом получать среднее значение метрики использования ресурсов.

### OSGuestTime {#osguesttime}

Отношение времени, в течение которого виртуальный CPU выполнял гостевые операционные системы под управлением ядра Linux (см. `man procfs`). Это системная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но присутствует для полноты. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..num cores].

### OSGuestTimeCPU_*N* {#osguesttimecpu_n}

Отношение времени, в течение которого выполняется виртуальный CPU для гостевых операционных систем под управлением ядра Linux (см. `man procfs`). Это общесистемная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server. Эта метрика не представляет интереса для ClickHouse, но приводится для полноты. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..число ядер].

### OSGuestTimeNormalized {#osguesttimenormalized}

Значение аналогично `OSGuestTime`, но делится на количество ядер CPU, чтобы лежать в интервале [0..1] независимо от числа ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неоднородно, и при этом получать корректную среднюю метрику использования ресурсов.

### OSIOWaitTime {#osiowaittime}

Доля времени, когда вычислительное ядро CPU не выполняло код, но при этом ядро ОС не запускало на этом CPU никакие другие процессы, поскольку процессы ожидали операций ввода-вывода (IO). Это системная метрика: она охватывает все процессы на хостовой машине, а не только clickhouse-server. Значение для одного вычислительного ядра CPU лежит в интервале [0..1]. Значение для всех вычислительных ядер CPU рассчитывается как сумма по всем ядрам [0..количество ядер].

### OSIOWaitTimeCPU_*N* {#osiowaittimecpu_n}

Доля времени, в течение которого ядро CPU не выполняло код, но при этом ядро ОС не запускало на данном CPU никакие другие процессы, поскольку процессы ожидали операции ввода-вывода (I/O). Это системная метрика: она учитывает все процессы на хосте, а не только clickhouse-server. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..число ядер].

### OSIOWaitTimeNormalized {#osiowaittimenormalized}

Значение аналогично `OSIOWaitTime`, но делится на количество ядер CPU, чтобы лежать в диапазоне [0..1] независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер различается, и при этом получать усреднённый показатель использования ресурсов.

### OSIdleTime {#osidletime}

Отношение времени, в течение которого ядро CPU простаивало (не было даже готово к выполнению процесса, ожидающего IO), с точки зрения ядра ОС. Это системная метрика: она включает все процессы на хостовой системе, а не только clickhouse-server. В нее не входит время, когда загрузка CPU была ниже максимальной по причинам, внутренним для самого CPU (загрузки памяти, остановки конвейера, ошибки предсказания переходов, выполнение другого SMT-ядра). Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..число ядер].

### OSIdleTimeCPU_*N* {#osidletimecpu_n}

Отношение времени, в течение которого ядро CPU простаивало (даже не было готово к выполнению процесса, ожидающего ввода‑вывода), с точки зрения ядра ОС. Это системная метрика: она учитывает все процессы на хостовой машине, а не только clickhouse-server. Сюда не входит время, когда CPU был недоиспользован по причинам, внутренним для самого CPU (загрузки из памяти, простои конвейера, ошибки предсказания переходов, выполнение другого SMT‑ядра). Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как их сумма и находится в интервале [0..число ядер].

### OSIdleTimeNormalized {#osidletimenormalized}

Значение похоже на `OSIdleTime`, но делится на количество ядер CPU, чтобы находиться в интервале [0..1] независимо от числа ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере даже при различном количестве ядер и при этом получать среднюю метрику использования ресурсов.

### OSInterrupts {#osinterrupts}

Количество прерываний на хосте. Это метрика на уровне всей системы: она учитывает все процессы на хосте, а не только clickhouse-server.

### OSIrqTime {#osirqtime}

Относительная доля времени, затраченного CPU на обработку аппаратных запросов прерываний (IRQ). Это системная метрика: она включает все процессы на хосте, а не только clickhouse-server. Высокое значение этой метрики может указывать на некорректную конфигурацию оборудования или очень высокую сетевую нагрузку. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSIrqTimeCPU_*N* {#osirqtimecpu_n}

Отношение времени, затраченного на обработку аппаратных прерываний на CPU. Это метрика на уровне всей системы: она учитывает все процессы на хостовой машине, а не только clickhouse-server. Высокое значение этой метрики может указывать на некорректную конфигурацию аппаратного обеспечения или очень высокую сетевую нагрузку. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как их сумма и лежит в интервале [0..число ядер].

### OSIrqTimeNormalized {#osirqtimenormalized}

Значение аналогично `OSIrqTime`, но делённое на количество ядер CPU, чтобы измеряться в интервале [0..1] независимо от числа ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если число ядер на них различается, и при этом получать усреднённую метрику использования ресурсов.

### OSMemoryAvailable {#osmemoryavailable}

Объём доступной для использования программами памяти (в байтах). Очень похожа на метрику `OSMemoryFreePlusCached`. Это метрика на уровне всей системы: она учитывает все процессы на хостовой машине, а не только clickhouse-server.

### OSMemoryBuffers {#osmemorybuffers}

Объём памяти, используемой буферами ядра ОС, в байтах. Обычно это значение должно быть небольшим; большие значения могут указывать на некорректную конфигурацию ОС. Это системная метрика: она охватывает все процессы на хосте, а не только clickhouse-server.

### OSMemoryCached {#osmemorycached}

Объем памяти, используемой кэшем страниц ОС, в байтах. Как правило, почти вся доступная память используется кэшем страниц ОС — высокие значения этой метрики являются нормальными и ожидаемыми. Это системная метрика: она включает все процессы на хосте, а не только clickhouse-server.

### OSMemoryFreePlusCached {#osmemoryfreepluscached}

Количество свободной памяти плюс память кэша страниц ОС на хост-системе, в байтах. Эта память доступна для использования программами. Значение должно быть очень близко к `OSMemoryAvailable`. Это системная метрика: она учитывает все процессы на хосте, а не только clickhouse-server.

### OSMemoryFreeWithoutCached {#osmemoryfreewithoutcached}

Объём свободной памяти на хост-системе в байтах. Сюда не входит память, используемая кэшем страниц ОС. Память кэша страниц также доступна для использования программами, поэтому значение этого метрика может быть сбивающим с толку. Вместо этого см. метрику `OSMemoryAvailable`. Для удобства мы также предоставляем метрику `OSMemoryFreePlusCached`, которая должна быть в некоторой степени похожа на OSMemoryAvailable. См. также https://www.linuxatemyram.com/. Это системный метрик: он включает все процессы на хост-машине, а не только clickhouse-server.

### OSMemoryTotal {#osmemorytotal}

Общий объём памяти на хосте, в байтах.

### OSNiceTime {#osnicetime}

Доля времени, в течение которого ядро CPU выполняло пользовательский код в пространстве пользователя (userspace) с повышенным приоритетом. Это системная метрика: она учитывает все процессы на хосте, а не только clickhouse-server. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSNiceTimeCPU_*N* {#osnicetimecpu_n}

Доля времени, когда ядро CPU выполняло пользовательский код с более высоким приоритетом. Это системная метрика: она учитывает все процессы на хосте, а не только clickhouse-server. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSNiceTimeNormalized {#osnicetimenormalized}

Значение аналогично `OSNiceTime`, но делится на количество ядер CPU и тем самым нормализуется к интервалу [0..1] независимо от числа ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер на них различается, и при этом получать среднюю метрику использования ресурсов.

### OSOpenFiles {#osopenfiles}

Общее количество открытых файлов на хостовой машине. Это системная метрика на уровне всей системы: она включает все процессы на хостовой машине, а не только clickhouse-server.

### OSProcessesBlocked {#osprocessesblocked}

Количество потоков, ожидающих завершения операций ввода-вывода (`man procfs`). Это системная метрика: она включает все процессы на хосте, а не только clickhouse-server.

### OSProcessesCreated {#osprocessescreated}

Количество созданных процессов. Это системная метрика: она включает все процессы на хосте, а не только clickhouse-server.

### OSProcessesRunning {#osprocessesrunning}

Количество исполняемых потоков (работающих или готовых к выполнению) с точки зрения операционной системы. Это метрика на уровне всей системы, она включает все процессы на хостовой машине, а не только clickhouse-server.

### OSSoftIrqTime {#ossoftirqtime}

Отношение времени, затраченного на обработку программных прерываний (software interrupts) на CPU. Это системная метрика, она учитывает все процессы на хост-машине, а не только clickhouse-server. Высокое значение этой метрики может указывать на неэффективную работу программного обеспечения в системе. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма значений по всем ядрам [0..num cores].

### OSSoftIrqTimeCPU_*N* {#ossoftirqtimecpu_n}

Доля времени, затраченного на обработку программных прерываний на CPU. Это системная метрика: она учитывает все процессы на хосте, а не только clickhouse-server. Высокое значение этой метрики может указывать на неэффективно работающее программное обеспечение в системе. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..число ядер].

### OSSoftIrqTimeNormalized {#ossoftirqtimenormalized}

Значение аналогично `OSSoftIrqTime`, но делится на количество процессорных ядер, чтобы находиться в интервале [0..1] независимо от числа ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер отличается, и при этом получать среднюю метрику использования ресурсов.

### OSStealTime {#osstealtime}

Отношение времени, которое CPU проводит в других операционных системах при работе в виртуализированной среде. Это системная метрика: она включает все процессы на хостовой машине, а не только clickhouse-server. Не каждая виртуализированная среда предоставляет эту метрику, и большинство — нет. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам и лежит в интервале [0..num cores].

### OSStealTimeCPU_*N* {#osstealtimecpu_n}

Отношение времени, которое CPU проводит в других операционных системах при работе в виртуализированной среде. Это системная метрика: она учитывает все процессы на хостовой машине, а не только clickhouse-server. Не во всех виртуализированных средах эта метрика доступна, и в большинстве случаев её нет. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSStealTimeNormalized {#osstealtimenormalized}

Значение аналогично `OSStealTime`, но делится на количество ядер CPU, чтобы измеряться в интервале [0..1] независимо от их числа. Это позволяет усреднять значения этого метрика по нескольким серверам кластера, даже если количество ядер неоднородно, и при этом получать средний показатель использования ресурсов.

### OSSystemTime {#ossystemtime}

Доля времени, в течение которого ядро CPU выполняло код ядра ОС (system). Это метрика для всей системы: она учитывает все процессы на хост‑машине, а не только clickhouse-server. Значение для одного ядра CPU находится в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма значений по всем ядрам [0..num cores].

### OSSystemTimeCPU_*N* {#ossystemtimecpu_n}

Отношение времени, в течение которого ядро CPU выполняло код ядра операционной системы (system). Это системная метрика: она учитывает все процессы на хост‑машине, а не только clickhouse-server. Значение для одного ядра CPU лежит в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по всем ядрам [0..число ядер].

### OSSystemTimeNormalized {#ossystemtimenormalized}

Значение аналогично `OSSystemTime`, но нормируется по количеству ядер CPU, чтобы лежать в интервале [0..1] независимо от числа ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер различается, и при этом получать средний показатель использования ресурсов.

### OSThreadsRunnable {#osthreadsrunnable}

Общее количество потоков в состоянии «runnable», как их видит планировщик ядра операционной системы.

### OSThreadsTotal {#osthreadstotal}

Общее количество потоков, как его видит планировщик ядра операционной системы.

### OSUptime {#osuptime}

Время непрерывной работы хост-сервера (машины, на которой запущен ClickHouse), в секундах.

### OSUserTime {#osusertime}

Доля времени, в течение которого ядро CPU выполняло код в пространстве пользователя. Это метрика на уровне всей системы; она включает все процессы на хостовой машине, а не только clickhouse-server. Сюда также входит время, когда CPU был недоиспользован по причинам, связанным с самим CPU (загрузки из памяти, простои конвейера, ошибочные предсказания переходов, выполнение другого SMT‑потока). Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSUserTimeCPU_*N* {#osusertimecpu_n}

Доля времени, в течение которого ядро CPU выполняло пользовательский код (userspace). Это метрика на уровне всей системы: она учитывает все процессы на хостовой машине, а не только clickhouse-server. Сюда также входит время, когда CPU был недогружен по причинам, внутренним для самого CPU (загрузки памяти, остановка конвейера, ошибочные предсказания переходов, выполнение другого SMT-ядра). Значение для одного ядра CPU будет находиться в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма по всем ядрам [0..количество ядер].

### OSUserTimeNormalized {#osusertimenormalized}

Значение аналогично `OSUserTime`, но делится на количество ядер CPU, чтобы находиться в интервале [0..1] независимо от числа ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неоднородно, и при этом получать усреднённый показатель использования ресурсов.

### PostgreSQLThreads {#postgresqlthreads}

Количество потоков на сервере протокола совместимости PostgreSQL.

### ReplicasMaxAbsoluteDelay {#replicasmaxabsolutedelay}

Максимальная разница в секундах между самой свежей реплицированной частью и самой свежей частью данных, которую ещё предстоит реплицировать, по таблицам типа Replicated. Очень большое значение указывает на реплику без данных.

### ReplicasMaxInsertsInQueue {#replicasmaxinsertsinqueue}

Максимальное количество операций INSERT в очереди (ещё не реплицированных) во всех Replicated-таблицах.

### ReplicasMaxMergesInQueue {#replicasmaxmergesinqueue}

Максимальное количество операций слияния в очереди (ещё не выполненных) во всех таблицах Replicated.

### ReplicasMaxQueueSize {#replicasmaxqueuesize}

Максимальный размер очереди (по количеству операций, таких как get, merge) во всех реплицируемых таблицах.

### ReplicasMaxRelativeDelay {#replicasmaxrelativedelay}

Максимальная разница между задержкой реплики и задержкой наиболее актуальной реплики той же таблицы во всех таблицах типа Replicated.

### ReplicasSumInsertsInQueue {#replicassuminsertsinqueue}

Сумма операций INSERT в очереди (ожидающих репликации) по всем реплицированным таблицам.

### ReplicasSumMergesInQueue {#replicassummergesinqueue}

Суммарное количество операций слияния в очереди (ещё не применённых) по всем реплицированным таблицам.

### ReplicasSumQueueSize {#replicassumqueuesize}

Суммарный размер очереди (в количестве операций типа get, merge) по всем реплицированным таблицам.

### TCPThreads {#tcpthreads}

Количество потоков на сервере протокола TCP (без TLS).

### Temperature_*N* {#temperature_n}

Температура соответствующего устройства в ℃. Датчик может сообщить нереалистичное значение. Источник: `/sys/class/thermal`

### Temperature_*name* {#temperature_name}

Температура в ℃, считываемая соответствующим аппаратным монитором и датчиком. Датчик может возвращать нереалистичное значение. Источник: `/sys/class/hwmon`

### TotalBytesOfMergeTreeTables {#totalbytesofmergetreetables}

Общий объем (в байтах, в сжатом виде, включая данные и индексы), хранящийся во всех таблицах семейства MergeTree.

### TotalPartsOfMergeTreeTables {#totalpartsofmergetreetables}

Общее количество частей во всех таблицах семейства MergeTree. Значения свыше 10 000 ухудшают время запуска сервера и могут указывать на неудачный выбор ключа партиции.

### TotalPrimaryKeyBytesInMemory {#totalprimarykeybytesinmemory}

Общее количество памяти (в байтах), используемой под значения первичного ключа (учитываются только активные части).

### TotalPrimaryKeyBytesInMemoryAllocated {#totalprimarykeybytesinmemoryallocated}

Общий объем памяти (в байтах), выделенной под значения первичного ключа (учитываются только активные части).

### TotalRowsOfMergeTreeTables {#totalrowsofmergetreetables}

Общее количество строк (записей), хранящихся во всех таблицах семейства движков MergeTree.

### Время работы сервера {#uptime}

Время работы сервера в секундах. Включает время, затраченное на инициализацию сервера до начала принятия подключений.

### ZooKeeperClientLastZXIDSeen {#zookeeperclientlastzxidseen}

Последний ZXID, зафиксированный в текущей сессии клиента ZooKeeper. Это значение монотонно возрастает по мере того, как клиент наблюдает транзакции ZooKeeper.

### jemalloc.active {#jemallocactive}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). Подробнее см. https://jemalloc.net/jemalloc.3.html

### jemalloc.allocated {#jemallocallocated}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). Подробнее см. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.dirty_purged {#jemallocarenasalldirty_purged}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.muzzy_purged {#jemallocarenasallmuzzy_purged}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.pactive {#jemallocarenasallpactive}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). Подробнее см. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.pdirty {#jemallocarenasallpdirty}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). Подробнее см. https://jemalloc.net/jemalloc.3.html

### jemalloc.arenas.all.pmuzzy {#jemallocarenasallpmuzzy}

Внутренняя метрика низкоуровневого аллокатора памяти jemalloc. См. https://jemalloc.net/jemalloc.3.html

### jemalloc.background_thread.num_runs {#jemallocbackground_threadnum_runs}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). Подробнее см. на https://jemalloc.net/jemalloc.3.html

### jemalloc.background_thread.num_threads {#jemallocbackground_threadnum_threads}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.background_thread.run_intervals {#jemallocbackground_threadrun_intervals}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См.: https://jemalloc.net/jemalloc.3.html

### jemalloc.epoch {#jemallocepoch}

Внутренний порядковый номер обновления статистики jemalloc (распределителя памяти Джейсона Эванса), используемый во всех остальных метриках `jemalloc`.

### jemalloc.mapped {#jemallocmapped}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). Подробнее см. https://jemalloc.net/jemalloc.3.html

### jemalloc.metadata {#jemallocmetadata}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.metadata_thp {#jemallocmetadata_thp}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.resident {#jemallocresident}

Внутренняя метрика низкоуровневого аллокатора памяти jemalloc. См. https://jemalloc.net/jemalloc.3.html

### jemalloc.retained {#jemallocretained}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

### jemalloc.prof.active {#jemallocprofactive}

Внутренняя метрика низкоуровневого распределителя памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

**См. также**

- [Monitoring](../../operations/monitoring.md) — Базовые концепции мониторинга ClickHouse.
- [system.metrics](/operations/system-tables/metrics) — Содержит мгновенно вычисляемые метрики.
- [system.events](/operations/system-tables/events) — Содержит счётчики произошедших событий.
- [system.metric_log](/operations/system-tables/metric_log) — Содержит историю значений метрик из таблиц `system.metrics` и `system.events`.