---
slug: '/sql-reference/table-functions/hdfsCluster'
sidebar_label: hdfsCluster
sidebar_position: 81
description: 'Позволяет обрабатывать файлы из HDFS параллельно с множества узлов'
title: hdfsCluster
doc_type: reference
---
# hdfsCluster Табличная Функция

Позволяет обрабатывать файлы из HDFS параллельно с многих узлов в заданном кластере. На инициаторе она создает соединение со всеми узлами в кластере, раскрывает звездочки в пути к файлу HDFS и динамически распределяет каждый файл. На узле-работнике она запрашивает у инициатора следующую задачу для обработки и выполняет её. Это повторяется до тех пор, пока все задачи не будут завершены.

## Синтаксис {#syntax}

```sql
hdfsCluster(cluster_name, URI, format, structure)
```

## Аргументы {#arguments}

| Аргумент       | Описание                                                                                                                                                                                                                                                                                          |
|----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `cluster_name` | Имя кластера, которое используется для построения набора адресов и параметров соединения с удаленными и локальными серверами.                                                                                                                                                                    |
| `URI`          | URI к файлу или группе файлов. Поддерживает следующие подстановочные знаки в режиме только для чтения: `*`, `**`, `?`, `{'abc','def'}` и `{N..M}`, где `N`, `M` — числа, `abc`, `def` — строки. Для получения дополнительной информации см. [Подстановочные знаки в пути](../../engines/table-engines/integrations/s3.md#wildcards-in-path). |
| `format`       | [формат](/sql-reference/formats) файла.                                                                                                                                                                                                                                                        |
| `structure`    | Структура таблицы. Формат `'имя_колонки1 тип_колонки1, имя_колонки2 тип_колонки2, ...'`.                                                                                                                                                                                                          |

## Возвращаемое значение {#returned_value}

Таблица с заданной структурой для чтения данных в указанном файле.

## Примеры {#examples}

1.  Предположим, что у нас есть кластер ClickHouse с именем `cluster_simple` и несколько файлов со следующими URI в HDFS:

- 'hdfs://hdfs1:9000/some_dir/some_file_1'
- 'hdfs://hdfs1:9000/some_dir/some_file_2'
- 'hdfs://hdfs1:9000/some_dir/some_file_3'
- 'hdfs://hdfs1:9000/another_dir/some_file_1'
- 'hdfs://hdfs1:9000/another_dir/some_file_2'
- 'hdfs://hdfs1:9000/another_dir/some_file_3'

2.  Запросите количество строк в этих файлах:

```sql
SELECT count(*)
FROM hdfsCluster('cluster_simple', 'hdfs://hdfs1:9000/{some,another}_dir/some_file_{1..3}', 'TSV', 'name String, value UInt32')
```

3.  Запросите количество строк во всех файлах этих двух директорий:

```sql
SELECT count(*)
FROM hdfsCluster('cluster_simple', 'hdfs://hdfs1:9000/{some,another}_dir/*', 'TSV', 'name String, value UInt32')
```

:::note
Если ваш список файлов содержит диапазоны чисел с Leading Zeros, используйте конструкцию с фигурными скобками для каждой цифры отдельно или используйте `?`.
:::

## Связанные {#related}

- [HDFS движок](../../engines/table-engines/integrations/hdfs.md)
- [HDFS табличная функция](../../sql-reference/table-functions/hdfs.md)