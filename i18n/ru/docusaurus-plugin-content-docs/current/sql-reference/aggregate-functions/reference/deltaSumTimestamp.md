---
description: 'Добавляет разность между последовательными строками. Если разность отрицательная,
  она игнорируется.'
slug: /sql-reference/aggregate-functions/reference/deltasumtimestamp
title: 'deltaSumTimestamp'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## deltaSumTimestamp \{#deltaSumTimestamp\}

Добавлена в версии: v21.6

Добавляет разность между последовательными строками. Если разность отрицательная, она игнорируется.

Эта функция в первую очередь предназначена для [materialized views](/sql-reference/statements/create/view#materialized-view), которые хранят данные, упорядоченные по метке времени, приведённой к шагу временного бакета, например, к бакету `toStartOfMinute`. Поскольку строки в таком materialized view имеют одинаковую метку времени, их невозможно корректно объединить в нужном порядке без хранения исходного, неокруглённого значения метки времени. Функция `deltaSumTimestamp` отслеживает исходный `timestamp` значений, которые были обработаны, поэтому значения (состояния) функции корректно вычисляются во время слияния частей.

Чтобы вычислить сумму дельт по упорядоченной коллекции, вы можете просто использовать функцию [`deltaSum`](/sql-reference/aggregate-functions/reference/deltasum).

**Синтаксис**

```sql
deltaSumTimestamp(value, timestamp)
```

**Аргументы**

* `value` — Входные значения. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Date`](/sql-reference/data-types/date) или [`DateTime`](/sql-reference/data-types/datetime)
* `timestamp` — Параметр для упорядочения значений. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Date`](/sql-reference/data-types/date) или [`DateTime`](/sql-reference/data-types/datetime)

**Возвращаемое значение**

Возвращает накопленные разности между последовательными значениями, упорядоченными по параметру `timestamp`. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Date`](/sql-reference/data-types/date) или [`DateTime`](/sql-reference/data-types/datetime)

**Примеры**

**Базовое использование с упорядочением по метке времени**

```sql title=Query
SELECT deltaSumTimestamp(value, timestamp)
FROM (SELECT number AS timestamp, [0, 4, 8, 3, 0, 0, 0, 1, 3, 5][number] AS value FROM numbers(1, 10))
```

```response title=Response
┌─deltaSumTimestamp(value, timestamp)─┐
│                                  13 │
└─────────────────────────────────────┘
```

{/*AUTOGENERATED_END*/ }
