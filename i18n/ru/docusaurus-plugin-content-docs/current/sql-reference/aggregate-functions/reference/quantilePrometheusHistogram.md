---
description: 'Вычисляет квантиль по гистограмме с использованием линейной интерполяции.'
slug: /sql-reference/aggregate-functions/reference/quantilePrometheusHistogram
title: 'quantilePrometheusHistogram'
doc_type: 'reference'
---

# quantilePrometheusHistogram {#quantileprometheushistogram}

Вычисляет [квантиль](https://en.wikipedia.org/wiki/Quantile) гистограммы с использованием линейной интерполяции, учитывая накопленные значения и верхние границы каждого бакета гистограммы.

Для получения интерполированного значения все переданные значения объединяются в массив, который затем сортируется по соответствующим значениям верхних границ бакетов. Затем интерполяция квантиля выполняется аналогично функции PromQL [histogram&#95;quantile()](https://prometheus.io/docs/prometheus/latest/querying/functions/#histogram_quantile) для классической гистограммы, выполняя линейную интерполяцию между нижней и верхней границами бакета, в котором находится позиция квантиля.

**Синтаксис**

```sql
quantilePrometheusHistogram(level)(bucket_upper_bound, cumulative_bucket_value)
```

**Аргументы**

* `level` — Уровень квантиля. Необязательный параметр. Константа с плавающей запятой от 0 до 1. Рекомендуется использовать значение `level` в диапазоне `[0.01, 0.99]`. Значение по умолчанию: `0.5`. При `level=0.5` функция вычисляет [медиану](https://en.wikipedia.org/wiki/Median).

* `bucket_upper_bound` — Верхние границы бакетов гистограммы.

  * Наибольший бакет должен иметь верхнюю границу `+Inf`.

* `cumulative_bucket_value` — Накопительные значения бакетов гистограммы типа [UInt](../../../sql-reference/data-types/int-uint) или [Float64](../../../sql-reference/data-types/float.md).

  * Значения должны монотонно возрастать по мере увеличения верхней границы бакета.

**Возвращаемое значение**

* Квантиль указанного уровня.

Тип:

* `Float64`.

**Пример**

Входная таблица:

```text
   ┌─bucket_upper_bound─┬─cumulative_bucket_value─┐
1. │                  0 │                       6 │
2. │                0.5 │                      11 │
3. │                  1 │                      14 │
4. │                inf │                      19 │
   └────────────────────┴─────────────────────────┘
```

Результат:

```text
   ┌─quantilePrometheusHistogram(bucket_upper_bound, cumulative_bucket_value)─┐
1. │                                                                     0.35 │
   └──────────────────────────────────────────────────────────────────────────┘
```

**См. также**

* [median](/sql-reference/aggregate-functions/reference/median)
* [quantiles](../../../sql-reference/aggregate-functions/reference/quantiles.md)

{/*AUTOGENERATED_START*/ }

{/*AUTOGENERATED_END*/ }
