---
description: 'Применяет алгоритм Largest-Triangle-Three-Buckets к входным данным.'
sidebar_label: 'largestTriangleThreeBuckets'
slug: /sql-reference/aggregate-functions/reference/largestTriangleThreeBuckets
title: 'largestTriangleThreeBuckets'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## largestTriangleThreeBuckets \{#largestTriangleThreeBuckets\}

Введена в версии: v23.10

Применяет алгоритм [Largest-Triangle-Three-Buckets](https://skemman.is/bitstream/1946/15343/3/SS_MSthesis.pdf) к входным данным.
Алгоритм используется для даунсемплинга (прореживания) временных рядов для целей визуализации.
Он предназначен для работы с рядами, отсортированными по координате `x`.
Работает путём разбиения отсортированного ряда на бакеты и последующего поиска наибольшего треугольника в каждом бакете.
Количество бакетов равно количеству точек в результирующем ряду.
Функция отсортирует данные по `x`, а затем применит алгоритм даунсемплинга к отсортированным данным.

Значения NaN игнорируются во входном ряду, то есть любые значения NaN будут исключены из анализа.
Это гарантирует, что функция работает только с корректными числовыми данными.

**Синтаксис**

```sql
largestTriangleThreeBuckets(n)(x, y)
```

**Псевдонимы**: `lttb`

**Параметры**

* `n` — число точек в результирующем ряду. [`UInt64`](/sql-reference/data-types/int-uint)

**Аргументы**

* `x` — координата x. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal) или [`Date`](/sql-reference/data-types/date) или [`Date32`](/sql-reference/data-types/date32) или [`DateTime`](/sql-reference/data-types/datetime) или [`DateTime64`](/sql-reference/data-types/datetime64)
* `y` — координата y. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal) или [`Date`](/sql-reference/data-types/date) или [`Date32`](/sql-reference/data-types/date32) или [`DateTime`](/sql-reference/data-types/datetime) или [`DateTime64`](/sql-reference/data-types/datetime64)

**Возвращаемое значение**

Возвращает массив кортежей с двумя элементами. [`Array(Tuple(Float64, Float64))`](/sql-reference/data-types/array)

**Примеры**

**Прореживание данных временных рядов**

```sql title=Query
CREATE TABLE largestTriangleThreeBuckets_test (x Float64, y Float64) ENGINE = Memory;
INSERT INTO largestTriangleThreeBuckets_test VALUES
    (1.0, 10.0), (2.0, 20.0), (3.0, 15.0), (8.0, 60.0), (9.0, 55.0),
    (10.0, 70.0), (4.0, 30.0), (5.0, 40.0), (6.0, 35.0), (7.0, 50.0);

SELECT largestTriangleThreeBuckets(4)(x, y) FROM largestTriangleThreeBuckets_test;
```

```response title=Response
┌────────largestTriangleThreeBuckets(4)(x, y)───────────┐
│           [(1,10),(3,15),(9,55),(10,70)]              │
└───────────────────────────────────────────────────────┘
```

{/*AUTOGENERATED_END*/ }
