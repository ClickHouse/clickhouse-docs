---
description: 'Вычисляет приблизительное число различных значений аргумента. Аналогична uniqCombined, но использует 64-битный хеш для всех типов данных, а не только для типа данных String.'
slug: /sql-reference/aggregate-functions/reference/uniqcombined64
title: 'uniqCombined64'
doc_type: 'reference'
---

# uniqCombined64 \{#uniqcombined64\}

Вычисляет приблизительное количество различных значений аргумента. То же самое, что и [uniqCombined](/sql-reference/aggregate-functions/reference/uniqcombined), но использует 64-битный хеш для всех типов данных, а не только для типа данных String.

```sql
uniqCombined64(HLL_precision)(x[, ...])
```

**Параметры**

* `HLL_precision`: Двоичный логарифм числа ячеек в [HyperLogLog](https://en.wikipedia.org/wiki/HyperLogLog). Опционально функцию можно вызывать как `uniqCombined64(x[, ...])`. Значение по умолчанию для `HLL_precision` — 17, что фактически соответствует 96 КиБ памяти (2^17 ячеек по 6 бит каждая).
* `X`: Переменное количество параметров. Параметры могут иметь типы `Tuple`, `Array`, `Date`, `DateTime`, `String` или числовые типы.

**Возвращаемое значение**

* Число типа [UInt64](../../../sql-reference/data-types/int-uint.md).

**Подробности реализации**

Функция `uniqCombined64`:

* Вычисляет хеш (64-битный хеш для всех типов данных) для всех параметров в агрегате и затем использует его в вычислениях.
* Использует комбинацию из трёх алгоритмов: массива, хеш-таблицы и HyperLogLog с таблицей коррекции ошибки.
  * Для небольшого количества различных элементов используется массив.
  * Когда размер множества увеличивается, используется хеш-таблица.
  * Для ещё большего количества элементов используется HyperLogLog, который занимает фиксированный объём памяти.
* Возвращает детерминированный результат (он не зависит от порядка обработки запроса).

:::note
Поскольку для всех типов используется 64-битный хеш, результат не страдает от очень высокой ошибки для мощностей существенно больше `UINT_MAX`, как в случае с [uniqCombined](../../../sql-reference/aggregate-functions/reference/uniqCombined.md), где для типов, отличных от `String`, используется 32-битный хеш.
:::

По сравнению с функцией [uniq](/sql-reference/aggregate-functions/reference/uniq) функция `uniqCombined64`:

* Потребляет в несколько раз меньше памяти.
* Вычисляет результат с в несколько раз большей точностью.

**Пример**

В приведённом ниже примере `uniqCombined64` выполняется по `1e10` различным числам и возвращает очень близкое приближение количества различных значений аргумента.

Запрос:

```sql
SELECT uniqCombined64(number) FROM numbers(1e10);
```

Результат:

```response
┌─uniqCombined64(number)─┐
│             9998568925 │ -- 10.00 billion
└────────────────────────┘
```

Для сравнения функция `uniqCombined` возвращает довольно грубое приближение для набора данных такого размера.

Запрос:

```sql
SELECT uniqCombined(number) FROM numbers(1e10);
```

Результат:

```response
┌─uniqCombined(number)─┐
│           5545308725 │ -- 5.55 billion
└──────────────────────┘
```

**См. также**

* [uniq](/sql-reference/aggregate-functions/reference/uniq)
* [uniqCombined](/sql-reference/aggregate-functions/reference/uniqcombined)
* [uniqHLL12](/sql-reference/aggregate-functions/reference/uniqhll12)
* [uniqExact](/sql-reference/aggregate-functions/reference/uniqexact)
* [uniqTheta](/sql-reference/aggregate-functions/reference/uniqthetasketch)

{/*AUTOGENERATED_START*/ }

{/*AUTOGENERATED_END*/ }
