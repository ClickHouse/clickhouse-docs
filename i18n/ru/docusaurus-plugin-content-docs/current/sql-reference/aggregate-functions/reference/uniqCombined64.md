---
description: 'Вычисляет приблизительное число различных значений аргумента. Аналогична uniqCombined, но использует 64-битный хеш для всех типов данных, а не только для типа данных String.'
slug: /sql-reference/aggregate-functions/reference/uniqcombined64
title: 'uniqCombined64'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## uniqCombined64 \{#uniqCombined64\}

Впервые появилась в: v20.1

Вычисляет приблизительное количество различных значений аргумента.
Аналогична функции [`uniqCombined`](https://clickhouse.com/docs/sql-reference/aggregate-functions/reference/uniqcombined), но использует 64-битный хеш для всех типов данных, а не только для типа данных String.

Эта функция возвращает детерминированный результат (он не зависит от порядка обработки запроса).

:::note
Поскольку она использует 64-битный хеш для всех типов, результат не подвержен очень большой ошибке при мощностях множеств, значительно превышающих `UINT_MAX`, в отличие от [`uniqCombined`](https://clickhouse.com/docs/sql-reference/aggregate-functions/reference/uniqcombined), которая использует 32-битный хеш для типов, отличных от String.
:::

По сравнению с функцией [uniq](https://clickhouse.com/docs/sql-reference/aggregate-functions/reference/uniq), функция uniqCombined64:

* Потребляет в несколько раз меньше памяти
* Вычисляет значение с в несколько раз большей точностью

<details>
  <summary>Implementation details</summary>
  Эта функция вычисляет 64-битный хеш для всех типов данных по всем параметрам в агрегате, а затем использует его в вычислениях.
  Она использует комбинацию трёх алгоритмов: массив, хеш-таблицу и [HyperLogLog](https://en.wikipedia.org/wiki/HyperLogLog) с таблицей коррекции ошибки:

  * Для небольшого числа различных элементов используется массив
  * При большем размере множества используется хеш-таблица
  * Для ещё большего числа элементов используется HyperLogLog, который занимает фиксированный объём памяти
</details>

**Синтаксис**

```sql
uniqCombined64(HLL_precision)(x[, ...])
uniqCombined64(x[, ...])
```

**Параметры**

* `HLL_precision` — Необязательный параметр. Двоичный логарифм количества ячеек в HyperLogLog. Значение по умолчанию — 17, что фактически соответствует 96 КиБ памяти (2^17 ячеек, по 6 бит каждая). Диапазон: [12, 20]. [`UInt8`](/sql-reference/data-types/int-uint)

**Аргументы**

* `x` — Переменное количество аргументов. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array) или [`Date`](/sql-reference/data-types/date) или [`DateTime`](/sql-reference/data-types/datetime) или [`String`](/sql-reference/data-types/string) или [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal)

**Возвращаемое значение**

Возвращает число типа UInt64, представляющее приблизительное количество различных значений аргументов. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример для большого объёма данных**

```sql title=Query
SELECT uniqCombined64(number) FROM numbers(1e10);
```

```response title=Response
┌─uniqCombined64(number)─┐
│             9998568925 │
└────────────────────────┘
```

**Сравнение с функцией uniqCombined**

```sql title=Query
-- uniqCombined64 with large dataset
SELECT uniqCombined64(number) FROM numbers(1e10);

-- uniqCombined with same dataset shows poor approximation
SELECT uniqCombined(number) FROM numbers(1e10);
```

```response title=Response
┌─uniqCombined64(number)─┐
│             9998568925 │ -- 10.00 billion
└────────────────────────┘
┌─uniqCombined(number)─┐
│           5545308725 │ -- 5.55 billion
└──────────────────────┘
```

{/*AUTOGENERATED_END*/ }

**См. также**

* [uniq](/sql-reference/aggregate-functions/reference/uniq)
* [uniqCombined](/sql-reference/aggregate-functions/reference/uniqcombined)
* [uniqHLL12](/sql-reference/aggregate-functions/reference/uniqhll12)
* [uniqExact](/sql-reference/aggregate-functions/reference/uniqexact)
* [uniqTheta](/sql-reference/aggregate-functions/reference/uniqthetasketch)
