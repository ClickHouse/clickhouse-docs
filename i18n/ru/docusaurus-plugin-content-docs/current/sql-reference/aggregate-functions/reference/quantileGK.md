---
description: 'Вычисляет квантиль последовательности числовых данных с использованием алгоритма Гринвальда — Кханны.'
sidebar_position: 175
slug: /sql-reference/aggregate-functions/reference/quantileGK
title: 'quantileGK'
doc_type: 'reference'
---

# quantileGK

Вычисляет [квантиль](https://en.wikipedia.org/wiki/Quantile) числовой последовательности данных с использованием алгоритма [Greenwald-Khanna](http://infolab.stanford.edu/~datar/courses/cs361a/papers/quantiles.pdf). Алгоритм Greenwald-Khanna применяется для вычисления квантилей по потоку данных чрезвычайно эффективным образом. Он был предложен Michael Greenwald и Sanjeev Khanna в 2001 году. Этот алгоритм широко используется в базах данных и системах обработки больших данных, где необходимо вычислять точные квантили по большому потоку данных в режиме реального времени. Алгоритм обладает высокой эффективностью, требуя всего O(log n) памяти и O(log log n) времени на элемент (где n — размер входных данных). Он также обеспечивает высокую точность, выдавая приближённое значение квантили с высокой вероятностью.

`quantileGK` отличается от других функций для вычисления квантилей в ClickHouse, поскольку позволяет пользователю управлять точностью приближённого значения квантили.

**Синтаксис**

```sql
quantileGK(accuracy, level)(expr)
```

Псевдоним: `medianGK`.

**Аргументы**

* `accuracy` — Точность квантиля. Константное положительное целое число. Большее значение точности означает меньшую погрешность. Например, если аргумент `accuracy` установлен в 100, вычисленный квантиль с высокой вероятностью будет иметь погрешность не более 1%. Существует компромисс между точностью вычисляемых квантилей и вычислительной сложностью алгоритма. Большая точность требует больше памяти и вычислительных ресурсов, тогда как меньшее значение аргумента точности обеспечивает более быстрое и экономное по памяти вычисление, но с несколько меньшей точностью.

* `level` — Уровень квантиля. Необязательный параметр. Константное число с плавающей запятой от 0 до 1. Значение по умолчанию: 0.5. При `level=0.5` функция вычисляет [медиану](https://en.wikipedia.org/wiki/Median).

* `expr` — Выражение над значениями столбца, результатом которого являются числовые [типы данных](/sql-reference/data-types), [Date](../../../sql-reference/data-types/date.md) или [DateTime](../../../sql-reference/data-types/datetime.md).

**Возвращаемое значение**

* Квантиль указанного уровня и точности.

Тип:

* [Float64](../../../sql-reference/data-types/float.md) для числовых типов данных на входе.
* [Date](../../../sql-reference/data-types/date.md), если входные значения имеют тип `Date`.
* [DateTime](../../../sql-reference/data-types/datetime.md), если входные значения имеют тип `DateTime`.

**Пример**

```sql
SELECT quantileGK(1, 0.25)(number + 1)
FROM numbers(1000)

┌─quantileGK(1, 0.25)(plus(number, 1))─┐
│                                    1 │
└──────────────────────────────────────┘

SELECT quantileGK(10, 0.25)(number + 1)
FROM numbers(1000)

┌─quantileGK(10, 0.25)(plus(number, 1))─┐
│                                   156 │
└───────────────────────────────────────┘

SELECT quantileGK(100, 0.25)(number + 1)
FROM numbers(1000)

┌─quantileGK(100, 0.25)(plus(number, 1))─┐
│                                    251 │
└────────────────────────────────────────┘

SELECT quantileGK(1000, 0.25)(number + 1)
FROM numbers(1000)

┌─quantileGK(1000, 0.25)(plus(number, 1))─┐
│                                     249 │
└─────────────────────────────────────────┘
```

**См. также**

* [median]/sql-reference/aggregate-functions/reference/median
* [quantiles](../../../sql-reference/aggregate-functions/reference/quantiles.md#quantiles)
