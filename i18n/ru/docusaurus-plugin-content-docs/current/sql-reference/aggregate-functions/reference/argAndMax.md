---
description: 'Вычисляет значения `arg` и `val` для максимального значения `val`. Если существует несколько строк с одинаковым максимальным значением `val`, то выбор возвращаемых связанных значений `arg` и `val` недетерминированным образом.'
slug: /sql-reference/aggregate-functions/reference/argandmax
title: 'argAndMax'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## argAndMax \{#argAndMax\}

Появилось в версии v1.1

Вычисляет значения `arg` и `val` для максимального значения `val`.
Если существует несколько строк с одинаковым максимальным значением `val`, то какая из соответствующих пар `arg` и `val` будет возвращена, не определено.
Обе части — `arg` и `max` — ведут себя как [агрегатные функции](/sql-reference/aggregate-functions/index.md), обе [пропускают `Null`](/sql-reference/aggregate-functions/index.md#null-processing) при обработке и возвращают не-`Null` значения, если доступны не-`Null` значения.

:::note
Единственное отличие от `argMax` состоит в том, что `argAndMax` возвращает и аргумент, и значение.
:::

**См. также**

* [argMax](/sql-reference/aggregate-functions/reference/argMax.md)
* [Tuple](/sql-reference/data-types/tuple.md)

**Синтаксис**

```sql
argAndMax(arg, val)
```

**Аргументы**

* `arg` — аргумент, для которого нужно найти максимальное значение. [`const String`](/sql-reference/data-types/string)
* `val` — максимальное значение. [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Date`](/sql-reference/data-types/date) или [`DateTime`](/sql-reference/data-types/datetime) или [`Tuple`](/sql-reference/data-types/tuple)

**Возвращаемое значение**

Возвращает кортеж, содержащий значение `arg`, соответствующее максимальному значению `val`, и максимальное значение `val`. [`Tuple`](/sql-reference/data-types/tuple)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT argAndMax(user, salary) FROM salary;
```

```response title=Response
┌─argAndMax(user, salary)─┐
│ ('director',5000)       │
└─────────────────────────┘
```

**Расширенный пример с обработкой значений NULL**

```sql title=Query
CREATE TABLE test
(
    a Nullable(String),
    b Nullable(Int64)
)
ENGINE = Memory AS
SELECT *
FROM VALUES(('a', 1), ('b', 2), ('c', 2), (NULL, 3), (NULL, NULL), ('d', NULL));

SELECT argMax(a, b), argAndMax(a, b), max(b) FROM test;
```

```response title=Response
┌─argMax(a, b)─┬─argAndMax(a, b)─┬─max(b)─┐
│ b            │ ('b',2)         │      3 │
└──────────────┴─────────────────┴────────┘
```

**Использование `Tuple` в аргументах**

```sql title=Query
SELECT argAndMax(a, (b,a)) FROM test;
```

```response title=Response
┌─argAndMax(a, (b, a))─┐
│ ('c',(2,'c'))        │
└──────────────────────┘
```

{/*AUTOGENERATED_END*/ }

**См. также**

* [argMax](/sql-reference/aggregate-functions/reference/argMax.md)
* [Tuple](/sql-reference/data-types/tuple.md)
