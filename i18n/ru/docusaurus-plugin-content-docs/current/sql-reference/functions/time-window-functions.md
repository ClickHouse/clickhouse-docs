---
description: 'Документация по функциям временных окон'
sidebar_label: 'Временное окно'
slug: /sql-reference/functions/time-window-functions
title: 'Функции временных окон'
doc_type: 'reference'
keywords: ['временное окно']
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import CloudNotSupportedBadge from '@theme/badges/CloudNotSupportedBadge';


# Функции временных окон \{#time-window-functions\}

<ExperimentalBadge />

<CloudNotSupportedBadge />

Функции временных окон возвращают нижнюю включительную и верхнюю невключительную границы соответствующего окна.
Ниже перечислены функции для работы с [WindowView](/sql-reference/statements/create/view#window-view):

{/* 
  Содержимое тегов ниже заменяется при сборке фреймворка документации
  документацией, сгенерированной на основе system.functions. Пожалуйста, не изменяйте и не удаляйте эти теги.
  См.: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }


## hop \{#hop\}

Впервые представлена в версии: v21.12

Скользящее временное окно имеет фиксированную длительность (`window_interval`) и сдвигается на заданный интервал (`hop_interval`). Если `hop_interval` меньше `window_interval`, скользящие окна перекрываются. Таким образом, записи могут быть отнесены к нескольким окнам.

Поскольку одна запись может быть отнесена к нескольким hop-окнам, при использовании функции hop без WINDOW VIEW функция возвращает только границу первого окна.

**Синтаксис**

```sql
hop(time_attr, hop_interval, window_interval[, timezone])
```

**Аргументы**

* `time_attr` — Дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `hop_interval` — Положительный интервал сдвига окна (hop interval). [`Interval`](/sql-reference/data-types/int-uint)
* `window_interval` — Положительный интервал окна. [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — Необязательный параметр. Название часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает включающую нижнюю и исключающую верхнюю границу соответствующего скользящего окна (hopping window). [`Tuple(DateTime, DateTime)`](/sql-reference/data-types/tuple)

**Примеры**

**Скользящее окно (hopping window)**

```sql title=Query
SELECT hop(now(), INTERVAL '1' DAY, INTERVAL '2' DAY)
```

```response title=Response
('2024-07-03 00:00:00','2024-07-05 00:00:00')
```


## hopEnd \{#hopEnd\}

Появилась в версии: v22.1

Возвращает верхнюю границу соответствующего скачущего окна (не включительно).

Поскольку одна запись может быть отнесена к нескольким окнам hop, функция возвращает только границу первого окна, когда функция hop используется без `WINDOW VIEW`.

**Синтаксис**

```sql
hopEnd(time_attr, hop_interval, window_interval[, timezone])
```

**Аргументы**

* `time_attr` — дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `hop_interval` — положительный интервал сдвига окна (hop interval). [`Interval`](/sql-reference/data-types/int-uint)
* `window_interval` — положительный интервал окна (window interval). [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — необязательный параметр. Название часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает верхнюю (исключающую) границу соответствующего hopping-окна. [`DateTime`](/sql-reference/data-types/datetime)

**Примеры**

**Конец hopping-окна**

```sql title=Query
SELECT hopEnd(now(), INTERVAL '1' DAY, INTERVAL '2' DAY)
```

```response title=Response
2024-07-05 00:00:00
```


## hopStart \{#hopStart\}

Введена в версии v22.1

Возвращает включительную нижнюю границу соответствующего скользящего окна.

Поскольку одна запись может быть отнесена к нескольким hop-окнам, функция возвращает границу только первого окна, когда функция hop используется без `WINDOW VIEW`.

**Синтаксис**

```sql
hopStart(time_attr, hop_interval, window_interval[, timezone])
```

**Аргументы**

* `time_attr` — Дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `hop_interval` — Положительный интервал сдвига (hop). [`Interval`](/sql-reference/data-types/int-uint)
* `window_interval` — Положительный интервал окна. [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — Необязательный. Название часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает включительную нижнюю границу соответствующего hopping-окна. [`DateTime`](/sql-reference/data-types/datetime)

**Примеры**

**Начало hopping-окна**

```sql title=Query
SELECT hopStart(now(), INTERVAL '1' DAY, INTERVAL '2' DAY)
```

```response title=Response
2024-07-03 00:00:00
```


## tumble \{#tumble\}

Впервые представлена в: v21.12

Временное окно с дискретным шагом (tumbling) распределяет записи по непересекающимся непрерывным окнам фиксированной длительности (`interval`).

**Синтаксис**

```sql
tumble(time_attr, interval[, timezone])
```

**Аргументы**

* `time_attr` — Дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `interval` — Интервал окна. [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — Необязательный параметр. Имя часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает нижнюю границу (включительно) и верхнюю границу (исключительно) соответствующего окна типа tumbling. [`Tuple(DateTime, DateTime)`](/sql-reference/data-types/tuple)

**Примеры**

**Окно типа tumbling**

```sql title=Query
SELECT tumble(now(), toIntervalDay('1'))
```

```response title=Response
('2024-07-04 00:00:00','2024-07-05 00:00:00')
```


## tumbleEnd \{#tumbleEnd\}

Впервые появилось в версии v22.1

Возвращает невключаемую верхнюю границу соответствующего окна фиксированного размера (tumbling window).

**Синтаксис**

```sql
tumbleEnd(time_attr, interval[, timezone])
```

**Аргументы**

* `time_attr` — Дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `interval` — Интервал окна типа Interval. [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — Необязательный параметр. Название часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает строгую верхнюю границу соответствующего tumbling-окна. [`DateTime`](/sql-reference/data-types/datetime)

**Примеры**

**Окончание tumbling-окна**

```sql title=Query
SELECT tumbleEnd(now(), toIntervalDay('1'))
```

```response title=Response
2024-07-05 00:00:00
```


## tumbleStart \{#tumbleStart\}

Добавлена в версии v22.1

Возвращает нижнюю (включительную) границу соответствующего tumbling-окна.

**Синтаксис**

```sql
tumbleStart(time_attr, interval[, timezone])
```

**Аргументы**

* `time_attr` — Дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `interval` — Интервал (размер) окна в типе Interval. [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — Необязательный параметр. Название часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает нижнюю границу (включительно) соответствующего tumbling-окна. [`DateTime`](/sql-reference/data-types/datetime)

**Примеры**

**Начало tumbling-окна**

```sql title=Query
SELECT tumbleStart(now(), toIntervalDay('1'))
```

```response title=Response
2024-07-04 00:00:00
```


## windowID \{#windowID\}

Добавлено в: v22.1

Возвращает идентификатор соответствующего дискретного (tumbling) или скачкообразного (hopping) окна.
Эта функция может использоваться только с `WINDOW VIEW`.

**Синтаксис**

```sql
windowID(time_attr, interval[, timezone])
```

**Аргументы**

* `time_attr` — дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `interval` — интервал окна типа Interval. [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — необязательный параметр. Название часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает идентификатор соответствующего окна. [`UInt32`](/sql-reference/data-types/int-uint)

**Примеры**

**Идентификатор окна**

```sql title=Query
SELECT windowID(now(), toIntervalDay('1'))
```

```response title=Response
```

{/*AUTOGENERATED_END*/ }


## Связанные материалы \{#related-content\}

- [Руководства по сценариям использования временных рядов](/use-cases/time-series)