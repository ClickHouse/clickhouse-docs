---
description: 'Документация по функциям временных окон'
sidebar_label: 'Временное окно'
slug: /sql-reference/functions/time-window-functions
title: 'Функции временных окон'
doc_type: 'reference'
keywords: ['временное окно']
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import CloudNotSupportedBadge from '@theme/badges/CloudNotSupportedBadge';

# Функции временных окон {#time-window-functions}

<ExperimentalBadge />

<CloudNotSupportedBadge />

Функции временных окон возвращают нижнюю границу соответствующего окна (включительно) и верхнюю границу (исключительно).
Ниже перечислены функции для работы с [WindowView](/sql-reference/statements/create/view#window-view):

{/* 
  Внутреннее содержимое расположенных ниже тегов при сборке фреймворка документации 
  заменяется на документы, сгенерированные на основе system.functions. Пожалуйста, не изменяйте и не удаляйте эти теги.
  См.: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }

## hop {#hop}

Введена в: v21.12

Скользящее временное окно имеет фиксированную длительность (`window_interval`) и сдвигается на заданный интервал (`hop_interval`). Если `hop_interval` меньше `window_interval`, скользящие окна перекрываются. Таким образом, записи могут попадать в несколько окон.

Поскольку одна запись может попадать в несколько скользящих окон, функция возвращает только границу первого окна при использовании функции hop без WINDOW VIEW.

**Синтаксис**

```sql
hop(time_attr, hop_interval, window_interval[, timezone])
```

**Аргументы**

* `time_attr` — дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `hop_interval` — положительный интервал шага окна. [`Interval`](/sql-reference/data-types/int-uint)
* `window_interval` — положительный интервал окна. [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — необязательный параметр. Название часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает нижнюю границу (включительно) и верхнюю границу (не включая) соответствующего скользящего (hopping) окна. [`Tuple(DateTime, DateTime)`](/sql-reference/data-types/tuple)

**Примеры**

**Скользящее (hopping) окно**

```sql title=Query
SELECT hop(now(), INTERVAL '1' DAY, INTERVAL '2' DAY)
```

```response title=Response
('2024-07-03 00:00:00','2024-07-05 00:00:00')
```

## hopEnd {#hopEnd}

Добавлена в версии: v22.1

Возвращает верхнюю исключающую границу соответствующего скользящего окна.

Поскольку одна запись может быть назначена нескольким hop-окнам, функция возвращает границу только первого окна, если функция hop используется без `WINDOW VIEW`.

**Синтаксис**

```sql
hopEnd(time_attr, hop_interval, window_interval[, timezone])
```

**Аргументы**

* `time_attr` — Дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `hop_interval` — Положительный интервал шага (hop). [`Interval`](/sql-reference/data-types/int-uint)
* `window_interval` — Положительный интервал окна (window). [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — Необязательный параметр. Название часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает верхнюю границу (исключая её) соответствующего hopping-окна. [`DateTime`](/sql-reference/data-types/datetime)

**Примеры**

**Конец hopping-окна**

```sql title=Query
SELECT hopEnd(now(), INTERVAL '1' DAY, INTERVAL '2' DAY)
```

```response title=Response
2024-07-05 00:00:00
```

## hopStart {#hopStart}

Впервые появилась в: v22.1

Возвращает включающую нижнюю границу соответствующего скользящего окна.

Поскольку одна запись может относиться к нескольким скользящим окнам, при использовании функции hop без `WINDOW VIEW` возвращается граница только первого окна.

**Синтаксис**

```sql
hopStart(time_attr, hop_interval, window_interval[, timezone])
```

**Аргументы**

* `time_attr` — Дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `hop_interval` — Положительный интервал сдвига окна. [`Interval`](/sql-reference/data-types/int-uint)
* `window_interval` — Положительный интервал окна. [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — Необязательный параметр. Название часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает включительную нижнюю границу соответствующего окна сдвига (hopping-окна). [`DateTime`](/sql-reference/data-types/datetime)

**Примеры**

**Начало окна сдвига (hopping-окна)**

```sql title=Query
SELECT hopStart(now(), INTERVAL '1' DAY, INTERVAL '2' DAY)
```

```response title=Response
2024-07-03 00:00:00
```

## tumble {#tumble}

Добавлено в: v21.12

Функция `tumble` разбивает записи на неперекрывающиеся, последовательные временные окна фиксированной продолжительности (`interval`).

**Синтаксис**

```sql
tumble(time_attr, interval[, timezone])
```

**Аргументы**

* `time_attr` — Дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `interval` — Интервал окна, тип Interval. [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — Необязательный параметр. Название часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает нижнюю границу (включительно) и верхнюю границу (не включительно) соответствующего tumbling-окна. [`Tuple(DateTime, DateTime)`](/sql-reference/data-types/tuple)

**Примеры**

**Tumbling-окно**

```sql title=Query
SELECT tumble(now(), toIntervalDay('1'))
```

```response title=Response
('2024-07-04 00:00:00','2024-07-05 00:00:00')
```

## tumbleEnd {#tumbleEnd}

Добавлена в версии: v22.1

Возвращает невключительную верхнюю границу соответствующего tumbling-окна.

**Синтаксис**

```sql
tumbleEnd(time_attr, interval[, timezone])
```

**Аргументы**

* `time_attr` — Дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `interval` — Интервал окна с типом `Interval`. [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — Необязательный параметр. Название часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает верхнюю границу (не включительно) соответствующего окна типа tumbling. [`DateTime`](/sql-reference/data-types/datetime)

**Примеры**

**Конец окна типа tumbling**

```sql title=Query
SELECT tumbleEnd(now(), toIntervalDay('1'))
```

```response title=Response
2024-07-05 00:00:00
```

## tumbleStart {#tumbleStart}

Появилась в версии v22.1

Возвращает включающую нижнюю границу соответствующего фиксированного окна.

**Синтаксис**

```sql
tumbleStart(time_attr, interval[, timezone])
```

**Аргументы**

* `time_attr` — Дата и время. [`DateTime`](/sql-reference/data-types/datetime)
* `interval` — Интервал временного окна в типе `Interval`. [`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — Необязательный параметр. Имя часового пояса. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает включающую нижнюю границу соответствующего фиксированного окна. [`DateTime`](/sql-reference/data-types/datetime)

**Примеры**

**Начало фиксированного окна**

```sql title=Query
SELECT tumbleStart(now(), toIntervalDay('1'))
```

```response title=Response
2024-07-04 00:00:00
```

{/*AUTOGENERATED_END*/ }

## Связанные материалы {#related-content}

- [Руководства по сценариям использования временных рядов](/use-cases/time-series)
