---
description: 'Документация по функциям обработки естественного языка (NLP)'
sidebar_label: 'NLP'
slug: /sql-reference/functions/nlp-functions
title: 'Функции обработки естественного языка (NLP)'
doc_type: 'reference'
keywords: ['NLP', 'Обработка естественного языка']
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import CloudNotSupportedBadge from '@theme/badges/CloudNotSupportedBadge';


# Функции обработки естественного языка (NLP)

<ExperimentalBadge />
<CloudNotSupportedBadge />

:::warning
Это экспериментальная функция, которая находится в разработке и не готова к использованию в продакшене. В будущих релизах она может измениться непредсказуемым образом с нарушением обратной совместимости. Для её включения установите `allow_experimental_nlp_functions = 1`.
:::

<!--
The inner content of the tags below are replaced at doc framework build time with
docs generated from system.functions. Please do not modify or remove the tags.
See: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
-->


<!--AUTOGENERATED_START-->

## detectCharset {#detectCharset}

Добавлена в версии: v22.2

Определяет кодировку входной строки, не закодированной в UTF-8.

**Синтаксис**

```sql
detectCharset(s)
```

**Аргументы**

- `s` — Текст для анализа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает строку с кодом определённой кодировки [`String`](/sql-reference/data-types/string)

**Примеры**

**Базовое использование**

```sql title=Запрос
SELECT detectCharset('Ich bleibe für ein paar Tage.')
```

```response title=Результат
WINDOWS-1252
```


## detectLanguage {#detectLanguage}

Добавлено в версии: v22.2

Определяет язык входной строки в кодировке UTF-8.
Функция использует [библиотеку CLD2](https://github.com/CLD2Owners/cld2) для определения языка и возвращает двухбуквенный код языка по стандарту ISO.

Чем длиннее входная строка, тем точнее определяется язык.

**Синтаксис**

```sql
detectLanguage(s)
```

**Аргументы**

- `text_to_be_analyzed` — Текст для анализа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает двухбуквенный код ISO определённого языка. Другие возможные результаты: `un` = неизвестный язык, не удалось определить; `other` = определённый язык не имеет двухбуквенного кода. [`String`](/sql-reference/data-types/string)

**Примеры**

**Текст на смешанных языках**

```sql title=Запрос
SELECT detectLanguage('Je pense que je ne parviendrai jamais à parler français comme un natif. Where there\'s a will, there\'s a way.')
```

```response title=Результат
fr
```


## detectLanguageMixed {#detectLanguageMixed}

Введена в версии: v22.2

Аналогична функции [`detectLanguage`](#detectLanguage), но `detectLanguageMixed` возвращает `Map` с двухбуквенными кодами языков, которые сопоставлены с процентным содержанием соответствующего языка в тексте.

**Синтаксис**

```sql
detectLanguageMixed(s)
```

**Аргументы**

- `s` — текст для анализа [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает словарь, ключами которого являются двухбуквенные коды ISO, а соответствующими значениями — процентное содержание текста на данном языке [`Map(String, Float32)`](/sql-reference/data-types/map)

**Примеры**

**Смешанные языки**

```sql title=Запрос
SELECT detectLanguageMixed('二兎を追う者は一兎をも得ず二兎を追う者は一兎をも得ず A vaincre sans peril, on triomphe sans gloire.')
```

```response title=Результат
{'ja':0.62,'fr':0.36}
```


## detectLanguageUnknown {#detectLanguageUnknown}

Введена в версии: v22.2

Аналогична функции [`detectLanguage`](#detectLanguage), за исключением того, что функция detectLanguageUnknown работает со строками в кодировках, отличных от UTF-8.
Используйте эту версию, если ваш набор символов использует кодировку UTF-16 или UTF-32.

**Синтаксис**

```sql
detectLanguageUnknown('s')
```

**Аргументы**

- `s` — текст для анализа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает двухбуквенный ISO-код определённого языка. Другие возможные результаты: `un` = неизвестно, не удалось определить язык; `other` = определённый язык не имеет двухбуквенного кода. [`String`](/sql-reference/data-types/string)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT detectLanguageUnknown('Ich bleibe für ein paar Tage.')
```

```response title=Response
de
```


## detectProgrammingLanguage {#detectProgrammingLanguage}

Добавлено в версии: v22.2

Определяет язык программирования по заданному фрагменту исходного кода.

**Синтаксис**

```sql
detectProgrammingLanguage('source_code')
```

**Аргументы**

- `source_code` — строковое представление исходного кода для анализа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает язык программирования [`String`](/sql-reference/data-types/string)

**Примеры**

**Определение кода C++**

```sql title=Запрос
SELECT detectProgrammingLanguage('#include <iostream>')
```

```response title=Результат
C++
```


## detectTonality {#detectTonality}

Введена в версии: v22.2

Определяет тональность (эмоциональную окраску) предоставленного текстового содержимого.

:::note Ограничение
В текущей реализации функция использует встроенный эмоциональный словарь и работает только с русским языком.
:::

**Синтаксис**

```sql
detectTonality(s)
```

**Аргументы**

- `s` — Текст для анализа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает среднее значение тональности слов в тексте. [`Float32`](/sql-reference/data-types/float)

**Примеры**

**Анализ тональности русского текста**

```sql title=Query
SELECT
    detectTonality('Шарик - хороший пёс'),
    detectTonality('Шарик - пёс'),
    detectTonality('Шарик - плохой пёс')
```

```response title=Response
0.44445, 0, -0.3
```


## lemmatize {#lemmatize}

Введена в версии: v21.9

Выполняет лемматизацию заданного слова.
Для работы этой функции требуются словари, которые можно получить на [github](https://github.com/vpodpecan/lemmagen3/tree/master/src/lemmagen3/models). Подробнее о загрузке словаря из локального файла см. страницу [«Определение словарей»](/sql-reference/dictionaries#local-file).

**Синтаксис**

```sql
lemmatize(lang, word)
```

**Аргументы**

- `lang` — язык, правила которого будут применены. [`String`](/sql-reference/data-types/string)
- `word` — слово в нижнем регистре для лемматизации. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает лемматизированную форму слова. [`String`](/sql-reference/data-types/string)

**Примеры**

**Лемматизация английского языка**

```sql title=Запрос
SELECT lemmatize('en', 'wolves')
```

```response title=Результат
wolf
```


## stem {#stem}

Введена в версии: v21.9

Выполняет стемминг (выделение основы) заданного слова.

**Синтаксис**

```sql
stem(lang, word)
```

**Аргументы**

- `lang` — язык, правила которого будут применены. Используйте двухбуквенный код ISO 639-1. [`String`](/sql-reference/data-types/string)
- `word` — слово в нижнем регистре для стемминга. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает основу слова. [`String`](/sql-reference/data-types/string)

**Примеры**

**Стемминг для английского языка**

```sql title=Запрос
SELECT arrayMap(x -> stem('en', x),
['I', 'think', 'it', 'is', 'a', 'blessing', 'in', 'disguise']) AS res
```

```response title=Результат
['I','think','it','is','a','bless','in','disguis']
```


## synonyms {#synonyms}

Добавлено в версии: v21.9

Находит синонимы заданного слова.

Существует два типа расширений для синонимов:

- `plain`
- `wordnet`

Для типа расширения `plain` необходимо указать путь к простому текстовому файлу, где каждая строка соответствует определённому набору синонимов.
Слова в строке должны быть разделены пробелами или символами табуляции.

Для типа расширения `wordnet` необходимо указать путь к каталогу с тезаурусом WordNet.
Тезаурус должен содержать индекс значений WordNet.

**Синтаксис**

```sql
synonyms(ext_name, word)
```

**Аргументы**

- `ext_name` — имя расширения, в котором будет выполняться поиск. [`String`](/sql-reference/data-types/string)
- `word` — слово для поиска в расширении. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает массив синонимов для заданного слова. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Поиск синонимов**

```sql title=Запрос
SELECT synonyms('list', 'important')
```

```response title=Результат
['important','big','critical','crucial']
```

<!--AUTOGENERATED_END-->
