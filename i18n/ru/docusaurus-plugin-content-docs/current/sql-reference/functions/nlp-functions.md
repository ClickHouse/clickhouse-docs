---
description: 'Документация по функциям обработки естественного языка (NLP)'
sidebar_label: 'NLP'
slug: /sql-reference/functions/nlp-functions
title: 'Функции обработки естественного языка (NLP)'
doc_type: 'reference'
keywords: ['NLP', 'Обработка естественного языка']
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import CloudNotSupportedBadge from '@theme/badges/CloudNotSupportedBadge';

# Функции обработки естественного языка (NLP) {#natural-language-processing-nlp-functions}

<ExperimentalBadge />

<CloudNotSupportedBadge />

:::warning
Это экспериментальная функция, которая в данный момент находится в разработке и не готова к широкому применению. В будущих релизах она может меняться непредсказуемым образом, нарушающим обратную совместимость. Установите `allow_experimental_nlp_functions = 1`, чтобы включить её.
:::

{/* 
  Внутреннее содержимое тегов ниже заменяется во время сборки фреймворка документации
  документацией, сгенерированной из system.functions. Пожалуйста, не изменяйте и не удаляйте эти теги.
  См.: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }

## detectCharset {#detectCharset}

Появилась в: v22.2

Определяет кодировку входной строки, закодированной не в UTF-8.

**Синтаксис**

```sql
detectCharset(s)
```

**Аргументы**

* `s` — текст для анализа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает строку с кодировкой обнаруженного набора символов. [`String`](/sql-reference/data-types/string)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT detectCharset('Я останусь на несколько дней.')
```

```response title=Response
WINDOWS-1252
```



## detectLanguage {#detectLanguage}

Introduced in: v22.2


Detects the language of the UTF8-encoded input string.
The function uses the [CLD2 library](https://github.com/CLD2Owners/cld2) for detection and returns the 2-letter ISO language code.

The longer the input, the more precise the language detection will be.


**Syntax**

```sql
detectLanguage(s)
```

**Arguments**

- `text_to_be_analyzed` — The text to analyze. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the 2-letter ISO code of the detected language. Other possible results: `un` = unknown, can not detect any language, `other` = the detected language does not have 2 letter code. [`String`](/sql-reference/data-types/string)

**Examples**

**Mixed language text**

```sql title=Query
SELECT detectLanguage('Je pense que je ne parviendrai jamais à parler français comme un natif. Where there\'s a will, there\'s a way.')
```

```response title=Response
fr
```



## detectLanguageMixed {#detectLanguageMixed}

Introduced in: v22.2


Similar to the [`detectLanguage`](#detectLanguage) function, but `detectLanguageMixed` returns a `Map` of 2-letter language codes that are mapped to the percentage of the certain language in the text.


**Syntax**

```sql
detectLanguageMixed(s)
```

**Arguments**

- `s` — The text to analyze [`String`](/sql-reference/data-types/string)


**Returned value**

Returns a map with keys which are 2-letter ISO codes and corresponding values which are a percentage of the text found for that language [`Map(String, Float32)`](/sql-reference/data-types/map)

**Examples**

**Mixed languages**

```sql title=Query
SELECT detectLanguageMixed('二兎を追う者は一兎をも得ず二兎を追う者は一兎をも得ず A vaincre sans peril, on triomphe sans gloire.')
```

```response title=Response
{'ja':0.62,'fr':0.36}
```



## detectLanguageUnknown {#detectLanguageUnknown}

Introduced in: v22.2


Similar to the [`detectLanguage`](#detectLanguage) function, except the detectLanguageUnknown function works with non-UTF8-encoded strings.
Prefer this version when your character set is UTF-16 or UTF-32.


**Syntax**

```sql
detectLanguageUnknown('s')
```

**Arguments**

- `s` — The text to analyze. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the 2-letter ISO code of the detected language. Other possible results: `un` = unknown, can not detect any language, `other` = the detected language does not have 2 letter code. [`String`](/sql-reference/data-types/string)

**Examples**

**Basic usage**

```sql title=Query
SELECT detectLanguageUnknown('Я останусь на несколько дней.')
```

```response title=Response
de
```



## detectProgrammingLanguage {#detectProgrammingLanguage}

Introduced in: v22.2


Determines the programming language from a given source code snippet.


**Syntax**

```sql
detectProgrammingLanguage('source_code')
```

**Arguments**

- `source_code` — String representation of the source code to analyze. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns programming language [`String`](/sql-reference/data-types/string)

**Examples**

**C++ code detection**

```sql title=Query
SELECT detectProgrammingLanguage('#include <iostream>')
```

```response title=Response
C++
```



## detectTonality {#detectTonality}

Introduced in: v22.2


Determines the sentiment of the provided text data.

:::note Limitation
This function is limited in its current form in that it makes use of the embedded emotional dictionary and only works for the Russian language.
:::


**Syntax**

```sql
detectTonality(s)
```

**Arguments**

- `s` — The text to be analyzed. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the average sentiment value of the words in text [`Float32`](/sql-reference/data-types/float)

**Examples**

**Russian sentiment analysis**

```sql title=Query
SELECT
    detectTonality('Шарик - хороший пёс'),
    detectTonality('Шарик - пёс'),
    detectTonality('Шарик - плохой пёс')
```

```response title=Response
0.44445, 0, -0.3
```



## lemmatize {#lemmatize}

Introduced in: v21.9


Performs lemmatization on a given word.
This function needs dictionaries to operate, which can be obtained from [github](https://github.com/vpodpecan/lemmagen3/tree/master/src/lemmagen3/models). For more details on loading a dictionary from a local file see page ["Defining Dictionaries"](/sql-reference/dictionaries#local-file).


**Syntax**

```sql
lemmatize(lang, word)
```

**Arguments**

- `lang` — Language which rules will be applied. [`String`](/sql-reference/data-types/string)
- `word` — Lowercase word that needs to be lemmatized. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the lemmatized form of the word [`String`](/sql-reference/data-types/string)

**Examples**

**English lemmatization**

```sql title=Query
SELECT lemmatize('en', 'wolves')
```

```response title=Response
волк
```



## stem {#stem}

Introduced in: v21.9


Performs stemming on a given word.


**Syntax**

```sql
stem(lang, word)
```

**Arguments**

- `lang` — Language which rules will be applied. Use the two letter ISO 639-1 code. [`String`](/sql-reference/data-types/string)
- `word` — Lowercase word that needs to be stemmed. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the stemmed form of the word [`String`](/sql-reference/data-types/string)

**Examples**

**English stemming**

```sql title=Query
SELECT arrayMap(x -> stem('en', x),
['I', 'think', 'it', 'is', 'a', 'blessing', 'in', 'disguise']) AS res
```

```response title=Response
['Я','думаю','это','скрытое','благословение']
```



## synonyms {#synonyms}

Introduced in: v21.9


Finds synonyms of a given word.

There are two types of synonym extensions:
- `plain`
- `wordnet`

With the `plain` extension type you need to provide a path to a simple text file, where each line corresponds to a certain synonym set.
Words in this line must be separated with space or tab characters.

With the `wordnet` extension type you need to provide a path to a directory with the WordNet thesaurus in it.
The thesaurus must contain a WordNet sense index.


**Syntax**

```sql
synonyms(ext_name, word)
```

**Arguments**

- `ext_name` — Name of the extension in which search will be performed. [`String`](/sql-reference/data-types/string)
- `word` — Word that will be searched in extension. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns array of synonyms for the given word. [`Array(String)`](/sql-reference/data-types/array)

**Examples**

**Find synonyms**

```sql title=Query
SELECT synonyms('list', 'important')
```

```response title=Response
['важный','значительный','критический','решающий']
```

{/*AUTOGENERATED_END*/ }
