---
slug: '/sql-reference/functions/nlp-functions'
sidebar_label: NLP
description: 'Документация для функций обработки естественного языка (NLP)'
title: 'Функции обработки естественного языка (NLP)'
doc_type: reference
---
import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import CloudNotSupportedBadge from '@theme/badges/CloudNotSupportedBadge';


# Функции обработки естественного языка (NLP)

<ExperimentalBadge/>
<CloudNotSupportedBadge/>

:::warning
Это экспериментальная функция, которая находится в разработке и еще не готова к общему использованию. Она будет изменяться непредсказуемым образом, несовместимым с предыдущими версиями, в будущих релизах. Установите `allow_experimental_nlp_functions = 1`, чтобы включить ее.
:::

<!-- 
Внутреннее содержимое тегов ниже заменяется на этапе сборки документа фреймворка на 
документацию, сгенерированную из system.functions. Пожалуйста, не изменяйте и не удаляйте эти теги.
Смотрите: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
-->

<!--AUTOGENERATED_START-->
## detectCharset {#detectCharset}

Введено в: v22.2


Определяет кодировку входной строки, не закодированной в UTF8.


**Синтаксис**

```sql
detectCharset(s)
```

**Аргументы**

- `s` — Текст для анализа. [`String`](/sql-reference/data-types/string)


**Возвращаемое значение**

Возвращает строку, содержащую код определенной кодировки [`String`](/sql-reference/data-types/string)

**Примеры**

**Основное использование**

```sql title=Query
SELECT detectCharset('Ich bleibe für ein paar Tage.')
```

```response title=Response
WINDOWS-1252
```



## detectLanguage {#detectLanguage}

Введено в: v22.2


Определяет язык входной строки, закодированной в UTF8.
Функция использует библиотеку [CLD2](https://github.com/CLD2Owners/cld2) для определения языка и возвращает 2-буквенный код языка по стандарту ISO.

Чем длиннее входной текст, тем точнее будет определение языка.


**Синтаксис**

```sql
detectLanguage(s)
```

**Аргументы**

- `text_to_be_analyzed` — Текст для анализа. [`String`](/sql-reference/data-types/string)


**Возвращаемое значение**

Возвращает 2-буквенный код языка по стандарту ISO. Другие возможные результаты: `un` = неизвестно, язык не может быть определен, `other` = определенный язык не имеет 2-буквенного кода. [`String`](/sql-reference/data-types/string)

**Примеры**

**Текст на смешанных языках**

```sql title=Query
SELECT detectLanguage('Je pense que je ne parviendrai jamais à parler français comme un natif. Where there\'s a will, there\'s a way.')
```

```response title=Response
fr
```



## detectLanguageMixed {#detectLanguageMixed}

Введено в: v22.2


Похоже на функцию [`detectLanguage`](#detectLanguage), но `detectLanguageMixed` возвращает `Map` 2-буквенных кодов языков, сопоставленных с процентом использования определенного языка в тексте.


**Синтаксис**

```sql
detectLanguageMixed(s)
```

**Аргументы**

- `s` — Текст для анализа [`String`](/sql-reference/data-types/string)


**Возвращаемое значение**

Возвращает карту, где ключи — это 2-буквенные коды ISO, а соответствующие значения — процент текста, найденного для этого языка [`Map(String, Float32)`](/sql-reference/data-types/map)

**Примеры**

**Смешанные языки**

```sql title=Query
SELECT detectLanguageMixed('二兎を追う者は一兎をも得ず二兎を追う者は一兎をも得ず A vaincre sans peril, on triomphe sans gloire.')
```

```response title=Response
{'ja':0.62,'fr':0.36}
```



## detectLanguageUnknown {#detectLanguageUnknown}

Введено в: v22.2


Похоже на функцию [`detectLanguage`](#detectLanguage), за исключением того, что функция detectLanguageUnknown работает с не закодированными в UTF8 строками.
Предпочитайте эту версию, если ваша кодировка — UTF-16 или UTF-32.


**Синтаксис**

```sql
detectLanguageUnknown('s')
```

**Аргументы**

- `s` — Текст для анализа. [`String`](/sql-reference/data-types/string)


**Возвращаемое значение**

Возвращает 2-буквенный код языка по стандарту ISO. Другие возможные результаты: `un` = неизвестно, язык не может быть определен, `other` = определенный язык не имеет 2-буквенного кода. [`String`](/sql-reference/data-types/string)

**Примеры**

**Основное использование**

```sql title=Query
SELECT detectLanguageUnknown('Ich bleibe für ein paar Tage.')
```

```response title=Response
de
```



## detectProgrammingLanguage {#detectProgrammingLanguage}

Введено в: v22.2


Определяет язык программирования по заданному фрагменту исходного кода.


**Синтаксис**

```sql
detectProgrammingLanguage('source_code')
```

**Аргументы**

- `source_code` — Строковое представление исходного кода для анализа. [`String`](/sql-reference/data-types/string)


**Возвращаемое значение**

Возвращает язык программирования [`String`](/sql-reference/data-types/string)

**Примеры**

**Определение кода на C++**

```sql title=Query
SELECT detectProgrammingLanguage('#include <iostream>')
```

```response title=Response
C++
```



## detectTonality {#detectTonality}

Введено в: v22.2


Определяет тональность предоставленных текстовых данных.

:::note Ограничение
Эта функция в текущем виде ограничена, так как использует встроенный эмоциональный словарь и работает только с русским языком.
:::


**Синтаксис**

```sql
detectTonality(s)
```

**Аргументы**

- `s` — Текст для анализа. [`String`](/sql-reference/data-types/string)


**Возвращаемое значение**

Возвращает среднее значение тональности слов в тексте [`Float32`](/sql-reference/data-types/float)

**Примеры**

**Анализ тональности на русском языке**

```sql title=Query
SELECT
    detectTonality('Шарик - хороший пёс'),
    detectTonality('Шарик - пёс'),
    detectTonality('Шарик - плохой пёс')
```

```response title=Response
0.44445, 0, -0.3
```



## lemmatize {#lemmatize}

Введено в: v21.9


Выполняет лемматизацию заданного слова.
Эта функция требует словари для работы, которые можно получить на [github](https://github.com/vpodpecan/lemmagen3/tree/master/src/lemmagen3/models). Для получения дополнительной информации о загрузке словаря из локального файла смотрите страницу ["Определение словарей"](/sql-reference/dictionaries#local-file).


**Синтаксис**

```sql
lemmatize(lang, word)
```

**Аргументы**

- `lang` — Язык, к которому будут применены правила. [`String`](/sql-reference/data-types/string)
- `word` — Слово в нижнем регистре, которое нужно лемматизировать. [`String`](/sql-reference/data-types/string)


**Возвращаемое значение**

Возвращает лемматизированную форму слова [`String`](/sql-reference/data-types/string)

**Примеры**

**Лемматизация на английском**

```sql title=Query
SELECT lemmatize('en', 'wolves')
```

```response title=Response
wolf
```



## stem {#stem}

Введено в: v21.9


Выполняет стемминг заданного слова.


**Синтаксис**

```sql
stem(lang, word)
```

**Аргументы**

- `lang` — Язык, к которому будут применены правила. Используйте 2-буквенный код ISO 639-1. [`String`](/sql-reference/data-types/string)
- `word` — Слово в нижнем регистре, которое нужно стеммировать. [`String`](/sql-reference/data-types/string)


**Возвращаемое значение**

Возвращает стеммированную форму слова [`String`](/sql-reference/data-types/string)

**Примеры**

**Стемминг на английском**

```sql title=Query
SELECT arrayMap(x -> stem('en', x),
['I', 'think', 'it', 'is', 'a', 'blessing', 'in', 'disguise']) AS res
```

```response title=Response
['I','think','it','is','a','bless','in','disguis']
```



## synonyms {#synonyms}

Введено в: v21.9


Находит синонимы заданного слова.

Существует два типа расширения синонимов:
- `plain`
- `wordnet`

С типом расширения `plain` необходимо предоставить путь к простому текстовому файлу, где каждая строка соответствует определенному набору синонимов.
Слова в этой строке должны быть разделены пробелами или символами табуляции.

С типом расширения `wordnet` необходимо предоставить путь к каталогу со словарем WordNet.
Словарь должен содержать индекс смыслов WordNet.


**Синтаксис**

```sql
synonyms(ext_name, word)
```

**Аргументы**

- `ext_name` — Имя расширения, в котором будет выполнен поиск. [`String`](/sql-reference/data-types/string)
- `word` — Слово, которое будет искаться в расширении. [`String`](/sql-reference/data-types/string)


**Возвращаемое значение**

Возвращает массив синонимов для данного слова. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Поиск синонимов**

```sql title=Query
SELECT synonyms('list', 'important')
```

```response title=Response
['important','big','critical','crucial']
```



<!--AUTOGENERATED_END-->