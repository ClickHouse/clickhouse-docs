---
description: 'Документация по функциям обработки естественного языка (NLP)'
sidebar_label: 'NLP'
slug: /sql-reference/functions/nlp-functions
title: 'Функции обработки естественного языка (NLP)'
doc_type: 'reference'
keywords: ['NLP', 'Обработка естественного языка']
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import CloudNotSupportedBadge from '@theme/badges/CloudNotSupportedBadge';

# Функции обработки естественного языка (NLP) \\{#natural-language-processing-nlp-functions\\}

<ExperimentalBadge />

<CloudNotSupportedBadge />

:::warning
Это экспериментальная функция, которая в данный момент находится в разработке и не готова к широкому применению. В будущих релизах она может меняться непредсказуемым образом, нарушающим обратную совместимость. Установите `allow_experimental_nlp_functions = 1`, чтобы включить её.
:::

{/* 
  Внутреннее содержимое тегов ниже заменяется во время сборки фреймворка документации
  документацией, сгенерированной из system.functions. Пожалуйста, не изменяйте и не удаляйте эти теги.
  См.: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }

## detectCharset \\{#detectCharset\\}

Появилась в: v22.2

Определяет кодировку входной строки, закодированной не в UTF-8.

**Синтаксис**

```sql
detectCharset(s)
```

**Аргументы**

* `s` — текст для анализа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает строку с кодировкой обнаруженного набора символов. [`String`](/sql-reference/data-types/string)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT detectCharset('Я останусь на несколько дней.')
```

```response title=Response
WINDOWS-1252
```

## detectLanguage \\{#detectLanguage\\}

Появилась в версии: v22.2

Определяет язык входной строки в кодировке UTF-8.
Функция использует библиотеку [CLD2](https://github.com/CLD2Owners/cld2) для определения языка и возвращает двухбуквенный языковой код ISO.

Чем длиннее входные данные, тем точнее будет определение языка.

**Синтаксис**

```sql
detectLanguage(s)
```

**Аргументы**

* `text_to_be_analyzed` — Текст для анализа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает двухбуквенный ISO‑код определённого языка. Другие возможные результаты: `un` = неизвестно, не удалось определить язык, `other` = для определённого языка нет двухбуквенного кода. [`String`](/sql-reference/data-types/string)

**Примеры**

**Текст на смешанном языке**

```sql title=Query
SELECT detectLanguage('Je pense que je ne parviendrai jamais à parler français comme un natif. Where there\'s a will, there\'s a way.')
```

```response title=Response
fr
```

## detectLanguageMixed \\{#detectLanguageMixed\\}

Добавлено в: v22.2

Аналогично функции [`detectLanguage`](#detectLanguage), но `detectLanguageMixed` возвращает `Map`, в котором двухбуквенным кодам языков сопоставлены значения с процентной долей соответствующего языка в тексте.

**Синтаксис**

```sql
detectLanguageMixed(s)
```

**Аргументы**

* `s` — текст для анализа [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает отображение (map), где ключами являются двухбуквенные ISO‑коды, а значениями — процент текста, относящийся к соответствующему языку [`Map(String, Float32)`](/sql-reference/data-types/map)

**Примеры**

**Смешанные языки**

```sql title=Query
SELECT detectLanguageMixed('二兎を追う者は一兎をも得ず二兎を追う者は一兎をも得ず A vaincre sans peril, on triomphe sans gloire.')
```

```response title=Response
{'ja':0.62,'fr':0.36}
```

## detectLanguageUnknown \\{#detectLanguageUnknown\\}

Добавлена в версии: v22.2

Аналогична функции [`detectLanguage`](#detectLanguage), за исключением того, что функция detectLanguageUnknown работает со строками, закодированными не в UTF-8.
Используйте эту версию, когда набор символов — UTF-16 или UTF-32.

**Синтаксис**

```sql
detectLanguageUnknown('s')
```

**Аргументы**

* `s` — текст для анализа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает двухбуквенный код ISO обнаруженного языка. Другие возможные результаты: `un` = неизвестно, не удалось определить язык; `other` = для обнаруженного языка не существует двухбуквенного кода. [`String`](/sql-reference/data-types/string)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT detectLanguageUnknown('Я останусь на несколько дней.')
```

```response title=Response
de
```

## detectProgrammingLanguage \\{#detectProgrammingLanguage\\}

Впервые появилась в версии v22.2

Определяет язык программирования по заданному фрагменту исходного кода.

**Синтаксис**

```sql
detectProgrammingLanguage('source_code')
```

**Аргументы**

* `source_code` — строковое представление исходного кода для анализа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает язык программирования в виде [`String`](/sql-reference/data-types/string)

**Примеры**

**Определение кода на C++**

```sql title=Query
SELECT detectProgrammingLanguage('#include <iostream>')
```

```response title=Response
C++
```

## detectTonality \\{#detectTonality\\}

Появилась в версии: v22.2

Определяет тональность (эмоциональную окраску) переданных текстовых данных.

:::note Ограничение
Текущая реализация функции ограничена использованием встроенного словаря эмоциональной лексики и работает только для русского языка.
:::

**Синтаксис**

```sql
detectTonality(s)
```

**Аргументы**

* `s` — текст для анализа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает среднее значение тональности слов в тексте. [`Float32`](/sql-reference/data-types/float)

**Примеры**

**Анализ тональности текста на русском языке**

```sql title=Query
SELECT
    detectTonality('Шарик - хороший пёс'),
    detectTonality('Шарик - пёс'),
    detectTonality('Шарик - плохой пёс')
```

```response title=Response
0.44445, 0, -0.3
```

## lemmatize \\{#lemmatize\\}

Впервые представлена в версии v21.9

Выполняет лемматизацию заданного слова.
Для работы этой функции требуются словари, которые можно получить с [GitHub](https://github.com/vpodpecan/lemmagen3/tree/master/src/lemmagen3/models). Подробнее о загрузке словаря из локального файла см. на странице [&quot;Определение словарей&quot;](/sql-reference/dictionaries#local-file).

**Синтаксис**

```sql
lemmatize(lang, word)
```

**Аргументы**

* `lang` — Язык, к которому будут применены правила. [`String`](/sql-reference/data-types/string)
* `word` — Слово в нижнем регистре, которое нужно лемматизировать. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает лемматизированную форму слова в виде [`String`](/sql-reference/data-types/string)

**Примеры**

**Лемматизация на английском языке**

```sql title=Query
SELECT lemmatize('en', 'wolves')
```

```response title=Response
волк
```

## stem \\{#stem\\}

Добавлено в: v21.9

Выполняет стемминг для заданного слова.

**Синтаксис**

```sql
stem(lang, word)
```

**Аргументы**

* `lang` — Язык, к которому будут применены правила. Используйте двухбуквенный код ISO 639-1. [`String`](/sql-reference/data-types/string)
* `word` — Слово в нижнем регистре, которое нужно привести к основе (стеммировать). [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает стеммированную форму слова в виде [`String`](/sql-reference/data-types/string)

**Примеры**

**Стемминг английских слов**

```sql title=Query
SELECT arrayMap(x -> stem('en', x),
['I', 'think', 'it', 'is', 'a', 'blessing', 'in', 'disguise']) AS res
```

```response title=Response
['Я','думаю','это','скрытое','благословение']
```

## synonyms \\{#synonyms\\}

Введено в версии v21.9

Находит синонимы заданного слова.

Существует два типа расширений синонимов:

* `plain`
* `wordnet`

Для типа расширения `plain` необходимо указать путь к простому текстовому файлу, в котором каждая строка соответствует определённому набору синонимов.
Слова в этой строке должны быть разделены пробелом или символом табуляции.

Для типа расширения `wordnet` необходимо указать путь к каталогу с тезаурусом WordNet.
Тезаурус должен содержать индекс смыслов (WordNet sense index).

**Синтаксис**

```sql
synonyms(ext_name, word)
```

**Аргументы**

* `ext_name` — Название расширения, в котором будет выполняться поиск. [`String`](/sql-reference/data-types/string)
* `word` — Слово, по которому выполняется поиск в расширении. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает массив синонимов для указанного слова. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Поиск синонимов**

```sql title=Query
SELECT synonyms('list', 'important')
```

```response title=Response
['важный','значительный','критический','решающий']
```

{/*AUTOGENERATED_END*/ }
