---
description: 'Документация по обычным функциям'
sidebar_label: 'Обзор'
sidebar_position: 1
slug: /sql-reference/functions/overview
title: 'Обычные функции'
doc_type: 'reference'
---



# Обычные функции

Существует как минимум\* два типа функций — обычные функции (их просто называют «функциями») и агрегатные функции. Это принципиально разные понятия. Обычные функции работают так, как будто они применяются к каждой строке отдельно (для каждой строки результат функции не зависит от других строк). Агрегатные функции накапливают набор значений из разных строк (т. е. они зависят от всего набора строк).

В этом разделе рассматриваются обычные функции. Об агрегатных функциях см. раздел «Aggregate functions».

:::note 
Существует третий тип функций, к которому относится функция [arrayJoin](../functions/array-join.md). Отдельно также можно упомянуть [табличные функции](../table-functions/index.md).
:::



## Строгая типизация {#strong-typing}

В отличие от стандартного SQL, в ClickHouse используется строгая типизация. Другими словами, неявные преобразования между типами не выполняются. Каждая функция работает с определённым набором типов. Это означает, что иногда требуется использовать функции преобразования типов.


## Устранение общих подвыражений {#common-subexpression-elimination}

Все выражения в запросе с одинаковым AST (одинаковой записью или одинаковым результатом синтаксического анализа) считаются имеющими идентичные значения. Такие выражения объединяются и выполняются однократно. Идентичные подзапросы также устраняются этим способом.


## Типы результатов {#types-of-results}

Все функции возвращают одно значение в качестве результата (не несколько значений и не ноль значений). Тип результата обычно определяется только типами аргументов, а не их значениями. Исключениями являются функция tupleElement (оператор a.N) и функция toFixedString.


## Константы {#constants}

Для упрощения некоторые функции могут работать только с константами в качестве определённых аргументов. Например, правый аргумент оператора LIKE должен быть константой.
Почти все функции возвращают константу при передаче константных аргументов. Исключением являются функции, генерирующие случайные числа.
Функция 'now' возвращает различные значения для запросов, выполненных в разное время, но результат считается константой, поскольку константность важна только в пределах одного запроса.
Константное выражение также считается константой (например, правая часть оператора LIKE может быть построена из нескольких констант).

Функции могут быть реализованы по-разному для константных и неконстантных аргументов (выполняется разный код). Однако результаты для константы и для обычного столбца, содержащего только одно и то же значение, должны совпадать.


## Обработка NULL {#null-processing}

Функции ведут себя следующим образом:

- Если хотя бы один из аргументов функции равен `NULL`, результат функции также будет `NULL`.
- Специальное поведение, которое указывается индивидуально в описании каждой функции. В исходном коде ClickHouse у таких функций установлен параметр `UseDefaultImplementationForNulls=false`.


## Константность {#constancy}

Функции не могут изменять значения своих аргументов — любые изменения возвращаются в качестве результата. Таким образом, результат вычисления отдельных функций не зависит от порядка записи функций в запросе.


## Функции высшего порядка {#higher-order-functions}

### Оператор `->` и лямбда-функции lambda(params, expr) {#arrow-operator-and-lambda}

Функции высшего порядка могут принимать только лямбда-функции в качестве функционального аргумента. Для передачи лямбда-функции в функцию высшего порядка используется оператор `->`. Слева от стрелки указывается формальный параметр (любой идентификатор) или несколько формальных параметров (идентификаторы в кортеже). Справа от стрелки указывается выражение, которое может использовать эти формальные параметры, а также любые столбцы таблицы.

Примеры:

```python
x -> 2 * x
str -> str != Referer
```

Лямбда-функция, принимающая несколько аргументов, также может быть передана в функцию высшего порядка. В этом случае функции высшего порядка передаются несколько массивов одинаковой длины, которым будут соответствовать эти аргументы.

Для некоторых функций первый аргумент (лямбда-функция) может быть опущен. В этом случае предполагается тождественное преобразование.


## Пользовательские функции (UDF) {#user-defined-functions-udfs}

ClickHouse поддерживает пользовательские функции. См. [UDF](../functions/udf.md).
