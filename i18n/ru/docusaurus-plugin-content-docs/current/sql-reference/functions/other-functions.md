---
description: 'Документация по категории «прочие функции»'
sidebar_label: 'Прочие'
slug: /sql-reference/functions/other-functions
title: 'Прочие функции'
doc_type: 'reference'
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import CloudNotSupportedBadge from '@theme/badges/CloudNotSupportedBadge';
import DeprecatedBadge from '@theme/badges/DeprecatedBadge';


# Прочие функции

:::note
Документация по функциям ниже автоматически генерируется из системной таблицы `system.functions`.
:::

<!--
Внутреннее содержимое тегов ниже заменяется во время сборки фреймворка документации
на документацию, сгенерированную из system.functions. Пожалуйста, не изменяйте и не удаляйте теги.
См.: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
-->


<!--AUTOGENERATED_START-->

## FQDN {#FQDN}

Introduced in: v20.1

Возвращает полное доменное имя (FQDN) сервера ClickHouse.

**Синтаксис**

```sql
fqdn()
```

**Псевдонимы**: `fullHostName`

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Полное доменное имя сервера ClickHouse. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT fqdn()
```

```response title=Response
┌─FQDN()──────────────────────────┐
│ clickhouse.us-east-2.internal │
└─────────────────────────────────┘
```


## MACNumToString {#MACNumToString}

Введена в версии: v1.1

Интерпретирует число типа [`UInt64`](/sql-reference/data-types/int-uint) как MAC-адрес в формате big endian.
Возвращает соответствующий MAC-адрес в формате `AA:BB:CC:DD:EE:FF` (шестнадцатеричные числа, разделённые двоеточиями) в виде строки.

**Синтаксис**

```sql
MACNumToString(num)
```

**Аргументы**

- `num` — число типа UInt64. [`UInt64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает MAC-адрес в формате AA:BB:CC:DD:EE:FF. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT MACNumToString(149809441867716) AS mac_address;
```

```response title=Результат
┌─mac_address───────┐
│ 88:00:11:22:33:44 │
└───────────────────┘
```


## MACStringToNum {#MACStringToNum}

Добавлена в версии: v1.1

Обратная функция для MACNumToString. Если MAC-адрес имеет некорректный формат, возвращает 0.

**Синтаксис**

```sql
MACStringToNum(s)
```

**Аргументы**

- `s` — строка с MAC-адресом. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает число типа UInt64. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT MACStringToNum('01:02:03:04:05:06') AS mac_numeric;
```

```response title=Результат
1108152157446
```


## MACStringToOUI {#MACStringToOUI}

Введена в версии: v1.1

Принимает MAC-адрес в формате AA:BB:CC:DD:EE:FF (шестнадцатеричные числа, разделённые двоеточиями) и возвращает первые три октета в виде числа типа UInt64. Если MAC-адрес имеет неверный формат, возвращает 0.

**Синтаксис**

```sql
MACStringToOUI(s)
```

**Аргументы**

- `s` — строка с MAC-адресом. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Первые три октета в виде числа типа UInt64. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT MACStringToOUI('00:50:56:12:34:56') AS oui;
```

```response title=Результат
20566
```


## **filterContains {#**filterContains}

Введена в версии: v25.10

Специальная функция для фильтрации JOIN во время выполнения.

**Синтаксис**

```sql
__filterContains(filter_name, key)
```

**Аргументы**

- `filter_name` — Внутреннее имя фильтра времени выполнения. Создается на этапе BuildRuntimeFilterStep. [`String`](/sql-reference/data-types/string)
- `key` — Значение любого типа, которое проверяется на присутствие в фильтре

**Возвращаемое значение**

Значение `true`, если ключ найден в фильтре [`Bool`](/sql-reference/data-types/boolean)

**Примеры**

**Пример**

```sql title=Query
This function is not supposed to be used in user queries. It might be added to query plan during optimization.
```

```response title=Response

```


## **patchPartitionID {#**patchPartitionID}

Введена в версии: v25.5

Внутренняя функция. Принимает имя куска данных и хеш имён столбцов патч-куска. Возвращает имя партиции патч-куска. Аргумент должен быть корректным именем куска, в противном случае поведение не определено.

**Синтаксис**

```sql

```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

**Примеры**


## authenticatedUser {#authenticatedUser}

Введено в версии: v25.11

Если пользователь сеанса был переключен с помощью команды EXECUTE AS, эта функция возвращает имя исходного пользователя, использованного для аутентификации и создания сеанса.
Псевдоним: authUser()

**Синтаксис**

```sql
authenticatedUser()
```

**Псевдонимы**: `authUser`

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Имя аутентифицированного пользователя. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
EXECUTE as u1;
            SELECT currentUser(), authenticatedUser();
```

```response title=Результат
┌─currentUser()─┬─authenticatedUser()─┐
│ u1            │ default             │
└───────────────┴─────────────────────┘
```


## bar {#bar}

Введена в версии: v1.1

Строит столбчатую диаграмму.
Рисует полосу шириной, пропорциональной (x - min), которая равна width символам при x = max.
Полоса рисуется с точностью до одной восьмой символа.

**Синтаксис**

```sql
bar(x, min, max[, width])
```

**Аргументы**

- `x` — Отображаемое значение. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal)
- `min` — Минимальное значение. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal)
- `max` — Максимальное значение. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal)
- `width` — Необязательный параметр. Ширина полосы в символах. Значение по умолчанию: `80`. [`const (U)Int*`](/sql-reference/data-types/int-uint) или [`const Float*`](/sql-reference/data-types/float) или [`const Decimal`](/sql-reference/data-types/decimal)

**Возвращаемое значение**

Возвращает строку с полосой в виде unicode-графики. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT
toHour(EventTime) AS h,
count() AS c,
bar(c, 0, 600000, 20) AS bar
FROM test.hits
GROUP BY h
ORDER BY h ASC
```

```response title=Результат
┌──h─┬──────c─┬─bar────────────────┐
│  0 │ 292907 │ █████████▋         │
│  1 │ 180563 │ ██████             │
│  2 │ 114861 │ ███▋               │
│  3 │  85069 │ ██▋                │
│  4 │  68543 │ ██▎                │
│  5 │  78116 │ ██▌                │
│  6 │ 113474 │ ███▋               │
│  7 │ 170678 │ █████▋             │
│  8 │ 278380 │ █████████▎         │
│  9 │ 391053 │ █████████████      │
│ 10 │ 457681 │ ███████████████▎   │
│ 11 │ 493667 │ ████████████████▍  │
│ 12 │ 509641 │ ████████████████▊  │
│ 13 │ 522947 │ █████████████████▍ │
│ 14 │ 539954 │ █████████████████▊ │
│ 15 │ 528460 │ █████████████████▌ │
│ 16 │ 539201 │ █████████████████▊ │
│ 17 │ 523539 │ █████████████████▍ │
│ 18 │ 506467 │ ████████████████▊  │
│ 19 │ 520915 │ █████████████████▎ │
│ 20 │ 521665 │ █████████████████▍ │
│ 21 │ 542078 │ ██████████████████ │
│ 22 │ 493642 │ ████████████████▍  │
│ 23 │ 400397 │ █████████████▎     │
└────┴────────┴────────────────────┘
```


## blockNumber {#blockNumber}

Введена в версии: v1.1

Возвращает монотонно возрастающий порядковый номер [блока](../../development/architecture.md#block), содержащего строку.
Возвращаемый номер блока обновляется по мере возможности, то есть может быть не полностью точным.

**Синтаксис**

```sql
blockNumber()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Порядковый номер блока данных, в котором находится строка. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT blockNumber()
FROM
(
    SELECT *
    FROM system.numbers
    LIMIT 10
) SETTINGS max_block_size = 2
```

```response title=Response
┌─blockNumber()─┐
│             7 │
│             7 │
└───────────────┘
┌─blockNumber()─┐
│             8 │
│             8 │
└───────────────┘
┌─blockNumber()─┐
│             9 │
│             9 │
└───────────────┘
┌─blockNumber()─┐
│            10 │
│            10 │
└───────────────┘
┌─blockNumber()─┐
│            11 │
│            11 │
└───────────────┘
```


## blockSerializedSize {#blockSerializedSize}

Введена в версии: v20.3

Возвращает несжатый размер блока значений на диске в байтах.

**Синтаксис**

```sql
blockSerializedSize(x1[, x2[, ...]])
```

**Аргументы**

- `x1[, x2, ...]` — любое количество значений, для которых требуется получить несжатый размер блока. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает количество байтов, которые будут записаны на диск для блока значений без сжатия. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT blockSerializedSize(maxState(1)) AS x;
```

```response title=Результат
┌─x─┐
│ 2 │
└───┘
```


## blockSize {#blockSize}

Введена в версии: v1.1

В ClickHouse запросы обрабатываются [блоками](/development/architecture#block) (порциями данных).
Функция возвращает размер (количество строк) блока, в котором она вызывается.

**Синтаксис**

```sql
blockSize()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает количество строк в текущем блоке. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT blockSize()
FROM system.numbers LIMIT 5
```

```response title=Результат
┌─blockSize()─┐
│           5 │
│           5 │
│           5 │
│           5 │
│           5 │
└─────────────┘
```


## byteSize {#byteSize}

Введена в версии: v21.1

Возвращает оценку несжатого размера аргументов в байтах в памяти.
Для аргументов типа `String` функция возвращает длину строки + 8 (для хранения длины).
При наличии нескольких аргументов функция суммирует их размеры в байтах.

**Синтаксис**

```sql
byteSize(arg1[, arg2, ...])
```

**Аргументы**

- `arg1[, arg2, ...]` — значения любого типа данных, для которых требуется оценить несжатый размер в байтах. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает оценку размера аргументов в байтах в памяти. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT byteSize('string')
```

```response title=Результат
┌─byteSize('string')─┐
│                 15 │
└────────────────────┘
```

**Несколько аргументов**

```sql title=Запрос
SELECT byteSize(NULL, 1, 0.3, '')
```

```response title=Результат
┌─byteSize(NULL, 1, 0.3, '')─┐
│                         19 │
└────────────────────────────┘
```


## catboostEvaluate {#catboostEvaluate}

Introduced in: v22.9

Выполняет вычисление внешней модели CatBoost. [CatBoost](https://catboost.ai) — это библиотека градиентного бустинга с открытым исходным кодом, разработанная компанией Яндекс для машинного обучения.
Принимает путь к модели CatBoost и аргументы модели (признаки).

**Предварительные требования**

1. Сборка библиотеки для вычисления CatBoost

Перед вычислением моделей CatBoost необходимо обеспечить доступность библиотеки `libcatboostmodel.<so|dylib>`. См. [документацию CatBoost](https://catboost.ai/docs/concepts/c-plus-plus-api_dynamic-c-pluplus-wrapper.html) о том, как её скомпилировать.

Затем укажите путь к `libcatboostmodel.<so|dylib>` в конфигурации ClickHouse:

```xml
<clickhouse>
...
    <catboost_lib_path>/path/to/libcatboostmodel.so</catboost_lib_path>
...
</clickhouse>
```

По соображениям безопасности и изоляции вычисление модели выполняется не в процессе сервера, а в процессе clickhouse-library-bridge.
При первом выполнении `catboostEvaluate()` сервер запускает процесс library bridge, если он ещё не запущен. Оба процесса
взаимодействуют через HTTP-интерфейс. По умолчанию используется порт `9012`. Другой порт можно указать следующим образом — это полезно, если порт
`9012` уже занят другим сервисом.

```xml
<library_bridge>
    <port>9019</port>
</library_bridge>
```

2. Обучение модели CatBoost с использованием libcatboost

См. [Обучение и применение моделей](https://catboost.ai/docs/features/training.html#training) о том, как обучать модели CatBoost на обучающем наборе данных.

**Синтаксис**

```sql
catboostEvaluate(path_to_model, feature_1[, feature_2, ..., feature_n])
```

**Аргументы**

- `path_to_model` — путь к модели CatBoost. [`const String`](/sql-reference/data-types/string)
- `feature` — один или несколько признаков/аргументов модели. [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает результат вычисления модели. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**catboostEvaluate**

```sql title=Запрос
SELECT catboostEvaluate('/root/occupy.bin', Temperature, Humidity, Light, CO2, HumidityRatio) AS prediction FROM occupancy LIMIT 1
```

```response title=Ответ
4.695691092573497
```


## colorOKLCHToSRGB {#colorOKLCHToSRGB}

Добавлено в версии: v25.7

Преобразует цвет из перцептивного цветового пространства **OKLCH** в знакомое цветовое пространство **sRGB**.

Если `L` находится вне диапазона `[0...1]`, `C` отрицательно или `H` находится вне диапазона `[0...360]`, результат зависит от реализации.

:::note
**OKLCH** — это цилиндрическая версия цветового пространства OKLab.
Его три координаты: `L` (светлота в диапазоне `[0...1]`), `C` (цветность `>= 0`) и `H` (тон в градусах от `[0...360]`)\*\*.
OKLab/OKLCH спроектирован так, чтобы быть перцептивно однородным при сохранении низкой вычислительной сложности.
:::

Преобразование является обратным к [`colorSRGBToOKLCH`](#colorSRGBToOKLCH):

1. OKLCH в OKLab.
2. OKLab в линейный sRGB
3. Линейный sRGB в sRGB

Второй аргумент gamma используется на последнем этапе.

Справочную информацию о цветах в пространстве OKLCH и их соответствии цветам sRGB см. на [https://oklch.com/](https://oklch.com/).

**Синтаксис**

```sql
colorOKLCHToSRGB(tuple [, gamma])
```

**Аргументы**

- `tuple` — кортеж из трех числовых значений `L`, `C`, `H`, где `L` находится в диапазоне `[0...1]`, `C >= 0` и `H` находится в диапазоне `[0...360]`. [`Tuple(Float64, Float64, Float64)`](/sql-reference/data-types/tuple)
- `gamma` — необязательный параметр. Показатель степени, который используется для преобразования линейного sRGB обратно в sRGB путем применения `(x ^ (1 / gamma)) * 255` для каждого канала `x`. По умолчанию `2.2`. [`Float64`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает кортеж (R, G, B), представляющий значения цвета sRGB. [`Tuple(Float64, Float64, Float64)`](/sql-reference/data-types/tuple)

**Примеры**

**Преобразование OKLCH в sRGB**

```sql title=Query
SELECT colorOKLCHToSRGB((0.4466, 0.0991, 45.44), 2.2) AS rgb
WITH colorOKLCHToSRGB((0.7, 0.1, 54)) as t SELECT tuple(toUInt8(t.1), toUInt8(t.2), toUInt8(t.3)) AS RGB
```

```response title=Response
┌─rgb──────────────────────────────────────────────────────┐
│ (127.03349738778945,66.06672044472008,37.11802592155851) │
└──────────────────────────────────────────────────────────┘
┌─RGB──────────┐
│ (205,139,97) │
└──────────────┘
```


## colorSRGBToOKLCH {#colorSRGBToOKLCH}

Введено в версии: v25.7

Преобразует цвет, закодированный в цветовом пространстве **sRGB**, в перцептивно-однородное цветовое пространство **OKLCH**.

Если какой-либо входной канал находится вне диапазона `[0...255]` или значение гаммы неположительное, поведение определяется реализацией.

:::note
**OKLCH** — это цилиндрическая версия цветового пространства OKLab.
Его три координаты: `L` (светлота в диапазоне `[0...1]`), `C` (цветность `>= 0`) и `H` (оттенок в градусах от `[0...360]`).
OKLab/OKLCH спроектирован так, чтобы быть перцептивно-однородным при сохранении низкой вычислительной сложности.
:::

Преобразование состоит из трёх этапов:

1. sRGB в Linear sRGB
2. Linear sRGB в OKLab
3. OKLab в OKLCH.

Справочную информацию о цветах в пространстве OKLCH и их соответствии цветам sRGB см. на [https://OKLCH.com/](https://OKLCH.com/).

**Синтаксис**

```sql
colorSRGBToOKLCH(tuple[, gamma])
```

**Аргументы**

- `tuple` — кортеж из трёх значений R, G, B в диапазоне `[0...255]`. [`Tuple(UInt8, UInt8, UInt8)`](/sql-reference/data-types/tuple)
- `gamma` — необязательный параметр. Показатель степени, используемый для линеаризации sRGB путём применения `(x / 255)^gamma` к каждому каналу `x`. По умолчанию `2.2`. [`Float64`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает кортеж (L, C, H), представляющий значения цветового пространства OKLCH. [`Tuple(Float64, Float64, Float64)`](/sql-reference/data-types/tuple)

**Примеры**

**Преобразование sRGB в OKLCH**

```sql title=Запрос
SELECT colorSRGBToOKLCH((128, 64, 32), 2.2) AS lch
```

```response title=Результат
┌─lch─────────────────────────────────────────────────────────┐
│ (0.4436238384931984,0.10442699545678624,45.907345481930236) │
└─────────────────────────────────────────────────────────────┘
```


## connectionId {#connectionId}

Введена в версии: v21.3

Возвращает идентификатор соединения клиента, отправившего текущий запрос.
Эта функция наиболее полезна в сценариях отладки.
Она была создана для обеспечения совместимости с функцией `CONNECTION_ID` MySQL.
Обычно не используется в продуктивных запросах.

**Синтаксис**

```sql
connectionId()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает идентификатор соединения текущего клиента. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT connectionId();
```

```response title=Результат
┌─connectionId()─┐
│              0 │
└────────────────┘
```


## countDigits {#countDigits}

Введена в версии: v20.8

Возвращает количество десятичных цифр, необходимых для представления значения.

:::note
Эта функция учитывает масштаб десятичных значений, т.е. вычисляет результат для базового целочисленного типа, равного `(value * scale)`.

Например:

- `countDigits(42) = 2`
- `countDigits(42.000) = 5`
- `countDigits(0.04200) = 4`
  :::

:::tip
Вы можете проверить переполнение `Decimal64` с помощью `countDigits(x) > 18`,
хотя это медленнее, чем [`isDecimalOverflow`](#isDecimalOverflow).
:::

**Синтаксис**

```sql
countDigits(x)
```

**Аргументы**

- `x` — целочисленное или десятичное значение. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Decimal`](/sql-reference/data-types/decimal)

**Возвращаемое значение**

Возвращает количество цифр, необходимых для представления `x`. [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT countDigits(toDecimal32(1, 9)), countDigits(toDecimal32(-1, 9)),
       countDigits(toDecimal64(1, 18)), countDigits(toDecimal64(-1, 18)),
       countDigits(toDecimal128(1, 38)), countDigits(toDecimal128(-1, 38));
```

```response title=Результат
┌─countDigits(toDecimal32(1, 9))─┬─countDigits(toDecimal32(-1, 9))─┬─countDigits(toDecimal64(1, 18))─┬─countDigits(toDecimal64(-1, 18))─┬─countDigits(toDecimal128(1, 38))─┬─countDigits(toDecimal128(-1, 38))─┐
│                             10 │                              10 │                              19 │                               19 │                               39 │                                39 │
└────────────────────────────────┴─────────────────────────────────┴─────────────────────────────────┴──────────────────────────────────┴──────────────────────────────────┴───────────────────────────────────┘
```


## currentDatabase {#currentDatabase}

Введена в версии: v1.1

Возвращает имя текущей базы данных.
Полезна в параметрах движка таблицы запросов `CREATE TABLE`, когда необходимо указать базу данных.

См. также [оператор `SET`](/sql-reference/statements/use).

**Синтаксис**

```sql
currentDatabase()
```

**Псевдонимы**: `current_database`, `SCHEMA`, `DATABASE`

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Имя текущей базы данных. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT currentDatabase()
```

```response title=Результат
┌─currentDatabase()─┐
│ default           │
└───────────────────┘
```


## currentProfiles {#currentProfiles}

Введена в версии: v21.9

Возвращает массив профилей настроек текущего пользователя.

**Синтаксис**

```sql
currentProfiles()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает массив профилей настроек текущего пользователя. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT currentProfiles();
```

```response title=Результат
┌─currentProfiles()─────────────────────────────┐
│ ['default', 'readonly_user', 'web_analytics'] │
└───────────────────────────────────────────────┘
```


## currentQueryID {#currentQueryID}

Введено в версии: v

Возвращает идентификатор текущего запроса.

**Синтаксис**

```sql
currentQueryID()
```

**Псевдонимы**: `current_query_id`

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

**Примеры**

**Пример**

```sql title=Запрос
SELECT currentQueryID();
```

```response title=Результат
┌─currentQueryID()─────────────────────┐
│ 1280d0e8-1a08-4524-be6e-77975bb68e7d │
└──────────────────────────────────────┘
```


## currentRoles {#currentRoles}

Введена в версии: v21.9

Возвращает массив ролей, назначенных текущему пользователю.

**Синтаксис**

```sql
currentRoles()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Массив ролей, назначенных текущему пользователю. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT currentRoles();
```

```response title=Результат
┌─currentRoles()─────────────────────────────────┐
│ ['sql-console-role:jane.smith@clickhouse.com'] │
└────────────────────────────────────────────────┘
```


## currentSchemas {#currentSchemas}

Добавлена в версии: v23.7

Аналогична функции [`currentDatabase`](#currentDatabase), но

- принимает булев аргумент, который игнорируется
- возвращает имя базы данных в виде массива с одним значением.

Функция `currentSchemas` существует только для совместимости с PostgreSQL.
Рекомендуется использовать `currentDatabase`.

См. также оператор [`SET`](/sql-reference/statements/use).

**Синтаксис**

```sql
currentSchemas(bool)
```

**Псевдонимы**: `current_schemas`

**Аргументы**

- `bool` — булево значение, которое игнорируется. [`Bool`](/sql-reference/data-types/boolean)

**Возвращаемое значение**

Возвращает массив из одного элемента с именем текущей базы данных. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Query
SELECT currentSchemas(true)
```

```response title=Response
┌─currentSchemas(true)─┐
│ ['default']          │
└──────────────────────┘
```


## currentUser {#currentUser}

Введено в версии: v20.1

Возвращает имя текущего пользователя.
В случае распределённого запроса возвращается имя пользователя, который инициировал запрос.

**Синтаксис**

```sql
currentUser()
```

**Псевдонимы**: `current_user`, `user`

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Имя текущего пользователя или логин пользователя, который инициировал запрос. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT currentUser()
```

```response title=Результат
┌─currentUser()─┐
│ default       │
└───────────────┘
```


## defaultProfiles {#defaultProfiles}

Введена в версии: v21.9

Возвращает массив имён профилей настроек по умолчанию для текущего пользователя.

**Синтаксис**

```sql
defaultProfiles()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает массив имён профилей настроек по умолчанию для текущего пользователя. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT defaultProfiles();
```

```response title=Результат
┌─defaultProfiles()─┐
│ ['default']       │
└───────────────────┘
```


## defaultRoles {#defaultRoles}

Введена в версии: v21.9

Возвращает массив ролей по умолчанию для текущего пользователя.

**Синтаксис**

```sql
defaultRoles()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Массив ролей по умолчанию для текущего пользователя. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT defaultRoles();
```

```response title=Результат
┌─defaultRoles()─────────────────────────────────┐
│ ['sql-console-role:jane.smith@clickhouse.com'] │
└────────────────────────────────────────────────┘
```


## defaultValueOfArgumentType {#defaultValueOfArgumentType}

Введена в версии: v1.1

Возвращает значение по умолчанию для заданного типа данных.
Не включает значения по умолчанию для пользовательских столбцов, заданные пользователем.

**Синтаксис**

```sql
defaultValueOfArgumentType(expression)
```

**Аргументы**

- `expression` — значение произвольного типа или выражение, результатом которого является значение произвольного типа. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает `0` для чисел, пустую строку для строк или `NULL` для типов Nullable. [`UInt8`](/sql-reference/data-types/int-uint) или [`String`](/sql-reference/data-types/string) или [`NULL`](/sql-reference/syntax#null)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT defaultValueOfArgumentType(CAST(1 AS Int8));
```

```response title=Ответ
┌─defaultValueOfArgumentType(CAST(1, 'Int8'))─┐
│                                           0 │
└─────────────────────────────────────────────┘
```

**Пример с Nullable**

```sql title=Запрос
SELECT defaultValueOfArgumentType(CAST(1 AS Nullable(Int8)));
```

```response title=Ответ
┌─defaultValueOfArgumentType(CAST(1, 'Nullable(Int8)'))─┐
│                                                  ᴺᵁᴸᴸ │
└───────────────────────────────────────────────────────┘
```


## defaultValueOfTypeName {#defaultValueOfTypeName}

Введена в версии: v1.1

Возвращает значение по умолчанию для заданного имени типа.

**Синтаксис**

```sql
defaultValueOfTypeName(type)
```

**Аргументы**

- `type` — строка, представляющая имя типа. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает значение по умолчанию для заданного имени типа: `0` для числовых типов, пустую строку для строковых типов или `NULL` для типов Nullable [`UInt8`](/sql-reference/data-types/int-uint) или [`String`](/sql-reference/data-types/string) или [`NULL`](/sql-reference/syntax#null)

**Примеры**

**Пример использования**

```sql title=Query
SELECT defaultValueOfTypeName('Int8');
```

```response title=Response
┌─defaultValueOfTypeName('Int8')─┐
│                              0 │
└────────────────────────────────┘
```

**Пример с Nullable**

```sql title=Query
SELECT defaultValueOfTypeName('Nullable(Int8)');
```

```response title=Response
┌─defaultValueOfTypeName('Nullable(Int8)')─┐
│                                     ᴺᵁᴸᴸ │
└──────────────────────────────────────────┘
```


## displayName {#displayName}

Введена в версии: v22.11

Возвращает значение `display_name` из [конфигурации](/operations/configuration-files) или полное доменное имя сервера (FQDN), если параметр не задан.

**Синтаксис**

```sql
displayName()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает значение `display_name` из конфигурации или FQDN сервера, если параметр не задан. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT displayName();
```

```response title=Результат
┌─displayName()─┐
│ production    │
└───────────────┘
```


## dumpColumnStructure {#dumpColumnStructure}

Введена в версии: v1.1

Выводит подробное описание внутренней структуры столбца и его типа данных.

**Синтаксис**

```sql
dumpColumnStructure(x)
```

**Аргументы**

- `x` — значение, для которого требуется получить описание. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает описание структуры столбца, используемой для представления значения. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT dumpColumnStructure(CAST('2018-01-01 01:02:03', 'DateTime'));
```

```response title=Response
┌─dumpColumnStructure(CAST('2018-01-01 01:02:03', 'DateTime'))─┐
│ DateTime, Const(size = 1, UInt32(size = 1))                  │
└──────────────────────────────────────────────────────────────┘
```


## enabledProfiles {#enabledProfiles}

Введена в версии: v21.9

Возвращает массив имён профилей настроек, включённых для текущего пользователя.

**Синтаксис**

```sql
enabledProfiles()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает массив имён профилей настроек, включённых для текущего пользователя. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT enabledProfiles();
```

```response title=Результат
┌─enabledProfiles()─────────────────────────────────────────────────┐
│ ['default', 'readonly_user', 'web_analytics', 'batch_processing'] │
└───────────────────────────────────────────────────────────────────┘
```


## enabledRoles {#enabledRoles}

Введена в версии: v21.9

Возвращает массив ролей, включённых для текущего пользователя.

**Синтаксис**

```sql
enabledRoles()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает массив имён ролей, включённых для текущего пользователя. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT enabledRoles();
```

```response title=Результат
┌─enabledRoles()─────────────────────────────────────────────────┐
│ ['general_data', 'sql-console-role:jane.smith@clickhouse.com'] │
└────────────────────────────────────────────────────────────────┘
```


## errorCodeToName {#errorCodeToName}

Введена в версии: v20.12

Возвращает текстовое имя числового кода ошибки ClickHouse.
Соответствие числовых кодов ошибок их именам доступно [здесь](https://github.com/ClickHouse/ClickHouse/blob/master/src/Common/ErrorCodes.cpp).

**Синтаксис**

```sql
errorCodeToName(error_code)
```

**Аргументы**

- `error_code` — код ошибки ClickHouse. [`(U)Int*`](/sql-reference/data-types/int-uint), [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal)

**Возвращаемое значение**

Возвращает текстовое имя `error_code`. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT errorCodeToName(252);
```

```response title=Результат
┌─errorCodeToName(252)─┐
│ TOO_MANY_PARTS       │
└──────────────────────┘
```


## file {#file}

Введено в версии: v21.3

Читает файл как строку и загружает данные в указанный столбец.
Содержимое файла не интерпретируется.

См. также табличную функцию [`file`](../table-functions/file.md).

**Синтаксис**

```sql
file(path[, default])
```

**Аргументы**

- `path` — Путь к файлу относительно `user_files_path`. Поддерживает подстановочные символы `*`, `**`, `?`, `{abc,def}` и `{N..M}`, где `N`, `M` — числа, а `'abc'`, `'def'` — строки. [`String`](/sql-reference/data-types/string)
- `default` — Значение, возвращаемое, если файл не существует или недоступен. [`String`](/sql-reference/data-types/string) или [`NULL`](/sql-reference/syntax#null)

**Возвращаемое значение**

Возвращает содержимое файла в виде строки. [`String`](/sql-reference/data-types/string)

**Примеры**

**Вставка файлов в таблицу**

```sql title=Запрос
INSERT INTO table SELECT file('a.txt'), file('b.txt');
```

```response title=Результат

```


## filesystemAvailable {#filesystemAvailable}

Введена в версии: v20.1

Возвращает объем свободного пространства в файловой системе, где хранятся данные базы данных.
Возвращаемое значение всегда меньше общего свободного пространства ([`filesystemUnreserved`](../../sql-reference/functions/other-functions.md#filesystemUnreserved)), так как часть пространства зарезервирована операционной системой.

**Синтаксис**

```sql
filesystemAvailable([disk_name])
```

**Аргументы**

- `disk_name` — Необязательный параметр. Имя диска, для которого нужно определить объем свободного пространства. Если не указан, используется диск по умолчанию. [`String`](/sql-reference/data-types/string) или [`FixedString`](/sql-reference/data-types/fixedstring)

**Возвращаемое значение**

Возвращает объем доступного свободного пространства в байтах. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT formatReadableSize(filesystemAvailable()) AS "Доступное пространство";
```

```response title=Результат
┌─Доступное пространство─┐
│ 30.75 ГиБ              │
└────────────────────────┘
```


## filesystemCapacity {#filesystemCapacity}

Введена в версии: v20.1

Возвращает емкость файловой системы в байтах.
Требуется настройка параметра [path](../../operations/server-configuration-parameters/settings.md#path) для директории данных.

**Синтаксис**

```sql
filesystemCapacity([disk_name])
```

**Аргументы**

- `disk_name` — Необязательный параметр. Имя диска, для которого требуется получить емкость. Если не указан, используется диск по умолчанию. [`String`](/sql-reference/data-types/string) или [`FixedString`](/sql-reference/data-types/fixedstring)

**Возвращаемое значение**

Возвращает емкость файловой системы в байтах. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT formatReadableSize(filesystemCapacity()) AS "Capacity";
```

```response title=Результат
┌─Capacity──┐
│ 39.32 GiB │
└───────────┘
```


## filesystemUnreserved {#filesystemUnreserved}

Введена в версии: v22.12

Возвращает общий объём свободного места в файловой системе, на которой размещается хранилище базы данных (ранее `filesystemFree`).
См. также [`filesystemAvailable`](#filesystemAvailable).

**Синтаксис**

```sql
filesystemUnreserved([disk_name])
```

**Аргументы**

- `disk_name` — Необязательный параметр. Имя диска, для которого требуется определить общий объём свободного места. Если не указан, используется диск по умолчанию. [`String`](/sql-reference/data-types/string) или [`FixedString`](/sql-reference/data-types/fixedstring)

**Возвращаемое значение**

Возвращает объём свободного места в байтах. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
SELECT formatReadableSize(filesystemUnreserved()) AS "Свободное место";
```

```response title=Response
┌─Свободное место─┐
│ 32.39 GiB       │
└─────────────────┘
```


## finalizeAggregation {#finalizeAggregation}

Введена в версии: v1.1

Принимая состояние агрегации, функция возвращает результат агрегации (или финализированное состояние при использовании комбинатора [-State](../../sql-reference/aggregate-functions/combinators.md#-state)).

**Синтаксис**

```sql
finalizeAggregation(state)
```

**Аргументы**

- `state` — Состояние агрегации. [`AggregateFunction`](/sql-reference/data-types/aggregatefunction)

**Возвращаемое значение**

Возвращает финализированный результат агрегации. [`Any`](/sql-reference/data-types)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT finalizeAggregation(arrayReduce('maxState', [1, 2, 3]));
```

```response title=Ответ
┌─finalizeAggregation(arrayReduce('maxState', [1, 2, 3]))─┐
│                                                       3 │
└─────────────────────────────────────────────────────────┘
```

**В сочетании с initializeAggregation**

```sql title=Запрос
WITH initializeAggregation('sumState', number) AS one_row_sum_state
SELECT
    number,
    finalizeAggregation(one_row_sum_state) AS one_row_sum,
    runningAccumulate(one_row_sum_state) AS cumulative_sum
FROM numbers(5);
```

```response title=Ответ
┌─number─┬─one_row_sum─┬─cumulative_sum─┐
│      0 │           0 │              0 │
│      1 │           1 │              1 │
│      2 │           2 │              3 │
│      3 │           3 │              6 │
│      4 │           4 │             10 │
└────────┴─────────────┴────────────────┘
```


## flipCoordinates {#flipCoordinates}

Введено в версии: v25.10

Меняет местами координаты Point, Ring, Polygon или MultiPolygon. Для Point меняет координаты местами. Для массивов рекурсивно применяет то же преобразование к каждой паре координат.

**Синтаксис**

```sql
flipCoordinates(geometry)
```

**Аргументы**

- `geometry` — геометрия для преобразования. Поддерживаемые типы: Point (Tuple(Float64, Float64)), Ring (Array(Point)), Polygon (Array(Ring)), MultiPolygon (Array(Polygon)).

**Возвращаемое значение**

Геометрия с перевёрнутыми координатами. Тип совпадает с входным. [`Point`](/sql-reference/data-types/geo#point) или [`Ring`](/sql-reference/data-types/geo#ring) или [`Polygon`](/sql-reference/data-types/geo#polygon) или [`MultiPolygon`](/sql-reference/data-types/geo#multipolygon)

**Примеры**

**basic_point**

```sql title=Запрос
SELECT flipCoordinates((1.0, 2.0));
```

```response title=Результат
(2.0, 1.0)
```

**ring**

```sql title=Запрос
SELECT flipCoordinates([(1.0, 2.0), (3.0, 4.0)]);
```

```response title=Результат
[(2.0, 1.0), (4.0, 3.0)]
```

**polygon**

```sql title=Запрос
SELECT flipCoordinates([[(1.0, 2.0), (3.0, 4.0)], [(5.0, 6.0), (7.0, 8.0)]]);
```

```response title=Результат
[[(2.0, 1.0), (4.0, 3.0)], [(6.0, 5.0), (8.0, 7.0)]]
```


## formatQuery {#formatQuery}

Введена в версии: v

Возвращает отформатированную, возможно многострочную, версию переданного SQL-запроса. Выбрасывает исключение в случае ошибки разбора.
[example:multiline]

**Синтаксис**

```sql
formatQuery(query)
```

**Аргументы**

- `query` — SQL-запрос для форматирования. [String](../../sql-reference/data-types/string.md)

**Возвращаемое значение**

Отформатированный запрос [`String`](/sql-reference/data-types/string)

**Примеры**

**многострочный**

```sql title=Запрос
SELECT formatQuery('select a,    b FRom tab WHERE a > 3 and  b < 3');
```

```response title=Результат
SELECT
    a,
    b
FROM tab
WHERE (a > 3) AND (b < 3)
```


## formatQueryOrNull {#formatQueryOrNull}

Введена в версии: v

Возвращает отформатированную, возможно многострочную, версию переданного SQL-запроса. Возвращает NULL в случае ошибки разбора.
[example:multiline]

**Синтаксис**

```sql
formatQueryOrNull(query)
```

**Аргументы**

- `query` — SQL-запрос для форматирования. [String](../../sql-reference/data-types/string.md)

**Возвращаемое значение**

Отформатированный запрос [`String`](/sql-reference/data-types/string)

**Примеры**

**многострочный формат**

```sql title=Query
SELECT formatQuery('select a,    b FRom tab WHERE a > 3 and  b < 3');
```

```response title=Response
SELECT
    a,
    b
FROM tab
WHERE (a > 3) AND (b < 3)
```


## formatQuerySingleLine {#formatQuerySingleLine}

Введена в версии: v

Аналогична formatQuery(), но возвращаемая отформатированная строка не содержит переносов строк. Генерирует исключение в случае ошибки разбора.
[example:multiline]

**Синтаксис**

```sql
formatQuerySingleLine(query)
```

**Аргументы**

- `query` — SQL-запрос для форматирования. [String](../../sql-reference/data-types/string.md)

**Возвращаемое значение**

Отформатированный запрос [`String`](/sql-reference/data-types/string)

**Примеры**

**multiline**

```sql title=Запрос
SELECT formatQuerySingleLine('select a,    b FRom tab WHERE a > 3 and  b < 3');
```

```response title=Результат
SELECT a, b FROM tab WHERE (a > 3) AND (b < 3)
```


## formatQuerySingleLineOrNull {#formatQuerySingleLineOrNull}

Introduced in: v

Аналогична formatQuery(), но возвращаемая отформатированная строка не содержит переносов строк. Возвращает NULL в случае ошибки разбора.
[example:multiline]

**Синтаксис**

```sql
formatQuerySingleLineOrNull(query)
```

**Аргументы**

- `query` — SQL-запрос для форматирования. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Отформатированный запрос [`String`](/sql-reference/data-types/string)

**Примеры**

**multiline**

```sql title=Query
SELECT formatQuerySingleLine('select a,    b FRom tab WHERE a > 3 and  b < 3');
```

```response title=Response
SELECT a, b FROM tab WHERE (a > 3) AND (b < 3)
```


## formatReadableDecimalSize {#formatReadableDecimalSize}

Добавлена в версии: v22.11

Функция принимает размер (число байтов) и возвращает читаемое, округлённое значение размера с суффиксом (KB, MB и т.д.) в виде строки.

Обратной операцией к этой функции является [`parseReadableSize`](#parseReadableSize).

**Синтаксис**

```sql
formatReadableDecimalSize(x)
```

**Аргументы**

- `x` — Размер в байтах. [`UInt64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает читаемое, округлённое значение размера с суффиксом в виде строки. [`String`](/sql-reference/data-types/string)

**Примеры**

**Форматирование размеров файлов**

```sql title=Запрос
SELECT
    arrayJoin([1, 1024, 1024*1024, 192851925]) AS filesize_bytes,
    formatReadableDecimalSize(filesize_bytes) AS filesize
```

```response title=Результат
┌─filesize_bytes─┬─filesize───┐
│              1 │ 1.00 B     │
│           1024 │ 1.02 KB    │
│        1048576 │ 1.05 MB    │
│      192851925 │ 192.85 MB  │
└────────────────┴────────────┘
```


## formatReadableQuantity {#formatReadableQuantity}

Введена в версии: v20.10

Принимает число и возвращает округлённое число с суффиксом (тысяча, миллион, миллиард и т. д.) в виде строки.

Функция принимает любой числовой тип в качестве входных данных, но внутренне приводит их к типу `Float64`.
Результаты могут быть неоптимальными при работе с большими значениями.

**Синтаксис**

```sql
formatReadableQuantity(x)
```

**Аргументы**

- `x` — число для форматирования. [`UInt64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает округлённое число с суффиксом в виде строки. [`String`](/sql-reference/data-types/string)

**Примеры**

**Форматирование чисел с суффиксами**

```sql title=Запрос
SELECT
    arrayJoin([1024, 1234 * 1000, (4567 * 1000) * 1000, 98765432101234]) AS number,
    formatReadableQuantity(number) AS number_for_humans
```

```response title=Результат
┌─────────number─┬─number_for_humans─┐
│           1024 │ 1.02 thousand     │
│        1234000 │ 1.23 million      │
│     4567000000 │ 4.57 billion      │
│ 98765432101234 │ 98.77 trillion    │
└────────────────┴───────────────────┘
```


## formatReadableSize {#formatReadableSize}

Введена в версии: v1.1

Функция принимает размер (количество байтов) и возвращает читаемое округлённое значение с суффиксом (KiB, MiB и т. д.) в виде строки.

Обратными операциями к этой функции являются [`parseReadableSize`](#parseReadableSize), [`parseReadableSizeOrZero`](#parseReadableSizeOrZero) и [`parseReadableSizeOrNull`](#parseReadableSizeOrNull).
Функция принимает на вход любой числовой тип, но внутренне приводит значения к типу `Float64`. При работе с большими значениями результаты могут быть неоптимальными.

**Синтаксис**

```sql
formatReadableSize(x)
```

**Псевдонимы**: `FORMAT_BYTES`

**Аргументы**

- `x` — Размер в байтах. [`UInt64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает читаемое округлённое значение размера с суффиксом в виде строки. [`String`](/sql-reference/data-types/string)

**Примеры**

**Форматирование размеров файлов**

```sql title=Запрос
SELECT
    arrayJoin([1, 1024, 1024*1024, 192851925]) AS filesize_bytes,
    formatReadableSize(filesize_bytes) AS filesize
```

```response title=Результат
┌─filesize_bytes─┬─filesize───┐
│              1 │ 1.00 B     │
│           1024 │ 1.00 KiB   │
│        1048576 │ 1.00 MiB   │
│      192851925 │ 183.92 MiB │
└────────────────┴────────────┘
```


## formatReadableTimeDelta {#formatReadableTimeDelta}

Введена в версии: v20.12

Функция принимает временной интервал (дельту) в секундах и возвращает временную дельту в виде строки с указанием лет/месяцев/дней/часов/минут/секунд/миллисекунд/микросекунд/наносекунд.

Функция принимает на вход любой числовой тип, но внутренне приводит значения к типу `Float64`. При больших значениях результаты могут быть неоптимальными.

**Синтаксис**

```sql
formatReadableTimeDelta(column[, maximum_unit, minimum_unit])
```

**Аргументы**

- `column` — Столбец с числовой временной дельтой. [`Float64`](/sql-reference/data-types/float)
- `maximum_unit` — Необязательный параметр. Максимальная единица измерения для отображения. Допустимые значения: `nanoseconds`, `microseconds`, `milliseconds`, `seconds`, `minutes`, `hours`, `days`, `months`, `years`. Значение по умолчанию: `years`. [`const String`](/sql-reference/data-types/string)
- `minimum_unit` — Необязательный параметр. Минимальная единица измерения для отображения. Все меньшие единицы отбрасываются. Допустимые значения: `nanoseconds`, `microseconds`, `milliseconds`, `seconds`, `minutes`, `hours`, `days`, `months`, `years`. Если явно указанное значение больше, чем `maximum_unit`, будет выброшено исключение. Значение по умолчанию: `seconds`, если `maximum_unit` равен `seconds` или больше, иначе `nanoseconds`. [`const String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает временную дельту в виде строки. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT
    arrayJoin([100, 12345, 432546534]) AS elapsed,
    formatReadableTimeDelta(elapsed) AS time_delta
```

```response title=Ответ
┌────elapsed─┬─time_delta─────────────────────────────────────────────────────┐
│        100 │ 1 minute and 40 seconds                                        │
│      12345 │ 3 hours, 25 minutes and 45 seconds                             │
│  432546534 │ 13 years, 8 months, 17 days, 7 hours, 48 minutes and 54 seconds│
└────────────┴────────────────────────────────────────────────────────────────┘
```

**С максимальной единицей измерения**

```sql title=Запрос
SELECT
    arrayJoin([100, 12345, 432546534]) AS elapsed,
    formatReadableTimeDelta(elapsed, 'minutes') AS time_delta
```

```response title=Ответ
┌────elapsed─┬─time_delta─────────────────────────────────────────────────────┐
│        100 │ 1 minute and 40 seconds                                         │
│      12345 │ 205 minutes and 45 seconds                                      │
│  432546534 │ 7209108 minutes and 54 seconds                                  │
└────────────┴─────────────────────────────────────────────────────────────────┘
```


## generateRandomStructure {#generateRandomStructure}

Введена в версии: v23.5

Генерирует случайную структуру таблицы в формате `column1_name column1_type, column2_name column2_type, ...`.

**Синтаксис**

```sql
generateRandomStructure([number_of_columns, seed])
```

**Аргументы**

- `number_of_columns` — Требуемое количество столбцов в результирующей структуре таблицы. Если установлено значение 0 или `Null`, количество столбцов будет случайным в диапазоне от 1 до 128. Значение по умолчанию: `Null`. [`UInt64`](/sql-reference/data-types/int-uint)
- `seed` — Начальное значение (seed) для генератора случайных чисел, обеспечивающее воспроизводимость результатов. Если не указано или установлено в `Null`, генерируется случайным образом. [`UInt64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Случайно сгенерированная структура таблицы. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT generateRandomStructure()
```

```response title=Ответ
c1 Decimal32(5), c2 Date, c3 Tuple(LowCardinality(String), Int128, UInt64, UInt16, UInt8, IPv6), c4 Array(UInt128), c5 UInt32, c6 IPv4, c7 Decimal256(64), c8 Decimal128(3), c9 UInt256, c10 UInt64, c11 DateTime
```

**С указанием количества столбцов**

```sql title=Запрос
SELECT generateRandomStructure(1)
```

```response title=Ответ
c1 Map(UInt256, UInt16)
```

**С указанием начального значения**

```sql title=Запрос
SELECT generateRandomStructure(NULL, 33)
```

```response title=Ответ
c1 DateTime, c2 Enum8('c2V0' = 0, 'c2V1' = 1, 'c2V2' = 2, 'c2V3' = 3), c3 LowCardinality(Nullable(FixedString(30))), c4 Int16, c5 Enum8('c5V0' = 0, 'c5V1' = 1, 'c5V2' = 2, 'c5V3' = 3), c6 Nullable(UInt8), c7 String, c8 Nested(e1 IPv4, e2 UInt8, e3 UInt16, e4 UInt16, e5 Int32, e6 Map(Date, Decimal256(70)))
```


## generateSerialID {#generateSerialID}

Введена в версии: v25.1

Генерирует и возвращает последовательные числа, начиная с предыдущего значения счётчика.
Функция принимает строковый аргумент — идентификатор последовательности и необязательное начальное значение.
Сервер должен быть настроен с использованием Keeper.
Последовательности хранятся в узлах Keeper по пути, который можно настроить с помощью параметра [`series_keeper_path`](/operations/server-configuration-parameters/settings#series_keeper_path) в конфигурации сервера.

**Синтаксис**

```sql
generateSerialID(series_identifier[, start_value])
```

**Аргументы**

- `series_identifier` — идентификатор последовательности [`const String`](/sql-reference/data-types/string)
- `start_value` — необязательный параметр. Начальное значение счётчика. По умолчанию 0. Примечание: это значение используется только при создании новой последовательности и игнорируется, если последовательность уже существует [`UInt*`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает последовательные числа, начиная с предыдущего значения счётчика. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**первый вызов**

```sql title=Запрос
SELECT generateSerialID('id1')
```

```response title=Ответ
┌─generateSerialID('id1')──┐
│                        1 │
└──────────────────────────┘
```

**второй вызов**

```sql title=Запрос
SELECT generateSerialID('id1')
```

```response title=Ответ
┌─generateSerialID('id1')──┐
│                        2 │
└──────────────────────────┘
```

**вызов для столбца**

```sql title=Запрос
SELECT *, generateSerialID('id1') FROM test_table
```

```response title=Ответ
┌─CounterID─┬─UserID─┬─ver─┬─generateSerialID('id1')──┐
│         1 │      3 │   3 │                        3 │
│         1 │      1 │   1 │                        4 │
│         1 │      2 │   2 │                        5 │
│         1 │      5 │   5 │                        6 │
│         1 │      4 │   4 │                        7 │
└───────────┴────────┴─────┴──────────────────────────┘
```

**с начальным значением**

```sql title=Запрос
SELECT generateSerialID('id2', 100)
```

```response title=Ответ
┌─generateSerialID('id2', 100)──┐
│                           100 │
└───────────────────────────────┘
```

**второй вызов с начальным значением**

```sql title=Запрос
SELECT generateSerialID('id2', 100)
```

```response title=Ответ
┌─generateSerialID('id2', 100)──┐
│                           101 │
└───────────────────────────────┘
```


## getClientHTTPHeader {#getClientHTTPHeader}

Введена в версии: v24.5

Возвращает значение HTTP-заголовка.
Если такой заголовок отсутствует или текущий запрос выполняется не через HTTP-интерфейс, функция возвращает пустую строку.
Доступ к некоторым HTTP-заголовкам (например, `Authentication` и `X-ClickHouse-*`) ограничен.

:::note Требуется настройка `allow_get_client_http_header`
Для работы функции необходимо включить настройку `allow_get_client_http_header`.
По умолчанию эта настройка отключена из соображений безопасности, поскольку некоторые заголовки, такие как `Cookie`, могут содержать конфиденциальную информацию.
:::

Для этой функции HTTP-заголовки чувствительны к регистру.
При использовании функции в контексте распределённого запроса непустой результат возвращается только на узле-инициаторе.

**Синтаксис**

```sql
getClientHTTPHeader(name)
```

**Аргументы**

- `name` — имя HTTP-заголовка. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает значение заголовка. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT getClientHTTPHeader('Content-Type');
```

```response title=Результат
┌─getClientHTTPHeader('Content-Type')─┐
│ application/x-www-form-urlencoded   │
└─────────────────────────────────────┘
```


## getMacro {#getMacro}

Введена в версии: v20.1

Возвращает значение макроса из конфигурационного файла сервера.
Макросы определяются в секции [`<macros>`](/operations/server-configuration-parameters/settings#macros) конфигурационного файла и могут использоваться для различения серверов по удобным именам, даже если у них сложные имена хостов.
Если функция выполняется в контексте распределённой таблицы, она генерирует обычный столбец со значениями, релевантными для каждого шарда.

**Синтаксис**

```sql
getMacro(name)
```

**Аргументы**

- `name` — имя макроса для получения. [`const String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает значение указанного макроса. [`String`](/sql-reference/data-types/string)

**Примеры**

**Базовое использование**

```sql title=Запрос
SELECT getMacro('test');
```

```response title=Результат
┌─getMacro('test')─┐
│ Value            │
└──────────────────┘
```


## getMaxTableNameLengthForDatabase {#getMaxTableNameLengthForDatabase}

Introduced in: v

Возвращает максимальную длину имени таблицы в указанной базе данных.

**Синтаксис**

```sql
getMaxTableNameLengthForDatabase(database_name)
```

**Аргументы**

- `database_name` — имя указанной базы данных. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает длину самого длинного имени таблицы в виде целого числа (Integer).

**Примеры**

**Типичный пример**

```sql title=Query
SELECT getMaxTableNameLengthForDatabase('default');
```

```response title=Response
┌─getMaxTableNameLengthForDatabase('default')─┐
            │                                         206 │
            └─────────────────────────────────────────────┘
```


## getMergeTreeSetting {#getMergeTreeSetting}

Введена в версии: v25.6

Возвращает текущее значение настройки MergeTree.

**Синтаксис**

```sql
getMergeTreeSetting(setting_name)
```

**Аргументы**

- `setting_name` — имя настройки. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает текущее значение настройки MergeTree.

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT getMergeTreeSetting('index_granularity');
```

```response title=Результат
┌─getMergeTreeSetting('index_granularity')─┐
│                                     8192 │
└──────────────────────────────────────────┘
```


## getOSKernelVersion {#getOSKernelVersion}

Добавлена в версии: v21.11

Возвращает строку с версией ядра операционной системы.

**Синтаксис**

```sql
getOSKernelVersion()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает текущую версию ядра операционной системы. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT getOSKernelVersion();
```

```response title=Результат
┌─getOSKernelVersion()────┐
│ Linux 4.15.0-55-generic │
└─────────────────────────┘
```


## getServerPort {#getServerPort}

Введена в версии: v21.10

Возвращает номер порта сервера для заданного протокола.

**Синтаксис**

```sql
getServerPort(port_name)
```

**Аргументы**

- `port_name` — название порта. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Номер порта сервера. [`UInt16`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT getServerPort('tcp_port');
```

```response title=Результат
┌─getServerPort('tcp_port')─┐
│                      9000 │
└───────────────────────────┘
```


## getServerSetting {#getServerSetting}

Введена в версии: v25.6

Возвращает текущее значение настройки сервера по её имени.

**Синтаксис**

```sql
getServerSetting(setting_name')
```

**Аргументы**

- `setting_name` — имя настройки сервера. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает текущее значение настройки сервера. [`Any`](/sql-reference/data-types)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT getServerSetting('allow_use_jemalloc_memory');
```

```response title=Ответ
┌─getServerSetting('allow_use_jemalloc_memory')─┐
│ true                                          │
└───────────────────────────────────────────────┘
```


## getSetting {#getSetting}

Введена в версии: v20.7

Возвращает текущее значение настройки.

**Синтаксис**

```sql
getSetting(setting_name)
```

**Аргументы**

- `setting_Name` — Имя настройки. [`const String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает текущее значение настройки. [`Any`](/sql-reference/data-types)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT getSetting('enable_analyzer');
SET enable_analyzer = false;
SELECT getSetting('enable_analyzer');
```

```response title=Результат
┌─getSetting('⋯_analyzer')─┐
│ true                     │
└──────────────────────────┘
┌─getSetting('⋯_analyzer')─┐
│ false                    │
└──────────────────────────┘
```


## getSettingOrDefault {#getSettingOrDefault}

Введено в версии: v24.10

Возвращает текущее значение настройки или значение по умолчанию, указанное во втором аргументе, если настройка не задана в текущем профиле.

**Синтаксис**

```sql
getSettingOrDefault(setting_name, default_value)
```

**Аргументы**

- `setting_name` — имя настройки. [`String`](/sql-reference/data-types/string)
- `default_value` — значение, возвращаемое, если настройка не задана. Может иметь любой тип данных или быть равным Null.

**Возвращаемое значение**

Возвращает текущее значение указанной настройки или `default_value`, если настройка не задана.

**Примеры**

**Пример использования**

```sql title=Query
SELECT getSettingOrDefault('custom_undef1', 'my_value');
SELECT getSettingOrDefault('custom_undef2', 100);
SELECT getSettingOrDefault('custom_undef3', NULL);
```

```response title=Response
my_value
100
NULL
```


## getSizeOfEnumType {#getSizeOfEnumType}

Введена в версии: v1.1

Возвращает количество полей в заданном типе [`Enum`](../../sql-reference/data-types/enum.md).

**Синтаксис**

```sql
getSizeOfEnumType(x)
```

**Аргументы**

- `x` — значение типа `Enum`. [`Enum`](/sql-reference/data-types/enum)

**Возвращаемое значение**

Возвращает количество полей типа `Enum` для входного значения. [`UInt8/16`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT getSizeOfEnumType(CAST('a' AS Enum8('a' = 1, 'b' = 2))) AS x;
```

```response title=Результат
┌─x─┐
│ 2 │
└───┘
```


## getSubcolumn {#getSubcolumn}

Введена в версии: v

Принимает выражение или идентификатор и строковую константу с именем подстолбца.

Возвращает запрошенный подстолбец, извлечённый из выражения.

**Синтаксис**

```sql

```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

**Примеры**

**getSubcolumn**

```sql title=Запрос
SELECT getSubcolumn(array_col, 'size0'), getSubcolumn(tuple_col, 'elem_name')
```

```response title=Ответ

```


## getTypeSerializationStreams {#getTypeSerializationStreams}

Введена в версии: v22.6

Перечисляет пути потоков сериализации типа данных.
Эта функция предназначена для использования при разработке.

**Синтаксис**

```sql
getTypeSerializationStreams(col)
```

**Аргументы**

- `col` — Столбец или строковое представление типа данных, из которого будет определён тип данных. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает массив со всеми путями подпотоков сериализации. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**tuple**

```sql title=Запрос
SELECT getTypeSerializationStreams(tuple('a', 1, 'b', 2))
```

```response title=Ответ
['{TupleElement(1), Regular}','{TupleElement(2), Regular}','{TupleElement(3), Regular}','{TupleElement(4), Regular}']
```

**map**

```sql title=Запрос
SELECT getTypeSerializationStreams('Map(String, Int64)')
```

```response title=Ответ
['{ArraySizes}','{ArrayElements, TupleElement(keys), Regular}','{ArrayElements, TupleElement(values), Regular}']
```


## globalVariable {#globalVariable}

Введена в версии: v20.5

Принимает константную строку в качестве аргумента и возвращает значение глобальной переменной с указанным именем. Эта функция предназначена для совместимости с MySQL и не требуется для нормальной работы ClickHouse. Определено только несколько фиктивных глобальных переменных.

**Синтаксис**

```sql
globalVariable(name)
```

**Аргументы**

- `name` — имя глобальной переменной. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает значение переменной `name`. [`Any`](/sql-reference/data-types)

**Примеры**

**globalVariable**

```sql title=Запрос
SELECT globalVariable('max_allowed_packet')
```

```response title=Ответ
67108864
```


## hasColumnInTable {#hasColumnInTable}

Введена в версии: v1.1

Проверяет, существует ли указанный столбец в таблице базы данных.
Для элементов вложенной структуры данных функция проверяет наличие столбца.
Для самой вложенной структуры данных функция возвращает `0`.

**Синтаксис**

```sql
hasColumnInTable([hostname[, username[, password]],]database, table, column)
```

**Аргументы**

- `database` — имя базы данных. [`const String`](/sql-reference/data-types/string)
- `table` — имя таблицы. [`const String`](/sql-reference/data-types/string)
- `column` — имя столбца. [`const String`](/sql-reference/data-types/string)
- `hostname` — необязательный параметр. Имя удалённого сервера, на котором выполняется проверка. [`const String`](/sql-reference/data-types/string)
- `username` — необязательный параметр. Имя пользователя для удалённого сервера. [`const String`](/sql-reference/data-types/string)
- `password` — необязательный параметр. Пароль для удалённого сервера. [`const String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает `1`, если указанный столбец существует, иначе `0`. [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Проверка существующего столбца**

```sql title=Запрос
SELECT hasColumnInTable('system','metrics','metric')
```

```response title=Результат
1
```

**Проверка несуществующего столбца**

```sql title=Запрос
SELECT hasColumnInTable('system','metrics','non-existing_column')
```

```response title=Результат
0
```


## hasThreadFuzzer {#hasThreadFuzzer}

Введено в версии: v20.6

Возвращает, включен ли thread fuzzer.
Эта функция полезна только для тестирования и отладки.

**Синтаксис**

```sql
hasThreadFuzzer()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает, активен ли Thread Fuzzer. [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Проверка статуса Thread Fuzzer**

```sql title=Запрос
SELECT hasThreadFuzzer()
```

```response title=Результат
┌─hasThreadFuzzer()─┐
│                 0 │
└───────────────────┘
```


## hostName {#hostName}

Введена в версии: v20.5

Возвращает имя хоста, на котором выполняется эта функция.
Если функция выполняется на удалённом сервере (распределённая обработка), возвращается имя удалённого сервера.
Если функция выполняется в контексте распределённой таблицы, она генерирует обычный столбец со значениями, соответствующими каждому шарду.
В противном случае возвращается константное значение.

**Синтаксис**

```sql
hostName()
```

**Псевдонимы**: `hostname`

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Имя хоста. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT hostName()
```

```response title=Результат
┌─hostName()─┐
│ clickhouse │
└────────────┘
```


## icebergBucket {#icebergBucket}

Введена в версии: v25.5

Реализует логику [преобразования iceberg bucket](https://iceberg.apache.org/spec/#bucket-transform-details.)

**Синтаксис**

```sql
icebergBucket(N, value)
```

**Аргументы**

- `N` — Количество бакетов, по модулю. [`const (U)Int*`](/sql-reference/data-types/int-uint)
- `value` — Исходное значение для преобразования. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Bool`](/sql-reference/data-types/boolean) или [`Decimal`](/sql-reference/data-types/decimal) или [`Float*`](/sql-reference/data-types/float) или [`String`](/sql-reference/data-types/string) или [`FixedString`](/sql-reference/data-types/fixedstring) или [`UUID`](/sql-reference/data-types/uuid) или [`Date`](/sql-reference/data-types/date) или [`Time`](/sql-reference/data-types/time) или [`DateTime`](/sql-reference/data-types/datetime)

**Возвращаемое значение**

Возвращает 32-битный хеш исходного значения. [`Int32`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример**

```sql title=Запрос
SELECT icebergBucket(5, 1.0 :: Float32)
```

```response title=Результат
4
```


## icebergTruncate {#icebergTruncate}

Введена в версии: v25.3

Реализует логику преобразования truncate в Iceberg: https://iceberg.apache.org/spec/#truncate-transform-details.

**Синтаксис**

```sql
icebergTruncate(N, value)
```

**Аргументы**

- `value` — значение для преобразования. [`String`](/sql-reference/data-types/string), [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Decimal`](/sql-reference/data-types/decimal)

**Возвращаемое значение**

Тип данных совпадает с типом аргумента

**Примеры**

**Пример**

```sql title=Запрос
SELECT icebergTruncate(3, 'iceberg')
```

```response title=Результат
ice
```


## identity {#identity}

Добавлена в версии: v1.1

Эта функция возвращает переданный ей аргумент, что полезно для отладки и тестирования. Она позволяет обойти использование индексов, чтобы оценить производительность полного сканирования. Анализатор запросов игнорирует всё, что находится внутри функций identity, при поиске индексов, а также отключает свёртывание констант.

**Синтаксис**

```sql
identity(x)
```

**Аргументы**

- `x` — входное значение. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает входное значение без изменений. [`Any`](/sql-reference/data-types)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT identity(42)
```

```response title=Результат
42
```


## ignore {#ignore}

Введена в версии: v1.1

Принимает произвольные аргументы и всегда возвращает `0`.

**Синтаксис**

```sql
ignore(x)
```

**Аргументы**

- `x` — Входное значение, которое не используется и передается только во избежание синтаксической ошибки. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Всегда возвращает `0`. [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT ignore(0, 'ClickHouse', NULL)
```

```response title=Результат
┌─ignore(0, 'ClickHouse', NULL)─┐
│                             0 │
└───────────────────────────────┘
```


## indexHint {#indexHint}

Введена в версии: v1.1

Эта функция предназначена для отладки и анализа работы индексов.
Она игнорирует свой аргумент и всегда возвращает 1.
Аргументы не вычисляются.

Однако при анализе индекса предполагается, что аргумент этой функции не обёрнут в `indexHint`.
Это позволяет выбирать данные в диапазонах индекса по соответствующему условию без дополнительной фильтрации по этому условию.
Индекс в ClickHouse является разреженным, и использование `indexHint` вернёт больше данных, чем непосредственное указание того же условия.

**Синтаксис**

```sql
indexHint(expression)
```

**Аргументы**

- `expression` — любое выражение для выбора диапазона индекса. [`Expression`](/sql-reference/data-types/special-data-types/expression)

**Возвращаемое значение**

Возвращает `1` во всех случаях. [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования с фильтрацией по дате**

```sql title=Запрос
SELECT FlightDate AS k, count() FROM ontime WHERE indexHint(k = '2025-09-15') GROUP BY k ORDER BY k ASC;
```

```response title=Результат
┌──────────k─┬─count()─┐
│ 2025-09-14 │    7071 │
│ 2025-09-15 │   16428 │
│ 2025-09-16 │    1077 │
│ 2025-09-30 │    8167 │
└────────────┴─────────┘
```


## initialQueryID {#initialQueryID}

Введено в версии: v1.1

Возвращает идентификатор начального запроса.
Другие параметры запроса можно извлечь из поля `initial_query_id` в таблице [`system.query_log`](../../operations/system-tables/query_log.md).

В отличие от функции [`queryID`](/sql-reference/functions/other-functions#queryID), функция `initialQueryID` возвращает одинаковые результаты на разных шардах.

**Синтаксис**

```sql
initialQueryID()
```

**Псевдонимы**: `initial_query_id`

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает идентификатор начального запроса. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
CREATE TABLE tmp (str String) ENGINE = Log;
INSERT INTO tmp (*) VALUES ('a');
SELECT count(DISTINCT t) FROM (SELECT initialQueryID() AS t FROM remote('127.0.0.{1..3}', currentDatabase(), 'tmp') GROUP BY queryID());
```

```response title=Результат
┌─count(DISTINCT t)─┐
│                 1 │
└───────────────────┘
```


## initialQueryStartTime {#initialQueryStartTime}

Введено в версии: v25.4

Возвращает время начала первоначального текущего запроса.
`initialQueryStartTime` возвращает одинаковые результаты на разных шардах.

**Синтаксис**

```sql
initialQueryStartTime()
```

**Псевдонимы**: `initial_query_start_time`

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает время начала первоначального текущего запроса. [`DateTime`](/sql-reference/data-types/datetime)

**Примеры**

**Пример использования**

```sql title=Query
CREATE TABLE tmp (str String) ENGINE = Log;
INSERT INTO tmp (*) VALUES ('a');
SELECT count(DISTINCT t) FROM (SELECT initialQueryStartTime() AS t FROM remote('127.0.0.{1..3}', currentDatabase(), 'tmp') GROUP BY queryID());
```

```response title=Response
┌─count(DISTINCT t)─┐
│                 1 │
└───────────────────┘
```


## initializeAggregation {#initializeAggregation}

Введена в версии: v20.6

Вычисляет результат агрегатной функции на основе одного значения.
Эта функция может использоваться для инициализации агрегатных функций с комбинатором [-State](../../sql-reference/aggregate-functions/combinators.md#-state).
Вы можете создавать состояния агрегатных функций и вставлять их в столбцы типа [`AggregateFunction`](../../sql-reference/data-types/aggregatefunction.md) или использовать инициализированные агрегаты в качестве значений по умолчанию.

**Синтаксис**

```sql
initializeAggregation(aggregate_function, arg1[, arg2, ...])
```

**Аргументы**

- `aggregate_function` — имя агрегатной функции для инициализации. [`String`](/sql-reference/data-types/string)
- `arg1[, arg2, ...]` — аргументы агрегатной функции. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает результат агрегации для каждой строки, переданной в функцию. Тип возвращаемого значения совпадает с типом возвращаемого значения функции, которую `initializeAggregation` принимает в качестве первого аргумента. [`Any`](/sql-reference/data-types)

**Примеры**

**Базовое использование с uniqState**

```sql title=Запрос
SELECT uniqMerge(state) FROM (SELECT initializeAggregation('uniqState', number % 3) AS state FROM numbers(10000));
```

```response title=Результат
┌─uniqMerge(state)─┐
│                3 │
└──────────────────┘
```

**Использование с sumState и finalizeAggregation**

```sql title=Запрос
SELECT finalizeAggregation(state), toTypeName(state) FROM (SELECT initializeAggregation('sumState', number % 3) AS state FROM numbers(5));
```

```response title=Результат
┌─finalizeAggregation(state)─┬─toTypeName(state)─────────────┐
│                          0 │ AggregateFunction(sum, UInt8) │
│                          1 │ AggregateFunction(sum, UInt8) │
│                          2 │ AggregateFunction(sum, UInt8) │
│                          0 │ AggregateFunction(sum, UInt8) │
│                          1 │ AggregateFunction(sum, UInt8) │
└────────────────────────────┴───────────────────────────────┘
```


## isConstant {#isConstant}

Введена в версии: v20.3

Возвращает, является ли аргумент константным выражением.
Константное выражение — это выражение, результат которого известен на этапе анализа запроса, то есть до его выполнения.
Например, выражения над [литералами](/sql-reference/syntax#literals) являются константными выражениями.
Эта функция предназначена в основном для разработки, отладки и демонстрации.

**Синтаксис**

```sql
isConstant(x)
```

**Аргументы**

- `x` — выражение для проверки. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает `1`, если `x` является константой, `0`, если `x` не является константой. [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Константное выражение**

```sql title=Запрос
SELECT isConstant(x + 1)
FROM (SELECT 43 AS x)
```

```response title=Результат
┌─isConstant(plus(x, 1))─┐
│                      1 │
└────────────────────────┘
```

**Константа с функцией**

```sql title=Запрос
WITH 3.14 AS pi
SELECT isConstant(cos(pi))
```

```response title=Результат
┌─isConstant(cos(pi))─┐
│                   1 │
└─────────────────────┘
```

**Неконстантное выражение**

```sql title=Запрос
SELECT isConstant(number)
FROM numbers(1)
```

```response title=Результат
┌─isConstant(number)─┐
│                  0 │
└────────────────────┘
```

**Поведение функции now()**

```sql title=Запрос
SELECT isConstant(now())
```

```response title=Результат
┌─isConstant(now())─┐
│                 1 │
└───────────────────┘
```


## isDecimalOverflow {#isDecimalOverflow}

Введена в версии: v20.8

Проверяет, превышает ли количество цифр в десятичном числе допустимое значение для типа данных Decimal с заданной точностью.

**Синтаксис**

```sql
isDecimalOverflow(value[, precision])
```

**Аргументы**

- `value` — проверяемое десятичное значение. [`Decimal`](/sql-reference/data-types/decimal)
- `precision` — необязательный параметр. Точность типа Decimal. Если не указан, используется исходная точность первого аргумента. [`UInt8`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает `1`, если десятичное значение содержит больше цифр, чем допускается заданной точностью, `0`, если десятичное значение соответствует указанной точности. [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT isDecimalOverflow(toDecimal32(1000000000, 0), 9),
       isDecimalOverflow(toDecimal32(1000000000, 0)),
       isDecimalOverflow(toDecimal32(-1000000000, 0), 9),
       isDecimalOverflow(toDecimal32(-1000000000, 0));
```

```response title=Результат
┌─isDecimalOverflow(toDecimal32(1000000000, 0), 9)─┬─isDecimalOverflow(toDecimal32(1000000000, 0))─┬─isDecimalOverflow(toDecimal32(-1000000000, 0), 9)─┬─isDecimalOverflow(toDecimal32(-1000000000, 0))─┐
│                                                1 │                                             1 │                                                 1 │                                              1 │
└──────────────────────────────────────────────────┴───────────────────────────────────────────────┴───────────────────────────────────────────────────┴────────────────────────────────────────────────┘
```


## joinGet {#joinGet}

Введена в версии: v18.16

Позволяет извлекать данные из таблицы так же, как из словаря.
Получает данные из таблиц Join, используя указанный ключ соединения.

:::note
Поддерживаются только таблицы, созданные с помощью [оператора](/engines/table-engines/special/join) `ENGINE = Join(ANY, LEFT, <join_keys>)`.
:::

**Синтаксис**

```sql
joinGet(join_storage_table_name, value_column, join_keys)
```

**Аргументы**

- `join_storage_table_name` — идентификатор, указывающий, где выполнять поиск. Идентификатор ищется в базе данных по умолчанию (см. параметр `default_database` в конфигурационном файле). Чтобы переопределить базу данных по умолчанию, используйте запрос `USE database_name` или укажите базу данных и таблицу через точку, например `database_name.table_name`. [`String`](/sql-reference/data-types/string)
- `value_column` — имя столбца таблицы, содержащего требуемые данные. [`const String`](/sql-reference/data-types/string)
- `join_keys` — список ключей соединения. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает список значений, соответствующих списку ключей. [`Any`](/sql-reference/data-types)

**Примеры**

**Пример использования**

```sql title=Запрос
CREATE TABLE db_test.id_val(`id` UInt32, `val` UInt32) ENGINE = Join(ANY, LEFT, id);
INSERT INTO db_test.id_val VALUES (1,11)(2,12)(4,13);

SELECT joinGet(db_test.id_val, 'val', toUInt32(1));
```

```response title=Результат
┌─joinGet(db_test.id_val, 'val', toUInt32(1))─┐
│                                          11 │
└─────────────────────────────────────────────┘
```

**Использование с таблицей из текущей базы данных**

```sql title=Запрос
USE db_test;
SELECT joinGet(id_val, 'val', toUInt32(2));
```

```response title=Результат
┌─joinGet(id_val, 'val', toUInt32(2))─┐
│                                  12 │
└─────────────────────────────────────┘
```

**Использование массивов в качестве ключей соединения**

```sql title=Запрос
CREATE TABLE some_table (id1 UInt32, id2 UInt32, name String) ENGINE = Join(ANY, LEFT, id1, id2);
INSERT INTO some_table VALUES (1, 11, 'a') (2, 12, 'b') (3, 13, 'c');

SELECT joinGet(some_table, 'name', 1, 11);
```

```response title=Результат
┌─joinGet(some_table, 'name', 1, 11)─┐
│ a                                  │
└────────────────────────────────────┘
```


## joinGetOrNull {#joinGetOrNull}

Введена в версии: v20.4

Позволяет извлекать данные из таблицы так же, как из словаря.
Получает данные из таблиц Join, используя указанный ключ соединения.
В отличие от [`joinGet`](#joinGet), возвращает `NULL`, если ключ отсутствует.

:::note
Поддерживаются только таблицы, созданные с помощью [оператора](/engines/table-engines/special/join) `ENGINE = Join(ANY, LEFT, <join_keys>)`.
:::

**Синтаксис**

```sql
joinGetOrNull(join_storage_table_name, value_column, join_keys)
```

**Аргументы**

- `join_storage_table_name` — идентификатор, указывающий, где выполнять поиск. Идентификатор ищется в базе данных по умолчанию (см. параметр default_database в конфигурационном файле). Чтобы переопределить базу данных по умолчанию, используйте запрос `USE database_name` или укажите базу данных и таблицу через точку, например `database_name.table_name`. [`String`](/sql-reference/data-types/string)
- `value_column` — имя столбца таблицы, содержащего требуемые данные. [`const String`](/sql-reference/data-types/string)
- `join_keys` — список ключей соединения. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает список значений, соответствующих списку ключей, или `NULL`, если ключ не найден. [`Any`](/sql-reference/data-types)

**Примеры**

**Пример использования**

```sql title=Запрос
CREATE TABLE db_test.id_val(`id` UInt32, `val` UInt32) ENGINE = Join(ANY, LEFT, id);
INSERT INTO db_test.id_val VALUES (1,11)(2,12)(4,13);

SELECT joinGetOrNull(db_test.id_val, 'val', toUInt32(1)), joinGetOrNull(db_test.id_val, 'val', toUInt32(999));
```

```response title=Результат
┌─joinGetOrNull(db_test.id_val, 'val', toUInt32(1))─┬─joinGetOrNull(db_test.id_val, 'val', toUInt32(999))─┐
│                                                11 │                                                ᴺᵁᴸᴸ │
└───────────────────────────────────────────────────┴─────────────────────────────────────────────────────┘
```


## lowCardinalityIndices {#lowCardinalityIndices}

Введена в версии: v18.12

Возвращает позицию значения в словаре столбца [LowCardinality](../data-types/lowcardinality.md). Нумерация позиций начинается с 1. Поскольку LowCardinality использует отдельные словари для каждого куска данных, функция может возвращать разные позиции для одного и того же значения в разных кусках.

**Синтаксис**

```sql
lowCardinalityIndices(col)
```

**Аргументы**

- `col` — столбец с низкой кардинальностью. [`LowCardinality`](/sql-reference/data-types/lowcardinality)

**Возвращаемое значение**

Позиция значения в словаре текущего куска данных. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Примеры использования**

```sql title=Query
DROP TABLE IF EXISTS test;
CREATE TABLE test (s LowCardinality(String)) ENGINE = Memory;

-- создаём два куска данных:

INSERT INTO test VALUES ('ab'), ('cd'), ('ab'), ('ab'), ('df');
INSERT INTO test VALUES ('ef'), ('cd'), ('ab'), ('cd'), ('ef');

SELECT s, lowCardinalityIndices(s) FROM test;
```

```response title=Response
┌─s──┬─lowCardinalityIndices(s)─┐
│ ab │                        1 │
│ cd │                        2 │
│ ab │                        1 │
│ ab │                        1 │
│ df │                        3 │
└────┴──────────────────────────┘
┌─s──┬─lowCardinalityIndices(s)─┐
│ ef │                        1 │
│ cd │                        2 │
│ ab │                        3 │
│ cd │                        2 │
│ ef │                        1 │
└────┴──────────────────────────┘
```


## lowCardinalityKeys {#lowCardinalityKeys}

Введена в версии: v18.12

Возвращает значения словаря из столбца [LowCardinality](../data-types/lowcardinality.md).
Если блок меньше или больше размера словаря, результат будет усечён или дополнен значениями по умолчанию.
Поскольку LowCardinality использует отдельные словари для каждой части данных, эта функция может возвращать различные значения словаря в разных частях.

**Синтаксис**

```sql
lowCardinalityKeys(col)
```

**Аргументы**

- `col` — столбец с низкой кардинальностью. [`LowCardinality`](/sql-reference/data-types/lowcardinality)

**Возвращаемое значение**

Возвращает ключи словаря. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**lowCardinalityKeys**

```sql title=Query
DROP TABLE IF EXISTS test;
CREATE TABLE test (s LowCardinality(String)) ENGINE = Memory;

-- создаём две части:

INSERT INTO test VALUES ('ab'), ('cd'), ('ab'), ('ab'), ('df');
INSERT INTO test VALUES ('ef'), ('cd'), ('ab'), ('cd'), ('ef');

SELECT s, lowCardinalityKeys(s) FROM test;
```

```response title=Response
┌─s──┬─lowCardinalityKeys(s)─┐
│ ef │                       │
│ cd │ ef                    │
│ ab │ cd                    │
│ cd │ ab                    │
│ ef │                       │
└────┴───────────────────────┘
┌─s──┬─lowCardinalityKeys(s)─┐
│ ab │                       │
│ cd │ ab                    │
│ ab │ cd                    │
│ ab │ df                    │
│ df │                       │
└────┴───────────────────────┘
```


## materialize {#materialize}

Введена в версии: v1.1

Преобразует константу в полноценный столбец, содержащий одно значение.
Полноценные столбцы и константы представлены в памяти по-разному.
Функции обычно выполняют различный код для обычных и константных аргументов, хотя результат, как правило, должен быть одинаковым.
Эта функция может использоваться для отладки такого поведения.

**Синтаксис**

```sql
materialize(x)
```

**Аргументы**

- `x` — Константа. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает полноценный столбец, содержащий константное значение. [`Any`](/sql-reference/data-types)

**Примеры**

**Пример использования**

```sql title=Query
-- В примере ниже функция `countMatches` ожидает константный второй аргумент.
-- Это поведение можно отладить, используя функцию `materialize` для преобразования константы в полноценный столбец,
-- проверив, что функция выдаёт ошибку для неконстантного аргумента.

SELECT countMatches('foobarfoo', 'foo');
SELECT countMatches('foobarfoo', materialize('foo'));
```

```response title=Response
2
Code: 44. DB::Exception: Received from localhost:9000. DB::Exception: Illegal type of argument #2 'pattern' of function countMatches, expected constant String, got String
```


## minSampleSizeContinuous {#minSampleSizeContinuous}

Введена в версии: v23.10

Вычисляет минимально необходимый размер выборки для A/B-теста, сравнивающего средние значения непрерывной метрики в двух выборках.

Использует формулу, описанную в [этой статье](https://towardsdatascience.com/required-sample-size-for-a-b-testing-6f6608dd330a).
Предполагает равные размеры тестовой и контрольной групп.
Возвращает требуемый размер выборки для одной группы (т. е. размер выборки, необходимый для всего эксперимента, в два раза больше возвращаемого значения).
Также предполагает равную дисперсию тестовой метрики в тестовой и контрольной группах.

**Синтаксис**

```sql
minSampleSizeContinuous(baseline, sigma, mde, power, alpha)
```

**Псевдонимы**: `minSampleSizeContinous`

**Аргументы**

- `baseline` — базовое значение метрики. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)
- `sigma` — базовое стандартное отклонение метрики. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)
- `mde` — минимальный обнаруживаемый эффект (MDE) в процентах от базового значения (например, для базового значения 112.25 значение MDE 0.03 означает ожидаемое изменение до 112.25 ± 112.25×0.03). [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float\*`](/sql-reference/data-types/float)
- `power` — требуемая статистическая мощность теста (1 − вероятность ошибки второго рода). [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)
- `alpha` — требуемый уровень значимости теста (вероятность ошибки первого рода). [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает именованный кортеж с 3 элементами: `minimum_sample_size`, `detect_range_lower` и `detect_range_upper`. Это соответственно: требуемый размер выборки, нижняя граница диапазона значений, не обнаруживаемых при возвращаемом требуемом размере выборки, вычисляемая как `baseline * (1 - mde)`, и верхняя граница диапазона значений, не обнаруживаемых при возвращаемом требуемом размере выборки, вычисляемая как `baseline * (1 + mde)` (Float64). [`Tuple(Float64, Float64, Float64)`](/sql-reference/data-types/tuple)

**Примеры**

**minSampleSizeContinuous**

```sql title=Запрос
SELECT minSampleSizeContinuous(112.25, 21.1, 0.03, 0.80, 0.05) AS sample_size
```

```response title=Результат
(616.2931945826209,108.8825,115.6175)
```


## minSampleSizeConversion {#minSampleSizeConversion}

Введена в версии: v22.6

Вычисляет минимально необходимый размер выборки для A/B-теста при сравнении конверсий (долей) в двух выборках.

Использует формулу, описанную в [этой статье](https://towardsdatascience.com/required-sample-size-for-a-b-testing-6f6608dd330a). Предполагается равный размер тестовой и контрольной групп. Возвращает размер выборки, необходимый для одной группы (т. е. размер выборки для всего эксперимента в два раза больше возвращаемого значения).

**Синтаксис**

```sql
minSampleSizeConversion(baseline, mde, power, alpha)
```

**Аргументы**

- `baseline` — Базовая конверсия. [`Float*`](/sql-reference/data-types/float)
- `mde` — Минимальный детектируемый эффект (MDE) в процентных пунктах (например, для базовой конверсии 0.25 значение MDE 0.03 означает ожидаемое изменение до 0.25 ± 0.03). [`Float*`](/sql-reference/data-types/float)
- `power` — Требуемая статистическая мощность теста (1 − вероятность ошибки второго рода). [`Float*`](/sql-reference/data-types/float)
- `alpha` — Требуемый уровень значимости теста (вероятность ошибки первого рода). [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает именованный кортеж из 3 элементов: `minimum_sample_size`, `detect_range_lower`, `detect_range_upper`. Это соответственно: требуемый размер выборки, нижняя граница диапазона значений, не детектируемых при возвращаемом требуемом размере выборки, вычисляемая как `baseline - mde`, и верхняя граница диапазона значений, не детектируемых при возвращаемом требуемом размере выборки, вычисляемая как `baseline + mde`. [`Tuple(Float64, Float64, Float64)`](/sql-reference/data-types/tuple)

**Примеры**

**minSampleSizeConversion**

```sql title=Запрос
SELECT minSampleSizeConversion(0.25, 0.03, 0.80, 0.05) AS sample_size
```

```response title=Результат
(3396.077603219163,0.22,0.28)
```


## neighbor {#neighbor}

Введена в версии: v20.1

Возвращает значение из столбца с указанным смещением относительно текущей строки.
Эта функция устарела и подвержена ошибкам, поскольку она работает с физическим порядком блоков данных, который может не соответствовать логическому порядку, ожидаемому пользователями.
Рекомендуется использовать вместо неё оконные функции.

Функцию можно включить, установив параметр `allow_deprecated_error_prone_window_functions = 1`.

**Синтаксис**

```sql
neighbor(column, offset[, default_value])
```

**Аргументы**

- `column` — исходный столбец. [`Any`](/sql-reference/data-types)
- `offset` — смещение относительно текущей строки. Положительные значения указывают на строки вперёд, отрицательные — назад. [`Integer`](/sql-reference/data-types/int-uint)
- `default_value` — необязательный параметр. Значение, которое возвращается, если смещение выходит за границы данных. Если не указано, используется значение по умолчанию для типа столбца. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает значение с указанным смещением или значение по умолчанию, если смещение выходит за границы. [`Any`](/sql-reference/data-types)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT number, neighbor(number, 2) FROM system.numbers LIMIT 10;
```

```response title=Результат
┌─number─┬─neighbor(number, 2)─┐
│      0 │                   2 │
│      1 │                   3 │
│      2 │                   4 │
│      3 │                   5 │
│      4 │                   6 │
│      5 │                   7 │
│      6 │                   8 │
│      7 │                   9 │
│      8 │                   0 │
│      9 │                   0 │
└────────┴─────────────────────┘
```

**Со значением по умолчанию**

```sql title=Запрос
SELECT number, neighbor(number, 2, 999) FROM system.numbers LIMIT 10;
```

```response title=Результат
┌─number─┬─neighbor(number, 2, 999)─┐
│      0 │                        2 │
│      1 │                        3 │
│      2 │                        4 │
│      3 │                        5 │
│      4 │                        6 │
│      5 │                        7 │
│      6 │                        8 │
│      7 │                        9 │
│      8 │                      999 │
│      9 │                      999 │
└────────┴──────────────────────────┘
```


## nested {#nested}

Introduced in: v

Это внутренняя функция движка ClickHouse, не предназначенная для непосредственного использования.

Возвращает массив кортежей из нескольких массивов.

Первый аргумент должен быть константным массивом строк, определяющим имена полей результирующего кортежа.
Остальные аргументы должны быть массивами одинакового размера.

**Синтаксис**

```sql

```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

**Примеры**

**nested**

```sql title=Query
SELECT nested(['keys', 'values'], ['key_1', 'key_2'], ['value_1','value_2'])
```

```response title=Response

```


## normalizeQuery {#normalizeQuery}

Введена в версии: v20.8

Заменяет литералы, последовательности литералов и сложные псевдонимы (содержащие пробелы, более двух цифр или имеющие длину не менее 36 байт, например UUID) на заполнитель `?`.

**Синтаксис**

```sql
normalizeQuery(x)
```

**Аргументы**

- `x` — последовательность символов. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает переданную последовательность символов с заполнителями. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT normalizeQuery('[1, 2, 3, x]') AS query
```

```response title=Результат
┌─query────┐
│ [?.., x] │
└──────────┘
```


## normalizeQueryKeepNames {#normalizeQueryKeepNames}

Добавлено в версии: v21.2

Заменяет литералы и последовательности литералов на заполнитель `?`, но не заменяет сложные псевдонимы (содержащие пробелы, более двух цифр или имеющие длину не менее 36 байт, например UUID).
Это помогает лучше анализировать сложные журналы запросов.

**Синтаксис**

```sql
normalizeQueryKeepNames(x)
```

**Аргументы**

- `x` — последовательность символов. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает заданную последовательность символов с заполнителями. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT normalizeQuery('SELECT 1 AS aComplexName123'), normalizeQueryKeepNames('SELECT 1 AS aComplexName123')
```

```response title=Response
┌─normalizeQuery('SELECT 1 AS aComplexName123')─┬─normalizeQueryKeepNames('SELECT 1 AS aComplexName123')─┐
│ SELECT ? AS `?`                               │ SELECT ? AS aComplexName123                            │
└───────────────────────────────────────────────┴────────────────────────────────────────────────────────┘
```


## normalizedQueryHash {#normalizedQueryHash}

Введена в версии: v20.8

Возвращает идентичные 64-битные хеш-значения без учёта значений литералов для похожих запросов.
Может быть полезна при анализе журналов запросов.

**Синтаксис**

```sql
normalizedQueryHash(x)
```

**Аргументы**

- `x` — Последовательность символов. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает 64-битное хеш-значение. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT normalizedQueryHash('SELECT 1 AS `xyz`') != normalizedQueryHash('SELECT 1 AS `abc`') AS res
```

```response title=Результат
┌─res─┐
│   1 │
└─────┘
```


## normalizedQueryHashKeepNames {#normalizedQueryHashKeepNames}

Введена в версии: v21.2

Аналогично [`normalizedQueryHash`](#normalizedQueryHash) возвращает идентичные 64-битные хеш-значения без значений литералов для похожих запросов, но не заменяет сложные псевдонимы (содержащие пробелы, более двух цифр или имеющие длину не менее 36 байт, например UUID) на заполнитель перед хешированием.
Может быть полезна при анализе журналов запросов.

**Синтаксис**

```sql
normalizedQueryHashKeepNames(x)
```

**Аргументы**

- `x` — последовательность символов. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает 64-битное хеш-значение. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT normalizedQueryHash('SELECT 1 AS `xyz123`') != normalizedQueryHash('SELECT 1 AS `abc123`') AS normalizedQueryHash;
SELECT normalizedQueryHashKeepNames('SELECT 1 AS `xyz123`') != normalizedQueryHashKeepNames('SELECT 1 AS `abc123`') AS normalizedQueryHashKeepNames;
```

```response title=Результат
┌─normalizedQueryHash─┐
│                   0 │
└─────────────────────┘
┌─normalizedQueryHashKeepNames─┐
│                            1 │
└──────────────────────────────┘
```


## parseReadableSize {#parseReadableSize}

Введена в версии: v24.6

Функция принимает строку, содержащую размер в байтах с единицами измерения `B`, `KiB`, `KB`, `MiB`, `MB` и т.д. (т.е. единицы измерения [ISO/IEC 80000-13](https://en.wikipedia.org/wiki/ISO/IEC_80000) или десятичные единицы измерения байтов), и возвращает соответствующее количество байтов.
Если функция не может разобрать входное значение, она генерирует исключение.

Обратными операциями к этой функции являются [`formatReadableSize`](#formatReadableSize) и [`formatReadableDecimalSize`](#formatReadableDecimalSize).

**Синтаксис**

```sql
parseReadableSize(x)
```

**Аргументы**

- `x` — Размер в удобочитаемом формате с единицами измерения ISO/IEC 80000-13 или десятичными единицами измерения байтов. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает количество байтов, округленное вверх до ближайшего целого числа. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
SELECT arrayJoin(['1 B', '1 KiB', '3 MB', '5.314 KiB']) AS readable_sizes, parseReadableSize(readable_sizes) AS sizes;
```

```response title=Response
┌─readable_sizes─┬───sizes─┐
│ 1 B            │       1 │
│ 1 KiB          │    1024 │
│ 3 MB           │ 3000000 │
│ 5.314 KiB      │    5442 │
└────────────────┴─────────┘
```


## parseReadableSizeOrNull {#parseReadableSizeOrNull}

Введена в версии: v24.6

Принимает строку, содержащую размер в байтах и единицу измерения `B`, `KiB`, `KB`, `MiB`, `MB` и т.д. (т.е. [ISO/IEC 80000-13](https://en.wikipedia.org/wiki/ISO/IEC_80000) или десятичную единицу измерения байтов), и возвращает соответствующее количество байтов.
Если функция не может разобрать входное значение, возвращается `NULL`.

Обратными операциями к этой функции являются [`formatReadableSize`](#formatReadableSize) и [`formatReadableDecimalSize`](#formatReadableDecimalSize).

**Синтаксис**

```sql
parseReadableSizeOrNull(x)
```

**Аргументы**

- `x` — Размер в удобочитаемом формате с единицей измерения ISO/IEC 80000-13 или десятичной единицей измерения байтов. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает количество байтов, округленное вверх до ближайшего целого числа, или `NULL`, если не удается разобрать входные данные. [`Nullable(UInt64)`](/sql-reference/data-types/nullable)

**Примеры**

**Пример использования**

```sql title=Query
SELECT arrayJoin(['1 B', '1 KiB', '3 MB', '5.314 KiB', 'invalid']) AS readable_sizes, parseReadableSizeOrNull(readable_sizes) AS sizes;
```

```response title=Response
┌─readable_sizes─┬───sizes─┐
│ 1 B            │       1 │
│ 1 KiB          │    1024 │
│ 3 MB           │ 3000000 │
│ 5.314 KiB      │    5442 │
│ invalid        │    ᴺᵁᴸᴸ │
└────────────────┴─────────┘
```


## parseReadableSizeOrZero {#parseReadableSizeOrZero}

Введена в версии: v24.6

Принимает строку, содержащую размер в байтах и единицу измерения `B`, `KiB`, `KB`, `MiB`, `MB` и т.д. (т.е. единицы измерения [ISO/IEC 80000-13](https://en.wikipedia.org/wiki/ISO/IEC_80000) или десятичные единицы измерения байтов), и возвращает соответствующее количество байтов.
Если функция не может разобрать входное значение, она возвращает `0`.

Обратными операциями к этой функции являются [`formatReadableSize`](#formatReadableSize) и [`formatReadableDecimalSize`](#formatReadableDecimalSize).

**Синтаксис**

```sql
parseReadableSizeOrZero(x)
```

**Аргументы**

- `x` — Размер в удобочитаемом формате с единицей измерения ISO/IEC 80000-13 или десятичной единицей измерения байтов. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает количество байтов, округленное вверх до ближайшего целого числа, или `0`, если не удается разобрать входные данные. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT arrayJoin(['1 B', '1 KiB', '3 MB', '5.314 KiB', 'invalid']) AS readable_sizes, parseReadableSizeOrZero(readable_sizes) AS sizes;
```

```response title=Результат
┌─readable_sizes─┬───sizes─┐
│ 1 B            │       1 │
│ 1 KiB          │    1024 │
│ 3 MB           │ 3000000 │
│ 5.314 KiB      │    5442 │
│ invalid        │       0 │
└────────────────┴─────────┘
```


## parseTimeDelta {#parseTimeDelta}

Введено в версии: v22.7

Разбирает последовательность чисел, за которыми следует обозначение единицы времени.

Строка временного интервала использует следующие обозначения единиц времени:

- `years`, `year`, `yr`, `y`
- `months`, `month`, `mo`
- `weeks`, `week`, `w`
- `days`, `day`, `d`
- `hours`, `hour`, `hr`, `h`
- `minutes`, `minute`, `min`, `m`
- `seconds`, `second`, `sec`, `s`
- `milliseconds`, `millisecond`, `millisec`, `ms`
- `microseconds`, `microsecond`, `microsec`, `μs`, `µs`, `us`
- `nanoseconds`, `nanosecond`, `nanosec`, `ns`

Несколько единиц времени можно комбинировать с использованием разделителей (пробел, `;`, `-`, `+`, `,`, `:`).

Длительность лет и месяцев является приблизительной: год равен 365 дням, месяц — 30,5 дням.

**Синтаксис**

```sql
parseTimeDelta(timestr)
```

**Аргументы**

- `timestr` — Последовательность чисел, за которыми следует обозначение единицы времени. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Количество секунд. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT parseTimeDelta('11s+22min')
```

```response title=Результат
┌─parseTimeDelta('11s+22min')─┐
│                        1331 │
└─────────────────────────────┘
```

**Комбинированные единицы времени**

```sql title=Запрос
SELECT parseTimeDelta('1yr2mo')
```

```response title=Результат
┌─parseTimeDelta('1yr2mo')─┐
│                 36806400 │
└──────────────────────────┘
```


## partitionId {#partitionId}

Введена в версии: v21.4

Вычисляет [идентификатор партиции](../../engines/table-engines/mergetree-family/custom-partitioning-key.md).

:::note
Эта функция работает медленно и не должна вызываться для большого числа строк.
:::

**Синтаксис**

```sql
partitionId(column1[, column2, ...])
```

**Псевдонимы**: `partitionID`

**Аргументы**

- `column1, column2, ...` — Столбцы, для которых необходимо вернуть идентификатор партиции.

**Возвращаемое значение**

Возвращает идентификатор партиции, к которой принадлежит строка. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
DROP TABLE IF EXISTS tab;

CREATE TABLE tab
(
  i int,
  j int
)
ENGINE = MergeTree
PARTITION BY i
ORDER BY tuple();

INSERT INTO tab VALUES (1, 1), (1, 2), (1, 3), (2, 4), (2, 5), (2, 6);

SELECT i, j, partitionId(i), _partition_id FROM tab ORDER BY i, j;
```

```response title=Результат
┌─i─┬─j─┬─partitionId(i)─┬─_partition_id─┐
│ 1 │ 1 │ 1              │ 1             │
│ 1 │ 2 │ 1              │ 1             │
│ 1 │ 3 │ 1              │ 1             │
│ 2 │ 4 │ 2              │ 2             │
│ 2 │ 5 │ 2              │ 2             │
│ 2 │ 6 │ 2              │ 2             │
└───┴───┴────────────────┴───────────────┘
```


## queryID {#queryID}

Introduced in: v21.9

Возвращает идентификатор текущего запроса.
Другие параметры запроса можно извлечь из поля `query_id` в таблице [`system.query_log`](../../operations/system-tables/query_log.md).

В отличие от функции [`initialQueryID`](#initialQueryID), функция `queryID` может возвращать различные результаты на разных шардах.

**Синтаксис**

```sql
queryID()
```

**Псевдонимы**: `query_id`

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает идентификатор текущего запроса. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
CREATE TABLE tmp (str String) ENGINE = Log;
INSERT INTO tmp (*) VALUES ('a');
SELECT count(DISTINCT t) FROM (SELECT queryID() AS t FROM remote('127.0.0.{1..3}', currentDatabase(), 'tmp') GROUP BY queryID());
```

```response title=Response
┌─count(DISTINCT t)─┐
│                 3 │
└───────────────────┘
```


## revision {#revision}

Введена в версии: v22.7

Возвращает текущую ревизию сервера ClickHouse.

**Синтаксис**

```sql
revision()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает текущую ревизию сервера ClickHouse. [`UInt32`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT revision()
```

```response title=Результат
┌─revision()─┐
│      54485 │
└────────────┘
```


## rowNumberInAllBlocks {#rowNumberInAllBlocks}

Введена в версии: v1.1

Возвращает уникальный номер строки для каждой обработанной строки.

**Синтаксис**

```sql
rowNumberInAllBlocks()
```

**Аргументы**

- Нет.

**Возвращаемое значение**

Возвращает порядковый номер строки в блоке данных, начиная с `0`. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT rowNumberInAllBlocks()
FROM
(
    SELECT *
    FROM system.numbers_mt
    LIMIT 10
)
SETTINGS max_block_size = 2
```

```response title=Ответ
┌─rowNumberInAllBlocks()─┐
│                      0 │
│                      1 │
└────────────────────────┘
┌─rowNumberInAllBlocks()─┐
│                      4 │
│                      5 │
└────────────────────────┘
┌─rowNumberInAllBlocks()─┐
│                      2 │
│                      3 │
└────────────────────────┘
┌─rowNumberInAllBlocks()─┐
│                      6 │
│                      7 │
└────────────────────────┘
┌─rowNumberInAllBlocks()─┐
│                      8 │
│                      9 │
└────────────────────────┘
```


## rowNumberInBlock {#rowNumberInBlock}

Введена в версии: v1.1

Для каждого [блока](../../development/architecture.md#block), обрабатываемого `rowNumberInBlock`, возвращает номер текущей строки.

Нумерация начинается с 0 для каждого блока.

**Синтаксис**

```sql
rowNumberInBlock()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Порядковый номер строки в блоке данных, начиная с `0`. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
SELECT rowNumberInBlock()
FROM
(
    SELECT *
    FROM system.numbers_mt
    LIMIT 10
) SETTINGS max_block_size = 2
```

```response title=Response
┌─rowNumberInBlock()─┐
│                  0 │
│                  1 │
└────────────────────┘
┌─rowNumberInBlock()─┐
│                  0 │
│                  1 │
└────────────────────┘
┌─rowNumberInBlock()─┐
│                  0 │
│                  1 │
└────────────────────┘
┌─rowNumberInBlock()─┐
│                  0 │
│                  1 │
└────────────────────┘
┌─rowNumberInBlock()─┐
│                  0 │
│                  1 │
└────────────────────┘
```


## runningAccumulate {#runningAccumulate}

Введена в версии: v1.1

Накапливает состояния агрегатной функции для каждой строки блока данных.

:::warning Устарела
Состояние сбрасывается для каждого нового блока данных.
Из-за такого поведения, подверженного ошибкам, функция была объявлена устаревшей, и рекомендуется использовать вместо неё [оконные функции](/sql-reference/window-functions).
Вы можете использовать настройку [`allow_deprecated_error_prone_window_functions`](/operations/settings/settings#allow_deprecated_error_prone_window_functions), чтобы разрешить использование этой функции.
:::

**Синтаксис**

```sql
runningAccumulate(agg_state[, grouping])
```

**Аргументы**

- `agg_state` — Состояние агрегатной функции. [`AggregateFunction`](/sql-reference/data-types/aggregatefunction)
- `grouping` — Необязательный параметр. Ключ группировки. Состояние функции сбрасывается при изменении значения `grouping`. Может быть любым из поддерживаемых типов данных, для которых определён оператор равенства. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает накопленный результат для каждой строки. [`Any`](/sql-reference/data-types)

**Примеры**

**Пример использования с initializeAggregation**

```sql title=Запрос
WITH initializeAggregation('sumState', number) AS one_row_sum_state
SELECT
    number,
    finalizeAggregation(one_row_sum_state) AS one_row_sum,
    runningAccumulate(one_row_sum_state) AS cumulative_sum
FROM numbers(5);
```

```response title=Результат
┌─number─┬─one_row_sum─┬─cumulative_sum─┐
│      0 │           0 │              0 │
│      1 │           1 │              1 │
│      2 │           2 │              3 │
│      3 │           3 │              6 │
│      4 │           4 │             10 │
└────────┴─────────────┴────────────────┘
```


## runningConcurrency {#runningConcurrency}

Введена в версии: v21.3

Вычисляет количество одновременно выполняющихся событий.
Каждое событие имеет время начала и время окончания.
Время начала включается в событие, а время окончания исключается.
Столбцы с временем начала и временем окончания должны иметь одинаковый тип данных.
Функция вычисляет общее количество активных (одновременно выполняющихся) событий для каждого момента начала события.

:::tip Требования
События должны быть упорядочены по времени начала в порядке возрастания.
Если это требование нарушено, функция генерирует исключение.
Каждый блок данных обрабатывается отдельно.
Если события из разных блоков данных перекрываются, они не могут быть обработаны корректно.
:::

:::warning Устарела
Рекомендуется использовать [оконные функции](/sql-reference/window-functions).
:::

**Синтаксис**

```sql
runningConcurrency(start, end)
```

**Аргументы**

- `start` — Столбец с временем начала событий. [`Date`](/sql-reference/data-types/date), [`DateTime`](/sql-reference/data-types/datetime) или [`DateTime64`](/sql-reference/data-types/datetime64)
- `end` — Столбец с временем окончания событий. [`Date`](/sql-reference/data-types/date), [`DateTime`](/sql-reference/data-types/datetime) или [`DateTime64`](/sql-reference/data-types/datetime64)

**Возвращаемое значение**

Возвращает количество одновременно выполняющихся событий для каждого момента начала события. [`UInt32`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT start, runningConcurrency(start, end) FROM example_table;
```

```response title=Результат
┌──────start─┬─runningConcurrency(start, end)─┐
│ 2025-03-03 │                              1 │
│ 2025-03-06 │                              2 │
│ 2025-03-07 │                              3 │
│ 2025-03-11 │                              2 │
└────────────┴────────────────────────────────┘
```


## runningDifference {#runningDifference}

Введена в версии: v1.1

Вычисляет разность между значениями двух последовательных строк в блоке данных.
Возвращает `0` для первой строки и разность с предыдущей строкой для последующих строк.

:::warning Устаревшая функция
Возвращает разности только внутри текущего обрабатываемого блока данных.
Из-за такого поведения, подверженного ошибкам, функция признана устаревшей.
Рекомендуется использовать вместо неё [оконные функции](/sql-reference/window-functions).

Для разрешения использования этой функции можно применить настройку [`allow_deprecated_error_prone_window_functions`](/operations/settings/settings#allow_deprecated_error_prone_window_functions).
:::

Результат функции зависит от обрабатываемых блоков данных и порядка данных в блоке.
Порядок строк при вычислении `runningDifference()` может отличаться от порядка строк, возвращаемых пользователю.
Чтобы этого избежать, можно создать подзапрос с [`ORDER BY`](../../sql-reference/statements/select/order-by.md) и вызвать функцию за пределами подзапроса.
Обратите внимание, что размер блока влияет на результат.
Внутреннее состояние `runningDifference` сбрасывается для каждого нового блока.

**Синтаксис**

```sql
runningDifference(x)
```

**Аргументы**

- `x` — столбец, для которого вычисляется разность. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает разность между последовательными значениями, для первой строки возвращается 0.

**Примеры**

**Пример использования**

```sql title=Query
SELECT
    EventID,
    EventTime,
    runningDifference(EventTime) AS delta
FROM
(
    SELECT
        EventID,
        EventTime
    FROM events
    WHERE EventDate = '2025-11-24'
    ORDER BY EventTime ASC
    LIMIT 5
);
```

```response title=Response
┌─EventID─┬───────────EventTime─┬─delta─┐
│    1106 │ 2025-11-24 00:00:04 │     0 │
│    1107 │ 2025-11-24 00:00:05 │     1 │
│    1108 │ 2025-11-24 00:00:05 │     0 │
│    1109 │ 2025-11-24 00:00:09 │     4 │
│    1110 │ 2025-11-24 00:00:10 │     1 │
└─────────┴─────────────────────┴───────┘
```

**Пример влияния размера блока**

```sql title=Query
SELECT
    number,
    runningDifference(number + 1) AS diff
FROM numbers(100000)
WHERE diff != 1;
```

```response title=Response
┌─number─┬─diff─┐
│      0 │    0 │
└────────┴──────┘
┌─number─┬─diff─┐
│  65536 │    0 │
└────────┴──────┘
```


## runningDifferenceStartingWithFirstValue {#runningDifferenceStartingWithFirstValue}

Введена в версии: v1.1

Вычисляет разность между последовательными значениями строк в блоке данных, но в отличие от [`runningDifference`](#runningDifference) возвращает фактическое значение первой строки вместо `0`.

:::warning Устарела
Возвращает разности только внутри текущего обрабатываемого блока данных.
Из-за такого подверженного ошибкам поведения функция устарела.
Рекомендуется использовать вместо неё [оконные функции](/sql-reference/window-functions).

Для разрешения использования этой функции можно использовать настройку `allow_deprecated_error_prone_window_functions`.
:::

**Синтаксис**

```sql
runningDifferenceStartingWithFirstValue(x)
```

**Аргументы**

- `x` — столбец, для которого вычисляется текущая разность. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает разность между последовательными значениями, при этом для первой строки возвращается её собственное значение. [`Any`](/sql-reference/data-types)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT
    number,
    runningDifferenceStartingWithFirstValue(number) AS diff
FROM numbers(5);
```

```response title=Результат
┌─number─┬─diff─┐
│      0 │    0 │
│      1 │    1 │
│      2 │    1 │
│      3 │    1 │
│      4 │    1 │
└────────┴──────┘
```


## serverUUID {#serverUUID}

Введена в версии: v20.1

Возвращает случайный уникальный UUID (v4), сгенерированный при первом запуске сервера.
UUID сохраняется, т.е. при втором, третьем и последующих запусках сервера возвращается тот же UUID.

**Синтаксис**

```sql
serverUUID()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает случайный UUID сервера. [`UUID`](/sql-reference/data-types/uuid)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT serverUUID();
```

```response title=Результат
┌─serverUUID()─────────────────────────────┐
│ 7ccc9260-000d-4d5c-a843-5459abaabb5f     │
└──────────────────────────────────────────┘
```


## shardCount {#shardCount}

Введена в версии: v21.9

Возвращает общее количество шардов для распределённого запроса.
Если запрос не является распределённым, возвращается константа `0`.

**Синтаксис**

```sql
shardCount()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Общее количество шардов или `0`. [`UInt32`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
-- См. пример shardNum() выше, который также демонстрирует использование shardCount()
CREATE TABLE shard_count_example (dummy UInt8)
ENGINE=Distributed(test_cluster_two_shards_localhost, system, one, dummy);
SELECT shardCount() FROM shard_count_example;
```

```response title=Response
┌─shardCount()─┐
│            2 │
│            2 │
└──────────────┘
```


## shardNum {#shardNum}

Введена в версии: v21.9

Возвращает индекс шарда, обрабатывающего часть данных в распределённом запросе.
Индексация начинается с `1`.
Если запрос не является распределённым, возвращается константа `0`.

**Синтаксис**

```sql
shardNum()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает индекс шарда или константу `0`. [`UInt32`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
CREATE TABLE shard_num_example (dummy UInt8)
ENGINE=Distributed(test_cluster_two_shards_localhost, system, one, dummy);
SELECT dummy, shardNum(), shardCount() FROM shard_num_example;
```

```response title=Response
┌─dummy─┬─shardNum()─┬─shardCount()─┐
│     0 │          1 │            2 │
│     0 │          2 │            2 │
└───────┴────────────┴──────────────┘
```


## showCertificate {#showCertificate}

Введена в версии: v22.6

Отображает информацию о SSL-сертификате (Secure Sockets Layer) текущего сервера, если он настроен.
Подробнее о настройке ClickHouse для использования сертификатов OpenSSL при проверке подключений см. в разделе [Настройка SSL-TLS](/guides/sre/configuring-ssl).

**Синтаксис**

```sql
showCertificate()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает словарь пар ключ-значение, относящихся к настроенному SSL-сертификату. [`Map(String, String)`](/sql-reference/data-types/map)

**Примеры**

**Пример использования**

```sql title=Query
SELECT showCertificate() FORMAT LineAsString;
```

```response title=Response
{'version':'1','serial_number':'2D9071D64530052D48308473922C7ADAFA85D6C5','signature_algo':'sha256WithRSAEncryption','issuer':'/CN=marsnet.local CA','not_before':'May  7 17:01:21 2024 GMT','not_after':'May  7 17:01:21 2025 GMT','subject':'/CN=chnode1','pkey_algo':'rsaEncryption'}
```


## sleep {#sleep}

Введена в версии: v1.1

Приостанавливает выполнение запроса на указанное количество секунд.
Функция используется преимущественно для тестирования и отладки.

Функцию `sleep()` обычно не следует использовать в продуктивных средах, так как она может негативно повлиять на производительность запросов и отзывчивость системы.
Однако она может быть полезна в следующих сценариях:

1. **Тестирование**: При тестировании или бенчмаркинге ClickHouse может потребоваться имитация задержек или введение пауз для наблюдения за поведением системы в определённых условиях.
2. **Отладка**: Если необходимо проверить состояние системы или выполнение запроса в конкретный момент времени, можно использовать `sleep()` для введения паузы, что позволит проверить или собрать соответствующую информацию.
3. **Имитация**: В некоторых случаях может потребоваться имитация реальных сценариев, в которых возникают задержки или паузы, например, сетевая задержка или зависимости от внешних систем.

:::warning
Важно использовать функцию `sleep()` разумно и только при необходимости, так как она может потенциально повлиять на общую производительность и отзывчивость системы ClickHouse.
:::

По соображениям безопасности функция может выполняться только в профиле пользователя по умолчанию (с включённым параметром `allow_sleep`).

**Синтаксис**

```sql
sleep(seconds)
```

**Аргументы**

- `seconds` — Количество секунд для приостановки выполнения запроса, максимум 3 секунды. Может быть значением с плавающей точкой для указания дробных секунд. [`const UInt*`](/sql-reference/data-types/int-uint) или [`const Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает `0`. [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
-- Этот запрос будет приостановлен на 2 секунды перед завершением.
-- В течение этого времени результаты не будут возвращены, и запрос будет выглядеть зависшим или неотвечающим.
SELECT sleep(2);
```

```response title=Response
┌─sleep(2)─┐
│        0 │
└──────────┘
1 row in set. Elapsed: 2.012 sec.
```


## sleepEachRow {#sleepEachRow}

Введена в версии: v1.1

Приостанавливает выполнение запроса на указанное количество секунд для каждой строки результирующего набора.

Функция `sleepEachRow()` используется преимущественно для тестирования и отладки, аналогично функции [`sleep()`](#sleep).
Она позволяет имитировать задержки или вводить паузы при обработке каждой строки, что может быть полезно в следующих сценариях:

1. **Тестирование**: При тестировании или бенчмаркинге производительности ClickHouse в определённых условиях можно использовать `sleepEachRow()` для имитации задержек или введения пауз для каждой обрабатываемой строки.
2. **Отладка**: Если необходимо проверить состояние системы или выполнение запроса для каждой обрабатываемой строки, можно использовать `sleepEachRow()` для введения пауз, что позволяет проверить или собрать соответствующую информацию.
3. **Имитация**: В некоторых случаях может потребоваться имитировать реальные сценарии, в которых возникают задержки или паузы для каждой обрабатываемой строки, например, при работе с внешними системами или при наличии сетевых задержек.

:::warning
Как и функцию `sleep()`, важно использовать `sleepEachRow()` разумно и только при необходимости, поскольку она может существенно повлиять на общую производительность и отзывчивость системы ClickHouse, особенно при работе с большими результирующими наборами.
:::

**Синтаксис**

```sql
sleepEachRow(seconds)
```

**Аргументы**

- `seconds` — Количество секунд для приостановки выполнения запроса для каждой строки результирующего набора, максимум 3 секунды. Может быть значением с плавающей точкой для указания дробных секунд. [`const UInt*`](/sql-reference/data-types/int-uint) или [`const Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает `0` для каждой строки. [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
-- Вывод будет задержан с паузой 0,5 секунды между каждой строкой.
SELECT number, sleepEachRow(0.5) FROM system.numbers LIMIT 5;
```

```response title=Response
┌─number─┬─sleepEachRow(0.5)─┐
│      0 │                 0 │
│      1 │                 0 │
│      2 │                 0 │
│      3 │                 0 │
│      4 │                 0 │
└────────┴───────────────────┘
```


## structureToCapnProtoSchema {#structureToCapnProtoSchema}

Введено в версии: v

Функция преобразует структуру таблицы ClickHouse в схему формата CapnProto.

**Syntax**

```sql

```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

**Примеры**

**random**

```sql title=Запрос
SELECT structureToCapnProtoSchema('s String, x UInt32', 'MessageName') format TSVRaw
```

```response title=Ответ
struct MessageName
{
    s @0 : Data;
    x @1 : UInt32;
}
```


## structureToProtobufSchema {#structureToProtobufSchema}

Введена в версии: v23.8

Преобразует структуру таблицы ClickHouse в схему формата Protobuf.

Функция принимает определение структуры таблицы ClickHouse и преобразует его в определение схемы Protocol Buffers (Protobuf)
в синтаксисе proto3. Это удобно для генерации схем Protobuf, соответствующих структурам таблиц ClickHouse, для обмена данными.

**Синтаксис**

```sql
structureToProtobufSchema(structure, message_name)
```

**Аргументы**

- `structure` — определение структуры таблицы ClickHouse в виде строки (например, 'column1 Type1, column2 Type2'). [`String`](/sql-reference/data-types/string)
- `message_name` — имя типа сообщения Protobuf в генерируемой схеме. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает определение схемы Protobuf в синтаксисе proto3, соответствующее входной структуре ClickHouse. [`String`](/sql-reference/data-types/string)

**Примеры**

**Преобразование структуры ClickHouse в схему Protobuf**

```sql title=Query
SELECT structureToProtobufSchema('s String, x UInt32', 'MessageName') FORMAT TSVRaw;
```

```response title=Response
syntax = "proto3";

message MessageName
{
    bytes s = 1;
    uint32 x = 2;
}
```


## tcpPort {#tcpPort}

Введена в версии: v20.12

Возвращает номер TCP-порта [нативного интерфейса](../../interfaces/tcp.md), который прослушивается сервером.
При выполнении в контексте распределённой таблицы функция генерирует обычный столбец со значениями, соответствующими каждому шарду.
В противном случае возвращается константное значение.

**Синтаксис**

```sql
tcpPort()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Номер TCP-порта. [`UInt16`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT tcpPort()
```

```response title=Результат
┌─tcpPort()─┐
│      9000 │
└───────────┘
```


## throwIf {#throwIf}

Введена в версии: v1.1

Генерирует исключение, если аргумент x имеет значение true.
Для использования аргумента `error_code` необходимо включить параметр конфигурации `allow_custom_error_code_in_throw`.

**Синтаксис**

```sql
throwIf(x[, message[, error_code]])
```

**Аргументы**

- `x` — Проверяемое условие. [`Any`](/sql-reference/data-types)
- `message` — Необязательный параметр. Пользовательское сообщение об ошибке. [`const String`](/sql-reference/data-types/string)
- `error_code` — Необязательный параметр. Пользовательский код ошибки. [`const Int8/16/32`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает `0`, если условие ложно, генерирует исключение, если условие истинно. [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT throwIf(number = 3, 'Too many') FROM numbers(10);
```

```response title=Ответ
↙ Progress: 0.00 rows, 0.00 B (0.00 rows/s., 0.00 B/s.) Received exception from server (version 19.14.1):
Code: 395. DB::Exception: Received from localhost:9000. DB::Exception: Too many.
```


## toColumnTypeName {#toColumnTypeName}

Введено в версии: v1.1

Возвращает внутреннее имя типа данных для указанного значения.
В отличие от функции [`toTypeName`](#toTypeName), возвращаемый тип данных может включать внутренние обёрточные колонки, такие как `Const` и `LowCardinality`.

**Синтаксис**

```sql
toColumnTypeName(value)
```

**Аргументы**

- `value` — значение, для которого требуется вернуть внутренний тип данных. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает внутренний тип данных, используемый для представления значения. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT toColumnTypeName(CAST('2025-01-01 01:02:03' AS DateTime));
```

```response title=Response
┌─toColumnTypeName(CAST('2025-01-01 01:02:03', 'DateTime'))─┐
│ Const(UInt32)                                             │
└───────────────────────────────────────────────────────────┘
```


## toTypeName {#toTypeName}

Введена в версии: v1.1

Возвращает название типа переданного аргумента.
Если передано значение `NULL`, функция возвращает тип `Nullable(Nothing)`, который соответствует внутреннему представлению `NULL` в ClickHouse.

**Синтаксис**

```sql
toTypeName(x)
```

**Аргументы**

- `x` — значение произвольного типа. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает название типа данных входного значения. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT toTypeName(123)
```

```response title=Response
┌─toTypeName(123)─┐
│ UInt8           │
└─────────────────┘
```


## transactionID {#transactionID}

Введена в версии: v22.6

<ExperimentalBadge />
<CloudNotSupportedBadge />

Возвращает идентификатор транзакции.

:::note
Эта функция является частью экспериментального набора функций.
Включите экспериментальную поддержку транзакций, добавив эту настройку в ваш [конфигурационный файл](/operations/configuration-files):

```xml
<clickhouse>
    <allow_experimental_transactions>1</allow_experimental_transactions>
</clickhouse>
```

Дополнительную информацию см. на странице [Поддержка транзакций (ACID)](/guides/developer/transactional#transactions-commit-and-rollback).
:::

**Синтаксис**

```sql
transactionID()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает кортеж, состоящий из `start_csn`, `local_tid` и `host_id`.

- `start_csn`: Глобальный порядковый номер, самая новая временная метка фиксации, которая была видна на момент начала этой транзакции.
- `local_tid`: Локальный порядковый номер, уникальный для каждой транзакции, запущенной данным хостом в рамках конкретного start_csn.
- `host_id`: UUID хоста, запустившего эту транзакцию.
  [`Tuple(UInt64, UInt64, UUID)`](/sql-reference/data-types/tuple)

**Примеры**

**Пример использования**

```sql title=Query
BEGIN TRANSACTION;
SELECT transactionID();
ROLLBACK;
```

```response title=Response
┌─transactionID()────────────────────────────────┐
│ (32,34,'0ee8b069-f2bb-4748-9eae-069c85b5252b') │
└────────────────────────────────────────────────┘
```


## transactionLatestSnapshot {#transactionLatestSnapshot}

Введена в версии: v22.6

<ExperimentalBadge />
<CloudNotSupportedBadge />

Возвращает самый новый снимок (номер последовательности фиксации, Commit Sequence Number) [транзакции](/guides/developer/transactional#transactions-commit-and-rollback), доступный для чтения.

:::note
Эта функция является частью экспериментального набора возможностей. Включите экспериментальную поддержку транзакций, добавив эту настройку в конфигурацию:

```xml
<clickhouse>
    <allow_experimental_transactions>1</allow_experimental_transactions>
</clickhouse>
```

Дополнительную информацию см. на странице [Поддержка транзакций (ACID)](/guides/developer/transactional#transactions-commit-and-rollback).
:::

**Синтаксис**

```sql
transactionLatestSnapshot()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает последний снимок (CSN) транзакции. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
BEGIN TRANSACTION;
SELECT transactionLatestSnapshot();
ROLLBACK;
```

```response title=Response
┌─transactionLatestSnapshot()─┐
│                          32 │
└─────────────────────────────┘
```


## transactionOldestSnapshot {#transactionOldestSnapshot}

Введена в версии: v22.6

<ExperimentalBadge />
<CloudNotSupportedBadge />

Возвращает самый старый снимок (номер последовательности фиксации, Commit Sequence Number), видимый для некоторой выполняющейся [транзакции](/guides/developer/transactional#transactions-commit-and-rollback).

:::note
Эта функция является частью экспериментального набора возможностей. Включите экспериментальную поддержку транзакций, добавив эту настройку в конфигурацию:

```xml
<clickhouse>
    <allow_experimental_transactions>1</allow_experimental_transactions>
</clickhouse>
```

Для получения дополнительной информации см. страницу [Поддержка транзакций (ACID)](/guides/developer/transactional#transactions-commit-and-rollback).
:::

**Синтаксис**

```sql
transactionOldestSnapshot()
```

**Аргументы**

- Нет.

**Возвращаемое значение**

Возвращает самый старый снимок (CSN) транзакции. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
BEGIN TRANSACTION;
SELECT transactionOldestSnapshot();
ROLLBACK;
```

```response title=Результат
┌─transactionOldestSnapshot()─┐
│                          32 │
└─────────────────────────────┘
```


## transform {#transform}

Введена в версии: v1.1

Преобразует значение согласно явно заданному отображению одних элементов на другие.

Существует два варианта этой функции:

- `transform(x, array_from, array_to, default)` — преобразует `x` с использованием массивов отображения со значением по умолчанию для несовпадающих элементов
- `transform(x, array_from, array_to)` — то же преобразование, но возвращает исходное значение `x`, если совпадение не найдено

Функция ищет `x` в `array_from` и возвращает соответствующий элемент из `array_to` с тем же индексом.
Если `x` не найден в `array_from`, возвращается либо значение `default` (версия с 4 параметрами), либо исходное значение `x` (версия с 3 параметрами).
Если в `array_from` существует несколько совпадающих элементов, возвращается элемент, соответствующий первому совпадению.

Требования:

- `array_from` и `array_to` должны иметь одинаковое количество элементов
- Для версии с 4 параметрами: `transform(T, Array(T), Array(U), U) -> U`, где `T` и `U` могут быть различными совместимыми типами
- Для версии с 3 параметрами: `transform(T, Array(T), Array(T)) -> T`, где все типы должны быть одинаковыми

**Синтаксис**

```sql
transform(x, array_from, array_to[, default])
```

**Аргументы**

- `x` — значение для преобразования. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Decimal`](/sql-reference/data-types/decimal) или [`Float*`](/sql-reference/data-types/float) или [`String`](/sql-reference/data-types/string) или [`Date`](/sql-reference/data-types/date) или [`DateTime`](/sql-reference/data-types/datetime)
- `array_from` — константный массив значений для поиска совпадений. [`Array((U)Int*)`](/sql-reference/data-types/array) или [`Array(Decimal)`](/sql-reference/data-types/array) или [`Array(Float*)`](/sql-reference/data-types/array) или [`Array(String)`](/sql-reference/data-types/array) или [`Array(Date)`](/sql-reference/data-types/array) или [`Array(DateTime)`](/sql-reference/data-types/array)
- `array_to` — константный массив значений для возврата при соответствующих совпадениях в `array_from`. [`Array((U)Int*)`](/sql-reference/data-types/array) или [`Array(Decimal)`](/sql-reference/data-types/array) или [`Array(Float*)`](/sql-reference/data-types/array) или [`Array(String)`](/sql-reference/data-types/array) или [`Array(Date)`](/sql-reference/data-types/array) или [`Array(DateTime)`](/sql-reference/data-types/array)
- `default` — необязательный параметр. Значение для возврата, если `x` не найден в `array_from`. Если не указан, возвращает x без изменений. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Decimal`](/sql-reference/data-types/decimal) или [`Float*`](/sql-reference/data-types/float) или [`String`](/sql-reference/data-types/string) или [`Date`](/sql-reference/data-types/date) или [`DateTime`](/sql-reference/data-types/datetime)

**Возвращаемое значение**

Возвращает соответствующее значение из `array_to`, если x совпадает с элементом в `array_from`, в противном случае возвращает default (если указан) или x (если default не указан). [`Any`](/sql-reference/data-types)

**Примеры**

**transform(T, Array(T), Array(U), U) -> U**

```sql title=Query
SELECT
transform(SearchEngineID, [2, 3], ['Yandex', 'Google'], 'Other') AS title,
count() AS c
FROM test.hits
WHERE SearchEngineID != 0
GROUP BY title
ORDER BY c DESC
```

```response title=Response
┌─title─────┬──────c─┐
│ Yandex    │ 498635 │
│ Google    │ 229872 │
│ Other     │ 104472 │
└───────────┴────────┘
```

**transform(T, Array(T), Array(T)) -> T**

```sql title=Query
SELECT
transform(domain(Referer), ['yandex.ru', 'google.ru', 'vkontakte.ru'], ['www.yandex', 'example.com', 'vk.com']) AS s, count() AS c
FROM test.hits
GROUP BY domain(Referer)
ORDER BY count() DESC
LIMIT 10
```


```response title=Response
┌─s──────────────┬───────c─┐
│                │ 2906259 │
│ www.yandex     │  867767 │
│ ███████.ru     │  313599 │
│ mail.yandex.ru │  107147 │
│ ██████.ru      │  100355 │
│ █████████.ru   │   65040 │
│ news.yandex.ru │   64515 │
│ ██████.net     │   59141 │
│ example.com    │   57316 │
└────────────────┴─────────┘
```


## uniqThetaIntersect {#uniqThetaIntersect}

Введена в версии: v22.9

Вычисляет пересечение двух объектов uniqThetaSketch (операция над множествами ∩). Результатом является новый объект uniqThetaSketch.

**Синтаксис**

```sql
uniqThetaIntersect(uniqThetaSketch,uniqThetaSketch)
```

**Аргументы**

- `uniqThetaSketch` — объект uniqThetaSketch. [`Tuple`](/sql-reference/data-types/tuple) или [`Array`](/sql-reference/data-types/array) или [`Date`](/sql-reference/data-types/date) или [`DateTime`](/sql-reference/data-types/datetime) или [`String`](/sql-reference/data-types/string) или [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal)

**Возвращаемое значение**

Новый объект uniqThetaSketch, содержащий результат пересечения. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
SELECT finalizeAggregation(uniqThetaIntersect(a, b)) AS a_intersect_b, finalizeAggregation(a) AS a_cardinality, finalizeAggregation(b) AS b_cardinality
FROM
(SELECT arrayReduce('uniqThetaState', [1, 2]) AS a, arrayReduce('uniqThetaState', [2, 3, 4]) AS b);
```

```response title=Response
┌─a_intersect_b─┬─a_cardinality─┬─b_cardinality─┐
│             1 │             2 │             3 │
└───────────────┴───────────────┴───────────────┘
```


## uniqThetaNot {#uniqThetaNot}

Введена в версии: v22.9

Выполняет операцию a_not_b (теоретико-множественная операция ×) над двумя объектами uniqThetaSketch, результатом является новый объект uniqThetaSketch.

**Синтаксис**

```sql
uniqThetaNot(uniqThetaSketch,uniqThetaSketch)
```

**Аргументы**

- `uniqThetaSketch` — объект uniqThetaSketch. [`Tuple`](/sql-reference/data-types/tuple) или [`Array`](/sql-reference/data-types/array) или [`Date`](/sql-reference/data-types/date) или [`DateTime`](/sql-reference/data-types/datetime) или [`String`](/sql-reference/data-types/string) или [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal)

**Возвращаемое значение**

Возвращает новый объект uniqThetaSketch, содержащий результат операции a_not_b. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT finalizeAggregation(uniqThetaNot(a, b)) AS a_not_b, finalizeAggregation(a) AS a_cardinality, finalizeAggregation(b) AS b_cardinality
FROM
(SELECT arrayReduce('uniqThetaState', [2, 3, 4]) AS a, arrayReduce('uniqThetaState', [1, 2]) AS b);
```

```response title=Результат
┌─a_not_b─┬─a_cardinality─┬─b_cardinality─┐
│       2 │             3 │             2 │
└─────────┴───────────────┴───────────────┘
```


## uniqThetaUnion {#uniqThetaUnion}

Введена в версии: v22.9

Выполняет объединение двух объектов uniqThetaSketch (операция над множествами ∪), результатом является новый объект uniqThetaSketch.

**Синтаксис**

```sql
uniqThetaUnion(uniqThetaSketch,uniqThetaSketch)
```

**Аргументы**

- `uniqThetaSketch` — объект uniqThetaSketch. [`Tuple`](/sql-reference/data-types/tuple) или [`Array`](/sql-reference/data-types/array) или [`Date`](/sql-reference/data-types/date) или [`DateTime`](/sql-reference/data-types/datetime) или [`String`](/sql-reference/data-types/string) или [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal)

**Возвращаемое значение**

Возвращает новый объект uniqThetaSketch, содержащий результат объединения. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT finalizeAggregation(uniqThetaUnion(a, b)) AS a_union_b, finalizeAggregation(a) AS a_cardinality, finalizeAggregation(b) AS b_cardinality
FROM
(SELECT arrayReduce('uniqThetaState', [1, 2]) AS a, arrayReduce('uniqThetaState', [2, 3, 4]) AS b);
```

```response title=Результат
┌─a_union_b─┬─a_cardinality─┬─b_cardinality─┐
│         4 │             2 │             3 │
└───────────┴───────────────┴───────────────┘
```


## uptime {#uptime}

Введена в версии: v1.1

Возвращает время работы сервера в секундах.
При выполнении в контексте распределённой таблицы функция генерирует обычный столбец со значениями для каждого шарда.
В противном случае возвращает константное значение.

**Синтаксис**

```sql
uptime()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Время работы сервера в секундах. [`UInt32`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT uptime() AS Uptime
```

```response title=Результат
┌─Uptime─┐
│  55867 │
└────────┘
```


## variantElement {#variantElement}

Введена в версии: v25.2

Извлекает столбец указанного типа из столбца `Variant`.

**Синтаксис**

```sql
variantElement(variant, type_name[, default_value])
```

**Аргументы**

- `variant` — столбец Variant. [`Variant`](/sql-reference/data-types/variant)
- `type_name` — имя типа варианта для извлечения. [`String`](/sql-reference/data-types/string)
- `default_value` — значение по умолчанию, которое будет использовано, если вариант не содержит указанный тип. Может быть любого типа. Необязательный параметр. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает столбец с указанным типом варианта, извлеченным из столбца Variant. [`Any`](/sql-reference/data-types)

**Примеры**

**Пример использования**

```sql title=Запрос
CREATE TABLE test (v Variant(UInt64, String, Array(UInt64))) ENGINE = Memory;
INSERT INTO test VALUES (NULL), (42), ('Hello, World!'), ([1, 2, 3]);
SELECT v, variantElement(v, 'String'), variantElement(v, 'UInt64'), variantElement(v, 'Array(UInt64)') FROM test;
```

```response title=Результат
┌─v─────────────┬─variantElement(v, 'String')─┬─variantElement(v, 'UInt64')─┬─variantElement(v, 'Array(UInt64)')─┐
│ ᴺᵁᴸᴸ          │ ᴺᵁᴸᴸ                        │                        ᴺᵁᴸᴸ │ []                                 │
│ 42            │ ᴺᵁᴸᴸ                        │                          42 │ []                                 │
│ Hello, World! │ Hello, World!               │                        ᴺᵁᴸᴸ │ []                                 │
│ [1,2,3]       │ ᴺᵁᴸᴸ                        │                        ᴺᵁᴸᴸ │ [1,2,3]                            │
└───────────────┴─────────────────────────────┴─────────────────────────────┴────────────────────────────────────┘
```


## variantType {#variantType}

Введена в версии: v24.2

Возвращает имя типа варианта для каждой строки столбца `Variant`. Если строка содержит NULL, для неё возвращается 'None'.

**Синтаксис**

```sql
variantType(variant)
```

**Аргументы**

- `variant` — столбец Variant. [`Variant`](/sql-reference/data-types/variant)

**Возвращаемое значение**

Возвращает столбец Enum с именем типа варианта для каждой строки. [`Enum`](/sql-reference/data-types/enum)

**Примеры**

**Пример использования**

```sql title=Запрос
CREATE TABLE test (v Variant(UInt64, String, Array(UInt64))) ENGINE = Memory;
INSERT INTO test VALUES (NULL), (42), ('Hello, World!'), ([1, 2, 3]);
SELECT variantType(v) FROM test;
```

```response title=Результат
┌─variantType(v)─┐
│ None           │
│ UInt64         │
│ String         │
│ Array(UInt64)  │
└────────────────┘
```


## version {#version}

Введена в версии: v1.1

Возвращает текущую версию ClickHouse в виде строки в формате: `major_version.minor_version.patch_version.number_of_commits_since_the_previous_stable_release`.
При выполнении в контексте распределённой таблицы функция генерирует обычный столбец со значениями, релевантными для каждого шарда.
В противном случае возвращает константное значение.

**Синтаксис**

```sql
version()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает текущую версию ClickHouse. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT version()
```

```response title=Результат
┌─version()─┐
│ 24.2.1.1  │
└───────────┘
```


## visibleWidth {#visibleWidth}

Введена в версии: v1.1

Вычисляет приблизительную ширину при выводе значений в консоль в текстовом формате (с разделением табуляцией).
Эта функция используется системой для реализации форматов Pretty.
`NULL` представляется в виде строки, соответствующей `NULL` в форматах Pretty.

**Синтаксис**

```sql
visibleWidth(x)
```

**Аргументы**

- `x` — значение любого типа данных. [`Any`](/sql-reference/data-types)

**Возвращаемое значение**

Возвращает приблизительную ширину значения при отображении в текстовом формате. [`UInt64`](/sql-reference/data-types/int-uint)

**Примеры**

**Вычисление видимой ширины NULL**

```sql title=Запрос
SELECT visibleWidth(NULL)
```

```response title=Результат
┌─visibleWidth(NULL)─┐
│                  4 │
└────────────────────┘
```


## zookeeperSessionUptime {#zookeeperSessionUptime}

Добавлена в версии: v21.11

Возвращает время работы (uptime) текущей сессии ZooKeeper в секундах.

**Синтаксис**

```sql
zookeeperSessionUptime()
```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

Возвращает время работы (uptime) текущей сессии ZooKeeper в секундах. [`UInt32`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT zookeeperSessionUptime();
```

```response title=Результат
┌─zookeeperSessionUptime()─┐
│                      286 │
└──────────────────────────┘
```

<!--AUTOGENERATED_END-->
