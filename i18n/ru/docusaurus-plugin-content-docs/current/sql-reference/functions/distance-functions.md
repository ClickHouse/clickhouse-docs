---
description: 'Справочная документация по функциям расстояния'
sidebar_label: 'Функции расстояния'
slug: /sql-reference/functions/distance-functions
title: 'Функции расстояния'
keywords: ['функции расстояния', 'нормы', 'расстояния', 'векторы']
doc_type: 'reference'
---

# Функции расстояний \{#distance-functions\}

{/* 
  Во время сборки фреймворка документации внутреннее содержимое расположенных ниже тегов
  заменяется документацией, сгенерированной из system.functions. Пожалуйста, не изменяйте и не удаляйте эти теги.
  См.: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }

## L1Distance \{#L1Distance\}

Введена в версии: v21.11

Вычисляет расстояние между двумя точками (элементы векторов являются координатами) в пространстве `L1` (1-норма, расстояние в [таксомоторной геометрии](https://en.wikipedia.org/wiki/Taxicab_geometry)).

**Синтаксис**

```sql
L1Distance(vector1, vector2)
```

**Псевдонимы**: `distanceL1`

**Аргументы**

* `vector1` — первый вектор. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)
* `vector2` — второй вектор. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)

**Возвращаемое значение**

Возвращает расстояние в 1-норме. [`UInt32`](/sql-reference/data-types/int-uint) или [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT L1Distance((1, 2), (2, 3))
```

```response title=Response
┌─L1Distance((1, 2), (2, 3))─┐
│                          2 │
└────────────────────────────┘
```

## L1Norm \{#L1Norm\}

Добавлена в версии: v21.11

Вычисляет сумму модулей элементов вектора.

**Синтаксис**

```sql
L1Norm(vector)
```

**Псевдонимы**: `normL1`

**Аргументы**

* `vector` — Вектор или кортеж числовых значений. [`Array(T)`](/sql-reference/data-types/array) или [`Tuple(T)`](/sql-reference/data-types/tuple)

**Возвращаемое значение**

Возвращает L1-норму или расстояние в [метрике такси (taxicab geometry)](https://en.wikipedia.org/wiki/Taxicab_geometry). [`UInt*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT L1Norm((1, 2))
```

```response title=Response
┌─L1Norm((1, 2))─┐
│              3 │
└────────────────┘
```

## L1Normalize \{#L1Normalize\}

Введена в версии: v21.11

Вычисляет единичный вектор для заданного вектора (элементы кортежа являются его координатами) в пространстве с нормой `L1` ([таксистская геометрия](https://en.wikipedia.org/wiki/Taxicab_geometry)).

**Синтаксис**

```sql
L1Normalize(tuple)
```

**Псевдонимы**: `normalizeL1`

**Аргументы**

* `tuple` — кортеж числовых значений. [`Tuple(T)`](/sql-reference/data-types/tuple)

**Возвращаемое значение**

Возвращает единичный вектор. [`Tuple(Float64)`](/sql-reference/data-types/tuple)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT L1Normalize((1, 2))
```

```response title=Response
┌─L1Normalize((1, 2))─────────────────────┐
│ (0.3333333333333333,0.6666666666666666) │
└─────────────────────────────────────────┘
```

## L2Distance \{#L2Distance\}

Появилась в версии: v21.11

Вычисляет расстояние между двумя точками (элементы векторов являются координатами) в евклидовом пространстве ([Euclidean distance](https://en.wikipedia.org/wiki/Euclidean_distance)).

**Синтаксис**

```sql
L2Distance(vector1, vector2)
```

**Псевдонимы**: `distanceL2`

**Аргументы**

* `vector1` — первый вектор. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)
* `vector2` — второй вектор. [`Tuple(T)`](/sql-reference/data-types/array) или [`Array(T)`](/sql-reference/data-types/array)

**Возвращаемое значение**

Возвращает расстояние во 2-норме. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT L2Distance((1, 2), (2, 3))
```

```response title=Response
┌─L2Distance((1, 2), (2, 3))─┐
│         1.4142135623730951 │
└────────────────────────────┘
```

## L2DistanceTransposed \{#L2DistanceTransposed\}

Добавлено в: v25.10

Вычисляет приближённое расстояние между двумя точками (значения векторов рассматриваются как координаты) в евклидовом пространстве ([евклидово расстояние](https://en.wikipedia.org/wiki/Euclidean_distance)).

**Синтаксис**

```sql
L2DistanceTransposed(vector1, vector2, p)
```

**Псевдонимы**: `distanceL2Transposed`

**Аргументы**

* `vectors` — Векторы. [`QBit(T, UInt64)`](/sql-reference/data-types/qbit)
* `reference` — Опорный вектор. [`Array(T)`](/sql-reference/data-types/array)
* `p` — Количество бит каждого элемента вектора, используемых при вычислении расстояния (от 1 до разрядности элемента). Уровень квантизации определяет компромисс между точностью и скоростью. Использование меньшего количества бит приводит к более быстрым операциям ввода-вывода и вычислениям с пониженной точностью, тогда как использование большего количества бит повышает точность ценой производительности. [`UInt`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает приближённое расстояние по 2-норме. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Базовое использование**

```sql title=Query
CREATE TABLE qbit (id UInt32, vec QBit(Float64, 2)) ENGINE = Memory;
INSERT INTO qbit VALUES (1, [0, 1]);
SELECT L2DistanceTransposed(vec, array(1, 2), 16) FROM qbit;
```

```response title=Response
┌─L2DistanceTransposed([0, 1], [1, 2], 16)─┐
│                       1.4142135623730951 │
└──────────────────────────────────────────┘
```

## L2Norm \{#L2Norm\}

Добавлена в версии: v21.11

Вычисляет квадратный корень из суммы квадратов элементов вектора.

**Синтаксис**

```sql
L2Norm(vector)
```

**Псевдонимы**: `normL2`

**Аргументы**

* `vector` — вектор или кортеж числовых значений. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)

**Возвращаемое значение**

Возвращает норму L2 или [евклидово расстояние](https://en.wikipedia.org/wiki/Euclidean_distance). [`UInt*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT L2Norm((1, 2))
```

```response title=Response
┌───L2Norm((1, 2))─┐
│ 2.23606797749979 │
└──────────────────┘
```

## L2Normalize \{#L2Normalize\}

Впервые появилось в: v21.11

Вычисляет единичный вектор для заданного вектора (элементы кортежа — его координаты) в евклидовом пространстве (с использованием [евклидова расстояния](https://en.wikipedia.org/wiki/Euclidean_distance)).

**Синтаксис**

```sql
L2Normalize(tuple)
```

**Псевдонимы**: `normalizeL2`

**Аргументы**

* `tuple` — кортеж числовых значений. [`Tuple(T)`](/sql-reference/data-types/tuple)

**Возвращаемое значение**

Возвращает единичный вектор. [`Tuple(Float64)`](/sql-reference/data-types/tuple)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT L2Normalize((3, 4))
```

```response title=Response
┌─L2Normalize((3, 4))─┐
│ (0.6,0.8)           │
└─────────────────────┘
```

## L2SquaredDistance \{#L2SquaredDistance\}

Введена в версии: v22.7

Вычисляет сумму квадратов разностей между соответствующими элементами двух векторов.

**Синтаксис**

```sql
L2SquaredDistance(vector1, vector2)
```

**Псевдонимы**: `distanceL2Squared`

**Аргументы**

* `vector1` — первый вектор. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)
* `vector2` — второй вектор. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)

**Возвращаемое значение**

Возвращает сумму квадратов разностей соответствующих элементов двух векторов. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT L2SquaredDistance([1, 2, 3], [0, 0, 0])
```

```response title=Response
┌─L2SquaredDis⋯ [0, 0, 0])─┐
│                       14 │
└──────────────────────────┘
```

## L2SquaredNorm \{#L2SquaredNorm\}

Добавлено в: v22.7

Вычисляет квадратный корень из суммы квадратов элементов вектора (то есть квадрат [`L2Norm`](#L2Norm)).

**Синтаксис**

```sql
L2SquaredNorm(vector)
```

**Псевдонимы**: `normL2Squared`

**Аргументы**

* `vector` — вектор или кортеж числовых значений. [`Array(T)`](/sql-reference/data-types/array) или [`Tuple(T)`](/sql-reference/data-types/tuple)

**Возвращаемое значение**

Возвращает квадрат L2-нормы. [`UInt*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`Decimal`](/sql-reference/data-types/decimal)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT L2SquaredNorm((1, 2))
```

```response title=Response
┌─L2SquaredNorm((1, 2))─┐
│                     5 │
└───────────────────────┘
```

## LinfDistance \{#LinfDistance\}

Появилась в версии: v21.11

Вычисляет расстояние между двумя точками (элементы векторов являются их координатами) в пространстве `L_{inf}` ([максимальная норма](https://en.wikipedia.org/wiki/Norm_\(mathematics\)#Maximum_norm_\(special_case_of:_infinity_norm,_uniform_norm,_or_supremum_norm\))).

**Синтаксис**

```sql
LinfDistance(vector1, vector2)
```

**Псевдонимы**: `distanceLinf`

**Аргументы**

* `vector1` — Первый вектор. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)
* `vector2` — Второй вектор. [`Tuple(T)`](/sql-reference/data-types/array) или [`Array(T)`](/sql-reference/data-types/array)

**Возвращаемое значение**

Возвращает расстояние по норме бесконечности. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT LinfDistance((1, 2), (2, 3))
```

```response title=Response
┌─LinfDistance((1, 2), (2, 3))─┐
│                            1 │
└──────────────────────────────┘
```

## LinfNorm \{#LinfNorm\}

Впервые появилась в версии v21.11

Вычисляет максимальное по модулю значение элементов вектора.

**Синтаксис**

```sql
LinfNorm(vector)
```

**Псевдонимы**: `normLinf`

**Аргументы**

* `vector` — вектор или кортеж числовых значений. [`Array(T)`](/sql-reference/data-types/array) или [`Tuple(T)`](/sql-reference/data-types/tuple)

**Возвращаемое значение**

Возвращает Linf-норму или максимальное абсолютное значение. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT LinfNorm((1, -2))
```

```response title=Response
┌─LinfNorm((1, -2))─┐
│                 2 │
└───────────────────┘
```

## LinfNormalize \{#LinfNormalize\}

Добавлена в версии: v21.11

Вычисляет единичный вектор заданного вектора (элементы кортежа — это его координаты) в пространстве `L_{inf}` (c использованием [максимальной нормы](https://en.wikipedia.org/wiki/Norm_\(mathematics\)#Maximum_norm_\(special_case_of:_infinity_norm,_uniform_norm,_or_supremum_norm\))).

**Синтаксис**

```sql
LinfNormalize(tuple)
```

**Синонимы**: `normalizeLinf`

**Аргументы**

* `tuple` — кортеж числовых значений. [`Tuple(T)`](/sql-reference/data-types/tuple)

**Возвращаемое значение**

Возвращает единичный вектор. [`Tuple(Float64)`](/sql-reference/data-types/tuple)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT LinfNormalize((3, 4))
```

```response title=Response
┌─LinfNormalize((3, 4))─┐
│ (0.75,1)              │
└───────────────────────┘
```

## LpDistance \{#LpDistance\}

Введена в версии: v21.11

Вычисляет расстояние между двумя точками (элементы векторов интерпретируются как координаты) в пространстве `Lp` ([расстояние в p-норме](https://en.wikipedia.org/wiki/Norm_\(mathematics\)#p-norm)).

**Синтаксис**

```sql
LpDistance(vector1, vector2, p)
```

**Псевдонимы**: `distanceLp`

**Аргументы**

* `vector1` — первый вектор. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)
* `vector2` — второй вектор. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)
* `p` — степень. Возможные значения: вещественное число в диапазоне `[1; inf)`. [`UInt*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает расстояние в p-норме. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Базовый пример**

```sql title=Query
SELECT LpDistance((1, 2), (2, 3), 3)
```

```response title=Response
┌─LpDistance((1, 2), (2, 3), 3)─┐
│            1.2599210498948732 │
└───────────────────────────────┘
```

## LpNorm \{#LpNorm\}

Введена в версии: v21.11

Вычисляет p-норму вектора, то есть корень степени p из суммы p-х степеней абсолютных значений его элементов.

Особые случаи:

* При p=1 эквивалентно L1Norm (манхэттенское расстояние).
* При p=2 эквивалентно L2Norm (евклидово расстояние).
* При p=∞ эквивалентно LinfNorm (максимальная норма).

**Синтаксис**

```sql
LpNorm(vector, p)
```

**Псевдонимы**: `normLp`

**Аргументы**

* `vector` — вектор или кортеж числовых значений. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)
* `p` — показатель степени. Возможные значения — действительные числа в диапазоне `[1; inf)`. [`UInt*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает [Lp-норму](https://en.wikipedia.org/wiki/Norm_\(mathematics\)#p-norm). [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT LpNorm((1, -2), 2)
```

```response title=Response
┌─LpNorm((1, -2), 2)─┐
│   2.23606797749979 │
└────────────────────┘
```

## LpNormalize \{#LpNormalize\}

Добавлена в версии: v21.11

Вычисляет единичный вектор заданного вектора (элементы кортежа — координаты) в пространстве `Lp` (с использованием [p-нормы](https://en.wikipedia.org/wiki/Norm_\(mathematics\)#p-norm)).

**Синтаксис**

```sql
LpNormalize(tuple, p)
```

**Псевдонимы**: `normalizeLp`

**Аргументы**

* `tuple` — кортеж числовых значений. [`Tuple(T)`](/sql-reference/data-types/tuple)
* `p` — степень. Возможные значения — любое число из диапазона `[1; inf)`. [`UInt*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает единичный вектор. [`Tuple(Float64)`](/sql-reference/data-types/tuple)

**Примеры**

**Пример использования**

```sql title=Query
SELECT LpNormalize((3, 4), 5)
```

```response title=Response
┌─LpNormalize((3, 4), 5)──────────────────┐
│ (0.7187302630182624,0.9583070173576831) │
└─────────────────────────────────────────┘
```

## cosineDistance \{#cosineDistance\}

Введена в версии: v1.1

Вычисляет [косинусное расстояние](https://en.wikipedia.org/wiki/Cosine_similarity#Cosine_distance) между двумя векторами (элементы кортежей — это координаты). Чем меньше возвращаемое значение, тем более похожи векторы.

**Синтаксис**

```sql
cosineDistance(vector1, vector2)
```

**Псевдонимы**: `distanceCosine`

**Аргументы**

* `vector1` — Первый кортеж. [`Tuple(T)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)
* `vector2` — Второй кортеж. [`Tuple(T)`](/sql-reference/data-types/array) или [`Array(T)`](/sql-reference/data-types/array)

**Возвращаемое значение**

Возвращает единицу минус косинус угла между двумя векторами. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Базовый пример**

```sql title=Query
SELECT cosineDistance((1, 2), (2, 3));
```

```response title=Response
┌─cosineDistance((1, 2), (2, 3))─┐
│           0.007722123286332261 │
└────────────────────────────────┘
```

## cosineDistanceTransposed \{#cosineDistanceTransposed\}

Введена в: v26.1

Вычисляет приближённое [косинусное расстояние](https://en.wikipedia.org/wiki/Cosine_similarity#Cosine_distance) между двумя точками (значения векторов являются координатами). Чем меньше возвращаемое значение, тем больше сходство между векторами.

**Синтаксис**

```sql
cosineDistanceTransposed(vector1, vector2, p)
```

**Псевдонимы**: `distanceCosineTransposed`

**Аргументы**

* `vectors` — Векторы. [`QBit(T, UInt64)`](/sql-reference/data-types/qbit)
* `reference` — Опорный вектор. [`Array(T)`](/sql-reference/data-types/array)
* `p` — Количество бит из каждого элемента вектора, используемых при вычислении расстояния (от 1 до разрядности элемента). Уровень квантования определяет компромисс между точностью и скоростью. Использование меньшего числа бит приводит к более быстрым операциям ввода-вывода и вычислениям с пониженной точностью, тогда как использование большего числа бит повышает точность ценой производительности. [`UInt`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает величину 1 минус приближённый косинус угла между двумя векторами. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Базовое использование**

```sql title=Query
CREATE TABLE qbit (id UInt32, vec QBit(Float64, 2)) ENGINE = Memory;
INSERT INTO qbit VALUES (1, [0, 1]);
SELECT cosineDistanceTransposed(vec, array(1, 2), 16) FROM qbit;
```

```response title=Response
┌─cosineDistanceTransposed([0, 1], [1, 2], 16)─┐
│                          0.10557281085638826 │
└──────────────────────────────────────────────┘
```

{/*AUTOGENERATED_END*/ }
