---
description: 'Справочник по битовым функциям'
sidebar_label: 'Битовые функции'
slug: /sql-reference/functions/bit-functions
title: 'Битовые функции'
doc_type: 'reference'
---

# Побитовые функции {#bit-functions}

Побитовые функции работают для любой пары типов из `UInt8`, `UInt16`, `UInt32`, `UInt64`, `Int8`, `Int16`, `Int32`, `Int64`, `Float32` или `Float64`. Некоторые функции поддерживают типы `String` и `FixedString`.

Тип результата — целое число с количеством бит, равным максимальному количеству бит среди его аргументов. Если хотя бы один из аргументов — знаковый, результат будет знаковым числом. Если аргумент является числом с плавающей запятой, он приводится к типу Int64.

{/* 
  Во время сборки фреймворка документации внутреннее содержимое приведённых ниже тегов
  заменяется документацией, сгенерированной из system.functions. Пожалуйста, не изменяйте и не удаляйте эти теги.
  См.: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }

## bitAnd {#bitAnd}

Добавлено в: v1.1

Выполняет побитовую операцию AND между двумя значениями.

**Синтаксис**

```sql
bitAnd(a, b)
```

**Аргументы**

* `a` — первое значение. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)
* `b` — второе значение. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает результат побитовой операции `a AND b`

**Примеры**

**Пример использования**

```sql title=Query
CREATE TABLE bits
(
    `a` UInt8,
    `b` UInt8
)
ENGINE = Memory;

INSERT INTO bits VALUES (0, 0), (0, 1), (1, 0), (1, 1);

SELECT
    a,
    b,
    bitAnd(a, b)
FROM bits
```

```response title=Response
┌─a─┬─b─┬─bitAnd(a, b)─┐
│ 0 │ 0 │            0 │
│ 0 │ 1 │            0 │
│ 1 │ 0 │            0 │
│ 1 │ 1 │            1 │
└───┴───┴──────────────┘
```

## bitCount {#bitCount}

Добавлена в: v20.3

Вычисляет количество битов, установленных в 1, в двоичном представлении числа.

**Синтаксис**

```sql
bitCount(x)
```

**Аргументы**

* `x` — Целочисленное или вещественное значение. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает количество битов, равных единице, в `x`. [`UInt8`](../data-types/int-uint.md).

:::note
Функция не преобразует входное значение к типу с большей разрядностью ([расширение знака](https://en.wikipedia.org/wiki/Sign_extension)).
Например: `bitCount(toUInt8(-1)) = 8`.
:::

**Примеры**

**Пример использования**

```sql title=Query
SELECT bin(333), bitCount(333);
```

```response title=Response
┌─bin(333)─────────┬─bitCount(333)─┐
│ 0000000101001101 │             5 │
└──────────────────┴───────────────┘
```

## bitHammingDistance {#bitHammingDistance}

Добавлено в: v21.1

Возвращает [расстояние Хэмминга](https://en.wikipedia.org/wiki/Hamming_distance) между битовыми представлениями двух чисел.
Может использоваться с функциями [`SimHash`](../../sql-reference/functions/hash-functions.md#ngramSimHash) для обнаружения частично дублирующихся строк.
Чем меньше расстояние, тем более похожи строки.

**Синтаксис**

```sql
bitHammingDistance(x, y)
```

**Аргументы**

* `x` — первое число для вычисления расстояния Хэмминга. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)
* `y` — второе число для вычисления расстояния Хэмминга. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает расстояние Хэмминга между `x` и `y` типа [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
SELECT bitHammingDistance(111, 121);
```

```response title=Response
┌─bitHammingDistance(111, 121)─┐
│                            3 │
└──────────────────────────────┘
```

## bitNot {#bitNot}

Добавлена в версии: v1.1

Выполняет побитовую операцию NOT.

**Синтаксис**

```sql
bitNot(a)
```

**Аргументы**

* `a` — Значение, к которому применяется побитовое отрицание (NOT). [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float) или [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает результат `~a`, то есть `a` с инвертированными битами.

**Примеры**

**Пример использования**

```sql title=Query
SELECT
    CAST('5', 'UInt8') AS original,
    bin(original) AS original_binary,
    bitNot(original) AS result,
    bin(bitNot(original)) AS result_binary;
```

```response title=Response
┌─original─┬─original_binary─┬─result─┬─result_binary─┐
│        5 │ 00000101        │    250 │ 11111010      │
└──────────┴─────────────────┴────────┴───────────────┘
```

## bitOr {#bitOr}

Добавлено в: v1.1

Выполняет побитовое операция OR между двумя значениями.

**Синтаксис**

```sql
bitOr(a, b)
```

**Аргументы**

* `a` — первое значение. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)
* `b` — второе значение. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает результат побитовой операции `a OR b`

**Примеры**

**Пример использования**

```sql title=Query
CREATE TABLE bits
(
    `a` UInt8,
    `b` UInt8
)
ENGINE = Memory;

INSERT INTO bits VALUES (0, 0), (0, 1), (1, 0), (1, 1);

SELECT
    a,
    b,
    bitOr(a, b)
FROM bits;
```

```response title=Response
┌─a─┬─b─┬─bitOr(a, b)─┐
│ 0 │ 0 │           0 │
│ 0 │ 1 │           1 │
│ 1 │ 0 │           1 │
│ 1 │ 1 │           1 │
└───┴───┴─────────────┘
```

## bitRotateLeft {#bitRotateLeft}

Добавлена в версии: v1.1

Выполняет циклический сдвиг битов влево на указанное количество позиций. Биты, вышедшие за левую границу, циклически переносятся вправо.

**Синтаксис**

```sql
bitRotateLeft(a, N)
```

**Аргументы**

* `a` — значение для циклического сдвига. [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint)
* `N` — число позиций циклического сдвига влево. [`UInt8/16/32/64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает результат циклического сдвига того же типа, что и `a`. [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
SELECT 99 AS a, bin(a), bitRotateLeft(a, 2) AS a_rotated, bin(a_rotated);
```

```response title=Response
┌──a─┬─bin(a)───┬─a_rotated─┬─bin(a_rotated)─┐
│ 99 │ 01100011 │       141 │ 10001101       │
└────┴──────────┴───────────┴────────────────┘
```

## bitRotateRight {#bitRotateRight}

Добавлена в: v1.1

Циклически сдвигает биты вправо на заданное число позиций. Биты, которые выходят за пределы, появляются слева.

**Синтаксис**

```sql
bitRotateRight(a, N)
```

**Аргументы**

* `a` — значение для циклического сдвига. [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint)
* `N` — количество позиций, на которое выполняется циклический сдвиг вправо. [`UInt8/16/32/64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает значение после циклического сдвига того же типа, что и `a`. [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
SELECT 99 AS a, bin(a), bitRotateRight(a, 2) AS a_rotated, bin(a_rotated);
```

```response title=Response
┌──a─┬─bin(a)───┬─a_rotated─┬─bin(a_rotated)─┐
│ 99 │ 01100011 │       216 │ 11011000       │
└────┴──────────┴───────────┴────────────────┘
```

## bitShiftLeft {#bitShiftLeft}

Впервые появился в: v1.1

Выполняет сдвиг двоичного представления значения влево на заданное число битовых позиций.

`FixedString` или `String` рассматриваются как одно многобайтное значение.

Биты значения типа `FixedString` теряются по мере их выхода за пределы при сдвиге.
Напротив, значение типа `String` расширяется дополнительными байтами, поэтому биты не теряются.

**Синтаксис**

```sql
bitShiftLeft(a, N)
```

**Аргументы**

* `a` — Значение для сдвига. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`String`](/sql-reference/data-types/string) или [`FixedString`](/sql-reference/data-types/fixedstring)
* `N` — Количество позиций сдвига. [`UInt8/16/32/64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает сдвинутое значение с типом, совпадающим с типом `a`.

**Примеры**

**Пример использования с двоичным кодированием**

```sql title=Query
SELECT 99 AS a, bin(a), bitShiftLeft(a, 2) AS a_shifted, bin(a_shifted);
```

```response title=Response
┌──a─┬─bin(99)──┬─a_shifted─┬─bin(bitShiftLeft(99, 2))─┐
│ 99 │ 01100011 │       140 │ 10001100                 │
└────┴──────────┴───────────┴──────────────────────────┘
```

**Пример использования в шестнадцатеричном формате**

```sql title=Query
SELECT 'abc' AS a, hex(a), bitShiftLeft(a, 4) AS a_shifted, hex(a_shifted);
```

```response title=Response
┌─a───┬─hex('abc')─┬─a_shifted─┬─hex(bitShiftLeft('abc', 4))─┐
│ abc │ 616263     │ &0        │ 06162630                    │
└─────┴────────────┴───────────┴─────────────────────────────┘
```

**Пример использования с кодировкой FixedString**

```sql title=Query
SELECT toFixedString('abc', 3) AS a, hex(a), bitShiftLeft(a, 4) AS a_shifted, hex(a_shifted);
```

```response title=Response
┌─a───┬─hex(toFixedString('abc', 3))─┬─a_shifted─┬─hex(bitShiftLeft(toFixedString('abc', 3), 4))─┐
│ abc │ 616263                       │ &0        │ 162630                                        │
└─────┴──────────────────────────────┴───────────┴───────────────────────────────────────────────┘
```

## bitShiftRight {#bitShiftRight}

Введено в: v1.1

Сдвигает двоичное представление значения на указанное число бит вправо.

`FixedString` или `String` рассматривается как одно многобайтное значение.

Биты значения типа `FixedString` теряются по мере их смещения за пределы разрядной сетки.
Напротив, значение типа `String` дополняется дополнительными байтами, поэтому биты не теряются.

**Синтаксис**

```sql
bitShiftRight(a, N)
```

**Аргументы**

* `a` — Значение для сдвига. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`String`](/sql-reference/data-types/string) или [`FixedString`](/sql-reference/data-types/fixedstring)
* `N` — Количество позиций для сдвига. [`UInt8/16/32/64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает сдвинутое значение с тем же типом, что и у `a`.

**Примеры**

**Пример использования с двоичным кодированием**

```sql title=Query
SELECT 101 AS a, bin(a), bitShiftRight(a, 2) AS a_shifted, bin(a_shifted);
```

```response title=Response
┌───a─┬─bin(101)─┬─a_shifted─┬─bin(bitShiftRight(101, 2))─┐
│ 101 │ 01100101 │        25 │ 00011001                   │
└─────┴──────────┴───────────┴────────────────────────────┘
```

**Пример использования шестнадцатеричного кодирования**

```sql title=Query
SELECT 'abc' AS a, hex(a), bitShiftLeft(a, 4) AS a_shifted, hex(a_shifted);
```

```response title=Response
┌─a───┬─hex('abc')─┬─a_shifted─┬─hex(bitShiftRight('abc', 12))─┐
│ abc │ 616263     │           │ 0616                          │
└─────┴────────────┴───────────┴───────────────────────────────┘
```

**Пример использования с кодировкой FixedString**

```sql title=Query
SELECT toFixedString('abc', 3) AS a, hex(a), bitShiftRight(a, 12) AS a_shifted, hex(a_shifted);
```

```response title=Response
┌─a───┬─hex(toFixedString('abc', 3))─┬─a_shifted─┬─hex(bitShiftRight(toFixedString('abc', 3), 12))─┐
│ abc │ 616263                       │           │ 000616                                          │
└─────┴──────────────────────────────┴───────────┴─────────────────────────────────────────────────┘
```

## bitSlice {#bitSlice}

Добавлено в: v22.2

Возвращает подстроку бит длиной &#39;length&#39; бит, начиная с бита с индексом &#39;offset&#39;.

**Синтаксис**

```sql
bitSlice(s, offset[, length])
```

**Аргументы**

* `s` — Строка или фиксированная строка, из которой выполняется извлечение. [`String`](/sql-reference/data-types/string) или [`FixedString`](/sql-reference/data-types/fixedstring)
* `offset` —
  Начальная позиция бита (индексация с 1).
* Положительные значения: отсчет от начала строки.
* Отрицательные значения: отсчет от конца строки.

  [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)
* `length` —
  Необязательный параметр. Количество бит для извлечения.
* Положительные значения: извлекается `length` бит.
* Отрицательные значения: извлечение от смещения до `(string_length - |length|)`.
* Если параметр опущен: извлечение от смещения до конца строки.
* Если длина не делится на 8, результат дополняется нулями справа.
  [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает строку, содержащую извлеченные биты, представленные в виде бинарной последовательности. Результат всегда дополняется до границ байта (кратности 8 бит). [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT bin('Hello'), bin(bitSlice('Hello', 1, 8));
SELECT bin('Hello'), bin(bitSlice('Hello', 1, 2));
SELECT bin('Hello'), bin(bitSlice('Hello', 1, 9));
SELECT bin('Hello'), bin(bitSlice('Hello', -4, 8));
```

```response title=Response
┌─bin('Hello')─────────────────────────────┬─bin(bitSlice('Hello', 1, 8))─┐
│ 0100100001100101011011000110110001101111 │ 01001000                     │
└──────────────────────────────────────────┴──────────────────────────────┘
┌─bin('Hello')─────────────────────────────┬─bin(bitSlice('Hello', 1, 2))─┐
│ 0100100001100101011011000110110001101111 │ 01000000                     │
└──────────────────────────────────────────┴──────────────────────────────┘
┌─bin('Hello')─────────────────────────────┬─bin(bitSlice('Hello', 1, 9))─┐
│ 0100100001100101011011000110110001101111 │ 0100100000000000             │
└──────────────────────────────────────────┴──────────────────────────────┘
┌─bin('Hello')─────────────────────────────┬─bin(bitSlice('Hello', -4, 8))─┐
│ 0100100001100101011011000110110001101111 │ 11110000                      │
└──────────────────────────────────────────┴───────────────────────────────┘
```

## bitTest {#bitTest}

Добавлено в версии: v1.1

Принимает число и преобразует его в [двоичную форму](https://en.wikipedia.org/wiki/Binary_number), затем возвращает значение бита на заданной позиции. Подсчёт битов ведётся справа налево, начиная с 0.

**Синтаксис**

```sql
bitTest(a, i)
```

**Аргументы**

* `a` — число для преобразования. [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)
* `i` — позиция бита, который нужно вернуть. [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает значение бита на позиции `i` в двоичном представлении числа `a` типа [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
SELECT bin(2), bitTest(2, 1);
```

```response title=Response
┌─bin(2)───┬─bitTest(2, 1)─┐
│ 00000010 │             1 │
└──────────┴───────────────┘
```

## bitTestAll {#bitTestAll}

Впервые добавлена в: v1.1

Возвращает результат [логического И](https://en.wikipedia.org/wiki/Logical_conjunction) (оператор AND) всех битов в указанных позициях.
Подсчёт ведётся справа налево, начиная с 0.

Логическое И между двумя битами истинно тогда и только тогда, когда оба входных бита истинны.

**Синтаксис**

```sql
bitTestAll(a, index1[, index2, ... , indexN])
```

**Аргументы**

* `a` — Целочисленное значение. [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint)
* `index1, ...` — Одна или несколько позиций битов. [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает результат логической конъюнкции типа [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования 1**

```sql title=Query
SELECT bitTestAll(43, 0, 1, 3, 5);
```

```response title=Response
┌─bin(43)──┬─bitTestAll(43, 0, 1, 3, 5)─┐
│ 00101011 │                          1 │
└──────────┴────────────────────────────┘
```

**Пример использования № 2**

```sql title=Query
SELECT bitTestAll(43, 0, 1, 3, 5, 2);
```

```response title=Response
┌─bin(43)──┬─bitTestAll(4⋯1, 3, 5, 2)─┐
│ 00101011 │                        0 │
└──────────┴──────────────────────────┘
```

## bitTestAny {#bitTestAny}

Впервые появилась в версии v1.1

Возвращает результат [логического сложения](https://en.wikipedia.org/wiki/Logical_disjunction) (оператора ИЛИ) всех битов на заданных позициях в числе.
Подсчёт ведётся справа налево, начиная с 0.

Логическое ИЛИ между двумя битами истинно, если хотя бы один из входных битов истинен.

**Синтаксис**

```sql
bitTestAny(a, index1[, index2, ... , indexN])
```

**Аргументы**

* `a` — Целое число. [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint)
* `index1, ...` — Одна или несколько позиций бит. [`(U)Int8/16/32/64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает результат операции логического «ИЛИ» [`UInt8`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования 1**

```sql title=Query
SELECT bitTestAny(43, 0, 2);
```

```response title=Response
┌─bin(43)──┬─bitTestAny(43, 0, 2)─┐
│ 00101011 │                    1 │
└──────────┴──────────────────────┘
```

**Пример использования 2**

```sql title=Query
SELECT bitTestAny(43, 4, 2);
```

```response title=Response
┌─bin(43)──┬─bitTestAny(43, 4, 2)─┐
│ 00101011 │                    0 │
└──────────┴──────────────────────┘
```

## bitXor {#bitXor}

Добавлена в версии v1.1

Выполняет побитовую операцию исключающего ИЛИ (XOR) между двумя значениями.

**Синтаксис**

```sql
bitXor(a, b)
```

**Аргументы**

* `a` — первое значение. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)
* `b` — второе значение. [`(U)Int*`](/sql-reference/data-types/int-uint) или [`Float*`](/sql-reference/data-types/float)

**Возвращаемое значение**

Возвращает результат побитовой операции `a XOR b`.

**Примеры**

**Пример использования**

```sql title=Query
CREATE TABLE bits
(
    `a` UInt8,
    `b` UInt8
)
ENGINE = Memory;

INSERT INTO bits VALUES (0, 0), (0, 1), (1, 0), (1, 1);

SELECT
    a,
    b,
    bitXor(a, b)
FROM bits;
```

```response title=Response
┌─a─┬─b─┬─bitXor(a, b)─┐
│ 0 │ 0 │            0 │
│ 0 │ 1 │            1 │
│ 1 │ 0 │            1 │
│ 1 │ 1 │            0 │
└───┴───┴──────────────┘
```

{/*AUTOGENERATED_END*/ }
