---
description: 'Документация по функциям для работы с URL-адресами'
sidebar_label: 'URL-адреса'
slug: /sql-reference/functions/url-functions
title: 'Функции для работы с URL-адресами'
doc_type: 'reference'
---

# Функции для работы с URL-адресами \{#functions-for-working-with-urls\}

## Обзор \{#overview\}

:::note
Функции, упомянутые в этом разделе, оптимизированы для максимальной производительности и в большинстве случаев не следуют стандарту RFC-3986.
Функции, реализующие RFC-3986, имеют суффикс `RFC` в имени функции и, как правило, работают медленнее.
:::

Как правило, можно использовать варианты функций без суффикса `RFC` при работе с публично зарегистрированными доменами, которые не содержат пользовательских данных и символов `@`.
В таблице ниже показано, какие символы в URL могут (`✔`) или не могут (`✗`) быть разобраны соответствующими вариантами `RFC` и non-`RFC`:

| Symbol      | non-`RFC` | `RFC` |   |
| ----------- | --------- | ----- | - |
| &#39; &#39; | ✗         | ✗     |   |
| \t          | ✗         | ✗     |   |
| &lt;        | ✗         | ✗     |   |
| &gt;        | ✗         | ✗     |   |
| %           | ✗         | ✔*    |   |
| &#123;      | ✗         | ✗     |   |
| &#125;      | ✗         | ✗     |   |
|             |           | ✗     | ✗ |
| \           | ✗         | ✗     |   |
| ^           | ✗         | ✗     |   |
| ~           | ✗         | ✔*    |   |
| [           | ✗         | ✗     |   |
| ]           | ✗         | ✔     |   |
| ;           | ✗         | ✔*    |   |
| =           | ✗         | ✔*    |   |
| &amp;       | ✗         | ✔*    |   |

Символы, помеченные `*`, являются субделимитерами в RFC 3986 и допускаются для пользовательской информации, следующей за символом `@`.

Существует два типа функций для работы с URL:

* Функции, извлекающие части URL. Если соответствующая часть отсутствует в URL, возвращается пустая строка.
* Функции, удаляющие часть URL. Если соответствующая часть в URL отсутствует, URL остаётся неизменным.

:::note
Приведённые ниже функции генерируются из системной таблицы `system.functions`.
:::

{/* 
  При сборке фреймворка документации содержимое приведённых ниже тегов
  заменяется документацией, сгенерированной из system.functions. Пожалуйста, не изменяйте и не удаляйте эти теги.
  См.: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }

## URLHierarchy \{#URLHierarchy\}

Добавлено в: v1.1

Возвращает массив, содержащий URL, усечённый в конце по символам `/`, `?` и `#` в пути и строке запроса. Последовательные символы-разделители считаются за один. Результат включает протокол и хост в качестве первого элемента, а последующие элементы — всё более длинные пути, образующие иерархию.

**Синтаксис**

```sql
URLHierarchy(url)
```

**Аргументы**

* `url` — URL для обработки. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает массив URL всё большей длины, образующих иерархию. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT URLHierarchy('https://example.com/a/b?c=1')
```

```response title=Response
['https://example.com/','https://example.com/a/','https://example.com/a/b','https://example.com/a/b?c=1']
```

## URLPathHierarchy \{#URLPathHierarchy\}

Добавлена в: v1.1

Возвращает массив, содержащий компонент пути URL-адреса, усечённый по символам `/`, `?` и `#` в конце. В отличие от `URLHierarchy`, результат не включает протокол и хост — он начинается с пути. Идущие подряд разделители считаются одним.

**Синтаксис**

```sql
URLPathHierarchy(url)
```

**Аргументы**

* `url` — URL для обработки. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает массив всё более длинных компонентов пути URL-адреса, формирующих иерархию. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT URLPathHierarchy('https://example.com/a/b?c=1')
```

```response title=Response
['/a/','/a/b','/a/b?c=1']
```

## cutFragment \{#cutFragment\}

Добавлена в версии: v1.1

Удаляет идентификатор фрагмента, включая знак решётки (#), из URL-адреса.

**Синтаксис**

```sql
cutFragment(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает URL без идентификатора фрагмента. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT cutFragment('http://example.com/path?query=value#fragment123');
```

```response title=Response
┌─cutFragment('http://example.com/path?query=value#fragment123')─┐
│ http://example.com/path?query=value                            │
└────────────────────────────────────────────────────────────────┘
```

## cutQueryString \{#cutQueryString\}

Введена в: v1.1

Удаляет строку запроса, включая вопросительный знак, из URL-адреса.

**Синтаксис**

```sql
cutQueryString(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает URL без строки параметров запроса. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT cutQueryString('http://example.com/path?query=value&param=123#fragment');
```

```response title=Response
┌─cutQueryString('http://example.com/path?query=value&param=123#fragment')─┐
│ http://example.com/path#fragment                                         │
└──────────────────────────────────────────────────────────────────────────┘
```

## cutQueryStringAndFragment \{#cutQueryStringAndFragment\}

Появилась в версии v1.1

Удаляет строку запроса и идентификатор фрагмента, включая вопросительный знак и символ решётки, из URL.

**Синтаксис**

```sql
cutQueryStringAndFragment(url)
```

**Аргументы**

* `url` — URL-адрес. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает URL-адрес с удалёнными строкой запроса и идентификатором фрагмента. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT cutQueryStringAndFragment('http://example.com/path?query=value&param=123#fragment');
```

```response title=Response
┌─cutQueryStringAndFragment('http://example.com/path?query=value&param=123#fragment')─┐
│ http://example.com/path                                                             │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

## cutToFirstSignificantSubdomain \{#cutToFirstSignificantSubdomain\}

Добавлена в: v1.1

Возвращает часть доменного имени, включающую домен верхнего уровня и субдомены вплоть до [первого значимого субдомена](/sql-reference/functions/url-functions#firstSignificantSubdomain).

**Синтаксис**

```sql
cutToFirstSignificantSubdomain(url)
```

**Аргументы**

* `url` — URL или строка домена для обработки. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает часть домена, которая включает верхние поддомены до первого значимого поддомена, если это возможно, иначе возвращает пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT
    cutToFirstSignificantSubdomain('https://news.clickhouse.com.tr/'),
    cutToFirstSignificantSubdomain('www.tr'),
    cutToFirstSignificantSubdomain('tr');
```

```response title=Response
┌─cutToFirstSignificantSubdomain('https://news.clickhouse.com.tr/')─┬─cutToFirstSignificantSubdomain('www.tr')─┬─cutToFirstSignificantSubdomain('tr')─┐
│ clickhouse.com.tr                                                 │ tr                                       │                                      │
└───────────────────────────────────────────────────────────────────┴──────────────────────────────────────────┴──────────────────────────────────────┘
```

## cutToFirstSignificantSubdomainCustom \{#cutToFirstSignificantSubdomainCustom\}

Впервые появилась в: v21.1

Возвращает часть доменного имени, включающую домены верхнего уровня вплоть до первого значимого поддомена. Принимает имя пользовательского списка [TLD](https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains). Эта функция может быть полезна, если вам нужен обновлённый список TLD или у вас есть собственный список.

**Пример конфигурации**

```yaml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>
```

**Синтаксис**

```sql
cutToFirstSignificantSubdomainCustom(url, tld_list_name)
```

**Аргументы**

* `url` — URL или строка с доменным именем для обработки. [`String`](/sql-reference/data-types/string)
* `tld_list_name` — имя пользовательского списка TLD, настроенного в ClickHouse. [`const String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает часть доменного имени, которая включает верхнеуровневые поддомены вплоть до первого значимого поддомена. [`String`](/sql-reference/data-types/string)

**Примеры**

**Использование пользовательского списка TLD для нестандартных доменных имён**

```sql title=Query
SELECT cutToFirstSignificantSubdomainCustom('bar.foo.there-is-no-such-domain', 'public_suffix_list')
```

```response title=Response
foo.there-is-no-such-domain
```

## cutToFirstSignificantSubdomainCustomRFC \{#cutToFirstSignificantSubdomainCustomRFC\}

Добавлена в версии: v22.10

Возвращает часть домена, включающую домены верхнего уровня до первого значимого поддомена.
Принимает наименование пользовательского списка доменов верхнего уровня (TLD): [TLD list](https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains).
Эта функция может быть полезна, если вам нужен свежий список TLD или если у вас есть собственный список.
Аналогична [cutToFirstSignificantSubdomainCustom](#cutToFirstSignificantSubdomainCustom), но соответствует RFC 3986.

**Пример конфигурации**

```xml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>
```

**Синтаксис**

```sql
cutToFirstSignificantSubdomainCustomRFC(url, tld_list_name)
```

**Аргументы**

* `url` — URL или строка домена для обработки в соответствии с RFC 3986.
* `tld_list_name` — имя пользовательского списка TLD, настроенного в ClickHouse.

**Возвращаемое значение**

Возвращает часть доменного имени, которая включает поддомены верхнего уровня до первого значимого поддомена. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT cutToFirstSignificantSubdomainCustomRFC('www.foo', 'public_suffix_list');
```

```response title=Response
┌─cutToFirstSignificantSubdomainCustomRFC('www.foo', 'public_suffix_list')─────┐
│ www.foo                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘
```

## cutToFirstSignificantSubdomainCustomWithWWW \{#cutToFirstSignificantSubdomainCustomWithWWW\}

Появилась в версии: v21.1

Возвращает часть доменного имени, включающую домены верхнего уровня до первого значимого поддомена, при этом префикс &#39;www&#39; не удаляется. Принимает имя пользовательского списка TLD. Может быть полезно, если вам нужен актуальный список TLD или у вас есть собственный список.

**Пример конфигурации**

````yaml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>
    

**Syntax**

```sql
cutToFirstSignificantSubdomainCustomWithWWW(url, tld_list_name)
````

**Аргументы**

* `url` — URL или строка с доменом для обработки. - `tld_list_name` — имя пользовательского списка TLD, настроенного в ClickHouse.

**Возвращаемое значение**

Часть доменного имени, включающая поддомены верхнего уровня вплоть до первого значимого поддомена, без удаления &#39;www&#39;. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT cutToFirstSignificantSubdomainCustomWithWWW('www.foo', 'public_suffix_list');
```

```response title=Response
┌─cutToFirstSignificantSubdomainCustomWithWWW('www.foo', 'public_suffix_list')─┐
│ www.foo                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘
```

## cutToFirstSignificantSubdomainCustomWithWWWRFC \{#cutToFirstSignificantSubdomainRFC\}

Добавлена в версии: v22.10

Возвращает часть домена, которая включает верхнеуровневые субдомены до первого значимого субдомена, не удаляя `www`.
Принимает имя пользовательского списка TLD.
Это может быть полезно, если вам нужен обновлённый список TLD или у вас есть собственный список.
Похожа на [cutToFirstSignificantSubdomainCustomWithWWW](#cutToFirstSignificantSubdomainCustomWithWWW), но соответствует [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Пример конфигурации**

````xml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>
    

**Syntax**

```sql
cutToFirstSignificantSubdomainCustomWithWWWRFC(url, tld_list_name)
````

**Аргументы**

* `url` — URL или строка доменного имени для обработки в соответствии с RFC 3986. - `tld_list_name` — имя пользовательского списка доменов верхнего уровня (TLD), настроенного в ClickHouse.

**Возвращаемое значение**

Возвращает часть имени домена, которая включает домены верхнего уровня и поддомены вплоть до первого значимого поддомена, при этом `www` не удаляется. [`String`](/sql-reference/data-types/string)

**Примеры**

**Разбор по RFC 3986 с сохранением www и пользовательским списком TLD**

```sql title=Query
SELECT cutToFirstSignificantSubdomainCustomWithWWWRFC('https://www.subdomain.example.custom', 'public_suffix_list')
```

```response title=Response
www.example.custom
```

## cutToFirstSignificantSubdomainRFC \{#cutToFirstSignificantSubdomainWithWWW\}

Добавлена в: v22.10

Возвращает часть доменного имени, которая включает поддомены верхнего уровня до [«первого значимого поддомена»](/sql-reference/functions/url-functions#firstSignificantSubdomain). Аналогична [`cutToFirstSignificantSubdomain`](#cutToFirstSignificantSubdomain), но соответствует [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
cutToFirstSignificantSubdomainRFC(url)
```

**Аргументы**

* `url` — URL или строка с доменом для обработки в соответствии с RFC 3986. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает часть домена, которая включает поддомены верхнего уровня до первого значимого поддомена, если это возможно, в противном случае возвращает пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT
    cutToFirstSignificantSubdomain('http://user:password@example.com:8080'),
    cutToFirstSignificantSubdomainRFC('http://user:password@example.com:8080');
```

```response title=Response
┌─cutToFirstSignificantSubdomain('http://user:password@example.com:8080')─┬─cutToFirstSignificantSubdomainRFC('http://user:password@example.com:8080')─┐
│                                                                         │ example.com                                                                │
└─────────────────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────────┘
```

## cutToFirstSignificantSubdomainWithWWW \{#cutToFirstSignificantSubdomainWithWWWRFC\}

Добавлена в версии: v20.12

Возвращает часть доменного имени, включающую домен верхнего уровня и поддомены до «первого значимого поддомена», при этом префикс &#39;www.&#39; не удаляется.

Аналогично [`cutToFirstSignificantSubdomain`](#cutToFirstSignificantSubdomain), но сохраняет префикс &#39;www.&#39;, если он присутствует.

**Синтаксис**

```sql
cutToFirstSignificantSubdomainWithWWW(url)
```

**Аргументы**

* `url` — URL или строка с доменным именем для обработки. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает часть домена, которая включает поддомены верхнего уровня вплоть до первого значимого поддомена (включая www), если это возможно, в противном случае — пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT
    cutToFirstSignificantSubdomainWithWWW('https://news.clickhouse.com.tr/'),
    cutToFirstSignificantSubdomainWithWWW('www.tr'),
    cutToFirstSignificantSubdomainWithWWW('tr');
```

```response title=Response
┌─cutToFirstSignificantSubdomainWithWWW('https://news.clickhouse.com.tr/')─┬─cutToFirstSignificantSubdomainWithWWW('www.tr')─┬─cutToFirstSignificantSubdomainWithWWW('tr')─┐
│ clickhouse.com.tr                                                        │ www.tr                                          │                                             │
└──────────────────────────────────────────────────────────────────────────┴─────────────────────────────────────────────────┴─────────────────────────────────────────────┘
```

## cutToFirstSignificantSubdomainWithWWWRFC \{#cutURLParameter\}

Появилась в: v22.10

Возвращает часть доменного имени, включающую поддомены верхнего уровня вплоть до «первого значимого поддомена», без удаления `www`. Аналогична [`cutToFirstSignificantSubdomainWithWWW`](#cutToFirstSignificantSubdomainWithWWW), но соответствует [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
cutToFirstSignificantSubdomainWithWWWRFC(url)
```

**Аргументы**

* `url` — строка с URL-адресом или доменным именем для обработки в соответствии с RFC 3986.

**Возвращаемое значение**

Возвращает часть домена, которая включает верхние поддомены до первого значимого поддомена (с «www», если возможно), в противном случае возвращает пустую строку [`String`](/sql-reference/data-types/string).

**Примеры**

**Пример использования**

```sql title=Query
SELECT
    cutToFirstSignificantSubdomainWithWWW('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy'),
    cutToFirstSignificantSubdomainWithWWWRFC('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy');
```

```response title=Response
┌─cutToFirstSignificantSubdomainWithWWW('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy')─┬─cutToFirstSignificantSubdomainWithWWWRFC('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy')─┐
│                                                                                       │ mail.ru                                                                                  │
└───────────────────────────────────────────────────────────────────────────────────────┴──────────────────────────────────────────────────────────────────────────────────────────┘
```

## cutURLParameter \{#cutWWW\}

Впервые появилась в версии: v1.1

Удаляет параметр `name` из URL, если он присутствует.
Эта функция не кодирует и не декодирует символы в именах параметров, например, `Client ID` и `Client%20ID` рассматриваются как разные имена параметров.

**Синтаксис**

```sql
cutURLParameter(url, name)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)
* `name` — Имя параметра URL. [`String`](/sql-reference/data-types/string) или [`Array(String)`](/sql-reference/data-types/array)

**Возвращаемое значение**

URL, из которого удалён параметр `name`. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT
    cutURLParameter('http://bigmir.net/?a=b&c=d&e=f#g', 'a') AS url_without_a,
    cutURLParameter('http://bigmir.net/?a=b&c=d&e=f#g', ['c', 'e']) AS url_without_c_and_e;
```

```response title=Response
┌─url_without_a────────────────┬─url_without_c_and_e──────┐
│ http://bigmir.net/?c=d&e=f#g │ http://bigmir.net/?a=b#g │
└──────────────────────────────┴──────────────────────────┘
```

## cutWWW \{#decodeURLComponent\}

Добавлен в версии v1.1

Удаляет начальное `www.` из доменного имени URL-адреса, если оно присутствует.

**Синтаксис**

```sql
cutWWW(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает URL с удалённым начальным `www.` в домене. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT cutWWW('http://www.example.com/path?query=value#fragment');
```

```response title=Response
┌─cutWWW('http://www.example.com/path?query=value#fragment')─┐
│ http://example.com/path?query=value#fragment               │
└────────────────────────────────────────────────────────────┘
```

## decodeURLComponent \{#decodeURLFormComponent\}

Добавлено в версии v1.1

Принимает URL-кодированную строку на вход и декодирует её в исходное, человекочитаемое представление.

**Синтаксис**

```sql
decodeURLComponent(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает декодированный URL. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT decodeURLComponent('http://127.0.0.1:8123/?query=SELECT%201%3B') AS DecodedURL;
```

```response title=Response
┌─DecodedURL─────────────────────────────┐
│ http://127.0.0.1:8123/?query=SELECT 1; │
└────────────────────────────────────────┘
```

## decodeURLFormComponent \{#domain\}

Впервые добавлена в v1.1

Декодирует URL-кодированные строки по правилам кодирования веб-форм ([RFC-1866](https://www.rfc-editor.org/rfc/rfc1866.html)), при которых знаки `+` преобразуются в пробелы, а процент-кодированные символы декодируются.

**Синтаксис**

```sql
decodeURLFormComponent(url)
```

**Аргументы**

* `url` — URL-адрес. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает декодированный URL-адрес. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT decodeURLFormComponent('http://127.0.0.1:8123/?query=SELECT%201+2%2B3') AS DecodedURL;
```

```response title=Response
┌─DecodedURL────────────────────────────────┐
│ http://127.0.0.1:8123/?query=SELECT 1 2+3 │
└───────────────────────────────────────────┘
```

## domain \{#domainRFC\}

Добавлена в версии v1.1

Извлекает имя хоста из URL-адреса.

URL-адрес может быть указан с протоколом или без него.

**Синтаксис**

```sql
domain(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает имя хоста, если входная строка может быть интерпретирована как URL, в противном случае — пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT domain('svn+ssh://some.svn-hosting.com:80/repo/trunk');
```

```response title=Response
┌─domain('svn+ssh://some.svn-hosting.com:80/repo/trunk')─┐
│ some.svn-hosting.com                                   │
└────────────────────────────────────────────────────────┘
```

## domainRFC \{#domainWithoutWWW\}

Введена в версии v22.10

Извлекает имя хоста из URL.
Аналогична функции [`domain`](#domain), но соответствует [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
domainRFC(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает имя хоста, если входную строку удаётся интерпретировать как URL, в противном случае — пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT
    domain('http://user:password@example.com:8080/path?query=value#fragment'),
    domainRFC('http://user:password@example.com:8080/path?query=value#fragment');
```

```response title=Response
┌─domain('http://user:password@example.com:8080/path?query=value#fragment')─┬─domainRFC('http://user:password@example.com:8080/path?query=value#fragment')─┐
│                                                                           │ example.com                                                                  │
└───────────────────────────────────────────────────────────────────────────┴──────────────────────────────────────────────────────────────────────────────┘
```

## domainWithoutWWW \{#domainWithoutWWWRFC\}

Появилась в версии: v1.1

Возвращает домен URL-адреса без ведущего `www.`, если он присутствует.

**Синтаксис**

```sql
domainWithoutWWW(url)
```

**Аргументы**

* `url` — URL-адрес. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает имя домена, если входная строка может быть интерпретирована как URL-адрес (без ведущего `www.`), в противном случае — пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT domainWithoutWWW('http://paul@www.example.com:80/');
```

```response title=Response
┌─domainWithoutWWW('http://paul@www.example.com:80/')─┐
│ example.com                                         │
└─────────────────────────────────────────────────────┘
```

## domainWithoutWWWRFC \{#encodeURLComponent\}

Добавлена в: v1.1

Возвращает домен без начального `www.`, если оно присутствует. Аналогична [`domainWithoutWWW`](#domainWithoutWWW), но соответствует [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
domainWithoutWWWRFC(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает имя домена, если входную строку можно интерпретировать как URL (без начального `www.`), в противном случае — пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT
    domainWithoutWWW('http://user:password@www.example.com:8080/path?query=value#fragment'),
    domainWithoutWWWRFC('http://user:password@www.example.com:8080/path?query=value#fragment');
```

```response title=Response
┌─domainWithoutWWW('http://user:password@www.example.com:8080/path?query=value#fragment')─┬─domainWithoutWWWRFC('http://user:password@www.example.com:8080/path?query=value#fragment')─┐
│                                                                                         │ example.com                                                                                │
└─────────────────────────────────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────────────────────────┘
```

## encodeURLComponent \{#encodeURLFormComponent\}

Введена в версии: v22.3

Принимает обычную строку и преобразует её в URL-кодированный формат (percent-encoding), в котором специальные символы заменяются их процентно-кодированными эквивалентами.

**Синтаксис**

```sql
encodeURLComponent(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает закодированный URL. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT encodeURLComponent('http://127.0.0.1:8123/?query=SELECT 1;') AS EncodedURL;
```

```response title=Response
┌─EncodedURL───────────────────────────────────────────────┐
│ http%3A%2F%2F127.0.0.1%3A8123%2F%3Fquery%3DSELECT%201%3B │
└──────────────────────────────────────────────────────────┘
```

## encodeURLFormComponent \{#extractURLParameter\}

Добавлена в: v22.3

Кодирует строки по правилам кодирования данных HTML-форм ([RFC-1866](https://www.rfc-editor.org/rfc/rfc1866.html)), при которых пробелы заменяются на символ «+», а специальные символы кодируются с использованием процентного кодирования.

**Синтаксис**

```sql
encodeURLFormComponent(url)
```

**Аргументы**

* `url` — URL-адрес. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает закодированный URL-адрес. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT encodeURLFormComponent('http://127.0.0.1:8123/?query=SELECT 1 2+3') AS EncodedURL;
```

```response title=Response
┌─EncodedURL────────────────────────────────────────────────┐
│ http%3A%2F%2F127.0.0.1%3A8123%2F%3Fquery%3DSELECT+1+2%2B3 │
└───────────────────────────────────────────────────────────┘
```

## extractURLParameter \{#extractURLParameterNames\}

Введена в версии: v1.1

Возвращает значение параметра `name` в URL, если он присутствует; в противном случае возвращается пустая строка.
Если существует несколько параметров с этим именем, возвращается первое вхождение.
Функция предполагает, что значение параметра в аргументе `url` закодировано тем же способом, что и аргумент `name`.

**Синтаксис**

```sql
extractURLParameter(url, name)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)
* `name` — имя параметра. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает значение параметра URL с указанным именем. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT extractURLParameter('http://example.com/?param1=value1&param2=value2', 'param1');
```

```response title=Response
┌─extractURLPa⋯, 'param1')─┐
│ value1                   │
└──────────────────────────┘
```

## extractURLParameterNames \{#extractURLParameters\}

Появилась в версии: v1.1

Возвращает массив строк, содержащий имена параметров URL.
Значения не декодируются.

**Синтаксис**

```sql
extractURLParameterNames(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает массив строк — имён параметров URL. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Query
SELECT extractURLParameterNames('http://example.com/?param1=value1&param2=value2');
```

```response title=Response
┌─extractURLPa⋯m2=value2')─┐
│ ['param1','param2']      │
└──────────────────────────┘
```

## extractURLParameters \{#firstSignificantSubdomain\}

Появилась в версии: v1.1

Возвращает массив строк вида `name=value`, соответствующих URL-параметрам.
Значения не декодируются.

**Синтаксис**

```sql
extractURLParameters(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает массив строк формата `name=value`, соответствующих параметрам URL. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Query
SELECT extractURLParameters('http://example.com/?param1=value1&param2=value2');
```

```response title=Response
┌─extractURLParame⋯&param2=value2')─┐
│ ['param1=value1','param2=value2'] │
└───────────────────────────────────┘
```

## firstSignificantSubdomain \{#firstSignificantSubdomainCustom\}

Появилась в версии: v1.1

Возвращает «первый значимый поддомен».

Первым значимым поддоменом является домен второго уровня, если это &#39;com&#39;, &#39;net&#39;, &#39;org&#39; или &#39;co&#39;.
В противном случае это домен третьего уровня.

Например, firstSignificantSubdomain(&#39;https://news.clickhouse.com/&#39;) = &#39;clickhouse&#39;, firstSignificantSubdomain (&#39;https://news.clickhouse.com.tr/&#39;) = &#39;clickhouse&#39;.

Список «незначительных» доменов второго уровня и другие детали реализации могут измениться в будущем.

**Синтаксис**

```sql
```

**Аргументы**

* Отсутствуют.

**Возвращаемое значение**

**Примеры**

**firstSignificantSubdomain**

```sql title=Query
SELECT firstSignificantSubdomain('https://news.clickhouse.com/')
```

```response title=Response
```

## firstSignificantSubdomainCustom \{#firstSignificantSubdomainCustomRFC\}

Введена в версии v21.1

Возвращает первый значимый поддомен URL на основе пользовательского списка TLD (Top-Level Domain). Имя пользовательского списка TLD соответствует конфигурации, которая определяет, какие суффиксы доменов следует считать доменами верхнего уровня. Это полезно для нестандартных иерархий доменов верхнего уровня. Функция использует упрощённый алгоритм разбора URL, который предполагает, что протокол и всё следующее за ним уже удалены.

**Синтаксис**

```sql
firstSignificantSubdomainCustom(url, tld_list_name)
```

**Аргументы**

* `url` — URL-адрес, из которого нужно извлечь поддомен. [`String`](/sql-reference/data-types/string)
* `tld_list_name` — имя настраиваемого списка TLD из конфигурации. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает первый значимый поддомен. [`String`](/sql-reference/data-types/string)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT firstSignificantSubdomainCustom('https://news.example.com', 'public_suffix_list')
```

```response title=Response
example
```

## firstSignificantSubdomainCustomRFC \{#firstSignificantSubdomainRFC\}

Добавлена в версии v22.10

Похожа на `firstSignificantSubdomainCustom`, но использует разбор URL в соответствии с RFC 3986 вместо упрощённого алгоритма.

**Синтаксис**

```sql
firstSignificantSubdomainCustomRFC(url, tld_list_name)
```

**Аргументы**

* `url` — URL-адрес, из которого извлекается поддомен. [`String`](/sql-reference/data-types/string)
* `tld_list_name` — имя пользовательского списка TLD из конфигурации. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает первый значимый поддомен. [`String`](/sql-reference/data-types/string)

**Примеры**

**Базовое использование**

```sql title=Query
SELECT firstSignificantSubdomainCustomRFC('https://news.example.com', 'public_suffix_list')
```

```response title=Response
example
```

## firstSignificantSubdomainRFC \{#fragment\}

Введена в версии: v22.10

Возвращает «первый значимый поддомен» в соответствии с RFC 1034.

**Синтаксис**

```sql
```

**Аргументы**

* Нет.

**Возвращаемое значение**

**Примеры**

## fragment \{#netloc\}

Добавлено в версии v1.1

Возвращает идентификатор фрагмента без начального символа `#`.

**Синтаксис**

```sql
fragment(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает идентификатор фрагмента без начального символа `#`. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT fragment('https://clickhouse.com/docs/getting-started/quick-start/cloud#1-create-a-clickhouse-service');
```

```response title=Response
┌─fragment('http⋯ouse-service')─┐
│ 1-create-a-clickhouse-service │
└───────────────────────────────┘
```

## netloc \{#path\}

Добавлено в: v20.5

Извлекает сетевую часть (`username:password@host:port`) из URL.

**Синтаксис**

```sql
netloc(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает `username:password@host:port` из указанного URL. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT netloc('http://paul@www.example.com:80/');
```

```response title=Response
┌─netloc('http⋯e.com:80/')─┐
│ paul@www.example.com:80  │
└──────────────────────────┘
```

## path \{#pathFull\}

Введено в версии: v1.1

Возвращает путь URL-адреса без строки запроса.

**Синтаксис**

```sql
path(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает путь URL-адреса без строки запроса. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT path('https://clickhouse.com/docs/sql-reference/functions/url-functions/?query=value');
```

```response title=Response
┌─path('https://clickhouse.com/en/sql-reference/functions/url-functions/?query=value')─┐
│ /docs/sql-reference/functions/url-functions/                                         │
└──────────────────────────────────────────────────────────────────────────────────────┘
```

## pathFull \{#port\}

Добавлена в версии: v1.1

То же, что и [`path`](#path), но включает строку запроса и фрагмент URL-адреса.

**Синтаксис**

```sql
pathFull(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает путь URL-адреса, включая строку запроса и фрагмент. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT pathFull('https://clickhouse.com/docs/sql-reference/functions/url-functions/?query=value#section');
```

```response title=Response
┌─pathFull('https://clickhouse.com⋯unctions/?query=value#section')─┐
│ /docs/sql-reference/functions/url-functions/?query=value#section │
└──────────────────────────────────────────────────────────────────┘
```

## port \{#portRFC\}

Введена в версии: v20.5

Возвращает порт URL-адреса или `default_port`, если в URL-адресе порт не указан или URL-адрес не удаётся разобрать.

**Синтаксис**

```sql
port(url[, default_port])
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)
* `default_port` — Необязательный параметр. Номер порта по умолчанию, который будет возвращён. По умолчанию `0`. [`UInt16`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает порт URL или порт по умолчанию, если порт не указан в URL либо в случае ошибки валидации. [`UInt16`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
SELECT port('https://clickhouse.com:8443/docs'), port('https://clickhouse.com/docs', 443);
```

```response title=Response
┌─port('https://clickhouse.com:8443/docs')─┬─port('https://clickhouse.com/docs', 443)─┐
│                                     8443 │                                      443 │
└──────────────────────────────────────────┴──────────────────────────────────────────┘
```

## portRFC \{#protocol\}

Введена в версии v22.10

Возвращает порт или `default_port`, если URL не содержит порта или не может быть разобран.
Аналогична [`port`](#port), но соответствует [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
portRFC(url[, default_port])
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)
* `default_port` — необязательный параметр. Номер порта, возвращаемый по умолчанию. По умолчанию — `0`. [`UInt16`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает порт или порт по умолчанию, если в URL не указан порт или в случае ошибки валидации. [`UInt16`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
SELECT port('http://user:password@example.com:8080/'), portRFC('http://user:password@example.com:8080/');
```

```response title=Response
┌─port('http:/⋯com:8080/')─┬─portRFC('htt⋯com:8080/')─┐
│                        0 │                     8080 │
└──────────────────────────┴──────────────────────────┘
```

## protocol \{#queryString\}

Добавлено в версии: v1.1

Извлекает протокол из URL.

Примеры типичных значений, возвращаемых функцией: http, https, ftp, mailto, tel, magnet.

**Синтаксис**

```sql
protocol(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает протокол URL-адреса или пустую строку, если его не удаётся определить. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT protocol('https://clickhouse.com/');
```

```response title=Response
┌─protocol('https://clickhouse.com/')─┐
│ https                               │
└─────────────────────────────────────┘
```

## queryString \{#queryStringAndFragment\}

Добавлено в: v1.1

Возвращает строку запроса URL без начального знака вопроса, `#` и всего, что следует после `#`.

**Синтаксис**

```sql
queryString(url)
```

**Аргументы**

* `url` — URL-адрес. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает строку запроса из URL-адреса без начального знака вопроса и фрагмента. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT queryString('https://clickhouse.com/docs?query=value&param=123#section');
```

```response title=Response
┌─queryString(⋯3#section')─┐
│ query=value&param=123    │
└──────────────────────────┘
```

## queryStringAndFragment \{#topLevelDomain\}

Добавлена в версии: v1.1

Возвращает строку запроса и идентификатор фрагмента URL.

**Синтаксис**

```sql
queryStringAndFragment(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает строку запроса и идентификатор фрагмента URL-адреса. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT queryStringAndFragment('https://clickhouse.com/docs?query=value&param=123#section');
```

```response title=Response
┌─queryStringAnd⋯=123#section')─┐
│ query=value&param=123#section │
└───────────────────────────────┘
```

## topLevelDomain \{#topLevelDomainRFC\}

Добавлена в: v1.1

Извлекает домен верхнего уровня из URL-адреса.

:::note
URL-адрес может быть указан с протоколом или без него.
Например:

```text
svn+ssh://some.svn-hosting.com:80/repo/trunk
some.svn-hosting.com:80/repo/trunk
https://clickhouse.com/time/
```

:::

**Синтаксис**

```sql
topLevelDomain(url)
```

**Аргументы**

* `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает доменное имя, если входная строка может быть интерпретирована как URL. В противном случае — пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT topLevelDomain('svn+ssh://www.some.svn-hosting.com:80/repo/trunk');
```

```response title=Response
┌─topLevelDomain('svn+ssh://www.some.svn-hosting.com:80/repo/trunk')─┐
│ com                                                                │
└────────────────────────────────────────────────────────────────────┘
```

## topLevelDomainRFC

Введена в: v22.10

Извлекает домен верхнего уровня из URL-адреса.
Аналогична функции [`topLevelDomain`](#topLevelDomain), но соответствует [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
topLevelDomainRFC(url)
```

**Аргументы**

* `url` — URL-адрес. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Имя домена, если входная строка может быть интерпретирована как URL-адрес. В противном случае — пустая строка. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT topLevelDomain('http://foo:foo%41bar@foo.com'), topLevelDomainRFC('http://foo:foo%41bar@foo.com');
```

```response title=Response
┌─topLevelDomain('http://foo:foo%41bar@foo.com')─┬─topLevelDomainRFC('http://foo:foo%41bar@foo.com')─┐
│                                                │ com                                               │
└────────────────────────────────────────────────┴───────────────────────────────────────────────────┘
```

{/*AUTOGENERATED_END*/ }
