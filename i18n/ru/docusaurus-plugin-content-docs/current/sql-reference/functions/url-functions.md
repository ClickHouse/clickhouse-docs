---
description: 'Документация по функциям для работы с URL'
sidebar_label: 'URL'
slug: /sql-reference/functions/url-functions
title: 'Функции для работы с URL'
doc_type: 'reference'
---



# Функции для работы с URL-адресами



## Overview {#overview}

:::note
Функции, описанные в этом разделе, оптимизированы для максимальной производительности и в большинстве случаев не соответствуют стандарту RFC-3986.
Функции, реализующие RFC-3986, имеют суффикс `RFC` в названии и, как правило, работают медленнее.
:::

Варианты функций без `RFC` можно использовать при работе с публично зарегистрированными доменами, не содержащими пользовательских строк и символов `@`.
В таблице ниже указано, какие символы в URL могут (`✔`) или не могут (`✗`) быть обработаны соответствующими вариантами с `RFC` и без `RFC`:

| Символ | без `RFC` | `RFC` |
| ------ | --------- | ----- |
| ' '    | ✗         | ✗     |
| \t     | ✗         | ✗     |
| &lt;   | ✗         | ✗     |
| >      | ✗         | ✗     |
| %      | ✗         | ✔\*  |
| \{     | ✗         | ✗     |
| }      | ✗         | ✗     |
| \|     | ✗         | ✗     |
| \\\    | ✗         | ✗     |
| ^      | ✗         | ✗     |
| ~      | ✗         | ✔\*  |
| [      | ✗         | ✗     |
| ]      | ✗         | ✔    |
| ;      | ✗         | ✔\*  |
| =      | ✗         | ✔\*  |
| &      | ✗         | ✔\*  |

Символы, отмеченные `*`, являются подразделителями в RFC 3986 и допустимы в пользовательской информации после символа `@`.

Существует два типа функций для работы с URL:

- Функции, извлекающие части URL. Если соответствующая часть отсутствует в URL, возвращается пустая строка.
- Функции, удаляющие часть URL. Если в URL отсутствует соответствующая часть, URL остается без изменений.

:::note
Функции ниже генерируются из системной таблицы `system.functions`.
:::

<!--
The inner content of the tags below are replaced at doc framework build time with
docs generated from system.functions. Please do not modify or remove the tags.
See: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
-->


<!--AUTOGENERATED_START-->

## cutFragment {#cutFragment}

Введена в версии: v1.1

Удаляет идентификатор фрагмента, включая символ решётки (#), из URL.

**Синтаксис**

```sql
cutFragment(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает URL с удалённым идентификатором фрагмента. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT cutFragment('http://example.com/path?query=value#fragment123');
```

```response title=Результат
┌─cutFragment('http://example.com/path?query=value#fragment123')─┐
│ http://example.com/path?query=value                            │
└────────────────────────────────────────────────────────────────┘
```


## cutQueryString {#cutQueryString}

Введена в версии: v1.1

Удаляет строку запроса из URL, включая знак вопроса.

**Синтаксис**

```sql
cutQueryString(url)
```

**Аргументы**

- `url` — URL-адрес. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает URL-адрес с удалённой строкой запроса. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT cutQueryString('http://example.com/path?query=value&param=123#fragment');
```

```response title=Ответ
┌─cutQueryString('http://example.com/path?query=value&param=123#fragment')─┐
│ http://example.com/path#fragment                                         │
└──────────────────────────────────────────────────────────────────────────┘
```


## cutQueryStringAndFragment {#cutQueryStringAndFragment}

Добавлена в версии: v1.1

Удаляет строку запроса и идентификатор фрагмента из URL, включая знак вопроса и решётку.

**Синтаксис**

```sql
cutQueryStringAndFragment(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает URL без строки запроса и идентификатора фрагмента. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT cutQueryStringAndFragment('http://example.com/path?query=value&param=123#fragment');
```

```response title=Response
┌─cutQueryStringAndFragment('http://example.com/path?query=value&param=123#fragment')─┐
│ http://example.com/path                                                             │
└─────────────────────────────────────────────────────────────────────────────────────┘
```


## cutToFirstSignificantSubdomain {#cutToFirstSignificantSubdomain}

Введена в версии: v1.1

Возвращает часть домена, включающую поддомены верхнего уровня до [первого значимого поддомена](/sql-reference/functions/url-functions#firstSignificantSubdomain).

**Синтаксис**

```sql
cutToFirstSignificantSubdomain(url)
```

**Аргументы**

- `url` — URL или строка домена для обработки. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает часть домена, включающую поддомены верхнего уровня до первого значимого поддомена, если это возможно, в противном случае возвращает пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT
    cutToFirstSignificantSubdomain('https://news.clickhouse.com.tr/'),
    cutToFirstSignificantSubdomain('www.tr'),
    cutToFirstSignificantSubdomain('tr');
```

```response title=Результат
┌─cutToFirstSignificantSubdomain('https://news.clickhouse.com.tr/')─┬─cutToFirstSignificantSubdomain('www.tr')─┬─cutToFirstSignificantSubdomain('tr')─┐
│ clickhouse.com.tr                                                 │ tr                                       │                                      │
└───────────────────────────────────────────────────────────────────┴──────────────────────────────────────────┴──────────────────────────────────────┘
```


## cutToFirstSignificantSubdomainCustom {#cutToFirstSignificantSubdomainCustom}

Введена в версии: v21.1

Возвращает часть домена, включающую домены верхнего уровня вплоть до первого значимого поддомена. Принимает имя пользовательского [списка TLD](https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains). Эта функция может быть полезна, если требуется актуальный список TLD или используется пользовательский список.

**Пример конфигурации**

```yaml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>
```

**Синтаксис**

```sql
cutToFirstSignificantSubdomainCustom(url, tld_list_name)
```

**Аргументы**

- `url` — URL или строка домена для обработки. [`String`](/sql-reference/data-types/string)
- `tld_list_name` — Имя пользовательского списка TLD, настроенного в ClickHouse. [`const String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает часть домена, включающую домены верхнего уровня вплоть до первого значимого поддомена. [`String`](/sql-reference/data-types/string)

**Примеры**

**Использование пользовательского списка TLD для нестандартных доменов**

```sql title=Запрос
SELECT cutToFirstSignificantSubdomainCustom('bar.foo.there-is-no-such-domain', 'public_suffix_list')
```

```response title=Ответ
foo.there-is-no-such-domain
```


## cutToFirstSignificantSubdomainCustomRFC {#cutToFirstSignificantSubdomainCustomRFC}

Добавлено в версии: v22.10

Возвращает часть домена, включающую домены верхнего уровня до первого значимого поддомена.
Принимает имя пользовательского [списка TLD](https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains).
Эта функция может быть полезна, если требуется актуальный список TLD или используется пользовательский список.
Аналогична функции [cutToFirstSignificantSubdomainCustom](#cutToFirstSignificantSubdomainCustom), но соответствует стандарту RFC 3986.

**Пример конфигурации**

```xml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>
```

**Синтаксис**

```sql
cutToFirstSignificantSubdomainCustomRFC(url, tld_list_name)
```

**Аргументы**

- `url` — URL или строка домена для обработки в соответствии с RFC 3986.
- `tld_list_name` — имя пользовательского списка TLD, настроенного в ClickHouse.

**Возвращаемое значение**

Возвращает часть домена, включающую домены верхнего уровня до первого значимого поддомена. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT cutToFirstSignificantSubdomainCustomRFC('www.foo', 'public_suffix_list');
```

```response title=Результат
┌─cutToFirstSignificantSubdomainCustomRFC('www.foo', 'public_suffix_list')─────┐
│ www.foo                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘
```


## cutToFirstSignificantSubdomainCustomWithWWW {#cutToFirstSignificantSubdomainCustomWithWWW}

Введена в версии: v21.1

Возвращает часть домена, включающую поддомены верхнего уровня до первого значимого поддомена, не удаляя 'www'. Принимает имя пользовательского списка TLD. Может быть полезна, если требуется актуальный список TLD или используется пользовательский список.

**Пример конфигурации**

````yaml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>


**Синтаксис**

```sql
cutToFirstSignificantSubdomainCustomWithWWW(url, tld_list_name)
````

**Аргументы**

- `url` — URL или строка домена для обработки.
- `tld_list_name` — имя пользовательского списка TLD, настроенного в ClickHouse.

**Возвращаемое значение**

Часть домена, включающая поддомены верхнего уровня до первого значимого поддомена, не удаляя 'www'. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT cutToFirstSignificantSubdomainCustomWithWWW('www.foo', 'public_suffix_list');
```

```response title=Результат
┌─cutToFirstSignificantSubdomainCustomWithWWW('www.foo', 'public_suffix_list')─┐
│ www.foo                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘
```


## cutToFirstSignificantSubdomainCustomWithWWWRFC {#cutToFirstSignificantSubdomainCustomWithWWWRFC}

Введена в версии: v22.10

Возвращает часть домена, включающую поддомены верхнего уровня до первого значимого поддомена, сохраняя `www`.
Принимает имя пользовательского списка доменов верхнего уровня (TLD).
Может быть полезна, если требуется актуальный список TLD или используется пользовательский список.
Аналогична функции [cutToFirstSignificantSubdomainCustomWithWWW](#cutToFirstSignificantSubdomainCustomWithWWW), но соответствует стандарту [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Пример конфигурации**

````xml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>


**Синтаксис**

```sql
cutToFirstSignificantSubdomainCustomWithWWWRFC(url, tld_list_name)
````

**Аргументы**

- `url` — URL или строка домена для обработки в соответствии с RFC 3986.
- `tld_list_name` — имя пользовательского списка TLD, настроенного в ClickHouse.

**Возвращаемое значение**

Возвращает часть домена, включающую поддомены верхнего уровня до первого значимого поддомена, сохраняя `www`. [`String`](/sql-reference/data-types/string)

**Примеры**

**Разбор по RFC 3986 с сохранением www и пользовательским списком TLD**

```sql title=Запрос
SELECT cutToFirstSignificantSubdomainCustomWithWWWRFC('https://www.subdomain.example.custom', 'public_suffix_list')
```

```response title=Результат
www.example.custom
```


## cutToFirstSignificantSubdomainRFC {#cutToFirstSignificantSubdomainRFC}

Добавлено в версии: v22.10

Возвращает часть домена, включающую поддомены верхнего уровня до ["первого значимого поддомена"](/sql-reference/functions/url-functions#firstSignificantSubdomain). Аналогична функции [`cutToFirstSignificantSubdomain`](#cutToFirstSignificantSubdomain), но соответствует стандарту [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
cutToFirstSignificantSubdomainRFC(url)
```

**Аргументы**

- `url` — URL или строка домена для обработки в соответствии с RFC 3986. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает часть домена, включающую поддомены верхнего уровня до первого значимого поддомена, если это возможно, в противном случае возвращает пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT
    cutToFirstSignificantSubdomain('http://user:password@example.com:8080'),
    cutToFirstSignificantSubdomainRFC('http://user:password@example.com:8080');
```

```response title=Результат
┌─cutToFirstSignificantSubdomain('http://user:password@example.com:8080')─┬─cutToFirstSignificantSubdomainRFC('http://user:password@example.com:8080')─┐
│                                                                         │ example.com                                                                │
└─────────────────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────────┘
```


## cutToFirstSignificantSubdomainWithWWW {#cutToFirstSignificantSubdomainWithWWW}

Введена в версии: v20.12

Возвращает часть домена, включающую поддомены верхнего уровня до «первого значимого поддомена», не удаляя префикс 'www.'.

Аналогична функции [`cutToFirstSignificantSubdomain`](#cutToFirstSignificantSubdomain), но сохраняет префикс 'www.', если он присутствует.

**Синтаксис**

```sql
cutToFirstSignificantSubdomainWithWWW(url)
```

**Аргументы**

- `url` — URL или строка домена для обработки. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает часть домена, включающую поддомены верхнего уровня до первого значимого поддомена (с www), если это возможно, в противном случае возвращает пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT
    cutToFirstSignificantSubdomainWithWWW('https://news.clickhouse.com.tr/'),
    cutToFirstSignificantSubdomainWithWWW('www.tr'),
    cutToFirstSignificantSubdomainWithWWW('tr');
```

```response title=Результат
┌─cutToFirstSignificantSubdomainWithWWW('https://news.clickhouse.com.tr/')─┬─cutToFirstSignificantSubdomainWithWWW('www.tr')─┬─cutToFirstSignificantSubdomainWithWWW('tr')─┐
│ clickhouse.com.tr                                                        │ www.tr                                          │                                             │
└──────────────────────────────────────────────────────────────────────────┴─────────────────────────────────────────────────┴─────────────────────────────────────────────┘
```


## cutToFirstSignificantSubdomainWithWWWRFC {#cutToFirstSignificantSubdomainWithWWWRFC}

Введена в версии: v22.10

Возвращает часть домена, включающую поддомены верхнего уровня до «первого значимого поддомена», без удаления 'www'. Аналогична функции [`cutToFirstSignificantSubdomainWithWWW`](#cutToFirstSignificantSubdomainWithWWW), но соответствует стандарту [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
cutToFirstSignificantSubdomainWithWWWRFC(url)
```

**Аргументы**

- `url` — URL или строка домена для обработки согласно RFC 3986.

**Возвращаемое значение**

Возвращает часть домена, включающую поддомены верхнего уровня до первого значимого поддомена (с 'www'), если это возможно, в противном случае возвращает пустую строку. Тип: [`String`](/sql-reference/data-types/string).

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT
    cutToFirstSignificantSubdomainWithWWW('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy'),
    cutToFirstSignificantSubdomainWithWWWRFC('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy');
```

```response title=Результат
┌─cutToFirstSignificantSubdomainWithWWW('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy')─┬─cutToFirstSignificantSubdomainWithWWWRFC('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy')─┐
│                                                                                       │ mail.ru                                                                                  │
└───────────────────────────────────────────────────────────────────────────────────────┴──────────────────────────────────────────────────────────────────────────────────────────┘
```


## cutURLParameter {#cutURLParameter}

Введена в версии: v1.1

Удаляет параметр `name` из URL, если он присутствует.
Функция не выполняет кодирование или декодирование символов в именах параметров, например `Client ID` и `Client%20ID` рассматриваются как различные имена параметров.

**Синтаксис**

```sql
cutURLParameter(url, name)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)
- `name` — Имя параметра URL. [`String`](/sql-reference/data-types/string) или [`Array(String)`](/sql-reference/data-types/array)

**Возвращаемое значение**

URL с удалённым параметром `name`. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT
    cutURLParameter('http://bigmir.net/?a=b&c=d&e=f#g', 'a') AS url_without_a,
    cutURLParameter('http://bigmir.net/?a=b&c=d&e=f#g', ['c', 'e']) AS url_without_c_and_e;
```

```response title=Результат
┌─url_without_a────────────────┬─url_without_c_and_e──────┐
│ http://bigmir.net/?c=d&e=f#g │ http://bigmir.net/?a=b#g │
└──────────────────────────────┴──────────────────────────┘
```


## cutWWW {#cutWWW}

Introduced in: v1.1

Удаляет префикс `www.` из доменного имени URL, если он присутствует.

**Синтаксис**

```sql
cutWWW(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает URL с удалённым префиксом `www.` из доменного имени. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT cutWWW('http://www.example.com/path?query=value#fragment');
```

```response title=Результат
┌─cutWWW('http://www.example.com/path?query=value#fragment')─┐
│ http://example.com/path?query=value#fragment               │
└────────────────────────────────────────────────────────────┘
```


## decodeURLComponent {#decodeURLComponent}

Введена в версии: v1.1

Принимает URL-кодированную строку на вход и декодирует её в исходный читаемый вид.

**Синтаксис**

```sql
decodeURLComponent(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает декодированный URL. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT decodeURLComponent('http://127.0.0.1:8123/?query=SELECT%201%3B') AS DecodedURL;
```

```response title=Response
┌─DecodedURL─────────────────────────────┐
│ http://127.0.0.1:8123/?query=SELECT 1; │
└────────────────────────────────────────┘
```


## decodeURLFormComponent {#decodeURLFormComponent}

Добавлена в версии: v1.1

Декодирует URL-кодированные строки с использованием правил кодирования форм ([RFC-1866](https://www.rfc-editor.org/rfc/rfc1866.html)), где знаки `+` преобразуются в пробелы, а символы с процентным кодированием декодируются.

**Синтаксис**

```sql
decodeURLFormComponent(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает декодированный URL. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT decodeURLFormComponent('http://127.0.0.1:8123/?query=SELECT%201+2%2B3') AS DecodedURL;
```

```response title=Response
┌─DecodedURL────────────────────────────────┐
│ http://127.0.0.1:8123/?query=SELECT 1 2+3 │
└───────────────────────────────────────────┘
```


## domain {#domain}

Введена в версии: v1.1

Извлекает имя хоста из URL-адреса.

URL-адрес может быть указан с протоколом или без него.

**Синтаксис**

```sql
domain(url)
```

**Аргументы**

- `url` — URL-адрес. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает имя хоста, если входная строка может быть распознана как URL-адрес, в противном случае возвращает пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT domain('svn+ssh://some.svn-hosting.com:80/repo/trunk');
```

```response title=Результат
┌─domain('svn+ssh://some.svn-hosting.com:80/repo/trunk')─┐
│ some.svn-hosting.com                                   │
└────────────────────────────────────────────────────────┘
```


## domainRFC {#domainRFC}

Введена в версии: v22.10

Извлекает имя хоста из URL.
Аналогична функции [`domain`](#domain), но соответствует стандарту [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
domainRFC(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает имя хоста, если входная строка может быть распознана как URL, в противном случае — пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT
    domain('http://user:password@example.com:8080/path?query=value#fragment'),
    domainRFC('http://user:password@example.com:8080/path?query=value#fragment');
```

```response title=Результат
┌─domain('http://user:password@example.com:8080/path?query=value#fragment')─┬─domainRFC('http://user:password@example.com:8080/path?query=value#fragment')─┐
│                                                                           │ example.com                                                                  │
└───────────────────────────────────────────────────────────────────────────┴──────────────────────────────────────────────────────────────────────────────┘
```


## domainWithoutWWW {#domainWithoutWWW}

Введена в версии: v1.1

Возвращает домен URL без префикса `www.`, если он присутствует.

**Синтаксис**

```sql
domainWithoutWWW(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает доменное имя, если входная строка может быть распознана как URL (без префикса `www.`), в противном случае — пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT domainWithoutWWW('http://paul@www.example.com:80/');
```

```response title=Результат
┌─domainWithoutWWW('http://paul@www.example.com:80/')─┐
│ example.com                                         │
└─────────────────────────────────────────────────────┘
```


## domainWithoutWWWRFC {#domainWithoutWWWRFC}

Добавлено в версии: v1.1

Возвращает домен без префикса `www.`, если он присутствует. Аналогична функции [`domainWithoutWWW`](#domainWithoutWWW), но соответствует стандарту [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
domainWithoutWWWRFC(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает доменное имя, если входная строка может быть распознана как URL (без префикса `www.`), в противном случае — пустую строку. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT
    domainWithoutWWW('http://user:password@www.example.com:8080/path?query=value#fragment'),
    domainWithoutWWWRFC('http://user:password@www.example.com:8080/path?query=value#fragment');
```

```response title=Результат
┌─domainWithoutWWW('http://user:password@www.example.com:8080/path?query=value#fragment')─┬─domainWithoutWWWRFC('http://user:password@www.example.com:8080/path?query=value#fragment')─┐
│                                                                                         │ example.com                                                                                │
└─────────────────────────────────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────────────────────────┘
```


## encodeURLComponent {#encodeURLComponent}

Добавлена в версии: v22.3

Принимает обычную строку и преобразует её в URL-кодированный (процентно-кодированный) формат, в котором специальные символы заменяются их процентно-кодированными эквивалентами.

**Синтаксис**

```sql
encodeURLComponent(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает закодированный URL. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT encodeURLComponent('http://127.0.0.1:8123/?query=SELECT 1;') AS EncodedURL;
```

```response title=Response
┌─EncodedURL───────────────────────────────────────────────┐
│ http%3A%2F%2F127.0.0.1%3A8123%2F%3Fquery%3DSELECT%201%3B │
└──────────────────────────────────────────────────────────┘
```


## encodeURLFormComponent {#encodeURLFormComponent}

Введена в версии: v22.3

Кодирует строки с использованием правил кодирования форм ([RFC-1866](https://www.rfc-editor.org/rfc/rfc1866.html)), где пробелы преобразуются в знаки +, а специальные символы кодируются процентным кодированием.

**Синтаксис**

```sql
encodeURLFormComponent(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает закодированный URL. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT encodeURLFormComponent('http://127.0.0.1:8123/?query=SELECT 1 2+3') AS EncodedURL;
```

```response title=Response
┌─EncodedURL────────────────────────────────────────────────┐
│ http%3A%2F%2F127.0.0.1%3A8123%2F%3Fquery%3DSELECT+1+2%2B3 │
└───────────────────────────────────────────────────────────┘
```


## extractURLParameter {#extractURLParameter}

Введена в версии: v1.1

Возвращает значение параметра `name` в URL, если он присутствует, в противном случае возвращается пустая строка.
Если параметров с таким именем несколько, возвращается первое вхождение.
Функция предполагает, что параметр в аргументе `url` закодирован так же, как и в аргументе `name`.

**Синтаксис**

```sql
extractURLParameter(url, name)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)
- `name` — Имя параметра. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Значение параметра URL с указанным именем. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT extractURLParameter('http://example.com/?param1=value1&param2=value2', 'param1');
```

```response title=Результат
┌─extractURLPa⋯, 'param1')─┐
│ value1                   │
└──────────────────────────┘
```


## extractURLParameterNames {#extractURLParameterNames}

Введена в версии: v1.1

Возвращает массив строк с именами параметров URL.
Значения не декодируются.

**Синтаксис**

```sql
extractURLParameterNames(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает массив строк с именами параметров URL. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT extractURLParameterNames('http://example.com/?param1=value1&param2=value2');
```

```response title=Результат
┌─extractURLPa⋯m2=value2')─┐
│ ['param1','param2']      │
└──────────────────────────┘
```


## extractURLParameters {#extractURLParameters}

Введена в версии: v1.1

Возвращает массив строк вида `name=value`, соответствующих параметрам URL.
Значения не декодируются.

**Синтаксис**

```sql
extractURLParameters(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Массив строк вида `name=value`, соответствующих параметрам URL. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT extractURLParameters('http://example.com/?param1=value1&param2=value2');
```

```response title=Результат
┌─extractURLParame⋯&param2=value2')─┐
│ ['param1=value1','param2=value2'] │
└───────────────────────────────────┘
```


## firstSignificantSubdomain {#firstSignificantSubdomain}

Introduced in: v

Возвращает «первый значимый поддомен».

Первый значимый поддомен — это домен второго уровня, если он является 'com', 'net', 'org' или 'co'.
В противном случае это домен третьего уровня.

Например, firstSignificantSubdomain('https://news.clickhouse.com/') = 'clickhouse', firstSignificantSubdomain ('https://news.clickhouse.com.tr/') = 'clickhouse'.

Список «незначимых» доменов второго уровня и другие детали реализации могут измениться в будущем.

**Синтаксис**

```sql

```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

**Примеры**

**firstSignificantSubdomain**

```sql title=Запрос
SELECT firstSignificantSubdomain('https://news.clickhouse.com/')
```

```response title=Результат

```


## firstSignificantSubdomainRFC {#firstSignificantSubdomainRFC}

Introduced in: v

Возвращает «первый значимый поддомен» в соответствии с RFC 1034.

**Синтаксис**

```sql

```

**Аргументы**

- Отсутствуют.

**Возвращаемое значение**

**Примеры**


## fragment {#fragment}

Добавлено в версии: v1.1

Возвращает идентификатор фрагмента без начального символа решётки.

**Синтаксис**

```sql
fragment(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает идентификатор фрагмента без начального символа решётки. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT fragment('https://clickhouse.com/docs/getting-started/quick-start/cloud#1-create-a-clickhouse-service');
```

```response title=Результат
┌─fragment('http⋯ouse-service')─┐
│ 1-create-a-clickhouse-service │
└───────────────────────────────┘
```


## netloc {#netloc}

Добавлено в версии: v20.5

Извлекает сетевое расположение (`username:password@host:port`) из URL.

**Синтаксис**

```sql
netloc(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает `username:password@host:port` из указанного URL. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT netloc('http://paul@www.example.com:80/');
```

```response title=Результат
┌─netloc('http⋯e.com:80/')─┐
│ paul@www.example.com:80  │
└──────────────────────────┘
```


## path {#path}

Добавлено в версии: v1.1

Возвращает путь URL без строки запроса.

**Синтаксис**

```sql
path(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает путь URL без строки запроса. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT path('https://clickhouse.com/docs/sql-reference/functions/url-functions/?query=value');
```

```response title=Результат
┌─path('https://clickhouse.com/en/sql-reference/functions/url-functions/?query=value')─┐
│ /docs/sql-reference/functions/url-functions/                                         │
└──────────────────────────────────────────────────────────────────────────────────────┘
```


## pathFull {#pathFull}

Добавлено в версии: v1.1

Аналогична функции [`path`](#path), но включает строку запроса и фрагмент URL.

**Синтаксис**

```sql
pathFull(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает путь URL, включая строку запроса и фрагмент. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT pathFull('https://clickhouse.com/docs/sql-reference/functions/url-functions/?query=value#section');
```

```response title=Результат
┌─pathFull('https://clickhouse.com⋯unctions/?query=value#section')─┐
│ /docs/sql-reference/functions/url-functions/?query=value#section │
└──────────────────────────────────────────────────────────────────┘
```


## port {#port}

Введена в версии: v20.5

Возвращает порт URL-адреса или значение `default_port`, если URL не содержит порта или не может быть разобран.

**Синтаксис**

```sql
port(url[, default_port])
```

**Аргументы**

- `url` — URL-адрес. [`String`](/sql-reference/data-types/string)
- `default_port` — Необязательный параметр. Номер порта, возвращаемый по умолчанию. Значение по умолчанию: `0`. [`UInt16`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает порт URL-адреса или порт по умолчанию, если порт в URL отсутствует или произошла ошибка валидации. [`UInt16`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT port('https://clickhouse.com:8443/docs'), port('https://clickhouse.com/docs', 443);
```

```response title=Результат
┌─port('https://clickhouse.com:8443/docs')─┬─port('https://clickhouse.com/docs', 443)─┐
│                                     8443 │                                      443 │
└──────────────────────────────────────────┴──────────────────────────────────────────┘
```


## portRFC {#portRFC}

Введена в версии: v22.10

Возвращает порт или `default_port`, если URL не содержит порта или не может быть разобран.
Аналогична функции [`port`](#port), но соответствует стандарту [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
portRFC(url[, default_port])
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)
- `default_port` — Необязательный параметр. Номер порта, возвращаемый по умолчанию. Значение по умолчанию: `0`. [`UInt16`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает порт или порт по умолчанию, если в URL отсутствует порт или произошла ошибка валидации. [`UInt16`](/sql-reference/data-types/int-uint)

**Примеры**

**Пример использования**

```sql title=Query
SELECT port('http://user:password@example.com:8080/'), portRFC('http://user:password@example.com:8080/');
```

```response title=Response
┌─port('http:/⋯com:8080/')─┬─portRFC('htt⋯com:8080/')─┐
│                        0 │                     8080 │
└──────────────────────────┴──────────────────────────┘
```


## protocol {#protocol}

Введена в версии: v1.1

Извлекает протокол из URL-адреса.

Примеры типичных возвращаемых значений: http, https, ftp, mailto, tel, magnet.

**Синтаксис**

```sql
protocol(url)
```

**Аргументы**

- `url` — URL-адрес. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает протокол URL-адреса или пустую строку, если его невозможно определить. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT protocol('https://clickhouse.com/');
```

```response title=Результат
┌─protocol('https://clickhouse.com/')─┐
│ https                               │
└─────────────────────────────────────┘
```


## queryString {#queryString}

Введена в версии: v1.1

Возвращает строку запроса URL без начального знака вопроса, символа `#` и всего, что следует после него.

**Синтаксис**

```sql
queryString(url)
```

**Аргументы**

- `url` — URL-адрес. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Строка запроса URL без начального знака вопроса и фрагмента. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT queryString('https://clickhouse.com/docs?query=value&param=123#section');
```

```response title=Результат
┌─queryString(⋯3#section')─┐
│ query=value&param=123    │
└──────────────────────────┘
```


## queryStringAndFragment {#queryStringAndFragment}

Introduced in: v1.1

Возвращает строку запроса и идентификатор фрагмента URL-адреса.

**Синтаксис**

```sql
queryStringAndFragment(url)
```

**Аргументы**

- `url` — URL-адрес. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Строка запроса и идентификатор фрагмента URL-адреса. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT queryStringAndFragment('https://clickhouse.com/docs?query=value&param=123#section');
```

```response title=Результат
┌─queryStringAnd⋯=123#section')─┐
│ query=value&param=123#section │
└───────────────────────────────┘
```


## topLevelDomain {#topLevelDomain}

Introduced in: v1.1

Извлекает домен верхнего уровня из URL.

:::note
URL можно указывать с протоколом или без него.
Например:

```text
svn+ssh://some.svn-hosting.com:80/repo/trunk
some.svn-hosting.com:80/repo/trunk
https://clickhouse.com/time/
```

:::

**Синтаксис**

```sql
topLevelDomain(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает имя домена, если входная строка может быть распознана как URL. В противном случае возвращается пустая строка. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT topLevelDomain('svn+ssh://www.some.svn-hosting.com:80/repo/trunk');
```

```response title=Результат
┌─topLevelDomain('svn+ssh://www.some.svn-hosting.com:80/repo/trunk')─┐
│ com                                                                │
└────────────────────────────────────────────────────────────────────┘
```


## topLevelDomainRFC {#topLevelDomainRFC}

Введена в версии: v22.10

Извлекает домен верхнего уровня из URL.
Аналогична функции [`topLevelDomain`](#topLevelDomain), но соответствует стандарту [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

**Синтаксис**

```sql
topLevelDomainRFC(url)
```

**Аргументы**

- `url` — URL. [`String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Доменное имя, если входная строка может быть разобрана как URL. В противном случае — пустая строка. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Запрос
SELECT topLevelDomain('http://foo:foo%41bar@foo.com'), topLevelDomainRFC('http://foo:foo%41bar@foo.com');
```

```response title=Результат
┌─topLevelDomain('http://foo:foo%41bar@foo.com')─┬─topLevelDomainRFC('http://foo:foo%41bar@foo.com')─┐
│                                                │ com                                               │
└────────────────────────────────────────────────┴───────────────────────────────────────────────────┘
```

<!--AUTOGENERATED_END-->
