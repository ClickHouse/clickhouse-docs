---
description: 'Документация по функциям разбиения строк'
sidebar_label: 'Разбиение строк'
slug: /sql-reference/functions/splitting-merging-functions
title: 'Функции разбиения строк'
doc_type: 'reference'
---

import DeprecatedBadge from '@theme/badges/DeprecatedBadge';


# Функции для разделения строк

:::note
Приведённая ниже документация сгенерирована из системной таблицы `system.functions`.
:::

{/* 
  Внутреннее содержимое тегов ниже во время сборки фреймворка документации
  заменяется на документы, сгенерированные из system.functions. Пожалуйста, не изменяйте и не удаляйте эти теги.
  См.: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
  */ }

{/*AUTOGENERATED_START*/ }


## alphaTokens

Добавлена в версии: v1.1

Выделяет подстроки из последовательных байтов в диапазонах `a-z` и `A-Z` и возвращает массив найденных подстрок.

**Синтаксис**

```sql
alphaTokens(s[, max_substrings])
```

**Псевдонимы**: `splitByAlpha`

**Аргументы**

* `s` — Строка для разбиения. [`String`](/sql-reference/data-types/string)
* `max_substrings` — Необязательный параметр. Если `max_substrings > 0`, количество возвращаемых подстрок не превышает `max_substrings`, в противном случае функция вернёт максимально возможное количество подстрок. [`Int64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает массив выбранных подстрок строки `s`. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Query
SELECT alphaTokens('abca1abc');
```

```response title=Response
┌─alphaTokens('abca1abc')─┐
│ ['abca','abc']          │
└─────────────────────────┘
```


## arrayStringConcat

Добавлена в: v1.1

Объединяет строковые представления значений массива, используя указанный разделитель. Разделитель является необязательным параметром и по умолчанию равен пустой строке.

**Синтаксис**

```sql
arrayStringConcat(arr[, separator])
```

**Аргументы**

* `arr` — Массив, элементы которого нужно конкатенировать. [`Array(T)`](/sql-reference/data-types/array)
* `separator` — Необязательный параметр. Строка-разделитель. По умолчанию — пустая строка. [`const String`](/sql-reference/data-types/string)

**Возвращаемое значение**

Возвращает строку, полученную в результате конкатенации. [`String`](/sql-reference/data-types/string)

**Примеры**

**Пример использования**

```sql title=Query
SELECT arrayStringConcat(['12/05/2021', '12:50:00'], ' ') AS DateString;
```

```response title=Response
┌─DateString──────────┐
│ 12/05/2021 12:50:00 │
└─────────────────────┘
```


## extractAllGroupsVertical

Добавлена в версии: v20.5

Находит все группы в строке с использованием регулярного выражения и возвращает массив массивов, где каждый внутренний массив содержит фрагменты совпадений для каждой группы, упорядоченные по мере их появления во входной строке.

**Синтаксис**

```sql
extractAllGroupsVertical(s, regexp)
```

**Псевдонимы**: `extractAllGroups`

**Аргументы**

* `s` — входная строка, из которой выполняется извлечение. [`String`](/sql-reference/data-types/string) или [`FixedString`](/sql-reference/data-types/fixedstring)
* `regexp` — регулярное выражение для сопоставления. [`const String`](/sql-reference/data-types/string) или [`const FixedString`](/sql-reference/data-types/fixedstring)

**Возвращаемое значение**

Возвращает массив массивов, где каждый вложенный массив содержит группы захвата из одного совпадения. Каждое совпадение порождает массив с элементами, соответствующими группам захвата в регулярном выражении (группа 1, группа 2 и т. д.). Если совпадения не найдены, возвращается пустой массив. [`Array(Array(String))`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Query
WITH '< Server: nginx
< Date: Tue, 22 Jan 2019 00:26:14 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
' AS s
SELECT extractAllGroupsVertical(s, '< ([\\w\\-]+): ([^\\r\\n]+)');
```

```response title=Response
[['Server','nginx'],['Date','Tue, 22 Jan 2019 00:26:14 GMT'],['Content-Type','text/html; charset=UTF-8'],['Connection','keep-alive']]
```


## ngrams

Добавлена в версии v21.11

Разбивает строку в кодировке UTF-8 на n-граммы длины `N`.

**Синтаксис**

```sql
n-граммы(s, N)
```

**Аргументы**

* `s` — Входная строка. [`String`](/sql-reference/data-types/string) или [`FixedString`](/sql-reference/data-types/fixedstring)
* `N` — Длина n-граммы. [`const UInt8/16/32/64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает массив n-грамм. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Query
SELECT ngrams('ClickHouse', 3);
```

```response title=Response
['Cli','lic','ick','ckH','kHo','Hou','ous','use']
```


## splitByChar

Появилась в: v1.1

Разбивает строку на массив подстрок, используя заданный константный разделитель `separator` длиной в один символ.
В результирующем массиве могут присутствовать пустые подстроки, если разделитель встречается в начале или в конце строки, либо если есть несколько последовательных разделителей.

:::note
Настройка [`splitby_max_substrings_includes_remaining_string`](../../operations/settings/settings.md#splitby_max_substrings_includes_remaining_string) (по умолчанию: `0`) определяет, включается ли оставшаяся часть строки в последний элемент результирующего массива, когда аргумент `max_substrings > 0`.
:::

Пустые подстроки могут появляться, если:

* Разделитель встречается в начале или в конце строки
* Есть несколько последовательных разделителей
* Исходная строка `s` пуста

**Синтаксис**

```sql
splitByChar(separator, s[, max_substrings])
```

**Аргументы**

* `separator` — Разделитель должен быть однобайтным символом. [`String`](/sql-reference/data-types/string)
* `s` — Строка, которую нужно разделить. [`String`](/sql-reference/data-types/string)
* `max_substrings` — Необязательный аргумент. Если `max_substrings > 0`, возвращаемый массив будет содержать не более `max_substrings` подстрок, иначе функция вернёт максимально возможное число подстрок. Значение по умолчанию — `0`.  [`Int64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает массив полученных подстрок. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Query
SELECT splitByChar(',', '1,2,3,abcde');
```

```response title=Response
┌─splitByChar(⋯2,3,abcde')─┐
│ ['1','2','3','abcde']    │
└──────────────────────────┘
```


## splitByNonAlpha

Впервые появилась в версии v21.9

Разбивает строку, в которой пробельные символы и знаки препинания используются как разделители, на массив подстрок.

:::note
Параметр [`splitby_max_substrings_includes_remaining_string`](../../operations/settings/settings.md#splitby_max_substrings_includes_remaining_string) (по умолчанию: `0`) определяет, будет ли оставшаяся часть строки включена в последний элемент результирующего массива, когда аргумент `max_substrings > 0`.
:::

**Синтаксис**

```sql
splitByNonAlpha(s[, max_substrings])
```

**Аргументы**

* `s` — Строка, которую нужно разбить. [`String`](/sql-reference/data-types/string)
* `max_substrings` — Необязательный параметр. Если `max_substrings > 0`, количество возвращаемых подстрок не превысит `max_substrings`, в противном случае функция вернёт максимально возможное количество подстрок. Значение по умолчанию: `0`. [`Int64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает массив подстрок строки `s`. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Query
SELECT splitByNonAlpha('user@domain.com');
```

```response title=Response
['user','domain','com']
```


## splitByRegexp

Добавлено в: v21.6

Разбивает строку, разделённую заданным регулярным выражением, на массив подстрок.
Если заданное регулярное выражение пустое, строка будет разбита на массив отдельных символов.
Если совпадений с регулярным выражением не найдено, строка не будет разбита.

Пустые подстроки могут появляться в следующих случаях:

* непустое совпадение регулярного выражения находится в начале или в конце строки
* есть несколько последовательных непустых совпадений регулярного выражения
* исходная строка пуста, а регулярное выражение — нет.

:::note
Настройка [`splitby_max_substrings_includes_remaining_string`](../../operations/settings/settings.md#splitby_max_substrings_includes_remaining_string) (по умолчанию: `0`) определяет, включается ли оставшаяся часть строки в последний элемент результирующего массива, когда аргумент `max_substrings > 0`.
:::

**Синтаксис**

```sql
splitByRegexp(regexp, s[, max_substrings])
```

**Аргументы**

* `regexp` — регулярное выражение. Константа. [`String`](/sql-reference/data-types/string) или [`FixedString`](/sql-reference/data-types/fixedstring)
* `s` — строка, которую нужно разделить. [`String`](/sql-reference/data-types/string)
* `max_substrings` — необязательный параметр. При `max_substrings > 0` количество возвращаемых подстрок не превышает `max_substrings`, в противном случае функция вернёт максимально возможное количество подстрок. Значение по умолчанию: `0`. [`Int64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает массив подстрок, полученных из `s`. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Query
SELECT splitByRegexp('\\d+', 'a12bc23de345f');
```

```response title=Response
┌─splitByRegex⋯c23de345f')─┐
│ ['a12bc23de345f']        │
└──────────────────────────┘
```

**Пустое регулярное выражение**

```sql title=Query
SELECT splitByRegexp('', 'abcde');
```

```response title=Response
┌─splitByRegexp('', 'abcde')─┐
│ ['a','b','c','d','e']      │
└────────────────────────────┘
```


## splitByString

Появилась в версии: v1.1

Разбивает строку с константным разделителем `separator`, состоящим из нескольких символов, на массив подстрок.
Если строка `separator` пуста, строка `s` будет разделена на массив отдельных символов.

Пустые подстроки могут появляться в следующих случаях:

* Непустой разделитель находится в начале или в конце строки
* Имеется несколько подряд идущих непустых разделителей
* Исходная строка `s` пуста, а разделитель непустой

:::note
Параметр [`splitby_max_substrings_includes_remaining_string`](../../operations/settings/settings.md#splitby_max_substrings_includes_remaining_string) (по умолчанию: `0`) управляет тем, включается ли оставшаяся часть строки в последний элемент результирующего массива, когда аргумент `max_substrings > 0`.
:::

**Синтаксис**

```sql
splitByString(separator, s[, max_substrings])
```

**Аргументы**

* `separator` — Разделитель. [`String`](/sql-reference/data-types/string)
* `s` — Строка для разбиения. [`String`](/sql-reference/data-types/string)
* `max_substrings` — Необязательный параметр. Когда `max_substrings > 0`, количество возвращаемых подстрок не превышает `max_substrings`, в противном случае функция возвращает максимально возможное количество подстрок. Значение по умолчанию: `0`. [`Int64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает массив полученных подстрок строки `s` [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Query
SELECT splitByString(', ', '1, 2 3, 4,5, abcde');
```

```response title=Response
┌─splitByStrin⋯4,5, abcde')─┐
│ ['1','2 3','4,5','abcde'] │
└───────────────────────────┘
```

**Пустой разделитель**

```sql title=Query
SELECT splitByString('', 'abcde');
```

```response title=Response
┌─splitByString('', 'abcde')─┐
│ ['a','b','c','d','e']      │
└────────────────────────────┘
```


## splitByWhitespace

Появилась в версии v21.9

Разделяет строку, разделённую пробельными символами, на массив подстрок.

:::note
Параметр [`splitby_max_substrings_includes_remaining_string`](../../operations/settings/settings.md#splitby_max_substrings_includes_remaining_string) (по умолчанию: `0`) определяет, будет ли оставшаяся часть строки включена в последний элемент результирующего массива, когда аргумент `max_substrings > 0`.
:::

**Синтаксис**

```sql
splitByWhitespace(s[, max_substrings])
```

**Аргументы**

* `s` — строка для разбиения. [`String`](/sql-reference/data-types/string)
* `max_substrings` — необязательный параметр. Если `max_substrings > 0`, количество возвращаемых подстрок не превышает `max_substrings`, в противном случае функция вернёт максимально возможное число подстрок. Значение по умолчанию: `0`. [`Int64`](/sql-reference/data-types/int-uint)

**Возвращаемое значение**

Возвращает массив выбранных подстрок строки `s`. [`Array(String)`](/sql-reference/data-types/array)

**Примеры**

**Пример использования**

```sql title=Query
SELECT splitByWhitespace('  1!  a,  b.  ');
```

```response title=Response
['1!','a,','b.']
```


## tokens \

Добавлено в: v21.11

Разбивает строку на токены с использованием указанного токенизатора.
Токенизатор по умолчанию использует символы ASCII, отличные от букв и цифр, в качестве разделителей.

В случае токенизатора `split`, если токены не образуют [префиксный код](https://en.wikipedia.org/wiki/Prefix_code), вам, вероятнее всего, нужно, чтобы при сопоставлении приоритет отдавался более длинным разделителям.
Для этого передавайте разделители в порядке убывания их длины.
Например, при separators = `['%21', '%']` строка `%21abc` будет разбита на токены как `['abc']`, тогда как при separators = `['%', '%21']` она будет разбита как `['21ac']` (что, вероятнее всего, не является желаемым результатом).

**Синтаксис**

```sql
tokens(value[, tokenizer[, ngrams[, separators]]])
```

**Аргументы**

* `value` — Входная строка. [`String`](/sql-reference/data-types/string) или [`FixedString`](/sql-reference/data-types/fixedstring)
* `tokenizer` — Используемый токенизатор. Допустимые значения: `splitByNonAlpha`, `ngrams`, `splitByString`, `array` и `sparseGrams`. Необязательный параметр; если не задан явно, по умолчанию используется `splitByNonAlpha`. [`const String`](/sql-reference/data-types/string)
* `ngrams` — Применим только если аргумент `tokenizer` равен `ngrams`: необязательный параметр, задающий длину n-грамм. Если не задан явно, по умолчанию принимает значение `3`. [`const UInt8`](/sql-reference/data-types/int-uint)
* `separators` — Применим только если аргумент `tokenizer` равен `split`: необязательный параметр, который задаёт строки-разделители. Если не задан явно, по умолчанию используется `[' ']`. [`const Array(String)`](/sql-reference/data-types/array)

**Возвращаемое значение**

Возвращает результирующий массив токенов из входной строки. [`Array`](/sql-reference/data-types/array)

**Примеры**

**Токенизатор по умолчанию**

```sql title=Query
SELECT tokens('test1,;\\\\ test2,;\\\\ test3,;\\\\   test4') AS tokens;
```

```response title=Response
['test1','test2','test3','test4']
```

**Токенизатор N‑грамм**

```sql title=Query
SELECT tokens('abc def', 'ngrams', 3) AS tokens;
```

```response title=Response
['abc','bc ','c d',' de','def']
```

{/*AUTOGENERATED_END*/ }
