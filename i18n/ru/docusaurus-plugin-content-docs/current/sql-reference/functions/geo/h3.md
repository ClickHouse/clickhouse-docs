---
description: 'Документация по H3'
sidebar_label: 'Индексы H3'
slug: /sql-reference/functions/geo/h3
title: 'Функции для работы с индексами H3'
doc_type: 'reference'
---

## Индекс H3 \\{#h3-index\\}

[H3](https://h3geo.org/) — это система географического индексирования, в которой поверхность Земли разбита на сетку равновеликих шестиугольных ячеек. Эта система иерархическая, т. е. каждый шестиугольник на верхнем уровне («родитель») может быть разделён на семь таких же, но меньших («потомки»), и так далее.

Уровень иерархии называется `resolution` и может принимать значения от `0` до `15`, где `0` — это базовый уровень (`base`) с наибольшими и наиболее грубыми ячейками.

Пара «широта–долгота» может быть преобразована в 64-битный индекс H3, идентифицирующий ячейку сетки.

Индекс H3 используется в первую очередь для разбиения (bucketing) местоположений и других геопространственных операций.

Полное описание системы H3 доступно на [сайте Uber Engineering](https://www.uber.com/blog/h3/).

## h3IsValid \\{#h3isvalid\\}

Проверяет, является ли число допустимым индексом [H3](#h3-index).

**Синтаксис**

```sql
h3IsValid(h3index)
```

**Параметр**

* `h3index` — номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).

**Возвращаемые значения**

* 1 — число является допустимым H3-индексом. [UInt8](../../data-types/int-uint.md).
* 0 — число не является допустимым H3-индексом. [UInt8](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
SELECT h3IsValid(630814730351855103) AS h3IsValid;
```

Результат:

```text
┌─h3IsValid─┐
│         1 │
└───────────┘
```

## h3GetResolution \\{#h3getresolution\\}

Определяет разрешение заданного индекса [H3](#h3-index).

**Синтаксис**

```sql
h3GetResolution(h3index)
```

**Параметр**

* `h3index` — номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).

**Возвращаемые значения**

* Разрешение индекса. Диапазон: `[0, 15]`. [UInt8](../../data-types/int-uint.md).
* Если индекс некорректен, функция возвращает случайное значение. Используйте [h3IsValid](#h3isvalid) для проверки индекса. [UInt8](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
SELECT h3GetResolution(639821929606596015) AS resolution;
```

Результат:

```text
┌─resolution─┐
│         14 │
└────────────┘
```

## h3EdgeAngle \\{#h3edgeangle\\}

Вычисляет среднюю длину ребра шестиугольной ячейки [H3](#h3-index) в градусах.

**Синтаксис**

```sql
h3EdgeAngle(resolution)
```

**Параметр**

* `resolution` — разрешение индекса. [UInt8](../../data-types/int-uint.md). Диапазон: `[0, 15]`.

**Возвращаемые значения**

* Средняя длина ребра шестиугольника [H3](#h3-index) в градусах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3EdgeAngle(10) AS edgeAngle;
```

Результат:

```text
┌───────h3EdgeAngle(10)─┐
│ 0.0005927224846720883 │
└───────────────────────┘
```

## h3EdgeLengthM \\{#h3edgelengthm\\}

Вычисляет среднюю длину ребра шестиугольной ячейки [H3](#h3-index) в метрах.

**Синтаксис**

```sql
h3EdgeLengthM(resolution)
```

**Параметр**

* `resolution` — разрешение индекса. [UInt8](../../data-types/int-uint.md). Диапазон: `[0, 15]`.

**Возвращаемое значение**

* Средняя длина ребра шестиугольника [H3](#h3-index) в метрах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3EdgeLengthM(15) AS edgeLengthM;
```

Результат:

```text
┌─edgeLengthM─┐
│ 0.509713273 │
└─────────────┘
```

## h3EdgeLengthKm \\{#h3edgelengthkm\\}

Вычисляет среднюю длину ребра шестиугольника [H3](#h3-index) в километрах.

**Синтаксис**

```sql
h3EdgeLengthKm(resolution)
```

**Параметр**

* `resolution` — Разрешение индекса. [UInt8](../../data-types/int-uint.md). Диапазон: `[0, 15]`.

**Возвращаемые значения**

* Средняя длина ребра шестиугольника [H3](#h3-index) в километрах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3EdgeLengthKm(15) AS edgeLengthKm;
```

Результат:

```text
┌─edgeLengthKm─┐
│  0.000509713 │
└──────────────┘
```

## geoToH3 \\{#geotoh3\\}

Возвращает индекс точки [H3](#h3-index) для координат `(lat, lon)` с указанным разрешением.

**Синтаксис**

```sql
geoToH3(lat, lon, resolution)
```

**Аргументы**

* `lat` — широта. [Float64](../../data-types/float.md).
* `lon` — долгота. [Float64](../../data-types/float.md).
* `resolution` — разрешающая способность индекса. Диапазон: `[0, 15]`. [UInt8](../../data-types/int-uint.md).

**Возвращаемые значения**

* Номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).
* 0 в случае ошибки. [UInt64](../../data-types/int-uint.md).

Примечание: в ClickHouse v25.4 и более ранних версиях `geoToH3()` принимает аргументы в порядке `(lon, lat)`. Начиная с ClickHouse v25.5, входные значения передаются в порядке `(lat, lon)`. Предыдущее поведение можно восстановить с помощью настройки `geotoh3_argument_order = 'lon_lat'`.

**Пример**

Запрос:

```sql
SELECT geoToH3(55.71290588, 37.79506683, 15) AS h3Index;
```

Результат:

```text
┌────────────h3Index─┐
│ 644325524701193974 │
└────────────────────┘
```

## h3ToGeo \\{#h3togeo\\}

Возвращает широту и долготу центроида, соответствующие указанному индексу [H3](#h3-index).

**Синтаксис**

```sql
h3ToGeo(h3Index)
```

**Аргументы**

* `h3Index` — индекс H3. [UInt64](../../data-types/int-uint.md).

**Возвращаемые значения**

* Кортеж из двух значений: `tuple(lat,lon)`. `lat` — широта. [Float64](../../data-types/float.md). `lon` — долгота. [Float64](../../data-types/float.md).

Примечание: в ClickHouse v24.12 и более ранних версиях `h3ToGeo()` возвращает значения в порядке `(lon, lat)`. Начиная с ClickHouse v25.1, возвращаемые значения идут в порядке `(lat, lon)`. Предыдущее поведение можно восстановить с помощью настройки `h3togeo_lon_lat_result_order = true`.

**Пример**

Запрос:

```sql
SELECT h3ToGeo(644325524701193974) AS coordinates;
```

Результат:

```text
┌─coordinates───────────────────────────┐
│ (55.71290243145668,37.79506616830252) │
└───────────────────────────────────────┘
```

## h3ToGeoBoundary \\{#h3togeoboundary\\}

Возвращает массив пар `(lat, lon)`, соответствующих границе указанного индекса H3.

**Синтаксис**

```sql
h3ToGeoBoundary(h3Index)
```

**Аргументы**

* `h3Index` — индекс H3. [UInt64](../../data-types/int-uint.md).

**Возвращаемые значения**

* Массив пар «(lat, lon)». [Array](../../data-types/array.md)([Float64](../../data-types/float.md), [Float64](../../data-types/float.md)).

**Пример**

Запрос:

```sql
SELECT h3ToGeoBoundary(644325524701193974) AS coordinates;
```

Результат:

```text
┌─h3ToGeoBoundary(599686042433355775)────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ [(37.2713558667319,-121.91508032705622),(37.353926450852256,-121.8622232890249),(37.42834118609435,-121.92354999630156),(37.42012867767779,-122.03773496427027),(37.33755608435299,-122.090428929044),(37.26319797461824,-122.02910130919001)] │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## h3kRing \\{#h3kring\\}

Перечисляет все шестиугольники [H3](#h3-index) в радиусе `k` от указанного шестиугольника в случайном порядке.

**Синтаксис**

```sql
h3kRing(h3index, k)
```

**Аргументы**

* `h3index` — номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).
* `k` — радиус. [integer](../../data-types/int-uint.md)

**Возвращаемые значения**

* Массив H3-индексов. [Array](../../data-types/array.md)([UInt64](../../data-types/int-uint.md)).

**Пример**

Запрос:

```sql
SELECT arrayJoin(h3kRing(644325529233966508, 1)) AS h3index;
```

Результат:

```text
┌────────────h3index─┐
│ 644325529233966508 │
│ 644325529233966497 │
│ 644325529233966510 │
│ 644325529233966504 │
│ 644325529233966509 │
│ 644325529233966355 │
│ 644325529233966354 │
└────────────────────┘
```

## h3PolygonToCells \\{#h3polygontocells\\}

Возвращает шестиугольники (при указанном разрешении), которые находятся внутри заданной геометрии — кольца или (мульти)полигона.

**Синтаксис**

```sql
h3PolygonToCells(geometry, resolution)
```

**Аргументы**

* `geometry` может быть одним из следующих [гео-типов данных](../../data-types/geo.md) или их соответствующих примитивных типов:
  * [Ring](../../data-types/geo.md#ring)
  * [Polygon](../../data-types/geo.md#polygon)
  * [MultiPolygon](../../data-types/geo.md#multipolygon)
* `resolution` — разрешение индекса. Диапазон: `[0, 15]`. [UInt8](../../data-types/int-uint.md).

**Возвращаемые значения**

* Массив, содержащихся H3-индексов. [Array](../../data-types/array.md)([UInt64](../../data-types/int-uint.md)).

**Пример**

Запрос:

```sql
SELECT h3PolygonToCells([(-122.4089866999972145,37.813318999983238),(-122.3544736999993603,37.7198061999978478),(-122.4798767000009008,37.8151571999998453)], 7) AS h3index;
```

Результат:

```text
┌────────────h3index─┐
│ 608692970769612799 │
│ 608692971927240703 │
│ 608692970585063423 │
│ 608692970819944447 │
│ 608692970719281151 │
│ 608692970752835583 │
│ 608692972027903999 │
└────────────────────┘
```

## h3GetBaseCell \\{#h3getbasecell\\}

Возвращает номер базовой ячейки индекса [H3](#h3-index).

**Синтаксис**

```sql
h3GetBaseCell(index)
```

**Параметр**

* `index` — номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* номер базовой ячейки шестиугольника. [UInt8](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
SELECT h3GetBaseCell(612916788725809151) AS basecell;
```

Результат:

```text
┌─basecell─┐
│       12 │
└──────────┘
```

## h3HexAreaM2 \\{#h3hexaream2\\}

Возвращает среднюю площадь шестиугольника в квадратных метрах для указанного разрешения.

**Синтаксис**

```sql
h3HexAreaM2(resolution)
```

**Параметр**

* `resolution` — Разрешение индекса. Диапазон значений: `[0, 15]`. [UInt8](../../data-types/int-uint.md).

**Возвращаемое значение**

* Площадь в квадратных метрах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3HexAreaM2(13) AS area;
```

Результат:

```text
┌─area─┐
│ 43.9 │
└──────┘
```

## h3HexAreaKm2 \\{#h3hexareakm2\\}

Возвращает среднюю площадь шестигранной ячейки в квадратных километрах для заданного разрешения.

**Синтаксис**

```sql
h3HexAreaKm2(resolution)
```

**Параметр**

* `resolution` — Разрешение индекса. Диапазон значений: `[0, 15]`. [UInt8](../../data-types/int-uint.md).

**Возвращаемое значение**

* Площадь в квадратных километрах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3HexAreaKm2(13) AS area;
```

Результат:

```text
┌──────area─┐
│ 0.0000439 │
└───────────┘
```

## h3IndexesAreNeighbors \\{#h3indexesareneighbors\\}

Возвращает, являются ли указанные индексы [H3](#h3-index) соседними.

**Синтаксис**

```sql
h3IndexesAreNeighbors(index1, index2)
```

**Аргументы**

* `index1` — Индекс гексагона. [UInt64](../../data-types/int-uint.md).
* `index2` — Индекс гексагона. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* `1` — Индексы являются соседними. [UInt8](../../data-types/int-uint.md).
* `0` — Индексы не являются соседними. [UInt8](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
SELECT h3IndexesAreNeighbors(617420388351344639, 617420388352655359) AS n;
```

Результат:

```text
┌─n─┐
│ 1 │
└───┘
```

## h3ToChildren \\{#h3tochildren\\}

Возвращает массив дочерних индексов для заданного индекса [H3](#h3-index).

**Синтаксис**

```sql
h3ToChildren(index, resolution)
```

**Аргументы**

* `index` — номер H3-индекса (шестиугольника). [UInt64](../../data-types/int-uint.md).
* `resolution` — разрешение индекса. Диапазон: `[0, 15]`. [UInt8](../../data-types/int-uint.md).

**Возвращаемые значения**

* Массив дочерних H3-индексов. [Array](../../data-types/array.md)([UInt64](../../data-types/int-uint.md)).

**Пример**

Запрос:

```sql
SELECT h3ToChildren(599405990164561919, 6) AS children;
```

Результат:

```text
┌─children───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ [603909588852408319,603909588986626047,603909589120843775,603909589255061503,603909589389279231,603909589523496959,603909589657714687] │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## h3ToParent \\{#h3toparent\\}

Возвращает родительский (более крупного уровня) индекс, содержащий заданный индекс [H3](#h3-index).

**Синтаксис**

```sql
h3ToParent(index, resolution)
```

**Аргументы**

* `index` — номер шестиугольного индекса H3. [UInt64](../../data-types/int-uint.md).
* `resolution` — разрешение индекса. Диапазон: `[0, 15]`. [UInt8](../../data-types/int-uint.md).

**Возвращаемое значение**

* Родительский индекс H3. [UInt64](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
SELECT h3ToParent(599405990164561919, 3) AS parent;
```

Результат:

```text
┌─────────────parent─┐
│ 590398848891879423 │
└────────────────────┘
```

## h3ToString \\{#h3tostring\\}

Преобразует представление индекса типа `H3Index` в строковое представление.

```sql
h3ToString(index)
```

**Параметр**

* `index` — номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Строковое представление индекса H3. [String](../../data-types/string.md).

**Пример**

Запрос:

```sql
SELECT h3ToString(617420388352917503) AS h3_string;
```

Результат:

```text
┌─h3_string───────┐
│ 89184926cdbffff │
└─────────────────┘
```

## stringToH3 \\{#stringtoh3\\}

Преобразует строковое представление в представление типа `H3Index` (UInt64).

**Синтаксис**

```sql
stringToH3(index_str)
```

**Параметр**

* `index_str` — Строковое представление индекса H3. [String](../../data-types/string.md).

**Возвращаемое значение**

* Номер шестиугольника индекса. В случае ошибки возвращает 0. [UInt64](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
SELECT stringToH3('89184926cc3ffff') AS index;
```

Результат:

```text
┌──────────────index─┐
│ 617420388351344639 │
└────────────────────┘
```

## h3GetResolution \\{#h3getresolution-1\\}

Возвращает уровень разрешения индекса [H3](#h3-index).

**Синтаксис**

```sql
h3GetResolution(index)
```

**Параметр**

* `index` — номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Разрешение индекса. Диапазон: `[0, 15]`. [UInt8](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
SELECT h3GetResolution(617420388352917503) AS res;
```

Результат:

```text
┌─res─┐
│   9 │
└─────┘
```

## h3IsResClassIII \\{#h3isresclassiii\\}

Возвращает, имеет ли индекс [H3](#h3-index) разрешение с ориентацией класса III.

**Синтаксис**

```sql
h3IsResClassIII(index)
```

**Параметр**

* `index` — номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* `1` — индекс имеет разрешение с ориентацией класса III. [UInt8](../../data-types/int-uint.md).
* `0` — индекс не имеет разрешения с ориентацией класса III. [UInt8](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
SELECT h3IsResClassIII(617420388352917503) AS res;
```

Результат:

```text
┌─res─┐
│   1 │
└─────┘
```

## h3IsPentagon \\{#h3ispentagon\\}

Возвращает, представляет ли этот индекс [H3](#h3-index) пятиугольную ячейку.

**Синтаксис**

```sql
h3IsPentagon(index)
```

**Параметр**

* `index` — номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* `1` — индекс соответствует пятиугольной ячейке. [UInt8](../../data-types/int-uint.md).
* `0` — индекс не соответствует пятиугольной ячейке. [UInt8](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
SELECT h3IsPentagon(644721767722457330) AS pentagon;
```

Результат:

```text
┌─pentagon─┐
│        0 │
└──────────┘
```

## h3GetFaces \\{#h3getfaces\\}

Возвращает грани икосаэдра, пересекаемые заданным индексом [H3](#h3-index).

**Синтаксис**

```sql
h3GetFaces(index)
```

**Параметр**

* `index` — номер шестиугольного индекса H3. [UInt64](../../data-types/int-uint.md).

**Возвращаемые значения**

* Массив, содержащий грани икосаэдра, пересекаемые заданным индексом H3. [Array](../../data-types/array.md)([UInt64](../../data-types/int-uint.md)).

**Пример**

Запрос:

```sql
SELECT h3GetFaces(599686042433355775) AS faces;
```

Результат:

```text
┌─faces─┐
│ [7]   │
└───────┘
```

## h3CellAreaM2 \\{#h3cellaream2\\}

Возвращает точную площадь указанной ячейки в квадратных метрах, соответствующей заданному входному H3-индексу.

**Синтаксис**

```sql
h3CellAreaM2(index)
```

**Параметр**

* `index` — индекс шестиугольной ячейки. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Площадь ячейки в квадратных метрах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3CellAreaM2(579205133326352383) AS area;
```

Результат:

```text
┌───────────────area─┐
│ 4106166334463.9233 │
└────────────────────┘
```

## h3CellAreaRads2 \\{#h3cellarearads2\\}

Возвращает точную площадь указанной ячейки в квадратных радианах, соответствующей заданному входному H3-индексу.

**Синтаксис**

```sql
h3CellAreaRads2(index)
```

**Параметр**

* `index` — индекс шестиугольника. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Площадь ячейки в квадратных радианах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3CellAreaRads2(579205133326352383) AS area;
```

Результат:

```text
┌────────────────area─┐
│ 0.10116268528089567 │
└─────────────────────┘
```

## h3ToCenterChild \\{#h3tocenterchild\\}

Возвращает центральный дочерний (более детализированный) индекс [H3](#h3-index), содержащийся в заданном индексе [H3](#h3-index) на указанном уровне разрешения.

**Синтаксис**

```sql
h3ToCenterChild(index, resolution)
```

**Параметр**

* `index` — номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).
* `resolution` — разрешение индекса. Диапазон: `[0, 15]`. [UInt8](../../data-types/int-uint.md).

**Возвращаемые значения**

* Индекс [H3](#h3-index) центральной дочерней ячейки, входящей в данный [H3](#h3-index) на указанном уровне разрешения. [UInt64](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
SELECT h3ToCenterChild(577023702256844799,1) AS centerToChild;
```

Результат:

```text
┌──────centerToChild─┐
│ 581496515558637567 │
└────────────────────┘
```

## h3ExactEdgeLengthM \\{#h3exactedgelengthm\\}

Возвращает точную длину однонаправленного ребра, представленного заданным индексом h3, в метрах.

**Синтаксис**

```sql
h3ExactEdgeLengthM(index)
```

**Параметр**

* `index` — номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Точная длина ребра в метрах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3ExactEdgeLengthM(1310277011704381439) AS exactEdgeLengthM;;
```

Результат:

```text
┌───exactEdgeLengthM─┐
│ 195449.63163407316 │
└────────────────────┘
```

## h3ExactEdgeLengthKm \\{#h3exactedgelengthkm\\}

Возвращает точную длину однонаправленного ребра, представленного переданным h3‑индексом, в километрах.

**Синтаксис**

```sql
h3ExactEdgeLengthKm(index)
```

**Параметр**

* `index` — номер индекса шестиугольника. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Точная длина ребра в километрах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3ExactEdgeLengthKm(1310277011704381439) AS exactEdgeLengthKm;;
```

Результат:

```text
┌──exactEdgeLengthKm─┐
│ 195.44963163407317 │
└────────────────────┘
```

## h3ExactEdgeLengthRads \\{#h3exactedgelengthrads\\}

Возвращает точную длину однонаправленного ребра, заданного входным h3-индексом, в радианах.

**Синтаксис**

```sql
h3ExactEdgeLengthRads(index)
```

**Параметр**

* `index` — номер индекса шестиугольника. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Точная длина ребра в радианах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3ExactEdgeLengthRads(1310277011704381439) AS exactEdgeLengthRads;;
```

Результат:

```text
┌──exactEdgeLengthRads─┐
│ 0.030677980118976447 │
└──────────────────────┘
```

## h3NumHexagons \\{#h3numhexagons\\}

Возвращает количество уникальных индексов H3 при заданном разрешении.

**Синтаксис**

```sql
h3NumHexagons(resolution)
```

**Параметр**

* `resolution` — разрешение индекса. Диапазон: `[0, 15]`. [UInt8](../../data-types/int-uint.md).

**Возвращаемое значение**

* Количество H3-индексов. [Int64](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
SELECT h3NumHexagons(3) AS numHexagons;
```

Результат:

```text
┌─numHexagons─┐
│       41162 │
└─────────────┘
```

## h3PointDistM \\{#h3pointdistm\\}

Возвращает расстояние по дуге большого круга («great circle») или по формуле гаверсинуса («haversine») между парами точек GeoCoord (широта/долгота) в метрах.

**Синтаксис**

```sql
h3PointDistM(lat1, lon1, lat2, lon2)
```

**Аргументы**

* `lat1`, `lon1` — широта и долгота точки 1 в градусах. [Float64](../../data-types/float.md).
* `lat2`, `lon2` — широта и долгота точки 2 в градусах. [Float64](../../data-types/float.md).

**Возвращаемые значения**

* Расстояние гаверсинуса или по дуге большого круга в метрах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3PointDistM(-10.0 ,0.0, 10.0, 0.0) AS h3PointDistM;
```

Результат:

```text
┌──────h3PointDistM─┐
│ 2223901.039504589 │
└───────────────────┘
```

## h3PointDistKm \\{#h3pointdistkm\\}

Возвращает расстояние по дуге большого круга (формула гаверсинусов, haversine) между парами точек GeoCoord (широта/долгота), в километрах.

**Синтаксис**

```sql
h3PointDistKm(lat1, lon1, lat2, lon2)
```

**Аргументы**

* `lat1`, `lon1` — широта и долгота первой точки в градусах. [Float64](../../data-types/float.md).
* `lat2`, `lon2` — широта и долгота второй точки в градусах. [Float64](../../data-types/float.md).

**Возвращаемые значения**

* Расстояние по формуле гаверсина (по дуге большого круга) в километрах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3PointDistKm(-10.0 ,0.0, 10.0, 0.0) AS h3PointDistKm;
```

Результат:

```text
┌─────h3PointDistKm─┐
│ 2223.901039504589 │
└───────────────────┘
```

## h3PointDistRads \\{#h3pointdistrads\\}

Возвращает расстояние по «большой окружности» (great-circle distance) или по формуле «haversine» между парами точек GeoCoord (широта/долгота) в радианах.

**Синтаксис**

```sql
h3PointDistRads(lat1, lon1, lat2, lon2)
```

**Аргументы**

* `lat1`, `lon1` — широта и долгота точки 1 в градусах. [Float64](../../data-types/float.md).
* `lat2`, `lon2` — широта и долгота точки 2 в градусах. [Float64](../../data-types/float.md).

**Возвращаемые значения**

* Расстояние по формуле гаверсинуса (по дуге большого круга) в радианах. [Float64](../../data-types/float.md).

**Пример**

Запрос:

```sql
SELECT h3PointDistRads(-10.0 ,0.0, 10.0, 0.0) AS h3PointDistRads;
```

Результат:

```text
┌────h3PointDistRads─┐
│ 0.3490658503988659 │
└────────────────────┘
```

## h3GetRes0Indexes \\{#h3getres0indexes\\}

Возвращает массив всех индексов H3 разрешения 0.

**Синтаксис**

```sql
h3GetRes0Indexes()
```

**Возвращаемые значения**

* Массив всех индексов H3 нулевого уровня разрешения. [Array](../../data-types/array.md)([UInt64](../../data-types/int-uint.md)).

**Пример**

Запрос:

```sql
SELECT h3GetRes0Indexes AS indexes ;
```

Результат:

```text
┌─indexes─────────────────────────────────────┐
│ [576495936675512319,576531121047601151,....]│
└─────────────────────────────────────────────┘
```

## h3GetPentagonIndexes \\{#h3getpentagonindexes\\}

Возвращает все пятиугольные индексы H3 на указанном разрешении.

**Синтаксис**

```sql
h3GetPentagonIndexes(resolution)
```

**Параметр**

* `resolution` — Разрешение индекса. Диапазон: `[0, 15]`. [UInt8](../../data-types/int-uint.md).

**Возвращаемое значение**

* Массив всех пятиугольных H3-индексов. [Array](../../data-types/array.md)([UInt64](../../data-types/int-uint.md)).

**Пример**

Запрос:

```sql
SELECT h3GetPentagonIndexes(3) AS indexes;
```

Результат:

```text
┌─indexes────────────────────────────────────────────────────────┐
│ [590112357393367039,590464201114255359,590816044835143679,...] │
└────────────────────────────────────────────────────────────────┘
```

## h3Line \\{#h3line\\}

Возвращает последовательность индексов между двумя заданными индексами.

**Синтаксис**

```sql
h3Line(start,end)
```

**Параметр**

* `start` — номер гексагона, представляющий начальную точку. [UInt64](../../data-types/int-uint.md).
* `end` — номер гексагона, представляющий конечную точку. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

Массив индексов H3, представляющий цепочку индексов между двумя заданными индексами. [Array](../../data-types/array.md)([UInt64](../../data-types/int-uint.md)).

**Пример**

Запрос:

```sql
 SELECT h3Line(590080540275638271,590103561300344831) AS indexes;
```

Результат:

```text
┌─indexes────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ [590080540275638271,590080471556161535,590080883873021951,590106516237844479,590104385934065663,590103630019821567,590103561300344831] │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## h3Distance \\{#h3distance\\}

Возвращает расстояние в ячейках сетки между двумя указанными индексами.

**Синтаксис**

```sql
h3Distance(start,end)
```

**Параметр**

* `start` — индекс гексагона, представляющий начальную точку. [UInt64](../../data-types/int-uint.md).
* `end` — индекс гексагона, представляющий конечную точку. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Количество ячеек сетки. [Int64](../../data-types/int-uint.md).

Возвращается отрицательное число, если не удалось определить расстояние.

**Пример**

Запрос:

```sql
 SELECT h3Distance(590080540275638271,590103561300344831) AS distance;
```

Результат:

```text
┌─distance─┐
│        7 │
└──────────┘
```

## h3HexRing \\{#h3hexring\\}

Возвращает индексы шестиугольного кольца с центром в заданном исходном индексе h3Index и длиной k.

Возвращает 0, если при вычислении не было обнаружено пятиугольного искажения.

**Синтаксис**

```sql
h3HexRing(index, k)
```

**Параметр**

* `index` — номер гексагона, представляющего исходную ячейку. [UInt64](../../data-types/int-uint.md).
* `k` — расстояние. [UInt64](../../data-types/int-uint.md).

**Возвращаемые значения**

* Массив индексов H3. [Array](../../data-types/array.md)([UInt64](../../data-types/int-uint.md)).

**Пример**

Запрос:

```sql
 SELECT h3HexRing(590080540275638271, toUInt16(1)) AS hexRing;
```

Результат:

```text
┌─hexRing─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ [590080815153545215,590080471556161535,590080677714591743,590077585338138623,590077447899185151,590079509483487231] │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## h3GetUnidirectionalEdge \\{#h3getunidirectionaledge\\}

Возвращает однонаправленный индекс ребра H3 на основе указанных исходной и конечной ячеек и возвращает 0 при ошибке.

**Синтаксис**

```sql
h3GetUnidirectionalEdge(originIndex, destinationIndex)
```

**Параметр**

* `originIndex` — номер исходного индекса Hexagon. [UInt64](../../data-types/int-uint.md).
* `destinationIndex` — номер целевого индекса Hexagon. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Номер индекса однонаправленного ребра Hexagon. [UInt64](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
 SELECT h3GetUnidirectionalEdge(599686042433355775, 599686043507097599) AS edge;
```

Результат:

```text
┌────────────────edge─┐
│ 1248204388774707199 │
└─────────────────────┘
```

## h3UnidirectionalEdgeIsValid \\{#h3unidirectionaledgeisvalid\\}

Определяет, является ли заданный H3Index допустимым индексом однонаправленного ребра. Возвращает 1, если это индекс однонаправленного ребра, и 0 — в противном случае.

**Синтаксис**

```sql
h3UnidirectionalEdgeisValid(index)
```

**Параметр**

* `index` — номер шестиугольного индекса. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* 1 — индекс H3 является корректным однонаправленным ребром. [UInt8](../../data-types/int-uint.md).
* 0 — индекс H3 не является корректным однонаправленным ребром. [UInt8](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
 SELECT h3UnidirectionalEdgeIsValid(1248204388774707199) AS validOrNot;
```

Результат:

```text
┌─validOrNot─┐
│          1 │
└────────────┘
```

## h3GetOriginIndexFromUnidirectionalEdge \\{#h3getoriginindexfromunidirectionaledge\\}

Возвращает индекс исходного шестиугольника по однонаправленному ребру H3Index.

**Синтаксис**

```sql
h3GetOriginIndexFromUnidirectionalEdge(edge)
```

**Параметр**

* `edge` — индекс шестиугольника, представляющий однонаправленное ребро. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Индекс исходного шестиугольника. [UInt64](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
 SELECT h3GetOriginIndexFromUnidirectionalEdge(1248204388774707197) AS origin;
```

Результат:

```text
┌─────────────origin─┐
│ 599686042433355773 │
└────────────────────┘
```

## h3GetDestinationIndexFromUnidirectionalEdge \\{#h3getdestinationindexfromunidirectionaledge\\}

Возвращает индекс конечного шестиугольника на основании однонаправленного ребра `H3Index`.

**Синтаксис**

```sql
h3GetDestinationIndexFromUnidirectionalEdge(edge)
```

**Параметр**

* `edge` — индекс гексагона, представляющего ориентированное ребро. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Индекс целевого гексагона. [UInt64](../../data-types/int-uint.md).

**Пример**

Запрос:

```sql
 SELECT h3GetDestinationIndexFromUnidirectionalEdge(1248204388774707197) AS destination;
```

Результат:

```text
┌────────destination─┐
│ 599686043507097597 │
└────────────────────┘
```

## h3GetIndexesFromUnidirectionalEdge \\{#h3getindexesfromunidirectionaledge\\}

Возвращает индексы исходной и конечной шестиугольных ячеек для заданного однонаправленного ребра H3Index.

**Синтаксис**

```sql
h3GetIndexesFromUnidirectionalEdge(edge)
```

**Параметр**

* `edge` — индекс гексагона, представляющий однонаправленное ребро. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

Кортеж из двух значений `tuple(origin,destination)`:

* `origin` — индекс исходного гексагона. [UInt64](../../data-types/int-uint.md).
* `destination` — индекс целевого гексагона. [UInt64](../../data-types/int-uint.md).

Возвращает `(0,0)`, если переданный аргумент некорректен.

**Пример**

Запрос:

```sql
 SELECT h3GetIndexesFromUnidirectionalEdge(1248204388774707199) AS indexes;
```

Результат:

```text
┌─indexes─────────────────────────────────┐
│ (599686042433355775,599686043507097599) │
└─────────────────────────────────────────┘
```

## h3GetUnidirectionalEdgesFromHexagon \\{#h3getunidirectionaledgesfromhexagon\\}

Возвращает все однонаправленные рёбра для указанного `H3Index`.

**Синтаксис**

```sql
h3GetUnidirectionalEdgesFromHexagon(index)
```

**Параметр**

* `index` — номер шестиугольного индекса, представляющего однонаправленное ребро. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

Массив индексов H3, представляющих каждое однонаправленное ребро. [Array](../../data-types/array.md)([UInt64](../../data-types/int-uint.md)).

**Пример**

Запрос:

```sql
 SELECT h3GetUnidirectionalEdgesFromHexagon(1248204388774707199) AS edges;
```

Результат:

```text
┌─edges─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ [1248204388774707199,1320261982812635135,1392319576850563071,1464377170888491007,1536434764926418943,1608492358964346879] │
└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## h3GetUnidirectionalEdgeBoundary \\{#h3getunidirectionaledgeboundary\\}

Возвращает координаты, определяющие ориентированное ребро.

**Синтаксис**

```sql
h3GetUnidirectionalEdgeBoundary(index)
```

**Параметр**

* `index` — номер шестиугольного индекса, представляющего однонаправленное ребро. [UInt64](../../data-types/int-uint.md).

**Возвращаемое значение**

* Массив пар &#39;(lon, lat)&#39;. [Array](../../data-types/array.md)([Float64](../../data-types/float.md), [Float64](../../data-types/float.md)).

**Пример**

Запрос:

```sql
 SELECT h3GetUnidirectionalEdgeBoundary(1248204388774707199) AS boundary;
```

Результат:

```text
┌─boundary────────────────────────────────────────────────────────────────────────┐
│ [(37.42012867767779,-122.03773496427027),(37.33755608435299,-122.090428929044)] │
└─────────────────────────────────────────────────────────────────────────────────┘
```
