---
slug: '/sql-reference/functions/geo/coordinates'
sidebar_label: 'Географические координаты'
description: 'Документация для Coordinates'
title: 'Функции для работы с географическими координатами'
doc_type: reference
---
## greatCircleDistance {#greatcircledistance}

Вычисляет расстояние между двумя точками на поверхности Земли, используя [формулу большого круга](https://en.wikipedia.org/wiki/Great-circle_distance).

```sql
greatCircleDistance(lon1Deg, lat1Deg, lon2Deg, lat2Deg)
```

**Входные параметры**

- `lon1Deg` — Долгота первой точки в градусах. Диапазон: `[-180°, 180°]`.
- `lat1Deg` — Широта первой точки в градусах. Диапазон: `[-90°, 90°]`.
- `lon2Deg` — Долгота второй точки в градусах. Диапазон: `[-180°, 180°]`.
- `lat2Deg` — Широта второй точки в градусах. Диапазон: `[-90°, 90°]`.

Положительные значения соответствуют северной широте и восточной долготе, отрицательные значения соответствуют южной широте и западной долготе.

**Возвращаемое значение**

Расстояние между двумя точками на поверхности Земли в метрах.

Вызывает исключение, когда значения входных параметров выходят за пределы диапазона.

**Пример**

```sql
SELECT greatCircleDistance(55.755831, 37.617673, -55.755831, -37.617673) AS greatCircleDistance
```

```text
┌─greatCircleDistance─┐
│            14128352 │
└─────────────────────┘
```

## geoDistance {#geodistance}

Аналогично `greatCircleDistance`, но вычисляет расстояние по эллипсоиду WGS-84 вместо сферы. Это более точная оценка геоида Земли.
Производительность такая же, как и у `greatCircleDistance` (нет снижения производительности). Рекомендуется использовать `geoDistance` для вычисления расстояний на Земле.

Техническая заметка: для достаточно близких точек мы вычисляем расстояние с использованием планарного приближения с метрикой на касательной плоскости в средней точке координат.

```sql
geoDistance(lon1Deg, lat1Deg, lon2Deg, lat2Deg)
```

**Входные параметры**

- `lon1Deg` — Долгота первой точки в градусах. Диапазон: `[-180°, 180°]`.
- `lat1Deg` — Широта первой точки в градусах. Диапазон: `[-90°, 90°]`.
- `lon2Deg` — Долгота второй точки в градусах. Диапазон: `[-180°, 180°]`.
- `lat2Deg` — Широта второй точки в градусах. Диапазон: `[-90°, 90°]`.

Положительные значения соответствуют северной широте и восточной долготе, отрицательные значения соответствуют южной широте и западной долготе.

**Возвращаемое значение**

Расстояние между двумя точками на поверхности Земли в метрах.

Вызывает исключение, когда значения входных параметров выходят за пределы диапазона.

**Пример**

```sql
SELECT geoDistance(38.8976, -77.0366, 39.9496, -75.1503) AS geoDistance
```

```text
┌─geoDistance─┐
│   212458.73 │
└─────────────┘
```

## greatCircleAngle {#greatcircleangle}

Вычисляет центральный угол между двумя точками на поверхности Земли, используя [формулу большого круга](https://en.wikipedia.org/wiki/Great-circle_distance).

```sql
greatCircleAngle(lon1Deg, lat1Deg, lon2Deg, lat2Deg)
```

**Входные параметры**

- `lon1Deg` — Долгота первой точки в градусах.
- `lat1Deg` — Широта первой точки в градусах.
- `lon2Deg` — Долгота второй точки в градусах.
- `lat2Deg` — Широта второй точки в градусах.

**Возвращаемое значение**

Центральный угол между двумя точками в градусах.

**Пример**

```sql
SELECT greatCircleAngle(0, 0, 45, 0) AS arc
```

```text
┌─arc─┐
│  45 │
└─────┘
```

## pointInEllipses {#pointinellipses}

Проверяет, принадлежит ли точка хотя бы одной из эллипс.

Координаты являются геометрическими в декартовой системе координат.

```sql
pointInEllipses(x, y, x₀, y₀, a₀, b₀,...,xₙ, yₙ, aₙ, bₙ)
```

**Входные параметры**

- `x, y` — Координаты точки на плоскости.
- `xᵢ, yᵢ` — Координаты центра `i`-го эллипса.
- `aᵢ, bᵢ` — Оси `i`-го эллипса в единицах координат x, y.

Входные параметры должны быть `2+4⋅n`, где `n` — количество эллипсов.

**Возвращаемые значения**

`1`, если точка находится внутри хотя бы одного из эллипсов; `0`, если это не так.

**Пример**

```sql
SELECT pointInEllipses(10., 10., 10., 9.1, 1., 0.9999)
```

```text
┌─pointInEllipses(10., 10., 10., 9.1, 1., 0.9999)─┐
│                                               1 │
└─────────────────────────────────────────────────┘
```

## pointInPolygon {#pointinpolygon}

Проверяет, принадлежит ли точка многоугольнику на плоскости.

```sql
pointInPolygon((x, y), [(a, b), (c, d) ...], ...)
```

**Входные значения**

- `(x, y)` — Координаты точки на плоскости. Тип данных — [Tuple](../../data-types/tuple.md) — Кортеж из двух чисел.
- `[(a, b), (c, d) ...]` — Вершины многоугольника. Тип данных — [Array](../../data-types/array.md). Каждая вершина представлена парой координат `(a, b)`. Вершины должны быть указаны в порядке по часовой стрелке или против часовой стрелки. Минимальное количество вершин — 3. Многоугольник должен быть постоянным.
- Функция поддерживает многоугольники с отверстиями (вырезанные секции). Тип данных — [Polygon](../../data-types/geo.md/#polygon). Либо передайте весь `Polygon` в качестве второго аргумента, либо сначала передайте внешнее кольцо, а затем каждое отверстие в качестве отдельных дополнительных аргументов.
- Функция также поддерживает мультиполигоны. Тип данных — [MultiPolygon](../../data-types/geo.md/#multipolygon). Либо передайте весь `MultiPolygon` в качестве второго аргумента, либо перечислите каждый компонентный многоугольник в качестве отдельного аргумента.

**Возвращаемые значения**

`1`, если точка находится внутри многоугольника, `0`, если это не так.
Если точка находится на границе многоугольника, функция может вернуть либо 0, либо 1.

**Пример**

```sql
SELECT pointInPolygon((3., 3.), [(6, 0), (8, 4), (5, 8), (0, 2)]) AS res
```

```text
┌─res─┐
│   1 │
└─────┘
```

> **Примечание**  
> • Вы можете установить `validate_polygons = 0`, чтобы обойти проверку геометрии.  
> • `pointInPolygon` предполагает, что каждый многоугольник является корректным. Если ввод самопересекающийся, имеет неправильно упорядоченные кольца или пересекающиеся ребра, результаты становятся ненадежными, особенно для точек, которые находятся точно на ребре, вершине или внутри самопересечения, где понятие "внутри" и "снаружи" не определено.