---
'description': 'Документация для финансовых функций'
'sidebar_label': 'Финансовые'
'slug': '/sql-reference/functions/financial-functions'
'title': 'Финансовые функции'
'keywords':
- 'Financial'
- 'rate of return'
- 'net present value'
'doc_type': 'reference'
---
# Финансовые функции

<!-- 
Содержимое тегов ниже заменяется во время сборки документа на 
документацию, сгенерированную из system.functions. Пожалуйста, не изменяйте и не удаляйте теги.
Смотрите: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
-->

<!--AUTOGENERATED_START-->
## financialInternalRateOfReturn {#financialInternalRateOfReturn}

Введено в: v25.7


Вычисляет внутреннюю норму доходности (IRR) для серии денежных потоков, происходящих через регулярные интервалы. IRR — это ставка дисконтирования, при которой чистая приведенная стоимость (NPV) равна нулю.

IRR пытается решить следующее уравнение:

$$
\sum_{i=0}^n \frac{cashflow_i}{(1 + irr)^i} = 0
$$
    

**Синтаксис**

```sql
financialInternalRateOfReturn(cashflows[, guess])
```

**Аргументы**

- `cashflows` — Массив денежных потоков. Каждое значение представляет собой платеж (отрицательное значение) или доход (положительное значение). [`Array(Int8/16/32/64)`](/sql-reference/data-types/array) или [`Array(Float*)`](/sql-reference/data-types/array)
- `[, guess]` — Необязательная начальная оценка (константное значение) для внутренней нормы доходности (по умолчанию 0.1). [`Float*`](/sql-reference/data-types/float)


**Возвращаемое значение**

Возвращает внутреннюю норму доходности или `NaN`, если расчет не может сойтись, входной массив пуст или содержит только один элемент, все денежные потоки равны нулю или произошли другие ошибки вычисления. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**simple_example**

```sql title=Query
SELECT financialInternalRateOfReturn([-100, 39, 59, 55, 20])
```

```response title=Response
0.2809484211599611
```

**simple_example_with_guess**

```sql title=Query
SELECT financialInternalRateOfReturn([-100, 39, 59, 55, 20], 0.1)
```

```response title=Response
0.2809484211599611
```



## financialInternalRateOfReturnExtended {#financialInternalRateOfReturnExtended}

Введено в: v25.7


Вычисляет расширенную внутреннюю норму доходности (XIRR) для серии денежных потоков, происходящих в нерегулярные интервалы. XIRR — это ставка дисконтирования, при которой чистая приведенная стоимость (NPV) всех денежных потоков равна нулю.

XIRR пытается решить следующее уравнение (пример для `ACT_365F`):

$$
\sum_{i=0}^n \frac{cashflow_i}{(1 + rate)^{(date_i - date_0)/365}} = 0
$$

Массивы должны быть отсортированы по дате в порядке возрастания. Даты должны быть уникальными.
    

**Синтаксис**

```sql
financialInternalRateOfReturnExtended(cashflow, date [, guess, daycount])
```

**Аргументы**

- `cashflow` — Массив денежных потоков, соответствующий датам во втором параметре. [`Array(Int8/16/32/64)`](/sql-reference/data-types/array) или [`Array(Float*)`](/sql-reference/data-types/array)
- `date` — Отсортированный массив уникальных дат, соответствующий денежным потокам. [`Array(Date)`](/sql-reference/data-types/array) или [`Array(Date32)`](/sql-reference/data-types/array)
- `[, guess]` — Необязательно. Начальная оценка (константное значение) для расчета XIRR. [`Float*`](/sql-reference/data-types/float)
- `[, daycount]` — 
Необязательная конвенция учета дней (по умолчанию 'ACT_365F'). Поддерживаемые значения:
- 'ACT_365F' - Фактические/365 фиксированные: Использует фактическое количество дней между датами, деленное на 365
- 'ACT_365_25' - Фактические/365.25: Использует фактическое количество дней между датами, деленное на 365.25
             [`String`](/sql-reference/data-types/string)


**Возвращаемое значение**

Возвращает значение XIRR. Если вычисление невозможно, возвращает NaN. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**simple_example**

```sql title=Query
SELECT financialInternalRateOfReturnExtended([-10000, 5750, 4250, 3250], [toDate('2020-01-01'), toDate('2020-03-01'), toDate('2020-10-30'), toDate('2021-02-15')])
```

```response title=Response
0.6342972615260243
```

**simple_example_with_guess**

```sql title=Query
SELECT financialInternalRateOfReturnExtended([-10000, 5750, 4250, 3250], [toDate('2020-01-01'), toDate('2020-03-01'), toDate('2020-10-30'), toDate('2021-02-15')], 0.5)
```

```response title=Response
0.6342972615260243
```

**simple_example_daycount**

```sql title=Query
SELECT round(financialInternalRateOfReturnExtended([100000, -110000], [toDate('2020-01-01'), toDate('2021-01-01')], 0.1, 'ACT_365_25'), 6) AS xirr_365_25
```

```response title=Response
0.099785
```



## financialNetPresentValue {#financialNetPresentValue}

Введено в: v25.7


Вычисляет чистую приведенную стоимость (NPV) серии денежных потоков, предполагая равные интервалы времени между каждым денежным потоком.

Вариант по умолчанию (`start_from_zero` = true):

$$
\sum_{i=0}^{N-1} \frac{values_i}{(1 + rate)^i}
$$

Вариант, совместимый с Excel (`start_from_zero` = false):

$$
\sum_{i=1}^{N} \frac{values_i}{(1 + rate)^i}
$$
    

**Синтаксис**

```sql
financialNetPresentValue(rate, cashflows[, start_from_zero])
```

**Аргументы**

- `rate` — Ставка дисконтирования, которую необходимо применить. [`Float*`](/sql-reference/data-types/float)
- `cashflows` — Массив денежных потоков. Каждое значение представляет собой платеж (отрицательное значение) или доход (положительное значение). [`Array(Int8/16/32/64)`](/sql-reference/data-types/array) или [`Array(Float*)`](/sql-reference/data-types/array)
- `[, start_from_zero]` — Необязательный логический параметр, указывающий, следует ли начинать расчет NPV с периода `0` (true) или с периода `1` (false, совместимый с Excel). По умолчанию: true. [`Bool`](/sql-reference/data-types/boolean)


**Возвращаемое значение**

Возвращает чистую приведенную стоимость в виде значения Float64. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**default_calculation**

```sql title=Query
SELECT financialNetPresentValue(0.08, [-40000., 5000., 8000., 12000., 30000.])
```

```response title=Response
3065.2226681795255
```

**excel_compatible_calculation**

```sql title=Query
SELECT financialNetPresentValue(0.08, [-40000., 5000., 8000., 12000., 30000.], false)
```

```response title=Response
2838.1691372032656
```



## financialNetPresentValueExtended {#financialNetPresentValueExtended}

Введено в: v25.7


Вычисляет расширенную чистую приведенную стоимость (XNPV) для серии денежных потоков, происходящих в нерегулярные интервалы. XNPV учитывает конкретное время каждого денежного потока при вычислении приведенной стоимости.

Уравнение XNPV для `ACT_365F`:

$$
XNPV=\sum_{i=1}^n \frac{cashflow_i}{(1 + rate)^{(date_i - date_0)/365}}
$$

Массивы должны быть отсортированы по дате в порядке возрастания. Даты должны быть уникальными.
    

**Синтаксис**

```sql
financialNetPresentValueExtended(rate, cashflows, dates[, daycount])
```

**Аргументы**

- `rate` — Ставка дисконтирования, которую необходимо применить. [`Float*`](/sql-reference/data-types/float)
- `cashflows` — Массив денежных потоков. Каждое значение представляет собой платеж (отрицательное значение) или доход (положительное значение). Должен содержать хотя бы одно положительное и одно отрицательное значение. [`Array(Int8/16/32/64)`](/sql-reference/data-types/array) или [`Array(Float*)`](/sql-reference/data-types/array)
- `dates` — Массив дат, соответствующий каждому денежному потоку. Должен иметь такой же размер, как массив cashflows. [`Array(Date)`](/sql-reference/data-types/array) или [`Array(Date32)`](/sql-reference/data-types/array)
- `[, daycount]` — Необязательная конвенция учета дней. Поддерживаемые значения: `'ACT_365F'` (по умолчанию) — Фактические/365 фиксированные, `'ACT_365_25'` — Фактические/365.25. [`String`](/sql-reference/data-types/string)


**Возвращаемое значение**

Возвращает чистую приведенную стоимость в виде значения Float64. [`Float64`](/sql-reference/data-types/float)

**Примеры**

**Basic usage**

```sql title=Query
SELECT financialNetPresentValueExtended(0.1, [-10000., 5750., 4250., 3250.], [toDate('2020-01-01'), toDate('2020-03-01'), toDate('2020-10-30'), toDate('2021-02-15')])
```

```response title=Response
2506.579458169746
```

**Using different day count convention**

```sql title=Query
SELECT financialNetPresentValueExtended(0.1, [-10000., 5750., 4250., 3250.], [toDate('2020-01-01'), toDate('2020-03-01'), toDate('2020-10-30'), toDate('2021-02-15')], 'ACT_365_25')
```

```response title=Response
2507.067268742502
```



<!--AUTOGENERATED_END-->