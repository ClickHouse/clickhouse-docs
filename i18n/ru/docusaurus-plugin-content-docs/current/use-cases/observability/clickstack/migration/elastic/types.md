---
slug: /use-cases/observability/clickstack/migration/elastic/types
title: 'Сопоставление типов'
pagination_prev: null
pagination_next: null
sidebar_label: 'Типы'
sidebar_position: 2
description: 'Сопоставление типов в ClickHouse и Elasticsearch'
show_related_blogs: true
keywords: ['JSON', 'Codecs']
doc_type: 'reference'
---

Elasticsearch и ClickHouse поддерживают широкий набор типов данных, но их базовые модели хранения и выполнения запросов принципиально различаются. В этом разделе часто используемые типы полей Elasticsearch сопоставляются с их эквивалентами в ClickHouse, где это возможно, а также приводится контекст, помогающий при миграции. Если точного эквивалента не существует, в комментариях предлагаются альтернативы или пояснения.



| **Тип в Elasticsearch**           | **Аналог в ClickHouse**                                                                                                                                                                                                                                                                  | **Комментарии**                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| --------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `boolean`                         | [`UInt8`](/sql-reference/data-types/int-uint)или[`Bool`](/sql-reference/data-types/boolean)                                                                                                                                                                                              | ClickHouse поддерживает`Boolean`в качестве псевдонима для`UInt8`в более новых версиях                                                                                                                                                                                                                                                                                                                                                                     |
| `keyword`                         | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                             | Используется для фильтрации по точному соответствию, а также для группировки и сортировки.                                                                                                                                                                                                                                                                                                                                                                |
| `text`                            | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                             | Возможности полнотекстового поиска в ClickHouse ограничены; для токенизации требуется пользовательская логика с использованием таких функций, как`tokens`в сочетании с функциями для работы с массивами.                                                                                                                                                                                                                                                  |
| `long`                            | [`Int64`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                            | 64-битное целое знаковое число.                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `integer`                         | [`Int32`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                            | 32-битное целое число со знаком.                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `short`                           | [`Int16`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                            | 16-битное знаковое целое число.                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `byte`                            | [`Int8`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                             | 8-битное знаковое целое число.                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `unsigned_long`                   | [`UInt64`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                           | Беззнаковое целое 64-битное число.                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `double`                          | [`Float64`](/sql-reference/data-types/float)                                                                                                                                                                                                                                             | 64-битное число с плавающей запятой.                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `float`                           | [`Float32`](/sql-reference/data-types/float)                                                                                                                                                                                                                                             | 32-битное число с плавающей точкой.                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `half_float`                      | [`Float32`](/sql-reference/data-types/float)или[`BFloat16`](/sql-reference/data-types/float)                                                                                                                                                                                             | Наиболее близкий эквивалент. В ClickHouse нет 16-битного числа с плавающей запятой. В ClickHouse есть`BFloat16`- это отличается от Half-float IEEE-754: half-float обеспечивает более высокую точность при меньшем диапазоне значений, тогда как bfloat16 жертвует точностью ради более широкого диапазона, что делает его более подходящим для задач машинного обучения.                                                                                 |
| `scaled_float`                    | [`Decimal(x, y)`](/sql-reference/data-types/decimal)                                                                                                                                                                                                                                     | Хранит числа с фиксированной запятой.                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `date`                            | [`DateTime`](/sql-reference/data-types/datetime)                                                                                                                                                                                                                                         | Эквивалентные типы дат с точностью до секунды.                                                                                                                                                                                                                                                                                                                                                                                                            |
| `date_nanos`                      | [`DateTime64`](/sql-reference/data-types/datetime64)                                                                                                                                                                                                                                     | ClickHouse поддерживает наносекундную точность с помощью`DateTime64(9)`.                                                                                                                                                                                                                                                                                                                                                                                  |
| `binary`                          | [`String`](/sql-reference/data-types/string),[`FixedString(N)`](/sql-reference/data-types/fixedstring)                                                                                                                                                                                   | Требуется декодировать в base64 двоичные поля.                                                                                                                                                                                                                                                                                                                                                                                                            |
| `ip`                              | [`IPv4`](/sql-reference/data-types/ipv4)`IPv4`, `IPv6`[`IPv6`](/sql-reference/data-types/ipv6)                                                                                                                                                                                           | Нативный`IPv4`и`IPv6`доступны типы `IPv4` и `IPv6`.                                                                                                                                                                                                                                                                                                                                                                                                       |
| `object`                          | [`Nested`](/sql-reference/data-types/nested-data-structures/nested),[`Map`](/sql-reference/data-types/map),[`Tuple`](/sql-reference/data-types/tuple),[`JSON`](/sql-reference/data-types/newjson)                                                                                        | ClickHouse поддерживает моделирование JSON-подобных объектов с помощью типа `Nested` или `JSON`.[`Nested`](/sql-reference/data-types/nested-data-structures/nested)или[`JSON`](/sql-reference/data-types/newjson)ClickHouse позволяет моделировать объекты, подобные JSON, с помощью типов данных `Nested` или `JSON`.                                                                                                                                    |
| `flattened`                       | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                             | Тип `flattened` в Elasticsearch сохраняет целые JSON-объекты в одном поле, обеспечивая гибкий, схему-независимый доступ к вложенным ключам без полной схемы (mapping). В ClickHouse аналогичную функциональность можно реализовать с помощью типа String, но при этом обработку необходимо выполнять в материализованных представлениях.                                                                                                                  |
| `nested`                          | [`Nested`](/sql-reference/data-types/nested-data-structures/nested)                                                                                                                                                                                                                      | ClickHouse`Nested`столбцы типа `Nested` обеспечивают схожую семантику для сгруппированных подполей при условии, что пользователи используют`flatten_nested=0`Столбцы типа `Nested` в ClickHouse обеспечивают схожую семантику для сгруппированных подполей при условии, что используется настройка `flatten_nested=0`.                                                                                                                                    |
| `join`                            | Н/Д                                                                                                                                                                                                                                                                                      | Нет явного понятия иерархических (родитель‑дочерних) связей. В ClickHouse это не требуется, так как поддерживаются соединения (`JOIN`) между таблицами.                                                                                                                                                                                                                                                                                                   |
| `alias`                           | [`Псевдоним`](/sql-reference/statements/create/table#alias)модификатор столбца                                                                                                                                                                                                           | Псевдонимы[поддерживаются](/sql-reference/statements/create/table#alias)с помощью модификатора поля. К этим псевдонимам можно применять функции, например:`size String ALIAS formatReadableSize(size_bytes)`                                                                                                                                                                                                                                              |
| `range`types (`*_range`)          | [`Tuple(start, end)`](/sql-reference/data-types/tuple)или[`Array(T)`](/sql-reference/data-types/array)                                                                                                                                                                                   | В ClickHouse нет встроенного типа диапазона, но числовые и временные диапазоны можно представлять с помощью[`Tuple(start, end)`](/sql-reference/data-types/tuple)или[`Array`](/sql-reference/data-types/array)структуры. Для диапазонов IP-адресов (`ip_range`), храните значения CIDR как`String`и вычислять с помощью функций, таких как`isIPAddressInRange()`. Или рассмотрите`ip_trie`словарей поиска на основе `ip_trie` для эффективной фильтрации. |
| `aggregate_metric_double`         | [`AggregateFunction(...)`](/sql-reference/data-types/aggregatefunction)и[`SimpleAggregateFunction(...)`](/sql-reference/data-types/simpleaggregatefunction)                                                                                                                              | Используйте состояния агрегатных функций и материализованные представления для моделирования заранее агрегированных метрик. Все агрегатные функции поддерживают состояния.                                                                                                                                                                                                                                                                                |
| `histogram`                       | [`Tuple(Array(Float64), Array(UInt64))`](/sql-reference/data-types/tuple)                                                                                                                                                                                                                | Ручное представление бакетов и счётчиков с помощью массивов или пользовательских схем.                                                                                                                                                                                                                                                                                                                                                                    |
| `annotated-text`                  | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                             | Нет встроенной поддержки поиска, учитывающего сущности, или аннотаций.                                                                                                                                                                                                                                                                                                                                                                                    |
| `completion`,`search_as_you_type` | Н/Д                                                                                                                                                                                                                                                                                      | Нет встроенного движка автодополнения или подсказок. Можно воспроизвести с помощью`String`и[функции поиска в строках](/sql-reference/functions/string-search-functions)Встроенного механизма автодополнения или подсказок нет. Можно воспроизвести с помощью `String` и поисковых функций.                                                                                                                                                                |
| `semantic_text`                   | Н/Д                                                                                                                                                                                                                                                                                      | Нет встроенного семантического поиска — создавайте эмбеддинги и используйте векторный поиск.                                                                                                                                                                                                                                                                                                                                                              |
| `token_count`                     | [`Int32`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                            | Используйте на этапе загрузки данных для ручного подсчёта числа токенов, например:`length(tokens())`функции, например с материализованным столбцом                                                                                                                                                                                                                                                                                                        |
| `dense_vector`                    | [`Array(Float32)`](/sql-reference/data-types/array)                                                                                                                                                                                                                                      | Используйте массивы для хранения векторов признаков                                                                                                                                                                                                                                                                                                                                                                                                       |
| `sparse_vector`                   | [`Map(UInt32, Float32)`](/sql-reference/data-types/map)                                                                                                                                                                                                                                  | Моделируйте разреженные векторы с помощью `Map`. Встроенной поддержки разреженных векторов нет.                                                                                                                                                                                                                                                                                                                                                           |
| `rank_feature`/`rank_features`    | [`Float32`](/sql-reference/data-types/float)На этапе выполнения запроса нет встроенного механизма увеличения веса, но его можно смоделировать вручную в логике скоринга.[`Array(Float32)`](/sql-reference/data-types/array)                                                              | Нет встроенного изменения веса на этапе выполнения запроса, но его можно смоделировать вручную в логике скоринга.                                                                                                                                                                                                                                                                                                                                         |
| `geo_point`                       | [`Tuple(Float64, Float64)`](/sql-reference/data-types/tuple)или[`Point`](/sql-reference/data-types/geo#point)                                                                                                                                                                            | Используйте кортеж вида (широта, долгота).[`Point`](/sql-reference/data-types/geo#point)представлен как тип ClickHouse.                                                                                                                                                                                                                                                                                                                                   |
| `geo_shape`,`shape`               | [`Ring`](/sql-reference/data-types/geo#ring),[`LineString`](/sql-reference/data-types/geo#linestring),[`MultiLineString`](/sql-reference/data-types/geo#multilinestring),[`Polygon`](/sql-reference/data-types/geo#polygon),[`MultiPolygon`](/sql-reference/data-types/geo#multipolygon) | Встроенная поддержка геометрических фигур и пространственной индексации.                                                                                                                                                                                                                                                                                                                                                                                  |
| `percolator`                      | Н/Д                                                                                                                                                                                                                                                                                      | Нет концепции индексирования запросов. Вместо этого используйте стандартный SQL и инкрементальные материализованные представления.                                                                                                                                                                                                                                                                                                                        |
| `version`                         | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                             | В ClickHouse нет встроенного типа для версий. Храните версии как строки и при необходимости используйте пользовательские UDF для семантического сравнения. Рассмотрите нормализацию к числовым форматам, если требуются запросы по диапазонам.                                                                                                                                                                                                            |

### Примечания {#notes}

- **Массивы**: В Elasticsearch все поля изначально поддерживают массивы. В ClickHouse массивы должны быть явно определены (например, `Array(String)`), при этом преимуществом является возможность обращения к конкретным позициям и их запроса, например `an_array[1]`.
- **Мультиполя**: Elasticsearch позволяет индексировать [одно и то же поле несколькими способами](https://www.elastic.co/docs/reference/elasticsearch/mapping-reference/multi-fields#_multi_fields_with_multiple_analyzers) (например, одновременно как `text` и `keyword`). В ClickHouse этот паттерн должен моделироваться с использованием отдельных столбцов или представлений.
- **Типы Map и JSON** - В ClickHouse тип [`Map`](/sql-reference/data-types/map) обычно используется для моделирования динамических структур ключ-значение, таких как `resourceAttributes` и `logAttributes`. Этот тип обеспечивает гибкую загрузку данных без фиксированной схемы, позволяя добавлять произвольные ключи во время выполнения — по сути аналогично JSON-объектам в Elasticsearch. Однако существуют важные ограничения, которые следует учитывать:
  - **Единообразные типы значений**: столбцы [`Map`](/sql-reference/data-types/map) в ClickHouse должны иметь единый тип значений (например, `Map(String, String)`). Значения смешанных типов не поддерживаются без приведения типов.
  - **Издержки производительности**: доступ к любому ключу в [`Map`](/sql-reference/data-types/map) требует загрузки всей структуры в память, что может негативно сказываться на производительности.
  - **Отсутствие подстолбцов**: в отличие от JSON, ключи в [`Map`](/sql-reference/data-types/map) не представлены как настоящие подстолбцы, что ограничивает возможности ClickHouse по индексированию, сжатию и эффективному выполнению запросов.

  Из-за этих ограничений ClickStack переходит от [`Map`](/sql-reference/data-types/map) к улучшенному типу [`JSON`](/sql-reference/data-types/newjson) в ClickHouse. Тип [`JSON`](/sql-reference/data-types/newjson) устраняет многие недостатки `Map`:
  - **Истинное колоночное хранение**: каждый путь JSON хранится как подстолбец, что обеспечивает эффективное сжатие, фильтрацию и векторизованное выполнение запросов.
  - **Поддержка смешанных типов**: различные типы данных (например, целые числа, строки, массивы) могут сосуществовать в рамках одного пути без приведения типов или унификации.
  - **Масштабируемость файловой системы**: внутренние ограничения на динамические ключи (`max_dynamic_paths`) и типы (`max_dynamic_types`) предотвращают неконтролируемое разрастание файлов столбцов на диске даже при наборах ключей с высокой кардинальностью.
  - **Плотное хранение**: значения null и отсутствующие значения хранятся разреженно, чтобы избежать ненужных накладных расходов.

    Тип [`JSON`](/sql-reference/data-types/newjson) особенно хорошо подходит для задач наблюдаемости, предлагая гибкость загрузки данных без фиксированной схемы с производительностью и масштабируемостью нативных типов ClickHouse — что делает его идеальной заменой [`Map`](/sql-reference/data-types/map) в полях динамических атрибутов.

    Для получения дополнительной информации о типе JSON мы рекомендуем [руководство по JSON](https://clickhouse.com/docs/integrations/data-formats/json/overview) и статью [«Как мы создали новый мощный тип данных JSON для ClickHouse»](https://clickhouse.com/blog/a-new-powerful-json-data-type-for-clickhouse).
