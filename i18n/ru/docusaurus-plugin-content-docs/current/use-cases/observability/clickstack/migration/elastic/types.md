---
slug: /use-cases/observability/clickstack/migration/elastic/types
title: 'Типы сопоставлений'
pagination_prev: null
pagination_next: null
sidebar_label: 'Типы'
sidebar_position: 2
description: 'Типы сопоставлений в ClickHouse и Elasticsearch'
show_related_blogs: true
keywords: ['JSON', 'Codecs']
doc_type: 'reference'
---

Elasticsearch и ClickHouse поддерживают широкий спектр типов данных, но их базовые модели хранения и выполнения запросов принципиально различаются. В этом разделе приводятся соответствия часто используемых типов полей Elasticsearch их эквивалентам в ClickHouse, где это возможно, а также пояснения, помогающие при миграции. В случаях, когда эквивалента не существует, в комментариях предоставляются альтернативы или дополнительные замечания.



| **Тип Elasticsearch**              | **Аналог в ClickHouse**                                                                                                                                                                                                                                                                      | **Комментарии**                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ---------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `boolean`                          | [`UInt8`](/sql-reference/data-types/int-uint) или [`Bool`](/sql-reference/data-types/boolean)                                                                                                                                                                                                | ClickHouse поддерживает использование `Boolean` в качестве псевдонима для `UInt8` в новых версиях.                                                                                                                                                                                                                                                                                                                                                                             |
| `keyword`                          | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                                 | Используется для фильтрации по точным совпадениям, группировки и сортировки.                                                                                                                                                                                                                                                                                                                                                                                                   |
| `text`                             | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                                 | Полнотекстовый поиск в ClickHouse ограничен; для токенизации требуется собственная логика с использованием функций, таких как `tokens`, в сочетании с функциями для работы с массивами.                                                                                                                                                                                                                                                                                        |
| `long`                             | [`Int64`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                                | 64-битное знаковое целое число.                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `integer`                          | [`Int32`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                                | 32-битное целое число со знаком.                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `short`                            | [`Int16`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                                | 16-битное целое число со знаком.                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `byte`                             | [`Int8`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                                 | 8-битное целое число со знаком.                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `unsigned_long`                    | [`UInt64`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                               | Беззнаковое целое 64-битное число.                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `double`                           | [`Float64`](/sql-reference/data-types/float)                                                                                                                                                                                                                                                 | 64-битное число с плавающей запятой.                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `float`                            | [`Float32`](/sql-reference/data-types/float)                                                                                                                                                                                                                                                 | 32-битное число с плавающей запятой.                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `half_float`                       | [`Float32`](/sql-reference/data-types/float) или [`BFloat16`](/sql-reference/data-types/float)                                                                                                                                                                                               | Наиболее близкий аналог. В ClickHouse нет 16-битного числа с плавающей запятой. В ClickHouse есть `BFloat16` — он отличается от Half-float IEEE-754: формат half-float обеспечивает более высокую точность при меньшем диапазоне, тогда как bfloat16 жертвует точностью ради более широкого диапазона, что делает его более подходящим для нагрузок машинного обучения.                                                                                                        |
| `scaled_float`                     | [`Decimal(x, y)`](/sql-reference/data-types/decimal)                                                                                                                                                                                                                                         | Хранит числа с фиксированной запятой.                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `date`                             | [`DateTime`](/sql-reference/data-types/datetime)                                                                                                                                                                                                                                             | Эквивалентные типы данных даты с точностью до секунды.                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `date_nanos`                       | [`DateTime64`](/sql-reference/data-types/datetime64)                                                                                                                                                                                                                                         | ClickHouse поддерживает наносекундную точность в `DateTime64(9)`.                                                                                                                                                                                                                                                                                                                                                                                                              |
| `binary`                           | [`String`](/sql-reference/data-types/string), [`FixedString(N)`](/sql-reference/data-types/fixedstring)                                                                                                                                                                                      | Двоичные поля необходимо декодировать из base64.                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `ip`                               | [`IPv4`](/sql-reference/data-types/ipv4), [`IPv6`](/sql-reference/data-types/ipv6)                                                                                                                                                                                                           | Доступны нативные типы `IPv4` и `IPv6`.                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `object`                           | [`Nested`](/sql-reference/data-types/nested-data-structures/nested), [`Map`](/sql-reference/data-types/map), [`Tuple`](/sql-reference/data-types/tuple), [`JSON`](/sql-reference/data-types/newjson)                                                                                         | ClickHouse может моделировать JSON-подобные объекты с помощью [`Nested`](/sql-reference/data-types/nested-data-structures/nested) или [`JSON`](/sql-reference/data-types/newjson).                                                                                                                                                                                                                                                                                             |
| `flattened`                        | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                                 | Тип `flattened` в Elasticsearch сохраняет целые объекты JSON как единые поля, обеспечивая гибкий, «схемолесс» доступ к вложенным ключам без необходимости полного mapping’а. В ClickHouse аналогичную функциональность можно реализовать с помощью типа `String`, но для этого требуется выполнять обработку в материализованных представлениях.                                                                                                                               |
| `nested`                           | [`Nested`](/sql-reference/data-types/nested-data-structures/nested)                                                                                                                                                                                                                          | Столбцы типа `Nested` в ClickHouse обеспечивают аналогичную семантику для сгруппированных подполей при использовании параметра `flatten_nested=0`.                                                                                                                                                                                                                                                                                                                             |
| `join`                             | Н/Д                                                                                                                                                                                                                                                                                          | Нет прямого понятия связей «родитель–потомок». В ClickHouse это не требуется, так как поддерживаются соединения (JOIN) между таблицами.                                                                                                                                                                                                                                                                                                                                        |
| `alias`                            | [`Alias`](/sql-reference/statements/create/table#alias) — модификатор столбца                                                                                                                                                                                                                | Псевдонимы [поддерживаются](/sql-reference/statements/create/table#alias) с помощью модификатора поля. К таким псевдонимам можно применять функции, например: `size String ALIAS formatReadableSize(size_bytes)`                                                                                                                                                                                                                                                               |
| типы диапазонов (`*_range`)        | [`Tuple(start, end)`](/sql-reference/data-types/tuple) или [`Array(T)`](/sql-reference/data-types/array)                                                                                                                                                                                     | В ClickHouse нет собственного типа данных диапазона, но числовые диапазоны и диапазоны дат можно представить с помощью структур [`Tuple(start, end)`](/sql-reference/data-types/tuple) или [`Array`](/sql-reference/data-types/array). Для IP-диапазонов (`ip_range`) храните значения CIDR как `String` и проверяйте их с помощью функций вроде `isIPAddressInRange()`. В качестве альтернативы рассмотрите поисковые словари на основе `ip_trie` для эффективной фильтрации. |
| `aggregate_metric_double`          | [`AggregateFunction(...)`](/sql-reference/data-types/aggregatefunction) и [`SimpleAggregateFunction(...)`](/sql-reference/data-types/simpleaggregatefunction)                                                                                                                                | Используйте состояния агрегатных функций и материализованные представления для формирования предагрегированных метрик. Все агрегатные функции поддерживают работу с агрегатными состояниями.                                                                                                                                                                                                                                                                                   |
| `гистограмма`                      | [`Tuple(Array(Float64), Array(UInt64))`](/sql-reference/data-types/tuple)                                                                                                                                                                                                                    | Задавайте бакеты и значения счётчиков вручную с помощью массивов или пользовательских схем.                                                                                                                                                                                                                                                                                                                                                                                    |
| `annotated-text`                   | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                                 | Нет встроенной поддержки поиска по сущностям или аннотаций.                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `completion`, `search_as_you_type` | Н/Д                                                                                                                                                                                                                                                                                          | Нет встроенного движка автодополнения или подсказок. Это можно реализовать с помощью функций раздела `String` и [функций поиска в строках](/sql-reference/functions/string-search-functions).                                                                                                                                                                                                                                                                                  |
| `semantic_text`                    | Н/Д                                                                                                                                                                                                                                                                                          | Нет встроенного семантического поиска — генерируйте эмбеддинги и используйте векторный поиск.                                                                                                                                                                                                                                                                                                                                                                                  |
| `token_count`                      | [`Int32`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                                | Используйте во время ингестии для ручного подсчёта количества токенов, например с помощью функции `length(tokens())` совместно с материализованным столбцом                                                                                                                                                                                                                                                                                                                    |
| `dense_vector`                     | [`Array(Float32)`](/sql-reference/data-types/array)                                                                                                                                                                                                                                          | Используйте массивы для хранения эмбеддингов                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `sparse_vector`                    | [`Map(UInt32, Float32)`](/sql-reference/data-types/map)                                                                                                                                                                                                                                      | Используйте Map для представления разреженных векторов. Собственной поддержки разреженных векторов нет.                                                                                                                                                                                                                                                                                                                                                                        |
| `rank_feature` / `rank_features`   | [`Float32`](/sql-reference/data-types/float), [`Array(Float32)`](/sql-reference/data-types/array)                                                                                                                                                                                            | Нет нативного бустинга на этапе выполнения запроса, но его можно реализовать вручную в логике вычисления оценок.                                                                                                                                                                                                                                                                                                                                                               |
| `geo_point`                        | [`Tuple(Float64, Float64)`](/sql-reference/data-types/tuple) или [`Point`](/sql-reference/data-types/geo#point)                                                                                                                                                                              | Используйте кортеж (широта, долгота). [`Point`](/sql-reference/data-types/geo#point) доступен в ClickHouse как тип данных.                                                                                                                                                                                                                                                                                                                                                     |
| `geo_shape`, `shape`               | [`Ring`](/sql-reference/data-types/geo#ring), [`LineString`](/sql-reference/data-types/geo#linestring), [`MultiLineString`](/sql-reference/data-types/geo#multilinestring), [`Polygon`](/sql-reference/data-types/geo#polygon), [`MultiPolygon`](/sql-reference/data-types/geo#multipolygon) | Нативная поддержка геометрических объектов и пространственной индексации.                                                                                                                                                                                                                                                                                                                                                                                                      |
| `percolator`                       | Н/Д                                                                                                                                                                                                                                                                                          | Нет понятия индексирования запросов. Вместо этого используйте стандартный SQL и инкрементные материализованные представления.                                                                                                                                                                                                                                                                                                                                                  |
| `version`                          | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                                 | В ClickHouse нет собственного типа данных для версий. Храните версии как строки и при необходимости используйте пользовательские функции (UDF) для выполнения семантических сравнений. Если требуются запросы по диапазону, рассмотрите нормализацию значений до числового формата.                                                                                                                                                                                            |



### Примечания {#notes}

- **Массивы**: в Elasticsearch все поля изначально поддерживают массивы. В ClickHouse массивы должны быть явно определены (например, `Array(String)`), при этом у них есть преимущество — можно обращаться к конкретным позициям и выполнять по ним запросы, например `an_array[1]`.
- **Мультиполя (multi-fields)**: Elasticsearch позволяет индексировать [одно и то же поле несколькими способами](https://www.elastic.co/docs/reference/elasticsearch/mapping-reference/multi-fields#_multi_fields_with_multiple_analyzers) (например, как `text` и `keyword`). В ClickHouse этот паттерн необходимо моделировать с помощью отдельных столбцов или представлений.
- **Типы Map и JSON** — в ClickHouse тип [`Map`](/sql-reference/data-types/map) обычно используется для моделирования динамических структур ключ–значение, таких как `resourceAttributes` и `logAttributes`. Этот тип обеспечивает гибкую ингестию без жёсткой схемы, позволяя добавлять произвольные ключи во время выполнения — по духу схоже с JSON‑объектами в Elasticsearch. Однако есть важные ограничения, которые нужно учитывать:

  - **Однородные типы значений**: столбцы типа [`Map`](/sql-reference/data-types/map) в ClickHouse должны иметь единый тип значения (например, `Map(String, String)`). Значения разных типов не поддерживаются без приведения типов.
  - **Стоимость по производительности**: доступ к любому ключу в [`Map`](/sql-reference/data-types/map) требует загрузки всей Map‑структуры в память, что может быть неоптимально с точки зрения производительности.
  - **Отсутствие подстолбцов**: в отличие от JSON, ключи в [`Map`](/sql-reference/data-types/map) не представлены как полноценные подстолбцы, что ограничивает возможности ClickHouse по индексации, сжатию и эффективному выполнению запросов.

  Из-за этих ограничений ClickStack переходит от использования [`Map`](/sql-reference/data-types/map) к улучшенному типу [`JSON`](/sql-reference/data-types/newjson) в ClickHouse. Тип [`JSON`](/sql-reference/data-types/newjson) устраняет многие недостатки `Map`:

  - **Истинное колоночное хранение**: каждый JSON‑путь хранится как подстолбец, что позволяет эффективно выполнять сжатие, фильтрацию и векторизованное выполнение запросов.
  - **Поддержка смешанных типов**: различные типы данных (например, целые числа, строки, массивы) могут сосуществовать под одним и тем же путём без приведения типов или их унификации.
  - **Масштабируемость на уровне файловой системы**: внутренние ограничения на количество динамических ключей (`max_dynamic_paths`) и типов (`max_dynamic_types`) предотвращают взрывное увеличение числа файлов столбцов на диске даже при высоком количестве различных ключей.
  - **Плотное хранение**: значения `null` и отсутствующие значения хранятся разреженно, чтобы избежать лишних накладных расходов.

    Тип [`JSON`](/sql-reference/data-types/newjson) особенно хорошо подходит для нагрузок, связанных с наблюдаемостью, обеспечивая гибкость ингестии без жёсткой схемы при одновременном сохранении производительности и масштабируемости нативных типов ClickHouse — что делает его идеальной заменой [`Map`](/sql-reference/data-types/map) для динамических полей атрибутов.

    Для получения дополнительной информации о типе JSON мы рекомендуем ознакомиться с [руководством по JSON](https://clickhouse.com/docs/integrations/data-formats/json/overview) и статьёй ["How we built a new powerful JSON data type for ClickHouse"](https://clickhouse.com/blog/a-new-powerful-json-data-type-for-clickhouse).
