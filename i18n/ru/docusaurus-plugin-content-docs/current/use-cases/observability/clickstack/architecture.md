---
slug: /use-cases/observability/clickstack/architecture
pagination_prev: null
pagination_next: null
description: 'Архитектура ClickStack — стека наблюдаемости ClickHouse'
title: 'Архитектура'
doc_type: 'reference'
keywords: ['архитектура ClickStack', 'архитектура наблюдаемости', 'HyperDX', 'коллектор OpenTelemetry', 'MongoDB', 'проектирование системы']
---

import Image from '@theme/IdealImage';
import architecture from '@site/static/images/use-cases/observability/clickstack-architecture.png';

Архитектура ClickStack построена вокруг трех ключевых компонентов: **ClickHouse**, **HyperDX** и коллектора **OpenTelemetry (OTel)**. Экземпляр **MongoDB** используется для хранения состояния приложения. Вместе они формируют высокопроизводительный стек наблюдаемости с открытым исходным кодом, оптимизированный для работы с логами, метриками и трейсами.


## Обзор архитектуры \\{#architecture-overview\\}

<Image img={architecture} alt="Архитектура" size="lg"/>

## ClickHouse: движок базы данных \\{#clickhouse\\}

В основе ClickStack находится ClickHouse — колоночная база данных, разработанная для massively‑масштабируемой аналитики в режиме реального времени. Она обеспечивает приём и выполнение запросов к данным наблюдаемости, позволяя:

- Выполнять поиск с задержкой менее секунды по терабайтам событий
- Принимать до миллиардов записей с высокой кардинальностью в день
- Достигать степени сжатия данных наблюдаемости не менее чем в 10 раз
- Иметь нативную поддержку полуструктурированных данных в формате JSON, что позволяет динамически изменять схему
- Использовать мощный SQL‑движок с сотнями встроенных аналитических функций

ClickHouse обрабатывает данные наблюдаемости как широкие записи событий, что позволяет выполнять глубокую корреляцию между логами, метриками и трейсами в единой унифицированной структуре.

## Коллектор OpenTelemetry: ингестия данных \\{#open-telemetry-collector\\}

ClickStack включает предварительно настроенный коллектор OpenTelemetry (OTel) для приёма телеметрии открытым, стандартизированным способом. Вы можете отправлять данные по протоколу OTLP через:

- gRPC (порт `4317`)
- HTTP (порт `4318`)

Коллектор экспортирует телеметрию в ClickHouse эффективными батчами. Он поддерживает оптимизированные схемы таблиц для каждого источника данных, обеспечивая масштабируемую производительность для всех типов сигналов телеметрии.

## HyperDX: интерфейс \\{#hyperdx\\}

HyperDX — это пользовательский интерфейс для ClickStack. Он предоставляет:

- Поиск на естественном языке и в стиле Lucene
- Live tailing логов для отладки в реальном времени
- Единые представления логов, метрик и трейсов
- Session replay (воспроизведение сессий) для наблюдаемости фронтенда
- Создание дашбордов и настройку оповещений
- SQL-интерфейс для продвинутого анализа

Разработанный специально для ClickHouse, HyperDX сочетает мощный поиск с интуитивными сценариями работы, позволяя вам быстро выявлять аномалии, расследовать проблемы и получать инсайты. 

## MongoDB: состояние приложения \\{#mongo\\}

ClickStack использует MongoDB для хранения состояния на уровне приложения, включая:

- Дашборды
- Оповещения
- Профили пользователей
- Сохранённые визуализации

Такое разделение состояния и данных о событиях обеспечивает высокую производительность и масштабируемость, а также упрощает резервное копирование и настройку.

Такая модульная архитектура позволяет ClickStack предоставлять платформу наблюдаемости «из коробки», которая отличается высокой скоростью работы, гибкостью и основана на открытом исходном коде.