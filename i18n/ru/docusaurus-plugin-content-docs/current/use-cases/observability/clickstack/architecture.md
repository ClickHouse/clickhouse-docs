---
slug: /use-cases/observability/clickstack/architecture
pagination_prev: null
pagination_next: null
description: 'Архитектура ClickStack — стека наблюдаемости ClickHouse'
title: 'Архитектура'
toc_max_heading_level: 2
doc_type: 'reference'
keywords: ['архитектура ClickStack', 'архитектура наблюдаемости', 'HyperDX', 'коллектор OpenTelemetry', 'MongoDB', 'проектирование системы']
---

import Image from '@theme/IdealImage';
import oss_architecture from '@site/static/images/use-cases/observability/clickstack-oss-architecture.png';
import managed_architecture from '@site/static/images/use-cases/observability/clickstack-managed-architecture.png';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

Архитектура ClickStack различается в зависимости от способа развертывания. Существуют важные архитектурные различия между **ClickStack Open Source**, где все компоненты самоуправляемые, и **Managed ClickStack**, где ClickHouse и интерфейс HyperDX размещаются и эксплуатируются в ClickHouse Cloud. Хотя основные компоненты остаются одинаковыми в обеих моделях, ответственность за размещение, масштабирование и защиту каждого компонента отличается.


## Обзор архитектуры \{#architecture-overview\}

Ниже приведён обзор архитектур управляемого и open-source‑вариантов ClickStack.

<Tabs groupId="architectures">
  <TabItem value="managed-clickstack" label="Управляемый ClickStack" default>
    Управляемый ClickStack полностью функционирует внутри **ClickHouse Cloud**, предоставляя полностью управляемый бэкенд для обсервабилити при сохранении той же модели данных ClickStack и пользовательского опыта.

    В этой модели **ClickHouse и интерфейс ClickStack (HyperDX)** размещаются, обслуживаются и защищаются ClickHouse Cloud. Пользователь отвечает только за запуск **OpenTelemetry (OTel) collector**, чтобы отправлять данные телеметрии в управляемый сервис.

    <Image img={managed_architecture} alt="Управляемая архитектура" size="lg" />

    ### ClickHouse Cloud: движок

    В основе управляемого ClickStack находится ClickHouse Cloud — бессерверная версия ClickHouse, столбцовой базы данных, спроектированной для масштабной аналитики в режиме реального времени. Она обеспечивает ингестию и выполнение запросов по данным обсервабилити, что позволяет:

    * Выполнять поиск с задержкой менее секунды по терабайтам событий
    * Обеспечивать ингестию миллиардов записей с высокой кардинальностью в день
    * Достигать высоких степеней сжатия не менее 10x для данных обсервабилити
    * Поддерживать нативную работу с полуструктурированными данными JSON, позволяя динамически изменять схему
    * Использовать мощный SQL-движок с сотнями встроенных аналитических функций

    ClickHouse Cloud обрабатывает данные обсервабилити как широкие события, что позволяет выполнять глубокую корреляцию логов, метрик и трейсов в единой унифицированной структуре.

    Помимо ClickHouse Open Source, ClickHouse Cloud также предоставляет ряд преимуществ для обсервабилити:

    * Автоматическое масштабирование вычислительных ресурсов независимо от хранилища
    * Низкую стоимость и практически неограниченный срок хранения за счёт объектного хранилища
    * Возможность независимо изолировать нагрузки на чтение и запись с помощью Warehouses
    * Интегрированную аутентификацию
    * Автоматизированные бэкапы
    * Функции безопасности и соответствия требованиям
    * Бесшовные обновления

    ### Коллектор OpenTelemetry: ингестия данных

    ClickStack Managed включает предварительно настроенный OpenTelemetry (OTel) collector для приёма телеметрии в открытом, стандартизированном формате. Вы можете отправлять данные, используя протокол OTLP через:

    * gRPC (порт `4317`)
    * HTTP (порт `4318`)

    Collector экспортирует телеметрию в ClickHouse Cloud эффективными пакетами. Он поддерживает оптимизированные схемы таблиц для каждого источника данных, обеспечивая масштабируемую производительность для всех типов сигналов.

    **Этот компонент архитектуры управляется пользователем**

    ### ClickStack UI (HyperDX): интерфейс

    ClickStack UI (HyperDX) — это пользовательский интерфейс для ClickStack. Он предлагает:

    * Поиск на естественном языке и в стиле Lucene
    * Просмотр хвоста логов в режиме реального времени для отладки
    * Унифицированные представления логов, метрик и трейсов
    * Session replay для обсервабилити фронтенда
    * Создание дашбордов и настройку алертов
    * Интерфейс SQL-запросов для продвинутого анализа

    Специально разработанный для ClickHouse, HyperDX сочетает в себе мощный поиск с интуитивными рабочими процессами, позволяя быстро обнаруживать аномалии, исследовать проблемы и получать инсайты.

    В Managed ClickStack UI интегрирован в систему аутентификации консоли ClickHouse Cloud.
  </TabItem>

  <TabItem value="oss-clickstack" label="ClickStack с открытым исходным кодом">
    Архитектура ClickStack Open Source построена вокруг трёх основных компонентов: **ClickHouse**, **HyperDX** и **коллектор OpenTelemetry (OTel)**. Экземпляр **MongoDB** обеспечивает хранение состояния приложения. Вместе они образуют высокопроизводительный open-source‑стек обсервабилити, оптимизированный для логов, метрик и трейсов.

    <Image img={oss_architecture} alt="Architecture" size="lg" />

    ### ClickHouse: движок базы данных

    В основе ClickStack лежит ClickHouse — столбцовая база данных, разработанная для масштабной аналитики в режиме реального времени. Она обеспечивает ингестию и выполнение запросов к данным обсервабилити, позволяя:

    * выполнять поиск с задержкой менее секунды по терабайтам событий;
    * обеспечивать приём миллиардов высококардинальных записей в день;
    * достигать высокой степени сжатия (не менее 10x) для данных обсервабилити;
    * нативно поддерживать полуструктурированные JSON-данные, обеспечивая динамическую эволюцию схемы;
    * использовать мощный SQL-движок с сотнями встроенных аналитических функций.

    ClickHouse обрабатывает данные обсервабилити как широкие события, что позволяет выполнять глубокую корреляцию логов, метрик и трейсов в единой унифицированной структуре.

    ### Коллектор OpenTelemetry: приём данных

    ClickStack включает предварительно настроенный коллектор OpenTelemetry (OTel) для приёма телеметрии в открытом, стандартизированном формате. Вы можете отправлять данные с использованием протокола OTLP через:

    * gRPC (порт `4317`);
    * HTTP (порт `4318`).

    Коллектор экспортирует телеметрию в ClickHouse эффективными пакетами. Он поддерживает оптимизированные схемы таблиц для каждого источника данных, обеспечивая масштабируемую производительность для всех типов сигналов.

    ### ClickStack UI (HyperDX): интерфейс

    ClickStack UI (HyperDX) — это пользовательский интерфейс для ClickStack. Он предоставляет:

    * поиск на естественном языке и в стиле Lucene;
    * live tailing для отладки в режиме реального времени;
    * унифицированные представления логов, метрик и трейсов;
    * session replay для фронтенд-обсервабилити;
    * создание дашбордов и настройку алертов;
    * интерфейс для выполнения SQL-запросов для продвинутой аналитики.

    Разработанный специально для ClickHouse, HyperDX сочетает мощный поиск с интуитивными рабочими процессами, позволяя быстро выявлять аномалии, исследовать инциденты и получать инсайты.

    ### MongoDB: состояние приложения

    ClickStack использует MongoDB для хранения состояния на уровне приложения, включая:

    * дашборды;
    * алерты;
    * профили пользователей;
    * сохранённые визуализации.

    Такое разделение состояния и событийных данных обеспечивает производительность и масштабируемость, упрощая при этом резервное копирование и конфигурацию.

    Подобная модульная архитектура позволяет ClickStack предоставлять готовую к использованию платформу обсервабилити, которая быстра, гибка и является open-source‑решением.
  </TabItem>
</Tabs>