---
slug: /use-cases/observability/clickstack/architecture
pagination_prev: null
pagination_next: null
description: 'Архитектура ClickStack — стека наблюдаемости ClickHouse'
title: 'Архитектура'
doc_type: 'reference'
keywords: ['архитектура ClickStack', 'архитектура системы наблюдаемости', 'HyperDX', 'коллектор OpenTelemetry', 'MongoDB', 'проектирование систем']
---

import Image from '@theme/IdealImage';
import architecture from '@site/static/images/use-cases/observability/clickstack-architecture.png';

Архитектура ClickStack построена вокруг трех основных компонентов: **ClickHouse**, **HyperDX** и **коллектора OpenTelemetry (OTel)**. Экземпляр **MongoDB** обеспечивает хранение состояния приложения. Вместе они формируют высокопроизводительный стек наблюдаемости с открытым исходным кодом, оптимизированный для логов, метрик и трейсов.


## Обзор архитектуры {#architecture-overview}

<Image img={architecture} alt="Схема архитектуры" size="lg"/>



## ClickHouse: движок базы данных {#clickhouse}

В основе ClickStack находится ClickHouse — колоночная база данных, спроектированная для аналитики в режиме реального времени в масштабах производства. Она обеспечивает приём и выполнение запросов к данным наблюдаемости, что позволяет:

- Выполнять поиск с задержкой менее секунды по терабайтам событий
- Обеспечивать ингестию миллиардов записей с высокой кардинальностью в день
- Достигать коэффициента сжатия не менее чем в 10 раз для данных наблюдаемости
- Предоставлять нативную поддержку полуструктурированных данных в формате JSON с возможностью динамического развития схемы
- Использовать мощный SQL-движок с сотнями встроенных аналитических функций

ClickHouse обрабатывает данные наблюдаемости как широкие события, что позволяет выполнять глубокую корреляцию логов, метрик и трейсов в единой унифицированной структуре.



## Коллектор OpenTelemetry: ингестия данных {#open-telemetry-collector}

ClickStack включает преднастроенный коллектор OpenTelemetry (OTel) для приёма телеметрии открытым, стандартизованным способом. Пользователи могут отправлять данные по протоколу OTLP через:

- gRPC (порт `4317`)
- HTTP (порт `4318`)

Коллектор экспортирует телеметрию в ClickHouse эффективными пакетами. Он поддерживает оптимизированные схемы таблиц для каждого источника данных, обеспечивая масштабируемую производительность для всех типов сигналов телеметрии.



## HyperDX: интерфейс {#hyperdx}

HyperDX — это пользовательский интерфейс для ClickStack. Он предоставляет:

- Поиск на естественном языке и поиск в стиле Lucene
- Live tailing (онлайн-просмотр логов) для отладки в реальном времени
- Унифицированные представления логов, метрик и трейсов
- Session replay (воспроизведение сессий) для наблюдаемости фронтенда
- Создание дашбордов и настройка оповещений
- Интерфейс для выполнения SQL-запросов для продвинутого анализа

Созданный специально для ClickHouse, HyperDX сочетает мощный поиск с интуитивными сценариями работы, позволяя пользователям быстро выявлять аномалии, расследовать проблемы и получать ценные инсайты. 



## MongoDB: состояние приложения {#mongo}

ClickStack использует MongoDB для хранения состояния на уровне приложения, включая:

- Дашборды
- Оповещения
- Профили пользователей
- Сохранённые визуализации

Такое разделение состояния и событийных данных обеспечивает высокую производительность и масштабируемость, а также упрощает резервное копирование и управление конфигурацией.

Такая модульная архитектура позволяет ClickStack предоставлять платформу наблюдаемости «из коробки», которая является быстрой, гибкой и с открытым исходным кодом.
