---
slug: /use-cases/observability/cloud-monitoring
title: 'Мониторинг ClickHouse Cloud'
sidebar_label: 'Мониторинг ClickHouse Cloud'
description: 'Руководство по мониторингу ClickHouse Cloud'
doc_type: 'guide'
keywords: ['наблюдаемость', 'мониторинг', 'облако', 'метрики', 'состояние системы']
---

import AdvancedDashboard from '@site/static/images/cloud/manage/monitoring/advanced_dashboard.png';
import NativeAdvancedDashboard from '@site/static/images/cloud/manage/monitoring/native_advanced_dashboard.png';
import Image from '@theme/IdealImage';
import ObservabilityIntegrations from '@site/i18n/ru/docusaurus-plugin-content-docs/current/_snippets/_observability_integration_options.md';
import DirectIntegrations from '@site/i18n/ru/docusaurus-plugin-content-docs/current/_snippets/_direct_observability_integration_options.md';
import CommunityMonitoring from '@site/i18n/ru/docusaurus-plugin-content-docs/current/_snippets/_community_monitoring.md';

# Мониторинг ClickHouse Cloud {#cloud-monitoring}

Это руководство предоставляет корпоративным командам, оценивающим ClickHouse Cloud, подробную информацию о возможностях мониторинга и наблюдаемости для продуктивных развертываний. Корпоративные клиенты часто спрашивают о встроенных возможностях мониторинга, интеграции с существующими стеками наблюдаемости, включая такие инструменты, как Datadog и AWS CloudWatch, а также о том, как возможности мониторинга ClickHouse Cloud соотносятся с развертываниями в self-hosted‑средах.

## Расширенная панель наблюдения {#advanced-observability}

ClickHouse Cloud предоставляет всесторонний мониторинг через встроенные панели, доступные в разделе Monitoring. Эти панели отображают системные метрики и метрики производительности в режиме реального времени без дополнительной настройки и служат основными инструментами для мониторинга боевых сред в ClickHouse Cloud.

- **Advanced Dashboard**: Основной интерфейс панели, доступный через Monitoring → Advanced dashboard, обеспечивает мониторинг в реальном времени показателей скорости запросов, использования ресурсов, состояния системы и производительности хранилища. Для этой панели не требуется отдельная аутентификация, она не мешает экземплярам переходить в режим простоя и не добавляет нагрузку запросами на вашу продуктивную систему. Каждая визуализация построена на настраиваемых SQL‑запросах; готовые диаграммы сгруппированы по метрикам, специфичным для ClickHouse, метрикам состояния системы и метрикам, специфичным для Cloud. Пользователи могут расширять мониторинг, создавая собственные запросы непосредственно в SQL‑консоли.

:::note
Доступ к этим метрикам не генерирует запрос к базовому сервису и не выводит из режима простоя простаивающие сервисы. 
:::

<Image img={AdvancedDashboard} size="lg" alt="Расширенная панель наблюдения"/>

Пользователи, которые хотят расширить эти визуализации, могут использовать возможности панелей мониторинга в ClickHouse Cloud, выполняя запросы напрямую к системным таблицам.

- **Native advanced dashboard**: Альтернативный интерфейс панели, доступный по ссылке «You can still access the native advanced dashboard» в разделе Monitoring. Он открывается в отдельной вкладке с аутентификацией и предоставляет альтернативный интерфейс для мониторинга состояния системы и сервиса. Эта панель поддерживает расширенную аналитику, позволяя пользователям изменять базовые SQL‑запросы.

<Image img={NativeAdvancedDashboard} size="lg" alt="Расширенная панель наблюдения"/>

Обе панели обеспечивают оперативное представление о состоянии и производительности сервиса без внешних зависимостей, что отличает их от внешних инструментов, ориентированных на отладку, таких как ClickStack.

Подробное описание возможностей панелей и доступных метрик см. в [документации по расширенной панели наблюдения](/cloud/manage/monitor/advanced-dashboard).

## Аналитика запросов и мониторинг ресурсов {#query-insights}

ClickHouse Cloud включает дополнительные средства мониторинга:

- Query Insights: встроенный интерфейс для анализа производительности запросов и устранения неполадок
- Resource Utilization Dashboard: отслеживает использование памяти, распределение CPU и характер передачи данных. Графики использования CPU и памяти показывают максимальное значение соответствующей метрики за определённый период времени. График использования CPU отображает метрику загрузки CPU на уровне системы (а не метрику загрузки CPU ClickHouse). 

См. документацию по [аналитике запросов](/cloud/get-started/query-insights) и [использованию ресурсов](/operations/monitoring#resource-utilization) для подробного описания возможностей.

## Совместимая с Prometheus конечная точка метрик {#prometheus}

ClickHouse Cloud предоставляет конечную точку, совместимую с Prometheus. Это позволяет вам сохранять текущие рабочие процессы, использовать существующий опыт команды и интегрировать метрики ClickHouse в корпоративные платформы мониторинга, включая Grafana, Datadog и другие инструменты, совместимые с Prometheus. 

Конечная точка на уровне организации агрегирует метрики от всех сервисов, а конечные точки для отдельных сервисов обеспечивают детализированный мониторинг. Ключевые возможности включают:

- Опция фильтрации метрик: необязательный параметр `filtered_metrics=true` сокращает объём данных с более чем 1000 доступных метрик до 125 «критически важных» метрик для оптимизации затрат и упрощения мониторинга.
- Кэшированная доставка метрик: использует материализованные представления, обновляемые каждую минуту, чтобы минимизировать нагрузку от запросов на производственные системы.

:::note
Этот подход учитывает поведение простаивающих сервисов, позволяя оптимизировать затраты, когда сервисы не выполняют активную обработку запросов. Эта конечная точка API использует учетные данные API ClickHouse Cloud. Полные сведения о конфигурации конечной точки смотрите в [документации по Prometheus](/integrations/prometheus).
:::

<ObservabilityIntegrations/>

### Варианты развертывания ClickStack {#clickstack-deployment}

- **HyperDX в ClickHouse Cloud** (закрытый предварительный релиз): HyperDX можно запустить на любом сервисе ClickHouse Cloud.
- [Helm](/use-cases/observability/clickstack/deployment/helm): Рекомендуется для Kubernetes-сред для отладки. Поддерживает интеграцию с ClickHouse Cloud и позволяет настраивать конфигурацию для конкретной среды, лимиты ресурсов и масштабирование через `values.yaml`.
- [Docker Compose](/use-cases/observability/clickstack/deployment/docker-compose): Разворачивает каждый компонент (ClickHouse, HyperDX, OTel collector, MongoDB) отдельно. Вы можете изменить compose-файл, чтобы удалить неиспользуемые компоненты при интеграции с ClickHouse Cloud, в частности ClickHouse и OTel collector.
- [Только HyperDX](/use-cases/observability/clickstack/deployment/hyperdx-only): Автономный контейнер HyperDX.

Полный перечень вариантов развертывания и подробности архитектуры см. в [документации ClickStack](/use-cases/observability/clickstack/overview) и [руководстве по ингестии данных](/use-cases/observability/clickstack/ingesting-data/overview).

:::note
Вы также можете собирать метрики с Prometheus-эндпоинта ClickHouse Cloud через коллектор OpenTelemetry и пересылать их в отдельное развертывание ClickStack для визуализации.
:::

<DirectIntegrations/>

<CommunityMonitoring/>

## Соображения по влиянию на систему {#system-impact}

Все перечисленные выше подходы в разной степени опираются либо на эндпоинты Prometheus, либо управляются ClickHouse Cloud, либо выполняют прямые запросы к системным таблицам.
Последний из этих вариантов основан на выполнении запросов к продукционной службе ClickHouse. Это добавляет дополнительную нагрузку на наблюдаемую систему за счёт выполнения запросов и мешает экземплярам ClickHouse Cloud простаивать, что влияет на оптимизацию затрат. Кроме того, в случае отказа продукционной системы мониторинг также может пострадать, так как они тесно связаны. Этот подход хорошо подходит для глубокого анализа работы системы и отладки, но менее уместен для мониторинга продукционных систем в реальном времени. Учитывайте этот баланс между возможностями детального анализа системы и операционными накладными расходами при оценке прямой интеграции с Grafana по сравнению с подходами интеграции через внешние инструменты, обсуждаемыми в следующем разделе.