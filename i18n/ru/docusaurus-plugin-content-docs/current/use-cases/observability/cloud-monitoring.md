---
slug: /use-cases/observability/cloud-monitoring
title: 'Мониторинг ClickHouse Cloud'
sidebar_label: 'Мониторинг ClickHouse Cloud'
description: 'Руководство по мониторингу ClickHouse Cloud'
doc_type: 'guide'
keywords: ['наблюдаемость', 'мониторинг', 'облако', 'метрики', 'состояние системы']
---

import AdvancedDashboard from '@site/static/images/cloud/manage/monitoring/advanced_dashboard.png';
import NativeAdvancedDashboard from '@site/static/images/cloud/manage/monitoring/native_advanced_dashboard.png';
import Image from '@theme/IdealImage';
import ObservabilityIntegrations from '@site/docs/_snippets/_observability_integration_options.md';
import DirectIntegrations from '@site/docs/_snippets/_direct_observability_integration_options.md';
import CommunityMonitoring from '@site/docs/_snippets/_community_monitoring.md';


# Мониторинг ClickHouse Cloud {#cloud-monitoring}

В этом руководстве представлена подробная информация о возможностях мониторинга и наблюдаемости в продуктивных развертываниях для корпоративных команд, оценивающих ClickHouse Cloud. Корпоративные клиенты часто задают вопросы о возможностях мониторинга «из коробки», интеграции с существующими стеками наблюдаемости, включая такие инструменты, как Datadog и AWS CloudWatch, а также о том, чем мониторинг ClickHouse Cloud отличается от мониторинга в развертываниях с самостоятельным управлением.



## Расширенная панель наблюдаемости {#advanced-observability}

ClickHouse Cloud предоставляет расширенный мониторинг через встроенные интерфейсы панелей, доступные в разделе Monitoring. Эти панели визуализируют системные метрики и метрики производительности в режиме реального времени без дополнительной настройки и служат основными инструментами для оперативного мониторинга продакшн-сред в ClickHouse Cloud.

- **Advanced Dashboard**: Основной интерфейс панели, доступный через Monitoring → Advanced dashboard, обеспечивает наблюдаемость в режиме реального времени за частотой запросов, использованием ресурсов, состоянием системы и производительностью подсистемы хранения. Эта панель не требует отдельной аутентификации, не препятствует переходу инстансов в состояние простоя и не добавляет дополнительную нагрузку запросами на вашу продакшн-систему. Каждая визуализация основана на настраиваемых SQL-запросах; встроенные графики сгруппированы по метрикам, специфичным для ClickHouse, метрикам состояния системы и метрикам, специфичным для ClickHouse Cloud. Пользователи могут расширять мониторинг, создавая пользовательские запросы непосредственно в SQL-консоли.

:::note
Доступ к этим метрикам не приводит к выполнению запроса к подлежащему сервису и не выводит неактивные сервисы из состояния простоя. 
:::

<Image img={AdvancedDashboard} size="lg" alt="Расширенная панель наблюдаемости"/>

Пользователи, желающие расширить эти визуализации, могут использовать функциональность панелей в ClickHouse Cloud, выполняя запросы к системным таблицам напрямую.

- **Native advanced dashboard**: Альтернативный интерфейс панели, доступный по ссылке «You can still access the native advanced dashboard» в разделе Monitoring. Он открывается в отдельной вкладке с аутентификацией и предоставляет альтернативный UI для мониторинга состояния системы и сервисов. Эта панель поддерживает расширенную аналитику, позволяя пользователям изменять базовые SQL-запросы.

<Image img={NativeAdvancedDashboard} size="lg" alt="Расширенная панель наблюдаемости"/>

Обе панели обеспечивают оперативное представление о состоянии сервиса и его производительности без внешних зависимостей, что отличает их от внешних инструментов, ориентированных на отладку, таких как ClickStack.

Подробное описание возможностей панелей и доступных метрик см. в [документации по расширенной панели](/cloud/manage/monitor/advanced-dashboard).



## Анализ запросов и мониторинг ресурсов {#query-insights}

ClickHouse Cloud включает дополнительные возможности мониторинга:

- Query Insights: встроенный интерфейс для анализа производительности запросов и устранения неполадок
- Resource Utilization Dashboard: панель мониторинга, которая отслеживает использование памяти, распределение CPU и характер передачи данных. Графики использования CPU и памяти показывают максимальное значение показателя загрузки за определённый период времени. График использования CPU показывает показатель загрузки CPU на уровне системы (НЕ показатель загрузки CPU ClickHouse). 

См. документацию по [анализу запросов](/cloud/get-started/query-insights) и [использованию ресурсов](/operations/monitoring#resource-utilization) для получения подробной информации о функциях.



## Совместимая с Prometheus конечная точка метрик {#prometheus}

ClickHouse Cloud предоставляет конечную точку Prometheus. Это позволяет пользователям сохранять существующие рабочие процессы, использовать экспертизу текущей команды и интегрировать метрики ClickHouse в корпоративные платформы мониторинга, включая Grafana, Datadog и другие инструменты, совместимые с Prometheus. 

Конечная точка на уровне организации агрегирует метрики со всех сервисов, тогда как конечные точки на уровне сервиса обеспечивают детализированный мониторинг. Ключевые возможности включают:
- Опция отфильтрованных метрик: необязательный параметр filtered_metrics=true сокращает объём данных с более чем 1000 доступных метрик до 125 критически важных метрик для оптимизации затрат и упрощения фокуса мониторинга
- Кэшированная доставка метрик: использует материализованные представления, обновляемые каждую минуту, чтобы минимизировать нагрузку запросов на продуктивные системы

:::note
Этот подход учитывает поведение простоя сервисов, позволяя оптимизировать затраты, когда сервисы не обрабатывают запросы активно. Эта конечная точка API использует учётные данные API ClickHouse Cloud. Для получения полной информации о конфигурации конечной точки см. облачную [документацию по Prometheus](/integrations/prometheus).
:::

<ObservabilityIntegrations/>

### Варианты развертывания ClickStack {#clickstack-deployment}

- **HyperDX в ClickHouse Cloud** (закрытый предварительный доступ): HyperDX можно запустить на любом сервисе ClickHouse Cloud.
- [Helm](/use-cases/observability/clickstack/deployment/helm): Рекомендуется для сред отладки на базе Kubernetes. Поддерживает интеграцию с ClickHouse Cloud и позволяет выполнять конфигурирование, ограничение ресурсов и масштабирование для конкретной среды через `values.yaml`.
- [Docker Compose](/use-cases/observability/clickstack/deployment/docker-compose): Развёртывает каждый компонент (ClickHouse, HyperDX, OTel collector, MongoDB) отдельно. Пользователи могут изменять compose-файл, чтобы удалить любые неиспользуемые компоненты при интеграции с ClickHouse Cloud, в частности ClickHouse и OTel collector.
- [Только HyperDX](/use-cases/observability/clickstack/deployment/hyperdx-only): Автономный контейнер HyperDX.

Для получения полной информации о вариантах развертывания и архитектуре см. [документацию ClickStack](/use-cases/observability/clickstack/overview) и [руководство по ингестии данных](/use-cases/observability/clickstack/ingesting-data/overview).

:::note
Пользователи также могут собирать метрики с конечной точки Prometheus ClickHouse Cloud через OTel collector и перенаправлять их в отдельное развертывание ClickStack для визуализации.
:::

<DirectIntegrations/>

<CommunityMonitoring/>



## Соображения по влиянию на систему {#system-impact}

Все перечисленные выше подходы используют комбинацию: либо опираются на endpoints Prometheus, либо управляются ClickHouse Cloud, либо выполняют запросы непосредственно к системным таблицам.
Последний из этих вариантов основан на выполнении запросов к продакшн-сервису ClickHouse. Это добавляет дополнительную нагрузку запросов на наблюдаемую систему и не позволяет экземплярам ClickHouse Cloud простаивать, что влияет на оптимизацию затрат. Кроме того, если продакшн-система выходит из строя, мониторинг также может пострадать, поскольку эти системы связаны. Такой подход хорошо подходит для глубокой интроспекции и отладки, но менее уместен для мониторинга продакшн-систем в режиме реального времени. Учитывайте эти компромиссы между возможностями детального анализа системы и операционными накладными расходами при оценке прямой интеграции с Grafana по сравнению с подходами интеграции через внешние инструменты, рассмотренными в следующем разделе.
