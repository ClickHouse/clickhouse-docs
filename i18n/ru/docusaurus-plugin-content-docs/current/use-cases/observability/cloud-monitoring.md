---
slug: /use-cases/observability/cloud-monitoring
title: 'Мониторинг ClickHouse Cloud'
sidebar_label: 'Мониторинг ClickHouse Cloud'
description: 'Руководство по мониторингу ClickHouse Cloud'
doc_type: 'guide'
keywords: ['наблюдаемость', 'мониторинг', 'облако', 'метрики', 'состояние системы']
---

import AdvancedDashboard from '@site/static/images/cloud/manage/monitoring/advanced_dashboard.png';
import NativeAdvancedDashboard from '@site/static/images/cloud/manage/monitoring/native_advanced_dashboard.png';
import Image from '@theme/IdealImage';
import ObservabilityIntegrations from '@site/docs/_snippets/_observability_integration_options.md';
import DirectIntegrations from '@site/docs/_snippets/_direct_observability_integration_options.md';
import CommunityMonitoring from '@site/docs/_snippets/_community_monitoring.md';


# Мониторинг ClickHouse Cloud {#cloud-monitoring}

Это руководство предоставляет корпоративным командам, которые оценивают ClickHouse Cloud, исчерпывающую информацию о возможностях мониторинга и наблюдаемости для промышленных развертываний. Корпоративные клиенты часто задают вопросы о готовых функциях мониторинга, интеграции с существующими стеками наблюдаемости, включая такие инструменты, как Datadog и AWS CloudWatch, а также о том, чем мониторинг ClickHouse отличается от мониторинга в самостоятельно размещаемых развертываниях.


## Расширенная панель наблюдаемости {#advanced-observability}

ClickHouse Cloud обеспечивает комплексный мониторинг через встроенные интерфейсы панелей, доступные в разделе Monitoring. Эти панели визуализируют системные метрики и метрики производительности в режиме реального времени без необходимости дополнительной настройки и служат основными инструментами для мониторинга production-систем в реальном времени в ClickHouse Cloud.

- **Advanced Dashboard**: Основной интерфейс панели, доступный через Monitoring → Advanced dashboard, обеспечивает видимость в режиме реального времени частоты запросов, использования ресурсов, состояния системы и производительности хранилища. Эта панель не требует отдельной аутентификации, не препятствует переходу инстансов в режим простоя и не создает дополнительную нагрузку запросами на вашу production-систему. Каждая визуализация основана на настраиваемых SQL-запросах, при этом готовые графики сгруппированы по метрикам, специфичным для ClickHouse, метрикам состояния системы и метрикам, специфичным для Cloud. Пользователи могут расширить мониторинг, создавая пользовательские запросы непосредственно в SQL-консоли.

:::note
Доступ к этим метрикам не выполняет запрос к базовому сервису и не выводит из режима простоя неактивные сервисы.
:::

<Image img={AdvancedDashboard} size='lg' alt='Advanced dashboard' />

Пользователи, желающие расширить эти визуализации, могут использовать функцию панелей в ClickHouse Cloud, выполняя запросы к системным таблицам напрямую.

- **Native advanced dashboard**: Альтернативный интерфейс панели, доступный через ссылку «You can still access the native advanced dashboard» в разделе Monitoring. Он открывается в отдельной вкладке с аутентификацией и предоставляет альтернативный пользовательский интерфейс для мониторинга состояния системы и сервисов. Эта панель позволяет выполнять расширенную аналитику, где пользователи могут изменять базовые SQL-запросы.

<Image img={NativeAdvancedDashboard} size='lg' alt='Advanced dashboard' />

Обе панели обеспечивают немедленную видимость состояния и производительности сервисов без внешних зависимостей, что отличает их от внешних инструментов, ориентированных на отладку, таких как ClickStack.

Подробную информацию о возможностях панели и доступных метриках см. в [документации по расширенной панели мониторинга](/cloud/manage/monitor/advanced-dashboard).


## Анализ запросов и мониторинг ресурсов {#query-insights}

ClickHouse Cloud включает дополнительные возможности мониторинга:

- Query Insights: встроенный интерфейс для анализа производительности запросов и устранения неполадок
- Resource Utilization Dashboard: отслеживает использование памяти, распределение ЦП и шаблоны передачи данных. Графики использования ЦП и памяти показывают максимальное значение метрики за определённый период времени. График использования ЦП отображает метрику использования ЦП на уровне системы (НЕ метрику использования ЦП самим ClickHouse).

Подробное описание функций см. в документации по [анализу запросов](/cloud/get-started/query-insights) и [использованию ресурсов](/operations/monitoring#resource-utilization).


## Конечная точка метрик, совместимая с Prometheus {#prometheus}

ClickHouse Cloud предоставляет конечную точку Prometheus. Это позволяет пользователям сохранять существующие рабочие процессы, использовать имеющийся опыт команды и интегрировать метрики ClickHouse в корпоративные платформы мониторинга, включая Grafana, Datadog и другие инструменты, совместимые с Prometheus.

Конечная точка на уровне организации объединяет метрики со всех сервисов, в то время как конечные точки отдельных сервисов обеспечивают детальный мониторинг. Основные возможности включают:

- Опция фильтрации метрик: необязательный параметр filtered_metrics=true сокращает объем данных с более чем 1000 доступных метрик до 125 «критически важных» метрик для оптимизации затрат и упрощения фокуса мониторинга
- Кэшированная доставка метрик: использует материализованные представления, обновляемые каждую минуту, для минимизации нагрузки запросов на производственные системы

:::note
Этот подход учитывает режим простоя сервисов, позволяя оптимизировать затраты, когда сервисы не обрабатывают запросы активно. Эта конечная точка API использует учетные данные ClickHouse Cloud API. Полные сведения о конфигурации конечной точки см. в облачной [документации Prometheus](/integrations/prometheus).
:::

<ObservabilityIntegrations />

### Варианты развертывания ClickStack {#clickstack-deployment}

- **HyperDX в ClickHouse Cloud** (закрытая предварительная версия): HyperDX можно запустить на любом сервисе ClickHouse Cloud.
- [Helm](/use-cases/observability/clickstack/deployment/helm): рекомендуется для сред отладки на базе Kubernetes. Поддерживает интеграцию с ClickHouse Cloud и позволяет настраивать конфигурацию для конкретной среды, ограничения ресурсов и масштабирование через `values.yaml`.
- [Docker Compose](/use-cases/observability/clickstack/deployment/docker-compose): развертывает каждый компонент (ClickHouse, HyperDX, сборщик OTel, MongoDB) отдельно. Пользователи могут изменить файл compose для удаления неиспользуемых компонентов при интеграции с ClickHouse Cloud, в частности ClickHouse и Open Telemetry Collector.
- [Только HyperDX](/use-cases/observability/clickstack/deployment/hyperdx-only): автономный контейнер HyperDX.

Полные варианты развертывания и сведения об архитектуре см. в [документации ClickStack](/use-cases/observability/clickstack/overview) и [руководстве по приему данных](/use-cases/observability/clickstack/ingesting-data/overview).

:::note
Пользователи также могут собирать метрики из конечной точки Prometheus ClickHouse Cloud через OpenTelemetry Collector и пересылать их в отдельное развертывание ClickStack для визуализации.
:::

<DirectIntegrations />

<CommunityMonitoring />


## Влияние на систему {#system-impact}

Все вышеперечисленные подходы используют комбинацию методов: использование конечных точек Prometheus, управление через ClickHouse Cloud или прямые запросы к системным таблицам.
Последний из этих вариантов предполагает выполнение запросов к продуктивному сервису ClickHouse. Это создает дополнительную нагрузку на наблюдаемую систему и не позволяет экземплярам ClickHouse Cloud переходить в режим простоя, что негативно влияет на оптимизацию затрат. Кроме того, при сбое продуктивной системы мониторинг также может быть нарушен, поскольку они тесно связаны. Этот подход хорошо подходит для глубокого анализа и отладки, но менее пригоден для мониторинга продуктивной системы в реальном времени. Учитывайте эти компромиссы между возможностями детального анализа системы и операционными издержками при оценке прямой интеграции с Grafana по сравнению с подходами интеграции внешних инструментов, которые рассматриваются в следующем разделе.
