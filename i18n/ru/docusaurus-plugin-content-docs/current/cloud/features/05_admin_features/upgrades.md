---
sidebar_label: 'Обновления'
slug: /manage/updates
title: 'Обновления'
description: 'С ClickHouse Cloud вам никогда не придётся беспокоиться об установке патчей и обновлений. Мы регулярно развёртываем обновления, включающие исправления, новые функции и улучшения производительности.'
doc_type: 'guide'
keywords: ['обновления', 'управление версиями', 'возможности облака', 'обслуживание', 'обновления']
---

import Image from '@theme/IdealImage';
import EnterprisePlanFeatureBadge from '@theme/badges/EnterprisePlanFeatureBadge'
import ScalePlanFeatureBadge from '@theme/badges/ScalePlanFeatureBadge'
import fast_release from '@site/static/images/cloud/manage/fast_release.png';
import enroll_fast_release from '@site/static/images/cloud/manage/enroll_fast_release.png';
import scheduled_upgrades from '@site/static/images/cloud/manage/scheduled_upgrades.png';
import scheduled_upgrade_window from '@site/static/images/cloud/manage/scheduled_upgrade_window.png';


# Обновления {#upgrades}

С ClickHouse Cloud вам не нужно заботиться о патчах и обновлениях. Мы регулярно внедряем обновления, которые включают исправления, новые функции и улучшения производительности. Полный список новых возможностей в ClickHouse смотрите в нашем [Cloud changelog](/whats-new/cloud).

:::note
Мы внедряем новый механизм обновления — подход, который мы называем «make before break» (или MBB). С этим новым подходом мы добавляем обновлённые реплики до удаления старых в ходе операции обновления. Это обеспечивает более плавные обновления с меньшим воздействием на выполняющиеся рабочие нагрузки.

В рамках этого изменения исторические данные системных таблиц будут сохраняться до 30 дней как часть событий обновления. Кроме того, любые данные системных таблиц старше 19 декабря 2024 года для сервисов на AWS или GCP и старше 14 января 2025 года для сервисов на Azure не будут сохранены при миграции на новые уровни организации.
:::

## Совместимость версий {#version-compatibility}

Когда вы создаёте сервис, настройка [`compatibility`](/operations/settings/settings#compatibility) устанавливается на самую актуальную версию ClickHouse, доступную в ClickHouse Cloud на момент первоначального развёртывания сервиса.

Настройка `compatibility` позволяет использовать значения по умолчанию для параметров из предыдущих версий. Когда ваш сервис обновляется до новой версии, версия, указанная в настройке `compatibility`, не изменяется. Это означает, что значения по умолчанию для параметров, существовавших на момент первоначального создания сервиса, не изменятся (если только вы уже не переопределили эти значения по умолчанию — в этом случае они сохранятся после обновления).

Вы не можете управлять значением настройки `compatibility` по умолчанию на уровне сервиса. Вам необходимо [обратиться в службу поддержки](https://clickhouse.com/support/program), если вы хотите изменить версию, установленную по умолчанию в настройке `compatibility` для вашего сервиса. Однако вы можете переопределить настройку `compatibility` на уровне пользователя, роли, профиля, запроса или сеанса, используя стандартные механизмы настройки ClickHouse, такие как `SET compatibility = '22.3'` в сеансе или `SETTINGS compatibility = '22.3'` в запросе.

## Режим обслуживания {#maintenance-mode}

Иногда нам может потребоваться обновить ваш сервис, и для этого может понадобиться временно отключить некоторые функции, например масштабирование или автоматический перевод в режим простоя. В редких случаях нам может потребоваться вмешаться в работу сервиса, который испытывает проблемы, и вернуть его в корректное состояние. Во время такого обслуживания на странице сервиса будет отображаться баннер с надписью _«Выполняется обслуживание»_. В этот период вы, возможно, всё ещё сможете выполнять запросы к сервису.

С вас не будет взиматься плата за время, пока сервис находится на обслуживании. _Режим обслуживания_ — редкий режим и его не следует путать с плановыми обновлениями сервиса.

## Каналы релизов (график обновлений) {#release-channels-upgrade-schedule}

Пользователи могут задавать график обновлений своего сервиса ClickHouse Cloud, подписываясь на конкретный канал релизов. Доступно три канала релизов, и пользователь может настроить день и время недели для обновлений с помощью функции **scheduled upgrades** (плановых обновлений).

Три канала релизов:
- [**Быстрый канал релизов**](#fast-release-channel-early-upgrades) для раннего доступа к обновлениям.
- [**Обычный канал релизов**](#regular-release-channel) является каналом по умолчанию, и обновления на этом канале начинаются через две недели после обновлений на быстром канале релизов. Если для вашего сервиса уровня Scale или Enterprise не задан канал релизов, он по умолчанию находится на обычном канале релизов.
- [**Медленный канал релизов**](#slow-release-channel-deferred-upgrades) предназначен для отложенных релизов. Обновления на этом канале происходят через две недели после обновлений на обычном канале релизов.

:::note
Сервисы уровня Basic автоматически подключаются к быстрому каналу релизов.
:::

### Быстрый канал релизов (ранние обновления) {#fast-release-channel-early-upgrades}

<ScalePlanFeatureBadge feature="Быстрый канал релизов"/>

Помимо обычного графика обновлений, мы предлагаем канал **Fast release**, если вы хотите, чтобы ваши сервисы получали обновления раньше обычного графика релизов.

В частности, сервисы будут:

- Получать последние релизы ClickHouse
- Обновляться чаще по мере выхода и тестирования новых релизов

Вы можете изменить график релизов сервиса в консоли ClickHouse Cloud, как показано ниже:

<div class="eighty-percent">
    <Image img={fast_release} size="lg" alt="Выбор плана" border/>
</div>

<br/>

<div class="eighty-percent">
    <Image img={enroll_fast_release} size="lg" alt="Выбор плана" border/>
</div>

<br/>

Этот канал **Fast release** подходит для тестирования новых функций в некритичных средах. **Он не рекомендуется для production-нагрузок с жёсткими требованиями к доступности и надёжности.**

### Обычный канал релизов {#regular-release-channel}

Для всех сервисов уровней Scale и Enterprise, для которых не настроен канал релизов или график обновлений, обновления будут выполняться в рамках релизов обычного канала. Это рекомендованный вариант для production-сред.

Обновления на обычный канал релизов, как правило, выполняются через две недели после **быстрого канала релизов**.

:::note
Сервисы уровня Basic обновляются вскоре после быстрого канала релизов.
:::

### Медленный канал релизов (отложенные обновления) {#slow-release-channel-deferred-upgrades}

<EnterprisePlanFeatureBadge feature="Медленный канал релизов"/>

Мы предлагаем канал **Slow release**, если вы хотите, чтобы ваши сервисы получали обновления после обычного графика релизов.

В частности, сервисы будут:

- Обновляться после завершения развёртывания релизов на быстрый и обычный каналы
- Получать релизы ClickHouse примерно через 2 недели после обычного релиза
- Предназначаться для клиентов, которым нужно дополнительное время, чтобы протестировать релизы ClickHouse в непроизводственных средах перед обновлением production-среды. Непроизводственные среды могут получать обновления по быстрому или обычному каналу релизов для тестирования и валидации.

:::note
Вы можете менять каналы релизов в любой момент. Однако в некоторых случаях изменение будет применено только к будущим релизам. 

- Переход на более быстрый канал немедленно обновит ваш сервис, то есть переход с медленного на обычный или с обычного на быстрый.
- Переход на более медленный канал не приведёт к откату версии сервиса; он останется на текущей версии до появления более новой версии в этом канале, то есть при переходе с обычного на медленный или с быстрого на обычный или медленный.
:::

## Плановые обновления {#scheduled-upgrades}

<EnterprisePlanFeatureBadge feature="Плановые обновления" linking_verb_are="true"/>

Вы можете настроить окно обновления для сервисов уровня Enterprise.

Выберите сервис, для которого вы хотите задать расписание обновлений, затем в левом меню нажмите `Settings`. Прокрутите до раздела `Scheduled upgrades`.

<div class="eighty-percent">
    <Image img={scheduled_upgrades} size="lg" alt="Плановые обновления" border/>
</div>
<br/>

При выборе этого параметра пользователи смогут указать день недели и временное окно для обновления базы данных и облачной инфраструктуры.

<div class="eighty-percent">
    <Image img={scheduled_upgrade_window} size="lg" alt="Окно плановых обновлений" border/>
</div>
<br/>

:::note
Хотя плановые обновления выполняются в соответствии с заданным расписанием, для критических исправлений безопасности и устранения уязвимостей возможны исключения. Если будет выявлена неотложная проблема безопасности, обновления могут быть выполнены вне запланированного окна. Клиенты будут уведомлены о таких исключениях по мере необходимости.
:::