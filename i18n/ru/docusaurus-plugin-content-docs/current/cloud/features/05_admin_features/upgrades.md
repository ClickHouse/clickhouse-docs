---
sidebar_label: 'Обновления'
slug: /manage/updates
title: 'Обновления'
description: 'С ClickHouse Cloud вам никогда не придется беспокоиться о патчах и обновлениях. Мы регулярно устанавливаем обновления, которые включают исправления, новые функции и улучшения производительности.'
doc_type: 'guide'
keywords: ['обновления', 'управление версиями', 'облачные возможности', 'обслуживание', 'обновления']
---

import Image from '@theme/IdealImage';
import EnterprisePlanFeatureBadge from '@theme/badges/EnterprisePlanFeatureBadge'
import ScalePlanFeatureBadge from '@theme/badges/ScalePlanFeatureBadge'
import fast_release from '@site/static/images/cloud/manage/fast_release.png';
import enroll_fast_release from '@site/static/images/cloud/manage/enroll_fast_release.png';
import scheduled_upgrades from '@site/static/images/cloud/manage/scheduled_upgrades.png';
import scheduled_upgrade_window from '@site/static/images/cloud/manage/scheduled_upgrade_window.png';


# Обновления

С ClickHouse Cloud вам не нужно беспокоиться о применении патчей и обновлений. Мы периодически развёртываем обновления, которые включают исправления, новые функции и улучшения производительности. Полный список новшеств в ClickHouse приведён в нашем [Cloud changelog](/whats-new/cloud).

:::note
Мы внедряем новый механизм обновления, концепцию, которую мы называем «make before break» (или MBB). При таком подходе мы добавляем обновлённые реплики до удаления старых в ходе операции обновления. Это обеспечивает более плавные обновления и снижает влияние на выполняющиеся нагрузки.

В рамках этого изменения исторические данные системных таблиц будут сохраняться до 30 дней в связи с событиями обновления. Кроме того, любые данные системных таблиц старше 19 декабря 2024 года для сервисов на AWS или GCP и старше 14 января 2025 года для сервисов на Azure не будут сохранены в рамках миграции на новые уровни организации.
:::



## Совместимость версий {#version-compatibility}

При создании сервиса настройка [`compatibility`](/operations/settings/settings#compatibility) устанавливается в значение самой актуальной версии ClickHouse, доступной в ClickHouse Cloud на момент первоначального развёртывания вашего сервиса.

Настройка `compatibility` позволяет использовать значения настроек по умолчанию из предыдущих версий. При обновлении сервиса до новой версии значение, указанное в настройке `compatibility`, не изменяется. Это означает, что значения по умолчанию для настроек, существовавших на момент создания вашего сервиса, останутся неизменными (если только вы уже не переопределили эти значения по умолчанию — в таком случае они сохранятся после обновления).

Вы не можете управлять настройкой `compatibility` по умолчанию на уровне сервиса. Если вы хотите изменить версию, установленную для настройки `compatibility` по умолчанию вашего сервиса, необходимо [обратиться в службу поддержки](https://clickhouse.com/support/program). Однако вы можете переопределить настройку `compatibility` на уровне пользователя, роли, профиля, запроса или сессии, используя стандартные механизмы настроек ClickHouse, такие как `SET compatibility = '22.3'` в сессии или `SETTINGS compatibility = '22.3'` в запросе.


## Режим обслуживания {#maintenance-mode}

Иногда нам может потребоваться обновить ваш сервис, что может привести к временному отключению некоторых функций, таких как масштабирование или переход в режим простоя. В редких случаях нам может потребоваться принять меры в отношении сервиса, испытывающего проблемы, и восстановить его работоспособность. Во время такого обслуживания на странице сервиса вы увидите баннер с сообщением _"Выполняется обслуживание"_. В это время вы по-прежнему можете использовать сервис для выполнения запросов.

Плата за время нахождения сервиса на обслуживании не взимается. _Режим обслуживания_ — это редкое явление, которое не следует путать с регулярными обновлениями сервиса.


## Каналы релизов (график обновлений) {#release-channels-upgrade-schedule}

Пользователи могут задать график обновлений для своей службы ClickHouse Cloud, подписавшись на определённый канал релизов. Существует три канала релизов, и пользователь может настроить день и время недели для обновлений с помощью функции **планируемых обновлений**.

Три канала релизов:

- [**Канал быстрого релиза**](#fast-release-channel-early-upgrades) для раннего доступа к обновлениям.
- [**Канал обычного релиза**](#regular-release-channel) — это канал по умолчанию, обновления в нём начинаются через две недели после обновлений в канале быстрого релиза. Если для вашей службы на уровне Scale или Enterprise не задан канал релизов, она по умолчанию находится в канале обычного релиза.
- [**Канал медленного релиза**](#slow-release-channel-deferred-upgrades) предназначен для отложенных релизов. Обновления в нём происходят через две недели после обновлений в канале обычного релиза.

:::note
Службы уровня Basic автоматически включаются в канал быстрого релиза
:::

### Канал быстрого релиза (ранние обновления) {#fast-release-channel-early-upgrades}

<ScalePlanFeatureBadge feature='Канал быстрого релиза' />

Помимо стандартного графика обновлений, мы предлагаем **канал быстрого релиза**, если вы хотите, чтобы ваши службы получали обновления раньше стандартного графика релизов.

В частности, службы будут:

- Получать последние релизы ClickHouse
- Проходить более частые обновления по мере тестирования новых релизов

Вы можете изменить график обновлений службы в консоли Cloud, как показано ниже:

<div class='eighty-percent'>
  <Image img={fast_release} size='lg' alt='Выберите план' border />
</div>
<br />

<div class='eighty-percent'>
  <Image img={enroll_fast_release} size='lg' alt='Выберите план' border />
</div>
<br />

Этот **канал быстрого релиза** подходит для тестирования новых функций в некритических средах. **Не рекомендуется использовать его для производственных нагрузок со строгими требованиями к аптайму и надёжности.**

### Канал обычного релиза {#regular-release-channel}

Для всех служб уровней Scale и Enterprise, у которых не настроен канал релизов или график обновлений, обновления выполняются в рамках канала обычного релиза. Это рекомендуется для производственных сред.

Обновления в канале обычного релиза обычно выполняются через две недели после **канала быстрого релиза**.

:::note
Службы уровня Basic обновляются вскоре после канала быстрого релиза.
:::

### Канал медленного релиза (отложенные обновления) {#slow-release-channel-deferred-upgrades}

<EnterprisePlanFeatureBadge feature='Канал медленного релиза' />

Мы предлагаем **канал медленного релиза**, если вы хотите, чтобы ваши службы получали обновления после стандартного графика релизов.

В частности, службы будут:

- Обновляться после завершения развертывания в каналах быстрого и обычного релизов
- Получать релизы ClickHouse примерно через 2 недели после обычного релиза
- Предназначаться для клиентов, которые хотят дополнительного времени для тестирования релизов ClickHouse в непроизводственных средах перед обновлением производства. Непроизводственные среды могут получать обновления в канале быстрого или обычного релиза для тестирования и валидации.

:::note
Вы можете изменить каналы релизов в любое время. Однако в некоторых случаях изменение будет применяться только к будущим релизам.

- Переход на более быстрый канал немедленно обновит вашу службу, т. е. от медленного к обычному, от обычного к быстрому.
- Переход на более медленный канал не понизит версию вашей службы и оставит вас на текущей версии, пока в этом канале не станет доступна новая версия, т. е. от обычного к медленному, от быстрого к обычному или медленному.
:::


## Запланированные обновления {#scheduled-upgrades}

<EnterprisePlanFeatureBadge
  feature='Запланированные обновления'
  linking_verb_are='true'
/>

Пользователи уровня Enterprise могут настроить временное окно для обновлений сервисов.

Выберите сервис, для которого необходимо указать расписание обновлений, затем перейдите в раздел `Settings` в левом меню. Прокрутите страницу до раздела `Scheduled upgrades`.

<div class='eighty-percent'>
  <Image img={scheduled_upgrades} size='lg' alt='Запланированные обновления' border />
</div>
<br />

Эта опция позволяет выбрать день недели и временное окно для обновлений базы данных и облачной инфраструктуры.

<div class='eighty-percent'>
  <Image
    img={scheduled_upgrade_window}
    size='lg'
    alt='Окно запланированного обновления'
    border
  />
</div>
<br />
:::note Хотя запланированные обновления выполняются согласно установленному расписанию, исключения применяются для критических патчей безопасности и исправлений уязвимостей. В случае обнаружения срочной проблемы безопасности обновления могут выполняться вне запланированного окна. При необходимости клиенты будут уведомлены о таких исключениях. :::
