---
sidebar_label: 'Обновления'
slug: /manage/updates
title: 'Обновления'
description: 'С ClickHouse Cloud вам не нужно беспокоиться о патчах и обновлениях. Мы регулярно устанавливаем обновления, включающие исправления, новые возможности и улучшения производительности.'
doc_type: 'guide'
keywords: ['обновления', 'управление версиями', 'возможности облака', 'обслуживание', 'обновления']
---

import Image from '@theme/IdealImage';
import EnterprisePlanFeatureBadge from '@theme/badges/EnterprisePlanFeatureBadge'
import ScalePlanFeatureBadge from '@theme/badges/ScalePlanFeatureBadge'
import fast_release from '@site/static/images/cloud/manage/fast_release.png';
import enroll_fast_release from '@site/static/images/cloud/manage/enroll_fast_release.png';
import scheduled_upgrades from '@site/static/images/cloud/manage/scheduled_upgrades.png';
import scheduled_upgrade_window from '@site/static/images/cloud/manage/scheduled_upgrade_window.png';


# Обновления

В ClickHouse Cloud вам не нужно заботиться о патчах и обновлениях. Мы регулярно выполняем обновления, которые включают исправления, новые функции и улучшения производительности. Полный список новшеств в ClickHouse см. в [журнале изменений Cloud](/whats-new/cloud).

:::note
Мы внедряем новый механизм обновления — концепцию, которую мы называем «make before break» (или MBB). В рамках этого подхода мы добавляем обновлённые реплики до удаления старых во время операции обновления. Это обеспечивает более плавные обновления и снижает влияние на выполняющиеся рабочие нагрузки.

В рамках этого изменения исторические данные системных таблиц будут сохраняться максимум 30 дней в контексте событий обновления. Кроме того, любые данные системных таблиц старше 19 декабря 2024 года для сервисов на AWS или GCP и старше 14 января 2025 года для сервисов на Azure не будут сохранены в рамках миграции на новые уровни организации.
:::



## Совместимость версий {#version-compatibility}

При создании сервиса настройка [`compatibility`](/operations/settings/settings#compatibility) устанавливается в значение самой актуальной версии ClickHouse, доступной в ClickHouse Cloud на момент первоначального развёртывания вашего сервиса.

Настройка `compatibility` позволяет использовать значения настроек по умолчанию из предыдущих версий. При обновлении сервиса до новой версии значение, указанное в настройке `compatibility`, не изменяется. Это означает, что значения по умолчанию для настроек, существовавших на момент создания вашего сервиса, останутся неизменными (если только вы уже не переопределили эти значения по умолчанию — в таком случае они сохранятся после обновления).

Вы не можете управлять настройкой `compatibility` по умолчанию на уровне сервиса. Если вы хотите изменить версию, установленную для настройки `compatibility` по умолчанию вашего сервиса, необходимо [обратиться в службу поддержки](https://clickhouse.com/support/program). Однако вы можете переопределить настройку `compatibility` на уровне пользователя, роли, профиля, запроса или сессии, используя стандартные механизмы настроек ClickHouse, такие как `SET compatibility = '22.3'` в сессии или `SETTINGS compatibility = '22.3'` в запросе.


## Режим обслуживания {#maintenance-mode}

Иногда нам может потребоваться обновить ваш сервис, что может привести к временному отключению некоторых функций, таких как масштабирование или переход в режим простоя. В редких случаях нам может потребоваться принять меры в отношении сервиса, испытывающего проблемы, и восстановить его работоспособность. Во время такого обслуживания на странице сервиса будет отображаться баннер с сообщением _"Выполняется обслуживание"_. При этом вы по-прежнему сможете использовать сервис для выполнения запросов.

Плата за время нахождения сервиса на обслуживании не взимается. _Режим обслуживания_ — это редкое явление, которое не следует путать с регулярными обновлениями сервиса.


## Каналы выпуска (расписание обновлений) {#release-channels-upgrade-schedule}

Пользователи могут указать расписание обновлений для своего сервиса ClickHouse Cloud, выбрав определённый канал выпуска. Существует три канала выпуска, и пользователь может настроить день и время недели для обновлений с помощью функции **запланированных обновлений**.

Три канала выпуска:

- [**Быстрый канал выпуска**](#fast-release-channel-early-upgrades) для раннего доступа к обновлениям.
- [**Обычный канал выпуска**](#regular-release-channel) — канал по умолчанию, обновления на котором начинаются через две недели после обновлений быстрого канала. Если для вашего сервиса уровня Scale или Enterprise не задан канал выпуска, он по умолчанию использует обычный канал выпуска.
- [**Медленный канал выпуска**](#slow-release-channel-deferred-upgrades) предназначен для отложенных выпусков. Обновления на этом канале происходят через две недели после обновлений обычного канала выпуска.

:::note
Сервисы уровня Basic автоматически подключаются к быстрому каналу выпуска
:::

### Быстрый канал выпуска (ранние обновления) {#fast-release-channel-early-upgrades}

<ScalePlanFeatureBadge feature='Быстрый канал выпуска' />

Помимо обычного расписания обновлений, мы предлагаем канал **быстрого выпуска**, если вы хотите, чтобы ваши сервисы получали обновления раньше обычного расписания.

В частности, сервисы будут:

- Получать последние выпуски ClickHouse
- Получать более частые обновления по мере тестирования новых выпусков

Вы можете изменить расписание выпуска сервиса в консоли Cloud, как показано ниже:

<div class='eighty-percent'>
  <Image img={fast_release} size='lg' alt='Выбор плана' border />
</div>
<br />

<div class='eighty-percent'>
  <Image img={enroll_fast_release} size='lg' alt='Выбор плана' border />
</div>
<br />

Этот канал **быстрого выпуска** подходит для тестирования новых функций в некритичных средах. **Он не рекомендуется для производственных нагрузок со строгими требованиями к доступности и надёжности.**

### Обычный канал выпуска {#regular-release-channel}

Для всех сервисов уровня Scale и Enterprise, для которых не настроен канал выпуска или расписание обновлений, обновления будут выполняться в рамках обычного канала выпуска. Это рекомендуется для производственных сред.

Обновления обычного канала выпуска обычно выполняются через две недели после **быстрого канала выпуска**.

:::note
Сервисы уровня Basic обновляются вскоре после быстрого канала выпуска.
:::

### Медленный канал выпуска (отложенные обновления) {#slow-release-channel-deferred-upgrades}

<EnterprisePlanFeatureBadge feature='Медленный канал выпуска' />

Мы предлагаем канал **медленного выпуска**, если вы хотите, чтобы ваши сервисы получали обновления позже обычного расписания.

В частности, сервисы будут:

- Обновляться после завершения развёртывания быстрого и обычного каналов выпуска
- Получать выпуски ClickHouse примерно через 2 недели после обычного выпуска
- Предназначены для клиентов, которым требуется дополнительное время для тестирования выпусков ClickHouse в непроизводственных средах перед обновлением производственной среды. Непроизводственные среды могут получать обновления по быстрому или обычному каналу выпуска для тестирования и проверки.

:::note
Вы можете изменить канал выпуска в любое время. Однако в некоторых случаях изменение будет применяться только к будущим выпускам.

- Переход на более быстрый канал немедленно обновит ваш сервис, т. е. с медленного на обычный, с обычного на быстрый
- Переход на более медленный канал не понизит версию вашего сервиса и оставит вас на текущей версии до тех пор, пока в этом канале не появится более новая версия, т. е. с обычного на медленный, с быстрого на обычный или медленный
  :::


## Запланированные обновления {#scheduled-upgrades}

<EnterprisePlanFeatureBadge
  feature='Запланированные обновления'
  linking_verb_are='true'
/>

Пользователи тарифа Enterprise могут настроить временное окно для обновлений сервисов.

Выберите сервис, для которого необходимо указать расписание обновлений, затем перейдите в раздел `Settings` в левом меню. Прокрутите страницу до раздела `Scheduled upgrades`.

<div class='eighty-percent'>
  <Image img={scheduled_upgrades} size='lg' alt='Запланированные обновления' border />
</div>
<br />

При выборе этой опции пользователи смогут указать день недели и временное окно для обновлений базы данных и облачной инфраструктуры.

<div class='eighty-percent'>
  <Image
    img={scheduled_upgrade_window}
    size='lg'
    alt='Окно запланированного обновления'
    border
  />
</div>
<br />
:::note Хотя запланированные обновления выполняются согласно установленному расписанию, исключения применяются для критических патчей безопасности и исправлений уязвимостей. В случае обнаружения срочной проблемы безопасности обновления могут выполняться вне запланированного окна. Клиенты будут уведомлены о таких исключениях при необходимости. :::
