---
sidebar_label: Аутентификация в облаке
slug: /cloud/security/cloud-authentication
title: Аутентификация в облаке
---

import ScalePlanFeatureBadge from '@theme/badges/ScalePlanFeatureBadge'
import EnterprisePlanFeatureBadge from '@theme/badges/EnterprisePlanFeatureBadge'


# Аутентификация в облаке

ClickHouse Cloud предоставляет несколько способов аутентификации. В этом руководстве объясняются некоторые лучшие практики настройки вашей аутентификации. Всегда консультируйтесь с вашей командой безопасности при выборе методов аутентификации.

## Настройки пароля {#password-settings}

Минимальные настройки пароля для нашей консоли и сервисов (баз данных) в настоящее время соответствуют [NIST 800-63B](https://pages.nist.gov/800-63-3/sp800-63b.html#sec4) Уровню уверенности в аутентификаторе 1:
- Минимум 12 символов
- Включает 3 из следующих 4 элементов:
   - 1 заглавная буква
   - 1 строчная буква
   - 1 число
   - 1 специальный символ

## Email + Пароль {#email--password}

ClickHouse Cloud позволяет аутентифицироваться с помощью адреса электронной почты и пароля. При использовании этого метода лучший способ защитить вашу учетную запись ClickHouse — использовать надежный пароль. Существует множество онлайн ресурсов, которые помогут вам разработать пароль, который вы сможете запомнить. В качестве альтернативы вы можете использовать генератор случайных паролей и хранить ваш пароль в менеджере паролей для повышения безопасности.

## SSO с использованием социальных аутентификаторов Google или Microsoft {#sso-using-google-or-microsoft-social-authentication}

Если ваша компания использует Google Workspace или Microsoft 365, вы можете использовать вашу текущую систему единого входа в ClickHouse Cloud. Для этого просто зарегистрируйтесь, используя ваш корпоративный адрес электронной почты, и приглашайте других пользователей, используя их корпоративные электронные почты. Эффект состоит в том, что ваши пользователи должны входить в систему, используя потоки аутентификации вашей компании, независимо от того, через ваш поставщик идентификации или непосредственно через аутентификацию Google или Microsoft, прежде чем они смогут аутентифицироваться в ClickHouse Cloud.

## Многофакторная аутентификация {#multi-factor-authentication}

Пользователи с аутентификацией через email + пароль или социальными сетями могут дополнительно защитить свою учетную запись, используя многофакторную аутентификацию (MFA). Чтобы настроить MFA:
1. Войдите в console.clickhouse.cloud
2. Нажмите на свои инициалы в верхнем левом углу рядом с логотипом ClickHouse
3. Выберите Профиль
4. Выберите Безопасность слева
5. Нажмите Настроить на плитке Аутентификатор
6. Используйте приложение аутентификатора, такое как Authy, 1Password или Google Authenticator, чтобы отсканировать QR-код
7. Введите код для подтверждения
8. На следующем экране скопируйте код для восстановления и сохраните его в надежном месте
9. Установите галочку рядом с `Я безопасно записал этот код`
10. Нажмите Продолжить

## Восстановление аккаунта {#account-recovery}

<details> 
   <summary>Получить код восстановления</summary>

   Если вы ранее зарегистрировались в MFA и либо не создали, либо потеряли свой код восстановления, выполните следующие шаги, чтобы получить новый код восстановления:
   1. Перейдите на https://console.clickhouse.cloud
   2. Войдите с помощью своих учетных данных и MFA
   3. Перейдите в свой профиль в верхнем левом углу
   4. Нажмите Безопасность слева
   5. Нажмите на корзину рядом с вашим приложением аутентификатора
   6. Нажмите Удалить приложение аутентификатор
   7. Введите свой код и нажмите Продолжить
   8. Нажмите Настроить в разделе Аутентификатор
   9. Отсканируйте QR-код и введите новый код
   10. Скопируйте свой код восстановления и сохраните его в надежном месте
   11. Установите галочку рядом с `Я безопасно записал этот код`
   12. Нажмите Продолжить
   
</details>
<details>
   <summary>Забыл пароль</summary>

   Если вы забыли свой пароль, выполните следующие шаги для самостоятельного восстановления:
   1. Перейдите на https://console.clickhouse.cloud
   2. Введите свой адрес электронной почты и нажмите Продолжить
   3. Нажмите Забыл свой пароль?
   4. Нажмите Отправить ссылку для сброса пароля
   5. Проверьте свою электронную почту и нажмите Сбросить пароль в письме
   6. Введите свой новый пароль, подтвердите пароль и нажмите Обновить пароль
   7. Нажмите Назад для входа
   8. Войдите в систему обычно с вашим новым паролем
            
</details>
<details>
   <summary>Потерянное устройство или токен MFA</summary>

   Если вы потеряли ваше устройство MFA или удалили свой токен, выполните следующие шаги для восстановления и создания нового токена:
   1. Перейдите на https://console.clickhouse.cloud
   2. Введите свои учетные данные и нажмите Продолжить
   3. На экране многофакторной аутентификации нажмите Отмена
   4. Нажмите Код восстановления
   5. Введите код и нажмите Продолжить
   6. Скопируйте новый код восстановления и сохраните его в надежном месте
   7. Установите галочку рядом с `Я безопасно записал этот код` и нажмите Продолжить
   8. После входа перейдите в свой профиль в верхнем левом углу
   9. Нажмите Безопасность в верхнем левом углу
   10. Нажмите на иконку корзины рядом с приложением аутентификатора, чтобы удалить ваш старый аутентификатор
   11. Нажмите Удалить приложение аутентификатор
   12. Когда будет предложено выполнить многофакторную аутентификацию, нажмите Отмена
   13. Нажмите Код восстановления
   14. Введите свой код восстановления (это новый код, сгенерированный на шаге 7) и нажмите Продолжить
   15. Скопируйте новый код восстановления и сохраните его в надежном месте - это запасной вариант на случай, если вы покинете экран во время процесса удаления
   16. Установите галочку рядом с `Я безопасно записал этот код` и нажмите Продолжить
   17. Следуйте вышеуказанному процессу для настройки нового фактора MFA
       
</details>
<details>
   <summary>Потерянное устройство MFA и код восстановления</summary>

   Если вы потеряли ваше устройство MFA И код восстановления или вы потеряли ваше устройство MFA и никогда не получали код восстановления, выполните следующие шаги для запроса сброса:

   **Подать заявку**: Если вы находитесь в организации, в которой есть другие административные пользователи, даже если вы пытаетесь получить доступ к организации для одного пользователя, попросите члена вашей организации, назначенного на роль администратора, войти в организацию и подать заявку на поддержку для сброса вашего MFA от вашего имени. Как только мы удостоверимся, что запрос прошел аутентификацию, мы сбросим вашу MFA и уведомим администратора. Войдите как обычно без MFA и перейдите в настройки профиля, чтобы зарегистрировать новый фактор, если хотите.

   **Сброс по электронной почте**: Если вы единственный пользователь в организации, подайте заявку на поддержку по электронной почте (support@clickhouse.com), используя адрес электронной почты, связанный с вашей учетной записью. Как только мы удостоверимся, что запрос поступил с правильного адреса электронной почты, мы сбросим вашу MFA И пароль. Получите доступ к вашей электронной почте, чтобы получить ссылку для сброса пароля. Настройте новый пароль, а затем перейдите в настройки профиля, чтобы зарегистрировать новый фактор, если хотите. 
   
</details>

## SAML SSO {#saml-sso}

<EnterprisePlanFeatureBadge feature="SAML SSO"/>

ClickHouse Cloud также поддерживает SSO через язык разметки утверждений безопасности (SAML). Для получения дополнительной информации смотрите [Настройка SAML SSO](/cloud/security/saml-setup).

## Идентификатор пользователя базы данных + пароль {#database-user-id--password}

Используйте метод SHA256_hash при [создании учетных записей пользователей](/sql-reference/statements/create/user.md) для защиты паролей.

**ПОДСКАЗКА:** Поскольку пользователи с менее чем административными полномочиями не могут установить свой собственный пароль, попросите пользователя хэшировать свой пароль с помощью генератора, например [этого](https://tools.keycdn.com/sha256-online-generator), перед тем как предоставить его администратору для настройки учетной записи. Пароли должны соответствовать [требованиям](#password-settings), перечисленным выше.

```sql
CREATE USER userName IDENTIFIED WITH sha256_hash BY 'hash';
```
