---
slug: /whats-new/cloud-compatibility
sidebar_label: 'Совместимость с ClickHouse Cloud'
title: 'Совместимость с ClickHouse Cloud'
description: 'В этом руководстве представлен обзор функциональных и эксплуатационных особенностей ClickHouse Cloud.'
keywords: ['ClickHouse Cloud', 'compatibility']
doc_type: 'guide'
---



# Руководство по совместимости ClickHouse Cloud

В этом руководстве даётся обзор функциональных и эксплуатационных особенностей ClickHouse Cloud. Хотя ClickHouse Cloud основан на дистрибутиве ClickHouse с открытым исходным кодом, возможны некоторые различия в архитектуре и реализации. В качестве вводного материала может быть полезно ознакомиться с этой записью в блоге о том, [как мы создали ClickHouse Cloud](https://clickhouse.com/blog/building-clickhouse-cloud-from-scratch-in-a-year).



## Архитектура ClickHouse Cloud {#clickhouse-cloud-architecture}

ClickHouse Cloud значительно упрощает операционные издержки и снижает затраты на эксплуатацию ClickHouse в масштабе. Нет необходимости заранее определять размер развертывания, настраивать репликацию для обеспечения высокой доступности, вручную шардировать данные, масштабировать серверы при увеличении нагрузки или уменьшать их при простое — мы делаем это за вас.

Эти преимущества являются результатом архитектурных решений, лежащих в основе ClickHouse Cloud:

- Вычислительные ресурсы и хранилище разделены и могут автоматически масштабироваться независимо друг от друга, поэтому вам не нужно избыточно выделять ресурсы хранилища или вычислений в статических конфигурациях экземпляров.
- Многоуровневое хранилище на основе объектного хранилища и многоуровневое кэширование обеспечивают практически неограниченное масштабирование и хорошее соотношение цены и производительности, поэтому вам не нужно заранее определять размер раздела хранилища и беспокоиться о высоких затратах на хранение данных.
- Высокая доступность включена по умолчанию, а репликация управляется прозрачно, поэтому вы можете сосредоточиться на разработке приложений или анализе данных.
- Автоматическое масштабирование для переменных непрерывных рабочих нагрузок включено по умолчанию, поэтому вам не нужно заранее определять размер сервиса, масштабировать серверы при увеличении нагрузки или вручную уменьшать их при снижении активности.
- Бесшовная гибернация для периодических рабочих нагрузок включена по умолчанию. Мы автоматически приостанавливаем вычислительные ресурсы после периода бездействия и прозрачно запускаем их снова при поступлении нового запроса, поэтому вам не нужно платить за простаивающие ресурсы.
- Расширенные элементы управления масштабированием позволяют установить максимум автомасштабирования для дополнительного контроля затрат или минимум автомасштабирования для резервирования вычислительных ресурсов для приложений со специализированными требованиями к производительности.


## Возможности {#capabilities}

ClickHouse Cloud предоставляет доступ к отобранному набору возможностей из открытой версии ClickHouse. В таблицах ниже описаны некоторые функции, которые в настоящее время отключены в ClickHouse Cloud.

### Синтаксис DDL {#ddl-syntax}

В большинстве случаев синтаксис DDL в ClickHouse Cloud соответствует тому, что доступно в самостоятельно управляемых установках. Несколько важных исключений:

- Поддержка `CREATE AS SELECT`, которая в настоящее время недоступна. В качестве обходного решения рекомендуется использовать `CREATE ... EMPTY ... AS SELECT`, а затем вставлять данные в эту таблицу (см. пример в [этом блоге](https://clickhouse.com/blog/getting-data-into-clickhouse-part-1)).
- Некоторый экспериментальный синтаксис может быть отключен, например оператор `ALTER TABLE ... MODIFY QUERY`.
- Некоторые функции интроспекции могут быть отключены в целях безопасности, например SQL-функция `addressToLine`.
- Не используйте параметры `ON CLUSTER` в ClickHouse Cloud — они не требуются. Хотя в основном это функции без операций, они все равно могут вызвать ошибку, если вы попытаетесь использовать [макросы](/operations/server-configuration-parameters/settings#macros). Макросы часто не работают и не требуются в ClickHouse Cloud.

### Движки баз данных и таблиц {#database-and-table-engines}

ClickHouse Cloud по умолчанию предоставляет высокодоступный реплицированный сервис. В результате все движки баз данных и таблиц являются реплицированными. Вам не нужно указывать «Replicated» — например, `ReplicatedMergeTree` и `MergeTree` идентичны при использовании в ClickHouse Cloud.

**Поддерживаемые движки таблиц**

- ReplicatedMergeTree (по умолчанию, если не указан другой)
- ReplicatedSummingMergeTree
- ReplicatedAggregatingMergeTree
- ReplicatedReplacingMergeTree
- ReplicatedCollapsingMergeTree
- ReplicatedVersionedCollapsingMergeTree
- MergeTree (преобразуется в ReplicatedMergeTree)
- SummingMergeTree (преобразуется в ReplicatedSummingMergeTree)
- AggregatingMergeTree (преобразуется в ReplicatedAggregatingMergeTree)
- ReplacingMergeTree (преобразуется в ReplicatedReplacingMergeTree)
- CollapsingMergeTree (преобразуется в ReplicatedCollapsingMergeTree)
- VersionedCollapsingMergeTree (преобразуется в ReplicatedVersionedCollapsingMergeTree)
- URL
- View
- MaterializedView
- GenerateRandom
- Null
- Buffer
- Memory
- Deltalake
- Hudi
- MySQL
- MongoDB
- NATS
- RabbitMQ
- PostgreSQL
- S3

### Интерфейсы {#interfaces}

ClickHouse Cloud поддерживает HTTPS, нативные интерфейсы и [протокол MySQL](/interfaces/mysql). Поддержка дополнительных интерфейсов, таких как Postgres, появится в ближайшее время.

### Словари {#dictionaries}

Словари — это популярный способ ускорить поиск в ClickHouse. ClickHouse Cloud в настоящее время поддерживает словари из PostgreSQL, MySQL, удаленных и локальных серверов ClickHouse, Redis, MongoDB и HTTP-источников.

### Федеративные запросы {#federated-queries}

Мы поддерживаем федеративные запросы ClickHouse для межкластерного взаимодействия в облаке и для взаимодействия с внешними самостоятельно управляемыми кластерами ClickHouse. ClickHouse Cloud в настоящее время поддерживает федеративные запросы с использованием следующих движков интеграции:

- Deltalake
- Hudi
- MySQL
- MongoDB
- NATS
- RabbitMQ
- PostgreSQL
- S3

Федеративные запросы с некоторыми внешними движками баз данных и таблиц, такими как SQLite, ODBC, JDBC, Redis, HDFS и Hive, пока не поддерживаются.

### Пользовательские функции {#user-defined-functions}

Пользовательские функции — это относительно новая возможность в ClickHouse. ClickHouse Cloud в настоящее время поддерживает только SQL UDF.

### Экспериментальные функции {#experimental-features}

Экспериментальные функции отключены в сервисах ClickHouse Cloud для обеспечения стабильности развертываний.

### Kafka {#kafka}

[Движок таблиц Kafka](/integrations/data-ingestion/kafka/index.md) не является общедоступным в ClickHouse Cloud. Вместо этого рекомендуется использовать архитектуры, которые отделяют компоненты подключения Kafka от сервиса ClickHouse для достижения разделения ответственности. Мы рекомендуем [ClickPipes](https://clickhouse.com/cloud/clickpipes) для извлечения данных из потока Kafka. В качестве альтернативы рассмотрите варианты на основе push-модели, перечисленные в [руководстве пользователя Kafka](/integrations/data-ingestion/kafka/index.md).

### Именованные коллекции {#named-collections}

[Именованные коллекции](/operations/named-collections) в настоящее время не поддерживаются в ClickHouse Cloud.


## Операционные настройки по умолчанию и рекомендации {#operational-defaults-and-considerations}

Ниже приведены настройки по умолчанию для сервисов ClickHouse Cloud. В некоторых случаях эти настройки зафиксированы для обеспечения корректной работы сервиса, в других — их можно изменить.

### Операционные ограничения {#operational-limits}

#### `max_parts_in_total: 10,000` {#max_parts_in_total-10000}

Значение по умолчанию настройки `max_parts_in_total` для таблиц MergeTree было снижено со 100 000 до 10 000. Причина этого изменения заключается в том, что большое количество частей данных может приводить к медленному запуску сервисов в облаке. Большое количество частей обычно указывает на выбор слишком детализированного ключа партиционирования, что, как правило, происходит случайно и чего следует избегать. Изменение значения по умолчанию позволит обнаруживать такие случаи на более ранней стадии.

#### `max_concurrent_queries: 1,000` {#max_concurrent_queries-1000}

Эта настройка на сервер была увеличена со значения по умолчанию `100` до `1000` для обеспечения большей параллельности.
Это приведет к `количество реплик * 1 000` одновременных запросов для сервисов предлагаемых уровней.
`1000` одновременных запросов для сервиса уровня Basic, ограниченного одной репликой, и `1000+` для уровней Scale и Enterprise,
в зависимости от настроенного количества реплик.

#### `max_table_size_to_drop: 1,000,000,000,000` {#max_table_size_to_drop-1000000000000}

Эта настройка была увеличена с 50 ГБ, чтобы разрешить удаление таблиц/партиций размером до 1 ТБ.

### Системные настройки {#system-settings}

ClickHouse Cloud оптимизирован для переменных нагрузок, и по этой причине большинство системных настроек в настоящее время недоступны для изменения. Мы не ожидаем необходимости настройки системных параметров для большинства пользователей, но если у вас есть вопросы о расширенной настройке системы, обратитесь в службу поддержки ClickHouse Cloud.

### Расширенное администрирование безопасности {#advanced-security-administration}

В рамках создания сервиса ClickHouse мы создаем базу данных по умолчанию и пользователя по умолчанию, который имеет широкие права доступа к этой базе данных. Этот начальный пользователь может создавать дополнительных пользователей и назначать им права доступа к этой базе данных. Помимо этого, возможность включения следующих функций безопасности в базе данных с использованием аутентификации Kerberos, LDAP или SSL-сертификатов X.509 в настоящее время не поддерживается.


## План развития {#roadmap}

Мы добавляем поддержку исполняемых пользовательских функций (UDF) в Cloud и оцениваем востребованность других функций. Если у вас есть отзывы или вы хотите запросить конкретную функцию, пожалуйста, [отправьте запрос здесь](https://console.clickhouse.cloud/support).
