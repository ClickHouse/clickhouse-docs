---
slug: /whats-new/cloud-compatibility
sidebar_label: 'Совместимость с ClickHouse Cloud'
title: 'Совместимость с ClickHouse Cloud'
description: 'В этом руководстве приведён обзор функциональных и эксплуатационных особенностей ClickHouse Cloud.'
keywords: ['ClickHouse Cloud', 'совместимость']
doc_type: 'guide'
---

# Руководство по совместимости с ClickHouse Cloud \{#clickhouse-cloud-compatibility-guide\}

Это руководство даёт общее представление о функциональных возможностях и особенностях эксплуатации ClickHouse Cloud. Хотя ClickHouse Cloud основан на дистрибутиве ClickHouse с открытым исходным кодом, возможны некоторые различия в архитектуре и реализации. В качестве вводного материала может быть полезно прочитать эту запись в блоге о том, [как мы создали ClickHouse Cloud](https://clickhouse.com/blog/building-clickhouse-cloud-from-scratch-in-a-year).

## Архитектура ClickHouse Cloud \\{#clickhouse-cloud-architecture\\}
ClickHouse Cloud значительно упрощает эксплуатацию и снижает затраты на использование ClickHouse в больших масштабах. Нет необходимости заранее задавать размер развертывания, настраивать репликацию для высокой доступности, вручную шардировать данные, масштабировать серверы при росте нагрузки или уменьшать их, когда вы ими не пользуетесь — мы берем это на себя.

Эти преимущества являются результатом архитектурных решений, лежащих в основе ClickHouse Cloud:
- Вычислительные ресурсы и хранилище разделены и поэтому могут автоматически масштабироваться независимо, так что вам не нужно избыточно выделять ни хранилище, ни вычислительные ресурсы в статических конфигурациях экземпляров.
- Многоуровневое хранилище на базе объектного хранилища и многоуровневое кэширование обеспечивают практически неограниченное масштабирование и хорошее соотношение цены и производительности, так что вам не нужно заранее задавать размер раздела хранилища и беспокоиться о высоких затратах на хранение.
- Высокая доступность включена по умолчанию, а репликация прозрачно управляется, так что вы можете сосредоточиться на разработке приложений или анализе данных.
- Автоматическое масштабирование для переменных непрерывных рабочих нагрузок включено по умолчанию, так что вам не нужно заранее задавать размер сервиса, масштабировать серверы при росте нагрузки или вручную уменьшать масштаб серверов при снижении активности.
- Плавная гибернация для периодических рабочих нагрузок включена по умолчанию. Мы автоматически приостанавливаем вычислительные ресурсы после периода простоя и прозрачно запускаем их снова при поступлении нового запроса, так что вам не приходится платить за неиспользуемые ресурсы.
- Расширенные параметры масштабирования позволяют задать максимальный порог автомасштабирования для дополнительного контроля затрат или минимальный порог автомасштабирования для резервирования вычислительных ресурсов для приложений с особыми требованиями к производительности.

## Возможности \\{#capabilities\\}

ClickHouse Cloud предоставляет доступ к отобранному набору возможностей из открытой дистрибуции ClickHouse. В таблицах ниже описаны некоторые функции, которые в данный момент отключены в ClickHouse Cloud.

### Движки баз данных и таблиц \\{#database-and-table-engines\\}

ClickHouse Cloud по умолчанию предоставляет высокодоступный, реплицируемый сервис. В результате все движки баз данных и таблиц являются «реплицируемыми». Вам не нужно явно указывать «Replicated» — например, `ReplicatedMergeTree` и `MergeTree` идентичны при использовании в ClickHouse Cloud.

**Поддерживаемые движки таблиц**

- ReplicatedMergeTree (по умолчанию, если ничего не указано)
- ReplicatedSummingMergeTree
- ReplicatedAggregatingMergeTree
- ReplicatedReplacingMergeTree
- ReplicatedCollapsingMergeTree
- ReplicatedVersionedCollapsingMergeTree
- MergeTree (преобразуется в ReplicatedMergeTree)
- SummingMergeTree (преобразуется в ReplicatedSummingMergeTree)
- AggregatingMergeTree (преобразуется в ReplicatedAggregatingMergeTree)
- ReplacingMergeTree (преобразуется в ReplicatedReplacingMergeTree)
- CollapsingMergeTree (преобразуется в ReplicatedCollapsingMergeTree)
- VersionedCollapsingMergeTree (преобразуется в ReplicatedVersionedCollapsingMergeTree)
- URL
- View
- MaterializedView
- GenerateRandom
- Null
- Buffer
- Memory
- Deltalake
- Hudi
- MySQL
- MongoDB
- NATS
- RabbitMQ
- PostgreSQL
- S3
- Kafka

### Интерфейсы \\{#interfaces\\}

ClickHouse Cloud поддерживает HTTPS, нативные интерфейсы и [сетевой протокол MySQL](/interfaces/mysql). Поддержка дополнительных интерфейсов, таких как Postgres, появится в ближайшее время.

### Словари \\{#dictionaries\\}

Словари — популярный способ ускорить операции поиска в ClickHouse. ClickHouse Cloud в настоящее время поддерживает словари из PostgreSQL, MySQL, удалённых и локальных серверов ClickHouse, Redis, MongoDB и HTTP‑источников.

### Федеративные запросы \\{#federated-queries\\}
Мы поддерживаем федеративные запросы ClickHouse для межкластерного взаимодействия в облаке, а также для взаимодействия с внешними самоуправляемыми кластерами ClickHouse. В настоящее время ClickHouse Cloud поддерживает федеративные запросы с использованием следующих интеграционных движков:
- Deltalake
- Hudi
- MySQL
- MongoDB
- NATS
- RabbitMQ
- PostgreSQL
- S3

Федеративные запросы с некоторыми внешними движками баз данных и таблиц, такими как SQLite, ODBC, JDBC, Redis, HDFS и Hive, пока не поддерживаются.

### Пользовательские функции \\{#user-defined-functions\\}

Пользовательские функции в ClickHouse Cloud доступны в режиме [закрытого предварительного просмотра](https://clickhouse.com/docs/sql-reference/functions/udf).

#### Поведение настроек \\{#udf-settings-behavior\\}

:::warning Важно
UDF в ClickHouse Cloud **не наследуют настройки на уровне пользователя**. Они выполняются с системными настройками по умолчанию.
:::

Это означает:

- Настройки на уровне сессии (задаваемые оператором `SET`) не передаются в контекст выполнения UDF
- Настройки профиля пользователя не наследуются UDF
- Настройки на уровне запроса не действуют при выполнении UDF

### Экспериментальные функции \\{#experimental-features\\}

Экспериментальные функции отключены в сервисах ClickHouse Cloud для обеспечения стабильности их развертываний.

### Именованные коллекции \\{#named-collections\\}

[Именованные коллекции](/operations/named-collections) в настоящее время не поддерживаются в ClickHouse Cloud.

## Операционные значения по умолчанию и особенности \\{#operational-defaults-and-considerations\\}
Ниже приведены настройки по умолчанию для сервисов ClickHouse Cloud. В некоторых случаях эти параметры зафиксированы, чтобы обеспечить корректную работу сервиса, а в других — могут быть изменены.

### Операционные ограничения \\{#operational-limits\\}

#### `max_parts_in_total: 10,000` \\{#max_parts_in_total-10000\\}

Значение по умолчанию настройки `max_parts_in_total` для таблиц MergeTree было снижено со 100&nbsp;000 до 10&nbsp;000. Причина этого изменения в том, что мы заметили, что большое количество частей данных, как правило, замедляет запуск сервисов в облаке. Большое количество частей обычно указывает на выбор слишком детализированного ключа партиционирования, что, как правило, делается случайно и чего следует избегать. Изменение значения по умолчанию позволит выявлять такие случаи на более ранней стадии.

#### `max_concurrent_queries: 1,000` \\{#max_concurrent_queries-1000\\}

Эта настройка на уровне сервера была увеличена со значения по умолчанию `100` до `1000`, чтобы обеспечить большую степень параллелизма. 
В результате для предлагаемых уровней сервиса будет доступно `number of replicas * 1,000` параллельных запросов. 
`1000` параллельных запросов для сервиса уровня Basic, ограниченного одной репликой, и `1000+` — для уровней Scale и Enterprise, 
в зависимости от настроенного числа реплик.

#### `max_table_size_to_drop: 1,000,000,000,000` \\{#max_table_size_to_drop-1000000000000\\}

Эта настройка была увеличена с 50 ГБ, чтобы разрешить удаление таблиц/партиций объемом до 1 ТБ.

### Системные настройки \\{#system-settings\\}

ClickHouse Cloud оптимизирован для переменных нагрузок, и по этой причине большинство системных настроек в настоящий момент не могут быть изменены. Мы не ожидаем необходимости настройки системных параметров для большинства пользователей, но если у вас есть вопросы по расширенной системной настройке, обратитесь в службу поддержки ClickHouse Cloud.

### Расширенное администрирование безопасности \\{#advanced-security-administration\\}

В рамках создания сервиса ClickHouse мы создаем базу данных по умолчанию и пользователя по умолчанию, который имеет широкие права доступа к этой базе данных. Этот начальный пользователь может создавать дополнительных пользователей и назначать им права на эту базу данных. Помимо этого, возможность включения в базе данных таких механизмов безопасности, как аутентификация по Kerberos, LDAP или SSL с использованием сертификатов X.509, в настоящее время не поддерживается.

## Дорожная карта \\{#roadmap\\}

Мы оцениваем спрос на многие другие функции ClickHouse Cloud. Если у вас есть предложения или вы хотите запросить добавление конкретной функции, пожалуйста, [отправьте запрос здесь](https://console.clickhouse.cloud/support).