---
title: 'Эксплуатация и обслуживание BYOC'
slug: /cloud/reference/byoc/operations
sidebar_label: 'Эксплуатация и обслуживание'
keywords: ['BYOC', 'cloud', 'bring your own cloud', 'operations', 'maintenance']
description: 'Развертывание ClickHouse в собственной облачной инфраструктуре'
doc_type: 'reference'
---

## Обзор \{#overview\}

ClickHouse Cloud управляет обновлениями и обслуживанием вашего BYOC-развертывания, чтобы ваши сервисы оставались безопасными, высокопроизводительными и актуальными. На этой странице описаны процессы обновления для различных компонентов вашей BYOC-инфраструктуры и то, как устроены окна обслуживания.

## Процесс обновления сервиса ClickHouse \{#clickhouse-upgrade-process\}

Мы регулярно обновляем базу данных ClickHouse, включая обновления версий, исправления ошибок и улучшения производительности. ClickHouse Cloud использует подход ["make before break" (MBB)](https://clickhouse.com/docs/cloud/features/mbb) для обновлений, при котором новые реплики добавляются до удаления старых, что обеспечивает более плавные обновления с меньшим воздействием на выполняемые рабочие нагрузки.

Обновления сервиса ClickHouse в BYOC выполняются по тем же процессам и принципам, что и стандартные сервисы ClickHouse Cloud, включая поддержку каналов релизов (Fast, Regular и Slow) и плановых окон обслуживания. Все функции уровней Scale и Enterprise доступны в развертываниях BYOC. Подробную информацию о графиках обновлений, каналах релизов и окнах обслуживания см. в [документации по обновлениям](/manage/updates).

## Процесс обновления облачных сервисов и ресурсов \{#cloud-upgrade-process\}

ClickHouse Cloud регулярно обновляет вспомогательные сервисы, работающие в Kubernetes, и инфраструктурные компоненты в рамках вашего развертывания BYOC, чтобы обеспечить безопасность, надежность и доступ к новым возможностям. Эти обновления облачных сервисов выполняются в фоновом режиме и синхронизированы с нашими стандартными циклами релизов Cloud. Все вспомогательные сервисы управляются с помощью ArgoCD, а обновления спроектированы так, чтобы не нарушать работу сервисов. Во время этих обновлений не ожидается перерывов в работе.

Примеры облачных сервисов, которые обновляются:

- **ClickHouse Operator**: Kubernetes-оператор, который управляет кластерами ClickHouse
- **Istio Services**: компоненты входного шлюза и агента
- **Monitoring Stack**: компоненты Prometheus, Grafana, AlertManager и Thanos

## Процесс обновления кластера Kubernetes \{#k8s-upgrade-process\}

Кластер Kubernetes (EKS для AWS, GKE для GCP), в котором развернуты ваши сервисы ClickHouse, требует периодических обновлений для поддержания безопасности, совместимости и доступа к новым возможностям. ClickHouse Cloud управляет всеми обновлениями кластера Kubernetes в вашем развертывании BYOC, обеспечивая, что кластер всегда соответствует поддерживаемым версиям.

### Типы обновления кластера \{#cluster-upgrade-types\}

**Обновления control plane**: Компоненты control plane Kubernetes (API server, etcd, controller manager) обновляются ClickHouse Cloud. Эти обновления, как правило, прозрачны для ваших рабочих нагрузок и не требуют перезапуска подов.

**Обновления групп узлов**: Обновление рабочих узлов требует их замены, что может повлиять на работающие поды. ClickHouse Cloud координирует такие обновления, используя подход make-before-break, чтобы минимизировать перебои:

- Новые узлы подготавливаются с обновлённой версией Kubernetes до удаления старых узлов
- Поды корректно выталкиваются (drain) и мигрируются на новые узлы
- Старые узлы выводятся из эксплуатации только после успешной миграции подов

:::note
Обновления узлов Kubernetes могут привести к кратковременным перезапускам подов в процессе миграции. ClickHouse Cloud использует бюджеты нарушений подов (pod disruption budgets) и корректное завершение работы подов, чтобы минимизировать влияние на ваши рабочие нагрузки.
:::

### График обновлений \{#upgrade-schedule\}

Обновления кластера Kubernetes планируются для вас в координации со службой поддержки ClickHouse. Мы заранее сообщим планы обновлений и вместе с вами определим подходящее окно обслуживания, чтобы свести влияние на работу системы к минимуму.

### Поддержка версий \{#version-support\}

ClickHouse Cloud поддерживает кластеры Kubernetes в рамках диапазонов версий, поддерживаемых вашим облачным провайдером (AWS EKS или Google GKE). Мы гарантируем, что ваш кластер остаётся совместимым с требованиями провайдера и при этом своевременно получает исправления безопасности и обновления функциональности.