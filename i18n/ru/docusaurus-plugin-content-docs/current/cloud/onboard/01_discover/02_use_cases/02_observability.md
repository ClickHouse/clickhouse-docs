---
slug: /cloud/get-started/cloud/use-cases/observability
title: 'Наблюдаемость'
description: 'Используйте ClickHouse Cloud для наблюдаемости, мониторинга, логирования и анализа производительности распределённых приложений'
keywords: ['use cases', 'observability']
sidebar_label: 'Наблюдаемость'
doc_type: 'guide'
---

<iframe width="758" height="426" src="https://www.youtube.com/embed/eKlZoT6hPwI?si=Wyrft2T04E1v8US6" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

Современные программные системы сложны. Микросервисы, облачная инфраструктура и 
распределённые системы сделали куда более сложным понимание того, что происходит 
внутри наших приложений. Когда что-то идёт не так, командам нужно быстро понять,
где и почему это произошло.

Именно здесь на помощь приходит наблюдаемость. Она прошла путь от простого мониторинга систем
до комплексного подхода к пониманию поведения системы. Однако 
реализация эффективной наблюдаемости — нетривиальная задача: она требует 
понимания как технических концепций, так и организационных вызовов.



## Что такое наблюдаемость? {#what-is-observability}

Наблюдаемость — это понимание внутреннего состояния системы путём анализа её выходных данных.
В программных системах это означает понимание того, что происходит внутри ваших
приложений и инфраструктуры на основе генерируемых ими данных.

Эта область значительно эволюционировала, и её развитие можно рассмотреть через призму двух различных
поколений подходов к наблюдаемости.

Первое поколение, часто называемое Observability 1.0, было построено на основе
традиционного подхода «трёх столпов»: метрик, логов и трассировок. Этот подход
требовал использования множества инструментов и хранилищ данных для различных типов телеметрии. Он
часто заставлял инженеров заранее определять, что они хотят измерять, что делало
поддержку множества систем дорогостоящей и сложной.

Современная наблюдаемость, или Observability 2.0, использует принципиально иной
подход. Она основана на сборе широких структурированных событий для каждой единицы работы
(например, HTTP-запроса и ответа) в системе. Этот подход захватывает
данные с высокой кардинальностью, такие как идентификаторы пользователей, идентификаторы запросов, хеши коммитов Git,
идентификаторы экземпляров, имена подов Kubernetes, конкретные параметры маршрутов и идентификаторы
транзакций вендоров. Практическое правило — добавлять метаданные, если они могут помочь
понять, как ведёт себя система.

Такой богатый сбор данных позволяет динамически срезать и анализировать данные без
предварительного определения метрик. Команды могут получать метрики, трассировки и другие визуализации
из этих базовых данных, что позволяет им отвечать на сложные вопросы о поведении системы,
которые не были предусмотрены при первоначальном добавлении инструментирования.

Однако внедрение возможностей современной наблюдаемости сопряжено со своими сложностями.
Организациям необходимы надёжные способы сбора, обработки и экспорта этих богатых
телеметрических данных в разнородных системах и технологиях. Хотя современные подходы
вышли за рамки традиционных границ, понимание фундаментальных
строительных блоков наблюдаемости остаётся критически важным.


## Три столпа наблюдаемости {#three-pillars-of-observability}

Чтобы лучше понять, как развивалась наблюдаемость и как она работает на практике, рассмотрим
три столпа наблюдаемости: логи, метрики и трассировки.

Хотя современная наблюдаемость вышла за рамки рассмотрения этих элементов как отдельных компонентов,
они остаются фундаментальными концепциями для понимания различных аспектов поведения системы.

1. **Логи** — текстовые записи дискретных событий, происходящих в системе.
   Они предоставляют подробный контекст о конкретных событиях, ошибках и изменениях состояния.
2. **Метрики** — числовые измерения, собираемые с течением времени. К ним относятся счётчики,
   индикаторы и гистограммы, которые помогают отслеживать производительность системы, использование ресурсов и ключевые бизнес-показатели.
3. **Трассировки** — записи, отслеживающие путь запросов по мере их прохождения через распределённые системы.
   Они помогают понять взаимосвязи между сервисами и выявить узкие места производительности.

Эти столпы позволяют командам осуществлять мониторинг, диагностику и оптимизацию своих систем.
Однако настоящая сила заключается в понимании того, как эффективно собирать,
анализировать и сопоставлять данные по всем трём столпам для получения значимой информации
о поведении системы.


## Преимущества наблюдаемости {#the-benefits-of-observability}

Хотя технические аспекты наблюдаемости — логи, метрики и трассировки — хорошо изучены, бизнес-преимущества не менее важны.

В своей книге ["Observability Engineering"](https://clickhouse.com/engineering-resources/observability#:~:text=Observability%20Engineering)
(O'Reilly, 2022) Charity Majors, Liz Fong-Jones и George Miranda на основе
отраслевых исследований и практического опыта выделяют четыре ключевых бизнес-преимущества,
которые организации могут получить от внедрения надлежащих практик наблюдаемости.
Рассмотрим эти преимущества:

### Увеличение дополнительной выручки {#higher-incremental-revenue}

Авторы отмечают, что инструменты наблюдаемости, помогающие командам улучшить время безотказной работы и
производительность, могут привести к увеличению дополнительной выручки за счет повышения качества кода.
Это проявляется несколькими способами:

1. Улучшение клиентского опыта: быстрое решение проблем и предотвращение деградации сервиса
   приводит к повышению удовлетворенности и удержанию клиентов
2. Повышение надежности системы: лучшее время безотказной работы означает больше успешных транзакций
   и меньше упущенных бизнес-возможностей
3. Улучшение производительности: возможность выявлять и оптимизировать узкие места производительности
   помогает поддерживать отзывчивые сервисы, удерживающие внимание клиентов
4. Конкурентное преимущество: организации, способные поддерживать высокое качество сервиса
   благодаря комплексному мониторингу и быстрому решению проблем, часто получают преимущество
   перед конкурентами

### Экономия затрат за счет более быстрого реагирования на инциденты {#cost-savings-from-faster-incident-response}

Одним из наиболее непосредственных преимуществ наблюдаемости является снижение трудозатрат
за счет более быстрого обнаружения и решения проблем. Это достигается благодаря:

- Сокращению среднего времени обнаружения (MTTD) и среднего времени решения (MTTR)
- Улучшению времени отклика запросов, обеспечивающему более быстрое расследование
- Более быстрому выявлению узких мест производительности
- Сокращению времени дежурств
- Меньшим затратам ресурсов на ненужные откаты

Мы видим это на практике — [trip.com построил свою систему наблюдаемости на ClickHouse](trip.com built their observability system with ClickHouse)
и достиг скорости выполнения запросов в 4-30 раз быстрее, чем в предыдущем решении, при этом 90%
запросов выполняются менее чем за 300 мс, что обеспечивает быстрое расследование проблем.

### Экономия затрат за счет предотвращения инцидентов {#cost-savings-from-incidents-avoided}

Наблюдаемость не только помогает быстрее решать проблемы — она помогает полностью их предотвращать.
Авторы подчеркивают, как команды могут предотвращать критические проблемы:

- Выявляя потенциальные проблемы до того, как они станут критическими
- Анализируя паттерны для предотвращения повторяющихся проблем
- Понимая поведение системы в различных условиях
- Проактивно устраняя узкие места производительности
- Принимая решения об улучшении системы на основе данных

[Собственная платформа наблюдаемости ClickHouse, LogHouse](https://clickhouse.com/blog/building-a-logging-platform-with-clickhouse-and-saving-millions-over-datadog),
демонстрирует это. Она позволяет нашим ключевым инженерам искать исторические паттерны по всем кластерам, помогая предотвращать
повторяющиеся проблемы.

### Экономия затрат за счет снижения текучести кадров {#cost-savings-from-decreased-employee-churn}

Одним из наиболее недооцененных преимуществ является влияние на удовлетворенность команды и удержание сотрудников.
Авторы подчеркивают, как наблюдаемость приводит к:

- Повышению удовлетворенности работой благодаря лучшим инструментам
- Снижению выгорания разработчиков из-за меньшего количества нерешенных проблем
- Уменьшению усталости от оповещений благодаря лучшему соотношению сигнал/шум
- Снижению стресса во время дежурств благодаря лучшему управлению инцидентами
- Повышению уверенности команды в надежности системы

Мы видим это на практике — когда [Fastly мигрировал на ClickHouse](https://clickhouse.com/videos/scaling-graphite-with-clickhouse),
их инженеры были поражены улучшением производительности запросов, отметив:

> «Я не мог в это поверить. Мне пришлось вернуться несколько раз, чтобы
> убедиться, что я правильно выполняю запрос... это возвращается слишком быстро.
> Это не имеет смысла».

Как подчеркивают авторы, хотя конкретные показатели этих преимуществ могут варьироваться
в зависимости от инструментов и реализации, эти фундаментальные улучшения можно
ожидать в организациях, внедряющих надежные практики наблюдаемости. Ключ
в том, чтобы эффективно выбирать и внедрять правильные инструменты для максимизации этих преимуществ.

Достижение этих преимуществ требует преодоления нескольких значительных препятствий. Даже
организации, понимающие ценность наблюдаемости, часто обнаруживают, что
реализация представляет неожиданные сложности и вызовы, которые необходимо
тщательно преодолевать.


## Проблемы внедрения наблюдаемости {#challenges-in-implementing-observability}

Внедрение наблюдаемости в организации — это трансформационный шаг к получению
более глубокого понимания производительности и надежности системы. Однако этот
путь не обходится без трудностей. Стремясь раскрыть весь потенциал
наблюдаемости, организации сталкиваются с различными препятствиями, которые могут
замедлить прогресс. Рассмотрим некоторые из них.

### Объем данных и масштабируемость {#data-volume-and-scalability}

Одним из основных препятствий при внедрении наблюдаемости является управление
огромным объемом и масштабируемостью телеметрических данных, генерируемых
современными системами. По мере роста организаций растет и объем данных, которые
необходимо отслеживать, что требует решений, эффективно обрабатывающих крупномасштабный
прием данных и аналитику в реальном времени.

### Интеграция с существующими системами {#integration-with-existing-systems}

Интеграция с существующими системами представляет собой еще одну серьезную проблему.
Многие организации работают в гетерогенных средах с разнообразными технологиями,
что делает необходимой бесшовную интеграцию инструментов наблюдаемости с текущей
инфраструктурой. Открытые стандарты играют ключевую роль в обеспечении такой
интеграции, гарантируя совместимость и снижая сложность развертывания решений
наблюдаемости в различных технологических стеках.

### Нехватка квалификации {#skill-gaps}

Нехватка квалификации также может препятствовать успешному внедрению наблюдаемости.
Переход к продвинутым решениям наблюдаемости часто требует специализированных
знаний в области аналитики данных и конкретных инструментов. Командам может
потребоваться инвестировать в обучение или найм персонала, чтобы устранить эти
пробелы и полностью использовать возможности своих платформ наблюдаемости.

### Управление затратами {#cost-management}

Управление затратами имеет критическое значение, поскольку решения наблюдаемости
могут быть дорогостоящими, особенно в масштабе. Организации должны балансировать
затраты на эти инструменты с предоставляемой ими ценностью, ища экономически
эффективные решения, которые обеспечивают значительную экономию по сравнению с
традиционными подходами.

### Хранение данных и управление сроками хранения {#data-retention-and-storage}

Управление хранением данных и сроками их хранения представляет дополнительные
трудности. Определение того, как долго хранить данные наблюдаемости без ущерба
для производительности или аналитических возможностей, требует тщательного
планирования и эффективных решений для хранения, которые снижают требования к
хранилищу при сохранении доступности данных.

### Стандартизация и привязка к поставщику {#standardization-and-vendor-lock-in}

Обеспечение стандартизации и избежание привязки к поставщику имеют важное значение
для поддержания гибкости и адаптивности решений наблюдаемости. Придерживаясь
открытых стандартов, организации могут избежать зависимости от конкретных
поставщиков и гарантировать, что их стек наблюдаемости может развиваться в
соответствии с их потребностями.

### Безопасность и соответствие требованиям {#security-and-compliance}

Вопросы безопасности и соответствия требованиям остаются критически важными,
особенно при работе с конфиденциальными данными в системах наблюдаемости.
Организации должны гарантировать, что их решения наблюдаемости соответствуют
применимым нормативным требованиям и эффективно защищают конфиденциальную
информацию.

Эти проблемы подчеркивают важность стратегического планирования и обоснованного
принятия решений при внедрении решений наблюдаемости, которые эффективно
удовлетворяют потребности организации.

Для решения этих проблем организациям необходим хорошо структурированный подход
к внедрению наблюдаемости. Стандартный конвейер наблюдаемости эволюционировал,
чтобы предоставить фреймворк для эффективного сбора, обработки и анализа
телеметрических данных. Один из самых ранних и влиятельных примеров этой
эволюции основан на опыте Twitter в 2013 году.
