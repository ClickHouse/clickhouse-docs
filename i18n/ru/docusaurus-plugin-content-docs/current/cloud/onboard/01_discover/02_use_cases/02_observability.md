---
slug: /cloud/get-started/cloud/use-cases/observability
title: 'Наблюдаемость'
description: 'Используйте ClickHouse Cloud для наблюдаемости, мониторинга, логирования и анализа производительности систем в распределённых приложениях'
keywords: ['use cases', 'observability']
sidebar_label: 'Наблюдаемость'
doc_type: 'guide'
---

<iframe width="758" height="426" src="https://www.youtube.com/embed/eKlZoT6hPwI?si=Wyrft2T04E1v8US6" title="Проигрыватель видео YouTube" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

Современные программные системы сложны. Микросервисы, облачная инфраструктура и 
распределённые системы сделали понимание того, что происходит внутри наших приложений, всё более сложным. Когда что-то идёт не так, командам необходимо как можно быстрее выяснить,
где и почему это происходит.

Здесь на помощь приходит наблюдаемость. Она эволюционировала от простого мониторинга систем
к комплексному подходу к пониманию поведения систем. Однако реализация эффективной наблюдаемости — задача непростая: она требует
понимания технических концепций и организационных сложностей.



## Что такое наблюдаемость? {#what-is-observability}

Наблюдаемость — это понимание внутреннего состояния системы по её выходным данным.
В программных системах это означает понимание того, что происходит внутри ваших
приложений и инфраструктуры на основе генерируемых ими данных.

Эта область за последние годы существенно изменилась и сейчас обычно описывается
через два поколения подходов к наблюдаемости.

Первое поколение, часто называемое Observability 1.0, было построено вокруг
традиционного подхода «трёх столпов»: метрик, логов и трейсов. Этот подход
требовал использования нескольких инструментов и хранилищ данных для разных
типов телеметрии. Он часто вынуждал инженеров заранее определять, что именно
они хотят измерять, что делало поддержку нескольких систем дорогостоящей и
сложной.

Современная наблюдаемость, или Observability 2.0, использует принципиально иной
подход. Она основана на сборе «широких» структурированных событий для каждой
единицы работы (например, HTTP‑запроса и ответа) в нашей системе. Такой подход
позволяет захватывать данные с высокой кардинальностью, такие как идентификаторы
пользователей, идентификаторы запросов, хэши Git‑коммитов, идентификаторы
инстансов, имена подов Kubernetes, конкретные параметры маршрутов и идентификаторы
транзакций поставщиков. Общее правило: добавлять элемент метаданных, если он
может помочь понять, как ведёт себя система.

Такой богатый по содержанию сбор данных позволяет динамически агрегировать и
сегментировать данные без предварительного определения метрик. Команды могут
получать метрики, трейсы и другие визуализации из этих базовых данных, что
позволяет отвечать на сложные вопросы о поведении системы, которые не
предполагались в момент добавления инструментирования.

Однако реализация возможностей современной наблюдаемости связана с определёнными
сложностями. Организациям нужны надёжные способы сбора, обработки и экспорта
этой богатой телеметрии в различных системах и технологиях. Хотя современные
подходы вышли за рамки традиционных границ, понимание фундаментальных
базовых компонентов наблюдаемости остаётся критически важным.



## Три столпа наблюдаемости {#three-pillars-of-observability}

Чтобы лучше понять, как наблюдаемость развивалась и как она работает на практике, 
рассмотрим три столпа наблюдаемости — логи, метрики и трейсы.

Хотя современная наблюдаемость уже вышла за рамки подхода, в котором эти типы данных рассматриваются по отдельности, 
они по-прежнему остаются основополагающими понятиями для понимания различных аспектов поведения системы.

1. **Логи** — текстовые записи отдельных событий, происходящих в системе. 
Они предоставляют детальный контекст о конкретных событиях, ошибках и изменениях состояния.
2. **Метрики** — числовые измерения, собираемые с течением времени. К ним относятся счетчики,
гейджи и гистограммы, которые помогают отслеживать производительность системы, использование ресурсов и бизнес‑показатели (KPI).
3. **Трейсы** — записи, которые отслеживают путь запросов по мере их прохождения через распределенные системы.
Они помогают понять взаимосвязи между сервисами и выявлять узкие места в производительности.

Эти столпы позволяют командам мониторить, устранять неполадки и оптимизировать свои системы. 
Однако настоящая ценность заключается в понимании того, как эффективно собирать, 
анализировать и коррелировать данные по всем трем столпам, чтобы получать значимые выводы
о поведении системы.



## Преимущества наблюдаемости {#the-benefits-of-observability}

Хотя технические аспекты наблюдаемости — логи, метрики и трейсы — хорошо 
понятны, не менее важно учитывать и бизнес-преимущества.

В своей книге ["Observability Engineering"](https://clickhouse.com/engineering-resources/observability#:~:text=Observability%20Engineering) 
(O'Reilly, 2022) Charity Majors, Liz Fong-Jones и George Miranda опираются на 
отраслевые исследования и практический опыт и отзывы, чтобы выделить четыре 
ключевых бизнес-преимущества, которых организации могут ожидать от внедрения 
корректных практик наблюдаемости. Рассмотрим эти преимущества:

### Более высокий дополнительный доход {#higher-incremental-revenue}

Авторы отмечают, что инструменты наблюдаемости, помогающие командам повышать 
доступность и производительность, могут приводить к росту дополнительной выручки 
за счет улучшения качества кода. Это проявляется несколькими способами:

1. Улучшение клиентского опыта: быстрое устранение проблем и предотвращение 
деградации сервиса ведут к повышению удовлетворенности и удержанию клиентов
2. Повышение надежности системы: лучшая доступность означает больше успешных 
транзакций и меньше упущенных бизнес-возможностей
3. Улучшение производительности: возможность выявлять и оптимизировать узкие 
места производительности помогает поддерживать отзывчивость сервисов и сохранять 
вовлеченность пользователей
4. Конкурентное преимущество: организации, способные поддерживать высокое качество 
сервиса за счет комплексной наблюдаемости и быстрого разрешения инцидентов, часто 
получают преимущество перед конкурентами

### Снижение затрат за счет более быстрого реагирования на инциденты {#cost-savings-from-faster-incident-response}

Одно из самых очевидных преимуществ наблюдаемости — снижение трудозатрат 
за счет более быстрого обнаружения и устранения проблем. Это достигается за счет:

* Сокращения Mean Time to Detect (MTTD) и Mean Time to Resolve (MTTR)
* Улучшения времени ответа на запросы, что ускоряет расследование
* Более быстрого выявления узких мест производительности
* Сокращения времени, проводимого на дежурствах
* Меньших ресурсов, потраченных на избыточные откаты

Мы видим это на практике — [trip.com built their observability system with ClickHouse](trip.com built their observability system with ClickHouse)
и добились ускорения запросов в 4–30 раз по сравнению с предыдущим решением, при этом 90% 
запросов выполняются менее чем за 300 мс, что позволяет быстро расследовать инциденты.

### Снижение затрат за счет предотвращенных инцидентов {#cost-savings-from-incidents-avoided}

Наблюдаемость помогает не только быстрее решать проблемы — она позволяет 
предотвращать их вовсе. Авторы подчеркивают, что команды могут предотвратить 
критические инциденты за счет:

* Выявления потенциальных проблем до того, как они станут критическими
* Анализа закономерностей для предотвращения повторяющихся инцидентов
* Понимания поведения системы в различных условиях
* Проактивного устранения узких мест производительности
* Принятия решений по улучшению системы на основе данных

[Собственная платформа наблюдаемости ClickHouse, LogHouse](https://clickhouse.com/blog/building-a-logging-platform-with-clickhouse-and-saving-millions-over-datadog) 
демонстрирует это. Она позволяет нашим инженерам ядра искать исторические закономерности 
во всех кластерах, помогая предотвращать повторяющиеся инциденты.

### Снижение затрат за счет уменьшения текучести сотрудников {#cost-savings-from-decreased-employee-churn}

Одно из наиболее недооцененных преимуществ — влияние на удовлетворенность команды 
и удержание сотрудников. Авторы подчеркивают, что наблюдаемость приводит к:

* Повышению удовлетворенности работой за счет лучших инструментов
* Снижению эмоционального выгорания разработчиков за счет меньшего числа 
нерешенных проблем
* Снижению усталости от оповещений за счет лучшего отношения сигнал/шум
* Меньшему стрессу при дежурствах благодаря более эффективному управлению инцидентами
* Повышению уверенности команды в надежности системы

Мы видим это на практике — когда [Fastly migrated to ClickHouse](https://clickhouse.com/videos/scaling-graphite-with-clickhouse),
их инженеры были поражены улучшением производительности запросов и отмечали:

> "I couldn't believe it. I actually had to go back a couple of times just to 
> make sure that I was querying it properly... this is coming back too fast. 
> This doesn't make sense."

Как подчеркивают авторы, хотя конкретные метрики этих преимуществ могут 
различаться в зависимости от инструментов и реализации, на фундаментальные 
улучшения могут рассчитывать все организации, которые внедряют зрелые практики 
наблюдаемости. Ключевым фактором является грамотный выбор и эффективная 
реализация инструментов, чтобы максимизировать эти преимущества.

Достижение этих преимуществ требует преодоления ряда существенных препятствий. 
Даже организации, которые понимают ценность наблюдаемости, часто сталкиваются 
с тем, что реализация приносит неожиданные сложности и проблемы, которые нужно 
аккуратно учитывать и преодолевать.



## Проблемы при внедрении наблюдаемости {#challenges-in-implementing-observability}

Внедрение наблюдаемости в организации — это важный шаг на пути
к более глубокому пониманию производительности и надёжности систем. Однако этот
путь не обходится без сложностей. По мере того как организации стремятся раскрыть
полный потенциал наблюдаемости, они сталкиваются с различными препятствиями,
которые могут замедлять прогресс. Рассмотрим некоторые из них.

### Объём данных и масштабируемость {#data-volume-and-scalability}

Одним из ключевых препятствий при внедрении наблюдаемости является управление 
огромным объёмом и масштабируемостью телеметрических данных, генерируемых 
современными системами. По мере роста организаций увеличивается и объём данных, 
которые необходимо мониторить, что требует решений, способных эффективно 
обрабатывать крупномасштабную ингестию данных и выполнять 
аналитику в режиме реального времени.

### Интеграция с существующими системами {#integration-with-existing-systems}

Интеграция с существующими системами представляет собой ещё одну значительную
проблему. Многие организации работают в гетерогенных средах с широким спектром
технологий, поэтому критически важно, чтобы инструменты наблюдаемости
бесшовно интегрировались с текущей инфраструктурой. Открытые стандарты играют
ключевую роль в упрощении такой интеграции, обеспечивая интероперабельность и
снижая сложность развертывания решений для наблюдаемости в разнообразных
технологических стеках.

### Дефицит компетенций {#skill-gaps}

Дефицит компетенций также может препятствовать успешному внедрению 
наблюдаемости. Переход к продвинутым решениям в области наблюдаемости часто 
требует специализированных знаний в области аналитики данных и конкретных 
инструментов. Командам может потребоваться инвестировать в обучение или 
наём специалистов, чтобы устранить эти пробелы и в полной мере использовать 
возможности своих платформ наблюдаемости.

### Управление затратами {#cost-management}

Управление затратами имеет критическое значение, поскольку решения для 
наблюдаемости могут становиться дорогостоящими, особенно при масштабировании. 
Организации должны сбалансировать расходы на эти инструменты с ценностью, 
которую они приносят, выбирая экономичные решения, обеспечивающие значительную 
экономию по сравнению с традиционными подходами.

### Хранение данных и управление сроком их хранения {#data-retention-and-storage}

Управление сроками хранения и размещением данных создаёт дополнительные
сложности. Решение вопроса о том, как долго хранить данные наблюдаемости, не 
ухудшая производительность и полноту получаемых инсайтов, требует тщательного 
планирования и эффективных систем хранения, которые уменьшают требования к 
хранилищу при сохранении доступности данных.

### Стандартизация и зависимость от поставщика {#standardization-and-vendor-lock-in}

Обеспечение стандартизации и предотвращение зависимости от конкретного 
поставщика имеют ключевое значение для сохранения гибкости и адаптивности 
решений по наблюдаемости. Соблюдая открытые стандарты, организации могут 
избежать жёсткой привязки к определённым вендорам и обеспечить возможность
эволюции своего стека наблюдаемости в соответствии с меняющимися потребностями.

### Безопасность и соответствие требованиям {#security-and-compliance}

Вопросы безопасности и соблюдения регуляторных требований остаются 
чрезвычайно важными, особенно при работе с конфиденциальными данными в 
системах наблюдаемости. Организации должны гарантировать, что их решения 
для наблюдаемости соответствуют применимым нормам и эффективно защищают 
чувствительную информацию.

Эти проблемы подчёркивают важность стратегического планирования и 
информированного принятия решений при внедрении решений по наблюдаемости, 
которые эффективно отвечают потребностям организации.

Чтобы справиться с этими вызовами, организациям необходим хорошо 
структурированный подход к внедрению наблюдаемости. Стандартный конвейер 
наблюдаемости эволюционировал, чтобы обеспечить структуру для эффективного 
сбора, обработки и анализа телеметрических данных. Одним из первых и наиболее 
влиятельных примеров такой эволюции является опыт Twitter в 2013 году.
