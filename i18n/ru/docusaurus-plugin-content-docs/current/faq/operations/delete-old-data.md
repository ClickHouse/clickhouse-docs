---
slug: '/faq/operations/delete-old-data'
description: 'Эта страница отвечает на вопрос о том, возможно ли удалить старые'
title: 'Возможно ли удалить старые записи из таблицы ClickHouse?'
doc_type: reference
toc_hidden: true
toc_priority: 20
---
# Можно ли удалить старые записи из таблицы ClickHouse? {#is-it-possible-to-delete-old-records-from-a-clickhouse-table}

Краткий ответ - «да». ClickHouse имеет несколько механизмов, которые позволяют освобождать дисковое пространство, удаляя старые данные. Каждый механизм предназначен для различных сценариев.

## TTL {#ttl}

ClickHouse позволяет автоматически удалять значения, когда происходит определенное условие. Это условие настраивается как выражение на основе любых колонок, обычно просто статического смещения для любого столбца временной метки.

Ключевое преимущество этого подхода заключается в том, что не требуется никакая внешняя система для триггера, как только TTL настроен, удаление данных происходит автоматически в фоновом режиме.

:::note
TTL также может использоваться для перемещения данных не только в [/dev/null](https://en.wikipedia.org/wiki/Null_device), но и между различными системами хранения, например, с SSD на HDD.
:::

Более подробная информация о [настройке TTL](../../engines/table-engines/mergetree-family/mergetree.md#table_engine-mergetree-ttl).

## DELETE FROM {#delete-from}

[DELETE FROM](/sql-reference/statements/delete.md) позволяет выполнять стандартные запросы DELETE в ClickHouse. Строки, на которые указывает условие фильтрации, помечаются как удаленные и исключаются из будущих результатов. Очистка строк происходит асинхронно.

:::note
DELETE FROM в общем доступе начиная с версии 23.3 и новее. В более ранних версиях он является экспериментальным и должен быть активирован с помощью:
```sql
SET allow_experimental_lightweight_delete = true;
```
:::

## ALTER DELETE {#alter-delete}

ALTER DELETE удаляет строки с помощью асинхронных пакетных операций. В отличие от DELETE FROM, запросы, выполняемые после ALTER DELETE и до завершения пакетных операций, будут включать строки, предназначенные для удаления. Более подробную информацию см. в документации по [ALTER DELETE](/sql-reference/statements/alter/delete.md).

`ALTER DELETE` можно использовать для гибкого удаления старых данных. Если вам нужно делать это регулярно, главный недостаток будет заключаться в необходимости иметь внешнюю систему для отправки запроса. Также существуют некоторые соображения по производительности, так как мутации переписывают полные части, даже если нужно удалить только одну строку.

Это самый распространенный подход для обеспечения соответствия вашей системы на основе ClickHouse требованиям [GDPR](https://gdpr-info.eu).

Более подробная информация о [мутациях](/sql-reference/statements/alter#mutations).

## DROP PARTITION {#drop-partition}

`ALTER TABLE ... DROP PARTITION` предоставляет экономичный способ удаления целой партиции. Он менее гибкий и требует корректной схемы партиционирования, настроенной при создании таблицы, но все же охватывает большинство обычных случаев. Как и мутации, он должен выполняться из внешней системы для регулярного использования.

Более подробная информация о [манипуляциях с партициями](/sql-reference/statements/alter/partition).

## TRUNCATE {#truncate}

Это довольно радикальный способ удалить все данные из таблицы, но в некоторых случаях это может быть именно то, что вам нужно.

Более подробная информация о [усечении таблицы](/sql-reference/statements/truncate.md).