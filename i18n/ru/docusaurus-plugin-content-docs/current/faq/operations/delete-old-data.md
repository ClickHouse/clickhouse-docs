---
slug: /faq/operations/delete-old-data
title: 'Можно ли удалить старые записи из таблицы ClickHouse?'
toc_hidden: true
toc_priority: 20
description: 'На этой странице объясняется, можно ли удалить старые записи из таблицы ClickHouse'
doc_type: 'reference'
keywords: ['удаление данных', 'TTL', 'хранение данных', 'очистка', 'жизненный цикл данных']
---



# Можно ли удалить старые записи из таблицы ClickHouse? {#is-it-possible-to-delete-old-records-from-a-clickhouse-table}

Краткий ответ — «да». В ClickHouse есть несколько механизмов, которые позволяют освободить дисковое пространство путём удаления старых данных. Каждый механизм предназначен для разных сценариев.


## TTL {#ttl}

ClickHouse позволяет автоматически удалять значения при выполнении определённого условия. Это условие настраивается как выражение на основе любых столбцов, обычно это просто статическое смещение для столбца с временной меткой.

Ключевое преимущество этого подхода заключается в том, что он не требует внешней системы для запуска: после настройки TTL удаление данных происходит автоматически в фоновом режиме.

:::note
TTL также можно использовать для перемещения данных не только в [/dev/null](https://en.wikipedia.org/wiki/Null_device), но и между различными системами хранения, например с SSD на HDD.
:::

Подробнее о [настройке TTL](../../engines/table-engines/mergetree-family/mergetree.md#table_engine-mergetree-ttl).


## DELETE FROM {#delete-from}

[DELETE FROM](/sql-reference/statements/delete.md) позволяет выполнять стандартные запросы DELETE в ClickHouse. Строки, соответствующие условию в предложении фильтрации, помечаются как удалённые и исключаются из будущих результирующих наборов. Очистка строк происходит асинхронно.

:::note
DELETE FROM является общедоступной функцией начиная с версии 23.3 и новее. В более ранних версиях она является экспериментальной и должна быть включена с помощью:

```sql
SET allow_experimental_lightweight_delete = true;
```

:::


## ALTER DELETE {#alter-delete}

ALTER DELETE удаляет строки с помощью асинхронных пакетных операций. В отличие от DELETE FROM, запросы, выполняемые после ALTER DELETE и до завершения пакетных операций, будут включать строки, помеченные для удаления. Подробнее см. в документации [ALTER DELETE](/sql-reference/statements/alter/delete.md).

`ALTER DELETE` можно использовать для гибкого удаления устаревших данных. Если это необходимо делать регулярно, основным недостатком будет необходимость использования внешней системы для отправки запроса. Также следует учитывать влияние на производительность, поскольку мутации переписывают целые куски данных, даже если требуется удалить только одну строку.

Это наиболее распространенный подход для обеспечения соответствия системы на основе ClickHouse требованиям [GDPR](https://gdpr-info.eu).

Подробнее о [мутациях](/sql-reference/statements/alter#mutations).


## DROP PARTITION {#drop-partition}

`ALTER TABLE ... DROP PARTITION` предоставляет экономичный способ удаления целого раздела. Этот метод не столь гибок и требует правильно настроенной схемы партиционирования при создании таблицы, но тем не менее покрывает большинство типичных случаев. Как и мутации, должен выполняться из внешней системы при регулярном использовании.

Подробнее о [работе с разделами](/sql-reference/statements/alter/partition).


## TRUNCATE {#truncate}

Удаление всех данных из таблицы — довольно радикальная операция, но в некоторых случаях это может быть именно то, что вам нужно.

Подробнее см. в разделе [Усечение таблиц](/sql-reference/statements/truncate.md).
