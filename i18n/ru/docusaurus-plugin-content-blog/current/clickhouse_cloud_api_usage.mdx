---
title: Управление сервисом ClickHouse Cloud с помощью API и cURL
description: Узнайте, как запускать, останавливать и возобновлять сервис ClickHouse Cloud с помощью конечных точек API и команд cURL.
date: 2023-06-07
tags: ['Управление облаком', 'Инструменты и утилиты']
keywords: ['cURL', 'Управление облаком', 'ClickHouse API']
---

{frontMatter.description}

{/* усечение */}


## Как запустить, остановить и возобновить облачный сервис с помощью ClickHouse API и cURL \{#how-to-start-stop-and-resume-a-cloud-service-using-the-clickhouse-api-and-curl\}

## Вопрос \{#question\}

Как с помощью конечных точек API запускать, останавливать и возобновлять работу сервиса ClickHouse Cloud?

## Ответ

1. Чтобы вывести облачный сервис из неактивного состояния, отправьте ping‑запрос к экземпляру:

```bash
curl -X GET https://abc123.us-west-2.aws.clickhouse.cloud:8443/ping
```

2. Чтобы остановить облачный сервис, используйте конечную точку `/state` вместе с командой `stop`. Синтаксис следующий:

```bash
curl -X PATCH https://api.clickhouse.cloud/v1/organizations/<org_uuid>/services/<service_uuid>/state -u <key_id>:<key_secret> -H "Content-Type: application/json" -d ''{"command": "<stop|start>"}''
```

Например, следующая команда останавливает службу `2e2124ca-c5ac-459d-a6f2-abc123549d2a`:

```bash
curl -X PATCH https://api.clickhouse.cloud/v1/organizations/123abcd0-e9b5-4f55-9e42-0fb04392445c/services/2e2124ca-c5ac-459d-a6f2-abc123549d2a/state -u abc123:ABC123 -H "Content-Type: application/json" -d '{"command": "stop"}'
```

Результат выглядит следующим образом:

```response
{"result":{"id":"2e2124ca-c5ac-459d-a6f2-abc123549d2a","name":"mars-s3","provider":"aws","regionId":"us-west-2","state":"stopping","endpoints":[{"protocol":"nativesecure","host":"abc123.us-west-2.aws.clickhouse.cloud","port":9440},{"protocol":"https","host":"abc123ntrb.us-west-2.aws.clickhouse.cloud","port":8443}],"tier":"production","idleScaling":true,"idleTimeoutMinutes":5,"minTotalMemoryGb":24,"maxTotalMemoryGb":48,"ipAccessList":[{"source":"[0.0.0.0/0](http://0.0.0.0/0)","description":"Везде"}],"createdAt":"2022-10-21T18:46:31Z"},"status":200}%
```

3. Чтобы повторно запустить службу, используйте команду `start`:

```bash
curl -X PATCH https://api.clickhouse.cloud/v1/organizations/123abcd0-e9b5-4f55-9e42-0fb04392445c/services/2e2124ca-c5ac-459d-a6f2-abc123549d2a/state -u abc123:ABC123 -H "Content-Type: application/json" -d '{"command": "start"}'
```

:::note
Вот возможные состояния сервиса:

```
"state":"останавливается"
"state":"остановлен"
"state":"запускается"
"state":"выполняется"
"state":"простаивает"
```

:::

:::note
Облачный сервис в состоянии **«idle»** (простаивает) считается запущенным, поэтому команда `start` не возобновит его и не «разбудит». Используйте endpoint `ping`, показанный в шаге 1, чтобы «разбудить» сервис.
:::
