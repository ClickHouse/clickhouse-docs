---
title: Как установить ClickHouse на Windows 10?
description: "Узнайте, как установить и протестировать ClickHouse на Windows 10 с использованием WSL 2. Включает настройку, устранение неполадок и запуск тестовой среды."
date: 2023-04-24
tags: ['Инструменты и утилиты']
keywords: ['Windows 10']
---

{frontMatter.description}

{/* truncate */}


## Как установить и протестировать ClickHouse на Microsoft Windows

При установке ClickHouse на Windows 10 вы можете получать ошибки при вставке данных, например:

```
DB::Exception: std::__1::__fs::filesystem::filesystem_error: ошибка файловой системы: при переименовании: Отказано в доступе ["./store/711/71144174-d098-4056-8976-6ad1204205ec/tmp_insert_all_1_1_0/"] ["./store/711/71144174-d098-4056-8976-6ad1204205ec/all_1_1_0/"]. Трассировка стека:
```

В Windows 10 необходимо обновить WSL до версии WSL 2.

* Откройте PowerShell, щёлкнув правой кнопкой мыши по значку PowerShell и выбрав «Запуск от имени администратора».

* Следуйте инструкциям Microsoft по обновлению до WSL 2 по ссылке:
  [https://learn.microsoft.com/en-us/windows/wsl/install](https://learn.microsoft.com/en-us/windows/wsl/install)

* После обновления откройте WSL из PowerShell.

```
wsl
```

* Для тестирования следуйте этим инструкциям, у вас должен получиться похожий вывод:
  Поскольку это только для тестирования, я вошёл под пользователем root, чтобы избежать проблем с правами доступа:

```
sudo -i
```

* Создайте каталог ClickHouse:

```
root@marspc2:~# mkdir /clickhouse
```

* Находясь в новой директории, загрузите ClickHouse:

```
root@marspc2:/# cd clickhouse

root@marspc2:/clickhouse# curl https://clickhouse.com | sh
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  2739    0  2739    0     0   5515      0 --:--:-- --:--:-- --:--:--  5511

Загрузка https://builds.clickhouse.com/master/amd64/clickhouse в clickhouse

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  530M  100  530M    0     0  8859k      0  0:01:01  0:01:01 --:--:-- 8549k

Бинарный файл ClickHouse успешно загружен. Запустить его можно следующим образом:
    ./clickhouse

Также можно установить его:
    sudo ./clickhouse install
```

* Запустите сервер ClickHouse:

```
root@marspc2:/clickhouse# ./clickhouse server
Processing configuration file 'config.xml'.
There is no file 'config.xml', will use embedded config.
Cannot set max size of core file to 1073741824
2023.04.17 19:19:23.155323 [ 500 ] {} <Information> SentryWriter: Sending crash reports is disabled
2023.04.17 19:19:23.165447 [ 500 ] {} <Trace> Pipe: Pipe capacity is 1.00 MiB
2023.04.17 19:19:23.271147 [ 500 ] {} <Information> Application: Starting ClickHouse 23.4.1.1222 (revision: 54473, git hash: 3993aef8e281815ac4269d44e27bb1dcdcff21cb, build id: AF16AA59B689841860F39ACDBED30AC8F9AB70FA), PID 500
2023.04.17 19:19:23.271208 [ 500 ] {} <Information> Application: starting up
2023.04.17 19:19:23.271237 [ 500 ] {} <Information> Application: OS name: Linux, version: 5.15.90.1-microsoft-standard-WSL2, architecture: x86_64
...
```

* В другом окне WSL запустите клиент:

```
root@marspc2:/clickhouse# ./clickhouse client
Клиент ClickHouse версии 23.4.1.1222 (официальная сборка).
Подключение к localhost:9000 от имени пользователя default.
Подключено к серверу ClickHouse версии 23.4.1, ревизия 54462.

Предупреждения:
 * Прозрачные огромные страницы Linux установлены в режим "always". Проверьте /sys/kernel/mm/transparent_hugepage/enabled

marspc2. :)
```

* Создайте базу данных и таблицу:


```
marspc2. :) create database db1;

CREATE DATABASE db1

Query id: 688f79e2-8132-44ed-98d6-0581abe9903a

Ok.

0 rows in set. Elapsed: 0.007 sec.

marspc2. :) create table db1.table1 (id Int64, string_column String) engine = MergeTree() order by id;

CREATE TABLE db1.table1
(
    `id` Int64,
    `string_column` String
)
ENGINE = MergeTree
ORDER BY id

Query id: d91a93b4-e13f-4e17-8201-f329223287d0

Ok.

0 rows in set. Elapsed: 0.010 sec.
```

* Вставьте несколько примерных строк:

```
marspc2. :) insert into db1.table1 (id, string_column) values (1, 'a'), (2,'b');

INSERT INTO db1.table1 (id, string_column) FORMAT Values

Query id: 2b274eef-09af-434b-88e0-c25799649910

Ok.

2 rows in set. Elapsed: 0.003 sec.
```

* Просмотрите строки:

```
marspc2. :) select * from db1.table1;

SELECT *
FROM db1.table1

Query id: 74c76bf1-d944-4b21-a384-cc0b5e6aa579

┌─id─┬─string_column─┐
│  1 │ a             │
│  2 │ b             │
└────┴───────────────┘

Получено 2 строки. Затрачено: 0.002 сек.
```
