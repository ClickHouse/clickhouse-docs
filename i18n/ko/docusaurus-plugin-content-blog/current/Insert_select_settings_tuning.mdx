---
title: INSERT...SELECT 중 발생하는 TOO MANY PARTS 오류는 어떻게 해결합니까?
description: "`INSERT...SELECT` 실행 중 ClickHouse에서 발생하는 TOO_MANY_PARTS 오류를 더 큰 블록 크기와 파티션 임계값 확대를 위한 고급 설정 조정을 통해 해결하는 방법을 설명합니다."
date: 2023-07-21
tags: ['설정', '에러 및 예외']
---

{frontMatter.description}

{/* 생략 */}

## Question \{#question\}

`INSERT...SELECT` 구문을 실행할 때 파트가 너무 많다는 TOO&#95;MANY&#95;PARTS 오류가 발생합니다.

이 문제를 어떻게 해결할 수 있습니까?

## Answer \{#answer\}

아래는 이 오류를 피하기 위해 조정할 수 있는 일부 설정입니다. 이는 ClickHouse에 대한 전문가 수준 튜닝이며, 이 값들은 사용될 ClickHouse Cloud 서비스 또는 온프레미스 클러스터의 사양을 충분히 이해한 후에만 설정해야 합니다. 따라서 이 값들을 「모든 환경에 공통으로 적용 가능한 값」으로 간주해서는 안 됩니다.

[max&#95;insert&#95;block&#95;size](https://clickhouse.com/docs/operations/settings/settings#settings-max_insert_block_size) = `100_000_000` (기본값 `1_048_576`)

약 1M에서 100M으로 늘리면 더 큰 블록이 생성되도록 할 수 있습니다.

참고: 이 설정은 서버가 블록을 생성할 때에만 적용됩니다. 즉, HTTP 인터페이스를 통한 INSERT에만 적용되며, clickhouse-client에는 적용되지 않습니다.

[min&#95;insert&#95;block&#95;size&#95;rows](https://clickhouse.com/docs/operations/settings/settings#min-insert-block-size-rows) = `100_000_000` (기본값 `1_048_576`)

약 1M에서 100M으로 늘리면 더 큰 블록이 생성되도록 할 수 있습니다.

[min&#95;insert&#95;block&#95;size&#95;bytes](https://clickhouse.com/docs/operations/settings/settings#min-insert-block-size-bytes) = `500_000_000` (기본값 `268_435_456`)

268.44 MB에서 500 MB로 늘리면 더 큰 블록이 생성되도록 할 수 있습니다.

[parts&#95;to&#95;delay&#95;insert](https://clickhouse.com/docs/operations/settings/merge-tree-settings#parts-to-delay-insert) = `500` (기본값 `150`)

단일 파티션에서 활성 파트 개수가 임계치에 도달했을 때 INSERT가 인위적으로 느려지지 않도록 이 값을 증가시킵니다.

[parts&#95;to&#95;throw&#95;insert](https://clickhouse.com/docs/operations/settings/merge-tree-settings#parts-to-throw-insert) = `1500` (기본값 `3000`)

이 값을 증가시키면 일반적으로 해당 테이블에 대한 쿼리 성능에 영향을 줄 수 있지만, 데이터 마이그레이션에서는 문제가 되지 않습니다.