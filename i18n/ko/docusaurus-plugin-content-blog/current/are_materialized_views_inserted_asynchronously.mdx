---
title: materialized view는 동기적으로 INSERT됩니까?
description: 이 KB 문서에서는 materialized view의 INSERT가 동기적으로 수행되는지 여부를 설명합니다.
date: 2023-03-01
tags: ['데이터 모델링']
keywords: ['materialized view']
---

{frontMatter.description}

{{/* 생략 */}}

## Materialized View는 동기적으로 삽입됩니까? \{#are-materialized-views-inserted-synchronously\}

**질문:** 소스 테이블에 새로운 행이 삽입되면, 그 새로운 행은 해당 소스 테이블의 모든 materialized view로도 전송됩니다. 이때 Materialized View로의 삽입이 동기적으로 수행된다는 것, 즉 서버에서 클라이언트로 삽입 성공이 확인되는 시점에는 모든 Materialized View가 완전히 갱신되어 쿼리에 사용할 수 있는 상태라는 의미입니까?

**답변:**

1. `INSERT`가 성공하면, 데이터는 테이블과 모든 materialized view에 함께 삽입됩니다.
2. materialized view 관점에서 삽입은 원자적(atomic)이지 않습니다. `INSERT`가 진행 중인 시점에는, 동시 실행 중인 클라이언트가 중간 상태를 볼 수 있습니다. 예를 들어 데이터가 메인 테이블에는 삽입되었지만 materialized view에는 아직 삽입되지 않았거나, 그 반대의 상태를 볼 수 있습니다.
3. [async inserts](https://clickhouse.com/docs/optimize/asynchronous-inserts/)를 사용하는 경우, 이들은 데이터를 모았다가 내부적으로 일반 insert를 수행하며, 일반 insert와 동일한 유형의 응답을 클라이언트에 반환합니다. 클라이언트가 기본값과 같이 `wait_for_async_insert` 옵션을 사용한 async insert에서 성공 응답을 받은 경우, 데이터는 테이블과 그에 속한 모든 materialized view에 삽입됩니다.

**질문:** 체인/캐스케이딩 materialized view의 경우는 어떻습니까?

**답변:**
동일한 규칙이 적용됩니다. 성공적인 응답을 받은 `INSERT`는 체인에 있는 모든 materialized view에 데이터가 삽입되었음을 의미합니다. 이 삽입 작업은 원자적이지 않습니다.