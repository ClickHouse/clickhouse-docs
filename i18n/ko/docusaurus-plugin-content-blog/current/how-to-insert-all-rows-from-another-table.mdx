---
title: 한 테이블의 모든 행을 다른 테이블에 삽입하려면 어떻게 하나요?
description: "한 테이블의 모든 행을 다른 테이블에 삽입하는 방법을 설명하는 지식베이스 문서입니다."
date: 2024-12-17
tags: ['데이터 수집']
keywords: ['테이블에서 데이터 삽입']
---

{frontMatter.description}

{{/* 생략 */}}

## 소개 \{#introduction\}

때때로 하나의 테이블에서 다른 테이블로 모든 데이터를 다시 수집해야 하는 경우가 있습니다.

예를 들어, 스테이징 테이블의 데이터를 프로덕션 테이블로 다시 수집하려는 경우가 있을 수 있습니다. 이 문서에서는 `INSERT INTO` 문을 사용하여 이를 수행하는 방법을 설명합니다.

## 예시 \{#example\}

아래는 동작 방식과 테스트하는 방법을 보여 주는 간단한 예시입니다:

* 샘플 데이터베이스를 생성합니다

```sql
CREATE DATABASE db1;
```

* 예제 테이블을 생성합니다

```sql
CREATE TABLE db1.source_table
(
    city VARCHAR,
    country VARCHAR,
    continent VARCHAR
)
engine = MergeTree()
ORDER BY continent;
```

* 소스 테이블에 일부 데이터를 삽입합니다

```sql
INSERT INTO db1.source_table (city, country, continent)
VALUES
    ('New York', 'USA', 'North America'),
    ('Tokyo', 'Japan', 'Asia'),
    ('Berlin', 'Germany', 'Europe'),
    ('Paris', 'France', 'Europe'),
    ('Cairo', 'Egypt', 'Africa'),
    ('Sydney', 'Australia', 'Australia');
```

* 소스 테이블의 행 수를 확인합니다

```sql
SELECT COUNT(*) FROM db1.source_table;
```

```text
┌─count()─┐
│      6  │
└─────────┘
```

* 원본 테이블과 동일한 구조로 새 테이블을 생성합니다.

```sql
CREATE TABLE db1.target_table AS db1.source_table;
```

* 소스 테이블의 모든 행을 대상 테이블에 삽입합니다.

```sql
INSERT INTO db1.target_table SELECT * FROM db1.source_table;
```

* 대상 테이블에서 행 수를 확인하십시오

```sql
SELECT COUNT(*) FROM db1.target_table;
```

```text
┌─count()─┐
│      6  │
└─────────┘
```

새 테이블의 구조를 수정하려면 먼저 소스 테이블의 구조를 확인해 볼 수 있습니다.

```sql
SHOW CREATE TABLE db1.source_table;
```

그런 다음 수정된 구조로 새 테이블을 생성합니다. 이 예제에서는 대상 테이블에 새로운 컬럼 `population`을 추가합니다.

```sql
CREATE TABLE db1.target_table_population
(
    `city` String,
    `country` String,
    `continent` String,
    `population` UInt16,
)
ENGINE = MergeTree
ORDER BY continent;
```

* 새 컬럼을 포함하여 소스 테이블의 모든 행을 대상 테이블에 삽입합니다. 모든 행의 population 필드는 0으로 설정합니다.

```sql
INSERT INTO db1.target_table_population (city, country, continent, population)
SELECT city, country, continent, 0 FROM db1.source_table;
```

* 대상 테이블의 데이터를 확인하십시오

```sql
SELECT * FROM db1.target_table_population LIMIT 3;
```

```text
┌─city──────┬─country───┬─continent──────┬─population─┐
│ New York  │ USA       │ North America  │          0 │
│ Tokyo     │ Japan     │ Asia           │          0 │
│ Berlin    │ Germany   │ Europe         │          0 │
└───────────┴───────────┴────────────────┴────────────┘
```
