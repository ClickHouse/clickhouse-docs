---
'slug': '/cloud/data-resiliency'
'sidebar_label': '데이터 복원력'
'title': '재해 복구'
'description': '이 가이드는 재해 복구에 대한 개요를 제공합니다.'
'doc_type': 'reference'
'keywords':
- 'ClickHouse Cloud'
- 'data resiliency'
- 'disaster recovery'
---

import Image from '@theme/IdealImage';
import restore_backup from '@site/static/images/cloud/guides/restore_backup.png';


# 데이터 복원력 {#clickhouse-cloud-data-resiliency}

이 페이지에서는 ClickHouse Cloud의 재난 복구 권장 사항과 고객이 장애에서 복구하는 방법에 대한 지침을 다룹니다. ClickHouse Cloud는 현재 자동 장애 조치 또는 여러 지리적 지역 간의 자동 동기화를 지원하지 않습니다.

:::tip
고객은 자신의 서비스 크기 및 구성에 대한 특정 RTO를 이해하기 위해 주기적인 백업 복원 테스트를 수행해야 합니다.
:::

## 정의 {#definitions}

먼저 몇 가지 정의를 다루는 것이 도움이 됩니다.

**RPO (복구 지점 목표)**: 파괴적인 사건 발생 후 최대 허용 데이터 손실을 시간으로 측정한 것입니다. 예: 30분의 RPO는 실패가 발생할 경우 DB가 30분 이상 된 데이터로 복원할 수 있다는 의미입니다. 이는 물론 백업이 얼마나 자주 이루어지는지에 따라 달라집니다.

**RTO (복구 시간 목표)**: 사고 발생 후 정상 운영이 재개되기 전까지 허용 가능한 최대 다운타임입니다. 예: 30분의 RTO는 실패가 발생할 경우 팀이 데이터와 애플리케이션을 복원하여 30분 이내에 정상 운영을 시작할 수 있다는 의미입니다.

**데이터베이스 백업 및 스냅샷**: 백업은 데이터의 별도 복사본을 포함한 내구성 있는 장기 저장 솔루션을 제공합니다. 스냅샷은 데이터의 추가 복사본을 생성하지 않으며, 일반적으로 더 빠르고 더 나은 RPO를 제공합니다.

## 데이터베이스 백업 {#database-backups}

주 서비스의 백업을 보유하는 것은 주 서비스가 다운될 경우 백업을 활용하고 복원하는 효과적인 방법입니다. ClickHouse Cloud는 다음과 같은 백업 기능을 지원합니다.

1. **기본 백업**

기본적으로 ClickHouse Cloud는 귀하의 서비스에 대해 24시간마다 [백업](/cloud/manage/backups)을 수행합니다. 이러한 백업은 서비스와 동일한 지역에서 이루어지며, ClickHouse CSP (클라우드 서비스 제공업체) 스토리지 버킷에서 발생합니다. 주 서비스의 데이터가 손상될 경우, 백업을 사용하여 새로운 서비스로 복원할 수 있습니다.

2. **외부 백업 (고객의 저장소 버킷 내)**

Enterprise Tier 고객은 [백업을 내 클라우드 계정으로 내보내기](/cloud/manage/backups/export-backups-to-own-cloud-account)를 통해 자신의 계정에 있는 객체 저장소로 내보낼 수 있으며, 동일한 지역 또는 다른 지역에 저장할 수 있습니다. 크로스 클라우드 백업 내보내기 지원이 곧 제공될 예정입니다. 지역 간 및 클라우드 간 백업에는 관련 데이터 전송 요금이 적용됩니다.

:::note
이 기능은 현재 PCI/HIPAA 서비스에서 사용할 수 없습니다.
:::

3. **구성 가능한 백업**

고객은 [백업 구성하기](/cloud/manage/backups/configurable-backups)를 통해 RPO를 개선하기 위해 6시간마다 한 번의 빈도로 더 높은 빈도로 백업을 수행하도록 설정할 수 있습니다. 고객은 긴 보존 기간으로도 구성할 수 있습니다.

서비스에 현재 사용할 수 있는 백업은 ClickHouse Cloud 콘솔의 “백업” 페이지에 나열되어 있습니다. 이 섹션은 각 백업의 성공/실패 상태도 제공합니다.

## 백업에서 복원하기 {#restoring-from-a-backup}

1. ClickHouse Cloud 버킷의 기본 백업은 동일한 지역의 새로운 서비스로 복원될 수 있습니다.
2. 외부 백업 (고객 객체 저장소 내)은 동일한 지역 또는 다른 지역의 새로운 서비스로 복원될 수 있습니다.

## 백업 및 복원 기간 지침 {#backup-and-restore-duration-guidance}

백업 및 복원 기간은 데이터베이스의 크기, 스키마 및 데이터베이스 내 테이블 수와 같은 여러 요인에 따라 달라집니다.

테스트에서 확인한 바에 따르면, 작은 백업 약 1 TB의 경우 백업 소요 시간이 최대 10-15분 또는 그 이상 걸렸습니다. 20 TB 미만의 백업은 보통 한 시간 이내에 완료되며, 약 50 TB의 데이터를 백업하는 데는 2-3 시간이 소요됩니다. 더 큰 크기에서 백업은 규모의 경제를 얻으며, 일부 내부 서비스에서는 최대 1 PB의 백업이 10시간 이내에 완료된 바 있습니다.

보다 나은 추정치를 얻기 위해 자신의 데이터베이스나 샘플 데이터를 사용하여 테스트할 것을 권장합니다. 실제 기간은 위에서 정리한 여러 요인에 따라 달라집니다.

복원 기간은 유사한 크기의 백업 시 백업 소요 시간과 유사합니다. 위에서 언급한 바와 같이, 백업 복원에 걸리는 시간을 확인하기 위해 자신의 데이터베이스로 테스트할 것을 권장합니다.

:::note
현재 두 개의 ClickHouse Cloud 인스턴스 간에 자동 장애 조치가 지원되지 않습니다. 동일한 지역 또는 다른 지역 간의 데이터 자동 동기도 현재 지원되지 않습니다. 즉, Active-Active 복제는 지원되지 않음.
:::

## 복구 프로세스 {#recovery-process}

이 섹션에서는 다양한 복구 옵션과 각 경우에 따라 따를 수 있는 프로세스를 설명합니다.

### 주 서비스 데이터 손상 {#primary-service-data-corruption}

이 경우, 데이터는 [백업에서 복원할 수 있습니다](/cloud/manage/backups/overview#restore-a-backup) 같은 지역의 다른 서비스로. 기본 백업 정책을 사용하는 경우 최대 24시간이 경과한 백업 또는 6시간 빈도의 구성 가능한 백업을 사용하는 경우 최대 6시간이 지났을 수 있습니다.

#### 복원 단계 {#restoration-steps}

기존 백업에서 복원하려면

<VerticalStepper headerLevel="list">

1. ClickHouse Cloud 콘솔의 “백업” 섹션으로 이동합니다.
2. 복원하려는 특정 백업의 “작업” 아래에서 세 개의 점을 클릭합니다.
3. 새로운 서비스에 특정 이름을 부여하고 이 백업에서 복원합니다.

<Image img={restore_backup} size="md" alt="백업에서 복원"/>

</VerticalStepper>

### 기본 지역 다운타임 {#primary-region-downtime}

Enterprise Tier 고객은 자신의 클라우드 제공업체 버킷으로 [백업을 내보낼 수 있습니다](/cloud/manage/backups/export-backups-to-own-cloud-account). 지역 장애를 염려하는 경우 다른 지역으로 백업을 내보낼 것을 권장합니다. 크로스 지역 데이터 전송 요금이 적용될 수 있음을 유념하시기 바랍니다.

기본 지역이 다운될 경우, 다른 지역에 있는 백업을 새로운 서비스로 복원할 수 있습니다.

백업이 다른 서비스로 복원된 후, 모든 DNS, 로드 밸런서 또는 연결 문자열 구성이 새로운 서비스로 가리키도록 업데이트되어야 합니다. 이 과정에는 다음 사항이 포함될 수 있습니다.

- 환경 변수 또는 비밀 업데이트
- 새로운 연결을 설정하기 위해 애플리케이션 서비스를 재시작

:::note
외부 버킷으로의 백업/복원은 현재 [투명 데이터 암호화 (TDE)](/cloud/security/cmek#transparent-data-encryption-tde)를 활용하는 서비스에서는 지원되지 않습니다.
:::

## 추가 옵션 {#additional-options}

고려할 몇 가지 추가 옵션이 있습니다.

1. **별도의 클러스터에 이중 쓰기**

이 옵션에서는 다른 지역에 2개의 별도 클러스터를 설정하고 두 클러스터 모두에 이중 쓰기를 수행할 수 있습니다. 이 옵션은 여러 서비스를 운영하는 것이기 때문에 본질적으로 더 높은 비용이 수반되지만, 한 지역이 사용 불가능해질 경우 더 높은 가용성을 제공합니다.

2. **CSP 복제 활용하기**

이 옵션에서는 클라우드 서비스 제공업체의 기본 객체 저장소 복제를 활용하여 데이터를 복사할 수 있습니다. 예를 들어, BYOB를 사용하면 백업을 기본 지역의 귀하 소속 버킷으로 내보내고 [AWS 크로스 지역 복제](https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication.html)를 사용하여 다른 지역으로 복제할 수 있습니다.
