---
'slug': '/sql-reference/functions/geo/s2'
'sidebar_label': 'S2 기하학'
'title': 'S2 인덱스와 작업하기 위한 함수'
'description': 'S2 인덱스와 작업하기 위한 함수에 대한 문서'
'doc_type': 'reference'
---


# S2 인덱스를 사용한 작업을 위한 함수

## S2Index {#s2index}

[S2](https://s2geometry.io/)는 모든 지리 데이터를 구에 표현하는 지리 인덱싱 시스템입니다 (지구본과 유사).

S2 라이브러리에서는 점을 S2 인덱스로 표현합니다. 이는 전통적인 (위도, 경도) 쌍과 달리 단위 구면의 표면에 있는 점을 내부적으로 인코딩하는 특정 번호입니다. (위도, 경도) 형식으로 지정된 주어진 점의 S2 포인트 인덱스를 얻으려면 [geoToS2](#geotos2) 함수를 사용하십시오. 또한 지정된 S2 포인트 인덱스에 해당하는 지리 좌표를 얻기 위해 [s2ToGeo](#s2togeo) 함수를 사용할 수 있습니다.

## geoToS2 {#geotos2}

제공된 좌표 `(경도, 위도)`에 해당하는 [S2](#s2index) 포인트 인덱스를 반환합니다.

**구문**

```sql
geoToS2(lon, lat)
```

**인수**

- `lon` — 경도. [Float64](../../data-types/float.md).
- `lat` — 위도. [Float64](../../data-types/float.md).

**반환 값**

- S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).

**예시**

쿼리:

```sql
SELECT geoToS2(37.79506683, 55.71290588) AS s2Index;
```

결과:

```text
┌─────────────s2Index─┐
│ 4704772434919038107 │
└─────────────────────┘
```

## s2ToGeo {#s2togeo}

제공된 [S2](#s2index) 포인트 인덱스에 해당하는 지리 좌표 `(경도, 위도)`를 반환합니다.

**구문**

```sql
s2ToGeo(s2index)
```

**인수**

- `s2index` — S2 인덱스. [UInt64](../../data-types/int-uint.md).

**반환 값**

- 두 값으로 구성된 [튜플](../../data-types/tuple.md): 
    - `lon`. [Float64](../../data-types/float.md).
    - `lat`. [Float64](../../data-types/float.md).

**예시**

쿼리:

```sql
SELECT s2ToGeo(4704772434919038107) AS s2Coodrinates;
```

결과:

```text
┌─s2Coodrinates────────────────────────┐
│ (37.79506681471008,55.7129059052841) │
└──────────────────────────────────────┘
```

## s2GetNeighbors {#s2getneighbors}

제공된 [S2](#s2index)에 해당하는 S2 이웃 인덱스를 반환합니다. S2 시스템의 각 셀은 네 개의 측지선으로 경계 지어진 사각형입니다. 따라서 각 셀은 4개의 이웃을 가집니다.

**구문**

```sql
s2GetNeighbors(s2index)
```

**인수**

- `s2index` — S2 인덱스. [UInt64](../../data-types/int-uint.md).

**반환 값**

- 4개의 이웃 인덱스로 구성된 배열: `array[s2index1, s2index3, s2index2, s2index4]`. [Array](../../data-types/array.md)([UInt64](../../data-types/int-uint.md)).

**예시**

쿼리:

```sql
SELECT s2GetNeighbors(5074766849661468672) AS s2Neighbors;
```

결과:

```text
┌─s2Neighbors───────────────────────────────────────────────────────────────────────┐
│ [5074766987100422144,5074766712222515200,5074767536856236032,5074767261978329088] │
└───────────────────────────────────────────────────────────────────────────────────┘
```

## s2CellsIntersect {#s2cellsintersect}

제공된 두 [S2](#s2index) 셀이 교차하는지 여부를 결정합니다.

**구문**

```sql
s2CellsIntersect(s2index1, s2index2)
```

**인수**

- `siIndex1`, `s2index2` — S2 인덱스. [UInt64](../../data-types/int-uint.md).

**반환 값**

- `1` — 세포가 교차하는 경우. [UInt8](../../data-types/int-uint.md).
- `0` — 세포가 교차하지 않는 경우. [UInt8](../../data-types/int-uint.md).

**예시**

쿼리:

```sql
SELECT s2CellsIntersect(9926595209846587392, 9926594385212866560) AS intersect;
```

결과:

```text
┌─intersect─┐
│         1 │
└───────────┘
```

## s2CapContains {#s2capcontains}

캡이 S2 포인트를 포함하는지 여부를 결정합니다. 캡은 평면에 의해 잘려진 구의 일부를 나타냅니다. 이는 구의 한 점과 도로 정의됩니다.

**구문**

```sql
s2CapContains(center, degrees, point)
```

**인수**

- `center` — 캡에 해당하는 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).
- `degrees` — 캡의 반지름 (도). [Float64](../../data-types/float.md).
- `point` — S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).

**반환 값**

- `1` — 캡이 S2 포인트 인덱스를 포함하는 경우. [UInt8](../../data-types/int-uint.md).
- `0` — 캡이 S2 포인트 인덱스를 포함하지 않는 경우. [UInt8](../../data-types/int-uint.md).

**예시**

쿼리:

```sql
SELECT s2CapContains(1157339245694594829, 1.0, 1157347770437378819) AS capContains;
```

결과:

```text
┌─capContains─┐
│           1 │
└─────────────┘
```

## s2CapUnion {#s2capunion}

주어진 두 입력 캡을 포함하는 가장 작은 캡을 결정합니다. 캡은 평면에 의해 잘려진 구의 일부를 나타냅니다. 이는 구의 한 점과 도로 정의됩니다.

**구문**

```sql
s2CapUnion(center1, radius1, center2, radius2)
```

**인수**

- `center1`, `center2` — 두 입력 캡에 해당하는 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).
- `radius1`, `radius2` — 두 입력 캡의 반지름 (도). [Float64](../../data-types/float.md).

**반환 값**

- `center` — 두 입력 캡을 포함하는 가장 작은 캡의 중심에 해당하는 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).
- `radius` — 두 입력 캡을 포함하는 가장 작은 캡의 반지름. [Float64](../../data-types/float.md).

**예시**

쿼리:

```sql
SELECT s2CapUnion(3814912406305146967, 1.0, 1157347770437378819, 1.0) AS capUnion;
```

결과:

```text
┌─capUnion───────────────────────────────┐
│ (4534655147792050737,60.2088283994957) │
└────────────────────────────────────────┘
```

## s2RectAdd {#s2rectadd}

주어진 S2 포인트를 포함하도록 경계 사각형의 크기를 증가시킵니다. S2 시스템에서 사각형은 `S2LatLngRect`라는 S2Region 유형으로 표현되며, 이는 위도-경도 공간의 사각형을 나타냅니다.

**구문**

```sql
s2RectAdd(s2pointLow, s2pointHigh, s2Point)
```

**인수**

- `s2PointLow` — 사각형에 해당하는 낮은 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).
- `s2PointHigh` — 사각형에 해당하는 높은 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).
- `s2Point` — 경계 사각형이 포함해야 하는 대상 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).

**반환 값**

- `s2PointLow` — 증가된 사각형에 해당하는 낮은 S2 셀 ID. [UInt64](../../data-types/int-uint.md).
- `s2PointHigh` — 증가된 사각형에 해당하는 높은 S2 셀 ID. [UInt64](../../data-types/float.md).

**예시**

쿼리:

```sql
SELECT s2RectAdd(5178914411069187297, 5177056748191934217, 5179056748191934217) AS rectAdd;
```

결과:

```text
┌─rectAdd───────────────────────────────────┐
│ (5179062030687166815,5177056748191934217) │
└───────────────────────────────────────────┘
```

## s2RectContains {#s2rectcontains}

주어진 사각형이 S2 포인트를 포함하는지 여부를 결정합니다. S2 시스템에서 사각형은 `S2LatLngRect`라는 S2Region 유형으로 표현되며, 이는 위도-경도 공간의 사각형을 나타냅니다.

**구문**

```sql
s2RectContains(s2PointLow, s2PointHi, s2Point)
```

**인수**

- `s2PointLow` — 사각형에 해당하는 낮은 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).
- `s2PointHigh` — 사각형에 해당하는 높은 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).
- `s2Point` — 대상 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).

**반환 값**

- `1` — 사각형이 주어진 S2 포인트를 포함하는 경우.
- `0` — 사각형이 주어진 S2 포인트를 포함하지 않는 경우.

**예시**

쿼리:

```sql
SELECT s2RectContains(5179062030687166815, 5177056748191934217, 5177914411069187297) AS rectContains;
```

결과:

```text
┌─rectContains─┐
│            0 │
└──────────────┘
```

## s2RectUnion {#s2rectunion}

이 사각형과 주어진 사각형의 합집합을 포함하는 가장 작은 사각형을 반환합니다. S2 시스템에서 사각형은 `S2LatLngRect`라는 S2Region 유형으로 표현되며, 이는 위도-경도 공간의 사각형을 나타냅니다.

**구문**

```sql
s2RectUnion(s2Rect1PointLow, s2Rect1PointHi, s2Rect2PointLow, s2Rect2PointHi)
```

**인수**

- `s2Rect1PointLow`, `s2Rect1PointHi` — 첫 번째 사각형에 해당하는 낮은 및 높은 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).
- `s2Rect2PointLow`, `s2Rect2PointHi` — 두 번째 사각형에 해당하는 낮은 및 높은 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).

**반환 값**

- `s2UnionRect2PointLow` — 합집합 사각형에 해당하는 낮은 S2 셀 ID. [UInt64](../../data-types/int-uint.md).
- `s2UnionRect2PointHi` — 합집합 사각형에 해당하는 높은 S2 셀 ID. [UInt64](../../data-types/int-uint.md).

**예시**

쿼리:

```sql
SELECT s2RectUnion(5178914411069187297, 5177056748191934217, 5179062030687166815, 5177056748191934217) AS rectUnion;
```

결과:

```text
┌─rectUnion─────────────────────────────────┐
│ (5179062030687166815,5177056748191934217) │
└───────────────────────────────────────────┘
```

## s2RectIntersection {#s2rectintersection}

주어진 사각형과 이 사각형의 교차점을 포함하는 가장 작은 사각형을 반환합니다. S2 시스템에서 사각형은 `S2LatLngRect`라는 S2Region 유형으로 표현되며, 이는 위도-경도 공간의 사각형을 나타냅니다.

**구문**

```sql
s2RectIntersection(s2Rect1PointLow, s2Rect1PointHi, s2Rect2PointLow, s2Rect2PointHi)
```

**인수**

- `s2Rect1PointLow`, `s2Rect1PointHi` — 첫 번째 사각형에 해당하는 낮은 및 높은 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).
- `s2Rect2PointLow`, `s2Rect2PointHi` — 두 번째 사각형에 해당하는 낮은 및 높은 S2 포인트 인덱스. [UInt64](../../data-types/int-uint.md).

**반환 값**

- `s2UnionRect2PointLow` — 주어진 사각형의 교차점을 포함하는 사각형에 해당하는 낮은 S2 셀 ID. [UInt64](../../data-types/int-uint.md).
- `s2UnionRect2PointHi` — 주어진 사각형의 교차점을 포함하는 사각형에 해당하는 높은 S2 셀 ID. [UInt64](../../data-types/int-uint.md).

**예시**

쿼리:

```sql
SELECT s2RectIntersection(5178914411069187297, 5177056748191934217, 5179062030687166815, 5177056748191934217) AS rectIntersection;
```

결과:

```text
┌─rectIntersection──────────────────────────┐
│ (5178914411069187297,5177056748191934217) │
└───────────────────────────────────────────┘
```
