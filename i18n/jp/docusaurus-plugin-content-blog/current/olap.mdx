---
title: OLAP とは？
description: "OLAP は Online Analytical Processing（オンライン分析処理）の略です。技術面とビジネス面という 2 つの観点から捉えられる包括的な概念です。"
date: 2021-09-01
tags: ['Concepts']
keywords: ['OLAP']
---

{frontMatter.description}

{/* 切り捨て */}

## OLAP \{#olap\}

[OLAP](https://en.wikipedia.org/wiki/Online_analytical_processing) は Online Analytical Processing（オンライン分析処理）の略です。技術的な観点とビジネス的な観点という 2 つの側面から捉えられる幅広い概念です。

しかし、ごく大まかには、これらの語を後ろから読んで理解することができます。

Processing
:   何らかのソースデータが処理され…

Analytical
:   …分析レポートやインサイトが得られ…

Online
:   …これをリアルタイムに行います。

## ビジネスの観点から見た OLAP \{#olap-from-the-business-perspective\}

近年、ビジネスに携わる人々はデータの価値を認識し始めています。データに基づかずに手探りで意思決定を行う企業は、多くの場合、競争についていけません。成功している企業のデータドリブンなアプローチにより、ビジネス判断に少しでも役立つ可能性のあるあらゆるデータを収集し、それらをタイムリーに分析するための仕組みが求められるようになりました。ここで役に立つのが、OLAP データベース管理システム (DBMS) です。

ビジネスの観点では、OLAP によって企業は業務活動を継続的に計画・分析・レポーティングでき、その結果として効率を最大化し、コストを削減し、最終的には市場シェアを獲得できます。これは自社運用のシステムで実現することも、Web/モバイル分析サービスや CRM サービスなどの SaaS プロバイダーにアウトソースすることも可能です。OLAP は多くの BI (Business Intelligence) アプリケーションを支える技術です。

ClickHouse は OLAP データベース管理システムであり、ドメイン固有データを分析するためのこれらの SaaS ソリューションのバックエンドとしてよく利用されています。しかし、一部の企業は依然として自社データをサードパーティプロバイダーと共有することに消極的であり、社内データウェアハウスというシナリオも現実的な選択肢です。

## 技術的な観点から見た OLAP \{#olap-from-the-technical-perspective\}

すべてのデータベース管理システムは、大きく二つのグループに分類できます。OLAP (Online **Analytical** Processing) と OLTP (Online **Transactional** Processing) です。前者は、膨大な履歴データに基づくレポートを作成することに重点を置きますが、その実行頻度はそれほど高くありません。一方、後者は連続的に流れてくるトランザクションを扱い、データの現在の状態を絶えず更新します。

実際には、OLAP と OLTP は明確なカテゴリというよりも連続体に近い概念です。ほとんどの実システムは通常どちらか一方に重点を置きつつ、反対側のワークロードも必要な場合には、何らかのソリューションやワークアラウンドを提供します。このことは、多くの場合、複数のストレージシステムを連携させて運用せざるを得ない状況を生み出します。これはそれほど大きな問題ではないかもしれませんが、システムが増えるほど運用コストは高くなります。そのため近年のトレンドは、単一のデータベース管理システムで両方の種類のワークロードを同等にうまく処理する HTAP (**Hybrid Transactional/Analytical Processing**) です。

DBMS が純粋な OLAP あるいは純粋な OLTP としてスタートしたとしても、競争に追随するためには HTAP の方向へ進まざるを得ません。ClickHouse も例外ではなく、当初は [可能な限り高速な OLAP システム](https://clickhouse.com/docs/faq/general/why-clickhouse-is-so-fast) として設計され、今なおフル機能のトランザクションサポートは備えていませんが、一貫した読み書きや、データの更新・削除を行うためのミューテーションといった機能は追加されてきました。

OLAP システムと OLTP システムの間にある本質的なトレードオフは依然として存在します。

* 分析レポートを効率良く構築するためには、カラムを個別に読み出せることが極めて重要であり、そのためほとんどの OLAP データベースは[カラム型（カラムナ）](https://clickhouse.com/docs/faq/general/columnar-database)です。
* 一方で、カラムを分離して格納すると、行に対する追加やインプレース更新といった操作のコストが、カラム数に比例して増加します（イベントのあらゆる詳細を「念のため」収集しようとすると、カラム数は非常に多くなり得ます）。そのため、ほとんどの OLTP システムは、データを行指向で格納します。