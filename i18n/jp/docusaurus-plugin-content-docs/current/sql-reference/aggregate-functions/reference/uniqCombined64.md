---
description: '異なる引数値のおおよその個数を計算します。`uniqCombined` と同様ですが、String 型だけでなく、すべてのデータ型に対して 64 ビットハッシュを使用します。'
slug: /sql-reference/aggregate-functions/reference/uniqcombined64
title: 'uniqCombined64'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## uniqCombined64 \{#uniqCombined64\}

導入バージョン: v20.1

引数の異なる値の概算個数を計算します。
[`uniqCombined`](https://clickhouse.com/docs/sql-reference/aggregate-functions/reference/uniqcombined) と同じですが、String 型だけでなくすべてのデータ型に対して 64 ビットハッシュを使用します。

この関数は決定的に結果を返します（クエリ処理順序には依存しません）。

:::note
すべての型に対して 64 ビットハッシュを使用するため、非 String 型に対して 32 ビットハッシュを使用する [`uniqCombined`](https://clickhouse.com/docs/sql-reference/aggregate-functions/reference/uniqcombined) のように、`UINT_MAX` を大きく超えるカーディナリティに対して非常に大きな誤差が発生することはありません。
:::

[uniq](https://clickhouse.com/docs/sql-reference/aggregate-functions/reference/uniq) 関数と比較して、uniqCombined64 関数は次の特徴があります。

* メモリ消費量が数倍少ない
* 計算精度が数倍高い

<details>
  <summary>実装の詳細</summary>
  この関数は、集約のすべてのパラメータに対して 64 ビットハッシュを計算し、それを用いて計算を行います。
  アルゴリズムとして、配列・ハッシュテーブル・誤差補正テーブル付きの [HyperLogLog](https://en.wikipedia.org/wiki/HyperLogLog) の 3 つを組み合わせて使用します。

  * 相異なる要素数が少ない場合は、配列を使用します
  * 集合のサイズが大きくなると、ハッシュテーブルを使用します
  * さらに要素数が増えると、固定量のメモリで動作する HyperLogLog を使用します
</details>

**構文**

```sql
uniqCombined64(HLL_precision)(x[, ...])
uniqCombined64(x[, ...])
```

**パラメーター**

* `HLL_precision` — 省略可能です。HyperLogLog におけるセル数の 2 を底とする対数値です。デフォルト値は 17 で、実質的に 96 KiB の領域を使用します（2^17 個のセル、各 6 ビット）。範囲：[12, 20]。[`UInt8`](/sql-reference/data-types/int-uint)

**引数**

* `x` — 可変個のパラメーター。[`Tuple(T)`](/sql-reference/data-types/tuple) または [`Array(T)`](/sql-reference/data-types/array) または [`Date`](/sql-reference/data-types/date) または [`DateTime`](/sql-reference/data-types/datetime) または [`String`](/sql-reference/data-types/string) または [`(U)Int*`](/sql-reference/data-types/int-uint) または [`Float*`](/sql-reference/data-types/float) または [`Decimal`](/sql-reference/data-types/decimal)

**戻り値**

引数の異なる値の概数を表す `UInt64` 型の数値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**大規模データセットの例**

```sql title=Query
SELECT uniqCombined64(number) FROM numbers(1e10);
```

```response title=Response
┌─uniqCombined64(number)─┐
│             9998568925 │
└────────────────────────┘
```

**uniqCombinedとの比較**

```sql title=Query
-- uniqCombined64 with large dataset
SELECT uniqCombined64(number) FROM numbers(1e10);

-- uniqCombined with same dataset shows poor approximation
SELECT uniqCombined(number) FROM numbers(1e10);
```

```response title=Response
┌─uniqCombined64(number)─┐
│             9998568925 │ -- 10.00 billion
└────────────────────────┘
┌─uniqCombined(number)─┐
│           5545308725 │ -- 5.55 billion
└──────────────────────┘
```

{/*AUTOGENERATED_END*/ }

**関連項目**

* [uniq](/sql-reference/aggregate-functions/reference/uniq)
* [uniqCombined](/sql-reference/aggregate-functions/reference/uniqcombined)
* [uniqHLL12](/sql-reference/aggregate-functions/reference/uniqhll12)
* [uniqExact](/sql-reference/aggregate-functions/reference/uniqexact)
* [uniqTheta](/sql-reference/aggregate-functions/reference/uniqthetasketch)
