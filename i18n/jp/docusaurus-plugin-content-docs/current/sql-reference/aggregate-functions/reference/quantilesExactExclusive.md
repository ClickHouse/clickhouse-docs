---
description: '数値データ系列の分位数を正確に計算します。'
slug: /sql-reference/aggregate-functions/reference/quantilesExactExclusive
title: 'quantilesExactExclusive'
doc_type: 'reference'
---

## quantilesExactExclusive \{#quantilesexactexclusive\}

数値データ列の[分位数](https://en.wikipedia.org/wiki/Quantile)を厳密に計算します。

厳密な値を得るために、渡されたすべての値をいったん配列にまとめ、その配列を部分的にソートします。そのため、この関数は `O(n)` のメモリを消費し、ここで `n` は渡された値の個数です。ただし、値の数が少ない場合には、この関数は非常に効率的です。

この関数は、Excel の [PERCENTILE.EXC](https://support.microsoft.com/en-us/office/percentile-exc-function-bbaa7204-e9e1-4010-85bf-c31dc5dce4ba) 関数（[型 R6](https://en.wikipedia.org/wiki/Quantile#Estimating_quantiles_from_a_sample)）と等価です。

[quantileExactExclusive](../../../sql-reference/aggregate-functions/reference/quantileExactExclusive.md) よりも、複数の分位レベルを同時に扱う場合に効率的に動作します。

**構文**

```sql
quantilesExactExclusive(level1, level2, ...)(expr)
```

**引数**

* `expr` — 数値型の[データ型](/sql-reference/data-types)、[Date](../../../sql-reference/data-types/date.md) または [DateTime](../../../sql-reference/data-types/datetime.md) を返すカラム値に対する式。

**パラメータ**

* `level` — 分位数のレベル。取り得る値: (0, 1)（両端は含まない）。[Float](../../../sql-reference/data-types/float.md)。

**戻り値**

* 指定されたレベルの分位数の[Array](../../../sql-reference/data-types/array.md)。

配列要素の型:

* 入力が数値データ型の場合は [Float64](../../../sql-reference/data-types/float.md)。
* 入力値が `Date` 型の場合は [Date](../../../sql-reference/data-types/date.md)。
* 入力値が `DateTime` 型の場合は [DateTime](../../../sql-reference/data-types/datetime.md)。

**例**

クエリ:

```sql
CREATE TABLE num AS numbers(1000);

SELECT quantilesExactExclusive(0.25, 0.5, 0.75, 0.9, 0.95, 0.99, 0.999)(x) FROM (SELECT number AS x FROM num);
```

結果：

```text
┌─quantilesExactExclusive(0.25, 0.5, 0.75, 0.9, 0.95, 0.99, 0.999)(x)─┐
│ [249.25,499.5,749.75,899.9,949.9499999999999,989.99,998.999]        │
└─────────────────────────────────────────────────────────────────────┘
```

{/*AUTOGENERATED_START*/ }

{/*AUTOGENERATED_END*/ }
