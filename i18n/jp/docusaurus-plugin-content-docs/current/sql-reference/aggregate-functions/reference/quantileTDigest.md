---
description: 't-digest アルゴリズムを使用して、数値データ系列の近似分位数を計算します。'
slug: /sql-reference/aggregate-functions/reference/quantiletdigest
title: 'quantileTDigest'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## quantileTDigest \{#quantileTDigest\}

導入バージョン: v1.1

数値データシーケンスに対して、[分位数](https://en.wikipedia.org/wiki/Quantile)を [t-digest](https://github.com/tdunning/t-digest/blob/master/docs/t-digest-paper/histo.pdf) アルゴリズムを用いて近似的に計算します。

メモリ使用量は `log(n)` で、ここで `n` は値の個数です。結果はクエリの実行順序に依存し、非決定的です。

この関数のパフォーマンスは、[`quantile`](/sql-reference/aggregate-functions/reference/quantile) や [`quantileTiming`](/sql-reference/aggregate-functions/reference/quantiletiming) のパフォーマンスよりも劣ります。ただし、State サイズと精度の比率という観点では、この関数は `quantile` よりもはるかに優れています。

1 つのクエリ内で異なるレベルの複数の `quantile*` 関数を使用する場合、内部 State は結合されません（つまり、そのクエリは本来よりも効率が悪くなります）。このような場合は、[`quantiles`](/sql-reference/aggregate-functions/reference/quantiles#quantiles) 関数を使用してください。

**構文**

```sql
quantileTDigest(level)(expr)
```

**別名**: `medianTDigest`

**パラメータ**

* `level` — 省略可能。分位数のレベル。0 から 1 までの定数の浮動小数点数。`level` の値には `[0.01, 0.99]` の範囲を使用することを推奨します。デフォルト値: 0.5。`level=0.5` の場合、この関数は中央値を計算します。[`Float*`](/sql-reference/data-types/float)

**引数**

* `expr` — 数値データ型、Date または DateTime を返すカラム値に対する式。[`(U)Int*`](/sql-reference/data-types/int-uint) または [`Float*`](/sql-reference/data-types/float) または [`Decimal*`](/sql-reference/data-types/decimal) または [`Date`](/sql-reference/data-types/date) または [`DateTime`](/sql-reference/data-types/datetime)

**戻り値**

指定されたレベルにおける近似分位数。[`Float64`](/sql-reference/data-types/float) または [`Date`](/sql-reference/data-types/date) または [`DateTime`](/sql-reference/data-types/datetime)

**例**

**t-digest を用いた分位数の計算**

```sql title=Query
SELECT quantileTDigest(number) FROM numbers(10);
```

```response title=Response
┌─quantileTDigest(number)─┐
│                     4.5 │
└─────────────────────────┘
```

{/*AUTOGENERATED_END*/ }

**関連項目**

* [median](/sql-reference/aggregate-functions/reference/median)
* [quantiles](/sql-reference/aggregate-functions/reference/quantiles)
