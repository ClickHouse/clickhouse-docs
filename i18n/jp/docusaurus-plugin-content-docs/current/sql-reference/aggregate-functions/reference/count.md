---
description: '行数または NULL 以外の値の数をカウントします。'
slug: /sql-reference/aggregate-functions/reference/count
title: 'count'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## count \{#count\}

導入バージョン: v1.1

行数、または NULL 以外の値の数を数えます。

ClickHouse は `count` に対して次の構文をサポートします:

* `count(expr)` または `COUNT(DISTINCT expr)`。
* `count()` または `COUNT(*)`。`count()` 構文は ClickHouse 固有です。

**詳細**

ClickHouse は `COUNT(DISTINCT ...)` 構文をサポートします。
この構文の動作は [`count_distinct_implementation`](../../../operations/settings/settings.md#count_distinct_implementation) 設定に依存します。
この設定は、演算を実行する際にどの [uniq*](/sql-reference/aggregate-functions/reference/uniq) 関数を使用するかを定義します。
デフォルトでは [uniqExact](/sql-reference/aggregate-functions/reference/uniqexact) 関数が使用されます。

`SELECT count() FROM table` クエリは、デフォルトで MergeTree のメタデータを使って最適化されます。
行レベルセキュリティを使用する必要がある場合は、[`optimize_trivial_count_query`](/operations/settings/settings#optimize_trivial_count_query) 設定を使ってこの最適化を無効化します。

一方で、`SELECT count(nullable_column) FROM table` クエリは、[`optimize_functions_to_subcolumns`](/operations/settings/settings#optimize_functions_to_subcolumns) 設定を有効にすることで最適化できます。
`optimize_functions_to_subcolumns = 1` の場合、この関数はカラム全体のデータを読み取って処理する代わりに、[`null`](../../../sql-reference/data-types/nullable.md#finding-null) サブカラムだけを読み取ります。
クエリ `SELECT count(n) FROM table` は `SELECT sum(NOT n.null) FROM table` に変換されます。

:::tip COUNT(DISTINCT expr) のパフォーマンス向上
`COUNT(DISTINCT expr)` クエリが遅い場合は、並列化が改善されるため [`GROUP BY`](/sql-reference/statements/select/group-by) 句を追加することを検討してください。
また、`COUNT(DISTINCT target_col)` に使用される対象カラムに索引を作成するために、[projection](../../../sql-reference/statements/alter/projection.md) を使用することもできます。
:::

**構文**

```sql
count([expr])
```

**引数**

* `expr` — 省略可能。式です。この関数は、この式が null ではない値を返した回数をカウントします。[`Expression`](/sql-reference/data-types/special-data-types/expression)

**戻り値**

引数なしで呼び出された場合は行数を返し、引数が渡された場合は、渡された式が null ではない値を返した回数を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**基本的な行数のカウント**

```sql title=Query
SELECT count() FROM t
```

```response title=Response
┌─count()─┐
│       5 │
└─────────┘
```

**COUNT(DISTINCT) の使用例**

```sql title=Query
-- This example shows that `count(DISTINCT num)` is performed by the `uniqExact` function according to the `count_distinct_implementation` setting value.
SELECT name, value FROM system.settings WHERE name = 'count_distinct_implementation';
SELECT count(DISTINCT num) FROM t
```

```response title=Response
┌─name──────────────────────────┬─value─────┐
│ count_distinct_implementation │ uniqExact │
└───────────────────────────────┴───────────┘
┌─uniqExact(num)─┐
│              3 │
└────────────────┘
```

{/*AUTOGENERATED_END*/ }
