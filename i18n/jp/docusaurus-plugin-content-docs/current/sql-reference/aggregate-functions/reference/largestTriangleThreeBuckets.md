---
description: '入力データに対して Largest-Triangle-Three-Buckets アルゴリズムを適用します。'
sidebar_label: 'largestTriangleThreeBuckets'
slug: /sql-reference/aggregate-functions/reference/largestTriangleThreeBuckets
title: 'largestTriangleThreeBuckets'
doc_type: 'reference'
---

# largestTriangleThreeBuckets \{#largesttrianglethreebuckets\}

入力データに対して [Largest-Triangle-Three-Buckets](https://skemman.is/bitstream/1946/15343/3/SS_MSthesis.pdf) アルゴリズムを適用します。
このアルゴリズムは、可視化のために時系列データをダウンサンプリングする際に使用されます。x 座標でソートされた系列を前提として設計されています。
ソート済み系列を複数のバケットに分割し、各バケット内で最大の三角形を見つけることで動作します。バケット数は、ダウンサンプリング後の系列に含まれる点の数と同じです。
この関数は、まずデータを `x` でソートし、その後ソート済みデータに対してダウンサンプリングアルゴリズムを適用します。

**構文**

```sql
largestTriangleThreeBuckets(n)(x, y)
```

エイリアス: `lttb`.

**引数**

* `x` — x 座標。[Integer](../../../sql-reference/data-types/int-uint.md)、[Float](../../../sql-reference/data-types/float.md)、[Decimal](../../../sql-reference/data-types/decimal.md)、[Date](../../../sql-reference/data-types/date.md)、[Date32](../../../sql-reference/data-types/date32.md)、[DateTime](../../../sql-reference/data-types/datetime.md)、[DateTime64](../../../sql-reference/data-types/datetime64.md)。
* `y` — y 座標。[Integer](../../../sql-reference/data-types/int-uint.md)、[Float](../../../sql-reference/data-types/float.md)、[Decimal](../../../sql-reference/data-types/decimal.md)、[Date](../../../sql-reference/data-types/date.md)、[Date32](../../../sql-reference/data-types/date32.md)、[DateTime](../../../sql-reference/data-types/datetime.md)、[DateTime64](../../../sql-reference/data-types/datetime64.md)。

与えられた系列中の NaN は無視され、これらの NaN 値は分析から除外されます。これにより、この関数は有効な数値データのみに対して動作します。

**パラメータ**

* `n` — 結果の系列に含まれる点の数。[UInt64](../../../sql-reference/data-types/int-uint.md)。

**返される値**

2 要素を持つ [Tuple](../../../sql-reference/data-types/tuple.md) の [Array](../../../sql-reference/data-types/array.md):

**例**

入力テーブル:

```text
┌─────x───────┬───────y──────┐
│ 1.000000000 │ 10.000000000 │
│ 2.000000000 │ 20.000000000 │
│ 3.000000000 │ 15.000000000 │
│ 8.000000000 │ 60.000000000 │
│ 9.000000000 │ 55.000000000 │
│ 10.00000000 │ 70.000000000 │
│ 4.000000000 │ 30.000000000 │
│ 5.000000000 │ 40.000000000 │
│ 6.000000000 │ 35.000000000 │
│ 7.000000000 │ 50.000000000 │
└─────────────┴──────────────┘
```

クエリ：

```sql
SELECT largestTriangleThreeBuckets(4)(x, y) FROM largestTriangleThreeBuckets_test;
```

結果:

```text
┌────────largestTriangleThreeBuckets(4)(x, y)───────────┐
│           [(1,10),(3,15),(9,55),(10,70)]              │
└───────────────────────────────────────────────────────┘
```

{/*AUTOGENERATED_START*/ }

{/*AUTOGENERATED_END*/ }
