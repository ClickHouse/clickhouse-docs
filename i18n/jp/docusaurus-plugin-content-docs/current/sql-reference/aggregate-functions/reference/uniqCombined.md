---
description: '異なる引数値の概数を計算します。'
slug: /sql-reference/aggregate-functions/reference/uniqcombined
title: 'uniqCombined'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## uniqCombined \{#uniqCombined\}

導入バージョン: v1.1

異なる引数値のおおよその個数を計算します。
結果は決定論的であり（クエリ処理順序に依存せず）、常に同じになります。

:::note
非 String 型に対して 32 ビットハッシュを使用するため、`UINT_MAX` を大きく超えるカーディナリティに対しては結果の誤差が非常に大きくなります（数百億程度の異なる値を超えたあたりから急激に誤差が増加します）。
カーディナリティが `UINT_MAX` より大きい場合は、代わりに [`uniqCombined64`](https://clickhouse.com/docs/sql-reference/aggregate-functions/reference/uniqcombined64) を使用する必要があります。
:::

`uniq` 関数と比較して、`uniqCombined` 関数は次の特徴があります:

* 消費するメモリ量が数倍少ない
* 計算精度が数倍高い
* 通常はパフォーマンスがわずかに低下します。ある種のシナリオでは、例えば多くの集約状態をネットワーク経由で送信する分散クエリでは、`uniqCombined` が `uniq` より高速に動作する場合もあります

<details>
  <summary>Implementation details</summary>
  この関数は、集約内のすべてのパラメータに対してハッシュ（String 型には 64 ビットハッシュ、それ以外には 32 ビットハッシュ）を計算し、そのハッシュ値を用いて計算を行います。
  配列、ハッシュテーブル、HyperLogLog と誤差補正テーブルの 3 つのアルゴリズムを組み合わせて使用します:

  * 異なる要素数が少ない場合は配列を使用します
  * 集合のサイズがより大きくなるとハッシュテーブルを使用します
  * さらに要素数が多い場合は HyperLogLog を使用し、これは一定量のメモリのみを消費します
</details>

**構文**

```sql
uniqCombined(HLL_precision)(x[, ...])
uniqCombined(x[, ...])
```

**パラメータ**

* `HLL_precision` — 省略可能。HyperLogLog のセル数の底 2 の対数。デフォルト値は 17 で、これは実質的に 96 KiB の領域（2^17 個のセル、各 6 ビット）に相当します。範囲: [12, 20]。[`UInt8`](/sql-reference/data-types/int-uint)

**引数**

* `x` — 可変個のパラメータ。[`Tuple(T)`](/sql-reference/data-types/tuple) または [`Array(T)`](/sql-reference/data-types/array) または [`Date`](/sql-reference/data-types/date) または [`DateTime`](/sql-reference/data-types/datetime) または [`String`](/sql-reference/data-types/string) または [`(U)Int*`](/sql-reference/data-types/int-uint) または [`Float*`](/sql-reference/data-types/float) または [`Decimal`](/sql-reference/data-types/decimal)

**返される値**

異なる引数値のおおよその個数を表す UInt64 型の数値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**基本的な使い方**

```sql title=Query
SELECT uniqCombined(number) FROM numbers(1e6);
```

```response title=Response
┌─uniqCombined(number)─┐
│              1001148 │
└──────────────────────┘
```

**カスタム精度を使用する場合**

```sql title=Query
SELECT uniqCombined(15)(number) FROM numbers(1e5);
```

```response title=Response
┌─uniqCombined(15)(number)─┐
│                   100768 │
└──────────────────────────┘
```

{/*AUTOGENERATED_END*/ }

**関連項目**

* [uniq](/sql-reference/aggregate-functions/reference/uniq)
* [uniqCombined64](/sql-reference/aggregate-functions/reference/uniqcombined64)
* [uniqHLL12](/sql-reference/aggregate-functions/reference/uniqhll12)
* [uniqExact](/sql-reference/aggregate-functions/reference/uniqexact)
* [uniqTheta](/sql-reference/aggregate-functions/reference/uniqthetasketch)
