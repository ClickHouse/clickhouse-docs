---
description: '数値データ系列の分位数を厳密に計算します。'
slug: /sql-reference/aggregate-functions/reference/quantileExactExclusive
title: 'quantileExactExclusive'
doc_type: 'reference'
---

# quantileExactExclusive \{#quantileexactexclusive\}

数値データ系列の[分位数](https://en.wikipedia.org/wiki/Quantile)を厳密に計算します。

厳密な値を取得するために、渡されたすべての値は 1 つの配列にまとめられ、その後部分的にソートされます。したがって、この関数は `O(n)` のメモリを消費し、ここで `n` は渡された値の個数です。ただし、値の数が少ない場合には、この関数は非常に効率的です。

この関数は、[PERCENTILE.EXC](https://support.microsoft.com/en-us/office/percentile-exc-function-bbaa7204-e9e1-4010-85bf-c31dc5dce4ba) の Excel 関数（[type R6](https://en.wikipedia.org/wiki/Quantile#Estimating_quantiles_from_a_sample)）と同等です。

1 つのクエリ内で異なるレベルを指定した複数の `quantileExactExclusive` 関数を使用する場合、内部状態は結合されません（つまり、そのクエリは本来よりも非効率に動作します）。この場合は、[quantilesExactExclusive](../../../sql-reference/aggregate-functions/reference/quantilesExactExclusive.md) 関数を使用してください。

**構文**

```sql
quantileExactExclusive(level)(expr)
```

**引数**

* `expr` — 数値の[データ型](/sql-reference/data-types)、[Date](../../../sql-reference/data-types/date.md) または [DateTime](../../../sql-reference/data-types/datetime.md) を結果とするカラム値に対する式。

**パラメーター**

* `level` — 分位点のレベル。省略可能。取りうる値は (0, 1) の範囲（端点は含まれません）。デフォルト値は 0.5。`level=0.5` の場合、この関数は[中央値](https://en.wikipedia.org/wiki/Median)を計算します。[Float](../../../sql-reference/data-types/float.md)。

**返り値**

* 指定されたレベルの分位点。

型:

* 数値データ型の入力に対しては [Float64](../../../sql-reference/data-types/float.md)。
* 入力値が `Date` 型の場合は [Date](../../../sql-reference/data-types/date.md)。
* 入力値が `DateTime` 型の場合は [DateTime](../../../sql-reference/data-types/datetime.md)。

**例**

クエリ:

```sql
CREATE TABLE num AS numbers(1000);

SELECT quantileExactExclusive(0.6)(x) FROM (SELECT number AS x FROM num);
```

結果：

```text
┌─quantileExactExclusive(0.6)(x)─┐
│                          599.6 │
└────────────────────────────────┘
```

{/*AUTOGENERATED_START*/ }

{/*AUTOGENERATED_END*/ }
