---
description: '線形補間によりヒストグラムの分位数を計算します。'
slug: /sql-reference/aggregate-functions/reference/quantilePrometheusHistogram
title: 'quantilePrometheusHistogram'
doc_type: 'reference'
---

{/*AUTOGENERATED_START*/ }

## quantilePrometheusHistogram \{#quantilePrometheusHistogram\}

導入バージョン: v25.10

線形補間を用いてヒストグラムの[分位数](https://en.wikipedia.org/wiki/Quantile)を計算します。各ヒストグラムバケットの累積値と上限値を考慮します。

補間された値を得るために、入力されたすべての値を配列にまとめ、その配列を対応するバケットの上限値でソートします。
その後、通常のヒストグラムに対する PromQL の [histogram&#95;quantile()](https://prometheus.io/docs/prometheus/latest/querying/functions/#histogram_quantile) 関数と同様に分位数の補間を行い、分位点が位置するバケットの下限値と上限値を用いて線形補間を実施します。

**関連項目**

* [median](/sql-reference/aggregate-functions/reference/median)
* [quantiles](../../../sql-reference/aggregate-functions/reference/quantiles.md)

**構文**

```sql
quantilePrometheusHistogram(level)(bucket_upper_bound, cumulative_bucket_value)
```

**パラメータ**

* `level` — 省略可能。分位数のレベル。0 から 1 の範囲の定数の浮動小数点数。`level` の値として `[0.01, 0.99]` の範囲を使用することを推奨します。デフォルト値: `0.5`。`level=0.5` の場合、この関数は [median](https://en.wikipedia.org/wiki/Median) を計算します。[`Float64`](/sql-reference/data-types/float)

**引数**

* `bucket_upper_bound` — ヒストグラムバケットの上限。最も大きいバケットは上限として `+Inf` を持たなければなりません。[`Float64`](/sql-reference/data-types/float)
* `cumulative_bucket_value` — ヒストグラムバケットの累積値。バケットの上限が大きくなるにつれて、値は単調増加していなければなりません。[`(U)Int*`](/sql-reference/data-types/int-uint) または [`Float64`](/sql-reference/data-types/float)

**返される値**

指定されたレベルの分位数を返します。[`Float64`](/sql-reference/data-types/float)

**例**

**使用例**

```sql title=Query
SELECT quantilePrometheusHistogram(bucket_upper_bound, cumulative_bucket_value)
FROM VALUES('bucket_upper_bound Float64, cumulative_bucket_value UInt64', (0, 6), (0.5, 11), (1, 14), (inf, 19));
```

```response title=Response
┌─quantilePrometheusHistogram(bucket_upper_bound, cumulative_bucket_value)─┐
│                                                                     0.35 │
└──────────────────────────────────────────────────────────────────────────┘
```

{/*AUTOGENERATED_END*/ }

**関連項目**

* [median](/sql-reference/aggregate-functions/reference/median)
* [quantiles](../../../sql-reference/aggregate-functions/reference/quantiles.md)
