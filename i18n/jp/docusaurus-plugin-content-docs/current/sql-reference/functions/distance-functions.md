---
description: '距離関数のドキュメント'
sidebar_label: '距離'
slug: /sql-reference/functions/distance-functions
title: '距離関数'
keywords: ['距離関数', 'ノルム', '距離', 'ベクトル']
doc_type: 'reference'
---



# 距離関数

<!--
The inner content of the tags below are replaced at doc framework build time with
docs generated from system.functions. Please do not modify or remove the tags.
See: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
-->


<!--AUTOGENERATED_START-->

## L1Distance {#L1Distance}

導入バージョン: v21.11

`L1`空間(1-ノルム([タクシー幾何学](https://en.wikipedia.org/wiki/Taxicab_geometry)距離))における2点間の距離を計算します(ベクトルの要素が座標となります)。

**構文**

```sql
L1Distance(vector1, vector2)
```

**エイリアス**: `distanceL1`

**引数**

- `vector1` — 第1ベクトル。[`Tuple(T)`](/sql-reference/data-types/tuple)または[`Array(T)`](/sql-reference/data-types/array)
- `vector2` — 第2ベクトル。[`Tuple(T)`](/sql-reference/data-types/tuple)または[`Array(T)`](/sql-reference/data-types/array)

**戻り値**

1-ノルム距離を返します。[`UInt32`](/sql-reference/data-types/int-uint)または[`Float64`](/sql-reference/data-types/float)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT L1Distance((1, 2), (2, 3))
```

```response title=レスポンス
┌─L1Distance((1, 2), (2, 3))─┐
│                          2 │
└────────────────────────────┘
```


## L1Norm {#L1Norm}

導入バージョン: v21.11

ベクトルの各要素の絶対値の合計を計算します。

**構文**

```sql
L1Norm(vector)
```

**エイリアス**: `normL1`

**引数**

- `vector` — 数値のベクトルまたはタプル。[`Array(T)`](/sql-reference/data-types/array) または [`Tuple(T)`](/sql-reference/data-types/tuple)

**戻り値**

L1ノルムまたは[マンハッタン距離](https://en.wikipedia.org/wiki/Taxicab_geometry)を返します。[`UInt*`](/sql-reference/data-types/int-uint) または [`Float*`](/sql-reference/data-types/float) または [`Decimal`](/sql-reference/data-types/decimal)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT L1Norm((1, 2))
```

```response title=レスポンス
┌─L1Norm((1, 2))─┐
│              3 │
└────────────────┘
```


## L1Normalize {#L1Normalize}

導入バージョン: v21.11

与えられたベクトル(タプルの要素が座標)の`L1`空間([タクシー幾何学](https://en.wikipedia.org/wiki/Taxicab_geometry))における単位ベクトルを計算します。

**構文**

```sql
L1Normalize(tuple)
```

**エイリアス**: `normalizeL1`

**引数**

- `tuple` — 数値のタプル。[`Tuple(T)`](/sql-reference/data-types/tuple)

**戻り値**

単位ベクトルを返します。[`Tuple(Float64)`](/sql-reference/data-types/tuple)

**例**

**基本的な使用例**

```sql title=Query
SELECT L1Normalize((1, 2))
```

```response title=Response
┌─L1Normalize((1, 2))─────────────────────┐
│ (0.3333333333333333,0.6666666666666666) │
└─────────────────────────────────────────┘
```


## L2Distance {#L2Distance}

導入バージョン: v21.11

ユークリッド空間における2点間の距離([ユークリッド距離](https://en.wikipedia.org/wiki/Euclidean_distance))を計算します(ベクトルの要素が座標を表します)。

**構文**

```sql
L2Distance(vector1, vector2)
```

**エイリアス**: `distanceL2`

**引数**

- `vector1` — 第1ベクトル。[`Tuple(T)`](/sql-reference/data-types/tuple)または[`Array(T)`](/sql-reference/data-types/array)
- `vector2` — 第2ベクトル。[`Tuple(T)`](/sql-reference/data-types/tuple)または[`Array(T)`](/sql-reference/data-types/array)

**戻り値**

2ノルム距離を返します。[`Float64`](/sql-reference/data-types/float)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT L2Distance((1, 2), (2, 3))
```

```response title=レスポンス
┌─L2Distance((1, 2), (2, 3))─┐
│         1.4142135623730951 │
└────────────────────────────┘
```


## L2DistanceTransposed {#L2DistanceTransposed}

導入バージョン: v25.10

ユークリッド空間における2点間の近似距離を計算します（ベクトルの値が座標となります）（[ユークリッド距離](https://en.wikipedia.org/wiki/Euclidean_distance)）。

**構文**

```sql
L2DistanceTransposed(vector1, vector2, p)
```

**エイリアス**: `distanceL2Transposed`

**引数**

- `vectors` — ベクトル。[`QBit(T, UInt64)`](/sql-reference/data-types/qbit)
- `reference` — 参照ベクトル。[`Array(T)`](/sql-reference/data-types/array)
- `p` — 距離計算に使用する各ベクトル要素のビット数（1から要素のビット幅まで）。量子化レベルは精度と速度のトレードオフを制御します。ビット数を少なくすると、I/Oと計算が高速化されますが精度が低下し、ビット数を多くすると精度が向上しますがパフォーマンスが犠牲になります。[`UInt`](/sql-reference/data-types/int-uint)

**戻り値**

近似2ノルム距離を返します。[`Float64`](/sql-reference/data-types/float)

**例**

**基本的な使用方法**

```sql title=クエリ
CREATE TABLE qbit (id UInt32, vec QBit(Float64, 2)) ENGINE = Memory;
INSERT INTO qbit VALUES (1, [0, 1]);
SELECT L2DistanceTransposed(vec, array(1.0, 2.0), 16) FROM qbit;"
```

```response title=レスポンス
┌─L2DistanceTransposed([0, 1], [1.0, 2.0], 16)─┐
│                           1.4142135623730951 │
└──────────────────────────────────────────────┘
```


## L2Norm {#L2Norm}

導入バージョン: v21.11

ベクトル要素の二乗和の平方根を計算します。

**構文**

```sql
L2Norm(vector)
```

**エイリアス**: `normL2`

**引数**

- `vector` — 数値のベクトルまたはタプル。[`Tuple(T)`](/sql-reference/data-types/tuple)または[`Array(T)`](/sql-reference/data-types/array)

**戻り値**

L2ノルムまたは[ユークリッド距離](https://en.wikipedia.org/wiki/Euclidean_distance)を返します。[`UInt*`](/sql-reference/data-types/int-uint)または[`Float*`](/sql-reference/data-types/float)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT L2Norm((1, 2))
```

```response title=レスポンス
┌───L2Norm((1, 2))─┐
│ 2.23606797749979 │
└──────────────────┘
```


## L2Normalize {#L2Normalize}

導入バージョン: v21.11

ユークリッド空間において、与えられたベクトル（タプルの要素が座標）の単位ベクトルを計算します（[ユークリッド距離](https://en.wikipedia.org/wiki/Euclidean_distance)を使用）。

**構文**

```sql
L2Normalize(tuple)
```

**エイリアス**: `normalizeL2`

**引数**

- `tuple` — 数値のタプル。[`Tuple(T)`](/sql-reference/data-types/tuple)

**戻り値**

単位ベクトルを返します。[`Tuple(Float64)`](/sql-reference/data-types/tuple)

**例**

**基本的な使用例**

```sql title=Query
SELECT L2Normalize((3, 4))
```

```response title=Response
┌─L2Normalize((3, 4))─┐
│ (0.6,0.8)           │
└─────────────────────┘
```


## L2SquaredDistance {#L2SquaredDistance}

導入バージョン: v22.7

2つのベクトルの対応する要素間の差の二乗和を計算します。

**構文**

```sql
L2SquaredDistance(vector1, vector2)
```

**エイリアス**: `distanceL2Squared`

**引数**

- `vector1` — 第1ベクトル。[`Tuple(T)`](/sql-reference/data-types/tuple) または [`Array(T)`](/sql-reference/data-types/array)
- `vector2` — 第2ベクトル。[`Tuple(T)`](/sql-reference/data-types/tuple) または [`Array(T)`](/sql-reference/data-types/array)

**戻り値**

2つのベクトルの対応する要素間の差の二乗和を返します。[`Float64`](/sql-reference/data-types/float)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT L2SquaredDistance([1, 2, 3], [0, 0, 0])
```

```response title=レスポンス
┌─L2SquaredDis⋯ [0, 0, 0])─┐
│                       14 │
└──────────────────────────┘
```


## L2SquaredNorm {#L2SquaredNorm}

導入バージョン: v22.7

ベクトル要素の二乗和の平方根([`L2Norm`](#L2Norm))を二乗した値を計算します。

**構文**

```sql
L2SquaredNorm(vector)
```

**エイリアス**: `normL2Squared`

**引数**

- `vector` — 数値のベクトルまたはタプル。[`Array(T)`](/sql-reference/data-types/array) または [`Tuple(T)`](/sql-reference/data-types/tuple)

**戻り値**

L2ノルムの二乗を返します。[`UInt*`](/sql-reference/data-types/int-uint) または [`Float*`](/sql-reference/data-types/float) または [`Decimal`](/sql-reference/data-types/decimal)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT L2SquaredNorm((1, 2))
```

```response title=レスポンス
┌─L2SquaredNorm((1, 2))─┐
│                     5 │
└───────────────────────┘
```


## LinfDistance {#LinfDistance}

導入バージョン: v21.11

`L_{inf}` 空間([最大ノルム](<https://en.wikipedia.org/wiki/Norm_(mathematics)#Maximum_norm_(special_case_of:_infinity_norm,_uniform_norm,_or_supremum_norm)>))における2点間の距離を計算します(ベクトルの要素が座標となります)。

**構文**

```sql
LinfDistance(vector1, vector2)
```

**エイリアス**: `distanceLinf`

**引数**

- `vector1` — 第1ベクトル。[`Tuple(T)`](/sql-reference/data-types/tuple) または [`Array(T)`](/sql-reference/data-types/array)
- `vector2` — 第2ベクトル。[`Tuple(T)`](/sql-reference/data-types/tuple) または [`Array(T)`](/sql-reference/data-types/array)

**戻り値**

無限大ノルム距離を返します。[`Float64`](/sql-reference/data-types/float)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT LinfDistance((1, 2), (2, 3))
```

```response title=レスポンス
┌─LinfDistance((1, 2), (2, 3))─┐
│                            1 │
└──────────────────────────────┘
```


## LinfNorm {#LinfNorm}

導入バージョン: v21.11

ベクトルの要素の絶対値の最大値を計算します。

**構文**

```sql
LinfNorm(vector)
```

**エイリアス**: `normLinf`

**引数**

- `vector` — 数値のベクトルまたはタプル。[`Array(T)`](/sql-reference/data-types/array) または [`Tuple(T)`](/sql-reference/data-types/tuple)

**戻り値**

Linfノルム（最大絶対値）を返します。[`Float64`](/sql-reference/data-types/float)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT LinfNorm((1, -2))
```

```response title=レスポンス
┌─LinfNorm((1, -2))─┐
│                 2 │
└───────────────────┘
```


## LinfNormalize {#LinfNormalize}

導入バージョン: v21.11

与えられたベクトル（タプルの要素が座標）の`L_{inf}`空間における単位ベクトルを計算します（[最大ノルム](<https://en.wikipedia.org/wiki/Norm_(mathematics)#Maximum_norm_(special_case_of:_infinity_norm,_uniform_norm,_or_supremum_norm)>)を使用）。

**構文**

```sql
LinfNormalize(tuple)
```

**エイリアス**: `normalizeLinf`

**引数**

- `tuple` — 数値のタプル。[`Tuple(T)`](/sql-reference/data-types/tuple)

**戻り値**

単位ベクトルを返します。[`Tuple(Float64)`](/sql-reference/data-types/tuple)

**例**

**基本的な使用法**

```sql title=Query
SELECT LinfNormalize((3, 4))
```

```response title=Response
┌─LinfNormalize((3, 4))─┐
│ (0.75,1)              │
└───────────────────────┘
```


## LpDistance {#LpDistance}

導入バージョン: v21.11

`Lp`空間における2点間の距離を計算します（ベクトルの要素が座標となります）（[p-ノルム距離](<https://en.wikipedia.org/wiki/Norm_(mathematics)#p-norm>)）。

**構文**

```sql
LpDistance(vector1, vector2, p)
```

**エイリアス**: `distanceLp`

**引数**

- `vector1` — 第1ベクトル。[`Tuple(T)`](/sql-reference/data-types/tuple)または[`Array(T)`](/sql-reference/data-types/array)
- `vector2` — 第2ベクトル。[`Tuple(T)`](/sql-reference/data-types/tuple)または[`Array(T)`](/sql-reference/data-types/array)
- `p` — べき乗数。指定可能な値: `[1; inf)`の範囲の実数。[`UInt*`](/sql-reference/data-types/int-uint)または[`Float*`](/sql-reference/data-types/float)

**戻り値**

p-ノルム距離を返します。[`Float64`](/sql-reference/data-types/float)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT LpDistance((1, 2), (2, 3), 3)
```

```response title=レスポンス
┌─LpDistance((1, 2), (2, 3), 3)─┐
│            1.2599210498948732 │
└───────────────────────────────┘
```


## LpNorm {#LpNorm}

導入バージョン: v21.11

ベクトルのp-ノルムを計算します。これは、各要素の絶対値のp乗の合計のp乗根です。

特殊なケース:

- p=1の場合、L1Norm(マンハッタン距離)と等価です。
- p=2の場合、L2Norm(ユークリッド距離)と等価です。
- p=∞の場合、LinfNorm(最大ノルム)と等価です。

**構文**

```sql
LpNorm(vector, p)
```

**エイリアス**: `normLp`

**引数**

- `vector` — 数値のベクトルまたはタプル。[`Tuple(T)`](/sql-reference/data-types/tuple)または[`Array(T)`](/sql-reference/data-types/array)
- `p` — べき乗数。`[1; inf)`の範囲の実数を指定可能。[`UInt*`](/sql-reference/data-types/int-uint)または[`Float*`](/sql-reference/data-types/float)

**戻り値**

[Lp-ノルム](<https://en.wikipedia.org/wiki/Norm_(mathematics)#p-norm>)を返します。[`Float64`](/sql-reference/data-types/float)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT LpNorm((1, -2), 2)
```

```response title=レスポンス
┌─LpNorm((1, -2), 2)─┐
│   2.23606797749979 │
└────────────────────┘
```


## LpNormalize {#LpNormalize}

導入バージョン: v21.11

`Lp`空間において、与えられたベクトル（タプルの要素が座標）の単位ベクトルを計算します（[p-ノルム](<https://en.wikipedia.org/wiki/Norm_(mathematics)#p-norm>)を使用）。

**構文**

```sql
LpNormalize(tuple, p)
```

**エイリアス**: `normalizeLp`

**引数**

- `tuple` — 数値のタプル。[`Tuple(T)`](/sql-reference/data-types/tuple)
- `p` — べき乗。`[1; inf)`の範囲内の任意の数値を指定可能。[`UInt*`](/sql-reference/data-types/int-uint)または[`Float*`](/sql-reference/data-types/float)

**戻り値**

単位ベクトルを返します。[`Tuple(Float64)`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT LpNormalize((3, 4), 5)
```

```response title=Response
┌─LpNormalize((3, 4), 5)──────────────────┐
│ (0.7187302630182624,0.9583070173576831) │
└─────────────────────────────────────────┘
```


## cosineDistance {#cosineDistance}

導入バージョン: v1.1

2つのベクトル間のコサイン距離を計算します(タプルの要素が座標を表します)。返される値が小さいほど、ベクトルの類似度が高くなります。

**構文**

```sql
cosineDistance(vector1, vector2)
```

**引数**

- `vector1` — 1つ目のタプル。[`Tuple(T)`](/sql-reference/data-types/tuple)または[`Array(T)`](/sql-reference/data-types/array)
- `vector2` — 2つ目のタプル。[`Tuple(T)`](/sql-reference/data-types/tuple)または[`Array(T)`](/sql-reference/data-types/array)

**戻り値**

2つのベクトル間の角度のコサインを1から減算した値を返します。[`Float64`](/sql-reference/data-types/float)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT cosineDistance((1, 2), (2, 3));
```

```response title=レスポンス
┌─cosineDistance((1, 2), (2, 3))─┐
│           0.007722123286332261 │
└────────────────────────────────┘
```

<!--AUTOGENERATED_END-->
