---
description: '自然言語処理（NLP）関数に関するドキュメント'
sidebar_label: 'NLP（自然言語処理）'
slug: /sql-reference/functions/nlp-functions
title: '自然言語処理（NLP）関数'
doc_type: 'reference'
keywords: ['NLP', '自然言語処理']
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import CloudNotSupportedBadge from '@theme/badges/CloudNotSupportedBadge';

# 自然言語処理 (NLP) 関数 {#natural-language-processing-nlp-functions}

<ExperimentalBadge />

<CloudNotSupportedBadge />

:::warning
これは現在開発中の実験的機能であり、本番利用にはまだ適していません。今後のリリースで後方互換性のないかたちで予期しない変更が行われる可能性があります。この機能を有効化するには、`allow_experimental_nlp_functions = 1` を設定してください。
:::

{/* 
  以下のタグ内の内容は、ドキュメントフレームワークのビルド時に
  system.functions から生成されたドキュメントに置き換えられます。タグを変更または削除しないでください。
  詳細は https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md を参照してください。
  */ }

{/*AUTOGENERATED_START*/ }

## detectCharset {#detectCharset}

導入バージョン: v22.2

UTF-8 以外でエンコードされた入力文字列の文字セットを検出します。

**構文**

```sql
detectCharset(s)
```

**引数**

* `s` — 解析対象のテキスト。[`String`](/sql-reference/data-types/string)

**戻り値**

検出された文字セットのコードを表す文字列を返します。[`String`](/sql-reference/data-types/string)

**使用例**

**基本的な使用方法**

```sql title=Query
SELECT detectCharset('Ich bleibe für ein paar Tage.')
```

```response title=Response
WINDOWS-1252
```



## detectLanguage {#detectLanguage}

Introduced in: v22.2


Detects the language of the UTF8-encoded input string.
The function uses the [CLD2 library](https://github.com/CLD2Owners/cld2) for detection and returns the 2-letter ISO language code.

The longer the input, the more precise the language detection will be.


**Syntax**

```sql
言語を検出する（s）
```

**Arguments**

- `text_to_be_analyzed` — The text to analyze. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the 2-letter ISO code of the detected language. Other possible results: `un` = unknown, can not detect any language, `other` = the detected language does not have 2 letter code. [`String`](/sql-reference/data-types/string)

**Examples**

**Mixed language text**

```sql title=Query
SELECT detectLanguage('自分は決してネイティブのようにフランス語を話せるようにはならないと思う。意志あるところに道は開ける。')
```

```response title=Response
fr
```



## detectLanguageMixed {#detectLanguageMixed}

Introduced in: v22.2


Similar to the [`detectLanguage`](#detectLanguage) function, but `detectLanguageMixed` returns a `Map` of 2-letter language codes that are mapped to the percentage of the certain language in the text.


**Syntax**

```sql
detectLanguageMixed(s)
```

**Arguments**

- `s` — The text to analyze [`String`](/sql-reference/data-types/string)


**Returned value**

Returns a map with keys which are 2-letter ISO codes and corresponding values which are a percentage of the text found for that language [`Map(String, Float32)`](/sql-reference/data-types/map)

**Examples**

**Mixed languages**

```sql title=Query
SELECT detectLanguageMixed('二兎を追う者は一兎をも得ず二兎を追う者は一兎をも得ず 危険なくして勝つ者に栄光なし。')
```

```response title=Response
{'ja':0.62,'fr':0.36}
```



## detectLanguageUnknown {#detectLanguageUnknown}

Introduced in: v22.2


Similar to the [`detectLanguage`](#detectLanguage) function, except the detectLanguageUnknown function works with non-UTF8-encoded strings.
Prefer this version when your character set is UTF-16 or UTF-32.


**Syntax**

```sql
detectLanguageUnknown('s')
```

**Arguments**

- `s` — The text to analyze. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the 2-letter ISO code of the detected language. Other possible results: `un` = unknown, can not detect any language, `other` = the detected language does not have 2 letter code. [`String`](/sql-reference/data-types/string)

**Examples**

**Basic usage**

```sql title=Query
SELECT detectLanguageUnknown('Ich bleibe für ein paar Tage.')
```

```response title=Response
de
```



## detectProgrammingLanguage {#detectProgrammingLanguage}

Introduced in: v22.2


Determines the programming language from a given source code snippet.


**Syntax**

```sql
detectProgrammingLanguage('source_code')
```

**Arguments**

- `source_code` — String representation of the source code to analyze. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns programming language [`String`](/sql-reference/data-types/string)

**Examples**

**C++ code detection**

```sql title=Query
SELECT detectProgrammingLanguage('#include <iostream>')
```

```response title=Response
C++
```



## detectTonality {#detectTonality}

Introduced in: v22.2


Determines the sentiment of the provided text data.

:::note Limitation
This function is limited in its current form in that it makes use of the embedded emotional dictionary and only works for the Russian language.
:::


**Syntax**

```sql
detectTonality(s)
```

**Arguments**

- `s` — The text to be analyzed. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the average sentiment value of the words in text [`Float32`](/sql-reference/data-types/float)

**Examples**

**Russian sentiment analysis**

```sql title=Query
SELECT
    detectTonality('Шарик - хороший пёс'),
    detectTonality('Шарик - пёс'),
    detectTonality('Шарик - плохой пёс')
```

```response title=Response
0.44445, 0, -0.3
```



## lemmatize {#lemmatize}

Introduced in: v21.9


Performs lemmatization on a given word.
This function needs dictionaries to operate, which can be obtained from [github](https://github.com/vpodpecan/lemmagen3/tree/master/src/lemmagen3/models). For more details on loading a dictionary from a local file see page ["Defining Dictionaries"](/sql-reference/dictionaries#local-file).


**Syntax**

```sql
lemmatize(lang, word)
```

**Arguments**

- `lang` — Language which rules will be applied. [`String`](/sql-reference/data-types/string)
- `word` — Lowercase word that needs to be lemmatized. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the lemmatized form of the word [`String`](/sql-reference/data-types/string)

**Examples**

**English lemmatization**

```sql title=Query
SELECT lemmatize('en', 'wolves')
```

```response title=Response
狼
```



## stem {#stem}

Introduced in: v21.9


Performs stemming on a given word.


**Syntax**

```sql
stem(lang, word)
```

**Arguments**

- `lang` — Language which rules will be applied. Use the two letter ISO 639-1 code. [`String`](/sql-reference/data-types/string)
- `word` — Lowercase word that needs to be stemmed. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns the stemmed form of the word [`String`](/sql-reference/data-types/string)

**Examples**

**English stemming**

```sql title=Query
SELECT arrayMap(x -> stem('en', x),
['I', 'think', 'it', 'is', 'a', 'blessing', 'in', 'disguise']) AS res
```

```response title=Response
['私は','それは','（災い転じて）','祝福だと','思います']
```



## synonyms {#synonyms}

Introduced in: v21.9


Finds synonyms of a given word.

There are two types of synonym extensions:
- `plain`
- `wordnet`

With the `plain` extension type you need to provide a path to a simple text file, where each line corresponds to a certain synonym set.
Words in this line must be separated with space or tab characters.

With the `wordnet` extension type you need to provide a path to a directory with the WordNet thesaurus in it.
The thesaurus must contain a WordNet sense index.


**Syntax**

```sql
synonyms(ext_name, word)
```

**Arguments**

- `ext_name` — Name of the extension in which search will be performed. [`String`](/sql-reference/data-types/string)
- `word` — Word that will be searched in extension. [`String`](/sql-reference/data-types/string)


**Returned value**

Returns array of synonyms for the given word. [`Array(String)`](/sql-reference/data-types/array)

**Examples**

**Find synonyms**

```sql title=Query
SELECT synonyms('list', 'important')
```

```response title=Response
['important','big','critical','crucial']
```

{/*AUTOGENERATED_END*/ }
