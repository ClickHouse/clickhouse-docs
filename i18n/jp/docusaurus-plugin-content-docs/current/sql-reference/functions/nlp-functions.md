---
description: '自然言語処理 (NLP) 関数に関するドキュメント'
sidebar_label: 'NLP'
slug: /sql-reference/functions/nlp-functions
title: '自然言語処理 (NLP) 関数'
doc_type: 'reference'
keywords: ['NLP', '自然言語処理']
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import CloudNotSupportedBadge from '@theme/badges/CloudNotSupportedBadge';


# 自然言語処理（NLP）関数

<ExperimentalBadge />
<CloudNotSupportedBadge />

:::warning
これは現在開発中の実験的機能であり、本番環境での使用には適していません。今後のリリースで予期しない後方互換性のない変更が行われる可能性があります。有効にするには `allow_experimental_nlp_functions = 1` を設定してください。
:::

<!--
The inner content of the tags below are replaced at doc framework build time with
docs generated from system.functions. Please do not modify or remove the tags.
See: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
-->


<!--AUTOGENERATED_START-->

## detectCharset {#detectCharset}

導入バージョン: v22.2

UTF-8以外でエンコードされた入力文字列の文字セットを検出します。

**構文**

```sql
detectCharset(s)
```

**引数**

- `s` — 解析するテキスト。[`String`](/sql-reference/data-types/string)

**戻り値**

検出された文字セットのコードを含む文字列 [`String`](/sql-reference/data-types/string)

**例**

**基本的な使用法**

```sql title=Query
SELECT detectCharset('Ich bleibe für ein paar Tage.')
```

```response title=Response
WINDOWS-1252
```


## detectLanguage {#detectLanguage}

導入バージョン: v22.2

UTF8エンコードされた入力文字列の言語を検出します。
この関数は検出に[CLD2ライブラリ](https://github.com/CLD2Owners/cld2)を使用し、2文字のISO言語コードを返します。

入力が長いほど、言語検出の精度が向上します。

**構文**

```sql
detectLanguage(s)
```

**引数**

- `text_to_be_analyzed` — 分析するテキスト。[`String`](/sql-reference/data-types/string)

**戻り値**

検出された言語の2文字のISOコードを返します。その他の可能な結果: `un` = 不明(言語を検出できない)、`other` = 検出された言語に2文字コードが存在しない。[`String`](/sql-reference/data-types/string)

**例**

**混合言語テキスト**

```sql title=クエリ
SELECT detectLanguage('Je pense que je ne parviendrai jamais à parler français comme un natif. Where there\'s a will, there\'s a way.')
```

```response title=レスポンス
fr
```


## detectLanguageMixed {#detectLanguageMixed}

導入バージョン: v22.2

[`detectLanguage`](#detectLanguage)関数と同様ですが、`detectLanguageMixed`はテキスト内の各言語の割合にマッピングされた2文字の言語コードの`Map`を返します。

**構文**

```sql
detectLanguageMixed(s)
```

**引数**

- `s` — 分析するテキスト [`String`](/sql-reference/data-types/string)

**戻り値**

2文字のISOコードをキーとし、その言語で検出されたテキストの割合を値とするマップを返します [`Map(String, Float32)`](/sql-reference/data-types/map)

**例**

**混合言語**

```sql title=クエリ
SELECT detectLanguageMixed('二兎を追う者は一兎をも得ず二兎を追う者は一兎をも得ず A vaincre sans peril, on triomphe sans gloire.')
```

```response title=レスポンス
{'ja':0.62,'fr':0.36}
```


## detectLanguageUnknown {#detectLanguageUnknown}

導入バージョン: v22.2

[`detectLanguage`](#detectLanguage)関数と同様ですが、detectLanguageUnknown関数は非UTF-8エンコードの文字列を処理します。
文字セットがUTF-16またはUTF-32の場合は、このバージョンを使用してください。

**構文**

```sql
detectLanguageUnknown('s')
```

**引数**

- `s` — 分析対象のテキスト。[`String`](/sql-reference/data-types/string)

**戻り値**

検出された言語の2文字のISOコードを返します。その他の可能な結果: `un` = 不明(言語を検出できない)、`other` = 検出された言語に2文字コードがない。[`String`](/sql-reference/data-types/string)

**例**

**基本的な使用方法**

```sql title=クエリ
SELECT detectLanguageUnknown('Ich bleibe für ein paar Tage.')
```

```response title=レスポンス
de
```


## detectProgrammingLanguage {#detectProgrammingLanguage}

導入バージョン: v22.2

与えられたソースコードスニペットからプログラミング言語を判定します。

**構文**

```sql
detectProgrammingLanguage('source_code')
```

**引数**

- `source_code` — 解析するソースコードの文字列表現。[`String`](/sql-reference/data-types/string)

**戻り値**

プログラミング言語を[`String`](/sql-reference/data-types/string)型で返します

**例**

**C++コードの検出**

```sql title=Query
SELECT detectProgrammingLanguage('#include <iostream>')
```

```response title=Response
C++
```


## detectTonality {#detectTonality}

導入バージョン: v22.2

提供されたテキストデータのセンチメントを判定します。

:::note 制限事項
この関数は現在の形式では組み込みの感情辞書を使用しており、ロシア語のみに対応しています。
:::

**構文**

```sql
detectTonality(s)
```

**引数**

- `s` — 分析対象のテキスト。[`String`](/sql-reference/data-types/string)

**戻り値**

テキスト内の単語の平均センチメント値を返します。[`Float32`](/sql-reference/data-types/float)

**例**

**ロシア語のセンチメント分析**

```sql title=Query
SELECT
    detectTonality('Шарик - хороший пёс'),
    detectTonality('Шарик - пёс'),
    detectTonality('Шарик - плохой пёс')
```

```response title=Response
0.44445, 0, -0.3
```


## lemmatize {#lemmatize}

導入バージョン: v21.9

指定された単語に対して見出し語化を実行します。
この関数を動作させるには辞書が必要です。辞書は[github](https://github.com/vpodpecan/lemmagen3/tree/master/src/lemmagen3/models)から取得できます。ローカルファイルから辞書を読み込む詳細については、["辞書の定義"](/sql-reference/dictionaries#local-file)のページを参照してください。

**構文**

```sql
lemmatize(lang, word)
```

**引数**

- `lang` — 適用する言語ルール。[`String`](/sql-reference/data-types/string)
- `word` — 見出し語化する小文字の単語。[`String`](/sql-reference/data-types/string)

**戻り値**

単語の見出し語化された形式を返します。[`String`](/sql-reference/data-types/string)

**例**

**英語の見出し語化**

```sql title=クエリ
SELECT lemmatize('en', 'wolves')
```

```response title=レスポンス
wolf
```


## stem {#stem}

導入バージョン: v21.9

指定された単語に対してステミング処理を実行します。

**構文**

```sql
stem(lang, word)
```

**引数**

- `lang` — 適用する言語ルール。2文字のISO 639-1コードを使用します。[`String`](/sql-reference/data-types/string)
- `word` — ステミング処理を行う小文字の単語。[`String`](/sql-reference/data-types/string)

**戻り値**

単語のステミング処理後の形式を返します。[`String`](/sql-reference/data-types/string)

**例**

**英語のステミング**

```sql title=クエリ
SELECT arrayMap(x -> stem('en', x),
['I', 'think', 'it', 'is', 'a', 'blessing', 'in', 'disguise']) AS res
```

```response title=レスポンス
['I','think','it','is','a','bless','in','disguis']
```


## synonyms {#synonyms}

導入バージョン: v21.9

指定された単語の同義語を検索します。

同義語拡張には2つのタイプがあります:

- `plain`
- `wordnet`

`plain`拡張タイプでは、各行が特定の同義語セットに対応するシンプルなテキストファイルへのパスを指定する必要があります。
行内の単語は、スペースまたはタブ文字で区切る必要があります。

`wordnet`拡張タイプでは、WordNetシソーラスを含むディレクトリへのパスを指定する必要があります。
シソーラスにはWordNetセンスインデックスが含まれている必要があります。

**構文**

```sql
synonyms(ext_name, word)
```

**引数**

- `ext_name` — 検索を実行する拡張の名前。[`String`](/sql-reference/data-types/string)
- `word` — 拡張内で検索される単語。[`String`](/sql-reference/data-types/string)

**戻り値**

指定された単語の同義語の配列を返します。[`Array(String)`](/sql-reference/data-types/array)

**例**

**同義語の検索**

```sql title=クエリ
SELECT synonyms('list', 'important')
```

```response title=レスポンス
['important','big','critical','crucial']
```

<!--AUTOGENERATED_END-->
