---
description: '通常関数のドキュメント'
sidebar_label: '概要'
sidebar_position: 1
slug: /sql-reference/functions/overview
title: '通常関数'
doc_type: 'reference'
---



# 通常関数

関数には少なくとも\*2種類あります。通常関数（単に「関数」と呼ばれます）と集約関数です。これらはまったく異なる概念です。通常関数は、各行に個別に適用されるかのように動作します（各行について、関数の結果は他の行には依存しません）。集約関数は、さまざまな行から値の集合を蓄積します（つまり、すべての行の集合全体に依存します）。

このセクションでは通常関数について説明します。集約関数については「集約関数」のセクションを参照してください。

:::note 
['arrayJoin' 関数](../functions/array-join.md)が属する第3の種類の関数があります。また、[テーブル関数](../table-functions/index.md)も別種のものとして言及できます。
:::



## 強い型付け {#strong-typing}

標準SQLとは対照的に、ClickHouseは強い型付けを採用しています。つまり、型間の暗黙的な変換を行いません。各関数は特定の型のセットに対してのみ動作します。そのため、型変換関数を使用する必要がある場合があります。


## 共通部分式の削除 {#common-subexpression-elimination}

クエリ内で同じAST(同じレコードまたは構文解析の同じ結果)を持つすべての式は、同一の値を持つとみなされます。このような式は統合され、一度だけ実行されます。同一のサブクエリもこの方法で削除されます。


## 結果の型 {#types-of-results}

すべての関数は結果として単一の値を返します(複数の値やゼロ個の値ではありません)。結果の型は通常、引数の値ではなく、引数の型のみによって定義されます。例外として、tupleElement関数(a.N演算子)とtoFixedString関数があります。


## 定数 {#constants}

簡潔性のため、一部の関数では特定の引数に定数のみを使用できます。例えば、LIKE演算子の右辺の引数は定数でなければなりません。
ほぼすべての関数は、定数引数に対して定数を返します。例外は、乱数を生成する関数です。
'now'関数は異なる時刻に実行されたクエリに対して異なる値を返しますが、定数性は単一のクエリ内でのみ重要であるため、結果は定数と見なされます。
定数式も定数と見なされます(例えば、LIKE演算子の右辺は複数の定数から構成できます)。

関数は、定数引数と非定数引数に対して異なる方法で実装できます(異なるコードが実行されます)。ただし、定数と同じ値のみを含む実際のカラムに対する結果は、互いに一致する必要があります。


## NULL処理 {#null-processing}

関数には以下の動作があります：

- 関数の引数の少なくとも1つが`NULL`の場合、関数の結果も`NULL`になります。
- 各関数の説明で個別に指定される特別な動作。ClickHouseのソースコードでは、これらの関数は`UseDefaultImplementationForNulls=false`を持ちます。


## 不変性 {#constancy}

関数は引数の値を変更できません。すべての変更は結果として返されます。したがって、個別の関数の計算結果は、クエリ内で関数が記述される順序に依存しません。


## 高階関数 {#higher-order-functions}

### `->` 演算子と lambda(params, expr) 関数 {#arrow-operator-and-lambda}

高階関数は、関数型引数としてラムダ関数のみを受け入れます。高階関数にラムダ関数を渡すには、`->` 演算子を使用します。矢印の左側には仮引数を記述します。これは任意のIDまたは複数の仮引数(タプル内の任意のID)です。矢印の右側には、これらの仮引数やテーブルの列を使用できる式を記述します。

例:

```python
x -> 2 * x
str -> str != Referer
```

複数の引数を受け入れるラムダ関数も高階関数に渡すことができます。この場合、高階関数には、これらの引数に対応する同じ長さの複数の配列が渡されます。

一部の関数では、最初の引数(ラムダ関数)を省略できます。この場合、恒等写像が適用されます。


## ユーザー定義関数（UDF） {#user-defined-functions-udfs}

ClickHouseはユーザー定義関数をサポートしています。[UDF](../functions/udf.md)を参照してください。
