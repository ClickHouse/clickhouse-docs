---
description: 'ハッシュ関数に関するドキュメント'
sidebar_label: 'ハッシュ'
slug: /sql-reference/functions/hash-functions
title: 'ハッシュ関数'
doc_type: 'reference'
---

# ハッシュ関数 {#hash-functions}

ハッシュ関数は、要素を決定論的かつ疑似ランダムにシャッフルするために使用できます。

SimHash はハッシュ関数であり、近い（類似した）引数に対して近いハッシュ値を返します。

ほとんどのハッシュ関数は、任意の型の任意個数の引数を受け付けます。

:::note
NULL のハッシュ値は NULL です。Nullable 列の NULL ではないハッシュ値を取得するには、それをタプルでラップしてください:

```sql
SELECT cityHash64(tuple(NULL))
```

:::

:::note
テーブル全体の内容のハッシュを計算するには、`sum(cityHash64(tuple(*)))`（または他のハッシュ関数）を使用してください。`tuple` により、NULL 値を含む行が除外されなくなります。`sum` により、行の順序に依存しなくなります。
:::

{/* 
  以下のタグ内の内容は、ドキュメントフレームワークのビルド時に
  system.functions から生成されるドキュメントに置き換えられます。
  これらのタグを変更したり削除したりしないでください。
  詳細は https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md を参照してください。
  */ }

{/*AUTOGENERATED_START*/ }

## BLAKE3 {#BLAKE3}

導入バージョン: v22.10

BLAKE3 ハッシュ値を計算し、その結果のバイト列を FixedString として返します。
この暗号学的ハッシュ関数は、BLAKE3 Rust ライブラリを用いて ClickHouse に統合されています。
この関数はかなり高速で、SHA-2 と比べておよそ 2 倍の速度を発揮しつつ、SHA-256 と同じ長さのハッシュを生成します。
戻り値は、型 FixedString(32) のバイト配列としての BLAKE3 ハッシュです。

**構文**

```sql
BLAKE3(message)
```

**引数**

* `message` — ハッシュ化する入力文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

入力文字列の BLAKE3 による 32 バイトのハッシュ値を固定長文字列として返します。[`FixedString(32)`](/sql-reference/data-types/fixedstring)

**例**

**hash**

```sql title=Query
SELECT hex(BLAKE3('ABC'))
```

```response title=Response
┌─hex(BLAKE3('ABC'))───────────────────────────────────────────────┐
│ D1717274597CF0289694F75D96D444B992A096F1AFD8E7BBFA6EBB1D360FEDFC │
└──────────────────────────────────────────────────────────────────┘
```

## MD4 {#MD4}

導入バージョン: v21.11

指定した文字列の MD4 ハッシュ値を計算します。

**構文**

```sql
MD4(s)
```

**引数**

* `s` — ハッシュ化する入力文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

指定された入力文字列の MD4 ハッシュ値を固定長の文字列として返します。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT HEX(MD4('abc'));
```

```response title=Response
┌─hex(MD4('abc'))──────────────────┐
│ A448017AAF21D8525FC10AE87AA6729D │
└──────────────────────────────────┘
```

## MD5 {#MD5}

導入バージョン: v1.1

指定された文字列の MD5 ハッシュ値を計算します。

**構文**

```sql
MD5(s)
```

**引数**

* `s` — ハッシュ化する入力文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

指定された入力文字列の MD5 ハッシュ値を固定長の文字列として返します。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT HEX(MD5('abc'));
```

```response title=Response
┌─hex(MD5('abc'))──────────────────┐
│ 900150983CD24FB0D6963F7D28E17F72 │
└──────────────────────────────────┘
```

## RIPEMD160 {#RIPEMD160}

導入バージョン: v24.10

指定された文字列の RIPEMD-160 ハッシュ値を計算します。

**構文**

```sql
RIPEMD160(s)
```

**引数**

* `s` — ハッシュ化する入力文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

指定された入力文字列の RIPEMD160 ハッシュを固定長文字列として返します。[`FixedString(20)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT HEX(RIPEMD160('素早い茶色の狐が怠惰な犬を飛び越える'));
```

```response title=Response
┌─HEX(RIPEMD160('The quick brown fox jumps over the lazy dog'))─┐
│ 37F332F68DB77BD9D7EDD4969571AD671CF9DD3B                      │
└───────────────────────────────────────────────────────────────┘
```

## SHA1 {#SHA1}

導入バージョン: v1.1

指定された文字列の SHA1 ハッシュ値を計算します。

**構文**

```sql
SHA1(s)
```

**引数**

* `s` — ハッシュ化する入力文字列 [`String`](/sql-reference/data-types/string)

**戻り値**

指定された入力文字列のSHA1ハッシュ値を固定長の文字列として返します。[`FixedString(20)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT HEX(SHA1('abc'));
```

```response title=Response
┌─hex(SHA1('abc'))─────────────────────────┐
│ A9993E364706816ABA3E25717850C26C9CD0D89D │
└──────────────────────────────────────────┘
```

## SHA224 {#SHA224}

導入バージョン：v1.1

指定した文字列の SHA224 ハッシュ値を計算します。

**構文**

```sql
SHA224(s)
```

**引数**

* `s` — ハッシュ化する入力文字列。[`String`](/sql-reference/data-types/string)

**返される値**

指定した入力文字列の SHA224 ハッシュ値を固定長の文字列として返します。[`FixedString(28)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT HEX(SHA224('abc'));
```

```response title=Response
┌─hex(SHA224('abc'))───────────────────────────────────────┐
│ 23097D223405D8228642A477BDA255B32AADBCE4BDA0B3F7E36C9DA7 │
└──────────────────────────────────────────────────────────┘
```

## SHA256 {#SHA256}

導入バージョン: v1.1

指定した文字列の SHA256 ハッシュを計算します。

**構文**

```sql
SHA256(s)
```

**引数**

* `s` — ハッシュ化する入力文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

指定された入力文字列の SHA256 ハッシュ値を固定長文字列として返します。[`FixedString(32)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT HEX(SHA256('abc'));
```

```response title=Response
┌─hex(SHA256('abc'))───────────────────────────────────────────────┐
│ BA7816BF8F01CFEA414140DE5DAE2223B00361A396177A9CB410FF61F20015AD │
└──────────────────────────────────────────────────────────────────┘
```

## SHA384 {#SHA384}

導入バージョン：v1.1

指定した文字列の SHA384 ハッシュ値を計算します。

**構文**

```sql
SHA384(s)
```

**引数**

* `s` — ハッシュ化する入力文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

指定された入力文字列の SHA384 ハッシュ値を固定長の文字列として返します。[`FixedString(48)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT HEX(SHA384('abc'));
```

```response title=Response
┌─hex(SHA384('abc'))───────────────────────────────────────────────────────────────────────────────┐
│ CB00753F45A35E8BB5A03D699AC65007272C32AB0EDED1631A8B605A43FF5BED8086072BA1E7CC2358BAECA134C825A7 │
└──────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## SHA512 {#SHA512}

導入バージョン: v1.1

与えられた文字列の SHA512 ハッシュ値を計算します。

**構文**

```sql
SHA512(s)
```

**引数**

* `s` — ハッシュ化する入力文字列 [`String`](/sql-reference/data-types/string)

**戻り値**

与えられた入力文字列の SHA512 ハッシュ値を固定長文字列として返します。[`FixedString(64)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT HEX(SHA512('abc'));
```

```response title=Response
┌─hex(SHA512('abc'))───────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ DDAF35A193617ABACC417349AE20413112E6FA4E89A97EA20A9EEEE64B55D39A2192992A274FC1A836BA3C23A3FEEBBD454D4423643CE80E2A9AC94FA54CA49F │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## SHA512&#95;256 {#SHA512&#95;256}

導入バージョン: v1.1

指定された文字列の SHA512&#95;256 ハッシュ値を計算します。

**構文**

```sql
SHA512_256(s)
```

**引数**

* `s` — ハッシュ化する入力文字列。[`String`](/sql-reference/data-types/string)

**返される値**

指定された入力文字列の SHA512&#95;256 ハッシュを固定長文字列として返します。[`FixedString(32)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT HEX(SHA512_256('abc'));
```

```response title=Response
┌─hex(SHA512_256('abc'))───────────────────────────────────────────┐
│ 53048E2681941EF99B2E29B76B4C7DABE4C2D0C634FC6D46E0E2F13107E7AF23 │
└──────────────────────────────────────────────────────────────────┘
```

## URLHash {#URLHash}

導入バージョン: v1.1

URL から取得した文字列に対して、何らかの正規化処理を行ったうえで適用する、高速かつ十分な品質を備えた非暗号学的ハッシュ関数です。

このハッシュ関数には 2 つのモードがあります:

| Mode              | Description                                                                                                   |
| ----------------- | ------------------------------------------------------------------------------------------------------------- |
| `URLHash(url)`    | 末尾に存在する場合は、末尾の `/`、`?`、`#` のいずれか 1 文字を取り除いた文字列からハッシュを計算します。                                                   |
| `URLHash(url, N)` | 末尾に存在する場合は、末尾の `/`、`?`、`#` のいずれか 1 文字を取り除いたうえで、URL 階層の N レベル目までの文字列からハッシュを計算します。レベルの定義は `URLHierarchy` と同じです。 |

**構文**

```sql
URLHash(url[, N])
```

**引数**

* `url` — ハッシュ化する URL 文字列。[`String`](/sql-reference/data-types/string)
* `N` — 省略可能。URL 階層内のレベル。[`(U)Int*`](/sql-reference/data-types/int-uint)

**戻り値**

`url` の算出されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT URLHash('https://www.clickhouse.com')
```

```response title=Response
┌─URLHash('htt⋯house.com')─┐
│     13614512636072854701 │
└──────────────────────────┘
```

**指定レベルでの URL のハッシュ**

```sql title=Query
SELECT URLHash('https://www.clickhouse.com/docs', 0);
SELECT URLHash('https://www.clickhouse.com/docs', 1);
```

```response title=Response
-- https://www.clickhouse.com のハッシュ
┌─URLHash('htt⋯m/docs', 0)─┐
│     13614512636072854701 │
└──────────────────────────┘
-- https://www.clickhouse.com/docs のハッシュ
┌─URLHash('htt⋯m/docs', 1)─┐
│     13167253331440520598 │
└──────────────────────────┘
```

## cityHash64 {#cityHash64}

導入バージョン: v1.1

64 ビットの [CityHash](https://github.com/google/cityhash) ハッシュ値を生成します。

これは高速な非暗号学的ハッシュ関数です。
文字列型の引数には CityHash アルゴリズムを使用し、それ以外のデータ型の引数には実装依存の高速な非暗号学的ハッシュ関数を使用します。
この関数は、最終結果を得るために CityHash のコンビネーターを使用します。

:::info
Google は、CityHash が ClickHouse に追加された後に CityHash のアルゴリズムを変更しました。
つまり、ClickHouse の cityHash64 と Google のアップストリーム CityHash は現在異なる結果を生成します。
ClickHouse の cityHash64 は CityHash v1.0.2 に対応しています。
:::

:::note
異なる引数型であっても、同じ入力値に対して計算されるハッシュ値が等しくなる場合があります。
これは例えば、サイズの異なる整数型、同じデータを持つ名前付き・名前なしの `Tuple`、および同じデータを持つ `Map` とそれに対応する `Array(Tuple(key, value))` 型などに影響します。
:::

**構文**

```sql
cityHash64(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュ値を計算する対象となる可変個数の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数に対して計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**呼び出し例**

```sql title=Query
SELECT cityHash64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS CityHash, toTypeName(CityHash) AS type;
```

```response title=Response
┌─────────────CityHash─┬─type───┐
│ 12072650598913549138 │ UInt64 │
└──────────────────────┴────────┘
```

**行の順序も含めてテーブル全体のチェックサムを計算する**

```sql title=Query
CREATE TABLE users (
    id UInt32,
    name String,
    age UInt8,
    city String
)
ENGINE = MergeTree
ORDER BY tuple();

INSERT INTO users VALUES
(1, 'Alice', 25, 'New York'),
(2, 'Bob', 30, 'London'),
(3, 'Charlie', 35, 'Tokyo');

SELECT groupBitXor(cityHash64(*)) FROM users;
```

```response title=Response
┌─groupBitXor(⋯age, city))─┐
│     11639977218258521182 │
└──────────────────────────┘
```

## farmFingerprint64 {#farmFingerprint64}

導入バージョン: v20.12

`Fingerprint64` メソッドを使用して 64 ビットの [FarmHash](https://github.com/google/farmhash) 値を生成します。

:::tip
[`farmHash64`](#farmHash64) よりも安定かつ移植性の高い値が必要な場合は、`farmFingerprint64` の使用を推奨します。
:::

:::note
計算されるハッシュ値は、引数の型が異なっていても、同じ入力値に対して等しくなる場合があります。
これは、たとえばサイズの異なる整数型、同じデータを持つ名前付きおよび名前なしの `Tuple`、同じデータを持つ `Map` と、それに対応する `Array(Tuple(key, value))` 型などが該当します。
:::

**構文**

```sql
farmFingerprint64(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュを計算する可変長の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数から計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT farmFingerprint64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS FarmFingerprint, toTypeName(FarmFingerprint) AS type;
```

```response title=Response
┌─────FarmFingerprint─┬─type───┐
│ 5752020380710916328 │ UInt64 │
└─────────────────────┴────────┘
```

## farmHash64 {#farmHash64}

導入バージョン: v1.1

`Hash64` メソッドを使用して 64 ビットの [FarmHash](https://github.com/google/farmhash) を生成します。

:::tip
安定かつ移植性の高い値が必要な場合は [`farmFingerprint64`](#farmFingerprint64) の使用を推奨します。
:::

:::note
計算されるハッシュ値は、異なる引数型であっても、同じ入力値に対して同一になる場合があります。
これは、たとえばサイズの異なる整数型、同一データを持つ名前付きおよび名前なしの `Tuple`、同一データを持つ `Map` と、それに対応する `Array(Tuple(key, value))` 型などに影響します。
:::

**構文**

```sql
farmHash64(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュ値を計算する任意個の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数のハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT farmHash64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS FarmHash, toTypeName(FarmHash) AS type;
```

```response title=Response
┌─────────────FarmHash─┬─type───┐
│ 18125596431186471178 │ UInt64 │
└──────────────────────┴────────┘
```

## gccMurmurHash {#gccMurmurHash}

導入バージョン: v20.1

入力値に対して、[GCC](https://github.com/gcc-mirror/gcc/blob/41d6b10e96a1de98e90a7c0378437c3255814b16/libstdc%2B%2B-v3/include/bits/functional_hash.h#L191) で使用されているものと同じシードを用いて、64ビットの [MurmurHash2](https://github.com/aappleby/smhasher) ハッシュを計算します。

Clang と GCC のビルド間で同じ結果が得られます。

**構文**

```sql
gccMurmurHash(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュを計算する任意個の引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数に対して計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT
    gccMurmurHash(1, 2, 3) AS res1,
    gccMurmurHash(('a', [1, 2, 3], 4, (4, ['foo', 'bar'], 1, (1, 2)))) AS res2
```

```response title=Response
┌─────────────────res1─┬────────────────res2─┐
│ 12384823029245979431 │ 1188926775431157506 │
└──────────────────────┴─────────────────────┘
```

## halfMD5 {#halfMD5}

導入バージョン: v1.1

すべての入力パラメータを文字列として[解釈し](/sql-reference/functions/type-conversion-functions#reinterpretasstring)、それぞれに対して MD5 ハッシュ値を計算します。次に、それらのハッシュ値を連結し、得られた文字列のハッシュの先頭 8 バイトを取り出し、それをビッグエンディアンのバイト順で [UInt64](/sql-reference/data-types/int-uint) として解釈します。この関数は比較的低速です（1 プロセッサコアあたり 1 秒間に 500 万件の短い文字列）。

代わりに [`sipHash64`](#sipHash64) 関数の使用を検討してください。

この関数は可変数の入力パラメータを取ります。
引数には、サポートされている任意のデータ型を指定できます。
一部のデータ型では、引数の型が異なっていても（サイズの異なる整数、同一データを持つ名前付きおよび名前なしの Tuple、同一データを持つ Map と、同一データを持つ対応する Array(Tuple(key, value)) 型など）、同じ値に対してはハッシュ関数の計算結果が同じになる場合があります。

**構文**

```sql
halfMD5(arg1[, arg2, ..., argN])
```

**引数**

* `arg1[, arg2, ..., argN]` — ハッシュを計算する可変個数の引数。[`Any`](/sql-reference/data-types)

**戻り値**

指定した入力引数の half MD5 ハッシュ値を計算し、ビッグエンディアンのバイト順序で `UInt64` として返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT HEX(halfMD5('abc', 'cde', 'fgh'));
```

```response title=Response
┌─hex(halfMD5('abc', 'cde', 'fgh'))─┐
│ 2C9506B7374CFAF4                  │
└───────────────────────────────────┘
```

## hiveHash {#hiveHash}

導入バージョン: v20.1

文字列から「HiveHash」を計算します。
これは符号ビットをゼロクリアした [`JavaHash`](#javaHash) と同じです。
この関数は、バージョン 3.0 より前の [Apache Hive](https://en.wikipedia.org/wiki/Apache_Hive) で使用されています。

:::caution
このハッシュ関数は性能が高くありません。
すでに別のシステムでこのアルゴリズムが使われており、同じ結果を計算する必要がある場合にのみ使用してください。
:::

**構文**

```sql
hiveHash(arg)
```

**引数**

* `arg` — ハッシュ化する入力文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

入力文字列に対して計算された「hive hash」の値を返します。[`Int32`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT hiveHash('Hello, world!');
```

```response title=Response
┌─hiveHash('Hello, world!')─┐
│                 267439093 │
└───────────────────────────┘
```

## icebergHash {#icebergHash}

導入バージョン: v25.5

Iceberg の [ハッシュ変換](https://iceberg.apache.org/spec/#appendix-b-32-bit-hash-requirements)ロジックを実装します。

**構文**

```sql
icebergHash(value)
```

**引数**

* `value` — ハッシュ値を計算する入力値。[`Integer`](/sql-reference/data-types/int-uint)、[`Bool`](/sql-reference/data-types/boolean)、[`Decimal`](/sql-reference/data-types/decimal)、[`Float*`](/sql-reference/data-types/float)、[`String`](/sql-reference/data-types/string)、[`FixedString`](/sql-reference/data-types/fixedstring)、[`UUID`](/sql-reference/data-types/uuid)、[`Date`](/sql-reference/data-types/date)、[`Time`](/sql-reference/data-types/time)、[`DateTime`](/sql-reference/data-types/datetime) のいずれか。

**返される値**

32 ビットの Murmur3 ハッシュ（x86 バリアント、シード値 0）を表す [`Int32`](/sql-reference/data-types/int-uint) 型の値を返します。

**例**

**使用例**

```sql title=Query
SELECT icebergHash(1.0 :: Float32)
```

```response title=Response
-142385009
```

## intHash32 {#intHash32}

導入: v1.1

整数の 32 ビットハッシュ値を計算します。

このハッシュ関数は比較的高速ですが、暗号学的ハッシュ関数ではありません。

**構文**

```sql
intHash32(arg)
```

**引数**

* `arg` — ハッシュ化する整数。[`(U)Int*`](/sql-reference/data-types/int-uint)

**戻り値**

入力整数の32ビットハッシュ値（[`UInt32`](/sql-reference/data-types/int-uint)）を返します。

**例**

**使用例**

```sql title=Query
SELECT intHash32(42);
```

```response title=Response
┌─intHash32(42)─┐
│    1228623923 │
└───────────────┘
```

## intHash64 {#intHash64}

導入バージョン: v1.1

整数の 64 ビットハッシュ値を計算します。

このハッシュ関数は比較的高速で（[`intHash32`](#intHash32) よりも高速ですが）、暗号学的ハッシュ関数ではありません。

**構文**

```sql
intHash64(int)
```

**引数**

* `int` — ハッシュ化する整数値。[`(U)Int*`](/sql-reference/data-types/int-uint)

**戻り値**

64ビットのハッシュコード。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT intHash64(42);
```

```response title=Response
┌────────intHash64(42)─┐
│ 11490350930367293593 │
└──────────────────────┘
```

## javaHash {#javaHash}

導入バージョン: v20.1

次の値から JavaHash を計算します:

* [string](http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/String.java#l1452),
* [Byte](https://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/Byte.java#l405),
* [Short](https://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/Short.java#l410),
* [Integer](https://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/Integer.java#l959),
* [Long](https://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/Long.java#l1060).

:::caution
このハッシュ関数は効率が良くありません。
すでに別のシステムでこのアルゴリズムが使われており、同じ結果を計算する必要がある場合にのみ使用してください。
:::

:::note
Java は符号付き整数に対するハッシュの計算のみをサポートしています。
符号なし整数のハッシュを計算したい場合は、適切な符号付きの ClickHouse 型にキャストする必要があります。
:::

**構文**

```sql
javaHash(arg)
```

**引数**

* `arg` — ハッシュ計算の対象となる入力値。[`Any`](/sql-reference/data-types)

**戻り値**

`arg` のハッシュ値を計算して返します。[`Int32`](/sql-reference/data-types/int-uint)

**例**

**使用例 1**

```sql title=Query
SELECT javaHash(toInt32(123));
```

```response title=Response
┌─javaHash(toInt32(123))─┐
│               123      │
└────────────────────────┘
```

**使用例2**

```sql title=Query
SELECT javaHash('Hello, world!');
```

```response title=Response
┌─javaHash('Hello, world!')─┐
│               -1880044555 │
└───────────────────────────┘
```

## javaHashUTF16LE {#javaHashUTF16LE}

導入バージョン: v20.1

UTF-16LE でエンコードされた文字列を表すバイト列が含まれていると仮定して、その文字列から [JavaHash](http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/478a4add975b/src/share/classes/java/lang/String.java#l1452) を計算します。

**構文**

```sql
javaHashUTF16LE(arg)
```

**引数**

* `arg` — UTF-16LE でエンコードされた文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

UTF-16LE でエンコードされた文字列のハッシュ値を返します。[`Int32`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT javaHashUTF16LE(convertCharset('test', 'utf-8', 'utf-16le'));
```

```response title=Response
┌─javaHashUTF16LE(convertCharset('test', 'utf-8', 'utf-16le'))─┐
│                                                      3556498 │
└──────────────────────────────────────────────────────────────┘
```

## jumpConsistentHash {#jumpConsistentHash}

導入バージョン: v1.1

整数に対して[jump consistent hash](https://arxiv.org/pdf/1406.2294.pdf)を計算します。

**構文**

```sql
jumpConsistentHash(key, buckets)
```

**引数**

* `key` — 入力キー。[`UInt64`](/sql-reference/data-types/int-uint)
* `buckets` — バケット数。[`Int32`](/sql-reference/data-types/int-uint)

**戻り値**

計算されたハッシュ値を返します。[`Int32`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT jumpConsistentHash(256, 4)
```

```response title=Response
┌─jumpConsistentHash(256, 4)─┐
│                          3 │
└────────────────────────────┘
```

## kafkaMurmurHash {#kafkaMurmurHash}

導入: v23.4

入力値の 32 ビット [MurmurHash2](https://github.com/aappleby/smhasher) ハッシュ値を、[Kafka](https://github.com/apache/kafka/blob/461c5cfe056db0951d9b74f5adc45973670404d7/clients/src/main/java/org/apache/kafka/common/utils/Utils.java#L482) で使用されているものと同じシードを用い、かつ最上位ビットを除外することで、[Default Partitioner](https://github.com/apache/kafka/blob/139f7709bd3f5926901a21e55043388728ccca78/clients/src/main/java/org/apache/kafka/clients/producer/internals/BuiltInPartitioner.java#L328) と互換性を持つように計算します。

**構文**

```sql
kafkaMurmurHash(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュ値を計算するための可変個の引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数に対して計算されたハッシュ値を返します。[`UInt32`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT
    kafkaMurmurHash('foobar') AS res1,
    kafkaMurmurHash(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS res2
```

```response title=Response
┌───────res1─┬─────res2─┐
│ 1357151166 │ 85479775 │
└────────────┴──────────┘
```

## keccak256 {#keccak256}

導入されたバージョン: v25.4

指定された文字列の Keccak-256 暗号学的ハッシュ値を計算します。
このハッシュ関数はブロックチェーンアプリケーション、特に Ethereum で広く使用されています。

**構文**

```sql
keccak256(message)
```

**引数**

* `message` — ハッシュ化する入力文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

入力文字列の 32 バイトの Keccak-256 ハッシュ値を固定長文字列として返します。[`FixedString(32)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT hex(keccak256('hello'))
```

```response title=Response
┌─hex(keccak256('hello'))──────────────────────────────────────────┐
│ 1C8AFF950685C2ED4BC3174F3472287B56D9517B9C948127319A09A7A36DEAC8 │
└──────────────────────────────────────────────────────────────────┘
```

## kostikConsistentHash {#kostikConsistentHash}

導入バージョン: v22.6

Konstantin &#39;Kostik&#39; Oblakov による、時間計算量および空間計算量がともに O(1) のコンシステントハッシュアルゴリズム。
`n <= 32768` の場合にのみ効率的です。

**構文**

```sql
kostikConsistentHash(input, n)
```

**別名**: `yandexConsistentHash`

**引数**

* `input` — 整数のキー。[`UInt64`](/sql-reference/data-types/int-uint)
* `n` — バケット数。[`UInt16`](/sql-reference/data-types/int-uint)

**戻り値**

計算されたハッシュ値を返します。[`UInt16`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT kostikConsistentHash(16045690984833335023, 2);
```

```response title=Response
┌─kostikConsistentHash(16045690984833335023, 2)─┐
│                                             1 │
└───────────────────────────────────────────────┘
```

## metroHash64 {#metroHash64}

導入バージョン: v1.1

64 ビットの [MetroHash](http://www.jandrewrogers.com/2015/05/27/metrohash/) ハッシュ値を生成します。

:::note
計算されるハッシュ値は、型が異なる引数であっても、同じ入力値に対して同一になる場合があります。
これは例えば、サイズの異なる整数型や、同一データを持つ名前付きおよび名前なしの `Tuple`、同一データを持つ `Map` と、それに対応する `Array(Tuple(key, value))` 型などに影響します。
:::

**構文**

```sql
metroHash64(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュを計算するための任意個の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数に対して計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT metroHash64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS MetroHash, toTypeName(MetroHash) AS type;
```

```response title=Response
┌────────────MetroHash─┬─type───┐
│ 14235658766382344533 │ UInt64 │
└──────────────────────┴────────┘
```

## murmurHash2&#95;32 {#murmurHash2&#95;32}

導入バージョン: v18.5

入力値に対して [MurmurHash2](https://github.com/aappleby/smhasher) ハッシュを計算します。

:::note
異なる引数型であっても、同じ入力値に対して計算されるハッシュ値が同一になる場合があります。
このことは、例えばサイズの異なる整数型、同一データを持つ名前付きおよび名前なしの `Tuple`、同一データを持つ `Map` と対応する `Array(Tuple(key, value))` 型などに影響します。
:::

**構文**

```sql
murmurHash2_32(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュ値を計算する可変個の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数に対して計算されたハッシュ値を返します。[`UInt32`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT murmurHash2_32(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS MurmurHash2, toTypeName(MurmurHash2) AS type;
```

```response title=Response
┌─MurmurHash2─┬─type───┐
│  3681770635 │ UInt32 │
└─────────────┴────────┘
```

## murmurHash2&#95;64 {#murmurHash2&#95;64}

導入バージョン: v18.10

入力値に対して [MurmurHash2](https://github.com/aappleby/smhasher) ハッシュを計算します。

:::note
同じ入力値に対しても、引数の型が異なる場合には、計算されるハッシュ値が同一になることがあります。
これは、たとえばサイズの異なる整数型、同じデータを持つ名前付きおよび名前なしの `Tuple`、同じデータを持つ `Map` とそれに対応する `Array(Tuple(key, value))` 型などが該当します。
:::

**構文**

```sql
murmurHash2_64(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュを計算する対象となる可変個の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数に対して計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT murmurHash2_64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS MurmurHash2, toTypeName(MurmurHash2) AS type;
```

```response title=Response
┌──────────MurmurHash2─┬─type───┐
│ 11832096901709403633 │ UInt64 │
└──────────────────────┴────────┘
```

## murmurHash3&#95;128 {#murmurHash3&#95;128}

導入バージョン: v18.10

入力値の 128 ビット [MurmurHash3](https://github.com/aappleby/smhasher) ハッシュ値を計算します。

**構文**

```sql
murmurHash3_128(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュを計算する対象となる可変個数の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数の 128 ビット `MurmurHash3` ハッシュ値を返します。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT hex(murmurHash3_128('foo', 'foo', 'foo'));
```

```response title=Response
┌─hex(murmurHash3_128('foo', 'foo', 'foo'))─┐
│ F8F7AD9B6CD4CF117A71E277E2EC2931          │
└───────────────────────────────────────────┘
```

## murmurHash3&#95;32 {#murmurHash3&#95;32}

導入: v18.10

[MurmurHash3](https://github.com/aappleby/smhasher) のハッシュ値を生成します。

:::note
計算されるハッシュ値は、引数の型が異なっていても、同じ入力値に対して同一になる場合があります。
例えば、サイズの異なる整数型、同一データを持つ名前付きおよび非名前付きの `Tuple`、同一データを持つ `Map` とそれに対応する `Array(Tuple(key, value))` 型などが該当します。
:::

**構文**

```sql
murmurHash3_32(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュ値を計算する対象となる可変個数の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数から計算されたハッシュ値を返します。[`UInt32`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT murmurHash3_32(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS MurmurHash3, toTypeName(MurmurHash3) AS type;
```

```response title=Response
┌─MurmurHash3─┬─type───┐
│     2152717 │ UInt32 │
└─────────────┴────────┘
```

## murmurHash3&#95;64 {#murmurHash3&#95;64}

導入: v18.10

入力値に対して [MurmurHash3](https://github.com/aappleby/smhasher) ハッシュを計算します。

:::note
同じ入力値であっても、引数の型が異なる場合に計算されるハッシュ値が同一になることがあります。
これは、たとえばサイズの異なる整数型、同じデータを持つ名前付き／名前なしの `Tuple`、同じデータを持つ `Map` 型および対応する `Array(Tuple(key, value))` 型などに該当します。
:::

**構文**

```sql
murmurHash3_64(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュ値を計算するための任意個数の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数に対して計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT murmurHash3_64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS MurmurHash3, toTypeName(MurmurHash3) AS type;
```

```response title=Response
┌──────────MurmurHash3─┬─type───┐
│ 11832096901709403633 │ UInt64 │
└──────────────────────┴────────┘
```

## ngramMinHash {#ngramMinHash}

導入バージョン: v21.1

ASCII 文字列を、`ngramsize` 個の文字からなる n-gram に分割し、各 n-gram のハッシュ値を計算して、それらのハッシュ値を要素とするタプルを返します。
`hashnum` 個の最小ハッシュを用いて最小ハッシュを計算し、`hashnum` 個の最大ハッシュを用いて最大ハッシュを計算します。
大文字と小文字は区別されます。

[`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) を使用して、類似した文字列を検出するために利用できます。
2 つの文字列に対して、返されるハッシュ値が両方の文字列で同じであれば、それらの文字列は同一です。

**構文**

```sql
ngramMinHash(string[, ngramsize, hashnum])
```

**引数**

* `string` — ハッシュ値を計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 省略可能。n-gram のサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可能。結果の計算に使用する最小ハッシュおよび最大ハッシュの個数。`1` から `25` までの任意の数値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

最小値と最大値、2 つのハッシュ値からなるタプルを返します。[`Tuple`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT ngramMinHash('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────┐
│ (18333312859352735453,9054248444481805918) │
└────────────────────────────────────────────┘
```

## ngramMinHashArg {#ngramMinHashArg}

導入バージョン: v21.1

ASCII 文字列を `ngramsize` 文字からなる N-グラムに分割し、同じ入力に対して [`ngramMinHash`](#ngramMinHash) 関数で計算されるハッシュ値のうち、最小値と最大値を持つ N-グラムを返します。
大文字と小文字を区別します。

**構文**

```sql
ngramMinHashArg(string[, ngramsize, hashnum])
```

**引数**

* `string` — ハッシュ値を計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 省略可。n-gram のサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可。結果を計算する際に使用される最小ハッシュ数および最大ハッシュ数。`1` から `25` までの任意の数値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

`hashnum` 個の n-gram を持つ 2 つのタプルから成るタプルを返します。[`Tuple(String)`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT ngramMinHashArg('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────────────┐
│ (('ous','ick','lic','Hou','kHo','use'),('Hou','lic','ick','ous','ckH','Cli')) │
└───────────────────────────────────────────────────────────────────────────────┘
```

## ngramMinHashArgCaseInsensitive {#ngramMinHashArgCaseInsensitive}

導入バージョン: v21.1

ASCII 文字列を `ngramsize` 文字からなる n-gram に分割し、同じ入力に対して [`ngramMinHashCaseInsensitive`](#ngramMinHashCaseInsensitive) 関数で計算される、ハッシュ値が最小の n-gram と最大の n-gram を返します。
大文字小文字は区別されません。

**構文**

```sql
ngramMinHashArgCaseInsensitive(string[, ngramsize, hashnum])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 省略可。n-グラムのサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可。結果の計算に使用される最小ハッシュおよび最大ハッシュの個数。`1` から `25` までの任意の数値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

`hashnum` 個の n-グラムを持つ 2 つのタプルから成るタプルを返します。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT ngramMinHashArgCaseInsensitive('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────────────┐
│ (('ous','ick','lic','kHo','use','Cli'),('kHo','lic','ick','ous','ckH','Hou')) │
└───────────────────────────────────────────────────────────────────────────────┘
```

## ngramMinHashArgCaseInsensitiveUTF8 {#ngramMinHashArgCaseInsensitiveUTF8}

導入バージョン: v21.1

UTF-8 文字列を、`ngramsize` 文字からなる n-gram に分割し、同じ入力に対して ngramMinHashCaseInsensitiveUTF8 関数で計算されるハッシュ値が最小および最大の n-gram を返します。
大文字と小文字は区別されません。

**構文**

```sql
ngramMinHashArgCaseInsensitiveUTF8(string[, ngramsize, hashnum])
```

**引数**

* `string` — ハッシュ値を計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 省略可。n-gram のサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可。結果を計算する際に使用する最小ハッシュおよび最大ハッシュの個数。`1` から `25` までの任意の数値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

それぞれに `hashnum` 個の n-gram を含む 2 つのタプルから成るタプルを返します。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT ngramMinHashArgCaseInsensitiveUTF8('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────────────┐
│ (('ckH','ous','ick','lic','kHo','use'),('kHo','lic','ick','ous','ckH','Hou')) │
└───────────────────────────────────────────────────────────────────────────────┘
```

## ngramMinHashArgUTF8 {#ngramMinHashArgUTF8}

導入バージョン: v21.1

UTF-8 文字列を `ngramsize` 文字から成る N グラムに分割し、同じ入力に対して `ngramMinHashUTF8` 関数で計算されるハッシュ値が最小および最大となる N グラムを返します。
大文字と小文字は区別されます。

**構文**

```sql
ngramMinHashArgUTF8(string[, ngramsize, hashnum])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 省略可。n-gram のサイズ。`1` から `25` までの任意の数値。デフォルトは `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可。結果の計算に使用される最小および最大ハッシュの数。`1` から `25` までの任意の数値。デフォルトは `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

`hashnum` 個の n-gram を持つ 2 つのタプルからなるタプルを返します。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT ngramMinHashArgUTF8('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────────────┐
│ (('ous','ick','lic','Hou','kHo','use'),('kHo','Hou','lic','ick','ous','ckH')) │
└───────────────────────────────────────────────────────────────────────────────┘
```

## ngramMinHashCaseInsensitive {#ngramMinHashCaseInsensitive}

導入バージョン: v21.1

ASCII文字列を `ngramsize` 文字の n-gram に分割し、各 n-gram のハッシュ値を計算して、それらのハッシュを含むタプルを返します。
`hashnum` 個の最小ハッシュを用いて最小ハッシュを計算し、`hashnum` 個の最大ハッシュを用いて最大ハッシュを計算します。
大文字小文字は区別しません。

[`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) を使って、準重複文字列を検出するために利用できます。
2 つの文字列に対して、返されるハッシュが両方の文字列で同じであれば、それらの文字列は同一とみなせます。

**構文**

```sql
ngramMinHashCaseInsensitive(string[, ngramsize, hashnum])
```

**引数**

* `string` — 文字列。[String](../data-types/string.md)。- `ngramsize` — n-gram のサイズ。省略可能。許容値: `1` から `25` までの任意の整数値。デフォルト値: `3`。[UInt8](../data-types/int-uint.md)。- `hashnum` — 結果を計算する際に使用する、最小ハッシュおよび最大ハッシュの数。省略可能。許容値: `1` から `25` までの任意の整数値。デフォルト値: `6`。[UInt8](../data-types/int-uint.md)。

**戻り値**

2 つのハッシュ（最小値と最大値）を含むタプル。[Tuple](../data-types/tuple.md)([UInt64](../data-types/int-uint.md), [UInt64](../data-types/int-uint.md))。[`Tuple`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT ngramMinHashCaseInsensitive('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────┐
│ (2106263556442004574,13203602793651726206) │
└────────────────────────────────────────────┘
```

## ngramMinHashCaseInsensitiveUTF8 {#ngramMinHashCaseInsensitiveUTF8}

導入バージョン: v21.1

UTF-8 文字列を `ngramsize` 個の文字からなる n-gram に分割し、それぞれの n-gram に対してハッシュ値を計算し、それらのハッシュを要素とするタプルを返します。
`hashnum` 個の最小ハッシュを使って最小ハッシュを計算し、`hashnum` 個の最大ハッシュを使って最大ハッシュを計算します。
大文字・小文字は区別しません。

[`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) を用いて、部分的に重複した（セミ重複）文字列を検出するために使用できます。
2 つの文字列に対して、返されるハッシュが同じであれば、それらの文字列は同一と見なされます。

**構文**

```sql
ngramMinHashCaseInsensitiveUTF8(文字列 [, nグラムサイズ, ハッシュ数])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 省略可能。N-gram のサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可能。結果の計算に使用するハッシュ値の最小個数および最大個数。`1` から `25` までの任意の数値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返される値**

最小値と最大値の 2 つのハッシュを要素として含むタプルを返します。[`Tuple`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT ngramMinHashCaseInsensitiveUTF8('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple───────────────────────────────────────┐
│ (12493625717655877135,13203602793651726206) │
└─────────────────────────────────────────────┘
```

## ngramMinHashUTF8 {#ngramMinHashUTF8}

導入バージョン: v21.1

UTF-8 文字列を `ngramsize` 文字の n-gram に分割し、各 n-gram のハッシュ値を計算して、それらのハッシュからなるタプルを返します。
`hashnum` 個の最小ハッシュ値を用いて最小ハッシュを計算し、`hashnum` 個の最大ハッシュ値を用いて最大ハッシュを計算します。
大文字と小文字は区別されます。

[`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) を使って、部分的に重複した文字列を検出するために使用できます。
2 つの文字列について、返されるハッシュが両方で同じであれば、それらの文字列は同一です。

**構文**

```sql
ngramMinHashUTF8(string[, ngramsize, hashnum])
```

**引数**

* `string` — ハッシュ値を計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 省略可能。N-gram のサイズ。`1` から `25` の任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可能。結果の計算に使用する最小および最大ハッシュの数。`1` から `25` の任意の数値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

2 つのハッシュ（最小値と最大値）を要素とするタプルを返します。[`Tuple`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT ngramMinHashUTF8('ClickHouse') AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────┐
│ (18333312859352735453,6742163577938632877) │
└────────────────────────────────────────────┘
```

## ngramSimHash {#ngramSimHash}

導入バージョン: v21.1

ASCII 文字列を、長さ `ngramsize` の記号からなる n-gram に分割し、その n-gram の `simhash` を返します。

[`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) と組み合わせて、部分的に重複した文字列の検出に使用できます。
2 つの文字列について計算された `simhashes` 間の[ハミング距離](https://en.wikipedia.org/wiki/Hamming_distance)が小さいほど、それらの文字列が同一である可能性が高くなります。

**構文**

```sql
ngramSimHash(string[, ngramsize])
```

**引数**

* `string` — 大文字・小文字を区別して `simhash` を計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 省略可能。n-gram のサイズで、`1` から `25` までの任意の数値。既定値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

入力文字列のハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT ngramSimHash('ClickHouse') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 1627567969 │
└────────────┘
```

## ngramSimHashCaseInsensitive {#ngramSimHashCaseInsensitive}

導入バージョン: v21.1

ASCII 文字列を、`ngramsize` 文字からなる n-gram に分割し、n-gram の `simhash` を返します。
大文字と小文字を区別しません。

[`bitHammingDistance`](/sql-reference/functions/bit-functions#bitHammingDistance) と組み合わせて、重複に近い文字列の検出に使用できます。
2 つの文字列について計算した `simhash` の[ハミング距離](https://en.wikipedia.org/wiki/Hamming_distance)が小さいほど、それらの文字列が同一である可能性が高くなります。

**構文**

```sql
ngramSimHashCaseInsensitive(string[, ngramsize])
```

**引数**

* `string` — 大文字小文字を区別せずに `simhash` を計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 省略可能。n-gram のサイズで、`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

ハッシュ値。[UInt64](../data-types/int-uint.md)。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT ngramSimHashCaseInsensitive('ClickHouse') AS Hash;
```

```response title=Response
┌──────Hash─┐
│ 562180645 │
└───────────┘
```

## ngramSimHashCaseInsensitiveUTF8 {#ngramSimHashCaseInsensitiveUTF8}

導入バージョン: v21.1

UTF-8 文字列を `ngramsize` 個の文字からなる n-gram に分割し、n-gram の `simhash` を返します。
大文字と小文字を区別しません。

[bitHammingDistance](../functions/bit-functions.md/#bitHammingDistance) と組み合わせて、重複度の高い文字列の検出に使用できます。2 つの文字列について計算された `simhash` 値同士の [Hamming Distance](https://en.wikipedia.org/wiki/Hamming_distance) が小さいほど、それらの文字列が同一である可能性が高くなります。

**構文**

```sql
ngramSimHashCaseInsensitiveUTF8(string[, ngramsize])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 省略可能。n-gram のサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT ngramSimHashCaseInsensitiveUTF8('ClickHouse') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 1636742693 │
└────────────┘
```

## ngramSimHashUTF8 {#ngramSimHashUTF8}

導入バージョン: v21.1

UTF-8 エンコードされた文字列を `ngramsize` 個の文字からなる n-gram に分割し、その n-gram の `simhash` を返します。
大文字と小文字を区別します。

[`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) と組み合わせて、部分的に重複した文字列の検出に使用できます。
2 つの文字列について計算された `simhashes` の[ハミング距離](https://en.wikipedia.org/wiki/Hamming_distance)が小さいほど、それらの文字列が同一である可能性が高くなります。

**構文**

```sql
ngramSimHashUTF8(string[, ngramsize])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `ngramsize` — 省略可能。n-gram のサイズで、`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT ngramSimHashUTF8('ClickHouse') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 1628157797 │
└────────────┘
```

## sipHash128 {#sipHash128}

導入バージョン: v1.1

[`sipHash64`](#sipHash64) に似ていますが、128 ビットのハッシュ値を生成します。つまり、最終的な XOR フォールディング処理が 128 ビットまで行われます。

:::tip 新規プロジェクトでは sipHash128Reference を使用する
この 128 ビット版はリファレンス実装と異なり、安全性がより低い実装です。
このバージョンが存在するのは、作成当時 SipHash の公式な 128 ビット拡張が存在しなかったためです。
新規プロジェクトでは [`sipHash128Reference`](#sipHash128Reference) の使用を推奨します。
:::

**構文**

```sql
sipHash128(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュを計算する任意個の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

128ビットの `SipHash` ハッシュ値を返します。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT hex(sipHash128('foo', '\x01', 3));
```

```response title=Response
┌─hex(sipHash128('foo', '', 3))────┐
│ 9DE516A64A414D4B1B609415E4523F24 │
└──────────────────────────────────┘
```

## sipHash128Keyed {#sipHash128Keyed}

導入バージョン: v23.2

[`sipHash128`](#sipHash128) と同じですが、固定キーを使う代わりに明示的なキー引数を追加で受け取ります。

:::tip 新しいプロジェクトでは sipHash128ReferenceKeyed を使用してください
この 128 ビット版はリファレンス実装とは異なり、より弱くなっています。
このバージョンが存在するのは、これが実装された当時、SipHash には公式な 128 ビット拡張が存在しなかったためです。
新しいプロジェクトでは [`sipHash128ReferenceKeyed`](#sipHash128ReferenceKeyed) の使用が推奨されます。
:::

**構文**

```sql
sipHash128Keyed((k0, k1), [arg1, arg2, ...])
```

**引数**

* `(k0, k1)` — キーを表す 2 つの UInt64 値からなるタプル。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)
* `arg1[, arg2, ...]` — ハッシュを計算するための任意個数の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

型 [FixedString(16)](../data-types/fixedstring.md) の 128 ビットの `SipHash` ハッシュ値。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT hex(sipHash128Keyed((506097522914230528, 1084818905618843912),'foo', '\x01', 3));
```

```response title=Response
┌─hex(sipHash128Keyed((506097522914230528, 1084818905618843912), 'foo', '', 3))─┐
│ B8467F65C8B4CFD9A5F8BD733917D9BF                                              │
└───────────────────────────────────────────────────────────────────────────────┘
```

## sipHash128Reference {#sipHash128Reference}

導入バージョン: v23.2

[`sipHash128`](/sql-reference/functions/hash-functions#sipHash128) と同様ですが、SipHash の原著者による 128 ビットアルゴリズムを実装しています。

**構文**

```sql
sipHash128Reference(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — ハッシュを計算する対象となる可変個の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数に対して計算された 128 ビットの `SipHash` ハッシュ値を返します。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT hex(sipHash128Reference('foo', '', 3));
```

```response title=Response
┌─hex(sipHash128Reference('foo', '', 3))─┐
│ 4D1BE1A22D7F5933C0873E1698426260       │
└────────────────────────────────────────┘
```

## sipHash128ReferenceKeyed {#sipHash128ReferenceKeyed}

導入バージョン: v23.2

[`sipHash128Reference`](#sipHash128Reference) と同様ですが、固定キーを使用する代わりに、明示的なキー引数を取ります。

**構文**

```sql
sipHash128ReferenceKeyed((k0, k1), arg1[, arg2, ...])
```

**引数**

* `(k0, k1)` — キーを表す 2 つの値からなるタプル。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)
* `arg1[, arg2, ...]` — ハッシュを計算する対象となる可変個数の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数に対して計算された 128 ビットの `SipHash` ハッシュ値を返します。[`FixedString(16)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT hex(sipHash128Reference('foo', '', 3));
```

```response title=Response
┌─hex(sipHash128Reference('foo', '', 3))─┐
│ 4D1BE1A22D7F5933C0873E1698426260       │
└────────────────────────────────────────┘
```

## sipHash64 {#sipHash64}

導入バージョン: v1.1

64 ビットの [SipHash](https://en.wikipedia.org/wiki/SipHash) ハッシュ値を生成します。

これは暗号学的ハッシュ関数です。[`MD5`](#MD5) ハッシュ関数より少なくとも 3 倍高速で動作します。

この関数は、すべての入力パラメータを文字列として[解釈](/sql-reference/functions/type-conversion-functions#reinterpretasstring)し、それぞれについてハッシュ値を計算します。
その後、以下のアルゴリズムでそれらのハッシュ値を結合します:

1. 1 番目と 2 番目のハッシュ値を連結して配列を作成し、それをハッシュします。
2. 直前に計算したハッシュ値と 3 番目の入力パラメータのハッシュ値を、同様の方法でハッシュします。
3. この計算を、元の入力に対応する残りすべてのハッシュ値に対して繰り返します。

:::note
同じ入力値でも、引数の型が異なる場合には、計算されるハッシュ値が同一になることがあります。
これは、たとえばサイズの異なる整数型、同じデータを持つ名前付きおよび名前なしの `Tuple`、同じデータを持つ `Map` と、それに対応する `Array(Tuple(key, value))` 型などに影響します。
:::

**構文**

```sql
sipHash64(arg1[, arg2, ...])
```

**引数**

* `arg1[, arg2, ...]` — 可変個数の入力引数。[`Any`](/sql-reference/data-types)

**戻り値**

入力引数に対して計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT sipHash64(array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS SipHash, toTypeName(SipHash) AS type;
```

```response title=Response
┌──────────────SipHash─┬─type───┐
│ 11400366955626497465 │ UInt64 │
└──────────────────────┴────────┘
```

## sipHash64Keyed {#sipHash64Keyed}

導入バージョン: v23.2

[`sipHash64`](#sipHash64) と同様ですが、固定キーではなく、明示的に指定したキー引数を取ります。

**構文**

```sql
sipHash64Keyed((k0, k1), arg1[,arg2, ...])
```

**引数**

* `(k0, k1)` — キーを表す 2 つの値のタプル。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)
* `arg1[,arg2, ...]` — 可変個の入力引数。[`Any`](/sql-reference/data-types)

**返り値**

入力値から計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT sipHash64Keyed((506097522914230528, 1084818905618843912), array('e','x','a'), 'mple', 10, toDateTime('2019-06-15 23:00:00')) AS SipHash, toTypeName(SipHash) AS type;
```

```response title=Response
┌─────────────SipHash─┬─type───┐
│ 8017656310194184311 │ UInt64 │
└─────────────────────┴────────┘
```

## wordShingleMinHash {#wordShingleMinHash}

導入バージョン: v21.1

ASCII 文字列を `shinglesize` 語からなる部分列（シングル）に分割し、各シングルごとにハッシュ値を計算して、それらのハッシュを要素とするタプルを返します。
最小ハッシュの計算には `hashnum` 個の最小ハッシュを、最大ハッシュの計算には `hashnum` 個の最大ハッシュを使用します。
大文字と小文字は区別されます。

[`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) を使って、準重複文字列を検出するために利用できます。
2 つの文字列に対して、返されるハッシュが両方の文字列で同じであれば、それらの文字列は同一であるとみなせます。

**構文**

```sql
wordShingleMinHash(string[, shinglesize, hashnum])
```

**引数**

* `string` — ハッシュ値を計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 省略可能。ワードシングル（shingle）のサイズ。`1` から `25` の範囲の任意の整数。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可能。結果の計算に使用される最小ハッシュ値および最大ハッシュ値の数。`1` から `25` の範囲の任意の整数。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

2 つのハッシュ値（最小値と最大値）を要素とするタプルを返します。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT wordShingleMinHash('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).') AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────┐
│ (16452112859864147620,5844417301642981317) │
└────────────────────────────────────────────┘
```

## wordShingleMinHashArg {#wordShingleMinHashArg}

導入バージョン: v1.1

ASCII 文字列を `shinglesize` 語ごとの部分（シングル）に分割し、同じ入力を用いて wordShingleMinHash 関数で計算される単語ハッシュの最小値および最大値を持つシングルを返します。
ケースセンシティブです。

**構文**

```sql
wordShingleMinHashArg(string[, shinglesize, hashnum])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 省略可能。ワードシングル（word shingle）のサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可能。結果の計算に使用する最小ハッシュと最大ハッシュの個数。`1` から `25` までの任意の数値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

`hashnum` 個のワードシングルを含む 2 つのタプルからなるタプルを返します。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT wordShingleMinHashArg('ClickHouse®は、オンライン分析処理（OLAP）のための列指向データベース管理システム（DBMS）です。', 1, 3) AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────┐
│ (('OLAP','database','analytical'),('online','oriented','processing')) │
└───────────────────────────────────────────────────────────────────────┘
```

## wordShingleMinHashArgCaseInsensitive {#wordShingleMinHashArgCaseInsensitive}

導入バージョン: v21.1

ASCII文字列を、`shinglesize` 個の単語からなる部分（シングル）に分割し、同じ入力に対して [`wordShingleMinHashCaseInsensitive`](#wordShingleMinHashCaseInsensitive) 関数で計算される、単語ハッシュが最小および最大となるシングルを返します。
大文字と小文字は区別されません。

**構文**

```sql
wordShingleMinHashArgCaseInsensitive(string[, shinglesize, hashnum])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 省略可能。ワードシングルのサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可能。結果の計算に使用される最小ハッシュ値および最大ハッシュ値の個数。`1` から `25` までの任意の数値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

`hashnum` 個のワードシングルをそれぞれ含む 2 つのタプルからなるタプルを返します。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT wordShingleMinHashArgCaseInsensitive('ClickHouse®は、オンライン分析処理（OLAP）のためのカラム指向データベース管理システム（DBMS）です。', 1, 3) AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────────────────────────────────┐
│ (('queries','database','analytical'),('oriented','processing','DBMS')) │
└────────────────────────────────────────────────────────────────────────┘
```

## wordShingleMinHashArgCaseInsensitiveUTF8 {#wordShingleMinHashArgCaseInsensitiveUTF8}

導入バージョン: v21.1

UTF-8 文字列を `shinglesize` 語ずつの部分（シングル）に分割し、同じ入力に対して [`wordShingleMinHashCaseInsensitiveUTF8`](#wordShingleMinHashCaseInsensitiveUTF8) 関数で計算される単語ハッシュの最小値および最大値に対応するシングルを返します。
大文字小文字は区別されません。

**構文**

```sql
wordShingleMinHashArgCaseInsensitiveUTF8(string[, shinglesize, hashnum])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 省略可。ワードシングル（shingle）のサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可。結果の計算に使用される最小および最大ハッシュの個数。`1` から `25` までの任意の数値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

それぞれが `hashnum` 個のワードシングルを持つ 2 つのタプルから構成されるタプルを返します。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT wordShingleMinHashArgCaseInsensitiveUTF8('ClickHouse®は、オンライン分析処理（OLAP）のためのカラム指向データベース管理システム（DBMS）です。', 1, 3) AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────────────────────────────────┐
│ (('queries','database','analytical'),('oriented','processing','DBMS')) │
└────────────────────────────────────────────────────────────────────────┘
```

## wordShingleMinHashArgUTF8 {#wordShingleMinHashArgUTF8}

導入バージョン: v21.1

UTF-8 文字列を `shinglesize` 語ごとの部分（shingle）に分割し、同じ入力に対して [`wordShingleMinHashUTF8`](#wordShingleMinHashUTF8) 関数で計算される、単語ハッシュ値が最小および最大の shingle を返します。
大文字と小文字は区別されます。

**構文**

```sql
wordShingleMinHashArgUTF8(string[, shinglesize, hashnum])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 省略可。ワードシングル（shingle）のサイズ。`1` から `25` までの任意の値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可。結果の計算に使用される最小ハッシュおよび最大ハッシュの個数。`1` から `25` までの任意の値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

`hashnum` 個のワードシングルをそれぞれ含む 2 つのタプルから成るタプルを返します。[`Tuple(Tuple(String))`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT wordShingleMinHashArgUTF8('ClickHouse®は、オンライン分析処理(OLAP)のための列指向データベース管理システム(DBMS)です。', 1, 3) AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────────────────────────────────┐
│ (('OLAP','database','analytical'),('online','oriented','processing')) │
└───────────────────────────────────────────────────────────────────────┘
```

## wordShingleMinHashCaseInsensitive {#wordShingleMinHashCaseInsensitive}

導入バージョン: v21.1

ASCII 文字列を `shinglesize` 語からなる部分（シングル）に分割し、各ワードシングルのハッシュ値を計算して、そのハッシュを要素とするタプルを返します。
`hashnum` 個の最小ハッシュを使用して最小ハッシュを計算し、`hashnum` 個の最大ハッシュを使用して最大ハッシュを計算します。
大文字小文字は区別されません。

[`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) と組み合わせて、準重複文字列を検出するために利用できます。
2つの文字列について、返されるハッシュ値が両方の文字列で同じであれば、それらの文字列は同一であると見なせます。

**構文**

```sql
wordShingleMinHashCaseInsensitive(string[, shinglesize, hashnum])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — オプション。ワードシングル（shingle）のサイズ。`1` から `25` までの任意の値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — オプション。結果を計算するために使用される最小ハッシュと最大ハッシュの数。`1` から `25` までの任意の値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**返される値**

2 つのハッシュ（最小値と最大値）を要素に持つタプルを返します。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT wordShingleMinHashCaseInsensitive('ClickHouse® is a column-oriented database management system (DBMS) for online analytical processing of queries (OLAP).') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────┐
│ (3065874883688416519,1634050779997673240) │
└───────────────────────────────────────────┘
```

## wordShingleMinHashCaseInsensitiveUTF8 {#wordShingleMinHashCaseInsensitiveUTF8}

導入バージョン: v21.1

UTF-8 文字列を `shinglesize` 語からなるシングル（shingle）に分割し、各シングルのハッシュ値を計算して、そのハッシュを要素とするタプルを返します。
最小ハッシュ値を計算するために `hashnum` 個のハッシュを、最大ハッシュ値を計算するために `hashnum` 個のハッシュを使用します。
大文字小文字は区別しません。

[`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) を使って、類似した文字列を検出するために使用できます。
2 つの文字列に対して、返されるハッシュが両方で同じであれば、その文字列は同一であるとみなせます。

**構文**

```sql
wordShingleMinHashCaseInsensitiveUTF8(string[, shinglesize, hashnum])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 省略可。ワードシングル（shingle）のサイズ。`1` から `25` までの任意の整数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可。結果を計算するために使用される最小ハッシュおよび最大ハッシュの個数。`1` から `25` までの任意の整数値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

最小値と最大値の 2 つのハッシュを要素とするタプルを返します。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT wordShingleMinHashCaseInsensitiveUTF8('ClickHouse®は、オンライン分析処理（OLAP）のためのカラム指向データベース管理システム（DBMS）です。') AS Tuple;
```

```response title=Response
┌─Tuple─────────────────────────────────────┐
│ (3065874883688416519,1634050779997673240) │
└───────────────────────────────────────────┘
```

## wordShingleMinHashUTF8 {#wordShingleMinHashUTF8}

導入バージョン: v21.1

UTF-8 文字列を、`shinglesize` 個の単語から成る部分列（シングル, shingle）に分割し、各単語シングルのハッシュ値を計算して、これらのハッシュを要素とするタプルを返します。
`hashnum` 個の最小ハッシュを使って最小ハッシュを計算し、`hashnum` 個の最大ハッシュを使って最大ハッシュを計算します。
大文字と小文字は区別されます。

[`tupleHammingDistance`](../functions/tuple-functions.md#tupleHammingDistance) を用いて準重複文字列を検出するために利用できます。
2 つの文字列に対して、返されるハッシュが両方の文字列で同じであれば、それらの文字列は同一とみなされます。

**構文**

```sql
wordShingleMinHashUTF8(string[, shinglesize, hashnum])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 省略可。単語シングル（shingle）のサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)
* `hashnum` — 省略可。結果の計算に使用する最小ハッシュと最大ハッシュの数。`1` から `25` までの任意の数値。デフォルト値は `6`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

2 つのハッシュ（最小値と最大値）を含むタプルを返します。[`Tuple(UInt64, UInt64)`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT wordShingleMinHashUTF8('ClickHouse®は、オンライン分析処理(OLAP)のためのカラム指向データベース管理システム(DBMS)です。') AS Tuple;
```

```response title=Response
┌─Tuple──────────────────────────────────────┐
│ (16452112859864147620,5844417301642981317) │
└────────────────────────────────────────────┘
```

## wordShingleSimHash {#wordShingleSimHash}

導入バージョン: v21.1

ASCII 文字列を `shinglesize` 語から成る部分（ワードシングル）に分割し、そのワードシングルの `simhash` を返します。
大文字と小文字は区別されます。

[`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) と組み合わせて、部分的に重複した文字列の検出に使用できます。
2 つの文字列について計算された `simhashes` の[ハミング距離](https://en.wikipedia.org/wiki/Hamming_distance)が小さいほど、これらの文字列が同一または非常に類似している可能性が高くなります。

**構文**

```sql
wordShingleSimHash(string[, shinglesize])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 省略可。ワードシングル（連続する単語列）のサイズ。`1` から `25` の任意の数値。既定値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT wordShingleSimHash('ClickHouse®は、オンライン分析処理(OLAP)のための列指向データベース管理システム(DBMS)です。') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 2328277067 │
└────────────┘
```

## wordShingleSimHashCaseInsensitive {#wordShingleSimHashCaseInsensitive}

導入バージョン: v21.1

ASCII 文字列を `shinglesize` 語からなる部分文字列（シングル）に分割し、その単語シングルの `simhash` を返します。
大文字小文字は区別されません。

[`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) を用いた、ほぼ重複した文字列の検出に使用できます。
2 つの文字列について計算された `simhash` 同士の[ハミング距離](https://en.wikipedia.org/wiki/Hamming_distance)が小さいほど、それらの文字列が同一である可能性が高くなります。

**構文**

```sql
wordShingleSimHashCaseInsensitive(string[, shinglesize])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 省略可能。ワードシングル（shingle）のサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT wordShingleSimHashCaseInsensitive('ClickHouse®は、オンライン分析処理(OLAP)クエリのためのカラム指向データベース管理システム(DBMS)です。') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 2194812424 │
└────────────┘
```

## wordShingleSimHashCaseInsensitiveUTF8 {#wordShingleSimHashCaseInsensitiveUTF8}

導入バージョン: v1.1

UTF-8 エンコードされた文字列を、`shinglesize` 語から成るシングル（shingle）に分割し、その単語シングルの `simhash` を返します。
大文字・小文字は区別されません。

[`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) を使用して、類似した重複文字列の検出に利用できます。
2 つの文字列から計算された `simhashes` の [ハミング距離](https://en.wikipedia.org/wiki/Hamming_distance) が小さいほど、それらの文字列が同じである可能性が高くなります。

**構文**

```sql
wordShingleSimHashCaseInsensitiveUTF8(string[, shinglesize])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 省略可能。ワードシングル（shingle）のサイズ。`1` から `25` までの任意の整数。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**返り値**

計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT wordShingleSimHashCaseInsensitiveUTF8('ClickHouse®は、オンライン分析処理(OLAP)のためのカラム指向データベース管理システム(DBMS)です。') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 2194812424 │
└────────────┘
```

## wordShingleSimHashUTF8 {#wordShingleSimHashUTF8}

導入バージョン: v21.1

UTF-8 文字列を、`shinglesize` 語から成る連続した部分列（シングル、shingle）に分割し、語シングル（word shingle）の `simhash` 値を返します。
大文字と小文字を区別します。

[`bitHammingDistance`](../functions/bit-functions.md/#bitHammingDistance) と組み合わせて、近似重複文字列を検出するために使用できます。
2 つの文字列について計算された `simhash` 値の[ハミング距離](https://en.wikipedia.org/wiki/Hamming_distance)が小さいほど、それらの文字列が同一である可能性が高くなります。

**構文**

```sql
wordShingleSimHashUTF8(string[, shinglesize])
```

**引数**

* `string` — ハッシュを計算する対象の文字列。[`String`](/sql-reference/data-types/string)
* `shinglesize` — 省略可能。単語シングル（shingle）のサイズ。`1` から `25` までの任意の数値。デフォルト値は `3`。[`UInt8`](/sql-reference/data-types/int-uint)

**戻り値**

計算されたハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT wordShingleSimHashUTF8('ClickHouse®は、オンライン分析処理(OLAP)のための列指向データベース管理システム(DBMS)です。') AS Hash;
```

```response title=Response
┌───────Hash─┐
│ 2328277067 │
└────────────┘
```

## wyHash64 {#wyHash64}

導入バージョン: v22.7

64ビットの [wyHash64](https://github.com/wangyi-fudan/wyhash) ハッシュ値を計算します。

**構文**

```sql
wyHash64(arg)
```

**引数**

* `arg` — ハッシュを計算する対象となる文字列引数。[`String`](/sql-reference/data-types/string)

**戻り値**

計算された 64 ビットのハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT wyHash64('ClickHouse') AS Hash;
```

```response title=Response
12336419557878201794
```

## xxHash32 {#xxHash32}

導入バージョン: v20.1

文字列に対する [xxHash](http://cyan4973.github.io/xxHash/) を計算します。

64ビット版については [`xxHash64`](#xxHash64) を参照してください。

**構文**

```sql
xxHash32(arg)
```

**引数**

* `arg` — ハッシュ化する対象の入力文字列。[`String`](/sql-reference/data-types/string)

**返り値**

入力文字列の 32 ビットハッシュ値を返します。[`UInt32`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT xxHash32('Hello, world!');
```

```response title=Response
┌─xxHash32('Hello, world!')─┐
│                 834093149 │
└───────────────────────────┘
```

## xxHash64 {#xxHash64}

導入: v20.1

文字列に対する [xxHash](http://cyan4973.github.io/xxHash/) を計算します。

32 ビット版については [`xxHash32`](#xxHash32) を参照してください。

**構文**

```sql
xxHash64(arg)
```

**引数**

* `arg` — ハッシュ化する入力文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

入力文字列に対して計算された 64 ビットのハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT xxHash64('Hello, world!');
```

```response title=Response
┌─xxHash64('Hello, world!')─┐
│      17691043854468224118 │
└───────────────────────────┘
```

## xxh3 {#xxh3}

導入バージョン: v22.12

[XXH3](https://github.com/Cyan4973/xxHash) の 64 ビットハッシュ値を計算します。

**構文**

```sql
xxh3(expr)
```

**引数**

* `expr` — 任意のデータ型の式からなるリスト。[`Any`](/sql-reference/data-types)

**戻り値**

計算された64ビットの `xxh3` ハッシュ値を返します。[`UInt64`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT xxh3('ClickHouse')
```

```response title=Response
18009318874338624809
```

{/*AUTOGENERATED_END*/ }
