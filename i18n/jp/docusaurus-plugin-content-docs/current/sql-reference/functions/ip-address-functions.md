---
'description': 'IPv4およびIPv6アドレスを扱うために使用される関数に関するドキュメント。'
'sidebar_label': 'IPアドレス'
'slug': '/sql-reference/functions/ip-address-functions'
'title': 'IPv4およびIPv6アドレスに関する関数'
'doc_type': 'reference'
---


# IPv4およびIPv6アドレスを処理するための関数

<!-- 
The inner content of the tags below are replaced at doc framework build time with 
docs generated from system.functions. Please do not modify or remove the tags.
See: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
-->

<!--AUTOGENERATED_START-->
## IPv4CIDRToRange {#IPv4CIDRToRange}

Introduced in: v20.1


CIDRプレフィックス長を持つIPv4アドレスを取得し、そのサブネットのアドレス範囲を最初と最後のアドレスのタプルとして返します。
IPv6バージョンについては、[`IPv6CIDRToRange`](#IPv4CIDRToRange)を参照してください。
    

**構文**

```sql
IPv4CIDRToRange(ipv4, cidr)
```

**引数**

- `ipv4` — IPv4アドレス。 [`IPv4`](/sql-reference/data-types/ipv4) または [`String`](/sql-reference/data-types/string)
- `cidr` — CIDR値。 [`UInt8`](/sql-reference/data-types/int-uint)


**戻り値**

サブネット範囲を表す2つのIPv4アドレスのタプルを返します。 [`Tuple(IPv4, IPv4)`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT IPv4CIDRToRange(toIPv4('192.168.5.2'), 16);
```

```response title=Response
┌─IPv4CIDRToRange(toIPv4('192.168.5.2'), 16)─┐
│ ('192.168.0.0','192.168.255.255')          │
└────────────────────────────────────────────┘
```



## IPv4NumToString {#IPv4NumToString}

Introduced in: v1.1


32ビット整数をドット十進法表現（A.B.C.D形式）のIPv4アドレス文字列に変換します。
入力はビッグエンディアンのバイトオ orderingを使用して解釈されます。
    

**構文**

```sql
IPv4NumToString(num)
```

**引数**

- `num` — IPv4アドレスを表すUInt32数値。 [`UInt32`](/sql-reference/data-types/int-uint)


**戻り値**

MACアドレスを表す数値を返すか、フォーマットが無効な場合は`0`を返します。 [`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
IPv4NumToString(3232235521)
```

```response title=Response
192.168.0.1
```



## IPv4NumToStringClassC {#IPv4NumToStringClassC}

Introduced in: v1.1


32ビット整数をドット十進法表現（A.B.C.D形式）のIPv4アドレス文字列に変換します。
[`IPv4NumToString`](#IPv4NumToString)と似ていますが、最後のオクテットの代わりに`xxx`を使用します。
    

**構文**

```sql
IPv4NumToStringClassC(num)
```

**引数**

- `num` — IPv4アドレスを表すUInt32数値。 [`UInt32`](/sql-reference/data-types/int-uint)


**戻り値**

最後のオクテットがxxxのIPv4アドレス文字列を返します。 [`String`](/sql-reference/data-types/string)

**例**

**集計を伴う基本的な例**

```sql title=Query
SELECT
    IPv4NumToStringClassC(ClientIP) AS k,
    count() AS c
FROM test.hits
GROUP BY k
ORDER BY c DESC
LIMIT 10
```

```response title=Response
┌─k──────────────┬─────c─┐
│ 83.149.9.xxx   │ 26238 │
│ 217.118.81.xxx │ 26074 │
│ 213.87.129.xxx │ 25481 │
│ 83.149.8.xxx   │ 24984 │
│ 217.118.83.xxx │ 22797 │
│ 78.25.120.xxx  │ 22354 │
│ 213.87.131.xxx │ 21285 │
│ 78.25.121.xxx  │ 20887 │
│ 188.162.65.xxx │ 19694 │
│ 83.149.48.xxx  │ 17406 │
└────────────────┴───────┘
```



## IPv4StringToNum {#IPv4StringToNum}

Introduced in: v1.1


ドット十進法表現（A.B.C.D形式）のIPv4アドレス文字列を対応する32ビット整数表現に変換します。（これは[`IPv4NumToString`](#IPv4NumToString)の逆です）。
IPv4アドレスのフォーマットが無効な場合は、例外がスローされます。
    

**構文**

```sql
IPv4StringToNum(string)
```

**引数**

- `string` — IPv4アドレス文字列。 [`String`](/sql-reference/data-types/string)


**戻り値**

IPv4アドレスを返します。 [`UInt32`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
IPv4StringToNum('192.168.0.1')
```

```response title=Response
3232235521
```



## IPv4StringToNumOrDefault {#IPv4StringToNumOrDefault}

Introduced in: v22.3


ドット十進法表現（A.B.C.D形式）のIPv4アドレス文字列を対応する32ビット整数表現に変換しますが、IPv4アドレスのフォーマットが無効な場合は`0`を返します。
    

**構文**

```sql
IPv4StringToNumOrDefault(string)
```

**引数**

- `string` — IPv4アドレス文字列。 [`String`](/sql-reference/data-types/string)


**戻り値**

IPv4アドレスを返すか、無効な場合は`0`を返します。 [`UInt32`](/sql-reference/data-types/int-uint)

**例**

**無効なアドレスの例**

```sql title=Query
SELECT
    IPv4StringToNumOrDefault('127.0.0.1') AS valid,
    IPv4StringToNumOrDefault('invalid') AS invalid;
```

```response title=Response
┌──────valid─┬─invalid─┐
│ 2130706433 │       0 │
└────────────┴─────────┘
```



## IPv4StringToNumOrNull {#IPv4StringToNumOrNull}

Introduced in: v22.3


32ビット整数をドット十進法表現（A.B.C.D形式）のIPv4アドレス文字列に変換しますが、IPv4アドレスのフォーマットが無効な場合は`NULL`を返します。
    

**構文**

```sql
IPv4StringToNumOrNull(string)
```

**引数**

- `string` — IPv4アドレス文字列。 [`String`](/sql-reference/data-types/string)


**戻り値**

IPv4アドレスを返すか、無効な場合は`NULL`を返します。 [`Nullable(UInt32)`](/sql-reference/data-types/nullable)

**例**

**無効なアドレスの例**

```sql title=Query
SELECT
IPv4StringToNumOrNull('127.0.0.1') AS valid,
IPv4StringToNumOrNull('invalid') AS invalid;
```

```response title=Response
┌──────valid─┬─invalid─┐
│ 2130706433 │    ᴺᵁᴸᴸ │
└────────────┴─────────┘
```



## IPv4ToIPv6 {#IPv4ToIPv6}

Introduced in: v1.1


（ビッグエンディアンの）32ビット数値をIPv4アドレスとして解釈し、それを`FixedString(16)`形式で対応するIPv6アドレスとして解釈します。
    

**構文**

```sql
IPv4ToIPv6(x)
```

**引数**

- `x` — IPv4アドレス。 [`UInt32`](/sql-reference/data-types/int-uint)


**戻り値**

バイナリ形式のIPv6アドレスを返します。 [`FixedString(16)`](/sql-reference/data-types/fixedstring)

**例**

**使用例**

```sql title=Query
SELECT IPv6NumToString(IPv4ToIPv6(IPv4StringToNum('192.168.0.1'))) AS addr;
```

```response title=Response
┌─addr───────────────┐
│ ::ffff:192.168.0.1 │
└────────────────────┘
```



## IPv6CIDRToRange {#IPv6CIDRToRange}

Introduced in: v20.1


CIDRプレフィックス長を持つIPv6アドレスを取得し、そのサブネットのアドレス範囲を最小アドレスと最大アドレスのタプルとして返します。
IPv4バージョンについては、[`IPv4CIDRToRange`](#IPv4CIDRToRange)を参照してください。
    

**構文**

```sql
IPv6CIDRToRange(ipv6, cidr)
```

**引数**

- `ipv6` — IPv6アドレス。 [`IPv6`](/sql-reference/data-types/ipv6) または [`String`](/sql-reference/data-types/string)
- `cidr` — CIDR値。 [`UInt8`](/sql-reference/data-types/int-uint)


**戻り値**

サブネット範囲を表す2つのIPv6アドレスのタプルを返します。 [`Tuple(IPv6, IPv6)`](/sql-reference/data-types/tuple)

**例**

**使用例**

```sql title=Query
SELECT IPv6CIDRToRange(toIPv6('2001:0db8:0000:85a3:0000:0000:ac1f:8001'), 32);
```

```response title=Response
┌─IPv6CIDRToRange(toIPv6('2001:0db8:0000:85a3:0000:0000:ac1f:8001'), 32)─┐
│ ('2001:db8::','2001:db8:ffff:ffff:ffff:ffff:ffff:ffff')                │
└────────────────────────────────────────────────────────────────────────┘
```



## IPv6NumToString {#IPv6NumToString}

Introduced in: v1.1


バイナリ形式（FixedString(16)）のIPv6アドレスを標準テキスト表現に変換します。
IPv4埋め込みのIPv6アドレスは、`::ffff:111.222.33.44`形式で表示されます。
    

**構文**

```sql
IPv6NumToString(x)
```

**引数**

- `x` — バイナリ形式のIPv6アドレス。 [`FixedString(16)`](/sql-reference/data-types/fixedstring) または [`IPv6`](/sql-reference/data-types/ipv6)


**戻り値**

テキスト形式のIPv6アドレス文字列を返します。 [`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT IPv6NumToString(toFixedString(unhex('2A0206B8000000000000000000000011'), 16)) AS addr;
```

```response title=Response
┌─addr─────────┐
│ 2a02:6b8::11 │
└──────────────┘
```

**ヒット分析を伴うIPv6**

```sql title=Query
SELECT
    IPv6NumToString(ClientIP6 AS k),
    count() AS c
FROM hits_all
WHERE EventDate = today() AND substring(ClientIP6, 1, 12) != unhex('00000000000000000000FFFF')
GROUP BY k
ORDER BY c DESC
LIMIT 10
```

```response title=Response
┌─IPv6NumToString(ClientIP6)──────────────┬─────c─┐
│ 2a02:2168:aaa:bbbb::2                   │ 24695 │
│ 2a02:2698:abcd:abcd:abcd:abcd:8888:5555 │ 22408 │
│ 2a02:6b8:0:fff::ff                      │ 16389 │
│ 2a01:4f8:111:6666::2                    │ 16016 │
│ 2a02:2168:888:222::1                    │ 15896 │
│ 2a01:7e00::ffff:ffff:ffff:222           │ 14774 │
│ 2a02:8109:eee:ee:eeee:eeee:eeee:eeee    │ 14443 │
│ 2a02:810b:8888:888:8888:8888:8888:8888  │ 14345 │
│ 2a02:6b8:0:444:4444:4444:4444:4444      │ 14279 │
│ 2a01:7e00::ffff:ffff:ffff:ffff          │ 13880 │
└─────────────────────────────────────────┴───────┘
```

**IPv4埋め込みIPv6アドレス**

```sql title=Query
SELECT
    IPv6NumToString(ClientIP6 AS k),
    count() AS c
FROM hits_all
WHERE EventDate = today()
GROUP BY k
ORDER BY c DESC
LIMIT 10
```

```response title=Response
┌─IPv6NumToString(ClientIP6)─┬──────c─┐
│ ::ffff:94.26.111.111       │ 747440 │
│ ::ffff:37.143.222.4        │ 529483 │
│ ::ffff:5.166.111.99        │ 317707 │
│ ::ffff:46.38.11.77         │ 263086 │
│ ::ffff:79.105.111.111      │ 186611 │
│ ::ffff:93.92.111.88        │ 176773 │
│ ::ffff:84.53.111.33        │ 158709 │
│ ::ffff:217.118.11.22       │ 154004 │
│ ::ffff:217.118.11.33       │ 148449 │
│ ::ffff:217.118.11.44       │ 148243 │
└────────────────────────────┴────────┘
```



## IPv6StringToNum {#IPv6StringToNum}

Introduced in: v1.1


一般的なテキスト表現からバイナリ形式（`FixedString(16)`）にIPv6アドレスを変換します。
IPv4埋め込みIPv6アドレスを`::ffff:111.222.33.44.`形式で受け入れます。
IPv6アドレスのフォーマットが無効な場合は、例外がスローされます。

入力文字列に有効なIPv4アドレスが含まれている場合、そのIPv6の同等物が返されます。
HEXは大文字または小文字が使用できます。
    

**構文**

```sql
IPv6StringToNum(string)
```

**引数**

- `string` — IPv6アドレス文字列。 [`String`](/sql-reference/data-types/string)


**戻り値**

バイナリ形式のIPv6アドレスを返します。 [`FixedString(16)`](/sql-reference/data-types/fixedstring)

**例**

**基本的な例**

```sql title=Query
SELECT addr, cutIPv6(IPv6StringToNum(addr), 0, 0) FROM (SELECT ['notaddress', '127.0.0.1', '1111::ffff'] AS addr) ARRAY JOIN addr;
```

```response title=Response
┌─addr───────┬─cutIPv6(IPv6StringToNum(addr), 0, 0)─┐
│ notaddress │ ::                                   │
│ 127.0.0.1  │ ::ffff:127.0.0.1                     │
│ 1111::ffff │ 1111::ffff                           │
└────────────┴──────────────────────────────────────┘
```



## IPv6StringToNumOrDefault {#IPv6StringToNumOrDefault}

Introduced in: v22.3


一般的なテキスト表現からバイナリ形式（`FixedString(16)`）にIPv6アドレスを変換します。
IPv4埋め込みIPv6アドレスを`::ffff:111.222.33.44.`形式で受け入れます。
IPv6アドレスのフォーマットが無効な場合は、デフォルト値`::`を返します（0 IPv6）または指定されたIPv6デフォルトを返します。
    

**構文**

```sql
IPv6StringToNumOrDefault(string)
```

**引数**

- `string` — 変換するIPアドレス文字列。 - `default` — オプション。文字列が無効な形式の場合に返す値。 

**戻り値**

IPv6アドレスを返します。無効な場合は`::`または提供されたオプションのデフォルトを返します。 [`IPv6`](/sql-reference/data-types/ipv6)

**例**

**有効なIPv6文字列と無効なIPv6文字列**

```sql title=Query
WITH
    '2001:0db8:85a3:0000:0000:8a2e:0370:7334' AS valid_IPv6_string,
    '2001:0db8:85a3::8a2e:370g:7334' AS invalid_IPv6_string,
    'not_an_ipv6' AS malformed_string
SELECT
    toIPv6OrDefault(valid_IPv6_string) AS valid,
    toIPv6OrDefault(invalid_IPv6_string) AS default_value,
    toIPv6OrDefault(malformed_string, toIPv6('::1')) AS provided_default;
```

```response title=Response
┌─valid──────────────────────────────────┬─default_value─┬─provided_default─┐
│ 2001:db8:85a3::8a2e:370:7334           │ ::            │ ::1              │
└────────────────────────────────────────┴───────────────┴──────────────────┘
```



## toIPv4 {#toIPv4}

Introduced in: v20.1


文字列またはUInt32形式のIPv4アドレスをIPv4型に変換します。
これは、[`IPv4StringToNum`](/sql-reference/functions/ip-address-functions#IPv4StringToNum)および[`IPv4NumToString`](/sql-reference/functions/ip-address-functions#IPv4NumToString)関数に似ていますが、文字列と符号なし整数データ型の両方を入力引数としてサポートします。


**構文**

```sql
toIPv4(x)
```

**引数**

- `x` — IPv4アドレス [`String`](/sql-reference/data-types/string) または [`UInt8/16/32`](/sql-reference/data-types/int-uint)


**戻り値**

IPv4アドレスを返します。 [`IPv4`](/sql-reference/data-types/ipv4)

**例**

**使用例**

```sql title=Query
SELECT toIPv4('171.225.130.45');
```

```response title=Response
┌─toIPv4('171.225.130.45')─┐
│ 171.225.130.45           │
└──────────────────────────┘
```

**IPv4StringToNumおよびIPv4NumToString関数との比較。**

```sql title=Query
WITH
    '171.225.130.45' AS IPv4_string
SELECT
    hex(IPv4StringToNum(IPv4_string)),
    hex(toIPv4(IPv4_string))
```

```response title=Response
┌─hex(IPv4StringToNum(IPv4_string))─┬─hex(toIPv4(IPv4_string))─┐
│ ABE1822D                          │ ABE1822D                 │
└───────────────────────────────────┴──────────────────────────┘
```

**整数からの変換**

```sql title=Query
SELECT toIPv4(2130706433);
```

```response title=Response
┌─toIPv4(2130706433)─┐
│ 127.0.0.1          │
└────────────────────┘
```



## toIPv4OrDefault {#toIPv4OrDefault}

Introduced in: v22.3


文字列またはUInt32形式のIPv4アドレスを[`IPv4`](../data-types/ipv4.md)型に変換します。
IPv4アドレスのフォーマットが無効な場合は`0.0.0.0`（0 IPv4）または指定されたIPv4デフォルトを返します。
    

**構文**

```sql
toIPv4OrDefault(string[, default])
```

**引数**

- `string` — 変換するIPアドレス文字列。 [`String`](/sql-reference/data-types/string)
- `default` — オプション。文字列が無効なIPv4アドレスの場合に返す値。 [`IPv4`](/sql-reference/data-types/ipv4)


**戻り値**

現在のIPv4アドレスに変換された文字列を返すか、変換に失敗した場合はデフォルト値を返します。 [`IPv4`](/sql-reference/data-types/ipv4)

**例**

**有効なIPv4文字列と無効なIPv4文字列**

```sql title=Query
WITH
    '192.168.1.1' AS valid_IPv4_string,
    '999.999.999.999' AS invalid_IPv4_string,
    'not_an_ip' AS malformed_string
SELECT
    toIPv4OrDefault(valid_IPv4_string) AS valid,
    toIPv4OrDefault(invalid_IPv4_string) AS default_value,
    toIPv4OrDefault(malformed_string, toIPv4('8.8.8.8')) AS provided_default;
```

```response title=Response
┌─valid─────────┬─default_value─┬─provided_default─┐
│ 192.168.1.1   │ 0.0.0.0       │ 8.8.8.8          │
└───────────────┴───────────────┴──────────────────┘
```



## toIPv4OrNull {#toIPv4OrNull}

Introduced in: v22.3


入力値をIPv4型の値に変換しますが、エラーが発生した場合は`NULL`を返します。
[`toIPv4`](#toIPv4)に似ていますが、変換エラー時に例外をスローする代わりに`NULL`を返します。

サポートされる引数:
- ドット十進法表現のIPv4アドレスの文字列。
- IPv4アドレスの整数表現。

サポートされていない引数（`NULL`を返す）:
- 無効なIPアドレスフォーマット。
- IPv6アドレス。
- 範囲外の値。
- 形式が壊れたアドレス。
    

**構文**

```sql
toIPv4OrNull(x)
```

**引数**

- `x` — IPv4アドレスの文字列または整数表現。 [`String`](/sql-reference/data-types/string) または [`Integer`](/sql-reference/data-types/int-uint)


**戻り値**

成功した場合はIPv4アドレスを返し、そうでない場合は`NULL`を返します。 [`IPv4`](/sql-reference/data-types/ipv4) または [`NULL`](/sql-reference/syntax#null)

**例**

**使用例**

```sql title=Query
SELECT
    toIPv4OrNull('192.168.1.1') AS valid_ip,
    toIPv4OrNull('invalid.ip') AS invalid_ip
```

```response title=Response
┌─valid_ip────┬─invalid_ip─┐
│ 192.168.1.1 │       ᴺᵁᴸᴸ │
└─────────────┴────────────┘
```



## toIPv4OrZero {#toIPv4OrZero}

Introduced in: v23.1


入力値を[IPv4](../data-types/ipv4.md)型の値に変換しますが、エラーが発生した場合はゼロIPv4アドレスを返します。
[`toIPv4`](#toIPv4)に似ていますが、変換エラー時に例外をスローする代わりにゼロIPv4アドレス（`0.0.0.0`）を返します。

サポートされる引数:
- ドット十進法表現のIPv4アドレスの文字列。
- IPv4アドレスの整数表現。

サポートされていない引数（ゼロIPv4を返す）:
- 無効なIPアドレスフォーマット。
- IPv6アドレス。
- 範囲外の値。
    

**構文**

```sql
toIPv4OrZero(x)
```

**引数**

- `x` — IPv4アドレスの文字列または整数表現。 [`String`](/sql-reference/data-types/string) または [`Integer`](/sql-reference/data-types/int-uint)


**戻り値**

成功した場合はIPv4アドレスを返し、そうでない場合はゼロIPv4アドレス（`0.0.0.0`）を返します。 [`IPv4`](/sql-reference/data-types/ipv4)

**例**

**使用例**

```sql title=Query
SELECT
    toIPv4OrZero('192.168.1.1') AS valid_ip,
    toIPv4OrZero('invalid.ip') AS invalid_ip
```

```response title=Response
┌─valid_ip────┬─invalid_ip─┐
│ 192.168.1.1 │ 0.0.0.0    │
└─────────────┴────────────┘
```



## toIPv6 {#toIPv6}

Introduced in: v20.1


文字列または`UInt128`形式のIPv6アドレスを[`IPv6`](../data-types/ipv6.md)型に変換します。
文字列の場合、IPv6アドレスのフォーマットが無効な場合は、空の値を返します。
これは、バイナリ形式（すなわち`FixedString(16)`）のIPv6アドレスの変換に似ています[`IPv6StringToNum`](/sql-reference/functions/ip-address-functions#IPv6StringToNum)および[`IPv6NumToString`](/sql-reference/functions/ip-address-functions#IPv6NumToString)関数と同様です。

入力文字列に有効なIPv4アドレスが含まれている場合、IPv4アドレスのIPv6同等物が返されます。


**構文**

```sql
toIPv6(x)
```

**引数**

- `x` — IPアドレス。 [`String`](/sql-reference/data-types/string) または [`UInt128`](/sql-reference/data-types/int-uint)


**戻り値**

IPv6アドレスを返します。 [`IPv6`](/sql-reference/data-types/ipv6)

**例**

**使用例**

```sql title=Query
WITH '2001:438:ffff::407d:1bc1' AS IPv6_string
SELECT
    hex(IPv6StringToNum(IPv6_string)),
    hex(toIPv6(IPv6_string));
```

```response title=Response
┌─hex(IPv6StringToNum(IPv6_string))─┬─hex(toIPv6(IPv6_string))─────────┐
│ 20010438FFFF000000000000407D1BC1  │ 20010438FFFF000000000000407D1BC1 │
└───────────────────────────────────┴──────────────────────────────────┘
```

**IPv4からIPv6へのマッピング**

```sql title=Query
SELECT toIPv6('127.0.0.1');
```

```response title=Response
┌─toIPv6('127.0.0.1')─┐
│ ::ffff:127.0.0.1    │
└─────────────────────┘
```



## toIPv6OrDefault {#toIPv6OrDefault}

Introduced in: v22.3


文字列またはUInt128形式のIPv6アドレスを[`IPv6`](../data-types/ipv6.md)型に変換します。
IPv6アドレスのフォーマットが無効な場合は`::`（0 IPv6）または指定されたIPv6デフォルトを返します。
    

**構文**

```sql
toIPv6OrDefault(string[, default])
```

**引数**

- `string` — 変換するIPアドレス文字列。 - `default` — オプション。文字列が無効な形式の場合に返す値。 

**戻り値**

IPv6アドレスを返します。無効な場合は`::`または提供されたオプションのデフォルトを返します。 [`IPv6`](/sql-reference/data-types/ipv6)

**例**

**有効なIPv6文字列と無効なIPv6文字列**

```sql title=Query
WITH
    '2001:0db8:85a3:0000:0000:8a2e:0370:7334' AS valid_IPv6_string,
    '2001:0db8:85a3::8a2e:370g:7334' AS invalid_IPv6_string,
    'not_an_ipv6' AS malformed_string
SELECT
    toIPv6OrDefault(valid_IPv6_string) AS valid,
    toIPv6OrDefault(invalid_IPv6_string) AS default_value,
    toIPv6OrDefault(malformed_string, toIPv6('::1')) AS provided_default;
```

```response title=Response
┌─valid──────────────────────────────────┬─default_value─┬─provided_default─┐
│ 2001:db8:85a3::8a2e:370:7334           │ ::            │ ::1              │
└────────────────────────────────────────┴───────────────┴──────────────────┘
```



## toIPv6OrNull {#toIPv6OrNull}

Introduced in: v22.3


入力値をIPv6型の値に変換しますが、エラーが発生した場合は`NULL`を返します。
[`toIPv6`](#toIPv6)に似ていますが、変換エラー時に例外をスローする代わりに`NULL`を返します。

サポートされる引数:
- 標準表記のIPv6アドレスの文字列。
- IPv4アドレスの文字列表現（IPv4を埋め込んだIPv6に変換）。
- バイナリ形式のIPv6アドレスの表現。

サポートされていない引数（`NULL`を返す）:
- 無効なIPアドレスフォーマット。
- 形式が壊れたIPv6アドレス。
- 範囲外の値。
- 不正な表記。
    

**構文**

```sql
toIPv6OrNull(x)
```

**引数**

- `x` — IPv6またはIPv4アドレスの文字列表現。 [`String`](/sql-reference/data-types/string)


**戻り値**

成功した場合はIPv6アドレスを返し、そうでない場合は`NULL`を返します。 [`IPv6`](/sql-reference/data-types/ipv6) または [`NULL`](/sql-reference/syntax#null)

**例**

**使用例**

```sql title=Query
SELECT
    toIPv6OrNull('2001:0db8:85a3:0000:0000:8a2e:0370:7334') AS valid_ipv6,
    toIPv6OrNull('invalid::ip') AS invalid_ipv6
```

```response title=Response
┌─valid_ipv6──────────────────────────┬─invalid_ipv6─┐
│ 2001:db8:85a3::8a2e:370:7334        │         ᴺᵁᴸᴸ │
└─────────────────────────────────────┴──────────────┘
```



## toIPv6OrZero {#toIPv6OrZero}

Introduced in: v23.1


入力値を[IPv6](../data-types/ipv6.md)型の値に変換しますが、エラーが発生した場合はゼロIPv6アドレスを返します。
[`toIPv6`](#toIPv6)に似ていますが、変換エラー時に例外をスローする代わりにゼロIPv6アドレス（`::`）を返します。

サポートされる引数:
- 標準表記のIPv6アドレスの文字列。
- IPv4アドレスの文字列表現（IPv4を埋め込んだIPv6に変換）。
- バイナリ形式のIPv6アドレスの表現。

サポートされていない引数（ゼロIPv6を返す）:
- 無効なIPアドレスフォーマット。
- 形式が壊れたIPv6アドレス。
- 範囲外の値。
    

**構文**

```sql
toIPv6OrZero(x)
```

**引数**

- `x` — IPv6またはIPv4アドレスの文字列表現。 [`String`](/sql-reference/data-types/string)


**戻り値**

成功した場合はIPv6アドレスを返し、そうでない場合はゼロIPv6アドレス（`::`）を返します。 [`IPv6`](/sql-reference/data-types/ipv6)

**例**

**使用例**

```sql title=Query
SELECT
    toIPv6OrZero('2001:0db8:85a3:0000:0000:8a2e:0370:7334') AS valid_ipv6,
    toIPv6OrZero('invalid::ip') AS invalid_ipv6
```

```response title=Response
┌─valid_ipv6──────────────────────────┬─invalid_ipv6─┐
│ 2001:db8:85a3::8a2e:370:7334        │ ::           │
└─────────────────────────────────────┴──────────────┘
```



<!--AUTOGENERATED_END-->
