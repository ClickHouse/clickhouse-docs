---
description: 'URL を扱う関数に関するドキュメント'
sidebar_label: 'URL'
slug: /sql-reference/functions/url-functions
title: 'URL を扱う関数'
doc_type: 'reference'
---



# URL を扱う関数



## 概要 {#overview}

:::note
このセクションで説明する関数は、最大限のパフォーマンスを実現するために最適化されており、ほとんどの場合RFC-3986標準に準拠していません。
RFC-3986を実装する関数は、関数名に`RFC`が付加されており、一般的に処理速度が遅くなります。
:::

ユーザー文字列や`@`記号を含まない公開登録ドメインを扱う場合は、通常、非`RFC`関数バリアントを使用できます。
以下の表は、URLに含まれる記号が、それぞれの`RFC`および非`RFC`バリアントで解析可能(`✔`)か不可能(`✗`)かを示しています:

| 記号   | 非`RFC` | `RFC` |
| ------ | --------- | ----- |
| ' '    | ✗         | ✗     |
| \t     | ✗         | ✗     |
| &lt;   | ✗         | ✗     |
| >      | ✗         | ✗     |
| %      | ✗         | ✔\*  |
| \{     | ✗         | ✗     |
| }      | ✗         | ✗     |
| \|     | ✗         | ✗     |
| \\\    | ✗         | ✗     |
| ^      | ✗         | ✗     |
| ~      | ✗         | ✔\*  |
| [      | ✗         | ✗     |
| ]      | ✗         | ✔    |
| ;      | ✗         | ✔\*  |
| =      | ✗         | ✔\*  |
| &      | ✗         | ✔\*  |

`*`が付いた記号は、RFC 3986におけるサブデリミタであり、`@`記号に続くユーザー情報として使用が許可されています。

URL関数には2つのタイプがあります:

- URLの一部を抽出する関数。該当する部分がURLに存在しない場合は、空文字列が返されます。
- URLの一部を削除する関数。URLに該当する部分が存在しない場合は、URLは変更されません。

:::note
以下の関数は、`system.functions`システムテーブルから生成されています。
:::

<!--
The inner content of the tags below are replaced at doc framework build time with
docs generated from system.functions. Please do not modify or remove the tags.
See: https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md
-->


<!--AUTOGENERATED_START-->

## cutFragment {#cutFragment}

Introduced in: v1.1

URLからフラグメント識別子(#記号を含む)を削除します。

**構文**

```sql
cutFragment(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

フラグメント識別子が削除されたURLを返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT cutFragment('http://example.com/path?query=value#fragment123');
```

```response title=Response
┌─cutFragment('http://example.com/path?query=value#fragment123')─┐
│ http://example.com/path?query=value                            │
└────────────────────────────────────────────────────────────────┘
```


## cutQueryString {#cutQueryString}

導入バージョン: v1.1

URLからクエリ文字列を疑問符も含めて削除します。

**構文**

```sql
cutQueryString(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

クエリ文字列が削除されたURLを返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT cutQueryString('http://example.com/path?query=value&param=123#fragment');
```

```response title=レスポンス
┌─cutQueryString('http://example.com/path?query=value&param=123#fragment')─┐
│ http://example.com/path#fragment                                         │
└──────────────────────────────────────────────────────────────────────────┘
```


## cutQueryStringAndFragment {#cutQueryStringAndFragment}

導入バージョン: v1.1

URLからクエリ文字列とフラグメント識別子を、疑問符（?）とハッシュ記号（#）を含めて削除します。

**構文**

```sql
cutQueryStringAndFragment(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

クエリ文字列とフラグメント識別子が削除されたURLを返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT cutQueryStringAndFragment('http://example.com/path?query=value&param=123#fragment');
```

```response title=レスポンス
┌─cutQueryStringAndFragment('http://example.com/path?query=value&param=123#fragment')─┐
│ http://example.com/path                                                             │
└─────────────────────────────────────────────────────────────────────────────────────┘
```


## cutToFirstSignificantSubdomain {#cutToFirstSignificantSubdomain}

導入バージョン: v1.1

[最初の有意なサブドメイン](/sql-reference/functions/url-functions#firstSignificantSubdomain)までのトップレベルサブドメインを含むドメインの部分を返します。

**構文**

```sql
cutToFirstSignificantSubdomain(url)
```

**引数**

- `url` — 処理対象のURLまたはドメイン文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

可能な場合、最初の有意なサブドメインまでのトップレベルサブドメインを含むドメインの部分を返します。それ以外の場合は空文字列を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT
    cutToFirstSignificantSubdomain('https://news.clickhouse.com.tr/'),
    cutToFirstSignificantSubdomain('www.tr'),
    cutToFirstSignificantSubdomain('tr');
```

```response title=レスポンス
┌─cutToFirstSignificantSubdomain('https://news.clickhouse.com.tr/')─┬─cutToFirstSignificantSubdomain('www.tr')─┬─cutToFirstSignificantSubdomain('tr')─┐
│ clickhouse.com.tr                                                 │ tr                                       │                                      │
└───────────────────────────────────────────────────────────────────┴──────────────────────────────────────────┴──────────────────────────────────────┘
```


## cutToFirstSignificantSubdomainCustom {#cutToFirstSignificantSubdomainCustom}

導入バージョン: v21.1

ドメインのうち、トップレベルドメインから最初の有意なサブドメインまでの部分を返します。カスタム[TLDリスト](https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains)名を指定できます。この関数は、最新のTLDリストが必要な場合やカスタムリストを使用する場合に便利です。

**設定例**

```yaml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>
```

**構文**

```sql
cutToFirstSignificantSubdomainCustom(url, tld_list_name)
```

**引数**

- `url` — 処理するURLまたはドメイン文字列。[`String`](/sql-reference/data-types/string)
- `tld_list_name` — ClickHouseで設定されたカスタムTLDリストの名前。[`const String`](/sql-reference/data-types/string)

**戻り値**

トップレベルドメインから最初の有意なサブドメインまでを含むドメインの部分。[`String`](/sql-reference/data-types/string)

**例**

**非標準ドメインに対するカスタムTLDリストの使用**

```sql title=クエリ
SELECT cutToFirstSignificantSubdomainCustom('bar.foo.there-is-no-such-domain', 'public_suffix_list')
```

```response title=レスポンス
foo.there-is-no-such-domain
```


## cutToFirstSignificantSubdomainCustomRFC {#cutToFirstSignificantSubdomainCustomRFC}

導入バージョン: v22.10

トップレベルサブドメインから最初の有意なサブドメインまでを含むドメインの部分を返します。
カスタム[TLDリスト](https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains)名を指定できます。
この関数は、最新のTLDリストが必要な場合やカスタムリストを使用する場合に便利です。
[cutToFirstSignificantSubdomainCustom](#cutToFirstSignificantSubdomainCustom)と類似していますが、RFC 3986に準拠しています。

**設定例**

```xml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>
```

**構文**

```sql
cutToFirstSignificantSubdomainCustomRFC(url, tld_list_name)
```

**引数**

- `url` — RFC 3986に従って処理するURLまたはドメイン文字列。
- `tld_list_name` — ClickHouseで設定されたカスタムTLDリストの名前。

**戻り値**

トップレベルサブドメインから最初の有意なサブドメインまでを含むドメインの部分を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT cutToFirstSignificantSubdomainCustomRFC('www.foo', 'public_suffix_list');
```

```response title=Response
┌─cutToFirstSignificantSubdomainCustomRFC('www.foo', 'public_suffix_list')─────┐
│ www.foo                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘
```


## cutToFirstSignificantSubdomainCustomWithWWW {#cutToFirstSignificantSubdomainCustomWithWWW}

導入バージョン: v21.1

'www'を削除せずに、最初の有意なサブドメインまでのトップレベルサブドメインを含むドメインの部分を返します。カスタムTLDリスト名を指定できます。最新のTLDリストが必要な場合や、カスタムリストを使用する場合に便利です。

**設定例**

````yaml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>


**構文**

```sql
cutToFirstSignificantSubdomainCustomWithWWW(url, tld_list_name)
````

**引数**

- `url` — 処理対象のURLまたはドメイン文字列。
- `tld_list_name` — ClickHouseで設定されたカスタムTLDリストの名前。

**戻り値**

'www'を削除せずに、最初の有意なサブドメインまでのトップレベルサブドメインを含むドメインの部分。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT cutToFirstSignificantSubdomainCustomWithWWW('www.foo', 'public_suffix_list');
```

```response title=Response
┌─cutToFirstSignificantSubdomainCustomWithWWW('www.foo', 'public_suffix_list')─┐
│ www.foo                                                                      │
└──────────────────────────────────────────────────────────────────────────────┘
```


## cutToFirstSignificantSubdomainCustomWithWWWRFC {#cutToFirstSignificantSubdomainCustomWithWWWRFC}

導入バージョン: v22.10

`www`を削除せずに、最初の有意なサブドメインまでのトップレベルサブドメインを含むドメイン部分を返します。
カスタムTLDリスト名を指定できます。
最新のTLDリストが必要な場合や、独自のカスタムリストを使用する場合に有用です。
[cutToFirstSignificantSubdomainCustomWithWWW](#cutToFirstSignificantSubdomainCustomWithWWW)と類似していますが、[RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986)に準拠しています。

**設定例**

````xml
<!-- <top_level_domains_path>/var/lib/clickhouse/top_level_domains/</top_level_domains_path> -->
<top_level_domains_lists>
    <!-- https://publicsuffix.org/list/public_suffix_list.dat -->
    <public_suffix_list>public_suffix_list.dat</public_suffix_list>
    <!-- NOTE: path is under top_level_domains_path -->
</top_level_domains_lists>


**構文**

```sql
cutToFirstSignificantSubdomainCustomWithWWWRFC(url, tld_list_name)
````

**引数**

- `url` — RFC 3986に従って処理するURLまたはドメイン文字列。
- `tld_list_name` — ClickHouseで設定されたカスタムTLDリストの名前。

**戻り値**

`www`を削除せずに、最初の有意なサブドメインまでのトップレベルサブドメインを含むドメイン部分を返します。[`String`](/sql-reference/data-types/string)

**例**

**カスタムTLDリストを使用してwwwを保持するRFC 3986解析**

```sql title=クエリ
SELECT cutToFirstSignificantSubdomainCustomWithWWWRFC('https://www.subdomain.example.custom', 'public_suffix_list')
```

```response title=レスポンス
www.example.custom
```


## cutToFirstSignificantSubdomainRFC {#cutToFirstSignificantSubdomainRFC}

導入バージョン: v22.10

["最初の有意なサブドメイン"](/sql-reference/functions/url-functions#firstSignificantSubdomain)までのトップレベルサブドメインを含むドメインの部分を返します。[`cutToFirstSignificantSubdomain`](#cutToFirstSignificantSubdomain)と同様ですが、[RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986)に準拠しています。

**構文**

```sql
cutToFirstSignificantSubdomainRFC(url)
```

**引数**

- `url` — RFC 3986に従って処理するURLまたはドメイン文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

可能な場合は、最初の有意なサブドメインまでのトップレベルサブドメインを含むドメインの部分を返します。それ以外の場合は空文字列を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT
    cutToFirstSignificantSubdomain('http://user:password@example.com:8080'),
    cutToFirstSignificantSubdomainRFC('http://user:password@example.com:8080');
```

```response title=レスポンス
┌─cutToFirstSignificantSubdomain('http://user:password@example.com:8080')─┬─cutToFirstSignificantSubdomainRFC('http://user:password@example.com:8080')─┐
│                                                                         │ example.com                                                                │
└─────────────────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────────┘
```


## cutToFirstSignificantSubdomainWithWWW {#cutToFirstSignificantSubdomainWithWWW}

導入バージョン: v20.12

トップレベルサブドメインから「最初の重要なサブドメイン」までを含むドメイン部分を返します。'www.'は削除されません。

[`cutToFirstSignificantSubdomain`](#cutToFirstSignificantSubdomain)と同様ですが、'www.'プレフィックスが存在する場合は保持します。

**構文**

```sql
cutToFirstSignificantSubdomainWithWWW(url)
```

**引数**

- `url` — 処理対象のURLまたはドメイン文字列。[`String`](/sql-reference/data-types/string)

**戻り値**

可能な場合、トップレベルサブドメインから最初の重要なサブドメイン(wwwを含む)までを含むドメイン部分を返します。それ以外の場合は空文字列を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT
    cutToFirstSignificantSubdomainWithWWW('https://news.clickhouse.com.tr/'),
    cutToFirstSignificantSubdomainWithWWW('www.tr'),
    cutToFirstSignificantSubdomainWithWWW('tr');
```

```response title=Response
┌─cutToFirstSignificantSubdomainWithWWW('https://news.clickhouse.com.tr/')─┬─cutToFirstSignificantSubdomainWithWWW('www.tr')─┬─cutToFirstSignificantSubdomainWithWWW('tr')─┐
│ clickhouse.com.tr                                                        │ www.tr                                          │                                             │
└──────────────────────────────────────────────────────────────────────────┴─────────────────────────────────────────────────┴─────────────────────────────────────────────┘
```


## cutToFirstSignificantSubdomainWithWWWRFC {#cutToFirstSignificantSubdomainWithWWWRFC}

導入バージョン: v22.10

トップレベルサブドメインから「最初の重要なサブドメイン」までを含むドメインの部分を返します。'www'は削除されません。[`cutToFirstSignificantSubdomainWithWWW`](#cutToFirstSignificantSubdomainWithWWW)と類似していますが、[RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986)に準拠しています。

**構文**

```sql
cutToFirstSignificantSubdomainWithWWWRFC(url)
```

**引数**

- `url` — RFC 3986に従って処理するURLまたはドメイン文字列。

**戻り値**

可能な場合、トップレベルサブドメインから最初の重要なサブドメイン('www'を含む)までを含むドメインの部分を返します。それ以外の場合は空文字列を返します [`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT
    cutToFirstSignificantSubdomainWithWWW('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy'),
    cutToFirstSignificantSubdomainWithWWWRFC('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy');
```

```response title=レスポンス
┌─cutToFirstSignificantSubdomainWithWWW('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy')─┬─cutToFirstSignificantSubdomainWithWWWRFC('http:%2F%2Fwwwww.nova@mail.ru/economicheskiy')─┐
│                                                                                       │ mail.ru                                                                                  │
└───────────────────────────────────────────────────────────────────────────────────────┴──────────────────────────────────────────────────────────────────────────────────────────┘
```


## cutURLParameter {#cutURLParameter}

導入バージョン: v1.1

URLから`name`パラメータを削除します(存在する場合)。
この関数はパラメータ名の文字をエンコードまたはデコードしません。例えば、`Client ID`と`Client%20ID`は異なるパラメータ名として扱われます。

**構文**

```sql
cutURLParameter(url, name)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)
- `name` — URLパラメータの名前。[`String`](/sql-reference/data-types/string)または[`Array(String)`](/sql-reference/data-types/array)

**戻り値**

`name`パラメータが削除されたURL。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT
    cutURLParameter('http://bigmir.net/?a=b&c=d&e=f#g', 'a') AS url_without_a,
    cutURLParameter('http://bigmir.net/?a=b&c=d&e=f#g', ['c', 'e']) AS url_without_c_and_e;
```

```response title=Response
┌─url_without_a────────────────┬─url_without_c_and_e──────┐
│ http://bigmir.net/?c=d&e=f#g │ http://bigmir.net/?a=b#g │
└──────────────────────────────┴──────────────────────────┘
```


## cutWWW {#cutWWW}

導入バージョン: v1.1

URLのドメインから先頭の`www.`を削除します（存在する場合）。

**構文**

```sql
cutWWW(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

ドメインから先頭の`www.`が削除されたURLを返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT cutWWW('http://www.example.com/path?query=value#fragment');
```

```response title=レスポンス
┌─cutWWW('http://www.example.com/path?query=value#fragment')─┐
│ http://example.com/path?query=value#fragment               │
└────────────────────────────────────────────────────────────┘
```


## decodeURLComponent {#decodeURLComponent}

導入バージョン: v1.1

URLエンコードされた文字列を入力として受け取り、元の読み取り可能な形式にデコードして返します。

**構文**

```sql
decodeURLComponent(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

デコードされたURLを返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT decodeURLComponent('http://127.0.0.1:8123/?query=SELECT%201%3B') AS DecodedURL;
```

```response title=Response
┌─DecodedURL─────────────────────────────┐
│ http://127.0.0.1:8123/?query=SELECT 1; │
└────────────────────────────────────────┘
```


## decodeURLFormComponent {#decodeURLFormComponent}

導入バージョン: v1.1

フォームエンコーディング規則（[RFC-1866](https://www.rfc-editor.org/rfc/rfc1866.html)）を使用してURLエンコードされた文字列をデコードします。`+`記号はスペースに変換され、パーセントエンコードされた文字がデコードされます。

**構文**

```sql
decodeURLFormComponent(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

デコードされたURLを返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT decodeURLFormComponent('http://127.0.0.1:8123/?query=SELECT%201+2%2B3') AS DecodedURL;
```

```response title=Response
┌─DecodedURL────────────────────────────────┐
│ http://127.0.0.1:8123/?query=SELECT 1 2+3 │
└───────────────────────────────────────────┘
```


## domain {#domain}

導入バージョン: v1.1

URLからホスト名を抽出します。

URLはプロトコルあり・なしのどちらでも指定できます。

**構文**

```sql
domain(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

入力文字列がURLとして解析できる場合はホスト名を返し、それ以外の場合は空文字列を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT domain('svn+ssh://some.svn-hosting.com:80/repo/trunk');
```

```response title=Response
┌─domain('svn+ssh://some.svn-hosting.com:80/repo/trunk')─┐
│ some.svn-hosting.com                                   │
└────────────────────────────────────────────────────────┘
```


## domainRFC {#domainRFC}

導入バージョン: v22.10

URLからホスト名を抽出します。
[`domain`](#domain)と同様ですが、[RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986)に準拠しています。

**構文**

```sql
domainRFC(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

入力文字列がURLとして解析可能な場合はホスト名を返し、それ以外の場合は空文字列を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT
    domain('http://user:password@example.com:8080/path?query=value#fragment'),
    domainRFC('http://user:password@example.com:8080/path?query=value#fragment');
```

```response title=レスポンス
┌─domain('http://user:password@example.com:8080/path?query=value#fragment')─┬─domainRFC('http://user:password@example.com:8080/path?query=value#fragment')─┐
│                                                                           │ example.com                                                                  │
└───────────────────────────────────────────────────────────────────────────┴──────────────────────────────────────────────────────────────────────────────┘
```


## domainWithoutWWW {#domainWithoutWWW}

導入バージョン: v1.1

URLのドメインから先頭の`www.`を除いて返します。

**構文**

```sql
domainWithoutWWW(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

入力文字列がURLとして解析可能な場合、ドメイン名を返します(先頭の`www.`を除く)。それ以外の場合は空文字列を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT domainWithoutWWW('http://paul@www.example.com:80/');
```

```response title=Response
┌─domainWithoutWWW('http://paul@www.example.com:80/')─┐
│ example.com                                         │
└─────────────────────────────────────────────────────┘
```


## domainWithoutWWWRFC {#domainWithoutWWWRFC}

導入バージョン: v1.1

先頭の `www.` が存在する場合、それを除いたドメインを返します。[`domainWithoutWWW`](#domainWithoutWWW) と同様ですが、[RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986) に準拠しています。

**構文**

```sql
domainWithoutWWWRFC(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

入力文字列がURLとして解析可能な場合はドメイン名(先頭の `www.` を除く)を返します。それ以外の場合は空文字列を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT
    domainWithoutWWW('http://user:password@www.example.com:8080/path?query=value#fragment'),
    domainWithoutWWWRFC('http://user:password@www.example.com:8080/path?query=value#fragment');
```

```response title=Response
┌─domainWithoutWWW('http://user:password@www.example.com:8080/path?query=value#fragment')─┬─domainWithoutWWWRFC('http://user:password@www.example.com:8080/path?query=value#fragment')─┐
│                                                                                         │ example.com                                                                                │
└─────────────────────────────────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────────────────────────┘
```


## encodeURLComponent {#encodeURLComponent}

導入バージョン: v22.3

通常の文字列を受け取り、特殊文字をパーセントエンコードされた同等の文字に置き換えたURLエンコード(パーセントエンコード)形式に変換します。

**構文**

```sql
encodeURLComponent(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

エンコードされたURLを返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT encodeURLComponent('http://127.0.0.1:8123/?query=SELECT 1;') AS EncodedURL;
```

```response title=レスポンス
┌─EncodedURL───────────────────────────────────────────────┐
│ http%3A%2F%2F127.0.0.1%3A8123%2F%3Fquery%3DSELECT%201%3B │
└──────────────────────────────────────────────────────────┘
```


## encodeURLFormComponent {#encodeURLFormComponent}

導入バージョン: v22.3

フォームエンコーディング規則([RFC-1866](https://www.rfc-editor.org/rfc/rfc1866.html))を使用して文字列をエンコードします。スペースは+記号に変換され、特殊文字はパーセントエンコーディングされます。

**構文**

```sql
encodeURLFormComponent(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

エンコードされたURLを返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT encodeURLFormComponent('http://127.0.0.1:8123/?query=SELECT 1 2+3') AS EncodedURL;
```

```response title=Response
┌─EncodedURL────────────────────────────────────────────────┐
│ http%3A%2F%2F127.0.0.1%3A8123%2F%3Fquery%3DSELECT+1+2%2B3 │
└───────────────────────────────────────────────────────────┘
```


## extractURLParameter {#extractURLParameter}

導入バージョン: v1.1

URLに`name`パラメータが存在する場合はその値を返し、存在しない場合は空文字列を返します。
同じ名前のパラメータが複数存在する場合は、最初に出現したものを返します。
この関数は、`url`パラメータ内のパラメータが`name`引数と同じ方法でエンコードされていることを前提としています。

**構文**

```sql
extractURLParameter(url, name)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)
- `name` — パラメータ名。[`String`](/sql-reference/data-types/string)

**戻り値**

指定された名前のURLパラメータの値を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT extractURLParameter('http://example.com/?param1=value1&param2=value2', 'param1');
```

```response title=レスポンス
┌─extractURLPa⋯, 'param1')─┐
│ value1                   │
└──────────────────────────┘
```


## extractURLParameterNames {#extractURLParameterNames}

導入バージョン: v1.1

URLパラメータ名に対応する文字列の配列を返します。
値はデコードされません。

**構文**

```sql
extractURLParameterNames(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

URLパラメータ名に対応する文字列の配列。[`Array(String)`](/sql-reference/data-types/array)

**例**

**使用例**

```sql title=クエリ
SELECT extractURLParameterNames('http://example.com/?param1=value1&param2=value2');
```

```response title=レスポンス
┌─extractURLPa⋯m2=value2')─┐
│ ['param1','param2']      │
└──────────────────────────┘
```


## extractURLParameters {#extractURLParameters}

導入バージョン: v1.1

URLパラメータに対応する`name=value`形式の文字列の配列を返します。
値はデコードされません。

**構文**

```sql
extractURLParameters(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

URLパラメータに対応する`name=value`形式の文字列の配列。[`Array(String)`](/sql-reference/data-types/array)

**例**

**使用例**

```sql title=クエリ
SELECT extractURLParameters('http://example.com/?param1=value1&param2=value2');
```

```response title=レスポンス
┌─extractURLParame⋯&param2=value2')─┐
│ ['param1=value1','param2=value2'] │
└───────────────────────────────────┘
```


## firstSignificantSubdomain {#firstSignificantSubdomain}

Introduced in: v

「最初の有意なサブドメイン」を返します。

最初の有意なサブドメインは、'com'、'net'、'org'、または'co'の場合は第2レベルドメインです。
それ以外の場合は第3レベルドメインです。

例えば、firstSignificantSubdomain('https://news.clickhouse.com/') = 'clickhouse'、firstSignificantSubdomain ('https://news.clickhouse.com.tr/') = 'clickhouse'となります。

「有意でない」第2レベルドメインのリストやその他の実装詳細は、将来変更される可能性があります。

**構文**

```sql

```

**引数**

- なし。

**戻り値**

**例**

**firstSignificantSubdomain**

```sql title=クエリ
SELECT firstSignificantSubdomain('https://news.clickhouse.com/')
```

```response title=レスポンス

```


## firstSignificantSubdomainRFC {#firstSignificantSubdomainRFC}

Introduced in: v

RFC 1034に従って「最初の有意なサブドメイン」を返します。

**構文**

```sql

```

**引数**

- なし。

**返される値**

**例**


## fragment {#fragment}

導入バージョン: v1.1

先頭のハッシュ記号を除いたフラグメント識別子を返します。

**構文**

```sql
fragment(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

先頭のハッシュ記号を除いたフラグメント識別子を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT fragment('https://clickhouse.com/docs/getting-started/quick-start/cloud#1-create-a-clickhouse-service');
```

```response title=レスポンス
┌─fragment('http⋯ouse-service')─┐
│ 1-create-a-clickhouse-service │
└───────────────────────────────┘
```


## netloc {#netloc}

導入バージョン: v20.5

URLからネットワークロケーション（`username:password@host:port`）を抽出します。

**構文**

```sql
netloc(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

指定されたURLから`username:password@host:port`を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT netloc('http://paul@www.example.com:80/');
```

```response title=Response
┌─netloc('http⋯e.com:80/')─┐
│ paul@www.example.com:80  │
└──────────────────────────┘
```


## path {#path}

導入バージョン: v1.1

URLからクエリ文字列を除いたパスを返します。

**構文**

```sql
path(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

クエリ文字列を除いたURLのパスを返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT path('https://clickhouse.com/docs/sql-reference/functions/url-functions/?query=value');
```

```response title=Response
┌─path('https://clickhouse.com/en/sql-reference/functions/url-functions/?query=value')─┐
│ /docs/sql-reference/functions/url-functions/                                         │
└──────────────────────────────────────────────────────────────────────────────────────┘
```


## pathFull {#pathFull}

導入バージョン: v1.1

[`path`](#path)と同じですが、URLのクエリ文字列とフラグメントを含みます。

**構文**

```sql
pathFull(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

クエリ文字列とフラグメントを含むURLのパスを返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT pathFull('https://clickhouse.com/docs/sql-reference/functions/url-functions/?query=value#section');
```

```response title=レスポンス
┌─pathFull('https://clickhouse.com⋯unctions/?query=value#section')─┐
│ /docs/sql-reference/functions/url-functions/?query=value#section │
└──────────────────────────────────────────────────────────────────┘
```


## port {#port}

導入バージョン: v20.5

URLのポート番号を返します。URLにポート番号が含まれていない場合、または解析できない場合は`default_port`を返します。

**構文**

```sql
port(url[, default_port])
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)
- `default_port` — オプション。返されるデフォルトのポート番号。デフォルトは`0`。[`UInt16`](/sql-reference/data-types/int-uint)

**戻り値**

URLのポート番号を返します。URLにポート番号が存在しない場合、または検証エラーが発生した場合はデフォルトポートを返します。[`UInt16`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT port('https://clickhouse.com:8443/docs'), port('https://clickhouse.com/docs', 443);
```

```response title=Response
┌─port('https://clickhouse.com:8443/docs')─┬─port('https://clickhouse.com/docs', 443)─┐
│                                     8443 │                                      443 │
└──────────────────────────────────────────┴──────────────────────────────────────────┘
```


## portRFC {#portRFC}

導入バージョン: v22.10

URLにポートが含まれていない場合、または解析できない場合に、ポートまたは`default_port`を返します。
[`port`](#port)と同様ですが、[RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986)に準拠しています。

**構文**

```sql
portRFC(url[, default_port])
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)
- `default_port` — オプション。返されるデフォルトのポート番号。デフォルトは`0`。[`UInt16`](/sql-reference/data-types/int-uint)

**戻り値**

URLにポートが存在しない場合、または検証エラーが発生した場合に、ポートまたはデフォルトポートを返します。[`UInt16`](/sql-reference/data-types/int-uint)

**例**

**使用例**

```sql title=Query
SELECT port('http://user:password@example.com:8080/'), portRFC('http://user:password@example.com:8080/');
```

```response title=Response
┌─port('http:/⋯com:8080/')─┬─portRFC('htt⋯com:8080/')─┐
│                        0 │                     8080 │
└──────────────────────────┴──────────────────────────┘
```


## protocol {#protocol}

導入バージョン: v1.1

URLからプロトコルを抽出します。

典型的な戻り値の例: http、https、ftp、mailto、tel、magnet

**構文**

```sql
protocol(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

URLのプロトコルを返します。判定できない場合は空文字列を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT protocol('https://clickhouse.com/');
```

```response title=レスポンス
┌─protocol('https://clickhouse.com/')─┐
│ https                               │
└─────────────────────────────────────┘
```


## queryString {#queryString}

導入バージョン: v1.1

URLのクエリ文字列を、先頭の疑問符、`#`、および`#`以降のすべてを除いて返します。

**構文**

```sql
queryString(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

先頭の疑問符とフラグメントを除いたURLのクエリ文字列を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT queryString('https://clickhouse.com/docs?query=value&param=123#section');
```

```response title=レスポンス
┌─queryString(⋯3#section')─┐
│ query=value&param=123    │
└──────────────────────────┘
```


## queryStringAndFragment {#queryStringAndFragment}

導入バージョン: v1.1

URLのクエリ文字列とフラグメント識別子を返します。

**構文**

```sql
queryStringAndFragment(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

URLのクエリ文字列とフラグメント識別子。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT queryStringAndFragment('https://clickhouse.com/docs?query=value&param=123#section');
```

```response title=レスポンス
┌─queryStringAnd⋯=123#section')─┐
│ query=value&param=123#section │
└───────────────────────────────┘
```


## topLevelDomain {#topLevelDomain}

Introduced in: v1.1

URLからトップレベルドメインを抽出します。

:::note
URLはプロトコルの有無にかかわらず指定できます。
例:

```text
svn+ssh://some.svn-hosting.com:80/repo/trunk
some.svn-hosting.com:80/repo/trunk
https://clickhouse.com/time/
```

:::

**Syntax**

```sql
topLevelDomain(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

入力文字列がURLとして解析可能な場合はドメイン名を返します。それ以外の場合は空文字列を返します。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=Query
SELECT topLevelDomain('svn+ssh://www.some.svn-hosting.com:80/repo/trunk');
```

```response title=Response
┌─topLevelDomain('svn+ssh://www.some.svn-hosting.com:80/repo/trunk')─┐
│ com                                                                │
└────────────────────────────────────────────────────────────────────┘
```


## topLevelDomainRFC {#topLevelDomainRFC}

導入バージョン: v22.10

URLからトップレベルドメインを抽出します。
[`topLevelDomain`](#topLevelDomain)と同様ですが、[RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986)に準拠しています。

**構文**

```sql
topLevelDomainRFC(url)
```

**引数**

- `url` — URL。[`String`](/sql-reference/data-types/string)

**戻り値**

入力文字列がURLとして解析可能な場合はドメイン名。それ以外の場合は空文字列。[`String`](/sql-reference/data-types/string)

**例**

**使用例**

```sql title=クエリ
SELECT topLevelDomain('http://foo:foo%41bar@foo.com'), topLevelDomainRFC('http://foo:foo%41bar@foo.com');
```

```response title=レスポンス
┌─topLevelDomain('http://foo:foo%41bar@foo.com')─┬─topLevelDomainRFC('http://foo:foo%41bar@foo.com')─┐
│                                                │ com                                               │
└────────────────────────────────────────────────┴───────────────────────────────────────────────────┘
```

<!--AUTOGENERATED_END-->
