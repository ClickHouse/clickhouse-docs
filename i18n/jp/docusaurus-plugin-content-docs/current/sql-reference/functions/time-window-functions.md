---
description: '時間ウィンドウ関数のドキュメント'
sidebar_label: '時間ウィンドウ'
slug: /sql-reference/functions/time-window-functions
title: '時間ウィンドウ関数'
doc_type: 'reference'
keywords: ['時間ウィンドウ']
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import CloudNotSupportedBadge from '@theme/badges/CloudNotSupportedBadge';


# 時間ウィンドウ関数 {#time-window-functions}

<ExperimentalBadge />

<CloudNotSupportedBadge />

時間ウィンドウ関数は、対応するウィンドウの下側の境界（含む）と上側の境界（含まない）を返します。
[WindowView](/sql-reference/statements/create/view#window-view) を扱うための関数は以下に示します。

{/* 
  以下のタグ内の内容は、ドキュメントフレームワークのビルド時に
  system.functions から自動生成されたドキュメントで置き換えられます。タグを変更または削除しないでください。
  詳細は https://github.com/ClickHouse/clickhouse-docs/blob/main/contribute/autogenerated-documentation-from-source.md を参照してください。
  */ }


{/*AUTOGENERATED_START*/ }

## hop {#hop}

導入バージョン: v21.12

ホッピング時間ウィンドウは固定の長さ（`window_interval`）を持ち、指定されたホップ間隔（`hop_interval`）ごとにシフトします。`hop_interval` が `window_interval` より小さい場合、ホッピングウィンドウは互いに重なり合います。そのため、レコードは複数のウィンドウに割り当てられる可能性があります。

1 つのレコードが複数の hop ウィンドウに割り当てられる可能性があるため、WINDOW VIEW を使用せずに hop 関数を使用した場合、この関数は最初のウィンドウの境界のみを返します。

**構文**

```sql
hop(time_attr, hop_interval, window_interval[, timezone])
```

**引数**

* `time_attr` — 日付と時刻。[`DateTime`](/sql-reference/data-types/datetime)
* `hop_interval` — 正のホップ間隔。[`Interval`](/sql-reference/data-types/int-uint)
* `window_interval` — 正のウィンドウ間隔。[`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — 省略可。タイムゾーン名。[`String`](/sql-reference/data-types/string)

**戻り値**

対応するホッピングウィンドウの下限（包含的）と上限（排他的）を返します。[`Tuple(DateTime, DateTime)`](/sql-reference/data-types/tuple)

**例**

**ホッピングウィンドウ**

```sql title=Query
SELECT hop(now(), INTERVAL '1' DAY, INTERVAL '2' DAY)
```

```response title=Response
('2024-07-03 00:00:00','2024-07-05 00:00:00')
```


## hopEnd {#hopEnd}

導入バージョン: v22.1

対応するホップウィンドウの排他的上限を返します。

1 つのレコードが複数のホップウィンドウに割り当てられる可能性があるため、`WINDOW VIEW` なしで hop 関数を使用する場合、この関数は最初のウィンドウの境界のみを返します。

**構文**

```sql
hopEnd(time_attr, hop_interval, window_interval[, timezone])
```

**引数**

* `time_attr` — 日付と時刻。[`DateTime`](/sql-reference/data-types/datetime)
* `hop_interval` — 正のホップ間隔。[`Interval`](/sql-reference/data-types/int-uint)
* `window_interval` — 正のウィンドウ間隔。[`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — 省略可能。タイムゾーン名。[`String`](/sql-reference/data-types/string)

**戻り値**

対応するホッピングウィンドウの排他的上限値を返します。[`DateTime`](/sql-reference/data-types/datetime)

**例**

**ホッピングウィンドウの終端**

```sql title=Query
SELECT hopEnd(now(), INTERVAL '1' DAY, INTERVAL '2' DAY)
```

```response title=Response
2024-07-05 00:00:00
```


## hopStart {#hopStart}

導入バージョン: v22.1

対応するホップウィンドウの包含的な下限値を返します。

1 つのレコードが複数のホップウィンドウに割り当てられる可能性があるため、`WINDOW VIEW` を使用せずに `hop` 関数を使用した場合、この関数は最初のホップウィンドウの下限値のみを返します。

**構文**

```sql
hopStart(time_attr, hop_interval, window_interval[, timezone])
```

**引数**

* `time_attr` — 日付と時刻。[`DateTime`](/sql-reference/data-types/datetime)
* `hop_interval` — 正のホップ間隔。[`Interval`](/sql-reference/data-types/int-uint)
* `window_interval` — 正のウィンドウ間隔。[`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — 省略可。タイムゾーン名。[`String`](/sql-reference/data-types/string)

**戻り値**

対応するホッピングウィンドウの下側の（含まれる）境界を返します。[`DateTime`](/sql-reference/data-types/datetime)

**例**

**ホッピングウィンドウの開始**

```sql title=Query
SELECT hopStart(now(), INTERVAL '1' DAY, INTERVAL '2' DAY)
```

```response title=Response
2024-07-03 00:00:00
```


## tumble {#tumble}

導入バージョン: v21.12

タンブリングウィンドウは、レコードを固定長（`interval`）の、互いに重ならない連続したウィンドウに割り当てます。

**構文**

```sql
tumble(time_attr, interval[, timezone])
```

**引数**

* `time_attr` — 日時。[`DateTime`](/sql-reference/data-types/datetime)
* `interval` — Interval 型で指定するウィンドウ間隔。[`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — 省略可。タイムゾーン名。[`String`](/sql-reference/data-types/string)

**戻り値**

対応するタンブリングウィンドウの下限（含む）と上限（含まない）を返します。[`Tuple(DateTime, DateTime)`](/sql-reference/data-types/tuple)

**例**

**タンブリングウィンドウ**

```sql title=Query
SELECT tumble(now(), toIntervalDay('1'))
```

```response title=Response
('2024-07-04 00:00:00','2024-07-05 00:00:00')
```


## tumbleEnd {#tumbleEnd}

導入バージョン: v22.1

対応するタンブリングウィンドウの非包含の上限値を返します。

**構文**

```sql
tumbleEnd(time_attr, interval[, timezone])
```

**引数**

* `time_attr` — 日付と時刻。[`DateTime`](/sql-reference/data-types/datetime)
* `interval` — `Interval` 型で指定されたウィンドウ間隔。[`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — 省略可能。タイムゾーン名。[`String`](/sql-reference/data-types/string)

**戻り値**

対応するタンブリングウィンドウの排他的な上限値を返します。[`DateTime`](/sql-reference/data-types/datetime)

**例**

**タンブリングウィンドウの終了時刻**

```sql title=Query
SELECT tumbleEnd(now(), toIntervalDay('1'))
```

```response title=Response
2024-07-05 00:00:00
```


## tumbleStart {#tumbleStart}

導入: v22.1

対応するタンブリングウィンドウの包含的な下限を返します。

**構文**

```sql
tumbleStart(time_attr, interval[, timezone])
```

**引数**

* `time_attr` — 日付と時刻。[`DateTime`](/sql-reference/data-types/datetime)
* `interval` — Interval 型で指定するウィンドウ間隔。[`Interval`](/sql-reference/data-types/int-uint)
* `timezone` — オプション。タイムゾーン名。[`String`](/sql-reference/data-types/string)

**返り値**

対応するタンブリングウィンドウの包括的な下限（開始時刻）を返します。[`DateTime`](/sql-reference/data-types/datetime)

**例**

**タンブリングウィンドウの開始**

```sql title=Query
SELECT tumbleStart(now(), toIntervalDay('1'))
```

```response title=Response
2024-07-04 00:00:00
```

{/*AUTOGENERATED_END*/ }


## 関連コンテンツ {#related-content}

- [時系列データのユースケースガイド](/use-cases/time-series)
