---
description: 'このテーブルには、即座に計算して Prometheus 形式でエクスポート可能なヒストグラムメトリクスが含まれます。常に最新の状態に保たれます。'
keywords: ['system table', 'histogram_metrics']
slug: /operations/system-tables/histogram_metrics
title: 'system.histogram_metrics'
doc_type: 'reference'
---

import SystemTableCloud from '@site/i18n/jp/docusaurus-plugin-content-docs/current/_snippets/_system_table_cloud.md';


# histogram_metrics \{#histogram_metrics\}

<SystemTableCloud />

このテーブルには、その場で計算でき、Prometheus 形式でエクスポート可能なヒストグラム形式のメトリクスが含まれます。常に最新の状態です。非推奨となった `system.latency_log` を置き換えるものです。

カラム:

{/*AUTOGENERATED_START*/ }

* `metric` ([String](../../sql-reference/data-types/)) — メトリクス名。
* `value` ([Int64](../../sql-reference/data-types/)) — メトリクスの値。
* `description` ([String](../../sql-reference/data-types/)) — メトリクスの説明。
* `labels` ([Map(String, String)](../../sql-reference/data-types/)) — メトリクスのラベル。

{/*AUTOGENERATED_END*/ }

**例**

このようなクエリを使用して、すべてのヒストグラムメトリクスを Prometheus 形式でエクスポートできます。

```sql
SELECT
  metric AS name,
  toFloat64(value) AS value,
  description AS help,
  labels,
  'histogram' AS type
FROM system.histogram_metrics
FORMAT Prometheus
```


## メトリクスの説明 \{#metric_descriptions\}

### keeper_response_time_ms_bucket \{#keeper_response_time_ms_bucket\}

Keeper の応答時間（ミリ秒単位）。

### keeper_client_queue_duration_milliseconds_bucket \{#keeper_client_queue_duration_milliseconds_bucket\}

Keeper クライアントによって処理される前に、リクエストがキューに入れられるまでおよびキュー内で待機する時間（ミリ秒単位）。

### keeper_receive_request_time_milliseconds_bucket \{#keeper_receive_request_time_milliseconds_bucket\}

Keeper の TCP ハンドラで、クライアントからのリクエストを受信して解析し終えるまでの時間（ミリ秒単位）。

### keeper_dispatcher_requests_queue_time_milliseconds_bucket \{#keeper_dispatcher_requests_queue_time_milliseconds_bucket\}

Keeper の dispatcher リクエストキュー内でリクエストが待機する時間（ミリ秒単位）。

### keeper_write_pre_commit_time_milliseconds_bucket \{#keeper_write_pre_commit_time_milliseconds_bucket\}

Raft コミットの前に書き込みリクエストを前処理するのに要する時間（ミリ秒）。

### keeper_write_commit_time_milliseconds_bucket \{#keeper_write_commit_time_milliseconds_bucket\}

Raft コミット完了後の書き込みリクエストの処理時間（ミリ秒単位）。

### keeper_dispatcher_responses_queue_time_milliseconds_bucket \{#keeper_dispatcher_responses_queue_time_milliseconds_bucket\}

Keeper ディスパッチャーのレスポンスキューで応答がキューに入っている時間（ミリ秒単位）。

### keeper_send_response_time_milliseconds_bucket \{#keeper_send_response_time_milliseconds_bucket\}

Keeper の TCP ハンドラーでクライアントへレスポンスを送信するまでの所要時間（キュー処理およびソケットへの書き込みを含む）。単位はミリ秒。

### keeper_read_wait_for_write_time_milliseconds_bucket \{#keeper_read_wait_for_write_time_milliseconds_bucket\}

読み取りリクエストが、自身が依存する書き込みリクエストの完了を待機する時間（ミリ秒単位）。

### keeper_read_process_time_milliseconds_bucket \{#keeper_read_process_time_milliseconds_bucket\}

Keeper における読み取りリクエストの処理時間（ミリ秒）。

### keeper_batch_size_elements_bucket \{#keeper_batch_size_elements_bucket\}

Raft に送信されるバッチの要素数。

### keeper_batch_size_bytes_bucket \{#keeper_batch_size_bytes_bucket\}

Raft に送信されるバッチのサイズ（バイト単位）。

**関連項目**

- [system.asynchronous_metrics](/operations/system-tables/asynchronous_metrics) — 定期的に計算されるメトリクスを含みます。
- [system.events](/operations/system-tables/events) — 発生したイベントの回数を含みます。
- [system.metric_log](/operations/system-tables/metric_log) — テーブル `system.metrics` および `system.events` のメトリクス値の履歴を含みます。
- [Monitoring](../../operations/monitoring.md) — ClickHouse の監視に関する基本的な概念。