---
description: '2026年の変更履歴'
note: "このファイルは yarn build によって生成されたものです"
slug: /whats-new/changelog/
sidebar_position: -9998
sidebar_label: '2026'
title: '2026年の変更履歴'
doc_type: 'changelog'
---

### ClickHouse リリース 26.1、2026-01-29。[プレゼンテーション](https://presentations.clickhouse.com/2026-release-26.1/)、[ビデオ](TODO) \{#261\}

#### 後方互換性を持たない変更 \{#backward-incompatible-change\}

* フォーマッタにおけるエイリアスの誤った置換によって発生していた一貫性のないフォーマットを修正します。これにより [#82833](https://github.com/ClickHouse/ClickHouse/issues/82833) がクローズされます。これにより [#82832](https://github.com/ClickHouse/ClickHouse/issues/82832) がクローズされます。これにより [#68296](https://github.com/ClickHouse/ClickHouse/issues/68296) がクローズされます。この変更は後方互換性に影響する可能性があります。analyzer が無効化されている場合、IN でエイリアスを参照している特定の CREATE VIEW クエリを処理できません。非互換性を避けるには、analyzer を有効化してください（24.3 以降はデフォルトで有効になっています）。[#82838](https://github.com/ClickHouse/ClickHouse/pull/82838)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* コーデック `DEFLATE_QPL` と `ZSTD_QAT` は削除されました。既存の `DEFLATE_QPL` または `ZSTD_QAT` で圧縮されたデータは、アップグレード前に別のコーデックへ変換することを推奨します。これらのコーデックを使用するには、設定 `enable_deflate_qpl_codec` および `enable_zstd_qat_codec` を有効にしておく必要があった点に注意してください。 [#92150](https://github.com/ClickHouse/ClickHouse/pull/92150)（[Robert Schulze](https://github.com/rschu1ze)）。
* `system.query_log.exception` における stderr キャプチャを有効化して UDF のデバッグを改善しました。以前は、UDF の stderr はファイルにのみログ出力され、クエリログには表示されなかったため、デバッグが不可能でした。今回の変更により、stderr はデフォルトで例外を発生させるようになり、スロー前に最大 1MB まで蓄積されます。その結果、`system.query_log.exception` に完全な Python のトレースバックとエラーメッセージが表示され、効果的なトラブルシューティングが可能になります。[#92209](https://github.com/ClickHouse/ClickHouse/pull/92209)（[Xu Jia](https://github.com/XuJia0210)）。
* `JOIN USING ()` 句における空のカラムリストは、現在は構文エラーと見なされるようになりました。以前はクエリ実行中に `INVALID_JOIN_ON_EXPRESSION` になるはずでしたが、`Join` ストレージとの結合など一部のケースでは `LOGICAL_ERROR` が発生していました。[#82502](https://github.com/ClickHouse/ClickHouse/issues/82502) をクローズ。[#92371](https://github.com/ClickHouse/ClickHouse/pull/92371)（[Vladimir Cherkasov](https://github.com/vdimir)）。
* JSON 型に対する SKIP REGEXP では、デフォルトで部分一致を使用するようにしました。[#79250](https://github.com/ClickHouse/ClickHouse/issues/79250) をクローズしました。[#92847](https://github.com/ClickHouse/ClickHouse/pull/92847)（[Pavel Kruglov](https://github.com/Avogar)）。
* 「simple な ALIAS カラムへの INSERT を許可する変更」をリバート（ClickHouse/ClickHouse[#84154](https://github.com/ClickHouse/ClickHouse/issues/84154) をリバート）。カスタムフォーマットでは動作せず、設定でも制御されていません。[#92849](https://github.com/ClickHouse/ClickHouse/pull/92849)（[Azat Khuzhin](https://github.com/azat)）。
* データレイクカタログがオブジェクトストレージにアクセスできない場合にエラーを発生させる設定。 [#93606](https://github.com/ClickHouse/ClickHouse/pull/93606) ([Konstantin Vedernikov](https://github.com/scanhex12)).
* `Lazy` データベースエンジンは削除され、利用できなくなりました。[#91231](https://github.com/ClickHouse/ClickHouse/issues/91231) をクローズしました。[#93627](https://github.com/ClickHouse/ClickHouse/pull/93627)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `metric_log` の `transposed_with_wide_view` モードを削除しました。このモードはバグにより使用できないためです。このモードで `system.metric_log` を定義することは、もはやできなくなりました。この変更により、[#78412](https://github.com/ClickHouse/ClickHouse/issues/78412) の一部が元に戻ります。[#93867](https://github.com/ClickHouse/ClickHouse/pull/93867)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* ワークロードのCPUスケジューリングは、既定でプリエンプティブになりました。`cpu_slot_preemption` サーバー設定を参照してください。 [#94060](https://github.com/ClickHouse/ClickHouse/pull/94060) ([Sergei Trifonov](https://github.com/serxa))。
* パーツの破損を防ぐため、索引ファイル名をエスケープするようにしました。この変更により、以前のバージョンで作成された、名前に非 ASCII 文字を含む索引は ClickHouse が読み込めなくなります。これに対処するには、MergeTree の設定 `escape_index_filenames` を使用してください。 [#94079](https://github.com/ClickHouse/ClickHouse/pull/94079) ([Raúl Marín](https://github.com/Algunenano)).
* フォーマット設定 `exact_rows_before_limit`、`rows_before_aggregation`、`cross_to_inner_join_rewrite`、`regexp_dict_allow_hyperscan`、`regexp_dict_flag_case_insensitive`、`regexp_dict_flag_dotall` および `dictionary_use_async_executor` は、通常の（非フォーマット）設定に変更されました。これは純粋に内部的な変更であり、（可能性は低いですが）Iceberg、DeltaLake、Kafka、S3、S3Queue、Azure、Hive、RabbitMQ、Set、FileLog、または NATS のテーブルエンジン定義でこれらの設定のいずれかを指定している場合を除き、ユーザーから見える副作用はありません。これらのケースでは、以前はこれらの設定は無視されていましたが、現在はそのような定義はエラーとなります。 [#94106](https://github.com/ClickHouse/ClickHouse/pull/94106) ([Robert Schulze](https://github.com/rschu1ze))。
* `joinGet/joinGetOrNull` 関数は、背後で使用される Join テーブルに対して `SELECT` 権限を必須とするようになりました。この変更以降、`joinGet('db.table', 'column', key)` を実行するには、Join テーブルで定義されているキー カラムと、取得対象の属性カラムの両方に対して `SELECT` 権限が必要です。これらの権限を持たないクエリは `ACCESS_DENIED` により失敗します。移行にあたっては、テーブル全体へのアクセスには `GRANT SELECT ON db.join_table TO user` を、カラム単位のアクセスには `GRANT SELECT(key_col, attr_col) ON db.join_table TO user` を使用して、必要な権限を付与してください。この変更は、明示的な `SELECT` 権限が事前に設定されていなかった `joinGet` / `joinGetOrNull` に依存するすべてのユーザーおよびアプリケーションに影響します。 [#94307](https://github.com/ClickHouse/ClickHouse/pull/94307) ([Vladimir Cherkasov](https://github.com/vdimir))。
* `CREATE TABLE ... AS ...` クエリについては、`SHOW COLUMNS` をチェックするようにしました。以前は `SHOW TABLES` をチェックしていましたが、この種の権限チェックとしては誤りでした。[#94556](https://github.com/ClickHouse/ClickHouse/pull/94556)（[pufit](https://github.com/pufit)）。
* `Hash` 出力フォーマットをブロックサイズに依存しないようにしました。[#94503](https://github.com/ClickHouse/ClickHouse/pull/94503)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。これにより、以前のバージョンと比べて出力されるハッシュ値が変わることに注意してください。

#### 新機能 \{#new-feature\}

* ClickHouse Keeper 用の HTTP API と組み込み Web UI。 [#78181](https://github.com/ClickHouse/ClickHouse/pull/78181) ([pufit](https://github.com/pufit)).
* 非同期挿入の重複排除が、依存する materialized view でも動作するようになりました。block&#95;id による衝突が発生した場合、元のブロックからその block&#95;id に関連付けられた行がフィルタリングで取り除かれ、残りの行に対して、関連するすべての materialized view の SELECT クエリが適用されます。これにより、競合する行を含まない元のブロックが再構築されます。 [#89140](https://github.com/ClickHouse/ClickHouse/pull/89140) ([Sema Checherinda](https://github.com/CheSema))。materialized view が関与している場合でも、非同期挿入で重複排除を使用できるようになりました。 [#93957](https://github.com/ClickHouse/ClickHouse/pull/93957) ([Sema Checherinda](https://github.com/CheSema))。
* projection 索引機能を簡素化し拡張するための新しい構文とフレームワークを導入しました。これは https://github.com/ClickHouse/ClickHouse/pull/81021 のフォローアップです。 [#91844](https://github.com/ClickHouse/ClickHouse/pull/91844) ([Amos Bird](https://github.com/amosbird))。
* `Array` カラム向けのテキスト索引サポートを追加。[#89895](https://github.com/ClickHouse/ClickHouse/pull/89895)（[Jimmy Aguilar Mena](https://github.com/Ergus)）。
* デフォルトで `use_variant_as_common_type` を有効にし、これにより `Array` 内や `UNION` クエリ内、`if` / `multiIf` / `case` の各分岐内で互換性のない型を使用できるようにしました。 [#90677](https://github.com/ClickHouse/ClickHouse/pull/90677) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 新しいシステムテーブル `zookeeper_info` を追加しました。[#88014](https://github.com/ClickHouse/ClickHouse/issues/88014) を実装しています。 [#90809](https://github.com/ClickHouse/ClickHouse/pull/90809)（[Smita Kulkarni](https://github.com/SmitaRKulkarni)）。
* すべての関数で `Variant` 型をサポートするようにしました。 [#90900](https://github.com/ClickHouse/ClickHouse/pull/90900) ([Bharat Nallan](https://github.com/bharatnc)).
* 主にバージョン情報を含む `ClickHouse_Info` メトリクスを Prometheus の `/metrics` エンドポイントに追加し、詳細なバージョン情報を時間の経過とともに追跡するチャートを作成できるようにしました。[#91125](https://github.com/ClickHouse/ClickHouse/pull/91125)（[Christoph Wurm](https://github.com/cwurm)）。
* keeper 向けにクラスタ構成を変更できる新しい4文字の `rcfg` コマンドを導入しました。このコマンドは、標準の `reconfigure` リクエストよりも柔軟かつ広範な構成変更を可能にします。コマンドは引数として `json` 文字列を受け取ります。TCP インターフェイスに送信されるバイト列全体は、次の形式になります: `rcfg{json_string_length_big_endian}{json_string}`。コマンドの例は次のとおりです: `{"preconditions": {"leaders": [1, 2], "members": [1, 2, 3, 4, 5]}, "actions": [{"transfer_leadership": [3]}, {"remove_members": [1, 2]}, {"set_priority": [{"id": 4, "priority": 100}, {"id": 5, "priority": 100}]}, {"transfer_leadership": [4, 5]}, {"set_priority": [{"id": 3, "priority": 0}]}]}`。[#91354](https://github.com/ClickHouse/ClickHouse/pull/91354)（[alesapin](https://github.com/alesapin)）。
* 指定された区切り文字で区切られた文字列内の部分文字列の順序を反転させる関数 `reverseBySeparator` を追加しました。 [#91463](https://github.com/ClickHouse/ClickHouse/issues/91463) をクローズしました。 [#91780](https://github.com/ClickHouse/ClickHouse/pull/91780) ([Xuewei Wang](https://github.com/Sallery-X)).
* 挿入ブロックの構成をより細かく制御できる新しい設定 `max_insert_block_size_bytes` を追加しました。 [#92833](https://github.com/ClickHouse/ClickHouse/pull/92833)（[Kirill Kopnev](https://github.com/Fgrtue)）。
* `ignore_on_cluster_for_replicated_database` 設定が有効な場合、Replicated データベースに対して `ON CLUSTER` 句付きの DDL クエリを実行できます。この場合、クラスター名は無視されます。 [#92872](https://github.com/ClickHouse/ClickHouse/pull/92872) ([Kirill](https://github.com/kirillgarbar)).
* `mergeTreeAnalyzeIndex` 関数を実装しました。 [#92954](https://github.com/ClickHouse/ClickHouse/pull/92954) ([Azat Khuzhin](https://github.com/azat)).
* 新しい設定 `use_primary_key` を追加しました。プライマリキーに基づく granule pruning を無効化するには、`false` に設定してください。 [#93319](https://github.com/ClickHouse/ClickHouse/pull/93319) ([Nihal Z. Miaji](https://github.com/nihalzp)).
* `icebergLocalCluster` テーブル関数を追加しました。 [#93323](https://github.com/ClickHouse/ClickHouse/pull/93323) ([Anton Ivashkin](https://github.com/ianton-ru)).
* 2 点間の [cosine distance](https://en.wikipedia.org/wiki/Cosine_similarity#Cosine_distance) を近似計算する `cosineDistanceTransposed` 関数を追加しました。 [#93621](https://github.com/ClickHouse/ClickHouse/pull/93621) ([Raufs Dunamalijevs](https://github.com/rienath))。
* 各データパーツのファイル数を示す `files` カラムを system.parts テーブルに追加しました。 [#94337](https://github.com/ClickHouse/ClickHouse/pull/94337) ([Match](https://github.com/gayanMatch)).
* 同時実行制御のために max-min 公平スケジューラを追加しました。多くのクエリが限られた CPU スロットを奪い合うような、高いオーバーサブスクリプション状態でも、より良い公平性を提供します。時間の経過とともに多くのスロットを蓄積した長時間実行クエリによって、短時間実行クエリが不利にならないようにします。`concurrent_threads_scheduler` サーバー設定の `max_min_fair` 値を指定することで有効になります。[#94732](https://github.com/ClickHouse/ClickHouse/pull/94732)（[Sergei Trifonov](https://github.com/serxa)）。
* ClickHouse クライアントがサーバーに接続する際に、TLS SNI を上書きできる機能を追加しました。 [#89761](https://github.com/ClickHouse/ClickHouse/pull/89761) ([Matt Klein](https://github.com/mattklein123)).
* `joinGet` 関数呼び出しで一時テーブルをサポートできるようにしました。 [#92973](https://github.com/ClickHouse/ClickHouse/pull/92973) ([Eduard Karacharov](https://github.com/korowa))。
* `DeltaLake` テーブルエンジンで deletion vectors をサポートしました。 [#93852](https://github.com/ClickHouse/ClickHouse/pull/93852) ([Kseniia Sumarokova](https://github.com/kssenii)).
* deltaLakeCluster で削除ベクターをサポートするようになりました。 [#94365](https://github.com/ClickHouse/ClickHouse/pull/94365) ([Kseniia Sumarokova](https://github.com/kssenii)).
* データレイク向けの Google Cloud Storage サポート。 [#93866](https://github.com/ClickHouse/ClickHouse/pull/93866) ([Konstantin Vedernikov](https://github.com/scanhex12)).

#### 実験的機能 \{#experimental-feature\}

* `QBit` を Experimental から Beta に移行しました。[#93816](https://github.com/ClickHouse/ClickHouse/pull/93816)（[Raufs Dunamalijevs](https://github.com/rienath)）。
* `Nullable(Tuple)` をサポートしました。有効にするには `allow_experimental_nullable_tuple_type = 1` を設定してください。[#89643](https://github.com/ClickHouse/ClickHouse/pull/89643)（[Nihal Z. Miaji](https://github.com/nihalzp)）。
* Paimon REST カタログをサポートしました（https://github.com/ClickHouse/ClickHouse/pull/84423 の継続として）。[#92011](https://github.com/ClickHouse/ClickHouse/pull/92011)（[JIaQi Tang](https://github.com/JiaQiTang98)）。

#### パフォーマンスの改善 \{#performance-improvement\}

* 設定 `use_skip_indexes_on_data_read` をデフォルトで有効化しました。この設定により、読み取りと同時にストリーミング形式でフィルタリングが可能になり、クエリのパフォーマンスと起動時間が向上します。 [#93407](https://github.com/ClickHouse/ClickHouse/pull/93407) ([Shankar Iyer](https://github.com/shankar-iyer)).
* Parquet リーダー v3 におけるデータレイクの PREWHERE および multistage PREWHERE。 [#89101](https://github.com/ClickHouse/ClickHouse/issues/89101) を解決します。 [#93542](https://github.com/ClickHouse/ClickHouse/pull/93542) ([Konstantin Vedernikov](https://github.com/scanhex12)).
* `LowCardinality` カラムに対する `DISTINCT` のパフォーマンスを向上させます。 [#5917](https://github.com/ClickHouse/ClickHouse/issues/5917) を解決します。 [#91639](https://github.com/ClickHouse/ClickHouse/pull/91639) ([Nihal Z. Miaji](https://github.com/nihalzp)).
* `distinctJSONPaths` 集計関数を最適化し、データパーツから JSON パスだけを読み取り、JSON カラム全体を読み取らないようにします。 [#92196](https://github.com/ClickHouse/ClickHouse/pull/92196) ([Pavel Kruglov](https://github.com/Avogar)).
* JOIN に対して、より多くのフィルターをプッシュダウンできるようにしました。 [#85556](https://github.com/ClickHouse/ClickHouse/pull/85556) ([Nikita Taranov](https://github.com/nickitat)).
* フィルターが一方の入力のみを使用する場合の JOIN ON 条件からのプッシュダウンを、より多くのケースでサポートします。`ANY`、`SEMI`、`ANTI` JOIN をサポートします。 [#92584](https://github.com/ClickHouse/ClickHouse/pull/92584) ([Dmitry Novik](https://github.com/novikd)).
* `SEMI JOIN` のフィルターのプッシュダウンに同値な集合を使用できるようにします。 [#85239](https://github.com/ClickHouse/ClickHouse/issues/85239) を解決します。 [#92837](https://github.com/ClickHouse/ClickHouse/pull/92837) ([Dmitry Novik](https://github.com/novikd)).
* 右側が空の場合、ハッシュ JOIN の左側読み取りをスキップします。以前は最初の非空ブロックまで左側を読み取っていましたが、重いフィルタリングや集計がある場合に多くの処理が発生する可能性がありました。 [#94062](https://github.com/ClickHouse/ClickHouse/pull/94062) ([Alexander Gololobov](https://github.com/davenger)).
* クエリーパイプライン内のデータパーティショニングに &quot;fastrange&quot; (Daniel Lemire) 手法を使用します。これにより、並列ソートと JOIN のパフォーマンスが向上する可能性があります。 [#93080](https://github.com/ClickHouse/ClickHouse/pull/93080) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* PARTITION BY がソートキーまたはそのプレフィックスと一致する場合のウィンドウ関数のパフォーマンスを向上させます。 [#87299](https://github.com/ClickHouse/ClickHouse/pull/87299) ([Nikita Taranov](https://github.com/nickitat)).
* 外部フィルターをビューにプッシュダウンし、ローカルおよびリモートノードで PREWHERE を適用できるようにします。 [#88189](https://github.com/ClickHouse/ClickHouse/issues/88189) を解決します。 [#88316](https://github.com/ClickHouse/ClickHouse/pull/88316) ([Igor Nikonov](https://github.com/devcrafter)).
* より多くの関数に対して JIT コンパイルを実装します。 [#73509](https://github.com/ClickHouse/ClickHouse/issues/73509) を解決します。 [#88770](https://github.com/ClickHouse/ClickHouse/pull/88770) ([Alexey Milovidov](https://github.com/alexey-milovidov) with [Taiyang Li](https://github.com/taiyang-li)).
* `FINAL` クエリで使用されるスキップインデックスがプライマリキーの一部を構成するカラムにある場合、他のパーツでのプライマリキー交差チェックの追加ステップは不要となり、これを実行しなくなりました。 [#85897](https://github.com/ClickHouse/ClickHouse/issues/85897) を解決します。 [#93899](https://github.com/ClickHouse/ClickHouse/pull/93899) ([Shankar Iyer](https://github.com/shankar-iyer)).
* 小数の `LIMIT` および `OFFSET` におけるパフォーマンスとメモリ使用量を最適化します。 [#91167](https://github.com/ClickHouse/ClickHouse/pull/91167) ([Ahmed Gouda](https://github.com/0xgouda)).
* Parquet Reader V3 プレフェッチャーの高速ランダム読み取りロジックの使用を修正します。 [#90890](https://github.com/ClickHouse/ClickHouse/issues/90890) を解決します。 [#91435](https://github.com/ClickHouse/ClickHouse/pull/91435) ([Arsen Muk](https://github.com/arsenmuk)).
* `icebergCluster` のパフォーマンスを向上させます。 [#91462](https://github.com/ClickHouse/ClickHouse/issues/91462) を解決します。 [#91537](https://github.com/ClickHouse/ClickHouse/pull/91537) ([Yang Jiang](https://github.com/Ted-Jiang)).
* 定数フィルターに対して仮想カラムでフィルタリングしないようにします。 [#91588](https://github.com/ClickHouse/ClickHouse/pull/91588) ([c-end](https://github.com/c-end)).
* 非常に広いテーブルに対する wide パーツを使用した INSERT/マージのメモリ使用量を、適応型書き込みバッファーを有効化することで削減します。暗号化ディスクに対する適応型書き込みバッファーのサポートを追加します。 [#92250](https://github.com/ClickHouse/ClickHouse/pull/92250) ([Azat Khuzhin](https://github.com/azat)).
* インデックス内の検索トークン数を削減することで、テキストインデックスと `sparseGrams` トークナイザーによる全文検索のパフォーマンスを向上させました。 [#93078](https://github.com/ClickHouse/ClickHouse/pull/93078) ([Anton Popov](https://github.com/CurtizJ)).
* 関数 `isValidASCII` を、true を返すケース（すなわち入力がすべて ASCII の場合）に対して最適化しました。 [#93347](https://github.com/ClickHouse/ClickHouse/pull/93347) ([Robert Schulze](https://github.com/rschu1ze)).
* 読み取り順最適化機能は、WHERE 条件により ORDER BY カラムが定数になる場合を認識し、効率的な逆順読み取りを可能にします。これにより、`WHERE tenant='42' ORDER BY tenant, event_time DESC` のようなマルチテナントクエリで、完全なソートを必要とする代わりに InReverseOrder を使用できるようになります。 [#94103](https://github.com/ClickHouse/ClickHouse/pull/94103) ([matanper](https://github.com/matanper)).
* メモリ消費を最適化するため、ASTLiteral の子要素の代わりに (string, integer) ペアで値パラメーターを格納する Enum AST 特殊クラスを導入します。 [#94178](https://github.com/ClickHouse/ClickHouse/pull/94178) ([Ilya Yatsishin](https://github.com/qoega)).
* 複数のレプリカに対する分散インデックス分析を実装します。共有ストレージやクラスタ内の大量データに有効です。これは SharedMergeTree (ClickHouse Cloud) に適用可能であり、共有ストレージ上の他の MergeTree テーブル種別にも適用可能になる可能性があります。 [#86786](https://github.com/ClickHouse/ClickHouse/pull/86786) ([Azat Khuzhin](https://github.com/azat)).
* JOIN ランタイムフィルターによるオーバーヘッドを、次のような場合にはそれらを無効化することで削減します： - ブルームフィルターでセットされているビット数が多すぎる場合 - 実行時にフィルタリングされる行が少なすぎる場合。 [#91578](https://github.com/ClickHouse/ClickHouse/pull/91578) ([Alexander Gololobov](https://github.com/davenger)).
* 相関サブクエリの入力を複数回評価するのを避けるため、メモリ内バッファーを使用します。 [#79890](https://github.com/ClickHouse/ClickHouse/issues/79890) の一部です。 [#91205](https://github.com/ClickHouse/ClickHouse/pull/91205) ([Dmitry Novik](https://github.com/novikd)).
* 並列レプリカ読み取りで、全レプリカが孤立範囲を奪い合うことを許可します。これにより、負荷分散が向上し、ロングテール遅延が低減されます。 [#91374](https://github.com/ClickHouse/ClickHouse/pull/91374) ([zoomxi](https://github.com/zoomxi)).
* 外部集計/ソート/JOIN では、すべてのコンテキストでクエリ設定 `temporary_files_codec` が適用されるようになりました。grace hash JOIN で記録されていなかったプロファイルイベントも修正しました。 [#92388](https://github.com/ClickHouse/ClickHouse/pull/92388) ([Vladimir Cherkasov](https://github.com/vdimir)).
* 集計/ソート中にディスクへのスピルを行う際の、クエリのメモリ使用量の検出をより堅牢にします。 [#92500](https://github.com/ClickHouse/ClickHouse/pull/92500) ([Azat Khuzhin](https://github.com/azat)).
* 集計キー カラムの総行数および NDV（distinct 値の数）統計を推定します。 [#92812](https://github.com/ClickHouse/ClickHouse/pull/92812) ([Alexander Gololobov](https://github.com/davenger)).
* simdcomp を用いたポスティングリスト圧縮を最適化します。 [#92871](https://github.com/ClickHouse/ClickHouse/pull/92871) ([Peng Jian](https://github.com/fastio)).
* バケットを使用した S3Queue の Ordered モード処理をリファクタリングします。これにより、パフォーマンスが向上し、keeper リクエスト数が減少するはずです。 [#92889](https://github.com/ClickHouse/ClickHouse/pull/92889) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 関数 `mapContainsKeyLike` および `mapContainsValueLike` が、それぞれ `mapKeys()` または `mapValues()` に対するテキストインデックスを活用できるようになりました。 [#93049](https://github.com/ClickHouse/ClickHouse/pull/93049) ([Michael Jarrett](https://github.com/EmeraldShift)).
* 非 Linux システムでのメモリ使用量を削減します（jemalloc のダーティページの即時パージを有効化）。 [#93360](https://github.com/ClickHouse/ClickHouse/pull/93360) ([Eduard Karacharov](https://github.com/korowa)).
* ダーティページサイズの `max_server_memory_usage` に対する比率が `memory_worker_purge_dirty_pages_threshold_ratio` を超えた場合に、jemalloc アリーナのパージを強制します。 [#93500](https://github.com/ClickHouse/ClickHouse/pull/93500) ([Eduard Karacharov](https://github.com/korowa)).
* AST のメモリ使用量を削減します。 [#93601](https://github.com/ClickHouse/ClickHouse/pull/93601) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* テーブルから読み取る際に ClickHouse がメモリ制限を守らないケースがありました。この問題を修正しました。 [#93715](https://github.com/ClickHouse/ClickHouse/pull/93715) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov)).
* `CHECK_STAT` および `TRY_REMOVE` Keeper 拡張機能をデフォルトで有効化します。 [#93886](https://github.com/ClickHouse/ClickHouse/pull/93886) ([Mikhail Artemenko](https://github.com/Michicosun)).
* Iceberg マニフェストファイルエントリから位置削除に対応するファイル名の上下限を解析し、対応するデータファイルの選択を改善します。 [#93980](https://github.com/ClickHouse/ClickHouse/pull/93980) ([Daniil Ivanik](https://github.com/divanik)).
* JSON カラム内の動的サブカラムの最大数を制御するための設定をさらに 2 つ追加します。1 つ目は MergeTree 設定 `merge_max_dynamic_subcolumns_in_compact_part`（すでに追加された `merge_max_dynamic_subcolumns_in_wide_part` に類似）で、Compact パーツへのマージ中に作成される動的サブカラムの数を制限します。2 つ目はクエリレベルの設定 `max_dynamic_subcolumns_in_json_type_parsing` で、JSON データの解析中に作成される動的サブカラムの数を制限し、INSERT 時に制限を指定できるようにします。 [#94184](https://github.com/ClickHouse/ClickHouse/pull/94184) ([Pavel Kruglov](https://github.com/Avogar)).
* 一部のケースで JSON カラムの圧縮をわずかに最適化します。 [#94247](https://github.com/ClickHouse/ClickHouse/pull/94247) ([Pavel Kruglov](https://github.com/Avogar)).
* 本番環境の経験に基づき、スレッドプールキューサイズを低減します。また、MergeTree からデータを読み取る前に明示的なメモリ消費チェックを追加します。 [#94692](https://github.com/ClickHouse/ClickHouse/pull/94692) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov)).
* CPU 飢餓状態ではスケジューラーが MemoryWorker スレッドを優先するようにします。これにより、ClickHouse プロセスを存在を脅かすレベルの危機から保護します。 [#94864](https://github.com/ClickHouse/ClickHouse/pull/94864) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov)).
* MemoryWorker のメンスレッドとは別のスレッドで jemalloc ダーティページのパージを実行します。パージが遅い場合、RSS 使用量の更新が遅延し、プロセスの OOM キルにつながる可能性があります。また、総メモリ使用量の比率に基づいてダーティページのパージを開始する新しい設定 `memory_worker_purge_total_memory_threshold_ratio` を導入します。 [#94902](https://github.com/ClickHouse/ClickHouse/pull/94902) ([Antonio Andelic](https://github.com/antonio2368)).

#### 改善 \{#improvement\}

* `system.blob_storage_log` が Azure Blob Storage での利用が可能になりました。 [#93105](https://github.com/ClickHouse/ClickHouse/pull/93105) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `blob_storage_log` を Local および HDFS 向けに実装しました。`S3Queue` が `blob_storage_log` でログ出力にディスク名以外の識別子を使用していた場合に発生していたエラーを修正しました。`blob_storage_log` に `error_code` カラムを追加しました。ローカルテストを容易にするためにテスト用設定ファイルを分割しました。 [#93106](https://github.com/ClickHouse/ClickHouse/pull/93106) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `clickhouse-client` と `clickhouse-local` は、数値リテラル入力時に桁区切り（千、百万など）を強調表示するようになりました。これにより [#93100](https://github.com/ClickHouse/ClickHouse/issues/93100) が解決されました。[#93108](https://github.com/ClickHouse/ClickHouse/pull/93108)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `clickhouse-client` で、等号の前後に空白を挟んだコマンドライン引数をサポートするようにしました。[#93077](https://github.com/ClickHouse/ClickHouse/issues/93077) をクローズ。[#93174](https://github.com/ClickHouse/ClickHouse/pull/93174)（[Cole Smith](https://github.com/colesmith54)）。
* `<interactive_history_legacy_keymap>true</interactive_history_legacy_keymap>` を使用すると、CLI クライアントは通常の検索には従来どおり Ctrl-R にフォールバックし、Ctrl-T でファジー検索を行えるようになりました。 [#87785](https://github.com/ClickHouse/ClickHouse/pull/87785) ([Larry Snizek](https://github.com/larry-cdn77)).
* キャッシュをクリアするためのステートメント `SYSTEM DROP [...] CACHE` は、そのステートメントがキャッシュを無効化するものだという誤った印象を与えていました。ClickHouse では、より明確な `SYSTEM CLEAR [...] CACHE` ステートメントがサポートされるようになりました。古い構文も引き続き利用可能です。[#93727](https://github.com/ClickHouse/ClickHouse/pull/93727)（[Pranav Tiwari](https://github.com/pranavt84)）。
* `EmbeddedRocksDB` で複数のカラムをプライマリキーとしてサポートします。 [#32819](https://github.com/ClickHouse/ClickHouse/issues/32819) をクローズします。 [#33917](https://github.com/ClickHouse/ClickHouse/pull/33917) ([usurai](https://github.com/usurai)).
* スカラ値に対して非定数の IN を使用できるようになりました（`val1 NOT IN if(cond, val2, val3)` のようなクエリ）。[#93495](https://github.com/ClickHouse/ClickHouse/pull/93495)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* サポートされていないため、`HeadObject`、`UploadPart` および `CompleteMultipartUpload` の各 S3 リクエストへ `x-amz-server-side-encryption` ヘッダーが伝播されないように防ぎます。 [#64577](https://github.com/ClickHouse/ClickHouse/pull/64577) ([Francisco J. Jurado Moreno](https://github.com/Beetelbrox)).
* `ALTER` クエリに対して `ALTER TABLE <table> ATTACH PART <part_name> FROM <directory_name>` という構文を追加しました。これにより、`detached/` ディレクトリ配下の任意のサブディレクトリからパーツをアタッチできるようになります。これは、`broken-on-start` や `unexpected` などのカスタムプレフィックスを持つパーツを、誤ってデタッチしてしまった場合に、手作業による介入なしで再アタッチする際に役立ちます。以前は、ファイルシステム上でディレクトリ名を手動で変更する必要がありました。[#74816](https://github.com/ClickHouse/ClickHouse/pull/74816)（[Anton Popov](https://github.com/CurtizJ)）。
* S3Queue の ordered モードにおいて Hive パーティショニングを追跡できるようにした。[#71161](https://github.com/ClickHouse/ClickHouse/issues/71161) を解決。[#81040](https://github.com/ClickHouse/ClickHouse/pull/81040) ([Anton Ivashkin](https://github.com/ianton-ru))。
* ファイルシステムキャッシュにおける領域予約を最適化しました。`FileCache::collectCandidatesForEviction` はユニークロックを取得せずに実行されるようになりました。 [#82764](https://github.com/ClickHouse/ClickHouse/pull/82764) ([Kseniia Sumarokova](https://github.com/kssenii)).
* サーバーログのサイズおよび時間に基づく複合ローテーション戦略をサポートしました。 [#87620](https://github.com/ClickHouse/ClickHouse/pull/87620) ([Jianmei Zhang](https://github.com/zhangjmruc)).
* CLI クライアントで、コマンドラインオプション `--no-warnings` の代わりに `<warnings>false</warnings>` を指定できるようになりました。 [#87783](https://github.com/ClickHouse/ClickHouse/pull/87783) ([Larry Snizek](https://github.com/larry-cdn77))。
* `avg` 集約関数で Date、DateTime、Time 型の値を引数として扱えるようにしました。[#82267](https://github.com/ClickHouse/ClickHouse/issues/82267) をクローズ。[#87845](https://github.com/ClickHouse/ClickHouse/pull/87845)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* 最適化機能 `use_join_disjunctions_push_down` はデフォルトで有効です。 [#89313](https://github.com/ClickHouse/ClickHouse/pull/89313) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 相関サブクエリで、より多くのテーブルエンジンおよびデータソースの種類をサポートしました。[#80775](https://github.com/ClickHouse/ClickHouse/issues/80775) をクローズ。[#90175](https://github.com/ClickHouse/ClickHouse/pull/90175)（[Dmitry Novik](https://github.com/novikd)）。
* パラメータ化されたビューのスキーマが明示的に指定されている場合、その内容が表示されます。 [#88875](https://github.com/ClickHouse/ClickHouse/issues/88875)、[#81385](https://github.com/ClickHouse/ClickHouse/issues/81385) をクローズしました。 [#90220](https://github.com/ClickHouse/ClickHouse/pull/90220)（[Grigorii Sokolik](https://github.com/GSokol)）。
* Keeper のログエントリで、最後にコミットされたインデックスより前のログが存在する場合、そのギャップを正しく処理するようにしました。 [#90403](https://github.com/ClickHouse/ClickHouse/pull/90403) ([Antonio Andelic](https://github.com/antonio2368)).
* JBOD ボリュームで正しく動作するように `min_free_disk_bytes_to_perform_insert` 設定を改善しました。 [#90878](https://github.com/ClickHouse/ClickHouse/pull/90878) ([Aleksandr Musorin](https://github.com/AVMusorin)).
* `S3` テーブルエンジンおよび `s3` テーブル関数向けの名前付きコレクションで、`storage_class_name` 設定を指定できるようにしました。 [#91926](https://github.com/ClickHouse/ClickHouse/pull/91926) ([János Benjamin Antal](https://github.com/antaljanosbenjamin)).
* `system.zookeeper` 経由で補助的な ZooKeeper を挿入できるようになりました。 [#92092](https://github.com/ClickHouse/ClickHouse/pull/92092) ([RinChanNOW](https://github.com/RinChanNOWWW)).
* Keeper 向けに新しいメトリクスを追加：`KeeperChangelogWrittenBytes`、`KeeperChangelogFileSyncMicroseconds`、`KeeperSnapshotWrittenBytes` および `KeeperSnapshotFileSyncMicroseconds` の profile events に加えて、`KeeperBatchSizeElements` と `KeeperBatchSizeBytes` の histogram metrics を追加しました。 [#92149](https://github.com/ClickHouse/ClickHouse/pull/92149) ([Miсhael Stetsyuk](https://github.com/mstetsyuk))。
* 新しい設定 `trace_profile_events_list` を追加し、`trace_profile_event` によるトレース対象を指定されたイベント名のリストに制限できるようにしました。これにより、大規模なワークロードに対して、より精度の高いデータ収集が可能になります。 [#92298](https://github.com/ClickHouse/ClickHouse/pull/92298) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 一時停止可能なフェイルポイント向けに SYSTEM NOTIFY FAILPOINT をサポートし、SYSTEM WAIT FAILPOINT fp の PAUSE/RESUME をサポート。[#92368](https://github.com/ClickHouse/ClickHouse/pull/92368) ([Shaohua Wang](https://github.com/tiandiwonder)).
* `system.data_skipping_indices` に `creation`（暗黙的/明示的）カラムを追加。[#92378](https://github.com/ClickHouse/ClickHouse/pull/92378)（[Raúl Marín](https://github.com/Algunenano)）。
* YTsaurus の dyn テーブルに対するカラム定義を Dictionary のソースに渡せるようにしました。 [#92391](https://github.com/ClickHouse/ClickHouse/pull/92391) ([MikhailBurdukov](https://github.com/MikhailBurdukov)).
* [#63985](https://github.com/ClickHouse/ClickHouse/pull/63985) で、ポートごとに TLS 構成に必要なすべてのパラメータを指定できるようになりました（[composable protocols](https://clickhouse.com/docs/operations/settings/composable-protocols) を参照）。これにより、グローバルな TLS 設定に依存する必要がなくなりました。しかし、この実装では依然として暗黙的にグローバルな `openSSL.server` 設定セクションの存在を前提としており、ポートごとに異なる TLS 構成が必要なセットアップとは競合してしまいます。たとえば keeper-in-server デプロイメントでは、keeper 間通信と ClickHouse クライアント接続それぞれに対して、別々の TLS 設定が必要です。[#92457](https://github.com/ClickHouse/ClickHouse/pull/92457)（[Miсhael Stetsyuk](https://github.com/mstetsyuk)）。
* バイナリ形式でデコードされる型ノードの総数を制限し、悪意のあるペイロードを防止する新しい設定 `input_format_binary_max_type_complexity` を導入しました。 [#92519](https://github.com/ClickHouse/ClickHouse/pull/92519) ([Raufs Dunamalijevs](https://github.com/rienath)).
* 実行中のタスクを `system.background_schedule_pool{,_log}` に反映するようにしました。ドキュメントを追加しました。 [#92587](https://github.com/ClickHouse/ClickHouse/pull/92587) ([Azat Khuzhin](https://github.com/azat)).
* 履歴に一致が見つからない場合、クライアントの Ctrl+R 検索時に現在のクエリを実行するようにしました。 [#92749](https://github.com/ClickHouse/ClickHouse/pull/92749) ([Azat Khuzhin](https://github.com/azat)).
* `EXPLAIN indexes = 1` のエイリアスとして `EXPLAIN indices = 1` をサポートします。 [#92483](https://github.com/ClickHouse/ClickHouse/issues/92483) をクローズします。 [#92774](https://github.com/ClickHouse/ClickHouse/pull/92774)（[Pranav Tiwari](https://github.com/pranavt84)）。
* Parquet リーダーでは、Tuple 型または Map 型のカラムを JSON として読み取れるようになりました。`f.parquet` 内のカラム `x` の型が Tuple または Map であっても、`select x from file(f.parquet, auto, 'x JSON')` が動作します。 [#92864](https://github.com/ClickHouse/ClickHouse/pull/92864) ([Michael Kolupaev](https://github.com/al13n321)).
* Parquet リーダーで空の Tuple をサポートしました。[#92868](https://github.com/ClickHouse/ClickHouse/pull/92868) ([Michael Kolupaev](https://github.com/al13n321)).
* Azure Blob Storage でネイティブコピーが BadRequest（例: 不正なブロックリスト）で失敗した場合に、読み取り・書き込みコピーへのフォールバックを行うようにしました。これまでは、異なるストレージアカウント間で BLOB をコピーする際に発生していた Unauthorized エラーに対してのみフォールバックしていました。しかし、「The specified block list is invalid」エラーが発生することもあります。そのため、すべてのネイティブコピー失敗時に読み取り・書き込みにフォールバックするよう条件を更新しました。 [#92888](https://github.com/ClickHouse/ClickHouse/pull/92888) ([Smita Kulkarni](https://github.com/SmitaRKulkarni)).
* 多数の S3 クエリを EC2 インスタンスプロファイル認証情報で同時に実行する際に発生していた、EC2 メタデータエンドポイントのスロットリングの問題を修正しました。以前は、各クエリが独自の `AWSInstanceProfileCredentialsProvider` を作成していたため、EC2 メタデータサービスへの同時リクエストが発生し、その結果、タイムアウトや `HTTP response code: 403` エラーが発生する可能性がありました。現在は、認証情報プロバイダーがキャッシュされ、すべてのクエリ間で共有されます。 [#92891](https://github.com/ClickHouse/ClickHouse/pull/92891) ([Sav](https://github.com/sberss))。
* `insert_select_deduplicate` 設定を再設計し、後方互換性を維持できるようにしました。 [#92951](https://github.com/ClickHouse/ClickHouse/pull/92951) ([Sema Checherinda](https://github.com/CheSema)).
* バックグラウンドタスクのうち平均より遅いもののみをログに記録するようにして（`background_schedule_pool_log.duration_threshold_milliseconds=30`）、タスクログが過剰にならないようにしました。[#92965](https://github.com/ClickHouse/ClickHouse/pull/92965) ([Azat Khuzhin](https://github.com/azat)).
* 以前のバージョンでは、一部の C++ 関数名が `system.trace_log` および `system.symbols` 内で正しく表示されず（「mangled」された形で表示され）、`demangle` 関数もそれらを適切に処理できていませんでした。これにより [#93074](https://github.com/ClickHouse/ClickHouse/issues/93074) がクローズされました。 [#93075](https://github.com/ClickHouse/ClickHouse/pull/93075) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* `backup_data_from_refreshable_materialized_view_targets` というバックアップ設定を導入し、リフレッシャブルmaterialized view のバックアップをスキップできるようにしました。APPEND リフレッシュ戦略を持つ RMV は常にバックアップされます。 [#93076](https://github.com/ClickHouse/ClickHouse/pull/93076) ([Julia Kartseva](https://github.com/jkartseva)). [#93658](https://github.com/ClickHouse/ClickHouse/pull/93658) ([Julia Kartseva](https://github.com/jkartseva))
* 関数などの重い翻訳単位については、デバッグ情報を一切生成しないのではなく、最小限のデバッグ情報を生成するようにしました。 [#93079](https://github.com/ClickHouse/ClickHouse/pull/93079) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* MinIO 固有のエラーに対するエラーコードのマッピングを実装することで、AWS S3 C++ SDK に MinIO 互換サポートを追加しました。この変更により、AWS S3 の代わりに MinIO デプロイメントを使用している場合でも、ClickHouse が MinIO サーバーエラーを適切に処理して再試行できるようになり、セルフホストされた MinIO クラスター上でオブジェクトストレージを運用しているユーザーの信頼性が向上します。 [#93082](https://github.com/ClickHouse/ClickHouse/pull/93082) ([XiaoBinMu](https://github.com/Binnn-MX)).
* シンボル化された jemalloc プロファイルを書き出し、ヒーププロファイル生成時にバイナリが不要になるようにしました。 [#93099](https://github.com/ClickHouse/ClickHouse/pull/93099) ([Azat Khuzhin](https://github.com/azat)).
* `clickhouse git-import` ツールを復活させました。大きなコミットや不正なコミットを処理する際に壊れていました。https://presentations.clickhouse.com/2020-matemarketing/ を参照してください。 [#93202](https://github.com/ClickHouse/ClickHouse/pull/93202) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* URL ストレージに含まれるパスワードをクエリログに表示しないようにしました。 [#93245](https://github.com/ClickHouse/ClickHouse/pull/93245) ([Konstantin Vedernikov](https://github.com/scanhex12)).
* `flipCoordinates` が `Geometry` 型をサポートするようになりました。 [#93303](https://github.com/ClickHouse/ClickHouse/pull/93303) ([Bharat Nallan](https://github.com/bharatnc)).
* SYSTEM INSTRUMENT の ADD/REMOVE 操作の UX を改善: 関数名に String リテラルを使用し、一致するすべての関数にパッチを適用し、`REMOVE` で function&#95;name を使用できるようにしました。 [#93345](https://github.com/ClickHouse/ClickHouse/pull/93345) ([Pablo Marcos](https://github.com/pamarcos)).
* マージ処理中に統計をマテリアライズするかどうかを制御する新しい設定 `materialize_statistics_on_merge` を追加しました。デフォルト値は `1` です。 [#93379](https://github.com/ClickHouse/ClickHouse/pull/93379) ([Han Fei](https://github.com/hanfei1991))。
* ClickHouse では、`DESCRIBE SELECT` クエリにおける `SELECT` を、かっこで囲まずにパースできるようになりました。 [#58382](https://github.com/ClickHouse/ClickHouse/issues/58382) をクローズしました。 [#93429](https://github.com/ClickHouse/ClickHouse/pull/93429) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* キャッシュの正しさ検証を一定の確率で実行するようにしました。 [#93439](https://github.com/ClickHouse/ClickHouse/pull/93439) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 設定 `type_json_allow_duplicated_key_with_literal_and_nested_object` を追加し、リテラルとネストされたオブジェクトが混在する JSON 内で重複したパスを許可できるようにしました。例: `{"a" : 42, "a" : {"b" : 42}}`。一部のデータは、重複パスに対するこの制約が https://github.com/ClickHouse/ClickHouse/pull/79317 で導入される前に作成されたものであり、そのようなデータを後から操作すると、現在ではエラーになる可能性があります。この設定を使用すると、そのような古いデータもエラーなしで引き続き利用できます。 [#93604](https://github.com/ClickHouse/ClickHouse/pull/93604) ([Pavel Kruglov](https://github.com/Avogar)).
* Pretty JSON でプリミティブ型の値を別々の行に出力しないようにしました。 [#93836](https://github.com/ClickHouse/ClickHouse/pull/93836) ([Pavel Kruglov](https://github.com/Avogar)).
* 多くの `alter table ... modify setting ...` 文がある場合、5秒以内にロックを取得できないことがあります。その場合は `logical error` よりも `timeout` を返す方が望ましいです。 [#93856](https://github.com/ClickHouse/ClickHouse/pull/93856) ([Han Fei](https://github.com/hanfei1991)).
* 構文エラー発生時の出力が過剰にならないようにしました。この変更以前は、多数のクエリを含む可能性のある SQL スクリプト全体を出力していました。 [#93876](https://github.com/ClickHouse/ClickHouse/pull/93876) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* Keeper で統計情報付きの `check` リクエストのバイト数を正しく計算するようにしました。 [#93907](https://github.com/ClickHouse/ClickHouse/pull/93907) ([Mikhail Artemenko](https://github.com/Michicosun)).
* 実行時のハッシュテーブルサイズの統計情報を結合の再順序付けに利用するかどうかを制御するための `use_hash_table_stats_for_join_reordering` 設定を追加しました。この設定はデフォルトで有効になっており、`collect_hash_table_stats_during_joins` の既存の挙動が維持されます。[#93912](https://github.com/ClickHouse/ClickHouse/pull/93912)（[Vladimir Cherkasov](https://github.com/vdimir)）。
* ユーザーは、`system.server_settings` テーブル内のネストされたグローバルサーバー設定（例：`logger.level`）の一部を表示できるようになりました。これは、固定構造を持つ設定（リスト、列挙型、繰り返しなどを含まないもの）のみに対応します。 [#94001](https://github.com/ClickHouse/ClickHouse/pull/94001)（[Hechem Selmi](https://github.com/m-selmi)）。
* `QBit` 同士を等価比較できるようになりました。 [#94078](https://github.com/ClickHouse/ClickHouse/pull/94078) ([Raufs Dunamalijevs](https://github.com/rienath)).
* Keeper が破損したスナップショットや不整合な変更ログを検出した場合、手動でアボートしたりファイルを自動的にクリーンアップしたりするのではなく、例外をスローするようにしました。これにより、手動での介入に依存する Keeper の動作がより安全になります。 [#94168](https://github.com/ClickHouse/ClickHouse/pull/94168) ([Antonio Andelic](https://github.com/antonio2368)).
* `CREATE TABLE` が失敗した場合に不要な残りが残る可能性があった問題を修正。 [#94174](https://github.com/ClickHouse/ClickHouse/pull/94174) ([Azat Khuzhin](https://github.com/azat)).
* パスワードで保護された TLS 秘密鍵が使用されている場合に発生する OpenSSL の未初期化メモリアクセスのバグを修正しました。 [#94182](https://github.com/ClickHouse/ClickHouse/pull/94182) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* chdig を [v26.1.1](https://github.com/azat/chdig/releases/tag/v26.1.1) に更新しました。 [#94290](https://github.com/ClickHouse/ClickHouse/pull/94290)（[Azat Khuzhin](https://github.com/azat)）。
* S3Queue の ordered モードで、より汎用的なパーティショニングをサポートするようにしました。 [#94321](https://github.com/ClickHouse/ClickHouse/pull/94321) ([Bharat Nallan](https://github.com/bharatnc)).
* 設定 `allow_statistics_optimize` にエイリアス `use_statistics` を追加しました。これにより、既存の設定 `use_primary_key` および `use_skip_indexes` との一貫性が高まりました。 [#94366](https://github.com/ClickHouse/ClickHouse/pull/94366) ([Robert Schulze](https://github.com/rschu1ze)).
* Numbers から Enum への変換時に要素が存在するかどうかを確認するため、`input_format_numbers_enum_on_conversion_error` 設定を有効にしました。 [#94384](https://github.com/ClickHouse/ClickHouse/pull/94384) ([Elmi Ahmadov](https://github.com/ahmadov)).
* S3(Azure)Queue の Ordered モードにおいて、制限を追跡することで失敗したノードのクリーンアップを行うようにしました（これまでは Unordered モードで、失敗ノードおよび処理済みノードの両方に対してのみ行われていたため、今後は Ordered モードでも失敗ノードに対してのみ実行されます）。 [#94412](https://github.com/ClickHouse/ClickHouse/pull/94412) ([Kseniia Sumarokova](https://github.com/kssenii)).
* clickhouse-local で `default` ユーザーに対してアクセス管理を有効化しました。`clickhouse-local` の `default` ユーザーには access&#95;management 権限が付与されておらず、そのため本来制限を受けないはずのユーザーであるにもかかわらず、`DROP ROW POLICY IF EXISTS` のような操作が `ACCESS_DENIED` エラーで失敗していました。 [#94501](https://github.com/ClickHouse/ClickHouse/pull/94501) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* YTsaurus の辞書およびテーブルで named collection を有効化しました。 [#94582](https://github.com/ClickHouse/ClickHouse/pull/94582) ([MikhailBurdukov](https://github.com/MikhailBurdukov)).
* S3 および Azure Blob Storage 向けの SQL で定義された名前付きコレクションを BACKUP/RESTORE でサポートしました。[#94604](https://github.com/ClickHouse/ClickHouse/issues/94604) をクローズ。[#94605](https://github.com/ClickHouse/ClickHouse/pull/94605)（[Pablo Marcos](https://github.com/pamarcos)）。
* ordered モードにおける S3Queue 向けに、パーティションキーに基づくバケット分割をサポートしました。 [#94698](https://github.com/ClickHouse/ClickHouse/pull/94698) ([Bharat Nallan](https://github.com/bharatnc)).
* 最も長く実行中のマージの経過時間を表す非同期メトリクスを追加しました。 [#94825](https://github.com/ClickHouse/ClickHouse/pull/94825) ([Raúl Marín](https://github.com/Algunenano)).
* IcebergBitmapPositionDeleteTransform を使用してポジション削除を適用する前に、対応するファイルのチェックを追加。 [#94897](https://github.com/ClickHouse/ClickHouse/pull/94897) ([Yang Jiang](https://github.com/Ted-Jiang)).
* `view_duration_ms` は、グループ内のスレッドの実行時間の合計ではなく、そのグループがアクティブだった時間を示すようになりました。 [#94966](https://github.com/ClickHouse/ClickHouse/pull/94966) ([Sema Checherinda](https://github.com/CheSema)).
* `hasAnyTokens` と `hasAllTokens` 関数における検索トークン数の最大数（64 個に制限されていた）の制限を削除しました。例: `SELECT count() FROM table WHERE hasAllTokens(text, ['token_1', 'token_2', [...], 'token_65']]);` このクエリは検索トークンが 65 個あるため、`BAD_ARGUMENTS` エラーになっていました。この PR により、この制限は完全に撤廃され、同じクエリはエラーなく実行されます。 [#95152](https://github.com/ClickHouse/ClickHouse/pull/95152) ([Elmi Ahmadov](https://github.com/ahmadov)).
* Numbers から Enums 型への変換時に値が存在するかどうかをチェックするための `input_format_numbers_enum_on_conversion_error` SETTING を追加しました。関連 Issue: [#56144](https://github.com/ClickHouse/ClickHouse/issues/56144)。[#56240](https://github.com/ClickHouse/ClickHouse/pull/56240)（[Nikolay Degterinsky](https://github.com/evillique)）。
* Iceberg テーブルにおいて、データファイルと position delete ファイルの読み取り間でフォーマットパーサーのリソースを共有し、メモリ割り当てを削減しました。 [#94701](https://github.com/ClickHouse/ClickHouse/pull/94701) ([Yang Jiang](https://github.com/Ted-Jiang)).

#### バグ修正(公式安定版リリースにおけるユーザー可視の不具合) \{#bug-fix-user-visible-misbehavior-in-an-official-stable-release\}

* 事前定義済みのクエリハンドラーで、挿入時に末尾の空白がデータとして解釈されてしまう不具合を修正。 [#83604](https://github.com/ClickHouse/ClickHouse/pull/83604) ([Fabian Ponce](https://github.com/FabianPonce))。
* Join ストレージに対して outer から inner への join 最適化が適用された場合に発生していた INCOMPATIBLE&#95;TYPE&#95;OF&#95;JOIN エラーを修正しました。 [#80794](https://github.com/ClickHouse/ClickHouse/issues/80794) を解決しました。 [#84292](https://github.com/ClickHouse/ClickHouse/pull/84292)（[Vladimir Cherkasov](https://github.com/vdimir)）。
* `allow_experimental_join_right_table_sorting` を有効にした状態でハッシュ結合を使用する際に発生する例外「Invalid number of rows in Chunk」を修正しました。 [#86440](https://github.com/ClickHouse/ClickHouse/pull/86440) ([yanglongwei](https://github.com/ylw510)).
* ファイルシステムが大文字小文字を区別しない場合は、MergeTree で常にファイル名をハッシュに置き換えるようにしました。これまでは、大文字小文字を区別しないファイルシステム（macOS など）では、複数のカラム／サブカラム名が大文字小文字だけ異なる場合にデータ破損を招く可能性がありました。 [#86559](https://github.com/ClickHouse/ClickHouse/pull/86559) ([Pavel Kruglov](https://github.com/Avogar)).
* materialized view 内部の基礎となるクエリに対して、CREATE 段階で完全な権限チェックを行うようにしました。 [#89180](https://github.com/ClickHouse/ClickHouse/pull/89180) ([pufit](https://github.com/pufit)).
* 定数引数でクラッシュしていた `icebergHash` 関数を修正しました。 [#90335](https://github.com/ClickHouse/ClickHouse/pull/90335) ([Michael Kolupaev](https://github.com/al13n321)).
* トランザクションを伴わない mutation が、最終的にロールバックされるアクティブなトランザクション内のパーツを変更してしまうという論理エラーを修正しました。 [#90469](https://github.com/ClickHouse/ClickHouse/pull/90469) ([Shaohua Wang](https://github.com/tiandiwonder)).
* Ordinary データベースを Atomic データベースに変換した後に、`system.warnings` が正しく更新されるようになりました。 [#90473](https://github.com/ClickHouse/ClickHouse/pull/90473) ([sdk2](https://github.com/sdk2)).
* Parquet ファイルの読み取り時に、クエリ内の別の場所で **prewhere** 式の一部が使用されている場合に発生するアサーション失敗を修正します。 [#90635](https://github.com/ClickHouse/ClickHouse/pull/90635) ([Max Kainov](https://github.com/maxknv)).
* Iceberg をバケット分割モードで読み込む際に、単一ノードクラスタで発生していたクラッシュを修正しました。これにより [#90913](https://github.com/ClickHouse/ClickHouse/issues/90913#issue-3668583963) がクローズされます。[#91553](https://github.com/ClickHouse/ClickHouse/pull/91553)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* サブカラム読み取り時の Log エンジンにおける発生しうる論理エラーを修正。[#91710](https://github.com/ClickHouse/ClickHouse/issues/91710) をクローズ。[#91711](https://github.com/ClickHouse/ClickHouse/pull/91711)（[Pavel Kruglov](https://github.com/Avogar)）。
* ATTACH AS REPLICATED 実行時に発生する「Storage does not support transaction」という論理エラーを修正。 [#91772](https://github.com/ClickHouse/ClickHouse/pull/91772) ([Shaohua Wang](https://github.com/tiandiwonder))。
* LEFT ANTI JOIN に追加の post-condition がある場合に runtime フィルタが正しく動作しない問題を修正しました。 [#91824](https://github.com/ClickHouse/ClickHouse/pull/91824) ([Alexander Gololobov](https://github.com/davenger)).
* Nothing 型を含む null セーフな比較で発生していたエラーを修正します。[#91834](https://github.com/ClickHouse/ClickHouse/issues/91834) をクローズ。[#84870](https://github.com/ClickHouse/ClickHouse/issues/84870) をクローズ。[#91821](https://github.com/ClickHouse/ClickHouse/issues/91821) をクローズ。[#91884](https://github.com/ClickHouse/ClickHouse/pull/91884)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* 非常に繰り返しの多い文字列データに影響する、ネイティブ Parquet リーダーの DELTA&#95;BYTE&#95;ARRAY デコード処理のバグを修正しました。 [#91929](https://github.com/ClickHouse/ClickHouse/pull/91929) ([Daniel Muino](https://github.com/dmuino)).
* スキーマ推論時に、グロブでマッチしたすべてのファイルではなく、推論元となったファイルのみのスキーマをキャッシュするようにしました。 [#91745](https://github.com/ClickHouse/ClickHouse/issues/91745) をクローズ。 [#92006](https://github.com/ClickHouse/ClickHouse/pull/92006) ([Pavel Kruglov](https://github.com/Avogar))。
* 誤ったアーカイブエントリのサイズヘッダーが原因で発生する `Couldn't pack tar archive: Failed to write all bytes` エラーを修正。 [#89075](https://github.com/ClickHouse/ClickHouse/issues/89075) を解決。[#92122](https://github.com/ClickHouse/ClickHouse/pull/92122)（[Julia Kartseva](https://github.com/jkartseva)）。
* `INSERT SELECT` においてリクエストストリームを解放し、HTTP 接続が閉じられてしまうのを防ぎます。 [#92175](https://github.com/ClickHouse/ClickHouse/pull/92175) ([Sema Checherinda](https://github.com/CheSema)).
* `USING` 句と `join_use_nulls` を使用する複数の JOIN を含むクエリで発生していた論理エラーを修正しました。 [#92251](https://github.com/ClickHouse/ClickHouse/pull/92251) ([Vladimir Cherkasov](https://github.com/vdimir))。
* join&#95;use&#95;nulls 使用時の結合再順序付けにおける論理エラーを修正し、https://github.com/clickhouse/clickhouse/issues/90795 をクローズ。 [#92289](https://github.com/ClickHouse/ClickHouse/pull/92289) ([Vladimir Cherkasov](https://github.com/vdimir)).
* negate リテラルを含む arrayElement の AST フォーマットの不整合を修正。[#92288](https://github.com/ClickHouse/ClickHouse/issues/92288)、[#92212](https://github.com/ClickHouse/ClickHouse/issues/92212)、[#91832](https://github.com/ClickHouse/ClickHouse/issues/91832)、[#91789](https://github.com/ClickHouse/ClickHouse/issues/91789)、[#91735](https://github.com/ClickHouse/ClickHouse/issues/91735)、[#88495](https://github.com/ClickHouse/ClickHouse/issues/88495)、[#92386](https://github.com/ClickHouse/ClickHouse/issues/92386) をクローズ。[#92293](https://github.com/ClickHouse/ClickHouse/pull/92293)（[Pavel Kruglov](https://github.com/Avogar)）。
* `join_on_disk_max_files_to_merge` SETTING で発生し得るクラッシュを修正。 [#92335](https://github.com/ClickHouse/ClickHouse/pull/92335) ([Bharat Nallan](https://github.com/bharatnc))。
* 関連する issue：https://github.com/ClickHouse/support-escalation/issues/6365。 [#92339](https://github.com/ClickHouse/ClickHouse/pull/92339)（[Tuan Pham Anh](https://github.com/tuanpach)）。
* `SYSTEM SYNC FILE CACHE` における欠落していたアクセスチェックを修正。[#92101](https://github.com/ClickHouse/ClickHouse/issues/92101) をクローズ。[#92372](https://github.com/ClickHouse/ClickHouse/pull/92372)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* ウィンドウ関数および複数の引数に対する `count_distinct_optimization` の処理を修正。 [#92376](https://github.com/ClickHouse/ClickHouse/pull/92376) ([Raúl Marín](https://github.com/Algunenano)).
* 特定の集計関数をウィンドウ関数と併用した際に発生する「Cannot write to finalized buffer」エラーを修正しました。[#91415](https://github.com/ClickHouse/ClickHouse/issues/91415) をクローズ。[#92395](https://github.com/ClickHouse/ClickHouse/pull/92395)（[Jimmy Aguilar Mena](https://github.com/Ergus)）。
* `CREATE TABLE ... AS urlCluster()` とデータベースエンジン `Replicated` を使用した場合の論理エラーを修正しました。[#92216](https://github.com/ClickHouse/ClickHouse/issues/92216) をクローズ。[#92418](https://github.com/ClickHouse/ClickHouse/pull/92418)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* MergeTree における mutation 実行時に、ソースパーツのシリアライゼーション情報の設定を継承するようにしました。これにより、データ型シリアライゼーションの変更後に、mutation 後のパーツに対するクエリ結果が誤ったものになる可能性があった問題が修正されます。 [#92419](https://github.com/ClickHouse/ClickHouse/pull/92419) ([Pavel Kruglov](https://github.com/Avogar)).
* 同じ名前を持つカラムとサブカラムの競合により、誤ったシリアライゼーションが使用されてクエリが失敗する可能性があった問題を修正しました。[#90219](https://github.com/ClickHouse/ClickHouse/issues/90219) をクローズ。[#85161](https://github.com/ClickHouse/ClickHouse/issues/85161) をクローズ。[#92453](https://github.com/ClickHouse/ClickHouse/pull/92453)（[Pavel Kruglov](https://github.com/Avogar)）。
* 外部結合を内部結合に変換する際に、意図しないクエリプランの変更によって発生していた `LOGICAL_ERROR` を修正しました。また、結合時に集約キーへ単射関数が適用されているケースでもこの最適化を適用できるよう、要件を緩和しました。 [#92503](https://github.com/ClickHouse/ClickHouse/pull/92503) ([János Benjamin Antal](https://github.com/antaljanosbenjamin)).
* 空のタプルカラムのソート中に発生しうるエラー `SIZES_OF_COLUMNS_DOESNT_MATCH` を修正しました。 [#92422](https://github.com/ClickHouse/ClickHouse/issues/92422) をクローズしました。 [#92520](https://github.com/ClickHouse/ClickHouse/pull/92520)（[Pavel Kruglov](https://github.com/Avogar)）。
* JSON 型の互換性のない型付きパスをチェックするようにしました。[#91577](https://github.com/ClickHouse/ClickHouse/issues/91577) をクローズ。[#92539](https://github.com/ClickHouse/ClickHouse/pull/92539)（[Pavel Kruglov](https://github.com/Avogar)）。
* Backup データベースに対する SHOW CREATE DATABASE で発生するデッドロックを修正。 [#92541](https://github.com/ClickHouse/ClickHouse/pull/92541) ([Azat Khuzhin](https://github.com/azat)).
* hypothesis 索引の検証時に、適切なエラーコードが使用されるようにしました。 [#92559](https://github.com/ClickHouse/ClickHouse/pull/92559) ([Raúl Marín](https://github.com/Algunenano)).
* analyzer におけるカラムエイリアス内の動的サブカラムの解決処理を修正しました。以前は、カラムエイリアス内の動的サブカラムは `getSubcolumn` でラップされており、場合によってはまったく解決されないことがありました。[#91434](https://github.com/ClickHouse/ClickHouse/issues/91434) をクローズします。[#92583](https://github.com/ClickHouse/ClickHouse/pull/92583)（[Pavel Kruglov](https://github.com/Avogar)）。
* 第二引数が null の場合に `tokens()` がクラッシュする問題を修正しました。 [#92586](https://github.com/ClickHouse/ClickHouse/pull/92586) ([Raúl Marín](https://github.com/Algunenano)).
* 基になる const PREWHERE カラムをインプレースで変更することにより発生し得るクラッシュを修正しました。これは、カラムの縮小（`IColumn::shrinkToFit`）やフィルタリング（`IColumn::filter`）が複数スレッドから同時にトリガーされた場合に発生する可能性がありました。 [#92588](https://github.com/ClickHouse/ClickHouse/pull/92588) ([Arsen Muk](https://github.com/arsenmuk)).
* 巨大なパーツ（4,294,967,295 行を超える）を含むテーブル上でのテキストインデックスの作成およびマテリアライズは、一時的に無効化されています。この制限は、現在のインデックス実装がそのような大きなパーツをまだサポートしておらず、不正確なクエリ結果が返されるのを防ぐためのものです。 [#92644](https://github.com/ClickHouse/ClickHouse/pull/92644) ([Anton Popov](https://github.com/CurtizJ)).
* JOIN の実行中に発生していた論理エラー `Too large size (A) passed to allocator` を修正します。[#92043](https://github.com/ClickHouse/ClickHouse/issues/92043) をクローズします。[#92667](https://github.com/ClickHouse/ClickHouse/pull/92667)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* `ngrambf_v1` 索引で ngram 長さ（第 1 パラメータ）が 8 を超える場合に例外がスローされる不具合を修正しました。 [#92672](https://github.com/ClickHouse/ClickHouse/pull/92672) ([Robert Schulze](https://github.com/rschu1ze)).
* ZooKeeper ストレージが使用されている場合に、バックグラウンドでの名前付きコレクション再読み込み中に発生する未処理例外を修正します。https://github.com/ClickHouse/clickhouse-private/issues/44180 をクローズします。[#92717](https://github.com/ClickHouse/ClickHouse/pull/92717)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* ワイルドカードによるアクセス権付与チェックにおけるロジックの誤りを修正します。以前の試みである https://github.com/ClickHouse/ClickHouse/pull/90928 は重大な脆弱性に対処しましたが、結果として制約が厳しすぎるものとなり、無関係な `REVOKE` によって一部のワイルドカード付き `GRANT` 文が失敗する状況を招いていました。[#92725](https://github.com/ClickHouse/ClickHouse/pull/92725)（[pufit](https://github.com/pufit)）。
* `WHERE` で `not match(...)` が使用された場合に誤った結果が返されていた data skipping ロジックのバグを修正します。[#92492](https://github.com/ClickHouse/ClickHouse/issues/92492) をクローズ。[#92726](https://github.com/ClickHouse/ClickHouse/pull/92726)（[Nihal Z. Miaji](https://github.com/nihalzp)）。
* 読み取り専用ディスク上に MergeTree テーブルが CREATE されている場合、起動時に一時ディレクトリを削除しようと試みないようにしました。 [#92748](https://github.com/ClickHouse/ClickHouse/pull/92748) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* ALTER TABLE REWRITE PARTS (v2) での「Cannot add action to empty ExpressionActionsChain」を修正しました。 [#92754](https://github.com/ClickHouse/ClickHouse/pull/92754) ([Azat Khuzhin](https://github.com/azat)).
* 切断された `Connection` から読み取った際にクラッシュしないようにしました。 [#92807](https://github.com/ClickHouse/ClickHouse/pull/92807) ([Raufs Dunamalijevs](https://github.com/rienath))。
* `Ordered` モードのストレージ `S3Queue` で発生していた論理エラー ` Failed to set file processing within 100 retries` を修正しました。現在はこのメッセージはエラーではなく警告として出力されます。このエラーは 25.10 より前のバージョンでは Keeper セッションの期限切れが発生した場合に起こる可能性がありましたが、`Ordered` モードで処理の並行実行度が高い場合には理論的には依然としてこのエラーが発生し得るため、25.10 以降のバージョンでも常に警告として扱われます。 [#92814](https://github.com/ClickHouse/ClickHouse/pull/92814) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 以前は、`PK sharding` を常に偽となる条件付きで使用していた一部のクエリが失敗していましたが、現在は失敗しなくなりました。https://github.com/ClickHouse/ClickHouse/pull/89313 のために必要な変更です。 [#92815](https://github.com/ClickHouse/ClickHouse/pull/92815) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* `system.parts` テーブルにおけるテキスト索引の非圧縮サイズの計算を修正しました。 [#92832](https://github.com/ClickHouse/ClickHouse/pull/92832) ([Anton Popov](https://github.com/CurtizJ)).
* `WHERE` 句の述語内でサブクエリを含む `IN` 句を伴う論理更新におけるプライマリ索引の利用方法を修正しました。 [#92838](https://github.com/ClickHouse/ClickHouse/pull/92838) ([Anton Popov](https://github.com/CurtizJ)).
* JSON 内のパス &#39;skip&#39; に対する型ヒントの生成を修正。 [#92731](https://github.com/ClickHouse/ClickHouse/issues/92731) をクローズ。 [#92842](https://github.com/ClickHouse/ClickHouse/pull/92842) ([Pavel Kruglov](https://github.com/Avogar)).
* S3 テーブルエンジンでは、非決定的関数が含まれている場合は、パーティションキーをキャッシュしないようにする必要があります。 [#92844](https://github.com/ClickHouse/ClickHouse/pull/92844) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* `ratio_of_defaults_for_sparse_serialization=0.0` を使用してスパースなカラムに対するミューテーション実行後に発生する可能性のあるエラー `FILE_DOESNT_EXIST` を修正しました。[#92633](https://github.com/ClickHouse/ClickHouse/issues/92633) をクローズしました。[#92860](https://github.com/ClickHouse/ClickHouse/pull/92860)（[Pavel Kruglov](https://github.com/Avogar))。
* JSON カラムが Tuple カラムの後に現れる場合に、旧 parquet リーダー（デフォルトでは使用されない）における parquet スキーマ推論を修正しました。空のタプルを含む場合に失敗していた旧 parquet リーダー（デフォルトでは使用されない）を修正しました。 [#92867](https://github.com/ClickHouse/ClickHouse/pull/92867) ([Michael Kolupaev](https://github.com/al13n321)).
* 定数条件で複数の JOIN を行い `join_use_nulls` を使用した場合に発生する論理エラーを修正し、[#92640](https://github.com/ClickHouse/ClickHouse/issues/92640) をクローズ。[#92892](https://github.com/ClickHouse/ClickHouse/pull/92892)（[Vladimir Cherkasov](https://github.com/vdimir)）。
* パーティション式にサブカラムを含むテーブルへの挿入時に発生する可能性のあるエラー `NOT_FOUND_COLUMN_IN_BLOCK` を修正しました。[#93210](https://github.com/ClickHouse/ClickHouse/issues/93210) と [#83406](https://github.com/ClickHouse/ClickHouse/issues/83406) をクローズ。[#92905](https://github.com/ClickHouse/ClickHouse/pull/92905)（[Pavel Kruglov](https://github.com/Avogar)）。
* エイリアス付きテーブルを扱う Merge エンジンで発生するエラー `NO_SUCH_COLUMN_IN_TABLE` を修正しました。[#88665](https://github.com/ClickHouse/ClickHouse/issues/88665) をクローズします。[#92910](https://github.com/ClickHouse/ClickHouse/pull/92910) ([Pavel Kruglov](https://github.com/Avogar))。
* LowCardinality(Nullable(T)) カラム上の full&#95;sorting&#95;join で NULL != NULL となるケースを修正しました。 [#92924](https://github.com/ClickHouse/ClickHouse/pull/92924) ([Vladimir Cherkasov](https://github.com/vdimir)).
* `MergeTree` テーブルにおけるテキスト索引のマージ処理中に発生していたクラッシュを複数件修正しました。 [#92925](https://github.com/ClickHouse/ClickHouse/pull/92925) ([Anton Popov](https://github.com/CurtizJ))。
* テーブル最適化中の例外を防ぐため、必要に応じて有効期限 (TTL) 集約時に Set 式の結果に対する LowCardinality ラッパーを復元します。 [#92971](https://github.com/ClickHouse/ClickHouse/pull/92971) ([Seva Potapov](https://github.com/seva-potapov)).
* `has` 関数で空配列が使用された場合に索引の解析中に発生する論理エラーを修正しました。 [#92906](https://github.com/ClickHouse/ClickHouse/issues/92906) をクローズしました。 [#92995](https://github.com/ClickHouse/ClickHouse/pull/92995)（[Nihal Z. Miaji](https://github.com/nihalzp)）。
* バックグラウンドスケジュールプールの終了時にハングアップが発生する可能性のある問題を修正しました（サーバーのシャットダウン時にサーバーがハングアップする可能性があります）。 [#93008](https://github.com/ClickHouse/ClickHouse/pull/93008) ([Azat Khuzhin](https://github.com/azat)).
* スパースなカラムの mutation の後、ALTER で SETTING `ratio_of_defaults_for_sparse_serialization` を `1.0` に変更した際に発生しうるエラー FILE&#95;DOESNT&#95;EXIST を修正しました。 [#93016](https://github.com/ClickHouse/ClickHouse/pull/93016) ([Pavel Kruglov](https://github.com/Avogar)).
* WHERE 句で `not materialize(...)` または `not CAST(...)` が使用された場合に誤った結果の原因となっていた data skipping ロジックのバグを修正しました。 [#88536](https://github.com/ClickHouse/ClickHouse/issues/88536) をクローズ。 [#93017](https://github.com/ClickHouse/ClickHouse/pull/93017)（[Nihal Z. Miaji](https://github.com/nihalzp)）。
* 共有パーツに対する TOCTOU レースコンディションにより古いパーツが使用される可能性がある問題を修正。 [#93022](https://github.com/ClickHouse/ClickHouse/pull/93022) ([Azat Khuzhin](https://github.com/azat)).
* 範囲外のオフセットを含む不正な形式の `groupConcat` 集約状態をデシリアライズした際に発生するクラッシュを修正しました。 [#93028](https://github.com/ClickHouse/ClickHouse/pull/93028) ([Raufs Dunamalijevs](https://github.com/rienath)).
* 事前キャンセルされた分散クエリの実行後に、接続が不正な状態のまま残る問題を修正。 [#93029](https://github.com/ClickHouse/ClickHouse/pull/93029) ([Azat Khuzhin](https://github.com/azat)).
* 右側の結合キーがスパースなカラムである場合の結合結果を修正します。これにより [#92920](https://github.com/ClickHouse/ClickHouse/issues/92920) がクローズされます。`set compatibility='23.3'` を設定した場合にのみこのバグを再現できました。バックポートすべきかどうかは不明です。[#93038](https://github.com/ClickHouse/ClickHouse/pull/93038)（[Amos Bird](https://github.com/amosbird)）。
* `estimateCompressionRatio()` で発生する可能性がある `Cannot finalize buffer after cancellation` を修正。次を修正: [#87380](https://github.com/ClickHouse/ClickHouse/issues/87380)。[#93068](https://github.com/ClickHouse/ClickHouse/pull/93068)（[Azat Khuzhin](https://github.com/azat)).
* `concat(col1, col2)` のような複雑な式に基づいて構築されたテキスト索引のマージ処理を修正しました。 [#93073](https://github.com/ClickHouse/ClickHouse/pull/93073) ([Anton Popov](https://github.com/CurtizJ)).
* フィルターにサブカラムが含まれている場合の PROJECTION の適用を修正。[#92882](https://github.com/ClickHouse/ClickHouse/issues/92882) をクローズ。[#93141](https://github.com/ClickHouse/ClickHouse/pull/93141)（[Pavel Kruglov](https://github.com/Avogar)）。
* クエリプランに join のランタイムフィルタが追加された一部のケースで発生する論理エラーを修正しました。原因は、join の一方の入力から重複した const カラムを誤って返していたことです。 [#93144](https://github.com/ClickHouse/ClickHouse/pull/93144) ([Alexander Gololobov](https://github.com/davenger)).
* 結合ランタイムフィルタで使用される特殊な関数 `__applyFilter` が、一部の妥当なケースにおいて ILLEGAL&#95;TYPE&#95;OF&#95;ARGUMENT エラーを返していました。 [#93187](https://github.com/ClickHouse/ClickHouse/pull/93187) ([Alexander Gololobov](https://github.com/davenger)).
* 実質的に同一カラムのエイリアスとなっている補間カラムについて、ブロック内で別々の補間カラムが同じカラムに折り畳まれてしまわないようにしました。 [#93197](https://github.com/ClickHouse/ClickHouse/pull/93197) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* 事前にデータが入っている右側のテーブルとの結合時には runtime filter を追加しないようにしました。 [#93211](https://github.com/ClickHouse/ClickHouse/pull/93211) ([Alexander Gololobov](https://github.com/davenger))。
* セッションが切断された後の keeper における persistent watches のクリーンアップ処理を修正しました。これにより [#92480](https://github.com/ClickHouse/ClickHouse/issues/92480) がクローズされます。[#93213](https://github.com/ClickHouse/ClickHouse/pull/93213)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* Iceberg における ORDER BY タプルを修正。これにより [#92977](https://github.com/ClickHouse/ClickHouse/issues/92977) がクローズされます。[#93225](https://github.com/ClickHouse/ClickHouse/pull/93225)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* S3Queue の SETTING `s3queue_migrate_old_metadata_to_buckets` に関するバグを修正しました。 [#93392](https://github.com/ClickHouse/ClickHouse/issues/93392)、[#93196](https://github.com/ClickHouse/ClickHouse/issues/93196)、[#81739](https://github.com/ClickHouse/ClickHouse/issues/81739) をクローズしました。 [#93232](https://github.com/ClickHouse/ClickHouse/pull/93232)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* マージ時にPROJECTIONを再構築する際、未使用のカラムを削除するようにしました。これによりメモリ使用量が削減され、一時パーツの作成数も減少します。 [#93233](https://github.com/ClickHouse/ClickHouse/pull/93233) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* スカラーな相関サブクエリが存在する場合に、サブクエリから未使用カラムを削除する処理を修正しました。修正前は、相関サブクエリ内でのみ使用されているカラムが削除されてしまい、その結果クエリが `NOT_FOUND_COLUMN_IN_BLOCK` エラーで失敗していました。 [#93273](https://github.com/ClickHouse/ClickHouse/pull/93273) ([Dmitry Novik](https://github.com/novikd)).
* 元のテーブルに対する `ALTER` 中に、マテリアライズドビューでサブカラムが欠落する可能性のあった問題を修正しました。[#93231](https://github.com/ClickHouse/ClickHouse/issues/93231) をクローズ。[#93276](https://github.com/ClickHouse/ClickHouse/pull/93276)（[Pavel Kruglov](https://github.com/Avogar)）。
* ローカルおよびリモート/Distributed テーブルをマージする際に `hostName()` に対して ILLEGAL&#95;COLUMN をスローする可能性があった、アナライザー使用時の `Merge` テーブルエンジンのクエリプランニングを修正しました。 [#92059](https://github.com/ClickHouse/ClickHouse/issues/92059) をクローズ。 [#93286](https://github.com/ClickHouse/ClickHouse/pull/93286)（[Jinlin](https://github.com/withlin)）。
* 非定数の配列引数を取る NOT IN が誤った値を返していた問題を修正し、非定数の Array 関数のサポートを追加しました。[#14980](https://github.com/ClickHouse/ClickHouse/issues/14980) をクローズ。[#93314](https://github.com/ClickHouse/ClickHouse/pull/93314)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* `use_top_k_dynamic_filtering` 最適化で発生していた `Not found column` エラーを修正しました。 [#93186](https://github.com/ClickHouse/ClickHouse/issues/93186) を修正。 [#93316](https://github.com/ClickHouse/ClickHouse/pull/93316)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* サブカラム上に作成されたテキスト索引の再構築処理を修正しました。 [#93326](https://github.com/ClickHouse/ClickHouse/pull/93326) ([Anton Popov](https://github.com/CurtizJ))。
* `hasAllTokens` および `hasAnyTokens` 関数の第 2 引数が空配列である場合の扱いを修正しました。 [#93328](https://github.com/ClickHouse/ClickHouse/pull/93328) ([Anton Popov](https://github.com/CurtizJ)).
* 右側のテーブルに対する totals を含むクエリで runtime フィルタが使用されている場合に発生する論理エラーを修正。 [#93330](https://github.com/ClickHouse/ClickHouse/pull/93330) ([Alexander Gololobov](https://github.com/davenger)).
* `tokens` 関数を非 const な tokenizer パラメータ（第 2、3、4 引数）で呼び出しても、サーバーがクラッシュしなくなりました。例: `SELECT tokens(NULL, 1, materialize(1))`。[#93383](https://github.com/ClickHouse/ClickHouse/pull/93383)（[Robert Schulze](https://github.com/rschu1ze)）。
* 細工された集約状態によりメモリ安全性上の問題を引き起こす可能性があった、`groupConcat` の状態デシリアライズ処理における整数オーバーフローの脆弱性を修正しました。 [#93426](https://github.com/ClickHouse/ClickHouse/pull/93426) ([Raufs Dunamalijevs](https://github.com/rienath)).
* インデックスにトークンが含まれていない場合（すべての配列が空であるか、トークナイザーによってすべてのトークンがスキップされる場合）における、配列カラムに対する固定テキスト索引の解析処理を修正しました。 [#93457](https://github.com/ClickHouse/ClickHouse/pull/93457) ([Anton Popov](https://github.com/CurtizJ)).
* ユーザー名とパスワードが接続文字列に含まれている場合は、ClickHouse Client での OAuth ログインをスキップするようにしました。 [#93459](https://github.com/ClickHouse/ClickHouse/pull/93459) ([Krishna Mannem](https://github.com/kcmannem)).
* DataLakeCatalog における Azure ADLS Gen2 から払い出される認証情報のサポートを修正し、Iceberg REST カタログから `adls.sas-token.*` キーをパースするとともに、ABFSS URL のパースを修正しました。 [#93477](https://github.com/ClickHouse/ClickHouse/pull/93477) ([Karun Anantharaman](https://github.com/karunmotorq))。
* analyzer を使用する GLOBAL IN のサポートを修正（以前は Set がリモートノード上で再作成されていた）。 [#93507](https://github.com/ClickHouse/ClickHouse/pull/93507) ([Azat Khuzhin](https://github.com/azat)).
* デシリアライズ中にサブカラムを直接スパースカラムに抽出する処理を修正。 [#93512](https://github.com/ClickHouse/ClickHouse/pull/93512) ([Pavel Kruglov](https://github.com/Avogar)).
* 重複した検索クエリがある場合のテキスト索引からの直接読み取りを修正しました。 [#93516](https://github.com/ClickHouse/ClickHouse/pull/93516) ([Anton Popov](https://github.com/CurtizJ)).
* runtime filter が有効で、結合したテーブルから同じカラムが複数回返される場合（例: SELECT a, a, a FROM t）に発生する NOT&#95;FOUND&#95;COLUMN&#95;IN&#95;BLOCK エラーの修正。 [#93526](https://github.com/ClickHouse/ClickHouse/pull/93526) ([Alexander Gololobov](https://github.com/davenger))。
* ssh を使用して接続する際に clickhouse-client がパスワードを 2 回要求するバグを修正。 [#93547](https://github.com/ClickHouse/ClickHouse/pull/93547) ([Isak Ellmer](https://github.com/spinojara)).
* zookeeper がシャットダウン時に確実に finalize されるようにし（きわめてまれなケースで発生しうるシャットダウン時のハングの可能性があった問題を修正）、ます。 [#93602](https://github.com/ClickHouse/ClickHouse/pull/93602) ([Azat Khuzhin](https://github.com/azat)).
* ReplicatedMergeTree を復元する際の重複排除のレースコンディションにより発生していた LOGICAL&#95;ERROR を修正しました。 [#93612](https://github.com/ClickHouse/ClickHouse/pull/93612) ([Pablo Marcos](https://github.com/pamarcos)).
* いくつかの入力フォーマットで Sparse カラムへ直接デシリアライズする際に、有効期限 (TTL) の更新に Sparse カラムを使用する処理を修正しました。これにより、論理エラー `Unexpected type of result TTL column` が発生する可能性を解消しました。 [#93619](https://github.com/ClickHouse/ClickHouse/pull/93619) ([Pavel Kruglov](https://github.com/Avogar)).
* 無効な入力に対して呼び出された場合に h3 索引関数がクラッシュしたりハングしたりすることがある問題を修正しました。 [#93657](https://github.com/ClickHouse/ClickHouse/pull/93657) ([Michael Kolupaev](https://github.com/al13n321))。
* 非 UTF-8 データに対して `ngram_bf` 索引を使用すると、未初期化メモリを読み取ってしまい、その値が結果として生成される索引構造内に含まれ得る問題がありました。これにより [#92576](https://github.com/ClickHouse/ClickHouse/issues/92576) がクローズされました。 [#93663](https://github.com/ClickHouse/ClickHouse/pull/93663)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 解凍後のバッファサイズが想定どおりであることを検証します。 [#93690](https://github.com/ClickHouse/ClickHouse/pull/93690) ([Raúl Marín](https://github.com/Algunenano)).
* ユーザーが `merge` テーブルエンジンを使用して、`SHOW COLUMNS` 権限のチェックなしにテーブルからカラムの一覧を取得できないようにしました。 [#93695](https://github.com/ClickHouse/ClickHouse/pull/93695) ([János Benjamin Antal](https://github.com/antaljanosbenjamin)).
* サブカラムに作成されたスキップ索引のマテリアライズ処理を修正しました。 [#93708](https://github.com/ClickHouse/ClickHouse/pull/93708) ([Anton Popov](https://github.com/CurtizJ)).
* `PipelineExecutor` が存続している間に `IStorage` オブジェクトが破棄されないようにするため、ストレージの `shared_ptr` を `QueryPipeline::resources::storage_holders` に保存します。 [#93746](https://github.com/ClickHouse/ClickHouse/pull/93746) ([Miсhael Stetsyuk](https://github.com/mstetsyuk))。
* 再起動後にインターサーバーホストが変更された場合に Replicated DB のアタッチに失敗する問題を修正。 [#93779](https://github.com/ClickHouse/ClickHouse/pull/93779) ([Tuan Pham Anh](https://github.com/tuanpach)).
* キャッシュが有効な場合に発生することがあった `ReadBufferFromS3` 内のアサーション `!read_until_position` を修正しました。[#93809](https://github.com/ClickHouse/ClickHouse/pull/93809)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* `Map` カラムで空のタプルが使用されるまれなケースで発生する論理エラーを修正。[#93784](https://github.com/ClickHouse/ClickHouse/issues/93784) をクローズ。[#93814](https://github.com/ClickHouse/ClickHouse/pull/93814)（[Nihal Z. Miaji](https://github.com/nihalzp)）。
* マージ中にプロジェクションを再構築する際に発生していた `_part_offset` の破損を修正し、`_part_offset` カラムの不要な読み取りを回避し、さらにプロジェクション計算で不要なカラムをスキップすることでプロジェクション処理を最適化しました。これは、[#93233](https://github.com/ClickHouse/ClickHouse/issues/93233) で導入された最適化をさらに発展させるものです。[#93827](https://github.com/ClickHouse/ClickHouse/pull/93827)（[Amos Bird](https://github.com/amosbird)）。
* &#39;Bad version&#39; エラーの処理を削除。 [#93843](https://github.com/ClickHouse/ClickHouse/pull/93843) ([Anton Ivashkin](https://github.com/ianton-ru)).
* キーが符号付き整数型のときに、分散クエリにおいて `optimize_inverse_dictionary_lookup` が動作しない不具合を修正しました。[#93259](https://github.com/ClickHouse/ClickHouse/issues/93259) をクローズしました。 [#93848](https://github.com/ClickHouse/ClickHouse/pull/93848) ([Nihal Z. Miaji](https://github.com/nihalzp))。
* 分散 `remote()` クエリにおいて `lag`/`lead` が動作しない不具合を修正しました。[#90014](https://github.com/ClickHouse/ClickHouse/issues/90014) をクローズ。[#93858](https://github.com/ClickHouse/ClickHouse/pull/93858)（[Nihal Z. Miaji](https://github.com/nihalzp)）。
* システムインストルメントのディスパッチに関するバグを修正。 [#93937](https://github.com/ClickHouse/ClickHouse/pull/93937) ([Pablo Marcos](https://github.com/pamarcos)).
* https://github.com/ClickHouse/ClickHouse/pull/89173 において、内部パイプを通じて `TraceSender` が送信する構造体にフィールドを 1 つ追加しました。しかし、バッファサイズは更新されていませんでした（[こちら](https://github.com/ClickHouse/ClickHouse/pull/89173/changes#diff-36ecfac5cde34c92c031652d8a77f0d12782cd5d43e68d6ef159e6d46a54224fL44)）。その結果、`buffer_size` を超えるデータを書き込んでしまい、flush が複数回発生します。また `TraceSender::send` は複数のスレッドから呼び出されるため、異なるスレッドによる flush が入り交じり、受信側（`TraceCollector`）が前提としている不変条件が破られてしまいます。[#93966](https://github.com/ClickHouse/ClickHouse/pull/93966)（[Miсhael Stetsyuk](https://github.com/mstetsyuk)）。
* ストレージ `Join` の `USING` 句を用いた結合操作におけるスーパータイプへの型変換を修正しました。[#91672](https://github.com/ClickHouse/ClickHouse/issues/91672) を修正。[#78572](https://github.com/ClickHouse/ClickHouse/issues/78572) を修正。[#94000](https://github.com/ClickHouse/ClickHouse/pull/94000)（[Dmitry Novik](https://github.com/novikd)）。
* Join runtime filter が Mergeテーブルに適用された場合に、FilterStep が正しく追加されない問題を修正しました。 [#94021](https://github.com/ClickHouse/ClickHouse/pull/94021) ([Alexander Gololobov](https://github.com/davenger)).
* 複数のカラムに対する述語を含み、Bloom filter スキップ索引を使用し、かつ `OR` と `NOT` の両方の条件が存在する `SELECT` クエリで、結果が不整合になる可能性がありました。この問題は修正されました。 [#94026](https://github.com/ClickHouse/ClickHouse/pull/94026) ([Shankar Iyer](https://github.com/shankar-iyer)).
* 依存インデックスを持つカラムに対する CLEAR 操作を修正。 [#94057](https://github.com/ClickHouse/ClickHouse/pull/94057) ([Raúl Marín](https://github.com/Algunenano)).
* `ReadWriteBufferFromHTTP` で未初期化値が使用されていた問題を修正。 [#94058](https://github.com/ClickHouse/ClickHouse/pull/94058) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* JSON の型付きパスに対する誤ったチェックを修正しました。このチェックは https://github.com/ClickHouse/ClickHouse/pull/92842 で導入され、既存のテーブルを起動する際にエラーにつながる可能性がありました。[#94070](https://github.com/ClickHouse/ClickHouse/pull/94070)（[Pavel Kruglov](https://github.com/Avogar)）。
* OUTER JOIN を含む場合のフィルタ解析中に発生するクラッシュを修正。[#90979](https://github.com/ClickHouse/ClickHouse/issues/90979) を修正。[#94080](https://github.com/ClickHouse/ClickHouse/pull/94080)（[Dmitry Novik](https://github.com/novikd)）。
* 並列処理（`max_threads` &gt; 1、デフォルト）で UInt8 集約キーを使用する場合の `uniqTheta` の精度を修正。 [#94095](https://github.com/ClickHouse/ClickHouse/pull/94095) ([Azat Khuzhin](https://github.com/azat)).
* `SCOPE_EXIT` 内の `socket.setBlocking(true)` 呼び出しからスローされる例外により発生していたクラッシュを修正。 [#94100](https://github.com/ClickHouse/ClickHouse/pull/94100) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* ReplicatedMergeTree で、後からのログエントリによって作成されたパーツが `DROP PARTITION` によって削除され、データが失われる問題を修正しました。 [#94123](https://github.com/ClickHouse/ClickHouse/pull/94123) ([Tuan Pham Anh](https://github.com/tuanpach))。
* ページ境界をまたぐ配列を誤って処理していた parquet reader v3 を修正しました。これは、たとえば Arrow が page statistics や page index を有効化せずに書き出したファイルで発生します。Array データ型のカラムにのみ影響します。代表的な症状として、約 1 MB ごとに 1 つの配列が切り捨てられることがあります。この修正以前の回避策としては、次の設定を使用してください: `input_format_parquet_use_native_reader_v3 = 0`。 [#94125](https://github.com/ClickHouse/ClickHouse/pull/94125) ([Michael Kolupaev](https://github.com/al13n321)).
* ログエントリの待機中に ReplicatedMergeTree で過剰な watch が発生する問題を修正。 [#94133](https://github.com/ClickHouse/ClickHouse/pull/94133) ([Azat Khuzhin](https://github.com/azat)).
* 関数 `arrayShuffle`、`arrayPartialShuffle`、`arrayRandomSample` を使用して const カラムをマテリアライズし、行ごとに異なる結果が得られるようにしました。 [#94134](https://github.com/ClickHouse/ClickHouse/pull/94134) ([Joanna Hulboj](https://github.com/jh0x))。
* materialized view 内でテーブル関数を評価する際のデータレースを修正。 [#94171](https://github.com/ClickHouse/ClickHouse/pull/94171) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `PostgreSQL` データベースエンジンにおける、クエリが不正な場合の nullptr デリファレンスを修正しました。[#92887](https://github.com/ClickHouse/ClickHouse/issues/92887) をクローズしました。[#94180](https://github.com/ClickHouse/ClickHouse/pull/94180)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 複数のサブクエリを含む `SELECT` クエリを使用したリフレッシャブルmaterialized view におけるメモリリークを修正しました。 [#94200](https://github.com/ClickHouse/ClickHouse/pull/94200) ([Antonio Andelic](https://github.com/antonio2368)).
* `DataPartStorageOnDiskBase::remove` と `system.parts` 間のデータレースを修正します。 [#49076](https://github.com/ClickHouse/ClickHouse/issues/49076) をクローズします。 [#94262](https://github.com/ClickHouse/ClickHouse/pull/94262)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* メモリ例外発生時にクラッシュ（`std::terminate`）を引き起こす可能性がある HashTable のコピー代入演算子に誤って付けられていた `noexcept` 指定子を削除しました。 [#94275](https://github.com/ClickHouse/ClickHouse/pull/94275) ([Nikita Taranov](https://github.com/nickitat)).
* 以前は、GROUP BY で重複するカラムを含む PROJECTION を作成し（例: `GROUP BY c0, c0`）、データを挿入すると、`optimize_row_order` が有効になっている場合に `std::length_error` が発生していました。[#94065](https://github.com/ClickHouse/ClickHouse/issues/94065) をクローズ。[#94277](https://github.com/ClickHouse/ClickHouse/pull/94277)（[Alexey Milovidov](https://github.com/alexey-milovidov))。
* 接続時の ZooKeeper クライアントで、ハングやクラッシュを引き起こす原因となっていた不可解なバグを修正しました。 [#94320](https://github.com/ClickHouse/ClickHouse/pull/94320) ([Azat Khuzhin](https://github.com/azat)).
* サブカラムに適用されていなかった関数からサブカラムへの最適化を修正。 [#94323](https://github.com/ClickHouse/ClickHouse/pull/94323) ([Pavel Kruglov](https://github.com/Avogar)).
* `enable_lazy_columns_replication` が有効な場合のネストした RIGHT JOIN において、誤った結果が返される可能性がある問題を修正しました。このバグにより、本来はそれぞれ異なる値を持つはずのレプリケートされたカラム内のすべての行が、誤って同一の値を返していました。 [#93891](https://github.com/ClickHouse/ClickHouse/issues/93891) をクローズしました。 [#94339](https://github.com/ClickHouse/ClickHouse/pull/94339)（[Vladimir Cherkasov](https://github.com/vdimir)）。
* 同値集合を使用した SEMI JOIN のフィルタのプッシュダウンを修正。引数の型が変更されている場合はフィルタをプッシュダウンしないようにする。[#93264](https://github.com/ClickHouse/ClickHouse/issues/93264) を修正。[#94340](https://github.com/ClickHouse/ClickHouse/pull/94340)（[Dmitry Novik](https://github.com/novikd)）。
* DeltaLake CDF を DataLake データベースエンジン（Delta Lake カタログ統合）と組み合わせて使用する際の挙動を修正しました。[#94122](https://github.com/ClickHouse/ClickHouse/issues/94122) をクローズ。[#94342](https://github.com/ClickHouse/ClickHouse/pull/94342) ([Kseniia Sumarokova](https://github.com/kssenii)).
* `SLRU` キャッシュポリシーが使用されている場合に、現在のメトリック `FilesystemCacheSizeLimit` の値が誤っていた問題を修正。 [#94363](https://github.com/ClickHouse/ClickHouse/pull/94363) ([Kseniia Sumarokova](https://github.com/kssenii))。
* 2 つ未満の引数で Backup データベースエンジンを作成すると、より説明的なエラーメッセージ `Wrong number of arguments`（従来の `std::out_of_range: InlinedVector::at(size_type) const failed bounds check.` の代わり）を返すようになりました。 [#94374](https://github.com/ClickHouse/ClickHouse/pull/94374) ([Robert Schulze](https://github.com/rschu1ze)).
* データベースレベルのグローバル権限のうち `GRANT OPTION` 付きのものに対する、実行不可能な `REVOKE` を無視するようにしました。 [#94386](https://github.com/ClickHouse/ClickHouse/pull/94386) ([pufit](https://github.com/pufit)).
* コンパクトなパーツからスパースオフセットを読み取る処理を修正しました。[#94385](https://github.com/ClickHouse/ClickHouse/issues/94385) をクローズしました。[#94399](https://github.com/ClickHouse/ClickHouse/pull/94399)（[Pavel Kruglov](https://github.com/Avogar)）。
* `alter_column_secondary_index_mode` の `throw` モードが使用されている場合でも、暗黙的な索引を使用しているカラムに対する ALTER を禁止しないように変更しました。 [#94425](https://github.com/ClickHouse/ClickHouse/pull/94425) ([Raúl Marín](https://github.com/Algunenano)).
* 複数回の `receivePacketsExpectQuery` 呼び出しで `Protocol::Client::IgnoredPartUUIDs` が読み込まれた際に発生する `TCPHandler` のクラッシュを修正しました。 [#94434](https://github.com/ClickHouse/ClickHouse/pull/94434) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* `system.functions` 内の機密データのマスキングを修正しました。 [#94436](https://github.com/ClickHouse/ClickHouse/pull/94436) ([Vitaly Baranov](https://github.com/vitlibar)).
* `send_profile_events` が無効化されている場合に発生する nullptr 参照の問題を修正しました。この機能は ClickHouse Python ドライバー向けに最近導入されたものです。[#92488](https://github.com/ClickHouse/ClickHouse/issues/92488) をクローズしました。[#94466](https://github.com/ClickHouse/ClickHouse/pull/94466)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* マージ処理中の text 索引 .mrk の非互換性を修正。 [#94494](https://github.com/ClickHouse/ClickHouse/pull/94494) ([Peng Jian](https://github.com/fastio)).
* `read_in_order_use_virtual_row` が有効になっている場合、コードは索引が切り詰められているかどうかを確認せずに、完全なプライマリキーのサイズに基づいて索引のカラムにアクセスしていたため、use-after-free／未初期化メモリの問題が発生していました。[#85596](https://github.com/ClickHouse/ClickHouse/issues/85596) を修正。[#94500](https://github.com/ClickHouse/ClickHouse/pull/94500)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `GLOBAL IN` を伴うサブクエリに外部テーブルを送信する際、型が `Nullable` の場合に発生していた型不一致エラーを修正しました。[#94097](https://github.com/ClickHouse/ClickHouse/issues/94097) をクローズします。[#94511](https://github.com/ClickHouse/ClickHouse/pull/94511)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 以前のバージョンでは、同じ式に対して複数の索引条件を含むクエリが、誤って `Not found column` という例外をスローすることがありました。[#60660](https://github.com/ClickHouse/ClickHouse/issues/60660) をクローズ。[#94515](https://github.com/ClickHouse/ClickHouse/pull/94515)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* ランタイムフィルターにおける Nullable 結合カラムの誤った処理を修正しました。 [#94555](https://github.com/ClickHouse/ClickHouse/pull/94555) ([Alexander Gololobov](https://github.com/davenger)).
* 現在使用中の別のワークロード内にワークロードを作成しても、クラッシュすることがなくなりました。 [#94599](https://github.com/ClickHouse/ClickHouse/pull/94599) ([Sergei Trifonov](https://github.com/serxa)).
* 欠落しているカラムに対して `isNotNull` が評価される場合に、ANY LEFT JOIN の最適化中に発生するクラッシュを修正しました。 [#94600](https://github.com/ClickHouse/ClickHouse/pull/94600) ([Molly](https://github.com/ggmolly))。
* 計算済みデフォルト値を持つ他のカラムを参照するデフォルト式の評価を修正しました。 [#94615](https://github.com/ClickHouse/ClickHouse/pull/94615) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* BACKUP/RESTORE 操作における権限の問題を修正しました。 [#94617](https://github.com/ClickHouse/ClickHouse/pull/94617) ([Pablo Marcos](https://github.com/pamarcos)).
* データ型が `Nullable(DateTime64)` の場合の誤った型キャストにより発生するクラッシュを修正しました。 [#94627](https://github.com/ClickHouse/ClickHouse/pull/94627) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* `ORDER BY` を含む特定の分散クエリにおいて、`ALIAS` カラムの値が入れ替わって返されることがあるバグを修正しました（例: カラム `a` にカラム `b` のデータが表示され、その逆も同様）。 [#94644](https://github.com/ClickHouse/ClickHouse/pull/94644) ([filimonov](https://github.com/filimonov)).
* keeper-bench の結果をファイルに保存する処理を修正。 [#94654](https://github.com/ClickHouse/ClickHouse/pull/94654) ([Antonio Andelic](https://github.com/antonio2368)).
* カラムに負の浮動小数点値が含まれている場合の MinMax 型統計による誤った推定を修正しました。[#94665](https://github.com/ClickHouse/ClickHouse/pull/94665) ([zoomxi](https://github.com/zoomxi)).
* map のキーが struct の場合の Parquet ファイルの読み取りを修正。 [#94670](https://github.com/ClickHouse/ClickHouse/pull/94670) ([Konstantin Vedernikov](https://github.com/scanhex12))。
* 複雑な ON 条件を使用した場合に、RIGHT JOIN の結果が誤ったものになる可能性がある問題を修正しました。[#92913](https://github.com/ClickHouse/ClickHouse/issues/92913) をクローズしました。[#94680](https://github.com/ClickHouse/ClickHouse/pull/94680)（[Vladimir Cherkasov](https://github.com/vdimir)）。
* Vertical マージ後も一定の索引粒度 (use&#95;const&#95;adaptive&#95;granularity) が保持されるようにしました。 [#94725](https://github.com/ClickHouse/ClickHouse/pull/94725) ([Azat Khuzhin](https://github.com/azat)).
* スカラーサブクエリとテーブルの依存関係に関連するミューテーションのバグを修正。テーブルがあるカラムに対する依存関係（索引や PROJECTION）を持つ場合、スカラーサブクエリがデータなしで評価・キャッシュされ、不正な変更につながる可能性がありました。 [#94731](https://github.com/ClickHouse/ClickHouse/pull/94731) ([Raúl Marín](https://github.com/Algunenano)).
* エラー時に AsynchronousMetrics の cpu&#95;pressure フォールバックを修正。 [#94827](https://github.com/ClickHouse/ClickHouse/pull/94827) ([Raúl Marín](https://github.com/Algunenano)).
* `getURLHostRFC` 関数では、ポインタをデリファレンスする前の境界チェックが欠けていました。空文字列が `domainRFC` に渡されると、未初期化メモリを読み込んでしまい、MSan エラーを引き起こしていました。 [#94851](https://github.com/ClickHouse/ClickHouse/pull/94851)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 暗号化ディスクが読み取り専用になってしまう問題を修正しました。 [#94852](https://github.com/ClickHouse/ClickHouse/pull/94852) ([Azat Khuzhin](https://github.com/azat)).
* 旧アナライザーで分散テーブルを使用している場合に、小数を指定した `LIMIT/OFFSET` で発生していた論理エラーを修正しました。[#94712](https://github.com/ClickHouse/ClickHouse/issues/94712) をクローズ。[#94999](https://github.com/ClickHouse/ClickHouse/pull/94999)（[Ahmed Gouda](https://github.com/0xgouda)）。
* デフォルトで join ランタイムフィルタが有効になっている場合に、一部の条件下で発生していたクラッシュを修正しました。 [#95000](https://github.com/ClickHouse/ClickHouse/pull/95000) ([Alexander Gololobov](https://github.com/davenger)).
* テーブルエンジン `URL()` およびテーブル関数 `url()` で使用される URL におけるパスワードのマスキング処理を改善しました。 [#95006](https://github.com/ClickHouse/ClickHouse/pull/95006) ([Vitaly Baranov](https://github.com/vitlibar)).
* `enable_extended_results_for_datetime_functions` が有効になっている場合、`toStartOfInterval` 関数は `toStartOfX` と同じように動作するようになりました。ここで `X` は `Day, Week, Month, Quarter, Year` です。 [#95011](https://github.com/ClickHouse/ClickHouse/pull/95011) ([Kirill Kopnev](https://github.com/Fgrtue))。
* 定数文字列の比較が `cast_string_to_date_time_mode`、`bool_true_representation`、`bool_false_representation`、`input_format_null_as_default` の各 SETTING を正しく考慮していなかった問題を修正しました。 [#91681](https://github.com/ClickHouse/ClickHouse/issues/91681) をクローズ。 [#95040](https://github.com/ClickHouse/ClickHouse/pull/95040)（[Nihal Z. Miaji](https://github.com/nihalzp)）。
* ファイルシステムキャッシュのデータレースを修正しました。 [#95064](https://github.com/ClickHouse/ClickHouse/pull/95064) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* Parquet リーダーで発生しうるまれな競合状態を修正。 [#95068](https://github.com/ClickHouse/ClickHouse/pull/95068) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `LIMIT` がゼロのときに top K 最適化でクラッシュする問題を修正しました。 [#93893](https://github.com/ClickHouse/ClickHouse/issues/93893) をクローズ。 [#95072](https://github.com/ClickHouse/ClickHouse/pull/95072)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* DateTime/整数から Time64 への変換では、`toTime` を使用して一日の時刻コンポーネントを抽出しますが、これは単調な関数ではありません。`ToDateTimeMonotonicity` テンプレートはこの変換が単調であると誤ってみなしており、デバッグビルドにおいて &quot;Invalid binary search result in MergeTreeSetIndex&quot; という例外を引き起こしていました。 [#95125](https://github.com/ClickHouse/ClickHouse/pull/95125) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* マニフェストファイルのエントリ一覧は、必要な場合にのみ再作成されるようにしました（以前は各イテレーションごとに再作成していました）。 [#95162](https://github.com/ClickHouse/ClickHouse/pull/95162) ([Daniil Ivanik](https://github.com/divanik))。

#### ビルド／テスト／パッケージングの改善 \{#buildtestingpackaging-improvement\}
* ClickHouse SQL パーサーにおけるメモリアロケーションをプロファイルするため、jemalloc のヒーププロファイリング機能を利用するツール群を追加しました。[#94072](https://github.com/ClickHouse/ClickHouse/pull/94072) ([Ilya Yatsishin](https://github.com/qoega)).
* パーサー内のメモリアロケーションのデバッグを簡素化するツールを追加しました。このツールは、クエリを AST 表現にパースする前後で jemalloc の `stats.allocated` メトリクスを使用し、どの程度メモリが割り当てられたかを表示します。また、前後でプロファイルをダンプして、どこで割り当てが発生したかを示すレポートを生成できるメモリプロファイリングモードもサポートします。[#93523](https://github.com/ClickHouse/ClickHouse/pull/93523) ([Ilya Yatsishin](https://github.com/qoega)).
* 間接的な libc++ のインクルードを削除しました。[#92523](https://github.com/ClickHouse/ClickHouse/pull/92523) ([Raúl Marín](https://github.com/Algunenano)).
* いくつかの逐次テストを並列実行に変更しました: https://github.com/ClickHouse/ClickHouse/pull/93030/changes#diff-c3a73510dae653c9bbfa24300b32f5d6ec663fd4e72cc4a3d5daa6e4342915df。[#93030](https://github.com/ClickHouse/ClickHouse/pull/93030) ([Nikita Fomichev](https://github.com/fm4v)).
* いくつかのビルドフラグをクリーンアップしました。[#93679](https://github.com/ClickHouse/ClickHouse/pull/93679) ([Raúl Marín](https://github.com/Algunenano)).
* c-ares を v1.34.5 から v1.34.6 に更新しました。これは c-ares の `CVE-2025-62408` に対処するものですが、ClickHouse には影響しません。[#94129](https://github.com/ClickHouse/ClickHouse/pull/94129) ([Govind R Nair](https://github.com/Revertionist)).
* `curl` 8.18.0 を使用するようにしました。[#94742](https://github.com/ClickHouse/ClickHouse/pull/94742) ([Konstantin Bogdanov](https://github.com/thevar1able)).