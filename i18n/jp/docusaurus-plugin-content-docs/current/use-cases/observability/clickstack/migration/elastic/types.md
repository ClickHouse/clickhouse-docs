---
slug: /use-cases/observability/clickstack/migration/elastic/types
title: 'マッピングの型'
pagination_prev: null
pagination_next: null
sidebar_label: '型'
sidebar_position: 2
description: 'ClickHouse と Elasticsearch におけるマッピングの型'
show_related_blogs: true
keywords: ['JSON', 'Codecs']
doc_type: 'reference'
---

Elasticsearch と ClickHouse は多様なデータ型をサポートしていますが、その基盤となるストレージおよびクエリモデルは本質的に異なります。このセクションでは、一般的に使用される Elasticsearch のフィールド型を、可能な範囲で ClickHouse における対応する型にマッピングし、あわせて移行時の指針となるコンテキストを提供します。対応する型が存在しない場合は、代替案や注意点をコメントとして記載します。



| **Elasticsearch の型**                  | **ClickHouse における同等機能**                                                                                                                                                                                                                                                                                                                                                                                            | **コメント**                                                                                                                                                                                                                                                                                  |
| ------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Boolean`                             | [`UInt8`](/sql-reference/data-types/int-uint)または[`Bool`](/sql-reference/data-types/boolean)                                                                                                                                                                                                                                                                                                                        | ClickHouse は、〜をサポートします`Boolean`の別名として`UInt8`新しいバージョンでは。                                                                                                                                                                                                                                   |
| `keyword`                             | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                                                                                                                                                       | 完全一致でのフィルタリング、グループ化、およびソートに使用されます。                                                                                                                                                                                                                                                        |
| `text`                                | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                                                                                                                                                       | ClickHouse での全文検索は制限があり、トークナイズには `tokens` や配列関数などの関数を用いたカスタムロジックが必要です`tokens`配列関数と組み合わせて使用されます。                                                                                                                                                                                           |
| `long`                                | [`Int64`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                                                                                                                                                      | 64ビット符号付き整数。                                                                                                                                                                                                                                                                              |
| `integer`                             | [`Int32`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                                                                                                                                                      | 32ビット符号付き整数。                                                                                                                                                                                                                                                                              |
| `short`                               | [`Int16`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                                                                                                                                                      | 16 ビット符号付き整数。                                                                                                                                                                                                                                                                             |
| `バイト`                                 | [`Int8`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                                                                                                                                                       | 8ビット符号付き整数。                                                                                                                                                                                                                                                                               |
| `unsigned_long`                       | [`UInt64`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                                                                                                                                                     | 符号なし 64ビット整数。                                                                                                                                                                                                                                                                             |
| `double`                              | [`Float64`](/sql-reference/data-types/float)                                                                                                                                                                                                                                                                                                                                                                       | 64ビット浮動小数点数。                                                                                                                                                                                                                                                                              |
| `float`                               | [`Float32`](/sql-reference/data-types/float)                                                                                                                                                                                                                                                                                                                                                                       | 32ビット浮動小数点数。                                                                                                                                                                                                                                                                              |
| `half_float`                          | [`Float32`](/sql-reference/data-types/float)または[`BFloat16`](/sql-reference/data-types/float)                                                                                                                                                                                                                                                                                                                       | 最も近い同等の型。ClickHouse には 16 ビットの浮動小数点型はありません。ClickHouse には`BFloat16`- これは Half-float IEEE-754 とは異なります。half-float はより狭い範囲と引き換えに高い精度を提供しますが、bfloat16 は精度を犠牲にしてより広い範囲を扱えるようにしており、機械学習ワークロードにより適しています。                                                                                          |
| `scaled_float`                        | [`Decimal(x, y)`](/sql-reference/data-types/decimal)                                                                                                                                                                                                                                                                                                                                                               | 固定小数点数値を格納します。                                                                                                                                                                                                                                                                            |
| `date`                                | [`DateTime`](/sql-reference/data-types/datetime)                                                                                                                                                                                                                                                                                                                                                                   | 秒精度を持つ同等の日時型。                                                                                                                                                                                                                                                                             |
| `date_nanos`                          | [`DateTime64`](/sql-reference/data-types/datetime64)                                                                                                                                                                                                                                                                                                                                                               | ClickHouse は `DateTime64(9)` によってナノ秒精度をサポートします。`DateTime64(9)`ClickHouse は `DateTime64(9)` 型によってナノ秒精度をサポートします。                                                                                                                                                                            |
| `binary`                              | [`String`](/sql-reference/data-types/string)、[`FixedString(N)`](/sql-reference/data-types/fixedstring)                                                                                                                                                                                                                                                                                                             | バイナリフィールドには base64 デコードが必要です。                                                                                                                                                                                                                                                             |
| `ip`                                  | [`IPv4`](/sql-reference/data-types/ipv4)IPv4、IPv6[`IPv6`](/sql-reference/data-types/ipv6)                                                                                                                                                                                                                                                                                                                          | ネイティブ`IPv4`および`IPv6`ネイティブな `IPv4` および `IPv6` 型が利用可能です。                                                                                                                                                                                                                                    |
| `object`                              | [`Nested`](/sql-reference/data-types/nested-data-structures/nested)[`Nested`], [`Map`], [`Tuple`], [`JSON`][`Map`](/sql-reference/data-types/map)`Nested`、`Map`、`Tuple`、`JSON`[`Tuple`](/sql-reference/data-types/tuple)、[`JSON`](/sql-reference/data-types/newjson)                                                                                                                                               | ClickHouse は `Nested` や `JSON` を使って JSON 風オブジェクトを表現できます[`Nested`](/sql-reference/data-types/nested-data-structures/nested)または[`JSON`](/sql-reference/data-types/newjson).                                                                                                                 |
| `flattened`                           | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                                                                                                                                                       | Elasticsearch の `flattened` 型は、JSON オブジェクト全体を単一フィールドとして格納し、完全なマッピングを定義しなくても、ネストされたキーに柔軟かつスキーマレスにアクセスできるようにします。ClickHouse では、同様の機能は `String` 型を使って実現できますが、そのための処理はマテリアライズドビュー内で行う必要があります。                                                                                                  |
| `nested`                              | [`Nested`](/sql-reference/data-types/nested-data-structures/nested)                                                                                                                                                                                                                                                                                                                                                | ClickHouse`Nested`カラムは、ユーザーが `flatten_nested=0` を使用することを前提とした場合、グループ化されたサブフィールドに対して同様のセマンティクスを提供します`flatten_nested=0`ClickHouse の `Nested` カラムは、ユーザーが `flatten_nested=0` を使用していることを前提として、グループ化されたサブフィールドに対して類似したセマンティクスを提供します。                                                            |
| `join`                                | 該当なし                                                                                                                                                                                                                                                                                                                                                                                                               | 親子関係という直接的な概念はありません。テーブル間の結合（JOIN）がサポートされているため、ClickHouseでは不要です。                                                                                                                                                                                                                          |
| `alias`                               | [`Alias`](/sql-reference/statements/create/table#alias)カラム修飾子                                                                                                                                                                                                                                                                                                                                                      | エイリアス[がサポートされています](/sql-reference/statements/create/table#alias)フィールド修飾子を使って指定できます。これらのエイリアスには関数を適用できます。例：`size String ALIAS formatReadableSize(size_bytes)`                                                                                                                              |
| `range``range` 型（`*_range`）`*_range`) | [`Tuple(start, end)`](/sql-reference/data-types/tuple)または[`Array(T)`](/sql-reference/data-types/array)                                                                                                                                                                                                                                                                                                             | ClickHouse にはネイティブなレンジ型はありませんが、数値および日付のレンジは[`Tuple(start, end)`](/sql-reference/data-types/tuple)または[`Array`](/sql-reference/data-types/array)構造体。IPレンジの場合(`ip_range`)、CIDR 値を次のように格納します`String`や次のような関数で評価します`isIPAddressInRange()`。あるいは、`ip_trie`を使用したルックアップ辞書によって、効率的なフィルタリングが可能になります。 |
| `aggregate_metric_double`             | [`AggregateFunction(...)`](/sql-reference/data-types/aggregatefunction)および[`SimpleAggregateFunction(...)`](/sql-reference/data-types/simpleaggregatefunction)                                                                                                                                                                                                                                                      | 集計関数の状態とマテリアライズドビューを使用して、事前集計されたメトリクスをモデリングします。すべての集計関数は集計状態をサポートします。                                                                                                                                                                                                                     |
| `ヒストグラム`                              | [`Tuple(Array(Float64), Array(UInt64))`](/sql-reference/data-types/tuple)                                                                                                                                                                                                                                                                                                                                          | 配列またはカスタムスキーマを使用して、バケットとカウントを手動で表現します。                                                                                                                                                                                                                                                    |
| `annotated-text`                      | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                                                                                                                                                       | エンティティ認識検索やアノテーションの組み込みサポートはありません。                                                                                                                                                                                                                                                        |
| `completion`,`search_as_you_type`     | NA                                                                                                                                                                                                                                                                                                                                                                                                                 | ネイティブなオートコンプリートやサジェストエンジンはありません。`String` と検索関数を使って再現できます。`String`および[検索関数](/sql-reference/functions/string-search-functions)ネイティブのオートコンプリート機能やサジェストエンジンはありませんが、`String` 型と検索関数を組み合わせることで実現できます。                                                                                           |
| `semantic_text`                       | 該当なし                                                                                                                                                                                                                                                                                                                                                                                                               | ネイティブのセマンティック検索機能はありません。埋め込みを生成してベクトル検索を使用してください。                                                                                                                                                                                                                                         |
| `token_count`                         | [`Int32`](/sql-reference/data-types/int-uint)                                                                                                                                                                                                                                                                                                                                                                      | 取り込み時にトークン数を手動で計算する場合に使用します。例：`length(tokens())`関数（例：Materialized 列と組み合わせて使用）                                                                                                                                                                                                             |
| `dense_vector`                        | [`Array(Float32)`](/sql-reference/data-types/array)                                                                                                                                                                                                                                                                                                                                                                | 埋め込みの保存には配列を使う                                                                                                                                                                                                                                                                            |
| `sparse_vector`                       | [`Map(UInt32, Float32)`](/sql-reference/data-types/map)                                                                                                                                                                                                                                                                                                                                                            | `Map` を使ってスパースベクトルを擬似的に表現します。スパースベクトルをネイティブにサポートしてはいません。                                                                                                                                                                                                                                  |
| `rank_feature`/`rank_features`        | [`Float32`](/sql-reference/data-types/float),[`Array(Float32)`](/sql-reference/data-types/array)                                                                                                                                                                                                                                                                                                                   | ネイティブなクエリ時ブースト機能はないが、スコアリングロジック内で手動でモデル化できる。                                                                                                                                                                                                                                              |
| `geo_point`                           | [`Tuple(Float64, Float64)`](/sql-reference/data-types/tuple)または[`Point`](/sql-reference/data-types/geo#point)                                                                                                                                                                                                                                                                                                      | (緯度, 経度) のタプルを使用してください。[`Point`](/sql-reference/data-types/geo#point)は ClickHouse の型として使用できます。                                                                                                                                                                                            |
| `geo_shape`,`shape`                   | [`Ring`](/sql-reference/data-types/geo#ring)`Ring`、`LineString`、`MultiLineString`、`Polygon`、`MultiPolygon`[`LineString`](/sql-reference/data-types/geo#linestring),[`MultiLineString`](/sql-reference/data-types/geo#multilinestring)、[`Polygon`](/sql-reference/data-types/geo#polygon)`Ring`、`LineString`、`MultiLineString`、`Polygon`、`MultiPolygon`[`MultiPolygon`](/sql-reference/data-types/geo#multipolygon) | ジオメトリ形状と空間インデックスをネイティブにサポート                                                                                                                                                                                                                                                               |
| `percolator`                          | 該当なし                                                                                                                                                                                                                                                                                                                                                                                                               | クエリにインデックスを付けるという概念はありません。代わりに標準的な SQL とインクリメンタルマテリアライズドビューを使用してください。                                                                                                                                                                                                                     |
| `version`                             | [`String`](/sql-reference/data-types/string)                                                                                                                                                                                                                                                                                                                                                                       | ClickHouse にはネイティブなバージョン型はありません。バージョンは文字列として保存し、必要に応じてセマンティックな比較を行うためにカスタム UDF を使用してください。レンジクエリが必要な場合は、数値形式へ正規化することを検討してください。                                                                                                                                                             |

### 注意事項 {#notes}

- **配列**: Elasticsearchでは、すべてのフィールドがネイティブに配列をサポートしています。ClickHouseでは、配列を明示的に定義する必要があります（例：`Array(String)`）が、その利点として特定の位置にアクセスしてクエリを実行できます（例：`an_array[1]`）。
- **マルチフィールド**: Elasticsearchでは、[同じフィールドを複数の方法でインデックス化](https://www.elastic.co/docs/reference/elasticsearch/mapping-reference/multi-fields#_multi_fields_with_multiple_analyzers)できます（例：`text`と`keyword`の両方）。ClickHouseでは、このパターンは別々のカラムまたはビューを使用してモデル化する必要があります。
- **Map型とJSON型** - ClickHouseでは、[`Map`](/sql-reference/data-types/map)型は`resourceAttributes`や`logAttributes`などの動的なキーバリュー構造をモデル化するために一般的に使用されます。この型は、実行時に任意のキーを追加できるようにすることで、柔軟なスキーマレス取り込みを可能にします。これはElasticsearchのJSONオブジェクトと本質的に類似しています。ただし、考慮すべき重要な制限があります：
  - **統一された値の型**: ClickHouseの[`Map`](/sql-reference/data-types/map)カラムは、一貫した値の型を持つ必要があります（例：`Map(String, String)`）。型変換なしでは、混合型の値はサポートされません。
  - **パフォーマンスコスト**: [`Map`](/sql-reference/data-types/map)内の任意のキーにアクセスするには、マップ全体をメモリにロードする必要があり、パフォーマンス上最適ではない場合があります。
  - **サブカラムなし**: JSONとは異なり、[`Map`](/sql-reference/data-types/map)内のキーは真のサブカラムとして表現されないため、ClickHouseのインデックス化、圧縮、効率的なクエリ実行の能力が制限されます。

  これらの制限により、ClickStackは[`Map`](/sql-reference/data-types/map)から、ClickHouseの拡張された[`JSON`](/sql-reference/data-types/newjson)型への移行を進めています。[`JSON`](/sql-reference/data-types/newjson)型は、`Map`の多くの欠点に対処します：
  - **真のカラムナーストレージ**: 各JSONパスはサブカラムとして保存され、効率的な圧縮、フィルタリング、ベクトル化されたクエリ実行が可能になります。
  - **混合型のサポート**: 異なるデータ型（例：整数、文字列、配列）が、型変換や型統一なしに同じパスの下で共存できます。
  - **ファイルシステムのスケーラビリティ**: 動的キー（`max_dynamic_paths`）と型（`max_dynamic_types`）の内部制限により、高カーディナリティのキーセットでも、ディスク上のカラムファイルの爆発的増加を防ぎます。
  - **効率的なストレージ**: nullや欠損値はスパースに保存され、不要なオーバーヘッドを回避します。

    [`JSON`](/sql-reference/data-types/newjson)型は、特にオブザーバビリティワークロードに適しており、スキーマレス取り込みの柔軟性とネイティブClickHouse型のパフォーマンスおよびスケーラビリティを提供します。これにより、動的属性フィールドにおける[`Map`](/sql-reference/data-types/map)の理想的な代替となります。

    JSON型の詳細については、[JSONガイド](https://clickhouse.com/docs/integrations/data-formats/json/overview)および[「ClickHouse向けの新しい強力なJSONデータ型の構築方法」](https://clickhouse.com/blog/a-new-powerful-json-data-type-for-clickhouse)を参照することをお勧めします。
