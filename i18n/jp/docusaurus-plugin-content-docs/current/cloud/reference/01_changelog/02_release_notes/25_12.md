---
slug: /changelogs/25.12
title: 'v25.12 Cloud 向け変更履歴'
description: 'v25.12 の変更履歴'
keywords: ['changelog', 'cloud']
sidebar_label: '25.12'
sidebar_position: 1
doc_type: 'changelog'
---

# Cloud 向け v25.12 の変更履歴 \{#v2512-changelog-for-cloud\}

## 後方互換性を損なう変更 \{#backward-incompatible-changes\}

### データ型の変更 \{#data-type-changes\}

* `Geometry` 型を導入しました。この型について `WKB` および `WKT` フォーマットの読み取りをサポートします。以前のバージョンでは `Geometry` 型は `String` のエイリアスでしたが、現在は完全な機能を備えた独立した型になりました。 [#83344](https://github.com/ClickHouse/ClickHouse/pull/83344) ([Konstantin Vedernikov](https://github.com/scanhex12))。
* 非推奨だった Object 型を削除しました。 [#85718](https://github.com/ClickHouse/ClickHouse/pull/85718) ([Pavel Kruglov](https://github.com/Avogar))。
* MergeTree テーブルの Wide データパーツにおける Variant 型サブカラムのために作成されるファイル名をエスケープするようにしました。この変更により、Variant/Dynamic/JSON データ型を持つ既存テーブルとの互換性が失われます。この変更は、Variant 内で特殊文字を含む型（たとえば、`\` を含む特定のタイムゾーンを持つ DateTime など）の保存時に発生していた問題を修正します。エスケープは、MergeTree の SETTING `escape_variant_subcolumn_filenames` を変更することで無効にできます（互換性を維持するには、MergeTree の設定でこの SETTING を無効化するか、アップグレード前のバージョンに `compatibility` SETTING を設定してください）。[#69590](https://github.com/ClickHouse/ClickHouse/issues/69590) を解決します。 [#87300](https://github.com/ClickHouse/ClickHouse/pull/87300) ([Pavel Kruglov](https://github.com/Avogar))。

### クエリおよび関数の変更 \{#query-and-function-changes\}

* `ALTER MODIFY COLUMN` は、Nullable なカラムを non-nullable 型に変換する際に、明示的な `DEFAULT` の指定が必須になりました。以前は、そのような `ALTER` が `cannot convert null to not null` エラーで行き詰まる可能性がありましたが、現在は `NULL` がカラムのデフォルト式で置き換えられます。[#5985](https://github.com/ClickHouse/ClickHouse/issues/5985) を解決します。 [#84770](https://github.com/ClickHouse/ClickHouse/pull/84770)（[Vladimir Cherkasov](https://github.com/vdimir)）。
* 設定 `allow_not_comparable_types_in_order_by` / `allow_not_comparable_types_in_comparison_functions` を削除しました。ORDER BY 句や比較関数で比較不可能な型を許可すると、論理的なエラーや予期しない結果につながる可能性があります。[#90028](https://github.com/ClickHouse/ClickHouse/issues/90028) を解決します。 [#90527](https://github.com/ClickHouse/ClickHouse/pull/90527)（[Pavel Kruglov](https://github.com/Avogar)）。
* 関数 bitShiftLeft および bitShiftRight を修正し、型のサイズとちょうど同じだけシフトが行われた場合には、0 または空値を返すようにしました。 [#91943](https://github.com/ClickHouse/ClickHouse/pull/91943)（[Pablo Marcos](https://github.com/pamarcos)）。
* Ngram tokenizer は、設定された長さ N 未満の ngram を返さないようになりました。Text Search は、検索トークンが空の場合には行を返しません。 [#89757](https://github.com/ClickHouse/ClickHouse/pull/89757)（[George Larionov](https://github.com/george-larionov)）。

### ストレージと索引の変更 \{#storage-and-index-changes\}

* 廃止された `LIVE VIEW` 機能を削除しました。`LIVE VIEW` を使用している場合、新しいバージョンへのアップグレードはできません。 [#88706](https://github.com/ClickHouse/ClickHouse/pull/88706) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 共有オブジェクトストレージパス上に複数の `plain-rewritable` ディスクを作成することを禁止しました。これは、異なるメタデータストレージトランザクションが衝突した際に、挙動が未定義となる可能性があるためです。 [#89038](https://github.com/ClickHouse/ClickHouse/pull/89038) ([Mikhail Artemenko](https://github.com/Michicosun)).
* 特殊な `MergeTree` テーブル（`ReplacingMergeTree`、`CollapsingMergeTree` など）について、`ORDER BY` キーが空の状態で作成することを禁止しました。これらのテーブルではマージ動作が未定義となるためです。どうしてもそのようなテーブルを作成する必要がある場合は、`allow_suspicious_primary_key` 設定を有効にしてください。 [#91569](https://github.com/ClickHouse/ClickHouse/pull/91569) ([Anton Popov](https://github.com/CurtizJ)).
* 暗黙の索引に関して、複数の修正を行いました。表示または保存されるスキーマ（Keeper メタデータ）には、`add_minmax_index_for_numeric_columns` や `add_minmax_index_for_string_columns` のような設定によって作成される暗黙の索引は含まれなくなります。これにより、古いリリースのレプリカが存在する状態で、新しいバージョンで ReplicatedMergeTree テーブルを作成または更新すると、メタデータエラーが発生する可能性があります。 [#91429](https://github.com/ClickHouse/ClickHouse/pull/91429) ([Raúl Marín](https://github.com/Algunenano)).

### 設定および構成の変更 \{#settings-and-configuration-changes\}

* クライアントが例外をより確実にパースできるように、HTTP の結果レスポンスに対する例外のタグ付けをサポートしました。[#75175](https://github.com/ClickHouse/ClickHouse/issues/75175) を解決します。設定 `http_write_exception_in_output_format` は、フォーマット間の一貫性のためデフォルトでは無効になっています。[#88818](https://github.com/ClickHouse/ClickHouse/pull/88818)（[Kaviraj Kanagaraj](https://github.com/kavirajk)）。
* Kafka ストレージの SASL 設定の優先順位を修正しました。`CREATE TABLE` クエリで指定されたテーブルレベルの SASL 設定が、設定ファイル内のコンシューマー／プロデューサー固有の設定を正しく上書きするようになりました。[#89401](https://github.com/ClickHouse/ClickHouse/pull/89401)（[János Benjamin Antal](https://github.com/antaljanosbenjamin)）。
* ACME 構成パラメータ `refresh_certificates_task_interval` を `refresh_certificates_task_interval_seconds` に、`refresh_certificates_before` を `refresh_certificates_before_seconds` に名称変更しました。`refresh_certificates_task_interval_seconds` パラメータは、秒単位の値を受け取るようになりました。[#92211](https://github.com/ClickHouse/ClickHouse/pull/92211)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* プロジェクションで無効化された位置指定引数を、後方互換性のない変更としてマークしました。加えて、プロジェクション内に位置指定引数が存在する場合でも、安全に ClickHouse クラスタをアップグレードできるようにするための設定 `enable_positional_arguments_for_projections` を導入しました。[#92007](https://github.com/ClickHouse/ClickHouse/pull/92007)（[Dmitry Novik](https://github.com/novikd)）。

### クライアントの変更 \{#client-changes\}

* `receive_timeout` によってクエリがタイムアウトした場合に、clickhouse-client が非ゼロの終了コード (159 - TIMEOUT_EXCEEDED) を返すように更新しました。以前は、タイムアウト時にも終了コード 0 (成功) を返していたため、スクリプトや自動化処理でタイムアウトによる失敗を検出することが困難でした。 [#91432](https://github.com/ClickHouse/ClickHouse/pull/91432) ([Sav](https://github.com/sberss))

### 統計フォーマットの変更 \{#statistics-format-changes\}

* カラムを `String` から `Nullable(String)` に `ALTER COLUMN` する場合、データ自体に対する mutation は行われません。ただし、`uniq` 集約関数は異なるデータ構造を使用します。nullable なカラムの場合は、ネストされた uniq 集約器を持つ `AggregateFunctionNull` を使用します。`AggregateFunctionNull` は追加の bool フラグをシリアライズします。このため、統計ファイルとの互換性が失われます。統計フォーマットは変更されており、古いフォーマットの統計が存在するとサーバーがクラッシュします。例外を回避するには、統計を再生成するために `ALTER TABLE [db.]table MATERIALIZE STATISTICS ALL` を実行してください。[#90311](https://github.com/ClickHouse/ClickHouse/pull/90311)（[Han Fei](https://github.com/hanfei1991)）。

### その他の互換性破壊的変更 \{#other-breaking-changes\}

* 要素サイズに揃っていないサイズのデータを圧縮する際に発生する `Fatal` エラーを修正しました（T64 コーデック）。[#89282](https://github.com/ClickHouse/ClickHouse/issues/89282) を解決しました。[#89432](https://github.com/ClickHouse/ClickHouse/pull/89432)（[yanglongwei](https://github.com/ylw510)）。

## 新機能 \{#new-features\}

### Functions \{#functions\}

* ユーザーのなりすましをサポートする新しい SQL ステートメント EXECUTE AS を追加しました。[#39048](https://github.com/ClickHouse/ClickHouse/issues/39048) を解決。[#70775](https://github.com/ClickHouse/ClickHouse/pull/70775)（[Shankar](https://github.com/shiyer7474)）。
* 配列内の必要な次元数を展開し、Tuple カラム内のポインタを入れ替える `flipCoordinates` 関数を追加しました。[#79469](https://github.com/ClickHouse/ClickHouse/issues/79469) を解決。[#79634](https://github.com/ClickHouse/ClickHouse/pull/79634)（[Sachin Kumar Singh](https://github.com/sachinkumarsingh092)）。
* `IS NOT DISTINCT FROM` (`<=>`) 演算子を強化しました。逆の `IS DISTINCT FROM` をサポートし、異なる型の互換性のある数値オペランド（例: `Nullable(UInt32)` と `Nullable(Int64)`）をサポートしました。[#87581](https://github.com/ClickHouse/ClickHouse/pull/87581)（[yanglongwei](https://github.com/ylw510)）。
* `cume_dist` ウィンドウ関数のサポートを追加しました。[#86920](https://github.com/ClickHouse/ClickHouse/issues/86920) を修正。[#88102](https://github.com/ClickHouse/ClickHouse/pull/88102)（[Manuel](https://github.com/raimannma)）。
* geometry 型に対して面積と周長を計算する関数を追加しました。[#89047](https://github.com/ClickHouse/ClickHouse/pull/89047)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* 属性が指定された値と等しい Dictionary のキーを返す `dictGetKeys` 関数を実装しました。クエリ単位の逆引きキャッシュを使用しており、`max_reverse_dictionary_lookup_cache_size_bytes` setting によって調整され、繰り返し検索を高速化します。[#89197](https://github.com/ClickHouse/ClickHouse/pull/89197)（[Nihal Z. Miaji](https://github.com/nihalzp)）。
* 配列 `arr` から `elem` と等しいすべての要素を削除する `arrayRemove(arr, elem)` のサポートを追加しました。[#52099](https://github.com/ClickHouse/ClickHouse/issues/52099) を解決。[#89585](https://github.com/ClickHouse/ClickHouse/pull/89585)（[tiwarysaurav](https://github.com/tiwarysaurav)）。
* 平均を計算する `midpoint` スカラー関数を導入しました。[#89029](https://github.com/ClickHouse/ClickHouse/issues/89029) を解決。[#89679](https://github.com/ClickHouse/ClickHouse/pull/89679)（[simonmichal](https://github.com/simonmichal)）。
* 新しい `argAndMin` および `argAndMax` 関数を使用して、引数と、その引数に対応する最小値または最大値の両方を取得できるようになりました。[#89884](https://github.com/ClickHouse/ClickHouse/pull/89884)（[AbdAlRahman Gad](https://github.com/AbdAlRahmanGad)）。
* [#73900](https://github.com/ClickHouse/ClickHouse/issues/73900) および [#38775](https://github.com/ClickHouse/ClickHouse/issues/38775) の一部として、`HMAC(algorithm, message, key)` SQL 関数を追加しました。[#90837](https://github.com/ClickHouse/ClickHouse/pull/90837)（[Mikhail f. Shiryaev](https://github.com/Felixoid)）。
* 第 1 引数が定数配列の場合に、`has()` 関数がプライマリキーとデータスキッピングインデックスを使用できるようにサポートを追加しました。[#90980](https://github.com/ClickHouse/ClickHouse/issues/90980) をクローズ。[#91023](https://github.com/ClickHouse/ClickHouse/pull/91023)（[Nihal Z. Miaji](https://github.com/nihalzp)）。

### システムテーブル \{#system-tables\}

* Unicode 文字とそのプロパティの一覧を含む `system.unicode` テーブルを追加しました。[#80055](https://github.com/ClickHouse/ClickHouse/issues/80055) をクローズしました。[#80857](https://github.com/ClickHouse/ClickHouse/pull/80857)（[wxybear](https://github.com/wxybear)）。
* `shared_merge_tree_outdated_parts` に類似した新しいシステムテーブル `shared_merge_tree_condemned_parts` を追加しました。このテーブルは、PartsKillerThread によって削除予定のパーツを一覧します。（[Smita Kulkarni](https://github.com/SmitaRKulkarni)）。

### テーブルエンジンとストレージ \{#table-engines-and-storage\}

* Prometheus HTTP Query API の一部をサポートしました。有効化するには、設定ファイルの `<prometheus>` セクションに `query_api` タイプのルールを追加します。サポートされるハンドラーは `/api/v1/query_range` と `/api/v1/query` です。[#86132](https://github.com/ClickHouse/ClickHouse/pull/86132)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* ユーザーは、これまでのファイルを保持または削除するオプションに加えて、処理済みファイルを移動またはタグ付けするように S3/Azure Queue テーブルを設定できるようになりました。[#72944](https://github.com/ClickHouse/ClickHouse/issues/72944) を解決します。[#86907](https://github.com/ClickHouse/ClickHouse/pull/86907)（[Murat Khairulin](https://github.com/mxwell)）。
* マージ後の Wide パーツにおける動的サブカラム数を、データ型で指定されたパラメータに関係なく制限できるようにするため、新しい MergeTree の設定 `merge_max_dynamic_subcolumns_in_wide_part` を追加しました。[#87646](https://github.com/ClickHouse/ClickHouse/pull/87646)（[Pavel Kruglov](https://github.com/Avogar)）。
* Microsoft OneLake カタログとの連携を追加しました。[#89366](https://github.com/ClickHouse/ClickHouse/pull/89366)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* 一時テーブルに対して `CREATE OR REPLACE` 構文をサポートしました。[#35888](https://github.com/ClickHouse/ClickHouse/issues/35888) をクローズします。[#89450](https://github.com/ClickHouse/ClickHouse/pull/89450)（[Aleksandr Musorin](https://github.com/AVMusorin)）。
* MergeTree テーブルに対して `direct`（ネストされたループ）JOIN をサポートしました。使用するには、設定で唯一のオプションとして指定します: `join_algorithm = 'direct'`。[#89920](https://github.com/ClickHouse/ClickHouse/pull/89920)（[Vladimir Cherkasov](https://github.com/vdimir)）。
* この PR では、`ALTER TABLE ... ADD PROJECTION` に新たに追加された `WITH SETTINGS` 句を通じて利用可能な、プロジェクションレベルの設定を導入します。これらの設定により、プロジェクションはプロジェクション単位で、特定の MergeTree ストレージパラメータ（例: index_granularity, index_granularity_bytes）を上書きできるようになります。[#90158](https://github.com/ClickHouse/ClickHouse/pull/90158)（[Amos Bird](https://github.com/amosbird)）。

### Iceberg とデータレイク \{#iceberg-and-data-lakes\}

* Iceberg に対する `CREATE` 操作での `ORDER BY` のサポートおよび `INSERT` 時のソートをサポート。[#89916](https://github.com/ClickHouse/ClickHouse/issues/89916) を解決。[#90141](https://github.com/ClickHouse/ClickHouse/pull/90141)（[Konstantin Vedernikov](https://github.com/scanhex12)）。

### SQL とクエリの機能 \{#sql-and-query-features\}

* 集約関数 `windowFunnel` にオプション `allow_reentry` を追加しました。`strict_order` とともに有効化すると、ファネル解析を停止する代わりに順序に違反するイベントを無視します。これにより、リフレッシュを伴うユーザージャーニー (A->A->B) や戻る操作を伴うユーザージャーニー (A->B->A->C) を扱う際に、コンバージョン率を過少報告せずに済みます。[#86916](https://github.com/ClickHouse/ClickHouse/pull/86916)（[Lee ChaeRok](https://github.com/LeeChaeRok)）。
* テキスト索引の構築時に、新しい引数 `preprocessor` を指定できるようになりました。この引数は、トークン化の前に各ドキュメントを変換するための任意の式です。[#88272](https://github.com/ClickHouse/ClickHouse/pull/88272)（[Jimmy Aguilar Mena](https://github.com/Ergus)）。
* テーブルの一部（割合）を選択するために、`LIMIT` および `OFFSET` で小数値を指定できるようになりました。[#81892](https://github.com/ClickHouse/ClickHouse/issues/81892) をクローズ。[#88755](https://github.com/ClickHouse/ClickHouse/pull/88755)（[Ahmed Gouda](https://github.com/0xgouda)）。
* 出力パスが存在しない場合の `INTO OUTFILE` のエラーを防ぐために、親ディレクトリを自動的に作成する設定 `into_outfile_create_parent_directories` を追加しました。[#88610](https://github.com/ClickHouse/ClickHouse/issues/88610) を解決。[#88795](https://github.com/ClickHouse/ClickHouse/pull/88795)（[Saksham](https://github.com/Saksham10-11)）。
* JSON 型に対する INSERT/型キャスト時に、入力 JSON を JSON 型の明示的な型付きパスへキャストできない場合の例外を無効にするための設定 `type_json_skip_invalid_typed_paths` を追加しました。代わりに、その型付きパスの null 値／ゼロ値にフォールバックします。[#86917](https://github.com/ClickHouse/ClickHouse/issues/86917) をクローズ。[#89886](https://github.com/ClickHouse/ClickHouse/pull/89886)（[Max Justus Spransy](https://github.com/maxjustus)）。

### クライアントおよび CLI の機能 \{#client-and-cli-features\}

* CLI クライアントで、`--no-server-client-version-message` または `false` を指定することで、「ClickHouse server version is older than ClickHouse client. It may indicate that the server is out of date and can be upgraded.」というメッセージを非表示にできるようになりました。[#87784](https://github.com/ClickHouse/ClickHouse/pull/87784) ([Larry Snizek](https://github.com/larry-cdn77))。
* `--login` を使用して、Cloud クレデンシャルで ClickHouse Cloud インスタンスにアクセスできるようになりました。[#89261](https://github.com/ClickHouse/ClickHouse/pull/89261) ([Krishna Mannem](https://github.com/kcmannem))。
* Web UI にダウンロードボタンが追加されました。UI で一部のみが表示されている場合でも、結果全体をダウンロードします。[#89768](https://github.com/ClickHouse/ClickHouse/pull/89768) ([Alexey Milovidov](https://github.com/alexey-milovidov))。

### サーバー構成と監視 \{#server-configuration-and-monitoring\}

* `X-ClickHouse-Progress` および `X-ClickHouse-Summary` に `memory_usage` フィールドを追加しました。これにより、クエリのメモリ使用量をクライアント側でリアルタイムに収集できます。 [#88393](https://github.com/ClickHouse/ClickHouse/pull/88393) ([Christoph Wurm](https://github.com/cwurm))。
* プロファイルイベントを使用しない場合に、クライアント側のネットワークトラフィックを削減できるようにする `send_profile_events` SETTING を追加しました。 [#89588](https://github.com/ClickHouse/ClickHouse/pull/89588) ([Kaviraj Kanagaraj](https://github.com/kavirajk))。

### Keeper \{#keeper\}

* Keeper の ZooKeeper 互換性: STATISTICS を伴う CREATE に対応。[#88797](https://github.com/ClickHouse/ClickHouse/pull/88797)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* ClickHouse Keeper における ZooKeeper 永続ウォッチのサポート。[#88813](https://github.com/ClickHouse/ClickHouse/pull/88813)（[Konstantin Vedernikov](https://github.com/scanhex12)）。

### 入出力フォーマット \{#input-output-formats\}

* 新しい入出力フォーマット `Buffers` を実装しました。このフォーマットは `Native` に似ていますが、`Native` と異なり、カラム名、カラム型、追加のメタデータを保存しません。[#84017](https://github.com/ClickHouse/ClickHouse/issues/84017) をクローズしました。[#91156](https://github.com/ClickHouse/ClickHouse/pull/91156)（[Nihal Z. Miaji](https://github.com/nihalzp)）。
* Dremio およびコマンド形式のディスクリプタを要求するその他の Arrow Flight サーバーをサポートするために、`arrow_flight_request_descriptor_type` 設定を追加しました。[#89523](https://github.com/ClickHouse/ClickHouse/issues/89523) を修正しました。[#89826](https://github.com/ClickHouse/ClickHouse/pull/89826)（[Shreyas Ganesh](https://github.com/shreyasganesh0)）。
* メッセージペイロードをパースする前にエンベロープヘッダーのバイト（例: AWS Glue Schema Registry の 19 バイトのプレフィックス）をスキップできるようにするため、Kafka テーブルエンジンに `kafka_schema_registry_skip_bytes` 設定を追加しました。[#89621](https://github.com/ClickHouse/ClickHouse/pull/89621)（[Taras Polishchuk](https://github.com/wake-up-neo)）。

### その他の新機能 \{#other-new-features\}

* Cluster テーブル関数でのファイル並列読み込み時のストリーム数を制御するための設定 `max_streams_for_files_processing_in_cluster_functions` を追加。[#90223](https://github.com/ClickHouse/ClickHouse/issues/90223) をクローズ。[#91323](https://github.com/ClickHouse/ClickHouse/pull/91323)（[Pavel Kruglov](https://github.com/Avogar)）。
* クエリごとに近接パーツデータのバックグラウンドでのダウンロードを無効化できるようにした。[#89524](https://github.com/ClickHouse/ClickHouse/issues/89524) を修正。[#89668](https://github.com/ClickHouse/ClickHouse/pull/89668)（[tanner-bruce](https://github.com/tanner-bruce)）。
* ClickHouse の新しいプラットフォームとして e2k (Elbrus-2000) を実験的にサポート。[#90159](https://github.com/ClickHouse/ClickHouse/pull/90159)（[Ramil Sattarov](https://github.com/r-a-sattarov)）。

## 実験的機能 \{#experimental-features\}

* ACME プロバイダからの TLS 証明書取得をサポートしました。[RFC 8555](https://datatracker.ietf.org/doc/html/rfc8555)。[#66315](https://github.com/ClickHouse/ClickHouse/pull/66315)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* 設定 `automatic_parallel_replicas_mode` で制御される、並列レプリカを用いてクエリを自動実行するための新しいロジックを導入しました。[#87541](https://github.com/ClickHouse/ClickHouse/pull/87541)（[Nikita Taranov](https://github.com/nickitat)）。
* フルテキスト検索は、以前の実験的段階からプライベートプレビューに移行しました。[#88928](https://github.com/ClickHouse/ClickHouse/pull/88928)（[Robert Schulze](https://github.com/rschu1ze)）。
* `Alias` を実験的機能に移動し、`allow_experimental_alias_table_engine=1` で有効化できるようにしました。[#89712](https://github.com/ClickHouse/ClickHouse/pull/89712)（[Kai Zhu](https://github.com/nauu)）。

## パフォーマンスの向上 \{#performance-improvements\}

### クエリの実行と最適化 \{#query-execution-and-optimization\}

* クエリが行制限に達した場合は早期に失敗させるようにしました。[#61872](https://github.com/ClickHouse/ClickHouse/issues/61872) を解決。[#62804](https://github.com/ClickHouse/ClickHouse/pull/62804)（[Sean Haynes](https://github.com/seandhaynes)）。
* クエリプラン内の未使用カラムを削除する最適化を追加しました。[#75152](https://github.com/ClickHouse/ClickHouse/issues/75152) を解決。[#76487](https://github.com/ClickHouse/ClickHouse/pull/76487)（[János Benjamin Antal](https://github.com/antaljanosbenjamin)）。
* ConstantNode における大きな値に対する最適化を行いました。[#72880](https://github.com/ClickHouse/ClickHouse/issues/72880) をクローズ。[#81104](https://github.com/ClickHouse/ClickHouse/pull/81104)（[Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)）。
* キャッシュミスを最小化するため、ハッシュテーブル反復中にキーを先読みするようにしました。[#84708](https://github.com/ClickHouse/ClickHouse/pull/84708)（[lgbo](https://github.com/lgbo-ustc)）。
* コードの単純化と選択アルゴリズムの調整により、LZ4 の伸長速度を改善しました。[#88360](https://github.com/ClickHouse/ClickHouse/pull/88360)（[Raúl Marín](https://github.com/Algunenano)）。
* JOIN および ARRAY JOIN において、遅延カラムレプリケーションを実装しました。Sparse や Replicated のような特殊なカラム表現を、一部の出力フォーマットでフルカラムへ変換することを避けます。これにより、メモリ内での不要なデータコピーを回避します。[#88752](https://github.com/ClickHouse/ClickHouse/pull/88752)（[Pavel Kruglov](https://github.com/Avogar)）。
* 動的ディスパッチを用いて、論理関数に対して高度な SIMD 演算を使用するようにしました。[#90432](https://github.com/ClickHouse/ClickHouse/pull/90432)（[Raúl Marín](https://github.com/Algunenano)）。
* 結果カラムを不要にゼロ初期化しないことで、JIT 関数の実行パフォーマンスを改善しました。[#90449](https://github.com/ClickHouse/ClickHouse/pull/90449)（[Raúl Marín](https://github.com/Algunenano)）。
* 動的ディスパッチにより、T64 の伸長処理を高速化しました。[#90610](https://github.com/ClickHouse/ClickHouse/pull/90610)（[Raúl Marín](https://github.com/Algunenano)）。
* 動的ディスパッチにより、（`WHERE` 句内での）カラムから bool への変換を高速化しました。[#91203](https://github.com/ClickHouse/ClickHouse/pull/91203)（[Raúl Marín](https://github.com/Algunenano)）。
* 動的ディスパッチにより、単一の数値ブロックのソートを高速化しました。[#91213](https://github.com/ClickHouse/ClickHouse/pull/91213)（[Raúl Marín](https://github.com/Algunenano)）。

### JOIN の最適化 \{#join-optimizations\}

* `RIGHT` および `FULL JOIN` が ConcurrentHashJoin を使用するようになりました。これにより、これらの種類の JOIN はより高い並列度で実行されます。`RIGHT` および `FULL JOIN` のさまざまなケースで、最大 2 倍の高速化が見込めます。[#78027](https://github.com/ClickHouse/ClickHouse/issues/78027) を解決しました。[#78462](https://github.com/ClickHouse/ClickHouse/pull/78462)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* 一部のケースでは、`ANY LEFT JOIN` または `ANY RIGHT JOIN` を `ALL INNER JOIN` に書き換えられるようになりました。[#89403](https://github.com/ClickHouse/ClickHouse/pull/89403)（[Dmitry Novik](https://github.com/novikd)）。
* `ANTI` JOIN に対する `JOIN` ランタイムフィルタをサポートしました。また、ロック競合を減らすためにランタイムフィルタの実装をリファクタリングしました。[#89710](https://github.com/ClickHouse/ClickHouse/pull/89710)（[Dmitry Novik](https://github.com/novikd)）。
* 後続のステップで活用できるよう、`LEFT` / `INNER JOIN` 演算において左テーブルからの読み取り順序を維持できるようにしました。[#89815](https://github.com/ClickHouse/ClickHouse/pull/89815)（[Vladimir Cherkasov](https://github.com/vdimir)）。

### MergeTree とストレージの最適化 \{#mergetree-and-storage-optimizations\}

* 10K 以上のパーツを持つテーブルで、パーティションプルーニングが多い `SELECT` クエリを最大 8 倍まで高速化。[#85535](https://github.com/ClickHouse/ClickHouse/pull/85535)（[James Morrison](https://github.com/jawm)）。
* クエリが集約状態（小さい整数による GROUP BY）に固定ハッシュマップを使用する場合、ClickHouse はクエリを高速化するために集約状態を並列にマージするようになりました。[#63666](https://github.com/ClickHouse/ClickHouse/issues/63666) を解決。[#87366](https://github.com/ClickHouse/ClickHouse/pull/87366)（[Jianfei Hu](https://github.com/incfly)）。
* Parquet reader v3 をデフォルトで有効化。[#88827](https://github.com/ClickHouse/ClickHouse/pull/88827)（[Michael Kolupaev](https://github.com/al13n321)）。
* `optimize_read_in_order` と `query_plan_optimize_lazy_materialization` を同時に利用してクエリを高速化可能に。[#88767](https://github.com/ClickHouse/ClickHouse/issues/88767) を解決。[#88866](https://github.com/ClickHouse/ClickHouse/pull/88866)（[Manuel](https://github.com/raimannma)）。
* `DISTINCT` を含むクエリで集約 PROJECTION を使用。[#86925](https://github.com/ClickHouse/ClickHouse/issues/86925) をクローズ。[#88894](https://github.com/ClickHouse/ClickHouse/pull/88894)（[Nihal Z. Miaji](https://github.com/nihalzp)）。
* 入力のソート順が `LIMIT BY` キーと一致する場合に、ストリーミング `LIMIT BY` transform を実行。[#88969](https://github.com/ClickHouse/ClickHouse/pull/88969)（[Eduard Karacharov](https://github.com/korowa)）。
* Nullable 型のカラムに対するスパースシリアライゼーションをサポート。[#88999](https://github.com/ClickHouse/ClickHouse/pull/88999)（[Amos Bird](https://github.com/amosbird)）。
* MergeTree reader のインプレースフィルタリングを最適化。[#87119](https://github.com/ClickHouse/ClickHouse/issues/87119) を解決。[#90630](https://github.com/ClickHouse/ClickHouse/pull/90630)（[Xiaozhe Yu](https://github.com/wudidapaopao)）。
* 選択されたマージ候補の幅を削減するための追加のヒューリスティックを導入。[#91163](https://github.com/ClickHouse/ClickHouse/pull/91163)（[Mikhail Artemenko](https://github.com/Michicosun)）。

### 索引およびテキスト検索の最適化 \{#index-and-text-search-optimizations\}

* ClickHouse は、`AND` と `OR` が混在したフィルター条件を持つ `WHERE` 句に対してスキップ索引を用いた索引解析を行うようになりました。これまでは、スキップ索引を利用するには `WHERE` 句がフィルター条件の連言 (AND) である必要がありました。この機能は新しい `use_skip_indexes_for_disjunctions` 設定（デフォルト: on）で制御されます。[#87781](https://github.com/ClickHouse/ClickHouse/pull/87781) ([Shankar Iyer](https://github.com/shankar-iyer)).
* `like`、`equals`、`has` などの関数を含む述語について、テキスト索引から構築された追加の事前フィルターを活用することでフィルタリングのパフォーマンスを向上させました。この最適化は `query_plan_text_index_add_hint` 設定で有効化されます。[#88550](https://github.com/ClickHouse/ClickHouse/pull/88550) ([Anton Popov](https://github.com/CurtizJ)).
* Dictionary ブロックのキャッシュと、バイナリサーチの代わりにトークン検索にハッシュテーブルを使用することで、テキスト索引のパフォーマンスを改善しました。[#88786](https://github.com/ClickHouse/ClickHouse/pull/88786) ([Elmi Ahmadov](https://github.com/ahmadov)).
* ポスティングリストはデータサイズが最も大きいため、それらをキャッシュすることで連続実行時のパフォーマンスが向上します。[#88912](https://github.com/ClickHouse/ClickHouse/pull/88912) ([Elmi Ahmadov](https://github.com/ahmadov)).
* 可能なキー値の事前計算済み集合に対して高速な検索を行うことで、繰り返し実行される逆向き Dictionary ルックアップを最適化しました。[#7968](https://github.com/ClickHouse/ClickHouse/issues/7968) をクローズしました。[#88971](https://github.com/ClickHouse/ClickHouse/pull/88971) ([Nihal Z. Miaji](https://github.com/nihalzp)).
* スキップ索引と動的しきい値フィルターを使用して、処理される行数を大幅に削減することで `ORDER BY...LIMIT N` クエリを最適化しました。[#89835](https://github.com/ClickHouse/ClickHouse/pull/89835) ([Shankar Iyer](https://github.com/shankar-iyer)).
* 大きな `minmax` 索引（数百万グラニュール）が存在する場合、索引解析のレイテンシの低減が期待できます。[#90428](https://github.com/ClickHouse/ClickHouse/pull/90428) ([Shankar Iyer](https://github.com/shankar-iyer)).

### 集約の最適化 \{#aggregation-optimizations\}

* `AggregateFunctionHistogram` を、points 配列の末尾部分のみをソートし、単調な入力に対してはソートをスキップすることで最適化し、およそ 10% の高速化を達成しました。 [#85760](https://github.com/ClickHouse/ClickHouse/pull/85760) ([MakarDev](https://github.com/MakarDev)).
* HashSetTable::merge のオーバーヘッドを削減することで、一部の countDistinct 演算をわずかに高速化しました。 [#89727](https://github.com/ClickHouse/ClickHouse/pull/89727) ([Raúl Marín](https://github.com/Algunenano)).
* topK のパフォーマンスと挙動を改善しました。 [#90091](https://github.com/ClickHouse/ClickHouse/pull/90091) ([Raúl Marín](https://github.com/Algunenano)).
* Decimal 型の比較演算のパフォーマンスを改善しました。[#28192](https://github.com/ClickHouse/ClickHouse/issues/28192) を解決しました。 [#90153](https://github.com/ClickHouse/ClickHouse/pull/90153) ([Konstantin Bogdanov](https://github.com/thevar1able)).

### S3 とバックアップの最適化 \{#s3-and-backup-optimizations\}

* S3 はキー名プレフィックスに基づいて内部的にオブジェクトをパーティション分割し、パーティションごとの高いリクエストレートに自動的にスケールできるようになっています。この変更により、2 つの新しい BACKUP 設定 `data_file_name_generator` と `data_file_name_prefix_length` が導入されました。`data_file_name_generator=checksum` の場合、バックアップデータファイルはその内容のハッシュを用いた名前で保存されます。[#88418](https://github.com/ClickHouse/ClickHouse/pull/88418) ([Julia Kartseva](https://github.com/jkartseva))。
* グロブパターンで作成された S3 テーブルに対して `_path` フィルタ値をプッシュダウンすることでクエリパフォーマンスを改善し、S3 の listing 操作を回避できるようにしました。`s3_path_filter_limit` 設定で制御されます。[#91165](https://github.com/ClickHouse/ClickHouse/pull/91165) ([Eduard Karacharov](https://github.com/korowa))。

### データレイクの最適化 \{#data-lake-optimizations\}

* 分散実行: タスクをファイル単位ではなく行グループ ID 単位でより適切に分割。[#87508](https://github.com/ClickHouse/ClickHouse/pull/87508) ([Konstantin Vedernikov](https://github.com/scanhex12)).
* Paimon 関数でのパーティションプルーニングをサポート。[#90253](https://github.com/ClickHouse/ClickHouse/pull/90253) ([JIaQi Tang](https://github.com/JiaQiTang98)).

## 改善 \{#improvements\}

### クエリの最適化と実行 \{#query-optimization-and-execution\}

* レプリケーテッド MergeTree テーブルに障害のあるディスクが存在していても `FETCH PARTITION` が行えるようになりました。 [#58663](https://github.com/ClickHouse/ClickHouse/pull/58663) ([Duc Canh Le](https://github.com/canhld94))。
* ジオメトリを h3 の六角形セルで充填できる `h3PolygonToCells` 関数を追加しました。これにより [#33991](https://github.com/ClickHouse/ClickHouse/issues/33991) が解決されます。 [#66262](https://github.com/ClickHouse/ClickHouse/pull/66262)（[Zacharias Knudsen](https://github.com/zachasme)）。
* すべての DDL `ON CLUSTER` クエリは、アクセス権限の検証をより正確に行うため、元のクエリを実行したユーザーのコンテキストで実行されるようになりました。 [#71334](https://github.com/ClickHouse/ClickHouse/pull/71334) ([pufit](https://github.com/pufit)).
* `ALTER TABLE ... FREEZE` クエリの処理を並列化しました。 [#71743](https://github.com/ClickHouse/ClickHouse/pull/71743) ([Kirill](https://github.com/kirillgarbar))。
* `IN` の第 2 引数に非定数を使用できるようになりました。第 2 引数としてタプルも指定できます。 [#77906](https://github.com/ClickHouse/ClickHouse/pull/77906) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。
* この PR により、通常のプロジェクションをセカンダリ索引として使用できるようになります。有効にすると、特定のクエリ述語を利用してプロジェクションのパーツから読み出し、PREWHERE ステージで行を効率的にフィルタリングするためのビットマップを生成できます。 [#81021](https://github.com/ClickHouse/ClickHouse/pull/81021) ([Amos Bird](https://github.com/amosbird))。
* より良い一貫性保証のため、`enable_shared_storage_snapshot_in_query` をデフォルトで有効化しました。 [#82634](https://github.com/ClickHouse/ClickHouse/pull/82634) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* UNION は、必要に応じて Variant を使用して型を統一するようになりました。[#82772](https://github.com/ClickHouse/ClickHouse/issues/82772) を解決しました。[#83246](https://github.com/ClickHouse/ClickHouse/pull/83246)（[Mithun p](https://github.com/mithunputhusseri)）。
* 内部クエリ（dictionaries、リフレッシャブルmaterialized view などによって内部的に実行されるもの）をログ出力し、`system.query_log` に新しい `is_internal` カラムを追加しました。 [#83277](https://github.com/ClickHouse/ClickHouse/pull/83277) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* `ALIAS` カラム（式を一切使用せずに物理カラムを単に参照するカラム）への `INSERT` を許可します。[#80060](https://github.com/ClickHouse/ClickHouse/issues/80060) をクローズします。[#84154](https://github.com/ClickHouse/ClickHouse/pull/84154)（[Shaurya Mohan](https://github.com/ShauryaMohan)）。
* clickhouse-client で、`SELECT` を含む `CREATE OR REPLACE TABLE` クエリに対して、進行状況バー、ログ、およびパフォーマンス統計情報を表示できるようになりました。[#38416](https://github.com/ClickHouse/ClickHouse/issues/38416) を解決しました。[#87247](https://github.com/ClickHouse/ClickHouse/pull/87247)（[Diskein](https://github.com/Diskein)）。
* ハッシュ関数で JSON 型および Dynamic 型をサポートしました。[#87734](https://github.com/ClickHouse/ClickHouse/issues/87734) を解決。 [#87791](https://github.com/ClickHouse/ClickHouse/pull/87791)（[Pavel Kruglov](https://github.com/Avogar)）。
* `query_plan_optimize_join_order_limit` のデフォルト値が 10 に変更されました。 [#89312](https://github.com/ClickHouse/ClickHouse/pull/89312) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 最適化オプション enable&#95;lazy&#95;columns&#95;replication がデフォルトで有効になり、JOIN 時のメモリ使用量が削減されます。 [#89316](https://github.com/ClickHouse/ClickHouse/pull/89316) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `allow_statistics_optimize` 設定をデフォルトで有効化し、JOIN のオプティマイザーがカラム統計情報を使用するようにしました。 [#89332](https://github.com/ClickHouse/ClickHouse/pull/89332) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `create_table_empty_primary_key_by_default` をデフォルトで有効化しました。これによりユーザビリティが向上します。 [#89333](https://github.com/ClickHouse/ClickHouse/pull/89333) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `enable_time_time64_type` 設定がデフォルトで有効になりました。 [#89345](https://github.com/ClickHouse/ClickHouse/pull/89345) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。
* `allow_special_serialization_kinds_in_output_formats` 設定をデフォルトで有効化しました。 [#89402](https://github.com/ClickHouse/ClickHouse/pull/89402) ([Pavel Kruglov](https://github.com/Avogar)).
* Shared Catalog を通じて実行されるクエリでは `ON CLUSTER` 句を無視するようにしました。([Nikolay Degterinsky](https://github.com/evillique))。
* Shared Catalog で `ALTER DATABASE MODIFY COMMENT` が利用できるようになりました。([Nikolay Degterinsky](https://github.com/evillique)).
* Shared データベースにおける SharedSet/SharedJoin で `CREATE OR REPLACE` をサポートしました。([Tuan Pham Anh](https://github.com/tuanpach))。
* SharedMergeTree で `SYNC REPLICA` を実行する際に、他のクエリの完了を待たないようにしました。 ([Raúl Marín](https://github.com/Algunenano))。

### Storage and MergeTree improvements \{#storage-and-mergetree-improvements\}

* S3 内の BLOB に関連付けられているすべてのタグを含む新しい仮想カラム `_tags` (`Map(String, String)`) を追加しました。これにより [#72945](https://github.com/ClickHouse/ClickHouse/issues/72945) が解決されました。 [#77773](https://github.com/ClickHouse/ClickHouse/pull/77773)（[Zicong Qu](https://github.com/zicongleoqu)）。
* パーツが重複排除されたことを示すエラーメッセージを追加しました。 [#80264](https://github.com/ClickHouse/ClickHouse/pull/80264)（[Aleksandr Musorin](https://github.com/AVMusorin)）。
* OpenSSL 3.5.4 を使用するようにしました。 [#81389](https://github.com/ClickHouse/ClickHouse/pull/81389)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* bcrypt 認証用のキャッシュを追加しました。 [#87115](https://github.com/ClickHouse/ClickHouse/pull/87115)（[Nikolay Degterinsky](https://github.com/evillique)）。
* Parquet のタイムゾーンなしタイムスタンプ（isAdjustedToUTC=false）は、これまでの DateTime64(...) ではなく、DateTime64(..., 'UTC') として読み込まれるようになりました。 [#87872](https://github.com/ClickHouse/ClickHouse/pull/87872)（[Michael Kolupaev](https://github.com/al13n321)）。
* SQL で定義されたロールを、`users.xml` で定義されたユーザーに付与できるようになりました。 [#88139](https://github.com/ClickHouse/ClickHouse/pull/88139)（[c-end](https://github.com/c-end)）。
* FINAL クエリで使用されるスキップ索引が、主キーの一部であるカラム上にある場合、他のパーツで主キーの交差を確認する追加ステップは不要であり、実行されなくなりました。 [#85897](https://github.com/ClickHouse/ClickHouse/issues/85897) を解決しました。 [#88368](https://github.com/ClickHouse/ClickHouse/pull/88368)（[Shankar Iyer](https://github.com/shankar-iyer)）。
* `disable_insertion_and_mutation` が有効な場合でも、リモートテーブルおよびデータレイクテーブルへの挿入が許可されるようになりました。 [#88549](https://github.com/ClickHouse/ClickHouse/pull/88549)（[Alexander Tokmakov](https://github.com/tavplubix)）。
* テーブルレベルの統計情報をキャッシュし、2 つの設定を追加しました: MergeTree の設定 `refresh_statistics_interval` とセッション設定 `use_statistics_cache`。 [#88670](https://github.com/ClickHouse/ClickHouse/pull/88670)（[Han Fei](https://github.com/hanfei1991)）。
* 変更処理中に索引をどのように扱うかを制御するための MergeTree 設定 `alter_column_secondary_index_mode` を追加しました。指定可能な値: throw、drop、rebuild、compatibility。 [#77797](https://github.com/ClickHouse/ClickHouse/issues/77797) をクローズしました。 [#89335](https://github.com/ClickHouse/ClickHouse/pull/89335)（[Raúl Marín](https://github.com/Algunenano)）。
* パーツ向けにテーブル単位の `ColumnsDescription` キャッシュを導入し、多数のパーツと多数のカラムを含むテーブルでのメモリ使用量を削減しました。 [#89352](https://github.com/ClickHouse/ClickHouse/pull/89352)（[Azat Khuzhin](https://github.com/azat)）。

### システムテーブルとモニタリング \{#system-tables-and-monitoring\}

* サーバーおよび Keeper 向けに、Keeper リクエストの実行ステージの所要時間を計測する複数のヒストグラムメトリクスを追加。[#88158](https://github.com/ClickHouse/ClickHouse/pull/88158) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* `system.columns` に新しいカラム統計を追加し、このテーブル上で構築されている統計の種類を示すようにしました。[#89086](https://github.com/ClickHouse/ClickHouse/pull/89086) ([Han Fei](https://github.com/hanfei1991)).
* HTTP インターフェイスは、クエリ結果キャッシュが使用されている場合に `Age` および `Expires` ヘッダーを返します。新しいプロファイルイベント `QueryCacheAgeSeconds`、`QueryCacheReadRows`、`QueryCacheReadBytes`、`QueryCacheWrittenRows`、`QueryCacheWrittenBytes` を導入。[#89759](https://github.com/ClickHouse/ClickHouse/pull/89759) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* Web UI にテーブルプロパティを表示。行数またはバイト数をクリックすると、`system.tables` からのクエリが表示されます。[#89771](https://github.com/ClickHouse/ClickHouse/pull/89771) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `system.error_log` テーブルに `last_error_time`、`last_error_message`、`last_error_query_id`、`last_error_trace` フィールドを追加。[#89879](https://github.com/ClickHouse/ClickHouse/pull/89879) ([Narasimha Pakeer](https://github.com/npakeer)).
* `system.part_logs` に重複排除ブロック ID を保存。[#89928](https://github.com/ClickHouse/ClickHouse/pull/89928) ([Sema Checherinda](https://github.com/CheSema)).
* `check_query_single_value_result` のデフォルト値を `true` から `false` に変更。これにより、`CHECK TABLE` は集約結果ではなく、パーツごとの詳細な結果を返すようになります。[#90150](https://github.com/ClickHouse/ClickHouse/pull/90150) ([Robert Schulze](https://github.com/rschu1ze)).
* 診断性向上のため、`system.mutations` に新しいカラム `parts_in_progress_names` を追加。[#90155](https://github.com/ClickHouse/ClickHouse/pull/90155) ([Shaohua Wang](https://github.com/tiandiwonder)).
* バックグラウンドジョブのインサイト取得を改善するため、`system.background_schedule_pool{,_log}` を導入。[#91157](https://github.com/ClickHouse/ClickHouse/pull/91157) ([Azat Khuzhin](https://github.com/azat)).
* プロファイルイベント `FailedInitialQuery` および `FailedInitialSelectQuery` を追加。[#91172](https://github.com/ClickHouse/ClickHouse/pull/91172) ([RinChanNOW](https://github.com/RinChanNOWWW)).
* ダングリングパーツのメトリクス用に、`system.tables` に 3 つのカラムを追加。[Han Fei](https://github.com/hanfei1991)).
* `distributed_cache_client.connection_pool_size` の値をメトリクスとして公開。[Francesco Ciocchetti](https://github.com/primeroz)).

### クライアントとUIの改善 \{#client-and-ui-improvements\}

* ページャー動作中でも、Ctrl+C を押すことでクエリをキャンセルできるようになりました。[#80778](https://github.com/ClickHouse/ClickHouse/issues/80778) を解決しました。[#88935](https://github.com/ClickHouse/ClickHouse/pull/88935) ([Grigorii Sokolik](https://github.com/GSokol))。
* Web UI のテーブルでは、値が負の場合でもバーが表示されるようになりました。[#89016](https://github.com/ClickHouse/ClickHouse/pull/89016) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 先頭が空白文字のクエリは履歴に保存されなくなりました。[#89116](https://github.com/ClickHouse/ClickHouse/pull/89116) ([Konstantin Bogdanov](https://github.com/thevar1able))。
* 対話モードの `clickhouse-client` および `clickhouse-local` では、カーソル下にある識別子と同じ名前を持つコマンドライン上の識別子がハイライト表示されるようになりました。[#89689](https://github.com/ClickHouse/ClickHouse/pull/89689) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* Web UI のクエリ入力用テキストエリアのリサイズハンドルが全幅になりました。[#89457](https://github.com/ClickHouse/ClickHouse/pull/89457) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* Web UI の型ヒントがテーブルヘッダーにはみ出さないようになりました。[#89753](https://github.com/ClickHouse/ClickHouse/pull/89753) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* Web UI のクエリエディタで、選択中の行を `Ctrl+/`（Mac では `Cmd+/`）で素早くコメントアウト／コメント解除できるようになりました。[#91160](https://github.com/ClickHouse/ClickHouse/pull/91160) ([Samuel K.](https://github.com/OpenGLShaders))。
* XDG Base Directory のパスから ClickHouse Client の設定を読み込めるようになりました。[#89882](https://github.com/ClickHouse/ClickHouse/issues/89882) を解決しました。[#90306](https://github.com/ClickHouse/ClickHouse/pull/90306) ([Wujun Jiang](https://github.com/rainac1))。

### S3 とクラウドストレージの改善 \{#s3-and-cloud-storage-improvements\}

* エンドポイントでリージョンが指定されていない場合に、S3 用のオプトインが必要な AWS リージョンを自動的に使用できるようにしました。[#88930](https://github.com/ClickHouse/ClickHouse/pull/88930) ([Andrey Zvonov](https://github.com/zvonand))。
* S3 の再パーティショニングが発生した場合でもバックアップが確実に成功するよう、25.6 ではデフォルトの `s3_retry_attempts` を 500 に設定しました。[#89051](https://github.com/ClickHouse/ClickHouse/pull/89051) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov))。
* STS エンドポイントとやり取りする S3 クレデンシャルをキャッシュし、異なる関数呼び出し間で再利用できるようにしました。[#89734](https://github.com/ClickHouse/ClickHouse/pull/89734) ([Antonio Andelic](https://github.com/antonio2368))。
* 事前署名付き URL が S3 で動作するようになりました。[#65032](https://github.com/ClickHouse/ClickHouse/issues/65032) をクローズしました。[#90827](https://github.com/ClickHouse/ClickHouse/pull/90827) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。

### データレイクの改善 \{#data-lakes-improvements\}

* `deltaLake` テーブル関数で、`delta_lake_snapshot_start_version`、`delta_lake_snapshot_end_version` 設定を用いた Delta Lake CDF の読み取りをサポート。[#90431](https://github.com/ClickHouse/ClickHouse/pull/90431)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* `SELECT` との一貫性のため、`INSERT INTO` テーブル関数でのストレージ設定をサポート。[#89386](https://github.com/ClickHouse/ClickHouse/issues/89386) をクローズ。[#91707](https://github.com/ClickHouse/ClickHouse/pull/91707)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* データレイクに対する `TRUNCATE` クエリについて、何もせずに黙って成功させるのではなく、「not implemented」エラーをスローするように変更。[#86604](https://github.com/ClickHouse/ClickHouse/issues/86604) をクローズ。[#91713](https://github.com/ClickHouse/ClickHouse/pull/91713)（[Kseniia Sumarokova](https://github.com/kssenii)）。

### Kafka の改善 \{#kafka-improvements\}

* `kafka_compression_codec` と `kafka_compression_level` 設定を使用して、Kafka プロデューサーの圧縮方式を指定できるようになりました。[#89073](https://github.com/ClickHouse/ClickHouse/pull/89073)（[János Benjamin Antal](https://github.com/antaljanosbenjamin)）。
* 調整可能な `Kafka` テーブルエンジンの設定として `kafka_consumer_reschedule_ms` を追加しました。[#89204](https://github.com/ClickHouse/ClickHouse/issues/89204) を解決します。[#90112](https://github.com/ClickHouse/ClickHouse/pull/90112)（[Jeremy Aguilon](https://github.com/JerAguilon)）。

### Keeper の改善 \{#keeper-improvements\}

* Keeper における append リクエストのバッチにバイトサイズの上限を追加しました。上限は `keeper_server.coordination_settings.max_requests_append_bytes_size` で制御されます。[#90342](https://github.com/ClickHouse/ClickHouse/pull/90342) ([Antonio Andelic](https://github.com/antonio2368))。
* ハンドシェイク中に keeper-server 側でのチェックを追加し、`last_zxid_seen (client によって提供される) > last_processed_zxid` の場合にクライアントを拒否するようにしました。[#90016](https://github.com/ClickHouse/ClickHouse/pull/90016) ([Miсhael Stetsyuk](https://github.com/mstetsyuk))。
* S3Queue のクリーンアップ時の RemoveRecursive Keeper リクエストに対して、より小さいノード数の上限を使用するようにしました。[#90201](https://github.com/ClickHouse/ClickHouse/pull/90201) ([Antonio Andelic](https://github.com/antonio2368))。

### 入出力フォーマットの改善 \{#input-output-format-improvements\}

* 論理型 UUID を持つ `FixedString(16)` で表現されている場合の Parquet における UUID サポートを追加しました。[#74484](https://github.com/ClickHouse/ClickHouse/pull/74484) ([alekseev-maksim](https://github.com/alekseev-maksim))。
* `hasAnyTokens` 関数および `hasAllTokens` 関数への入力として、文字列配列をサポートしました。[#89124](https://github.com/ClickHouse/ClickHouse/pull/89124) ([Elmi Ahmadov](https://github.com/ahmadov))。
* Pretty フォーマットで、名前付きタプルが Pretty JSON として表示されるようになりました。これにより [#65022](https://github.com/ClickHouse/ClickHouse/issues/65022) がクローズされました。[#91779](https://github.com/ClickHouse/ClickHouse/pull/91779) ([Mostafa Mohamed Salah](https://github.com/Sasao4o))。
* CapnProto メッセージサイズ上限を追加しました。`format_capn_proto_max_message_size` で変更できます。[#91888](https://github.com/ClickHouse/ClickHouse/pull/91888) ([Antonio Andelic](https://github.com/antonio2368))。

### テキスト索引の改善 \{#text-index-improvements\}

* テキスト索引が ReplacingMergeTree テーブルでも動作するようになりました。[#90908](https://github.com/ClickHouse/ClickHouse/pull/90908) ([Elmi Ahmadov](https://github.com/ahmadov)).
* `PREWHERE` で反転インデックスを使用できるようにしました。[#89975](https://github.com/ClickHouse/ClickHouse/issues/89975) を解決しました。[#89977](https://github.com/ClickHouse/ClickHouse/pull/89977) ([Peng Jian](https://github.com/fastio)).
* Ngrams tokenizer を `ngram_length = 1` でビルドできるようになりました。[#91529](https://github.com/ClickHouse/ClickHouse/pull/91529) ([George Larionov](https://github.com/george-larionov)).
* テキスト索引のデシリアライズ済みヘッダー用のキャッシュを導入し、I/O を削減してクエリ性能を向上させました。[#89513](https://github.com/ClickHouse/ClickHouse/pull/89513) ([Elmi Ahmadov](https://github.com/ahmadov)).

### その他の改善 \{#other-improvements\}

* サイズ制限を検証する際に、`max_binary_string_size` ではなく `max_binary_array_size` 設定を使うように、`Array` と `Map` のバイナリデシリアライズを修正しました。[#88744](https://github.com/ClickHouse/ClickHouse/pull/88744) ([Raufs Dunamalijevs](https://github.com/rienath)).
* システムメモリが 5GB 未満の場合は、デフォルトで実行ファイルを mlock しないようにしました。[#89751](https://github.com/ClickHouse/ClickHouse/pull/89751) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `system.metric_log` テーブルで、`min_bytes_for_wide_part` と `vertical_merge_algorithm_min_bytes_to_activate` を 128MB に設定することで、マージ時のメモリ使用量を削減しました。[#89811](https://github.com/ClickHouse/ClickHouse/pull/89811) ([filimonov](https://github.com/filimonov)).
* S3 ライブラリが XML レスポンスをパースする際に、ネットワークエラーをリトライするようにしました。[#90216](https://github.com/ClickHouse/ClickHouse/pull/90216) ([Sema Checherinda](https://github.com/CheSema)).
* ガードレールの制限値に近づいたときの警告メッセージを更新し、現在値と例外発生時の値を表示するようにしました。[#90438](https://github.com/ClickHouse/ClickHouse/pull/90438) ([Nikita Fomichev](https://github.com/fm4v)).
* `system.filesystem_cache` テーブルで、すべてのキャッシュ状態を 1 つの chunk にまとめるのではなく、chunk をストリーミングするようにしました。[#90508](https://github.com/ClickHouse/ClickHouse/pull/90508) ([Kseniia Sumarokova](https://github.com/kssenii)).
* ベクトル類似度索引キャッシュ内のエントリが、テーブルパーツが削除されたり新しいパーツに置き換えられたりしたときに削除されるようになりました。[#90750](https://github.com/ClickHouse/ClickHouse/pull/90750) ([Shankar Iyer](https://github.com/shankar-iyer)).
* 認証前に返される HTTP エラーレスポンスで ClickHouse サーバーバージョンを公開しないようにしました。[#91003](https://github.com/ClickHouse/ClickHouse/pull/91003) ([filimonov](https://github.com/filimonov)).
* `FINAL` 処理の後で行ポリシーと `PREWHERE` 条件を適用できるように、新しい設定 `apply_row_policy_after_final` と `apply_prewhere_after_final` を追加しました。[#90986](https://github.com/ClickHouse/ClickHouse/issues/90986) を修正しました。[#91065](https://github.com/ClickHouse/ClickHouse/pull/91065) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* tupleElement で JSON 型をサポートしました。[#81630](https://github.com/ClickHouse/ClickHouse/issues/81630) をクローズしました。[#91327](https://github.com/ClickHouse/ClickHouse/pull/91327) ([Pavel Kruglov](https://github.com/Avogar)).
* タプル要素アクセスで負のインデックス（例: tuple.-1）をサポートしました。[#91665](https://github.com/ClickHouse/ClickHouse/pull/91665) ([Amos Bird](https://github.com/amosbird)).
* `Array` から `QBit` へのキャスト時に暗黙の型変換を許可しました。[#91846](https://github.com/ClickHouse/ClickHouse/pull/91846) ([Raufs Dunamalijevs](https://github.com/rienath)).
* `system.blob_storage_log` に新しいカラム `elapsed_time_microseconds` を追加しました。[#92322](https://github.com/ClickHouse/ClickHouse/pull/92322) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* Shared データベースにおけるテーブル削除の遅延時間を制御できる新しい設定 `database_shared_drop_table_delay_seconds` を追加しました。([Nikolay Degterinsky](https://github.com/evillique)).
* 名前付きコレクション用の暗号化キーを遅延ロードするようにしました。([Pablo Marcos](https://github.com/pamarcos)).
* 分散キャッシュで、バッファー単位でクライアントキャッシュを無効化できるようにしました。([Kseniia Sumarokova](https://github.com/kssenii)).
* 分散キャッシュ接続に共通の上限値を追加しました。([Kseniia Sumarokova](https://github.com/kssenii)).

## バグ修正 \{#bug-fixes\}

:::note
このセクションでは、重要なバグ修正のうち主なもののみを取り上げています。このリリースにおけるすべてのバグ修正の一覧については、[完全な変更履歴](https://github.com/ClickHouse/ClickHouse/blob/master/CHANGELOG.md)を参照してください。
:::

### クエリ実行に関する修正 \{#query-execution-fixes\}

* 分散マージ集約で複数のリモート分片が関与する場合の `rows_before_limit_at_least` の不正な値を修正しました。[#63511](https://github.com/ClickHouse/ClickHouse/pull/63511) ([Amos Bird](https://github.com/amosbird)).
* `INSERT INTO ... SELECT` クエリの後に `0 rows in set` が表示される問題を修正しました。[#47800](https://github.com/ClickHouse/ClickHouse/issues/47800) をクローズ。 [#79462](https://github.com/ClickHouse/ClickHouse/pull/79462) ([Engel Danila](https://github.com/aaaengel)).
* 定数引数およびショートサーキット評価を伴う `multiIf` を修正しました。[#72714](https://github.com/ClickHouse/ClickHouse/issues/72714) をクローズ。 [#84546](https://github.com/ClickHouse/ClickHouse/pull/84546) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* サブクエリ制約を持つテーブルに対して SELECT を実行した際に発生する LogicalError を修正しました。[#84190](https://github.com/ClickHouse/ClickHouse/issues/84190) を解決。 [#85575](https://github.com/ClickHouse/ClickHouse/pull/85575) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* `query_plan_optimize_join_order_limit > 1` の場合の CROSS JOIN の並び替えにおける論理エラーを修正しました。[#89409](https://github.com/ClickHouse/ClickHouse/issues/89409) をクローズ。 [#88286](https://github.com/ClickHouse/ClickHouse/pull/88286) ([Vladimir Cherkasov](https://github.com/vdimir)).
* 右テーブルのキーがユニークな場合に OR 条件付きの JOIN で誤った結果になる問題を修正しました。[#89391](https://github.com/ClickHouse/ClickHouse/issues/89391) を解決。 [#89512](https://github.com/ClickHouse/ClickHouse/pull/89512) ([Vladimir Cherkasov](https://github.com/vdimir)).
* 重複カラムを伴う full_sorting_merge join における論理エラーを修正しました。[#86957](https://github.com/ClickHouse/ClickHouse/issues/86957) を解決。 [#89495](https://github.com/ClickHouse/ClickHouse/pull/89495) ([Vladimir Cherkasov](https://github.com/vdimir)).
* 重複カラムを伴う JOIN で発生しうる "Invalid number of rows in Chunk" エラーを修正しました。[#89411](https://github.com/ClickHouse/ClickHouse/issues/89411) を解決。 [#90053](https://github.com/ClickHouse/ClickHouse/pull/90053) ([Vladimir Cherkasov](https://github.com/vdimir)).
* parallel replicas 有効時、分散テーブルを用いた RIGHT JOIN で重複データが発生する問題を修正しました。[#90806](https://github.com/ClickHouse/ClickHouse/pull/90806) ([zoomxi](https://github.com/zoomxi)).
* `join_use_nulls` と複数の JOIN、さらに CROSS JOIN を組み合わせた場合の論理エラーを修正しました。[#91853](https://github.com/ClickHouse/ClickHouse/pull/91853) ([Vladimir Cherkasov](https://github.com/vdimir)).

### データ型と JSON の修正 \{#data-type-and-json-fixes\}

* 一部のケースにおいて、名前にドットを含むカラムからサブカラムを読み取る処理を修正しました。次の問題を解決します: [#81261](https://github.com/ClickHouse/ClickHouse/issues/81261)、[#82058](https://github.com/ClickHouse/ClickHouse/issues/82058)、[#88169](https://github.com/ClickHouse/ClickHouse/issues/88169)。[#87205](https://github.com/ClickHouse/ClickHouse/pull/87205)（[Pavel Kruglov](https://github.com/Avogar)）。
* JSON 内の Float と Bool が混在した配列の読み取りを修正しました。以前はそのようなデータを挿入すると例外が発生していました。[#88008](https://github.com/ClickHouse/ClickHouse/pull/88008)（[Pavel Kruglov](https://github.com/Avogar)）。
* `LowCardinality(Nullable(T))` から Dynamic へのキャストを修正しました。[#86365](https://github.com/ClickHouse/ClickHouse/pull/86365)（[Pavel Kruglov](https://github.com/Avogar)）。
* 高度な JSON 共有データのシリアル化処理において、パスおよびそのサブカラムの読み取り時に発生しうる論理エラーを修正しました。[#89805](https://github.com/ClickHouse/ClickHouse/issues/89805) をクローズしました。[#89819](https://github.com/ClickHouse/ClickHouse/pull/89819)（[Pavel Kruglov](https://github.com/Avogar)）。
* データ型のバイナリデシリアル化で発生しうるスタックオーバーフローを修正しました。[#88710](https://github.com/ClickHouse/ClickHouse/issues/88710) をクローズしました。[#89822](https://github.com/ClickHouse/ClickHouse/pull/89822)（[Pavel Kruglov](https://github.com/Avogar)）。
* JSON 内の共有データおよび動的パスの状態が不整合になりうる問題を修正しました。この問題は論理エラーや予期しない結果につながる可能性がありました。[#90816](https://github.com/ClickHouse/ClickHouse/pull/90816)（[Pavel Kruglov](https://github.com/Avogar)）。
* Summing/Aggregating/Coalescing MergeTree における JSON カラムのマージ処理を修正しました。[#91151](https://github.com/ClickHouse/ClickHouse/pull/91151)（[Pavel Kruglov](https://github.com/Avogar)）。

### MergeTree とストレージの修正 \{#mergetree-and-storage-fixes\}

* 有効期限 (TTL) によるカラムの早期削除が原因で発生していた複数の問題を修正しました。 [#88002](https://github.com/ClickHouse/ClickHouse/issues/88002) を解決します。 [#88860](https://github.com/ClickHouse/ClickHouse/pull/88860) ([Amos Bird](https://github.com/amosbird)).
* 主キーが逆順の場合に `min(PK)` / `max(PK)` の結果が誤っていた問題を修正しました。これは [#83619](https://github.com/ClickHouse/ClickHouse/issues/83619) を修正します。 [#88796](https://github.com/ClickHouse/ClickHouse/pull/88796) ([Amos Bird](https://github.com/amosbird)).
* 主キーが降順にソートされている場合に、`JOIN` 最適化で誤った分片処理が行われる問題を修正しました。 [#88512](https://github.com/ClickHouse/ClickHouse/issues/88512) を解決します。 [#88794](https://github.com/ClickHouse/ClickHouse/pull/88794) ([Amos Bird](https://github.com/amosbird)).
* PROJECTION の索引の読み取り経路におけるレースコンディションを修正しました。 [#89497](https://github.com/ClickHouse/ClickHouse/issues/89497) を解決します。 [#89762](https://github.com/ClickHouse/ClickHouse/pull/89762) ([Peng Jian](https://github.com/fastio)).
* `deduplicate_merge_projection_mode='ignore'` を使用している場合に、有効期限 (TTL) により空になったパーツと、非空の PROJECTION を含むパーツのマージ処理が誤っていた問題を修正しました。 [#89430](https://github.com/ClickHouse/ClickHouse/issues/89430) を解決します。 [#89458](https://github.com/ClickHouse/ClickHouse/pull/89458) ([Amos Bird](https://github.com/amosbird)).
* コンパクトなパーツに対して一部の `ALTER` クエリを実行した後に発生しうる `TOO_MANY_MARKS` エラーを修正しました。 [#91980](https://github.com/ClickHouse/ClickHouse/pull/91980) ([alesapin](https://github.com/alesapin)).

### Parquet およびフォーマットの修正 \{#parquet-and-format-fixes\}

* `input_format_parquet_local_file_min_bytes_for_seek` が 0 に設定されている場合に Parquet リーダーで発生していたセグメンテーションフォルトを修正しました。[#78456](https://github.com/ClickHouse/ClickHouse/issues/78456) を解決。[#88784](https://github.com/ClickHouse/ClickHouse/pull/88784) ([Animesh](https://github.com/anibilthare))。
* Parquet writer において、`created_by` 文字列を正しいフォーマットで出力するようにしました。[#87735](https://github.com/ClickHouse/ClickHouse/pull/87735) ([Michael Kolupaev](https://github.com/al13n321))。
* ネイティブ writer を用いた単一スレッド書き込み時に、Parquet 書き込みで元の順序が保持されない問題を修正しました。[#90126](https://github.com/ClickHouse/ClickHouse/pull/90126) ([Arthur Passos](https://github.com/arthurpassos))。
* DICTIONARY_V2 でエンコードされ、NULL 値のみを含む文字列カラムを読み込む際の ORC リーダーのバグを修正しました。[#91889](https://github.com/ClickHouse/ClickHouse/pull/91889) ([Peng Jian](https://github.com/fastio))。
* ORC フォーマットから Date および DateTime64 型を読み込む際に発生していたオーバーフローを修正しました。[#70976](https://github.com/ClickHouse/ClickHouse/issues/70976) をクローズ。[#91572](https://github.com/ClickHouse/ClickHouse/pull/91572) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。

### Iceberg とデータレイクの修正 \{#iceberg-and-data-lake-fixes\}

* `icebergS3Cluster` プロトコルを修正し、`iceberg` クラスタ関数でスキーマ進化、位置削除および等価削除をサポートするようになりました。[#88287](https://github.com/ClickHouse/ClickHouse/issues/88287) を解決しました。[#88919](https://github.com/ClickHouse/ClickHouse/pull/88919)（[Yang Jiang](https://github.com/Ted-Jiang)）。
* glue カタログを使用している場合に、timestamp カラムを含む iceberg テーブルで発生する JSON の例外を修正しました。[#90210](https://github.com/ClickHouse/ClickHouse/issues/90210) を解決しました。[#90209](https://github.com/ClickHouse/ClickHouse/pull/90209)（[Alsu Giliazova](https://github.com/alsugiliazova)）。
* manifest ファイルでソート順が指定されていない場合、ClickHouse が iceberg に対して read-in-order 最適化を使用しないようになりました。[#89178](https://github.com/ClickHouse/ClickHouse/issues/89178) を修正しました。[#90304](https://github.com/ClickHouse/ClickHouse/pull/90304)（[alesapin](https://github.com/alesapin)）。

### 関数の修正 \{#function-fixes\}

* 関数 `reverseUTF8` のバグを修正しました。以前のバージョンでは、長さ 4 の UTF-8 コードポイントのバイト列を誤って反転していました。これにより [#88913](https://github.com/ClickHouse/ClickHouse/issues/88913) がクローズされました。 [#88914](https://github.com/ClickHouse/ClickHouse/pull/88914) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* `cramersV`、`cramersVBiasCorrected`、`theilsU`、`contingency` において誤った結果を引き起こしていた φ二乗の計算を修正しました。 [#87831](https://github.com/ClickHouse/ClickHouse/pull/87831) ([Nihal Z. Miaji](https://github.com/nihalzp))。
* `top_k` が単一引数で呼び出された際に、しきい値（threshold）パラメータを正しく考慮するよう修正しました。これにより [#88757](https://github.com/ClickHouse/ClickHouse/issues/88757) がクローズされました。 [#88867](https://github.com/ClickHouse/ClickHouse/pull/88867) ([Manuel](https://github.com/raimannma))。
* `countIf(*)` の引数が切り捨てられる問題を修正しました。これにより [#89372](https://github.com/ClickHouse/ClickHouse/issues/89372) がクローズされました。 [#89373](https://github.com/ClickHouse/ClickHouse/pull/89373) ([Manuel](https://github.com/raimannma))。
* `trim`、`ltrim`、`rtrim` 関数が 2 つの引数で動作しない問題を修正しました。これにより [#90170](https://github.com/ClickHouse/ClickHouse/issues/90170) がクローズされました。 [#90305](https://github.com/ClickHouse/ClickHouse/pull/90305) ([Nihal Z. Miaji](https://github.com/nihalzp))。
* 空配列と `isNull` 関数を併用した場合に `arrayFilter` 関数が動作しない問題を修正しました。これにより [#73849](https://github.com/ClickHouse/ClickHouse/issues/73849) がクローズされました。 [#91105](https://github.com/ClickHouse/ClickHouse/pull/91105) ([Nihal Z. Miaji](https://github.com/nihalzp))。

### メモリおよびクラッシュの修正 \{#memory-and-crash-fixes\}

* `IN` 内での `ARRAY JOIN` を含むリモートクエリ実行時、`enable_lazy_columns_replication` 設定有効時に発生しうるクラッシュを修正しました。[#90361](https://github.com/ClickHouse/ClickHouse/issues/90361)。[#89997](https://github.com/ClickHouse/ClickHouse/pull/89997)（[Pavel Kruglov](https://github.com/Avogar)）。
* 誤った破棄順序が原因で、サーバーのクリーンシャットダウン中に発生していたクラッシュを修正しました。[#82420](https://github.com/ClickHouse/ClickHouse/issues/82420)。[#90076](https://github.com/ClickHouse/ClickHouse/pull/90076)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* 集約関数の状態に LowCardinality(String) のカラムのシリアライズされた値が含まれている場合に発生するクラッシュを修正しました。[#89550](https://github.com/ClickHouse/ClickHouse/pull/89550)（[Pavel Kruglov](https://github.com/Avogar)）。
* 不正な形式の分片ディレクトリ名を解析する際に StorageDistributed で発生するクラッシュを修正しました。[#90243](https://github.com/ClickHouse/ClickHouse/pull/90243)（[Aleksandr Musorin](https://github.com/AVMusorin)）。
* userspace page cache が有効な場合に発生していた誤ったメモリ制限エラーを修正しました。[#91361](https://github.com/ClickHouse/ClickHouse/pull/91361)（[Michael Kolupaev](https://github.com/al13n321)）。
* `MEMORY_LIMIT_EXCEEDED` の後に集約関数で発生しうるクラッシュを修正しました。[#92390](https://github.com/ClickHouse/ClickHouse/pull/92390)（[Azat Khuzhin](https://github.com/azat)）。
* ハッシュ結合の結果生成におけるメモリ使用量のトラッキングを改善しました。[#89560](https://github.com/ClickHouse/ClickHouse/pull/89560)（[Azat Khuzhin](https://github.com/azat)）。

### セキュリティとアクセスに関する修正 \{#security-and-access-fixes\}

* 存在しないロールを持つユーザーから clusterAllReplicas を実行しようとした際に発生する `ACCESS_ENTITY_NOT_FOUND` エラーを修正。[#87670](https://github.com/ClickHouse/ClickHouse/issues/87670) を解決。[#89068](https://github.com/ClickHouse/ClickHouse/pull/89068)（[pufit](https://github.com/pufit)）。
* 対象ホストとして `localhost` を指定した `remote` テーブル関数が使用される場合の `ALTER UPDATE` クエリに対するアクセス権検証を修正。[#90761](https://github.com/ClickHouse/ClickHouse/pull/90761)（[pufit](https://github.com/pufit)）。
* 部分的な revoke に対するワイルドカード grant のチェックを修正。[#90922](https://github.com/ClickHouse/ClickHouse/pull/90922)（[pufit](https://github.com/pufit)）。
* ワイルドカード revoke と組み合わせたグローバル grant の処理を修正。[#90928](https://github.com/ClickHouse/ClickHouse/pull/90928)（[pufit](https://github.com/pufit)）。

### Replicated データベースの修正 \{#replicated-database-fixes\}

* リカバリ後に、Replicated データベースのレプリカが長時間にわたって `Failed to marked query-0004647339 as finished` のようなメッセージを出力し続けて進まなくなることがありましたが、修正されました。 [#88671](https://github.com/ClickHouse/ClickHouse/pull/88671) ([Alexander Tokmakov](https://github.com/tavplubix))。
* シャットダウン処理とバックグラウンドの `INSERT` の競合状態により Distributed で発生していた use-after-free を修正しました。[#88640](https://github.com/ClickHouse/ClickHouse/issues/88640) を解決します。 [#89136](https://github.com/ClickHouse/ClickHouse/pull/89136) ([Azat Khuzhin](https://github.com/azat))。
* リフレッシャブルmaterialized view：リフレッシュ中にソーステーブルが完全に DROP された場合にまれに発生していたサーバークラッシュを修正しました。 [#89203](https://github.com/ClickHouse/ClickHouse/pull/89203) ([Michael Kolupaev](https://github.com/al13n321))。

### Keeper の修正 \{#keeper-fixes\}

* ローテーション時に `changelog` が正しくリネームされなかった場合に、Keeper の起動時における `changelog` の読み取り処理が失敗していた問題を修正。[#89496](https://github.com/ClickHouse/ClickHouse/pull/89496) ([Antonio Andelic](https://github.com/antonio2368)).

### その他の主な修正 \{#other-notable-fixes\}

* スキップ索引を解析する際のパフォーマンス低下を修正しました。 [#89004](https://github.com/ClickHouse/ClickHouse/pull/89004) ([Anton Popov](https://github.com/CurtizJ)).
* 25.8 へのスムーズなアップグレードを妨げていた Hive パーティショニングの非互換性を修正しました。 [#90202](https://github.com/ClickHouse/ClickHouse/pull/90202) ([Kseniia Sumarokova](https://github.com/kssenii)).
* `nan`/`inf` により無限に続いていた `WITH FILL` クエリを修正しました。 [#69261](https://github.com/ClickHouse/ClickHouse/issues/69261) を解決しました。 [#90255](https://github.com/ClickHouse/ClickHouse/pull/90255)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* Time および Time64 は、DateTime および DateTime64 からの変換時にタイムゾーンを正しく考慮するようになりました。[#89896](https://github.com/ClickHouse/ClickHouse/issues/89896) をクローズしました。[#90310](https://github.com/ClickHouse/ClickHouse/pull/90310)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* `SELECT` クエリでクエリ条件キャッシュが有効な場合に、論理更新後に誤ったクエリ結果が返される可能性があった問題を修正しました（[#90176](https://github.com/ClickHouse/ClickHouse/issues/90176)）。 [#90204](https://github.com/ClickHouse/ClickHouse/pull/90204)（[Anton Popov](https://github.com/CurtizJ)）。
* インメモリでの String 集約状態のシリアライズ互換性を修正。 [#90880](https://github.com/ClickHouse/ClickHouse/pull/90880) ([Antonio Andelic](https://github.com/antonio2368)).
* `Nested` かつ `LowCardinality` なカラムに対する `SummingMergeTree` の集約を修正しました。 [#90927](https://github.com/ClickHouse/ClickHouse/pull/90927) ([Ivan Babrou](https://github.com/bobrik))。
* `system.view_refreshes` が `No macro 'replica' in config` エラーで失敗する問題を修正しました。 [#92203](https://github.com/ClickHouse/ClickHouse/pull/92203) ([Michael Kolupaev](https://github.com/al13n321)).
* Shared Catalog を使用する MV に対して、カラムを間接的に追加する `ALTER` クエリのレプリケーションを修正しました。 ([Nikolay Degterinsky](https://github.com/evillique)).
* 失敗した MV コミットによって Shared Catalog の状態適用処理がハングする不具合を修正しました。 ([Nikolay Degterinsky](https://github.com/evillique))
* Shared Catalog を使用するセカンダリレプリカ上での `ALTER` における設定制約のチェックを修正しました。([Nikolay Degterinsky](https://github.com/evillique))
* SharedCatalog へのマイグレーション時にデータベースコメントが保持されるようになりました。 ([Alexander Tokmakov](https://github.com/tavplubix)).
* Shared Catalog でセカンダリーレプリカ上の materialized view が置き換えられてしまう問題を修正しました。 ([Nikolay Degterinsky](https://github.com/evillique))
* system.distributed&#95;cache&#95;usage カウンターを修正しました。([Kseniia Sumarokova](https://github.com/kssenii))。
* Shared Catalog で `ILLEGAL_COLUMN` 例外により CREATE に失敗したテーブルに対し、DROP が進行しなくなる問題を修正しました。（[Nikolay Degterinsky](https://github.com/evillique)）
* Replicated データベースにおいて、SharedSet/SharedJoin での `CREATE OR REPLACE` を無効化しました。([Tuan Pham Anh](https://github.com/tuanpach))
* 共有データベースでの RMV リフレッシュ時に発生する `UNFINISHED` 例外を修正。([Nikolay Degterinsky](https://github.com/evillique))。
* Shared データベースで `TABLE_ALREADY_EXISTS` エラーにより発生していたクラッシュを修正しました。 ([Nikolay Degterinsky](https://github.com/evillique)).
* Shared Catalog 内で不正な CREATE クエリを持つテーブルのマイグレーションを修正しました。 ([Nikolay Degterinsky](https://github.com/evillique))。
* `getStatus` で常にメモリ上の仮想パーツを使用するようにしました。([Mikhail Artemenko](https://github.com/Michicosun))。
* 起動時に Shared catalog state アプリケーションにリトライ機能を追加しました。 ([Nikolay Degterinsky](https://github.com/evillique)).
* テーブル作成中に例外が発生した後、`DROP DATABASE` がハングしたままになる問題を修正しました。（[Nikolay Degterinsky](https://github.com/evillique)）
* 分散キャッシュのロジックエラーを修正しました。 ([Kseniia Sumarokova](https://github.com/kssenii)).
* 分散キャッシュで誤ったエラーが発生する問題を修正しました。([Kseniia Sumarokova](https://github.com/kssenii))
* Shared Catalog の ~TemporaryLockForUUIDDirectory で発生する `LOGICAL_ERROR` を修正。([Nikolay Degterinsky](https://github.com/evillique))。
* データベース名の変更後にメタデータキャッシュが誤った依存関係を返してしまう問題を修正しました。 ([Nikolay Degterinsky](https://github.com/evillique)).
* Shared Catalog: セカンダリーレプリカ上で大きなテーブルを `DROP` する際に発生していた問題を修正しました。 ([Raúl Marín](https://github.com/Algunenano)).
* Distributed cache：`processWriteRequest` の論理エラーを修正。([Kseniia Sumarokova](https://github.com/kssenii))。
* セカンダリのレプリカ上での MV の `ALTER` 操作に対するチェックを削除しました。([Nikolay Degterinsky](https://github.com/evillique)).