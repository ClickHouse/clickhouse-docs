---
slug: /whats-new/changelog/24.2-fast-release
title: "v24.2 変更履歴"
description: "v24.2のファストリリース変更履歴"
keywords: ["変更履歴"]
sidebar_label: "24.2"
sidebar_position: 9
doc_type: "changelog"
---

### ClickHouseリリースタグ: 24.2.2.15987 {#clickhouse-release-tag-242215987}


#### 後方互換性のない変更 {#backward-incompatible-change}

- ネストされた型内の疑わしい/実験的な型を検証します。以前は、Array/Tuple/Mapのようなネストされた型内でこのような型(JSONを除く)を検証していませんでした。[#59385](https://github.com/ClickHouse/ClickHouse/pull/59385) ([Kruglov Pavel](https://github.com/Avogar))。
- ソート句`ORDER BY ALL`(v23.12で導入)は`ORDER BY *`に置き換えられました。以前の構文は、`all`という名前のカラムを持つテーブルに対してエラーが発生しやすいものでした。[#59450](https://github.com/ClickHouse/ClickHouse/pull/59450) ([Robert Schulze](https://github.com/rschu1ze))。
- スレッド数とブロックサイズの妥当性チェックを追加しました。[#60138](https://github.com/ClickHouse/ClickHouse/pull/60138) ([Raúl Marín](https://github.com/Algunenano))。
- クエリレベルの設定`async_insert`と`deduplicate_blocks_in_dependent_materialized_views`が同時に有効になっている場合、受信したINSERTクエリを拒否します。この動作は設定`throw_if_deduplication_in_dependent_materialized_views_enabled_with_async_insert`によって制御され、デフォルトで有効になっています。これはhttps://github.com/ClickHouse/ClickHouse/pull/59915のブロックを解除するために必要なhttps://github.com/ClickHouse/ClickHouse/pull/59699の続きです。[#60888](https://github.com/ClickHouse/ClickHouse/pull/60888) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov))。
- ユーティリティ`clickhouse-copier`はGitHub上の別リポジトリに移動されました: https://github.com/ClickHouse/copier。バンドルには含まれなくなりましたが、個別のダウンロードとして引き続き利用可能です。これにより以下が解決されます: [#60734](https://github.com/ClickHouse/ClickHouse/issues/60734) [#60540](https://github.com/ClickHouse/ClickHouse/issues/60540) [#60250](https://github.com/ClickHouse/ClickHouse/issues/60250) [#52917](https://github.com/ClickHouse/ClickHouse/issues/52917) [#51140](https://github.com/ClickHouse/ClickHouse/issues/51140) [#47517](https://github.com/ClickHouse/ClickHouse/issues/47517) [#47189](https://github.com/ClickHouse/ClickHouse/issues/47189) [#46598](https://github.com/ClickHouse/ClickHouse/issues/46598) [#40257](https://github.com/ClickHouse/ClickHouse/issues/40257) [#36504](https://github.com/ClickHouse/ClickHouse/issues/36504) [#35485](https://github.com/ClickHouse/ClickHouse/issues/35485) [#33702](https://github.com/ClickHouse/ClickHouse/issues/33702) [#26702](https://github.com/ClickHouse/ClickHouse/issues/26702) ### ユーザー向け変更のドキュメントエントリ。[#61058](https://github.com/ClickHouse/ClickHouse/pull/61058) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov))。
- MySQLとの互換性を高めるため、関数`locate`はデフォルトで引数`(needle, haystack[, start_pos])`を受け入れるようになりました。以前の動作`(haystack, needle, [, start_pos])`は、設定`function_locate_has_mysql_compatible_argument_order = 0`により復元できます。[#61092](https://github.com/ClickHouse/ClickHouse/pull/61092) ([Robert Schulze](https://github.com/rschu1ze))。
- 廃止されたインメモリデータパートはバージョン23.5以降非推奨となり、バージョン23.10以降サポートされていません。現在、残りのコードが削除されました。[#55186](https://github.com/ClickHouse/ClickHouse/issues/55186)および[#45409](https://github.com/ClickHouse/ClickHouse/issues/45409)の続きです。インメモリデータパートを使用していた可能性は低いです。なぜなら、これらはバージョン23.5以前でのみ利用可能であり、MergeTreeテーブルに対応するSETTINGSを指定して手動で有効にした場合のみ使用できたためです。インメモリデータパートがあるかどうかを確認するには、次のクエリを実行してください: `SELECT part_type, count() FROM system.parts GROUP BY part_type ORDER BY part_type`。インメモリデータパートの使用を無効にするには、`ALTER TABLE ... MODIFY SETTING min_bytes_for_compact_part = DEFAULT, min_rows_for_compact_part = DEFAULT`を実行してください。古いClickHouseリリースからアップグレードする前に、まずインメモリデータパートがないことを確認してください。インメモリデータパートが存在する場合は、まずそれらを無効にし、インメモリデータパートがなくなるまで待ってからアップグレードを続行してください。[#61127](https://github.com/ClickHouse/ClickHouse/pull/61127) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
- `MergeTree`テーブルの`ORDER BY`での`SimpleAggregateFunction`の使用をデフォルトで禁止しました(`AggregateFunction`が禁止されているのと同様ですが、比較可能でないため禁止されています)(許可するには`allow_suspicious_primary_key`を使用してください)。[#61399](https://github.com/ClickHouse/ClickHouse/pull/61399) ([Azat Khuzhin](https://github.com/azat))。
- ClickHouseはString型で任意のバイナリデータを許可しており、通常はUTF-8です。Parquet/ORC/ArrowのStringはUTF-8のみをサポートしています。そのため、ClickHouseのString型に対してどのArrowのデータ型を使用するか(StringまたはBinary)を選択できます。これは設定`output_format_parquet_string_as_string`、`output_format_orc_string_as_string`、`output_format_arrow_string_as_string`によって制御されます。Binaryの方がより正確で互換性がありますが、デフォルトでStringを使用することは、ほとんどの場合ユーザーの期待に沿うものです。Parquet/ORC/Arrowは、lz4やzstdを含む多くの圧縮方式をサポートしています。ClickHouseはすべての圧縮方式をサポートしています。一部の劣ったツールは、より高速な`lz4`圧縮方式のサポートを欠いているため、デフォルトで`zstd`を設定しています。これは設定`output_format_parquet_compression_method`、`output_format_orc_compression_method`、`output_format_arrow_compression_method`によって制御されます。ParquetとORCのデフォルトを`zstd`に変更しましたが、Arrow(低レベルの使用を重視)は変更していません。[#61817](https://github.com/ClickHouse/ClickHouse/pull/61817) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
- マテリアライズドビューのセキュリティ問題の修正。この問題により、ユーザーは必要な権限なしにテーブルへの挿入が可能でした。修正により、ユーザーがマテリアライズドビューだけでなく、すべての基礎となるテーブルへの挿入権限を持っていることが検証されます。これは、以前は動作していた一部のクエリが、権限不足で失敗する可能性があることを意味します。この問題に対処するため、このリリースではビューのSQL securityという新機能が導入されています[https://clickhouse.com/docs/sql-reference/statements/create/view#sql_security](/sql-reference/statements/create/view#sql_security)。[#54901](https://github.com/ClickHouse/ClickHouse/pull/54901) ([pufit](https://github.com/pufit))





#### 新機能 {#new-feature}

- 値のカウントとそのエラーを返すTopk/topkweighedのサポートモード。[#54508](https://github.com/ClickHouse/ClickHouse/pull/54508) ([UnamedRus](https://github.com/UnamedRus))。
- ビュー/マテリアライズドビューで定義者ユーザーを指定できる新しい構文を追加しました。これにより、基礎となるテーブルへの明示的な権限なしでビューからのselect/insertを実行できます。[#54901](https://github.com/ClickHouse/ClickHouse/pull/54901) ([pufit](https://github.com/pufit))。
- 異なる種類のMergeTreeテーブルをレプリケーテッドエンジンに自動変換する機能を実装しました。テーブルのデータディレクトリ(`/clickhouse/store/xxx/xxxyyyyy-yyyy-yyyy-yyyy-yyyyyyyyyyyy/`)に空の`convert_to_replicated`ファイルを作成すると、次回のサーバー起動時にそのテーブルが自動的に変換されます。[#57798](https://github.com/ClickHouse/ClickHouse/pull/57798) ([Kirill](https://github.com/kirillgarbar))。
- テーブル関数`mergeTreeIndex`を追加しました。これは`MergeTree`テーブルのインデックスとマークファイルの内容を表します。イントロスペクションに使用できます。構文: `mergeTreeIndex(database, table, [with_marks = true])` ここで`database.table`は`MergeTree`エンジンを持つ既存のテーブルです。[#58140](https://github.com/ClickHouse/ClickHouse/pull/58140) ([Anton Popov](https://github.com/CurtizJ))。
- `file/s3/hdfs/url/azureBlobStorage`エンジンでファイル形式が不明な場合、スキーマ推論中に自動的にファイル形式を検出するようにしました。Closes [#50576](https://github.com/ClickHouse/ClickHouse/issues/50576)。[#59092](https://github.com/ClickHouse/ClickHouse/pull/59092) ([Kruglov Pavel](https://github.com/Avogar))。
- テーブル関数としてgenerate_seriesを追加しました。この関数は自然数の等差数列を持つテーブルを生成します。[#59390](https://github.com/ClickHouse/ClickHouse/pull/59390) ([divanik](https://github.com/divanik))。
- 空のパーティションに関連するZooKeeperノードを削除する`ALTER TABLE table FORGET PARTITION partition`クエリを追加しました。[#59507](https://github.com/ClickHouse/ClickHouse/pull/59507) ([Sergei Trifonov](https://github.com/serxa))。
- tarアーカイブとしてのバックアップの読み書きをサポートしました。[#59535](https://github.com/ClickHouse/ClickHouse/pull/59535) ([josh-hildred](https://github.com/josh-hildred))。
- 新しい集約関数'groupArrayIntersect'を提供します。フォローアップ: [#49862](https://github.com/ClickHouse/ClickHouse/issues/49862)。[#59598](https://github.com/ClickHouse/ClickHouse/pull/59598) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。
- DNS問題のデバッグに役立つsystem.dns_cacheテーブルを実装しました。[#59856](https://github.com/ClickHouse/ClickHouse/pull/59856) ([Kirill Nikiforov](https://github.com/allmazz))。
- S3Expressバケットのサポートを実装しました。[#59965](https://github.com/ClickHouse/ClickHouse/pull/59965) ([Nikita Taranov](https://github.com/nickitat))。
- コーデック`LZ4HC`は新しいレベル2を受け入れるようになりました。これは以前の最小レベル3よりも高速ですが、圧縮率は低下します。以前のバージョンでは、`LZ4HC(2)`以下は`LZ4HC(3)`と同じでした。作成者: [Cyan4973](https://github.com/Cyan4973)。[#60090](https://github.com/ClickHouse/ClickHouse/pull/60090) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
- DNS問題のデバッグに役立つsystem.dns_cacheテーブルを実装しました。新しいサーバー設定dns_cache_max_size。[#60257](https://github.com/ClickHouse/ClickHouse/pull/60257) ([Kirill Nikiforov](https://github.com/allmazz))。
- `DateTime`または`DateTime64`型の値のミリ秒成分を返す関数`toMillisecond`を追加しました。[#60281](https://github.com/ClickHouse/ClickHouse/pull/60281) ([Shaun Struwig](https://github.com/Blargian))。
- mergeテーブル関数の単一引数バージョン`merge(['db_name', ] 'tables_regexp')`をサポートしました。[#60372](https://github.com/ClickHouse/ClickHouse/pull/60372) ([豪肥肥](https://github.com/HowePa))。
- Tsv、TSV、tsv、さらにはrowbinaryのように、すべてのフォーマット名を大文字小文字を区別しないようにしました。[#60420](https://github.com/ClickHouse/ClickHouse/pull/60420) ([豪肥肥](https://github.com/HowePa))。
- ビュー/マテリアライズドビューで定義者ユーザーを指定できる新しい構文を追加しました。これにより、基礎となるテーブルへの明示的な権限なしでビューからのselect/insertを実行できます。[#60439](https://github.com/ClickHouse/ClickHouse/pull/60439) ([pufit](https://github.com/pufit))。
- `StorageMemory`(memoryエンジン)に4つのプロパティ`min_bytes_to_keep, max_bytes_to_keep, min_rows_to_keep`および`max_rows_to_keep`を追加 - 新しい変更を反映するテストを追加 - `memory.md`ドキュメントを更新 - テーブルパラメータの境界へのアクセスを可能にするため、`MemorySink`にテーブル`context`プロパティを追加。[#60612](https://github.com/ClickHouse/ClickHouse/pull/60612) ([Jake Bamrah](https://github.com/JakeBamrah))。
- `DateTime`または`DateTime64`型の値のミリ秒成分を返す関数`toMillisecond`を追加しました。[#60649](https://github.com/ClickHouse/ClickHouse/pull/60649) ([Robert Schulze](https://github.com/rschu1ze))。
- 待機中のクエリと実行中のクエリの数に対する個別の制限。`async_load_databases`により待機しているクエリの数を制限する新しいサーバー設定`max_waiting_queries`を追加しました。実行中のクエリ数に対する既存の制限は、待機中のクエリをカウントしなくなりました。[#61053](https://github.com/ClickHouse/ClickHouse/pull/61053) ([Sergei Trifonov](https://github.com/serxa))。
- `ATTACH PARTITION ALL`のサポートを追加しました。[#61107](https://github.com/ClickHouse/ClickHouse/pull/61107) ([Kirill Nikiforov](https://github.com/allmazz))。





#### パフォーマンス改善 {#performance-improvement}

- SELECT句内のGROUP BYキーに対するmin/max/any/anyLast集約関数を除去します。[#52230](https://github.com/ClickHouse/ClickHouse/pull/52230) ([JackyWoo](https://github.com/JackyWoo))。
- 複数の[nullable]カラムを含む場合のシリアライズ集約メソッドのパフォーマンスを改善します。これは抽象化の整合性を損なわない[#51399](https://github.com/ClickHouse/ClickHouse/issues/51399)の汎用版です。[#55809](https://github.com/ClickHouse/ClickHouse/pull/55809) ([Amos Bird](https://github.com/amosbird))。
- ALL結合のパフォーマンスを改善するため、結合出力を遅延構築します。[#58278](https://github.com/ClickHouse/ClickHouse/pull/58278) ([LiuNeng](https://github.com/liuneng1994))。
- 集約関数ArgMin / ArgMax / any / anyLast / anyHeavy、および`ORDER BY {u8/u16/u32/u64/i8/i16/u32/i64) LIMIT 1`クエリの改善。[#58640](https://github.com/ClickHouse/ClickHouse/pull/58640) ([Raúl Marín](https://github.com/Algunenano))。
- 分岐ミスを削減することで、bigintおよびbig decimal型に対する条件付きsum/avgのパフォーマンスを最適化します。[#59504](https://github.com/ClickHouse/ClickHouse/pull/59504) ([李扬](https://github.com/taiyang-li))。
- アクティブなミューテーションを伴うSELECTのパフォーマンスを改善します。[#59531](https://github.com/ClickHouse/ClickHouse/pull/59531) ([Azat Khuzhin](https://github.com/azat))。
- カラムフィルタの軽微な最適化。基礎となるデータ型が数値でないフィルタカラムが`result_size_hint = -1`でフィルタリングされることを回避します。場合によってはピークメモリを元の44%まで削減できます。[#59698](https://github.com/ClickHouse/ClickHouse/pull/59698) ([李扬](https://github.com/taiyang-li))。
- プライマリキーが使用するメモリ量を削減します。[#60049](https://github.com/ClickHouse/ClickHouse/pull/60049) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
- プライマリキーおよびその他の操作のメモリ使用量を改善します。[#60050](https://github.com/ClickHouse/ClickHouse/pull/60050) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
- テーブルのプライマリキーは、最初のアクセス時にメモリへ遅延ロードされます。これは新しいMergeTree設定`primary_key_lazy_load`によって制御され、デフォルトで有効です。これにはいくつかの利点があります：- 使用されないテーブルではロードされません；- メモリが不足している場合、サーバー起動時ではなく最初の使用時に例外がスローされます。これにはいくつかの欠点があります：- プライマリキーのロードレイテンシは、接続を受け入れる前ではなく最初のクエリ時に発生します；これは理論的にサンダリングハード問題を引き起こす可能性があります。これは[#11188](https://github.com/ClickHouse/ClickHouse/issues/11188)を解決します。[#60093](https://github.com/ClickHouse/ClickHouse/pull/60093) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
- ベクトル検索に有用なベクトル化関数`dotProduct`。[#60202](https://github.com/ClickHouse/ClickHouse/pull/60202) ([Robert Schulze](https://github.com/rschu1ze))。
- テーブルのプライマリキーにほとんど無用なカラムが含まれている場合、それらをメモリに保持しません。これは新しい設定`primary_key_ratio_of_unique_prefix_values_to_skip_suffix_columns`によって制御され、デフォルト値は`0.9`です。これは次のことを意味します：複合プライマリキーの場合、あるカラムが全体の少なくとも0.9の割合で値を変更する場合、その後のカラムはロードされません。[#60255](https://github.com/ClickHouse/ClickHouse/pull/60255) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
- result_typeの基礎となる型が数値の場合、multiIf関数をカラム単位で実行します。[#60384](https://github.com/ClickHouse/ClickHouse/pull/60384) ([李扬](https://github.com/taiyang-li))。
- 図1に示すように、"&&"を"&"に置き換えることでSIMDコードを生成できます。![image](https://github.com/ClickHouse/ClickHouse/assets/26588299/a5a72ac4-6dc6-4d52-835a-4f512e55f0b9) 図1. '&&'（左）と'&'（右）からコンパイルされたコード。[#60498](https://github.com/ClickHouse/ClickHouse/pull/60498) ([Zhiguo Zhou](https://github.com/ZhiguoZh))。
- より高速な（ほぼ2倍）ミューテックス（ThreadFuzzerにより遅くなっていました）。[#60823](https://github.com/ClickHouse/ClickHouse/pull/60823) ([Azat Khuzhin](https://github.com/azat))。
- 接続のドレインをprepareからworkに移動し、複数の接続を並列にドレインします。[#60845](https://github.com/ClickHouse/ClickHouse/pull/60845) ([lizhuoyu5](https://github.com/lzydmxy))。
- nullable numberまたはnullable stringのinsertManyFromを最適化します。[#60846](https://github.com/ClickHouse/ClickHouse/pull/60846) ([李扬](https://github.com/taiyang-li))。
- 不要で高コストなメモリコピーを省略するよう関数`dotProduct`を最適化しました。[#60928](https://github.com/ClickHouse/ClickHouse/pull/60928) ([Robert Schulze](https://github.com/rschu1ze))。
- ファイルシステムキャッシュの操作がロック競合の影響を受けにくくなります。[#61066](https://github.com/ClickHouse/ClickHouse/pull/61066) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
- ColumnString::replicateを最適化し、memcpySmallAllowReadWriteOverflow15Implが組み込みmemcpyに最適化されることを防ぎます。[#61074](https://github.com/ClickHouse/ClickHouse/issues/61074)を解決します。ColumnString::replicateはx86-64上で2.46倍高速化されます。[#61075](https://github.com/ClickHouse/ClickHouse/pull/61075) ([李扬](https://github.com/taiyang-li))。
- 256ビット整数の出力が30倍高速化されます。[#61100](https://github.com/ClickHouse/ClickHouse/pull/61100) ([Raúl Marín](https://github.com/Algunenano))。
- 構文エラーを含むクエリが正規表現を伴うCOLUMNSマッチャーを含んでいた場合、正規表現はパーサーのバックトラック中に一度だけコンパイルされるのではなく、毎回コンパイルされていました。これは根本的なエラーでした。コンパイルされた正規表現はASTに配置されていました。しかし、ASTのAは「抽象」を意味し、重量級オブジェクトを含むべきではありません。ASTの一部は、大量のバックトラックを含む解析中に作成および破棄される可能性があります。これは解析側の遅延につながり、結果として読み取り専用ユーザーによるDoSを可能にします。しかし、主な問題はファザーの進行を妨げることです。[#61543](https://github.com/ClickHouse/ClickHouse/pull/61543) ([Alexey Milovidov](https://github.com/alexey-milovidov))。





#### 改善 {#improvement}

- While running the MODIFY COLUMN query for materialized views, check the inner table's structure to ensure every column exists. [#47427](https://github.com/ClickHouse/ClickHouse/pull/47427) ([sunny](https://github.com/sunny19930321)).
- Added table `system.keywords` which contains all the keywords from parser. Mostly needed and will be used for better fuzzing and syntax highlighting. [#51808](https://github.com/ClickHouse/ClickHouse/pull/51808) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov)).
- Added support for parameterized view with analyzer to not analyze create parameterized view. Refactor existing parameterized view logic to not analyze create parameterized view. [#54211](https://github.com/ClickHouse/ClickHouse/pull/54211) ([SmitaRKulkarni](https://github.com/SmitaRKulkarni)).
- Ordinary database engine is deprecated. You will receive a warning in clickhouse-client if your server is using it. This closes [#52229](https://github.com/ClickHouse/ClickHouse/issues/52229). [#56942](https://github.com/ClickHouse/ClickHouse/pull/56942) ([shabroo](https://github.com/shabroo)).
- All zero copy locks related to a table have to be dropped when the table is dropped. The directory which contains these locks has to be removed also. [#57575](https://github.com/ClickHouse/ClickHouse/pull/57575) ([Sema Checherinda](https://github.com/CheSema)).
- Add short-circuit ability for `dictGetOrDefault` function. Closes [#52098](https://github.com/ClickHouse/ClickHouse/issues/52098). [#57767](https://github.com/ClickHouse/ClickHouse/pull/57767) ([jsc0218](https://github.com/jsc0218)).
- Allow declaring enum in external table structure. [#57857](https://github.com/ClickHouse/ClickHouse/pull/57857) ([Duc Canh Le](https://github.com/canhld94)).
- Running `ALTER COLUMN MATERIALIZE` on a column with `DEFAULT` or `MATERIALIZED` expression now writes the correct values: The default value for existing parts with default value or the non-default value for existing parts with non-default value. Previously, the default value was written for all existing parts. [#58023](https://github.com/ClickHouse/ClickHouse/pull/58023) ([Duc Canh Le](https://github.com/canhld94)).
- Enabled a backoff logic (e.g. exponential). Will provide an ability for reduced CPU usage, memory usage and log file sizes. [#58036](https://github.com/ClickHouse/ClickHouse/pull/58036) ([MikhailBurdukov](https://github.com/MikhailBurdukov)).
- Consider lightweight deleted rows when selecting parts to merge. [#58223](https://github.com/ClickHouse/ClickHouse/pull/58223) ([Zhuo Qiu](https://github.com/jewelzqiu)).
- Allow to define `volume_priority` in `storage_configuration`. [#58533](https://github.com/ClickHouse/ClickHouse/pull/58533) ([Andrey Zvonov](https://github.com/zvonand)).
- Add support for Date32 type in T64 codec. [#58738](https://github.com/ClickHouse/ClickHouse/pull/58738) ([Hongbin Ma](https://github.com/binmahone)).
- This PR makes http/https connections reusable for all uses cases. Even when response is 3xx or 4xx. [#58845](https://github.com/ClickHouse/ClickHouse/pull/58845) ([Sema Checherinda](https://github.com/CheSema)).
- Added comments for columns for more system tables. Continuation of https://github.com/ClickHouse/ClickHouse/pull/58356. [#59016](https://github.com/ClickHouse/ClickHouse/pull/59016) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov)).
- Now we can use virtual columns in PREWHERE. It's worthwhile for non-const virtual columns like `_part_offset`. [#59033](https://github.com/ClickHouse/ClickHouse/pull/59033) ([Amos Bird](https://github.com/amosbird)).
- Settings for the Distributed table engine can now be specified in the server configuration file (similar to MergeTree settings), e.g. `<distributed> <flush_on_detach>false</flush_on_detach> </distributed>`. [#59291](https://github.com/ClickHouse/ClickHouse/pull/59291) ([Azat Khuzhin](https://github.com/azat)).
- Keeper improvement: cache only a certain amount of logs in-memory controlled by `latest_logs_cache_size_threshold` and `commit_logs_cache_size_threshold`. [#59460](https://github.com/ClickHouse/ClickHouse/pull/59460) ([Antonio Andelic](https://github.com/antonio2368)).
- Instead using a constant key, now object storage generates key for determining remove objects capability. [#59495](https://github.com/ClickHouse/ClickHouse/pull/59495) ([Sema Checherinda](https://github.com/CheSema)).
- Don't infer floats in exponential notation by default. Add a setting `input_format_try_infer_exponent_floats` that will restore previous behaviour (disabled by default). Closes [#59476](https://github.com/ClickHouse/ClickHouse/issues/59476). [#59500](https://github.com/ClickHouse/ClickHouse/pull/59500) ([Kruglov Pavel](https://github.com/Avogar)).
- Allow alter operations to be surrounded by parenthesis. The emission of parentheses can be controlled by the `format_alter_operations_with_parentheses` config. By default in formatted queries the parentheses are emitted as we store the formatted alter operations in some places as metadata (e.g.: mutations). The new syntax clarifies some of the queries where alter operations end in a list. E.g.: `ALTER TABLE x MODIFY TTL date GROUP BY a, b, DROP COLUMN c` cannot be parsed properly with the old syntax. In the new syntax the query `ALTER TABLE x (MODIFY TTL date GROUP BY a, b), (DROP COLUMN c)` is obvious. Older versions are not able to read the new syntax, therefore using the new syntax might cause issues if newer and older version of ClickHouse are mixed in a single cluster. [#59532](https://github.com/ClickHouse/ClickHouse/pull/59532) ([János Benjamin Antal](https://github.com/antaljanosbenjamin)).
- Bumped Intel QPL (used by codec `DEFLATE_QPL`) from v1.3.1 to v1.4.0 . Also fixed a bug for polling timeout mechanism, as we observed in same cases timeout won't work properly, if timeout happen, IAA and CPU may process buffer concurrently. So far, we'd better make sure IAA codec status is not QPL_STS_BEING_PROCESSED, then fallback to SW codec. [#59551](https://github.com/ClickHouse/ClickHouse/pull/59551) ([jasperzhu](https://github.com/jinjunzh)).
- Add positional pread in libhdfs3. If you want to call positional read in libhdfs3, use the hdfsPread function in hdfs.h as follows. `tSize hdfsPread(hdfsFS fs, hdfsFile file, void * buffer, tSize length, tOffset position);`. [#59624](https://github.com/ClickHouse/ClickHouse/pull/59624) ([M1eyu](https://github.com/M1eyu2018)).
- Check for stack overflow in parsers even if the user misconfigured the `max_parser_depth` setting to a very high value. This closes [#59622](https://github.com/ClickHouse/ClickHouse/issues/59622). [#59697](https://github.com/ClickHouse/ClickHouse/pull/59697) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- Unify xml and sql created named collection behaviour in kafka storage. [#59710](https://github.com/ClickHouse/ClickHouse/pull/59710) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
- Allow uuid in replica_path if CREATE TABLE explicitly has it. [#59908](https://github.com/ClickHouse/ClickHouse/pull/59908) ([Azat Khuzhin](https://github.com/azat)).
- Add column `metadata_version` of ReplicatedMergeTree table in `system.tables` system table. [#59942](https://github.com/ClickHouse/ClickHouse/pull/59942) ([Maksim Kita](https://github.com/kitaisreal)).
- Keeper improvement: add retries on failures for Disk related operations. [#59980](https://github.com/ClickHouse/ClickHouse/pull/59980) ([Antonio Andelic](https://github.com/antonio2368)).
- Add new config setting `backups.remove_backup_files_after_failure`: `<clickhouse> <backups> <remove_backup_files_after_failure>true</remove_backup_files_after_failure> </backups> </clickhouse>`. [#60002](https://github.com/ClickHouse/ClickHouse/pull/60002) ([Vitaly Baranov](https://github.com/vitlibar)).
- Use multiple threads while reading the metadata of tables from a backup while executing the RESTORE command. [#60040](https://github.com/ClickHouse/ClickHouse/pull/60040) ([Vitaly Baranov](https://github.com/vitlibar)).
- Now if `StorageBuffer` has more than 1 shard (`num_layers` > 1) background flush will happen simultaneously for all shards in multiple threads. [#60111](https://github.com/ClickHouse/ClickHouse/pull/60111) ([alesapin](https://github.com/alesapin)).
- Support specifying users for specific S3 settings in config using `user` key. [#60144](https://github.com/ClickHouse/ClickHouse/pull/60144) ([Antonio Andelic](https://github.com/antonio2368)).
- Copy S3 file GCP fallback to buffer copy in case GCP returned `Internal Error` with `GATEWAY_TIMEOUT` HTTP error code. [#60164](https://github.com/ClickHouse/ClickHouse/pull/60164) ([Maksim Kita](https://github.com/kitaisreal)).
- Allow "local" as object storage type instead of "local_blob_storage". [#60165](https://github.com/ClickHouse/ClickHouse/pull/60165) ([Kseniia Sumarokova](https://github.com/kssenii)).
- Implement comparison operator for Variant values and proper Field inserting into Variant column. Don't allow creating `Variant` type with similar variant types by default (allow uder a setting `allow_suspicious_variant_types`) Closes [#59996](https://github.com/ClickHouse/ClickHouse/issues/59996). Closes [#59850](https://github.com/ClickHouse/ClickHouse/issues/59850). [#60198](https://github.com/ClickHouse/ClickHouse/pull/60198) ([Kruglov Pavel](https://github.com/Avogar)).
- Improved overall usability of virtual columns. Now it is allowed to use virtual columns in `PREWHERE` (it's worthwhile for non-const virtual columns like `_part_offset`). Now a builtin documentation is available for virtual columns as a comment of column in `DESCRIBE` query with enabled setting `describe_include_virtual_columns`. [#60205](https://github.com/ClickHouse/ClickHouse/pull/60205) ([Anton Popov](https://github.com/CurtizJ)).
- Short circuit execution for `ULIDStringToDateTime`. [#60211](https://github.com/ClickHouse/ClickHouse/pull/60211) ([Juan Madurga](https://github.com/jlmadurga)).
- Added `query_id` column for tables `system.backups` and `system.backup_log`. Added error stacktrace to `error` column. [#60220](https://github.com/ClickHouse/ClickHouse/pull/60220) ([Maksim Kita](https://github.com/kitaisreal)).
- Parallel flush of pending INSERT blocks of Distributed engine on `DETACH`/server shutdown and `SYSTEM FLUSH DISTRIBUTED` (Parallelism will work only if you have multi disk policy for table (like everything in Distributed engine right now)). [#60225](https://github.com/ClickHouse/ClickHouse/pull/60225) ([Azat Khuzhin](https://github.com/azat)).
- Filter setting is improper in `joinRightColumnsSwitchNullability`, resolve [#59625](https://github.com/ClickHouse/ClickHouse/issues/59625). [#60259](https://github.com/ClickHouse/ClickHouse/pull/60259) ([lgbo](https://github.com/lgbo-ustc)).
- Add a setting to force read-through cache for merges. [#60308](https://github.com/ClickHouse/ClickHouse/pull/60308) ([Kseniia Sumarokova](https://github.com/kssenii)).
- Issue [#57598](https://github.com/ClickHouse/ClickHouse/issues/57598) mentions a variant behaviour regarding transaction handling. An issued COMMIT/ROLLBACK when no transaction is active is reported as an error contrary to MySQL behaviour. [#60338](https://github.com/ClickHouse/ClickHouse/pull/60338) ([PapaToemmsn](https://github.com/PapaToemmsn)).
- Added `none_only_active` mode for `distributed_ddl_output_mode` setting. [#60340](https://github.com/ClickHouse/ClickHouse/pull/60340) ([Alexander Tokmakov](https://github.com/tavplubix)).
- Connections through the MySQL port now automatically run with setting `prefer_column_name_to_alias = 1` to support QuickSight out-of-the-box. Also, settings `mysql_map_string_to_text_in_show_columns` and `mysql_map_fixed_string_to_text_in_show_columns` are now enabled by default, affecting also only MySQL connections. This increases compatibility with more BI tools. [#60365](https://github.com/ClickHouse/ClickHouse/pull/60365) ([Robert Schulze](https://github.com/rschu1ze)).
- When output format is Pretty format and a block consists of a single numeric value which exceeds one million, A readable number will be printed on table right. e.g. `┌──────count()─┐ │ 233765663884 │ -- 233.77 billion └──────────────┘`. [#60379](https://github.com/ClickHouse/ClickHouse/pull/60379) ([rogeryk](https://github.com/rogeryk)).
- Allow configuring HTTP redirect handlers for clickhouse-server. For example, you can make `/` redirect to the Play UI. [#60390](https://github.com/ClickHouse/ClickHouse/pull/60390) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- The advanced dashboard has slightly better colors for multi-line graphs. [#60391](https://github.com/ClickHouse/ClickHouse/pull/60391) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- Fix a race condition in JavaScript code leading to duplicate charts on top of each other. [#60392](https://github.com/ClickHouse/ClickHouse/pull/60392) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- Check for stack overflow in parsers even if the user misconfigured the `max_parser_depth` setting to a very high value. This closes [#59622](https://github.com/ClickHouse/ClickHouse/issues/59622). [#60434](https://github.com/ClickHouse/ClickHouse/pull/60434) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- Function `substring` now has a new alias `byteSlice`. [#60494](https://github.com/ClickHouse/ClickHouse/pull/60494) ([Robert Schulze](https://github.com/rschu1ze)).
- Renamed server setting `dns_cache_max_size` to `dns_cache_max_entries` to reduce ambiguity. [#60500](https://github.com/ClickHouse/ClickHouse/pull/60500) ([Kirill Nikiforov](https://github.com/allmazz)).
- `SHOW INDEX | INDEXES | INDICES | KEYS` no longer sorts by the primary key columns (which was unintuitive). [#60514](https://github.com/ClickHouse/ClickHouse/pull/60514) ([Robert Schulze](https://github.com/rschu1ze)).
- Keeper improvement: abort during startup if an invalid snapshot is detected to avoid data loss. [#60537](https://github.com/ClickHouse/ClickHouse/pull/60537) ([Antonio Andelic](https://github.com/antonio2368)).
- Added MergeTree read split ranges into intersecting and non intersecting fault injection using `merge_tree_read_split_ranges_into_intersecting_and_non_intersecting_fault_probability` setting. [#60548](https://github.com/ClickHouse/ClickHouse/pull/60548) ([Maksim Kita](https://github.com/kitaisreal)).
- The Advanced dashboard now has controls always visible on scrolling. This allows you to add a new chart without scrolling up. [#60692](https://github.com/ClickHouse/ClickHouse/pull/60692) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- String types and Enums can be used in the same context, such as: arrays, UNION queries, conditional expressions. This closes [#60726](https://github.com/ClickHouse/ClickHouse/issues/60726). [#60727](https://github.com/ClickHouse/ClickHouse/pull/60727) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- Update tzdata to 2024a. [#60768](https://github.com/ClickHouse/ClickHouse/pull/60768) ([Raúl Marín](https://github.com/Algunenano)).
- Support files without format extension in Filesystem database. [#60795](https://github.com/ClickHouse/ClickHouse/pull/60795) ([Kruglov Pavel](https://github.com/Avogar)).
- Keeper improvement: support `leadership_expiry_ms` in Keeper's settings. [#60806](https://github.com/ClickHouse/ClickHouse/pull/60806) ([Brokenice0415](https://github.com/Brokenice0415)).
- Always infer exponential numbers in JSON formats regardless of the setting `input_format_try_infer_exponent_floats`. Add setting `input_format_json_use_string_type_for_ambiguous_paths_in_named_tuples_inference_from_objects` that allows to use String type for ambiguous paths instead of an exception during named Tuples inference from JSON objects. [#60808](https://github.com/ClickHouse/ClickHouse/pull/60808) ([Kruglov Pavel](https://github.com/Avogar)).
- Add a flag for SMJ to treat null as biggest/smallest. So the behavior can be compitable with other SQL systems, like Apache Spark. [#60896](https://github.com/ClickHouse/ClickHouse/pull/60896) ([loudongfeng](https://github.com/loudongfeng)).
- Clickhouse version has been added to docker labels. Closes [#54224](https://github.com/ClickHouse/ClickHouse/issues/54224). [#60949](https://github.com/ClickHouse/ClickHouse/pull/60949) ([Nikolay Monkov](https://github.com/nikmonkov)).
- Add a setting `parallel_replicas_allow_in_with_subquery = 1` which allows subqueries for IN work with parallel replicas. [#60950](https://github.com/ClickHouse/ClickHouse/pull/60950) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
- DNSResolver shuffles set of resolved IPs. [#60965](https://github.com/ClickHouse/ClickHouse/pull/60965) ([Sema Checherinda](https://github.com/CheSema)).
- Support detect output format by file exctension in `clickhouse-client` and `clickhouse-local`. [#61036](https://github.com/ClickHouse/ClickHouse/pull/61036) ([豪肥肥](https://github.com/HowePa)).
- Check memory limit update periodically. [#61049](https://github.com/ClickHouse/ClickHouse/pull/61049) ([Han Fei](https://github.com/hanfei1991)).
- Enable processors profiling (time spent/in and out bytes for sorting, aggregation, ...) by default. [#61096](https://github.com/ClickHouse/ClickHouse/pull/61096) ([Azat Khuzhin](https://github.com/azat)).
- Add the function `toUInt128OrZero`, which was missed by mistake (the mistake is related to https://github.com/ClickHouse/ClickHouse/pull/945). The compatibility aliases `FROM_UNIXTIME` and `DATE_FORMAT` (they are not ClickHouse-native and only exist for MySQL compatibility) have been made case insensitive, as expected for SQL-compatibility aliases. [#61114](https://github.com/ClickHouse/ClickHouse/pull/61114) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- Improvements for the access checks, allowing to revoke of unpossessed rights in case the target user doesn't have the revoking grants either. Example: ```sql GRANT SELECT ON _._ TO user1; REVOKE SELECT ON system.\* FROM user1;. [#61115](https://github.com/ClickHouse/ClickHouse/pull/61115) ([pufit](https://github.com/pufit)).
- Fix an error in previeous opt: https://github.com/ClickHouse/ClickHouse/pull/59698: remove break to make sure the first filtered column has minimum size cc @jsc0218. [#61145](https://github.com/ClickHouse/ClickHouse/pull/61145) ([李扬](https://github.com/taiyang-li)).
- Fix `has()` function with `Nullable` column (fixes [#60214](https://github.com/ClickHouse/ClickHouse/issues/60214)). [#61249](https://github.com/ClickHouse/ClickHouse/pull/61249) ([Mikhail Koviazin](https://github.com/mkmkme)).
- Now it's possible to specify attribute `merge="true"` in config substitutions for subtrees `<include from_zk="/path" merge="true">`. In case this attribute specified, clickhouse will merge subtree with existing configuration, otherwise default behavior is append new content to configuration. [#61299](https://github.com/ClickHouse/ClickHouse/pull/61299) ([alesapin](https://github.com/alesapin)).
- Add async metrics for virtual memory mappings: VMMaxMapCount & VMNumMaps. Closes [#60662](https://github.com/ClickHouse/ClickHouse/issues/60662). [#61354](https://github.com/ClickHouse/ClickHouse/pull/61354) ([Tuan Pham Anh](https://github.com/tuanpavn)).
- Use `temporary_files_codec` setting in all places where we create temporary data, for example external memory sorting and external memory GROUP BY. Before it worked only in `partial_merge` JOIN algorithm. [#61456](https://github.com/ClickHouse/ClickHouse/pull/61456) ([Maksim Kita](https://github.com/kitaisreal)).
- Remove duplicated check `containing_part.empty()`, It's already being checked here: https://github.com/ClickHouse/ClickHouse/blob/1296dac3c7e47670872c15e3f5e58f869e0bd2f2/src/Storages/MergeTree/MergeTreeData.cpp#L6141. [#61467](https://github.com/ClickHouse/ClickHouse/pull/61467) ([William Schoeffel](https://github.com/wiledusc)).
- Add a new setting `max_parser_backtracks` which allows to limit the complexity of query parsing. [#61502](https://github.com/ClickHouse/ClickHouse/pull/61502) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- Less contention during dynamic resize of filesystem cache. [#61524](https://github.com/ClickHouse/ClickHouse/pull/61524) ([Kseniia Sumarokova](https://github.com/kssenii)).
- Disallow sharded mode of StorageS3 queue, because it will be rewritten. [#61537](https://github.com/ClickHouse/ClickHouse/pull/61537) ([Kseniia Sumarokova](https://github.com/kssenii)).
- Fixed typo: from `use_leagcy_max_level` to `use_legacy_max_level`. [#61545](https://github.com/ClickHouse/ClickHouse/pull/61545) ([William Schoeffel](https://github.com/wiledusc)).
- Remove some duplicate entries in blob_storage_log. [#61622](https://github.com/ClickHouse/ClickHouse/pull/61622) ([YenchangChan](https://github.com/YenchangChan)).
- Added `current_user` function as a compatibility alias for MySQL. [#61770](https://github.com/ClickHouse/ClickHouse/pull/61770) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
- Use managed identity for backups IO when using Azure Blob Storage. Add a setting to prevent ClickHouse from attempting to create a non-existent container, which requires permissions at the storage account level. [#61785](https://github.com/ClickHouse/ClickHouse/pull/61785) ([Daniel Pozo Escalona](https://github.com/danipozo)).
- In the previous version, some numbers in Pretty formats were not pretty enough. [#61794](https://github.com/ClickHouse/ClickHouse/pull/61794) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- A long value in Pretty formats won't be cut if it is the single value in the resultset, such as in the result of the `SHOW CREATE TABLE` query. [#61795](https://github.com/ClickHouse/ClickHouse/pull/61795) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- Similarly to `clickhouse-local`, `clickhouse-client` will accept the `--output-format` option as a synonym to the `--format` option. This closes [#59848](https://github.com/ClickHouse/ClickHouse/issues/59848). [#61797](https://github.com/ClickHouse/ClickHouse/pull/61797) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- If stdout is a terminal and the output format is not specified, `clickhouse-client` and similar tools will use `PrettyCompact` by default, similarly to the interactive mode. `clickhouse-client` and `clickhouse-local` will handle command line arguments for input and output formats in a unified fashion. This closes [#61272](https://github.com/ClickHouse/ClickHouse/issues/61272). [#61800](https://github.com/ClickHouse/ClickHouse/pull/61800) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
- Underscore digit groups in Pretty formats for better readability. This is controlled by a new setting, `output_format_pretty_highlight_digit_groups`. [#61802](https://github.com/ClickHouse/ClickHouse/pull/61802) ([Alexey Milovidov](https://github.com/alexey-milovidov)).

#### バグ修正（公式安定版リリースにおけるユーザーに影響する不具合） {#bug-fix-user-visible-misbehavior-in-an-official-stable-release}


* 10 進数の引数に対する `intDiv` の不具合を修正 [#59243](https://github.com/ClickHouse/ClickHouse/pull/59243)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* wingfuzz によって検出された kql の問題を修正 [#59626](https://github.com/ClickHouse/ClickHouse/pull/59626) （[Yong Wang](https://github.com/kashwy)）。
* AsynchronousBoundedReadBuffer において発生するエラー「Read beyond last offset」を修正 [#59630](https://github.com/ClickHouse/ClickHouse/pull/59630)（[Vitaly Baranov](https://github.com/vitlibar)）。
* rabbitmq: ack も nack もされないメッセージが発生する問題を修正 [#59775](https://github.com/ClickHouse/ClickHouse/pull/59775) ([Kseniia Sumarokova](https://github.com/kssenii)).
* アナライザにおける `GROUP BY const` 利用時の const および LowCardinality に対する関数実行を修正 [#59986](https://github.com/ClickHouse/ClickHouse/pull/59986)（[Azat Khuzhin](https://github.com/azat)）。
* DateTime64 のスケール変換を修正しました [#60004](https://github.com/ClickHouse/ClickHouse/pull/60004) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。
* SQLite への INSERT におけるシングルクォートの扱いを修正（バックスラッシュではなくクォートでシングルクォートをエスケープするように変更） [#60015](https://github.com/ClickHouse/ClickHouse/pull/60015) ([Azat Khuzhin](https://github.com/azat)).
* `optimize_uniq_to_count` がカラムエイリアスを削除してしまう問題を修正 [#60026](https://github.com/ClickHouse/ClickHouse/pull/60026)（[Raúl Marín](https://github.com/Algunenano)）。
* MergeTree 向けの `finished_mutations_to_keep=0` の挙動を修正（ドキュメントでは 0 はすべてを保持することを意味すると説明されているため） [#60031](https://github.com/ClickHouse/ClickHouse/pull/60031) ([Azat Khuzhin](https://github.com/azat))。
* s3queue テーブルの DROP 時に発生しうる例外を修正 [#60036](https://github.com/ClickHouse/ClickHouse/pull/60036) ([Kseniia Sumarokova](https://github.com/kssenii))。
* 同じパーツに対して `PartsSplitter` が不正なレンジを生成する問題を修正 [#60041](https://github.com/ClickHouse/ClickHouse/pull/60041)（[Maksim Kita](https://github.com/kitaisreal)）。
* DDLLogEntry でハードコードされた 4096 の代わりに、コンテキストからの max&#95;query&#95;size を使用するようにしました [#60083](https://github.com/ClickHouse/ClickHouse/pull/60083) ([Kruglov Pavel](https://github.com/Avogar))。
* クエリのフォーマットの不整合を修正 [#60095](https://github.com/ClickHouse/ClickHouse/pull/60095) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* サブクエリ内の EXPLAIN の書式の不整合を修正 [#60102](https://github.com/ClickHouse/ClickHouse/pull/60102) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* Nullable 使用時に発生する cosineDistance のクラッシュを修正 [#60150](https://github.com/ClickHouse/ClickHouse/pull/60150) ([Raúl Marín](https://github.com/Algunenano)).
* 文字列表現の bool を本来の bool 型へキャストできるようにしました [#60160](https://github.com/ClickHouse/ClickHouse/pull/60160) ([Robert Schulze](https://github.com/rschu1ze)).
* system.s3queue&#95;log を修正しました [#60166](https://github.com/ClickHouse/ClickHouse/pull/60166) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 集約関数名が Nullable の場合の arrayReduce の動作を修正 [#60188](https://github.com/ClickHouse/ClickHouse/pull/60188) ([Raúl Marín](https://github.com/Algunenano))。
* 事前フィルタリング（PK、パーティションプルーニング）時のアクションの実行を修正 [#60196](https://github.com/ClickHouse/ClickHouse/pull/60196) ([Azat Khuzhin](https://github.com/azat))。
* s3queue の機密情報をマスク [#60233](https://github.com/ClickHouse/ClickHouse/pull/60233)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* &quot;`ORDER BY ALL` を `ORDER BY *` に置き換える&quot; を取り消し [#60248](https://github.com/ClickHouse/ClickHouse/pull/60248) ([Robert Schulze](https://github.com/rschu1ze)).
* Azure Blob Storage : エンドポイントおよびプレフィックスに関する不具合を修正 [#60251](https://github.com/ClickHouse/ClickHouse/pull/60251) ([SmitaRKulkarni](https://github.com/SmitaRKulkarni)).
* HTTP 例外コードを修正しました。 [#60252](https://github.com/ClickHouse/ClickHouse/pull/60252) ([Austin Kothig](https://github.com/kothiga)).
* LRUResource Cache のバグを修正（Hive キャッシュ） [#60262](https://github.com/ClickHouse/ClickHouse/pull/60262) ([shanfengp](https://github.com/Aed-p)).
* s3queue: バグを修正（不安定だった test&#95;storage&#95;s3&#95;queue/test.py::test&#95;shards&#95;distributed の問題もあわせて解消） [#60282](https://github.com/ClickHouse/ClickHouse/pull/60282) ([Kseniia Sumarokova](https://github.com/kssenii)).
* IPv6 を用いたハッシュ関数における未初期化値の使用と不正な結果を修正 [#60359](https://github.com/ClickHouse/ClickHouse/pull/60359) ([Kruglov Pavel](https://github.com/Avogar)).
* 並列レプリカに変更があった場合に再解析を強制する [#60362](https://github.com/ClickHouse/ClickHouse/pull/60362) ([Raúl Marín](https://github.com/Algunenano)).
* 新しいディスク構成オプションでのプレーンメタデータ型の使用方法を修正 [#60396](https://github.com/ClickHouse/ClickHouse/pull/60396)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* max&#95;parallel&#95;replicas を 0 に設定できないようにしました。0 に設定することには意味がないためです [#60430](https://github.com/ClickHouse/ClickHouse/pull/60430) ([Kruglov Pavel](https://github.com/Avogar))。
* mapContainsKeyLike における論理エラー「Cannot capture column because it has incompatible type」の修正を試みました [#60451](https://github.com/ClickHouse/ClickHouse/pull/60451) ([Kruglov Pavel](https://github.com/Avogar))。
* null 引数を取る OptimizeDateOrDateTimeConverterWithPreimageVisitor を修正 [#60453](https://github.com/ClickHouse/ClickHouse/pull/60453) ([Raúl Marín](https://github.com/Algunenano)).
* CREATE TABLE におけるスカラサブクエリの計算を極力避けるようにしました。 [#60464](https://github.com/ClickHouse/ClickHouse/pull/60464) ([Nikolai Kochetov](https://github.com/KochetovNicolai))。
* [#59674](https://github.com/ClickHouse/ClickHouse/issues/59674) をマージ。[#60470](https://github.com/ClickHouse/ClickHouse/pull/60470)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* s3Cluster 内のキーを正しく検査するように修正 [#60477](https://github.com/ClickHouse/ClickHouse/pull/60477) ([Antonio Andelic](https://github.com/antonio2368))。
* 大量の行がエラーによりスキップされる場合の並列パース時のデッドロックを修正 [#60516](https://github.com/ClickHouse/ClickHouse/pull/60516) ([Kruglov Pavel](https://github.com/Avogar))。
* kql&#95;compound&#95;operator 向けの max&#95;query&#95;size を修正: [#60534](https://github.com/ClickHouse/ClickHouse/pull/60534) ([Yong Wang](https://github.com/kashwy)).
* Keeper の修正: コミットログの待機時にタイムアウトを追加 [#60544](https://github.com/ClickHouse/ClickHouse/pull/60544) ([Antonio Andelic](https://github.com/antonio2368))。
* `system.numbers` から読み取る行数を削減 [#60546](https://github.com/ClickHouse/ClickHouse/pull/60546) ([JackyWoo](https://github.com/JackyWoo))。
* 日付型に対して数値のヒントを出力しないようにしました [#60577](https://github.com/ClickHouse/ClickHouse/pull/60577) ([Raúl Marín](https://github.com/Algunenano)).
* フィルタで非決定的関数を使用している場合の MergeTree からの読み取りを修正 [#60586](https://github.com/ClickHouse/ClickHouse/pull/60586) ([Kruglov Pavel](https://github.com/Avogar))。
* 互換性設定に不正な値型が指定された場合の論理エラーを修正 [#60596](https://github.com/ClickHouse/ClickHouse/pull/60596) ([Kruglov Pavel](https://github.com/Avogar)).
* x86-64 / ARM 混在クラスターにおける集約関数状態の不整合を修正 [#60610](https://github.com/ClickHouse/ClickHouse/pull/60610) ([Harry Lee](https://github.com/HarryLeeIBM)).
* fix(prql): より堅牢なパニックハンドラ [#60615](https://github.com/ClickHouse/ClickHouse/pull/60615) ([Maximilian Roos](https://github.com/max-sixty)).
* 10 進数および日付引数に対する `intDiv` の挙動を修正 [#60672](https://github.com/ClickHouse/ClickHouse/pull/60672) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。
* 修正: `ALTER ... MODIFY` クエリで CTE を展開するように修正 [#60682](https://github.com/ClickHouse/ClickHouse/pull/60682)（[Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)）。
* 非 Atomic/Ordinary データベースエンジン（例: Memory）用の system.parts を修正 [#60689](https://github.com/ClickHouse/ClickHouse/pull/60689)（[Azat Khuzhin](https://github.com/azat)）。
* パラメータ化ビューにおける「Invalid storage definition in metadata file」エラーを修正 [#60708](https://github.com/ClickHouse/ClickHouse/pull/60708) ([Azat Khuzhin](https://github.com/azat))。
* CompressionCodecMultiple のバッファオーバーフローを修正しました [#60731](https://github.com/ClickHouse/ClickHouse/pull/60731) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* SQL/JSON から不正な要素を削除 [#60738](https://github.com/ClickHouse/ClickHouse/pull/60738) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 集約関数 quantileGK における誤ったサニタイズチェックを削除 [#60740](https://github.com/ClickHouse/ClickHouse/pull/60740) ([李扬](https://github.com/taiyang-li)).
* streams を 1 に設定することで insert-select + insert&#95;deduplication&#95;token のバグを修正する [#60745](https://github.com/ClickHouse/ClickHouse/pull/60745) ([Jordi Villar](https://github.com/jrdi))。
* サポートされていないマルチパートアップロード操作でカスタムメタデータヘッダーを設定できないようにしました [#60748](https://github.com/ClickHouse/ClickHouse/pull/60748) ([Francisco J. Jurado Moreno](https://github.com/Beetelbrox)).
* toStartOfInterval を修正しました [#60763](https://github.com/ClickHouse/ClickHouse/pull/60763)（[Andrey Zvonov](https://github.com/zvonand)）。
* arrayEnumerateRanked のクラッシュを修正しました [#60764](https://github.com/ClickHouse/ClickHouse/pull/60764)（[Raúl Marín](https://github.com/Algunenano)）。
* INSERT SELECT JOIN で input() を使用した際に発生するクラッシュを修正 [#60765](https://github.com/ClickHouse/ClickHouse/pull/60765) ([Kruglov Pavel](https://github.com/Avogar)).
* サブクエリ内で `allow_experimental_analyzer` の値が異なる場合に発生するクラッシュを修正しました [#60770](https://github.com/ClickHouse/ClickHouse/pull/60770) ([Dmitry Novik](https://github.com/novikd))。
* S3 からの読み取り時の再帰処理を削除しました [#60849](https://github.com/ClickHouse/ClickHouse/pull/60849) ([Antonio Andelic](https://github.com/antonio2368)).
* HashedDictionaryParallelLoader において、エラー発生時にハングしたままになる可能性がある問題を修正しました [#60926](https://github.com/ClickHouse/ClickHouse/pull/60926) ([vdimir](https://github.com/vdimir))。
* 非同期 RESTORE と Replicated データベースの組み合わせに関する問題を修正 [#60934](https://github.com/ClickHouse/ClickHouse/pull/60934)（[Antonio Andelic](https://github.com/antonio2368) による変更）。
* ネイティブプロトコル経由での `Log` テーブルへの非同期挿入で発生するデッドロックを修正 [#61055](https://github.com/ClickHouse/ClickHouse/pull/61055) ([Anton Popov](https://github.com/CurtizJ))。
* RangeHashedDictionary における dictGetOrDefault のデフォルト引数の遅延評価を修正 [#61196](https://github.com/ClickHouse/ClickHouse/pull/61196) ([Kruglov Pavel](https://github.com/Avogar)).
* groupArraySorted の複数のバグを修正 [#61203](https://github.com/ClickHouse/ClickHouse/pull/61203)（[Raúl Marín](https://github.com/Algunenano)）。
* スタンドアロンバイナリ向けの Keeper の再設定を修正 [#61233](https://github.com/ClickHouse/ClickHouse/pull/61233) ([Antonio Andelic](https://github.com/antonio2368))。
* S3 エンジンでの session&#95;token の使用を修正 [#61234](https://github.com/ClickHouse/ClickHouse/pull/61234) ([Kruglov Pavel](https://github.com/Avogar)).
* 集約関数 `uniqExact` で不正な結果が返される可能性のある問題を修正 [#61257](https://github.com/ClickHouse/ClickHouse/pull/61257) ([Anton Popov](https://github.com/CurtizJ))。
* show databases のバグを修正 [#61269](https://github.com/ClickHouse/ClickHouse/pull/61269)（[Raúl Marín](https://github.com/Algunenano)）。
* MATERIALIZED カラムを含む RabbitMQ ストレージの論理エラーを修正 [#61320](https://github.com/ClickHouse/ClickHouse/pull/61320) ([vdimir](https://github.com/vdimir))。
* CREATE OR REPLACE DICTIONARY を修正しました [#61356](https://github.com/ClickHouse/ClickHouse/pull/61356)（[Vitaly Baranov](https://github.com/vitlibar)）。
* 外部の ON CLUSTER を使用する ATTACH クエリを修正 [#61365](https://github.com/ClickHouse/ClickHouse/pull/61365)（[Nikolay Degterinsky](https://github.com/evillique)）。
* actions DAG 分割に関する問題を修正 [#61458](https://github.com/ClickHouse/ClickHouse/pull/61458) ([Raúl Marín](https://github.com/Algunenano)).
* 失敗した RESTORE の完了処理に関する問題を修正しました [#61466](https://github.com/ClickHouse/ClickHouse/pull/61466) ([Vitaly Baranov](https://github.com/vitlibar)).
* 互換性設定を使用して async&#95;insert&#95;use&#95;adaptive&#95;busy&#95;timeout を正しく無効化 [#61468](https://github.com/ClickHouse/ClickHouse/pull/61468)（[Raúl Marín](https://github.com/Algunenano)）。
* リストアプールでのキューイングを許可 [#61475](https://github.com/ClickHouse/ClickHouse/pull/61475)（[Nikita Taranov](https://github.com/nickitat)）。
* UUID を使用して `system.parts` を読み取る際の不具合を修正 (issue 61220)。 [#61479](https://github.com/ClickHouse/ClickHouse/pull/61479) ([Dan Wu](https://github.com/wudanzy))。
* ウィンドウビューで発生していたクラッシュを修正しました [#61526](https://github.com/ClickHouse/ClickHouse/pull/61526) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* ネイティブ以外の整数型に対する `repeat` の動作を修正 [#61527](https://github.com/ClickHouse/ClickHouse/pull/61527) ([Antonio Andelic](https://github.com/antonio2368)).
* クライアントの `-s` 引数を修正しました [#61530](https://github.com/ClickHouse/ClickHouse/pull/61530)（[Mikhail f. Shiryaev](https://github.com/Felixoid)）。
* arrayPartialReverseSort のクラッシュを修正しました [#61539](https://github.com/ClickHouse/ClickHouse/pull/61539) ([Raúl Marín](https://github.com/Algunenano))。
* 定数 position を用いた文字列検索を修正 [#61547](https://github.com/ClickHouse/ClickHouse/pull/61547)（[Antonio Andelic](https://github.com/antonio2368)）。
* datetime64 で使用したときにエラーが発生する問題を addDays で修正 [#61561](https://github.com/ClickHouse/ClickHouse/pull/61561)（[Shuai li](https://github.com/loneylee)）。
* 重複排除付き非同期挿入に対する `system.part_log` を修正 [#61620](https://github.com/ClickHouse/ClickHouse/pull/61620)（[Antonio Andelic](https://github.com/antonio2368)）。
* system.parts の Non-ready セットを修正。[#61666](https://github.com/ClickHouse/ClickHouse/pull/61666)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
