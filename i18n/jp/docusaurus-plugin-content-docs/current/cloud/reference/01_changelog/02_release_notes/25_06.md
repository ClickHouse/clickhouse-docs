---
slug: /changelogs/25.6
title: 'v25.6 Cloud 向けチェンジログ'
description: 'v25.6 のファストリリース版チェンジログ'
keywords: ['changelog', 'cloud']
sidebar_label: '25.6'
sidebar_position: 2
doc_type: 'changelog'
---



## 後方互換性のない変更 {#backward-incompatible-change}

- 関数 `geoToH3()` は、入力を (lat, lon, res) の順序で受け付けるようになりました(これは幾何関数の標準的な順序です)。従来の結果順序 (lon, lat, res) を保持したい場合は、設定 `geotoh3_lon_lat_input_order = true` を指定できます。[#78852](https://github.com/ClickHouse/ClickHouse/pull/78852) ([Pratima Patel](https://github.com/pratimapatel2008))。
- `full_text` タイプのインデックスは `gin` に名称変更されました。これは PostgreSQL や他のデータベースでより馴染みのある用語に従っています。既存の `full_text` タイプのインデックスは読み込み可能ですが、検索で使用しようとすると例外がスローされます(代わりに `gin` インデックスの使用を提案します)。[#79024](https://github.com/ClickHouse/ClickHouse/pull/79024) ([Robert Schulze](https://github.com/rschu1ze))。
- ファイルシステムキャッシュの動的リサイズを許可するために、ファイルシステムキャッシュ設定 `allow_dynamic_cache_resize` を追加しました。デフォルトは `false` です。理由: 特定の環境(ClickHouse Cloud)では、すべてのスケーリングイベントがプロセスの再起動を通じて発生するため、動作をより制御し、安全対策として、この機能を明示的に無効にする必要があります。この PR は後方互換性がないとマークされています。なぜなら、古いバージョンでは特別な設定なしでデフォルトで動的キャッシュリサイズが機能していたためです。[#79148](https://github.com/ClickHouse/ClickHouse/pull/79148) ([Kseniia Sumarokova](https://github.com/kssenii))。
- レガシーインデックスタイプ `annoy` と `usearch` のサポートを削除しました。両方とも長い間スタブであり、つまりレガシーインデックスを使用しようとするたびにエラーが返されていました。まだ `annoy` と `usearch` インデックスをお持ちの場合は、削除してください。[#79802](https://github.com/ClickHouse/ClickHouse/pull/79802) ([Robert Schulze](https://github.com/rschu1ze))。#_ サーバー設定 `format_alter_commands_with_parentheses` を削除しました。この設定は 24.2 で導入され、デフォルトで無効化されていました。25.2 でデフォルトで有効化されました。新しいフォーマットをサポートしない LTS バージョンが存在しないため、この設定を削除できます。[#79970](https://github.com/ClickHouse/ClickHouse/pull/79970) ([János Benjamin Antal](https://github.com/antaljanosbenjamin))。#_ マイナー: backup_threads と restore_threads サーバー設定を非ゼロに強制します。[#80224](https://github.com/ClickHouse/ClickHouse/pull/80224) ([Raúl Marín](https://github.com/Algunenano))。
- String に対する bitNot() がゼロ終端文字列を返すように修正しました。[#80791](https://github.com/ClickHouse/ClickHouse/pull/80791) ([Azat Khuzhin](https://github.com/azat))。


## 新機能 {#new-feature}


* `CREATE` クエリで対象カラムに対して圧縮コーデックが明示的に指定されていない場合に使用されるデフォルトの圧縮コーデックを設定する、新しい MergeTree の `SETTINGS` オプションを追加しました。これにより [#42005](https://github.com/ClickHouse/ClickHouse/issues/42005) がクローズされました。 [#66394](https://github.com/ClickHouse/ClickHouse/pull/66394) ([gvoelfin](https://github.com/gvoelfin))。
* [https://github.com/ClickHouse/ClickHouse/pull/71943](https://github.com/ClickHouse/ClickHouse/pull/71943) のフォローアップです。この PR では `Time` / `Time64` データ型を実装しています。新しいデータ型 Time (HHH:MM:SS) と Time64 (HHH:MM:SS.`&lt;fractional&gt;`) を実装し、いくつかの基本的なキャスト関数および他のデータ型と連携するための関数を追加しました。また、キャスト関数で `toTime` 関数が必要となるため、既存の関数名 `toTime` を `toTimeWithFixedDate` に変更しました。[#75735](https://github.com/ClickHouse/ClickHouse/pull/75735)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* `WHERE` 句の `EXISTS` 式の引数として相関サブクエリをサポートします。[#72459](https://github.com/ClickHouse/ClickHouse/issues/72459) をクローズしました。[#76078](https://github.com/ClickHouse/ClickHouse/pull/76078)（[Dmitry Novik](https://github.com/novikd)）。
* Merge テーブルエンジンへの書き込みを許可。 [#77484](https://github.com/ClickHouse/ClickHouse/pull/77484) ([Anton Ivashkin](https://github.com/ianton-ru))。
* レプリケートされた MergeTree テーブルに対する分散 `INSERT SELECT` では、異なるノードで異なるデータを選択して独立して挿入することで、並列レプリカを効率的に活用して `INSERT` を並列化できるようになりました。 [#78041](https://github.com/ClickHouse/ClickHouse/pull/78041) ([Igor Nikonov](https://github.com/devcrafter)).
* `mapContainsValuesLike`/`mapContainsValues`/`mapExtractValuesLike` 関数を追加し、マップの値に対するフィルタリングと、それらの bloomfilter ベースのインデックスでのサポートを可能にしました。 [#78171](https://github.com/ClickHouse/ClickHouse/pull/78171) ([UnamedRus](https://github.com/UnamedRus)).
* `system.iceberg_history` テーブルを追加。 [#78244](https://github.com/ClickHouse/ClickHouse/pull/78244) ([Smita Kulkarni](https://github.com/SmitaRKulkarni)).
* ワークロード向けのクエリスロットスケジューリングを追加しました。詳細は [https://clickhouse.com/docs/operations/workload-scheduling#query&#95;scheduling](https://clickhouse.com/docs/operations/workload-scheduling#query_scheduling) を参照してください。 [#78415](https://github.com/ClickHouse/ClickHouse/pull/78415)（[Sergei Trifonov](https://github.com/serxa)）。
* `getServerSetting` 関数と `getMergeTreeSetting` 関数を追加。 [https://github.com/clickhouse/clickhouse/issues/78318](https://github.com/clickhouse/clickhouse/issues/78318) をクローズ。[#78439](https://github.com/ClickHouse/ClickHouse/pull/78439)（[NamNguyenHoai](https://github.com/NamHoaiNguyen)）。
* 設定制約で不許可となる値のサポートに対応。 [#78499](https://github.com/ClickHouse/ClickHouse/pull/78499) ([Bharat Nallan](https://github.com/bharatnc))。
* `version-hint.text` ファイルを活用するための新しい設定 `iceberg_enable_version_hint` を追加。 [#78594](https://github.com/ClickHouse/ClickHouse/pull/78594) ([Arnaud Briche](https://github.com/arnaudbriche)).
* `LIKE` キーワードでフィルタリングして、データベース内の特定のテーブルを削除（TRUNCATE）できるようになりました。 [#78597](https://github.com/ClickHouse/ClickHouse/pull/78597) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* `clickhouse-local`（およびその短縮エイリアスである `ch`）は、処理する入力データがある場合に暗黙の `FROM table` を使用するようになりました。これにより [#65023](https://github.com/ClickHouse/ClickHouse/issues/65023) が解決されました。また、通常ファイルを処理する際に `--input-format` が指定されていない場合、clickhouse-local でフォーマットの自動推論が行われるようになりました。[#79085](https://github.com/ClickHouse/ClickHouse/pull/79085)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* [`icebergHash`](https://iceberg.apache.org/spec/#appendix-b-32-bit-hash-requirements) 関数と [`icebergBucketTransform`](https://iceberg.apache.org/spec/#bucket-transform-details) 関数を追加。[`bucket transfom`](https://iceberg.apache.org/spec/#partitioning) でパーティション分割された `Iceberg` テーブルに対するデータファイルのプルーニングをサポート。[#79262](https://github.com/ClickHouse/ClickHouse/pull/79262) ([Daniil Ivanik](https://github.com/divanik))。
* Coalescing Merge Tree のサポートを追加。これにより [#78869](https://github.com/ClickHouse/ClickHouse/issues/78869) がクローズされます。 [#79344](https://github.com/ClickHouse/ClickHouse/pull/79344)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* ランダムまたは暗号化されている可能性のあるデータを検索するための `stringBytesUniq` 関数と `stringBytesEntropy` 関数を追加しました。 [#79350](https://github.com/ClickHouse/ClickHouse/pull/79350) ([Sachin Kumar Singh](https://github.com/sachinkumarsingh092))。
* MergeTree ファミリーのテーブルで `_part_starting_offset` 仮想列がサポートされました。この列は、現在のパーツ一覧に基づいてクエリ時に計算される、それ以前のすべてのパーツの累積行数を表します。累積値はクエリ実行全体を通して保持され、パーツのプルーニング後も有効なままです。この挙動をサポートするため、関連する内部ロジックがリファクタリングされました。 [#79417](https://github.com/ClickHouse/ClickHouse/pull/79417) ([Amos Bird](https://github.com/amosbird)).
* 設定 `enable_shared_storage_snapshot_in_query` を追加し、1 つのクエリ内のすべてのサブクエリで同じストレージスナップショットを共有できるようにしました。これにより、クエリ内で同じテーブルが複数回参照される場合でも、そのテーブルからの読み取りの一貫性が保たれます。 [#79471](https://github.com/ClickHouse/ClickHouse/pull/79471) ([Amos Bird](https://github.com/amosbird))。
* CH の `JSON` 列を `Parquet` に書き出し、`Parquet` の `JSON` 列を CH の `JSON` 列として直接読み取れるようにしました。 [#79649](https://github.com/ClickHouse/ClickHouse/pull/79649) ([Nihal Z. Miaji](https://github.com/nihalzp)).
* [`chdig`](https://github.com/azat/chdig/) を ClickHouse の一部として同梱しました。これは ClickHouse 用の TUI インターフェイス（`top` ライクなツール）です。 [#79666](https://github.com/ClickHouse/ClickHouse/pull/79666) ([Azat Khuzhin](https://github.com/azat))。
* `pointInPolygon` に `MultiPolygon` のサポートを追加しました。 [#79773](https://github.com/ClickHouse/ClickHouse/pull/79773) ([Nihal Z. Miaji](https://github.com/nihalzp)).
* Geo Parquet をサポートしました。これにより [#75317](https://github.com/ClickHouse/ClickHouse/issues/75317) がクローズされました。[#79777](https://github.com/ClickHouse/ClickHouse/pull/79777)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* ローカルファイルシステムにマウントされた Delta テーブルを `deltaLakeLocal` テーブル関数経由でクエリできるようにするサポートを追加しました。 [#79781](https://github.com/ClickHouse/ClickHouse/pull/79781) ([roykim98](https://github.com/roykim98)).
* Base32 のエンコード／デコード機能を追加しました。 [#79809](https://github.com/ClickHouse/ClickHouse/pull/79809) ([Joanna Hulboj](https://github.com/jh0x)).
* ClickHouse のベクトル検索は、プリフィルタリングとポストフィルタリングの両方をサポートし、より細かな制御のための関連設定も提供するようになりました (issue [#78161](https://github.com/ClickHouse/ClickHouse/issues/78161)). [#79854](https://github.com/ClickHouse/ClickHouse/pull/79854) ([Shankar Iyer](https://github.com/shankar-iyer)).
* WKB フォーマットの読み取りをサポートする関数を追加しました。これにより [#43941](https://github.com/ClickHouse/ClickHouse/issues/43941) が一部解決されます。 [#80139](https://github.com/ClickHouse/ClickHouse/pull/80139) ([Konstantin Vedernikov](https://github.com/scanhex12))。
* `cast_string_to_date_time_mode` という新しい設定を追加し、String からのキャスト時に DateTime のパースモードを選択できるようにしました。 [#80210](https://github.com/ClickHouse/ClickHouse/pull/80210) ([Pavel Kruglov](https://github.com/Avogar))。
* `Bech32` および `Bech32m` のエンコード／デコード関数を追加しました（issue [#40381](https://github.com/ClickHouse/ClickHouse/issues/40381)）。[#80239](https://github.com/ClickHouse/ClickHouse/pull/80239)（[George Larionov](https://github.com/glarik)）。
* Atomic および Ordinary DB エンジンで `disk` 設定をサポートし、テーブルのメタデータファイルを保存するディスクを指定できるようにしました。 [#80546](https://github.com/ClickHouse/ClickHouse/pull/80546) ([Tuan Pham Anh](https://github.com/tuanpach))。
* MergeTree パーツを展開して比較するためのサポート関数を追加。 [#80573](https://github.com/ClickHouse/ClickHouse/pull/80573) ([Mikhail Artemenko](https://github.com/Michicosun)).
* `timeSeries*` ヘルパー関数により、時系列データを扱う際の一部のユースケースを高速化します。- 指定した開始タイムスタンプ、終了タイムスタンプ、ステップに基づいてデータを時間グリッドに再サンプリングする - PromQL 風の `delta`、`rate`、`idelta`、`irate` を計算する。[#80590](https://github.com/ClickHouse/ClickHouse/pull/80590)（[Alexander Gololobov](https://github.com/davenger)）。
* クエリ対象として選択されるパーツを、それらが配置されているディスクでフィルタリングできるようにしました。 [#80650](https://github.com/ClickHouse/ClickHouse/pull/80650) ([tanner-bruce](https://github.com/tanner-bruce)).
* 組み込み Web ツールの一覧を表示するランディングページを追加しました。ブラウザ類似のユーザーエージェントからのリクエスト時に開きます。 [#81129](https://github.com/ClickHouse/ClickHouse/pull/81129) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `arrayFirst`、`arrayFirstIndex`、`arrayLast`、`arrayLastIndex` で `NULL` 値をフィルタリングできるようにしました。[#81113](https://github.com/ClickHouse/ClickHouse/issues/81113) を修正。[#81197](https://github.com/ClickHouse/ClickHouse/pull/81197)（[Lennard Eijsackers](https://github.com/Blokje5)）。





## 実験的機能 {#experimental-feature}

- Icebergデータレイク用のHiveメタストアカタログ。[#77677](https://github.com/ClickHouse/ClickHouse/pull/77677) ([Konstantin Vedernikov](https://github.com/scanhex12))。
- キーバリューペアによる明示的なパラメータがサポートされました。現在サポートされているパラメータは、必須の`tokenizer`と、オプションの`max_rows_per_postings_list`および`ngram_size`の2つです。[#80262](https://github.com/ClickHouse/ClickHouse/pull/80262) ([Elmi Ahmadov](https://github.com/ahmadov))。
- `gin`型の実験的インデックスは`text`に名称変更されました。既存の`gin`型インデックスは読み込み可能ですが、検索で使用しようとすると例外がスローされます(代わりに`text`インデックスの使用が推奨されます)。[#80855](https://github.com/ClickHouse/ClickHouse/pull/80855) ([Robert Schulze](https://github.com/rschu1ze))。


## パフォーマンスの向上 {#performance-improvement}


* 複数の granule に対して一度に式を評価することで、セカンダリインデックスの処理を高速化しました。 [#64109](https://github.com/ClickHouse/ClickHouse/pull/64109) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 右側テーブルのサイズがしきい値未満の場合に `hash` アルゴリズムにフォールバックするためのしきい値を導入しました（設定 `parallel_hash_join_threshold` で制御）。[#76185](https://github.com/ClickHouse/ClickHouse/pull/76185)（[Nikita Taranov](https://github.com/nickitat)）。
* 既存の `Pipe::resize` の実装では、パイプラインのトポロジに `Resize` または `StrictResize` ノードを 1 つ挿入して作成し、このノードがすべての入力ストリーム（上流ノード）を単一の出力ストリーム集合（下流ノード）へ接続する中央ハブとして機能します。この設計により、特にコア数の多い環境では、パイプライン・グラフの実行中に `ExecutingGraph::Node::status_mutex` を巡る競合が発生します。パイプラインが数十から数百のストリームにスケールすると、この競合により次のような結果が生じます。 [#77562](https://github.com/ClickHouse/ClickHouse/pull/77562) ([Zhiguo Zhou](https://github.com/ZhiguoZh)).
* `S3Queue` / `AzureQueue` のパフォーマンスを向上しました。キュー設定 `parallel_inserts=true` を有効にすることで、`INSERT` データを並列で実行できるようになりました。これまでは `S3Queue` / `AzureQueue` はパイプラインの前半部分（ダウンロードとパース）のみを並列化でき、`INSERT` は単一スレッドで実行されていました。また、`INSERT` がほぼ常にボトルネックとなっていました。今回の変更により、`processing_threads_num` に応じてほぼ線形にスケールするようになります。 [#77671](https://github.com/ClickHouse/ClickHouse/pull/77671) ([Azat Khuzhin](https://github.com/azat))。
* コンパクトパート形式を変更し、各サブストリームごとにマークを保存して個々のサブカラムを読み取れるようにしました。旧コンパクト形式は読み取りでは引き続きサポートされており、MergeTree 設定 `write_marks_for_substreams_in_compact_parts` を使用することで書き込みにも有効化できます。コンパクトパートのストレージ形式が変わるため、アップグレードをより安全に行う目的で、デフォルトでは無効になっています。今後のいずれかのリリースでデフォルト有効化される予定です。 [#77940](https://github.com/ClickHouse/ClickHouse/pull/77940) ([Pavel Kruglov](https://github.com/Avogar))。
* 新しい設定 `use_skip_indexes_in_final_exact_mode` を導入しました。`ReplacingMergeTree` テーブルに対するクエリで `FINAL` 句が指定されている場合、スキップインデックスに基づいてテーブル範囲のみを読み取ると、誤った結果が返される可能性があります。この設定により、スキップインデックスによって返された主キー範囲と重なり合う、より新しいパーツをスキャンすることで、正しい結果が返されるようにできます。0 に設定すると無効、1 に設定すると有効になります。 [#78350](https://github.com/ClickHouse/ClickHouse/pull/78350) ([Shankar Iyer](https://github.com/shankar-iyer)).
* パラレルレプリカを有効にした読み取りにおけるタスクサイズを、レプリカ数に基づいて決定するようにしました。これにより、読み取るデータ量がそれほど大きくない場合でも、レプリカ間の作業負荷分散が改善されます。 [#78695](https://github.com/ClickHouse/ClickHouse/pull/78695) ([Nikita Taranov](https://github.com/nickitat))。
* 分散集約の最終ステージで、`uniqExact` の状態を並列にマージできるようにしました。[#78703](https://github.com/ClickHouse/ClickHouse/pull/78703)（[Nikita Taranov](https://github.com/nickitat)）。
* キー付き集約における `uniqExact` 状態の並列マージで発生しうるパフォーマンス低下を修正。 [#78724](https://github.com/ClickHouse/ClickHouse/pull/78724) ([Nikita Taranov](https://github.com/nickitat)).
  #* `DELETE FROM ... WHERE 1` クエリを `TRUNCATE` に置き換え。 (ロールバック済み)。 [#78739](https://github.com/ClickHouse/ClickHouse/pull/78739) ([Konstantin Vedernikov](https://github.com/scanhex12)).
* Azure Storage に対する List Blobs API 呼び出し回数を削減。 [#78860](https://github.com/ClickHouse/ClickHouse/pull/78860) ([Julia Kartseva](https://github.com/jkartseva)).
* ハッシュテーブルのキーとして利用できるようにするため、可能であればフィルタークエリプランステップの等価条件を `JOIN` 条件にマージするようにしました。 [#78877](https://github.com/ClickHouse/ClickHouse/pull/78877) ([Dmitry Novik](https://github.com/novikd)).
* `regex` の代わりに `extractKeyValuePairs` を使用することで、Hive パス解析のパフォーマンスを向上。 [#79067](https://github.com/ClickHouse/ClickHouse/pull/79067) ([Arthur Passos](https://github.com/arthurpassos)).
* 並列レプリカを用いる分散 `INSERT SELECT` のパフォーマンスを改善しました。 [#79441](https://github.com/ClickHouse/ClickHouse/pull/79441) ([Azat Khuzhin](https://github.com/azat))。
* サブカラムを含む条件を `PREWHERE` に移動できるようになりました。 [#79489](https://github.com/ClickHouse/ClickHouse/pull/79489) ([Pavel Kruglov](https://github.com/Avogar))。
* すべての Bloom Filter タイプのパフォーマンスを改善しました。 [#79800](https://github.com/ClickHouse/ClickHouse/pull/79800) ([Delyan Kratunov](https://github.com/dkratunov)).
* `LogSeriesLimiter` がインスタンス生成のたびにクリーンアップを行わないようにし、高い同時実行シナリオでのロック競合とパフォーマンス低下を回避します。 [#79864](https://github.com/ClickHouse/ClickHouse/pull/79864) ([filimonov](https://github.com/filimonov)).
* 通常の式の一部を JIT コンパイルする `compile_expressions` をデフォルトで有効にしました。これにより [#51264](https://github.com/ClickHouse/ClickHouse/issues/51264)、[#56386](https://github.com/ClickHouse/ClickHouse/issues/56386)、[#66486](https://github.com/ClickHouse/ClickHouse/issues/66486) が解決されました。[#79907](https://github.com/ClickHouse/ClickHouse/pull/79907)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 単純な COUNT 最適化によりクエリを高速化しました。 [#79945](https://github.com/ClickHouse/ClickHouse/pull/79945) ([Raúl Marín](https://github.com/Algunenano)).
* `UniqExactSet::merge` において、一方の集合が空の場合のハッピーパスを導入しました。また、LHS の集合が two-level で RHS が single-level の場合には、RHS を two-level に変換しないようにしました。 [#79971](https://github.com/ClickHouse/ClickHouse/pull/79971) ([Nikita Taranov](https://github.com/nickitat))。
* `convertDecimalsImpl` に `__attribute__((always_inline))` を追加。 [#79999](https://github.com/ClickHouse/ClickHouse/pull/79999) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* `input_format_parquet_bloom_filter_push_down` をデフォルトで true に設定しました。また、設定変更履歴内の誤りを修正しました。 [#80058](https://github.com/ClickHouse/ClickHouse/pull/80058) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* ログ出力をデフォルトで非同期にしました。`<logger>` 配下で `<async>false</async>` を設定することで無効化できます。 [#80125](https://github.com/ClickHouse/ClickHouse/pull/80125) ([Raúl Marín](https://github.com/Algunenano)).
* 二段階ハッシュテーブル使用時のメモリ再利用効率を向上し、ページフォールトを削減しました。 [#80245](https://github.com/ClickHouse/ClickHouse/pull/80245) ([Jiebin Sun](https://github.com/jiebinn)).
* `QueryConditionCache` において不要な更新を回避し、ロック競合を低減しました。 [#80247](https://github.com/ClickHouse/ClickHouse/pull/80247) ([Jiebin Sun](https://github.com/jiebinn)).
* `concatenateBlocks` を小規模に最適化しました。並列 Hash join に役立つ可能性があります。 [#80328](https://github.com/ClickHouse/ClickHouse/pull/80328) ([李扬](https://github.com/taiyang-li)).
* 主キー範囲からマーク範囲を選択する際、主キーが関数でラップされている場合は二分探索を使用できませんでした。このPRにより、この制限が改善されました。主キーが常に単調な関数のチェーンでラップされている場合、あるいはRPNに常に真となる要素が含まれている場合でも、二分探索を適用できるようになりました。このPRは [#45536](https://github.com/ClickHouse/ClickHouse/issues/45536) をクローズします。 [#80597](https://github.com/ClickHouse/ClickHouse/pull/80597)（[zoomxi](https://github.com/zoomxi)）。
* Kafka エンジンのシャットダウン速度を改善しました（複数の Kafka テーブルがある場合に発生していた余分な 3 秒の遅延を除去しました）。 [#80796](https://github.com/ClickHouse/ClickHouse/pull/80796) ([Azat Khuzhin](https://github.com/azat)).
* 非同期 insert のメモリ使用量を削減し、insert クエリのパフォーマンスを向上しました。 [#80972](https://github.com/ClickHouse/ClickHouse/pull/80972) ([Raúl Marín](https://github.com/Algunenano)).
* ログテーブルが無効な場合はプロセッサをプロファイルしないようにしました。 [#81256](https://github.com/ClickHouse/ClickHouse/pull/81256) ([Raúl Marín](https://github.com/Algunenano)).
* ソースが要求された長さと完全に一致している場合に `toFixedString` を高速化しました。 [#81257](https://github.com/ClickHouse/ClickHouse/pull/81257) ([Raúl Marín](https://github.com/Algunenano)).
* ユーザーに制限がない場合はクォータ値を処理しないようにしました。 [#81549](https://github.com/ClickHouse/ClickHouse/pull/81549) ([Raúl Marín](https://github.com/Algunenano)).
* `ProcfsMetricsProvider` を `thread_local` にして、タスク間でファイルを開いたままに保つようにしました。 [#81576](https://github.com/ClickHouse/ClickHouse/pull/81576) ([Raúl Marín](https://github.com/Algunenano))。
* メモリトラッキングにおけるパフォーマンスの退行を修正しました。 [#81694](https://github.com/ClickHouse/ClickHouse/pull/81694) ([Michael Kolupaev](https://github.com/al13n321)).





## 改善 {#improvement}


#* `clickhouse-local` は、`--path` コマンドライン引数を指定することで、再起動後もデータベースを保持します。これにより [#50647](https://github.com/ClickHouse/ClickHouse/issues/50647) が解決されます。これにより [#49947](https://github.com/ClickHouse/ClickHouse/issues/49947) が解決されます。[#71722](https://github.com/ClickHouse/ClickHouse/pull/71722) ([Alexey Milovidov](https://github.com/alexey-milovidov))。

* `EXPLAIN SYNTAX` は新しいアナライザーを使用するようになりました。これにより、クエリツリーから構築された抽象構文木 (AST) を返します。クエリツリーを AST に変換する前に実行されるパスの回数を制御するためのオプション `query_tree_passes` を追加しました。 [#74536](https://github.com/ClickHouse/ClickHouse/pull/74536) ([Vladimir Cherkasov](https://github.com/vdimir)).
  #* filesystem cache で、デフォルトで SLRU キャッシュポリシーを使用するようにしました。 [#75072](https://github.com/ClickHouse/ClickHouse/pull/75072) ([Kseniia Sumarokova](https://github.com/kssenii)).
* ビューへのプッシュ処理のロジックをリファクタリングしました。 [#77309](https://github.com/ClickHouse/ClickHouse/pull/77309) ([Sema Checherinda](https://github.com/CheSema)).
* オブジェクトストレージクラスタテーブル関数（例: `s3Cluster`）では、キャッシュ局所性を向上させるため、一貫ハッシュに基づいて読み取り用ファイルをレプリカに割り当てるようになりました。 [#77326](https://github.com/ClickHouse/ClickHouse/pull/77326) ([Andrej Hoos](https://github.com/adikus))。
* `AuthenticationRequired` エラー発生後に S3 クレデンシャルをリフレッシュするようにしました。 [#77353](https://github.com/ClickHouse/ClickHouse/pull/77353) ([Vitaly Baranov](https://github.com/vitlibar))。
* 一部の HTTP バッファに、ビルダーを利用してプロキシ設定を埋め込めるようにしました。 [#77693](https://github.com/ClickHouse/ClickHouse/pull/77693) ([Arthur Passos](https://github.com/arthurpassos)).
* `system.asynchronous_metrics` にディクショナリ関連のメトリクスを追加: `DictionaryMaxUpdateDelay` - ディクショナリ更新の最大遅延時間（秒）。`DictionaryTotalFailedUpdates` - 直近の正常な読み込み以降、すべてのディクショナリで発生したエラーの総数。 [#78175](https://github.com/ClickHouse/ClickHouse/pull/78175) ([Vlad](https://github.com/codeworse)).
* 右辺引数がゼロのときに NULL を返す関数 `divideOrNull`、`moduloOrNull`、`intDivOrNull`、`positiveModuloOrNull` を追加しました。 [#78276](https://github.com/ClickHouse/ClickHouse/pull/78276) ([kevinyhzou](https://github.com/KevinyhZou)).
* `isIPAddressInRange` 関数の対応データ型を String、IPv4、IPv6、Nullable(String)、Nullable(IPv4)、Nullable(IPv6) に拡張しました。 [#78364](https://github.com/ClickHouse/ClickHouse/pull/78364) ([YjyJeff](https://github.com/YjyJeff)).
* PostgreSQL エンジンのコネクションプーラー設定を動的に変更できるようになりました。 [#78414](https://github.com/ClickHouse/ClickHouse/pull/78414) ([Samay Sharma](https://github.com/samay-sharma)).
* 通常のプロジェクションで `_part_offset` を指定できるようにしました。これはプロジェクションインデックスを構築するための最初のステップです。[#58224](https://github.com/ClickHouse/ClickHouse/issues/58224) と組み合わせて使用でき、[https://github.com/ClickHouse/ClickHouse/pull/63207](https://github.com/ClickHouse/ClickHouse/pull/63207) の改善に役立ちます。[#78429](https://github.com/ClickHouse/ClickHouse/pull/78429)（[Amos Bird](https://github.com/amosbird)）。
* 分散クエリにおけるシャーディングキーの最適化を向上。 [#78452](https://github.com/ClickHouse/ClickHouse/pull/78452) ([fhw12345](https://github.com/fhw12345)).
* `system.named_collections` に新しいカラム（`create_query` と `source`）を追加。 [#78179](https://github.com/ClickHouse/ClickHouse/issues/78179) をクローズ。 [#78582](https://github.com/ClickHouse/ClickHouse/pull/78582)（[MikhailBurdukov](https://github.com/MikhailBurdukov)）。
* `system.query_condition_cache` システムテーブルにフィールド `condition` を追加しました。このフィールドには、クエリ条件キャッシュでキーとして使用されるハッシュの元となるプレーンテキストの条件が保存されます。 [#78671](https://github.com/ClickHouse/ClickHouse/pull/78671) ([Robert Schulze](https://github.com/rschu1ze))。
* ClickHouse Keeper を使用して StorageKafka2 向けに、Kafka のリバランスに類似したロジックを実装します。各レプリカでは、永続ロックと一時ロックという 2 種類のパーティションロックをサポートします。レプリカは可能な限り長く永続ロックを保持しようとし、任意の時点でレプリカ上の永続ロック数が `all_topic_partitions / active_replicas_count`（ここで `all_topic_partitions` はすべてのパーティション数、`active_replicas_count` はアクティブなレプリカ数）を超えることはありません。もしそれ以上になった場合、レプリカはいくつかのパーティションを解放します。一部のパーティションはレプリカによって一時的に保持されます。レプリカ上の一時ロックの最大数は動的に変化し、他のレプリカが一部のパーティションを永続ロックとして取得できるようにします。一時ロックを更新する際、レプリカはいったんそれらをすべて解放し、そのうえで別のパーティションを再取得しようとします。 [#78726](https://github.com/ClickHouse/ClickHouse/pull/78726) ([Daria Fomina](https://github.com/sinfillo))。
* `Kafka` テーブルエンジンに、SASL 構成および認証情報用のテーブル設定を追加しました。これにより、設定ファイルや named collections を使用せずに、`CREATE TABLE` ステートメント内で直接、Kafka および Kafka 互換システムへの SASL ベースの認証を構成できるようになります。 [#78810](https://github.com/ClickHouse/ClickHouse/pull/78810) ([Christoph Wurm](https://github.com/cwurm)).
* 破損したテーブルを保存する目的で作成された可能性のあるデータベースについて、警告を追加。 [#78841](https://github.com/ClickHouse/ClickHouse/pull/78841) ([János Benjamin Antal](https://github.com/antaljanosbenjamin)).
* `BFloat16` 列に対してベクトル類似性インデックスを作成できるようになりました。 [#78850](https://github.com/ClickHouse/ClickHouse/pull/78850) ([Robert Schulze](https://github.com/rschu1ze))。
* `best_effort` の `DateTime64` パースで、小数部付きの Unix タイムスタンプをサポートしました。 [#78908](https://github.com/ClickHouse/ClickHouse/pull/78908) ([Pavel Kruglov](https://github.com/Avogar))。
* ストレージ DeltaLake の delta-kernel 実装において columnMappingMode.name を修正し、スキーマ進化向けのテストを追加しました。 [#78921](https://github.com/ClickHouse/ClickHouse/pull/78921) ([Kseniia Sumarokova](https://github.com/kssenii))。
* `Values` フォーマットでの `Variant` 列への挿入時に、値の変換を改善。[#78923](https://github.com/ClickHouse/ClickHouse/pull/78923) ([Pavel Kruglov](https://github.com/Avogar)).
* `S3Queue` エンジンに `_time` 仮想カラムを追加。 [#78926](https://github.com/ClickHouse/ClickHouse/pull/78926) ([Anton Ivashkin](https://github.com/ianton-ru))。
* `tokens` 関数が拡張され、追加の「tokenizer」引数と、さらにトークナイザー固有の引数を受け取れるようになりました。 [#79001](https://github.com/ClickHouse/ClickHouse/pull/79001) ([Elmi Ahmadov](https://github.com/ahmadov))。
* `SHOW CLUSTER` ステートメントは、引数内のマクロ（存在する場合）を展開するようになりました。 [#79006](https://github.com/ClickHouse/ClickHouse/pull/79006) ([arf42](https://github.com/arf42))。
* ハッシュ関数が、配列、タプル、マップ内の `NULL` をサポートするようになりました（issues [#48365](https://github.com/ClickHouse/ClickHouse/issues/48365) および [#48623](https://github.com/ClickHouse/ClickHouse/issues/48623)）。[#79008](https://github.com/ClickHouse/ClickHouse/pull/79008)（[Michael Kolupaev](https://github.com/al13n321)）。
* 読み取り専用の MergeTree テーブルでのリフレッシュをサポート。 [#79033](https://github.com/ClickHouse/ClickHouse/pull/79033) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* cctz を 2025a に更新。 [#79043](https://github.com/ClickHouse/ClickHouse/pull/79043) ([Raúl Marín](https://github.com/Algunenano)).
* CPU 過負荷時の接続ドロップを制御する設定をホットリロード可能にしました。 [#79052](https://github.com/ClickHouse/ClickHouse/pull/79052) ([Alexey Katsman](https://github.com/alexkats))。
* 使いやすくなります。 [#79066](https://github.com/ClickHouse/ClickHouse/pull/79066) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* クエリ条件キャッシュをデフォルトで有効化します。 [#79080](https://github.com/ClickHouse/ClickHouse/pull/79080) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
  #* Web UI でタブを取り消し可能にします。これにより [#71284](https://github.com/ClickHouse/ClickHouse/issues/71284) がクローズされます。 [#79084](https://github.com/ClickHouse/ClickHouse/pull/79084) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* `recoverLostReplica` 中の設定を、[https://github.com/ClickHouse/ClickHouse/pull/78637](https://github.com/ClickHouse/ClickHouse/pull/78637) の場合と同様に削除しました。[#79113](https://github.com/ClickHouse/ClickHouse/pull/79113)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* ProfileEvents `ParquetReadRowGroups` と `ParquetPrunedRowGroups` を追加し、Parquet インデックスのプルーニングをプロファイルできるようにしました。 [#79180](https://github.com/ClickHouse/ClickHouse/pull/79180) ([flynn](https://github.com/ucasfl)).
* Azure Blob Storage 上の plain disk について、`system.tables` で報告されるデータパスにコンテナプレフィックスを追加し、S3 および GCP と一貫したレポートになるようにしました。 [#79241](https://github.com/ClickHouse/ClickHouse/pull/79241) ([Julia Kartseva](https://github.com/jkartseva)).
* `ON CLUSTER` を指定したデータベースの変更をサポート。[#79242](https://github.com/ClickHouse/ClickHouse/pull/79242)（[Tuan Pham Anh](https://github.com/tuanpach)）。
* QueryMetricLog の統計収集で取りこぼした実行分を明示的にスキップしないと、ログが現在時刻に追いつくまでに非常に長い時間がかかる可能性があります。 [#79257](https://github.com/ClickHouse/ClickHouse/pull/79257) ([Mikhail Artemenko](https://github.com/Michicosun)).
* `lightweight_deletes_sync = 0`、`apply_mutations_on_fly = 1` の設定により、軽量削除をオンザフライで適用できるようになりました。 [#79281](https://github.com/ClickHouse/ClickHouse/pull/79281) ([Anton Popov](https://github.com/CurtizJ)).
* すべての行を削除することになるパーツに対する `ALTER ... DELETE` ミューテーションを最適化しました。このような場合、ミューテーションを実行せずに元のパーツの代わりに空のパーツが作成されるようになりました。 [#79307](https://github.com/ClickHouse/ClickHouse/pull/79307) ([Anton Popov](https://github.com/CurtizJ)).
* `CHColumnToArrowColumn` のちょっとした最適化。 [#79308](https://github.com/ClickHouse/ClickHouse/pull/79308) ([Bharat Nallan](https://github.com/bharatnc))。
* 設定 `allow_archive_path_syntax` は誤って experimental としてマークされていました。experimental な設定がデフォルトで有効になってしまうのを防ぐテストを追加しました。 [#79320](https://github.com/ClickHouse/ClickHouse/pull/79320) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* ページキャッシュ設定をクエリ単位で調整可能にしました。これは、より高速な検証を行えるようにし、高スループットかつ低レイテンシなクエリ向けに細かくチューニングできるようにするために必要です。 [#79337](https://github.com/ClickHouse/ClickHouse/pull/79337) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 64 ビットハッシュのほとんどのように見える数値に対しては、数値ヒントを見やすい形式で出力しないようにしました。これにより [#79334](https://github.com/ClickHouse/ClickHouse/issues/79334) が解決されました。[#79338](https://github.com/ClickHouse/ClickHouse/pull/79338)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* pretty フォーマットのデータがターミナルに表示されていて、その後続ブロックが同じカラム幅を持つ場合、カーソルを上に移動して前のブロックに「貼り付ける」ことで前のブロックの続きとして表示できます。これにより [#79333](https://github.com/ClickHouse/ClickHouse/issues/79333) が解決されます。この機能は新しい設定 `output_format_pretty_glue_chunks` によって制御されます。[#79339](https://github.com/ClickHouse/ClickHouse/pull/79339)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 詳細ダッシュボード上のグラフの色は、対応するクエリのハッシュから計算されるようになりました。これにより、ダッシュボードをスクロールしているときに、目的のグラフを記憶しやすく、見つけやすくなります。 [#79341](https://github.com/ClickHouse/ClickHouse/pull/79341) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 非同期メトリクス `FilesystemCacheCapacity` を追加しました。これは `cache` 仮想ファイルシステムの総容量を表します。グローバルなインフラストラクチャ監視に役立ちます。[#79348](https://github.com/ClickHouse/ClickHouse/pull/79348)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* system.parts へのアクセスを最適化（要求された場合にのみカラム／インデックスのサイズを読み取る）。 [#79352](https://github.com/ClickHouse/ClickHouse/pull/79352) ([Azat Khuzhin](https://github.com/azat)).
* `SHOW CLUSTER &lt;name&gt;` クエリに対して、すべてのフィールドではなく重要なフィールドのみを選択するようにしました。 [#79368](https://github.com/ClickHouse/ClickHouse/pull/79368) ([Tuan Pham Anh](https://github.com/tuanpach)).
* `DatabaseCatalog` のストレージ設定を指定できるようにしました。 [#79407](https://github.com/ClickHouse/ClickHouse/pull/79407) ([Kseniia Sumarokova](https://github.com/kssenii)).
* delta kernel でローカルストレージをサポートしました。 [#79416](https://github.com/ClickHouse/ClickHouse/pull/79416) ([Kseniia Sumarokova](https://github.com/kssenii)).
* クエリレベルの設定 `allow_experimental_delta_kernel_rs` を追加し、delta-kernel-rs を有効化できるようにしました。 [#79418](https://github.com/ClickHouse/ClickHouse/pull/79418) ([Kseniia Sumarokova](https://github.com/kssenii)).
* Azure/S3 BLOB ストレージからの BLOB 一覧取得時に発生し得る無限ループを修正。 [#79425](https://github.com/ClickHouse/ClickHouse/pull/79425) ([Alexander Gololobov](https://github.com/davenger)).
* 現在、ClickHouse はクエリパラメータとして `param_<name>`（アンダースコア）に加えて `param-<name>`（ダッシュ）も受け付けるようになりました。これにより [#63093](https://github.com/ClickHouse/ClickHouse/issues/63093) がクローズされました。 [#79429](https://github.com/ClickHouse/ClickHouse/pull/79429) ([Engel Danila](https://github.com/aaaengel))。
  #* ファイルシステムキャッシュ設定 `max_size_ratio_to_total_space` を追加しました。 [#79460](https://github.com/ClickHouse/ClickHouse/pull/79460) ([Kseniia Sumarokova](https://github.com/kssenii))。
* チェックサム有効時にローカルからリモート S3 へデータをコピーする場合の帯域幅ディスカウントに関する詳細な警告メッセージ。 [#79464](https://github.com/ClickHouse/ClickHouse/pull/79464) ([VicoWu](https://github.com/VicoWu)).
* `clickhouse-benchmark` の `reconnect` オプションを再構成し、再接続の設定に応じて 0、1、または N を値として指定できるようにしました。 [#79465](https://github.com/ClickHouse/ClickHouse/pull/79465) ([Sachin Kumar Singh](https://github.com/sachinkumarsingh092)).
* `input_format_max_block_size_bytes` 設定を追加し、入力フォーマットで作成されるブロックのサイズをバイト単位で制限できるようにしました。これにより、行に大きな値が含まれている場合のデータインポート時の過度なメモリ使用量を回避するのに役立ちます。 [#79495](https://github.com/ClickHouse/ClickHouse/pull/79495) ([Pavel Kruglov](https://github.com/Avogar)).
* sparseGrams の速度とメモリ使用量を改善しました。 [#79517](https://github.com/ClickHouse/ClickHouse/pull/79517) ([Konstantin Vedernikov](https://github.com/scanhex12)).
* 可能な場合、Compact パーツへの挿入時にブロックを余分にコピーしないようにしました。 [#79536](https://github.com/ClickHouse/ClickHouse/pull/79536) ([Pavel Kruglov](https://github.com/Avogar)).
* `DeltaLake` ストレージの delta-kernel 実装をデフォルトで有効にしました。 [#79541](https://github.com/ClickHouse/ClickHouse/pull/79541) ([Kseniia Sumarokova](https://github.com/kssenii)).
* URL から読み込む際に複数回のリダイレクトが発生する場合、`enable_url_encoding` の設定はリダイレクトチェーン全体に正しく適用されます。 [#79563](https://github.com/ClickHouse/ClickHouse/pull/79563) ([Shankar Iyer](https://github.com/shankar-iyer)).
* 異なる plain&#95;rewritable ディスク上にあるテーブル間で `ALTER TABLE ... MOVE|REPLACE PARTITION` を許可。 [#79566](https://github.com/ClickHouse/ClickHouse/pull/79566) ([Julia Kartseva](https://github.com/jkartseva)).
* `WHERE` 句でのスカラー相関サブクエリをサポート。 [#6697](https://github.com/ClickHouse/ClickHouse/issues/6697) をクローズ。 [#79600](https://github.com/ClickHouse/ClickHouse/pull/79600)（[Dmitry Novik](https://github.com/novikd)）。
* 以前は `input_format_parquet_max_block_size = 0` の場合に ClickHouse がハングしていましたが、この問題は修正されました。これにより [#79394](https://github.com/ClickHouse/ClickHouse/issues/79394) がクローズされました。 [#79601](https://github.com/ClickHouse/ClickHouse/pull/79601) ([abashkeev](https://github.com/abashkeev)).
* `startup_scripts` 用の `throw_on_error` 設定を追加しました。`throw_on_error` が true の場合、すべてのクエリが正常に完了しない限りサーバーは起動しません。デフォルトでは `throw_on_error` は false であり、これまでの動作が維持されます。 [#79732](https://github.com/ClickHouse/ClickHouse/pull/79732) ([Aleksandr Musorin](https://github.com/AVMusorin)).
* 参照ベクトルが `Array(BFloat16)` 型の場合にも、ベクトル類似度インデックスが使用されるようになりました。 [#79745](https://github.com/ClickHouse/ClickHouse/pull/79745) ([Shankar Iyer](https://github.com/shankar-iyer)).
* `system.error_log` テーブルに `last_error_message`、`last_error_trace`、`query_id` を追加しました。関連チケット [#75816](https://github.com/ClickHouse/ClickHouse/issues/75816)。 [#79836](https://github.com/ClickHouse/ClickHouse/pull/79836) ([Andrei Tinikov](https://github.com/Dolso))。
  #* クラッシュレポートの送信をデフォルトで有効にしました。これはサーバーの設定ファイルで無効にできます。 [#79838](https://github.com/ClickHouse/ClickHouse/pull/79838) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* システムテーブル `system.functions` に、各関数が最初に導入された ClickHouse バージョンが表示されるようになりました。 [#79839](https://github.com/ClickHouse/ClickHouse/pull/79839) ([Robert Schulze](https://github.com/rschu1ze))。
* `access_control_improvements.enable_user_name_access_type` 設定を追加しました。この設定により、[https://github.com/ClickHouse/ClickHouse/pull/72246](https://github.com/ClickHouse/ClickHouse/pull/72246) で導入されたユーザー／ロールに対する厳密な `GRANT` を有効／無効にできます。レプリカの一部がバージョン 25.1 より古いクラスタを使用している場合は、この設定を無効にすることを検討してください。[#79842](https://github.com/ClickHouse/ClickHouse/pull/79842)（[pufit](https://github.com/pufit)）。
* `ASTSelectWithUnionQuery::clone()` メソッドの正しい実装において、`is_normalized` フィールドも考慮されるようになりました。これにより [#77569](https://github.com/ClickHouse/ClickHouse/issues/77569) の解決に役立つ可能性があります。[#79909](https://github.com/ClickHouse/ClickHouse/pull/79909)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* 単純なケースで、射影リスト内の相関サブクエリをサポートしました。 [#79925](https://github.com/ClickHouse/ClickHouse/pull/79925) ([Dmitry Novik](https://github.com/novikd))。
* `EXCEPT` 演算子を含む一部のクエリで、フォーマットが一貫しない問題を修正しました。`EXCEPT` 演算子の左辺が `*` で終わる場合、フォーマット後のクエリから括弧が失われ、その結果、`EXCEPT` 修飾子付きの `*` としてパースされてしまいます。これらのクエリは fuzzer によって検出されたもので、実際に遭遇する可能性は低いと考えられます。この修正により [#79950](https://github.com/ClickHouse/ClickHouse/issues/79950) がクローズされました。[#79952](https://github.com/ClickHouse/ClickHouse/pull/79952)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 任意の種類の `http_handlers` に `http_response_headers` を追加できるようにしました。 [#79975](https://github.com/ClickHouse/ClickHouse/pull/79975) ([Andrey Zvonov](https://github.com/zvonand)).
* `JSON` 型のパースにおいて、バリアントのデシリアライズ順序のキャッシュを利用することで、わずかに改善しました。 [#79984](https://github.com/ClickHouse/ClickHouse/pull/79984) ([Pavel Kruglov](https://github.com/Avogar)).
* 適用可能な場合に、`GLOBAL [NOT] IN` 述語を `PREWHERE` 句へ移動できるようにしました。[#79996](https://github.com/ClickHouse/ClickHouse/pull/79996)（[Eduard Karacharov](https://github.com/korowa)）。
* `s3_slow_all_threads_after_network_error` 設定を追加。 [#80035](https://github.com/ClickHouse/ClickHouse/pull/80035) ([Vitaly Baranov](https://github.com/vitlibar)).
* マージ対象として選択されたパーツに関するログレベルが誤っていました（Information）。[#80061](https://github.com/ClickHouse/ClickHouse/issues/80061) をクローズします。[#80062](https://github.com/ClickHouse/ClickHouse/pull/80062)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `reverse` 関数が `Tuple` データ型をサポートするようになりました。[#80053](https://github.com/ClickHouse/ClickHouse/issues/80053) をクローズ。[#80083](https://github.com/ClickHouse/ClickHouse/pull/80083)（[flynn](https://github.com/ucasfl)）。
* `enble_url_encoding` のデフォルト値が `False` に変更されました。 [#80088](https://github.com/ClickHouse/ClickHouse/pull/80088) ([Shankar Iyer](https://github.com/shankar-iyer)).
* この小さなパッチにより、`system.zookeeper` テーブルから `auxiliary_zookeepers` データを取得できるようになり、[#75817](https://github.com/ClickHouse/ClickHouse/issues/75817) が解決されました。[#80146](https://github.com/ClickHouse/ClickHouse/pull/80146)（[Nikolay Govorov](https://github.com/mrdimidium)）。
* ベクトル類似性インデックスを用いたベクトル検索がベータ版になりました（以前は実験的機能）。 [#80164](https://github.com/ClickHouse/ClickHouse/pull/80164) ([Robert Schulze](https://github.com/rschu1ze)).
* サーバーの TCP ソケットに関する非同期メトリクスを追加しました。これにより可観測性が向上します。 [#80187](https://github.com/ClickHouse/ClickHouse/issues/80187) をクローズします。 [#80188](https://github.com/ClickHouse/ClickHouse/pull/80188)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 関数 `tokens` が、トークナイザーとして `string` をサポートするようになりました。 [#80195](https://github.com/ClickHouse/ClickHouse/pull/80195) ([Robert Schulze](https://github.com/rschu1ze)).
* Parallel replicas: すべての読み取りタスクが他のレプリカに割り当てられている場合、未使用の低速レプリカを待機しないようにしました。 [#80199](https://github.com/ClickHouse/ClickHouse/pull/80199) ([Igor Nikonov](https://github.com/devcrafter)).
* `simpleAggregateFunction` で `anylast_respect_nulls` と `any_respect_nulls` をサポートしました。 [#80219](https://github.com/ClickHouse/ClickHouse/pull/80219) ([Diskein](https://github.com/Diskein)).
* レプリケートされたデータベースに対する不要な `adjustCreateQueryForBackup()` の呼び出しを削除しました。[#80282](https://github.com/ClickHouse/ClickHouse/pull/80282)（[Vitaly Baranov](https://github.com/vitlibar)）。
* `SHOW ... LIKE` クエリ内のメタ文字をハイライト表示するようにしました。これにより [#80275](https://github.com/ClickHouse/ClickHouse/issues/80275) がクローズされました。 [#80297](https://github.com/ClickHouse/ClickHouse/pull/80297) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
  #* `clickhouse-local` で SQL UDF を永続化するようにしました。以前に作成された関数は起動時に読み込まれます。これにより [#80085](https://github.com/ClickHouse/ClickHouse/issues/80085) がクローズされました。 [#80300](https://github.com/ClickHouse/ClickHouse/pull/80300) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* `Time`/`Time64` 型同士の比較をサポートしました。 [#80327](https://github.com/ClickHouse/ClickHouse/pull/80327) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* `preliminary distinct` ステップの `EXPLAIN PLAN` における説明を修正しました。 [#80330](https://github.com/ClickHouse/ClickHouse/pull/80330) ([UnamedRus](https://github.com/UnamedRus)).
* ODBC/JDBC でネームドコレクションを使用できるようにしました。 [#80334](https://github.com/ClickHouse/ClickHouse/pull/80334) ([Andrey Zvonov](https://github.com/zvonand)).
* 複数プロジェクションによるフィルタリングをサポートし、パートレベルのフィルタリングで複数のプロジェクションを使用できるようにしました。これは [#55525](https://github.com/ClickHouse/ClickHouse/issues/55525) への対応です。これは、[#78429](https://github.com/ClickHouse/ClickHouse/issues/78429) に続くプロジェクションインデックス実装の第 2 段階です。[#80343](https://github.com/ClickHouse/ClickHouse/pull/80343)（[Amos Bird](https://github.com/amosbird)）。
* 読み取り専用ディスクおよび破損ディスクの数を示すメトリクス。DiskLocalCheckThread の起動時にインジケーターをログ出力します。 [#80391](https://github.com/ClickHouse/ClickHouse/pull/80391) ([VicoWu](https://github.com/VicoWu)).
* `projection` を伴う `s3_plain_rewritable` ストレージのサポートを実装しました。以前のバージョンでは、S3 内で `projection` を参照しているメタデータオブジェクトが移動されても更新されませんでした。[#70258](https://github.com/ClickHouse/ClickHouse/issues/70258) をクローズ。[#80393](https://github.com/ClickHouse/ClickHouse/pull/80393)（[Sav](https://github.com/sberss)）。
* Parallel replicas は、専用の接続タイムアウトを使用するようになりました。`parallel_replicas_connect_timeout_ms` 設定を参照してください。以前は、parallel replicas クエリの接続タイムアウト値として `connect_timeout_with_failover_ms` / `connect_timeout_with_failover_secure_ms` 設定が使用されていました（デフォルトは 1 秒）。[#80421](https://github.com/ClickHouse/ClickHouse/pull/80421) ([Igor Nikonov](https://github.com/devcrafter))。
* `SYSTEM UNFREEZE` コマンドは、`readonly` および `write-once` ディスク上のパーツを探索しようとしなくなりました。これにより [#80430](https://github.com/ClickHouse/ClickHouse/issues/80430) がクローズされました。[#80432](https://github.com/ClickHouse/ClickHouse/pull/80432)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* マージ済みパーツに関するメッセージのログレベルを INFO から TRACE に変更しました。 [#80476](https://github.com/ClickHouse/ClickHouse/pull/80476) ([Hans Krutzer](https://github.com/hkrutzer)).
* Native フォーマットで Dynamic および JSON 向けのフラット化シリアライゼーションを実装し、Dynamic の shared variant や JSON の shared data といった特別な構造を使用せずに Dynamic および JSON データをシリアライズ／デシリアライズできるようにしました。このシリアライゼーションは、`output_format_native_use_flattened_dynamic_and_json_serialization` を設定することで有効化できます。このシリアライゼーションは、さまざまな言語で実装されたクライアントで TCP プロトコル経由の Dynamic および JSON のサポートを容易にするために利用できます。[#80499](https://github.com/ClickHouse/ClickHouse/pull/80499)（[Pavel Kruglov](https://github.com/Avogar)）。
* Iceberg テーブルに対するパーティションプルーニングのデフォルト動作を変更。 [#80583](https://github.com/ClickHouse/ClickHouse/pull/80583) ([Melvyn Peignon](https://github.com/melvynator)).
* インデックス検索アルゴリズムの可観測性向けに、`IndexBinarySearchAlgorithm` と `IndexGenericExclusionSearchAlgorithm` という 2 つの新しい `ProfileEvents` を追加しました。 [#80679](https://github.com/ClickHouse/ClickHouse/pull/80679) ([Pablo Marcos](https://github.com/pamarcos))。
* 古いカーネルで未サポートな `MADV_POPULATE_WRITE` については、ログが汚染されないよう、ログに警告を出さないようにしました。[#80704](https://github.com/ClickHouse/ClickHouse/pull/80704) ([Robert Schulze](https://github.com/rschu1ze)).
* TTL で Date32 と DateTime64 がサポートされるようになりました。 [#80710](https://github.com/ClickHouse/ClickHouse/pull/80710) ([Andrey Zvonov](https://github.com/zvonand)).
* `max_merge_delayed_streams_for_parallel_write` の互換性に関する値を調整しました。 [#80760](https://github.com/ClickHouse/ClickHouse/pull/80760) ([Azat Khuzhin](https://github.com/azat)).
* クラッシュを修正: デストラクタ内で一時ファイル（ディスクへの一時データのスピルに使用される）を削除しようとした際に例外がスローされると、プログラムが異常終了する可能性がありました。 [#80776](https://github.com/ClickHouse/ClickHouse/pull/80776) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* `SYSTEM SYNC REPLICA` に `IF EXISTS` 修飾子を追加。 [#80810](https://github.com/ClickHouse/ClickHouse/pull/80810) ([Raúl Marín](https://github.com/Algunenano)).
* &quot;Having zero bytes, but read range is not finished...&quot; に関する例外メッセージを拡張し、`system.filesystem_cache` に `finished_download_time` 列を追加しました。[#80849](https://github.com/ClickHouse/ClickHouse/pull/80849)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* 以前は、フルテキストインデックスでは `packed` ストレージがサポートされていませんでした。これは、セグメント ID がディスク上の `.gin_sid` ファイルを読み書きすることでオンザフライに更新されていたためです。`packed` ストレージでは、未コミットなファイルから値を読み取ることがサポートされておらず、それが問題の原因となっていました。 [#80852](https://github.com/ClickHouse/ClickHouse/pull/80852) ([Elmi Ahmadov](https://github.com/ahmadov)).
* `indexes = 1` を指定して `EXPLAIN` を使用した場合、検索アルゴリズムに関するセクションが `EXPLAIN` の出力に追加されるようになりました。ここには「binary search」または「generic exclusion search」のいずれかが表示されます。[#80881](https://github.com/ClickHouse/ClickHouse/pull/80881) ([Pablo Marcos](https://github.com/pamarcos))。
* 2024年の初めには、新しい analyzer がデフォルトで有効になっていなかったため、MySQL handler に対して `prefer_column_name_to_alias` が True にハードコードされていました。現在は、このハードコードが解除されています。 [#80916](https://github.com/ClickHouse/ClickHouse/pull/80916) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* `system.iceberg_history` が、glue や iceberg rest などのカタログデータベースの履歴も表示するようになりました。また、一貫性のために、`system.iceberg_history` 内の `table_name` 列と `database_name` 列を、それぞれ `table` および `database` にリネームしました。 [#80975](https://github.com/ClickHouse/ClickHouse/pull/80975) ([alesapin](https://github.com/alesapin)).
* `merge` テーブル関数で読み取り専用モードを許可し、使用時に `CREATE TEMPORARY TABLE` 権限が不要になるようにしました。 [#80981](https://github.com/ClickHouse/ClickHouse/pull/80981) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* インメモリキャッシュのインスペクションを改善しました（不完全な `system.asynchronouse_metrics` ではなく、`system.metrics` でキャッシュに関する情報を公開）。インメモリキャッシュのサイズ（バイト単位）を `dashboard.html` に追加しました。`VectorSimilarityIndexCacheSize` / `IcebergMetadataFilesCacheSize` は `VectorSimilarityIndexCacheBytes` / `IcebergMetadataFilesCacheBytes` に名称変更されました。[#81023](https://github.com/ClickHouse/ClickHouse/pull/81023) ([Azat Khuzhin](https://github.com/azat))。
* system.rocksdb から読み取る際、RocksDB テーブルを保持できないエンジンを使用しているデータベースを無視するようにしました。 [#81083](https://github.com/ClickHouse/ClickHouse/pull/81083) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* `clickhouse-local` の設定ファイルで `filesystem_caches` と `named_collections` を使用可能にしました。 [#81105](https://github.com/ClickHouse/ClickHouse/pull/81105) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `INSERT` クエリ内の `PARTITION BY` のハイライトを修正しました。以前のバージョンでは、`PARTITION BY` がキーワードとしてハイライトされていませんでした。[#81106](https://github.com/ClickHouse/ClickHouse/pull/81106) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* Web UI における小さな改善を 2 点行いました。出力を持たない `CREATE` や `INSERT` などのクエリを正しく処理するようにしました（つい最近まで、これらのクエリはスピナーが無限に回り続ける原因となっていました）。また、テーブルをダブルクリックしたときに先頭までスクロールするようにしました。[#81131](https://github.com/ClickHouse/ClickHouse/pull/81131) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* `c-ares` を `v1.34.5` に更新しました。[#81159](https://github.com/ClickHouse/ClickHouse/pull/81159) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* CVE-2025-5025 および CVE-2025-4947 に対応するため、curl を 8.14 にアップグレードしました。[#81171](https://github.com/ClickHouse/ClickHouse/pull/81171) ([larryluogit](https://github.com/larryluogit)).
  #* 次の脆弱性に対応するため、libarchive を 3.7.9 にアップグレードしました: CVE-2024-20696 CVE-2025-25724 CVE-2024-48958 CVE-2024-57970 CVE-2025-1632 CVE-2024-48957 CVE-2024-48615。[#81174](https://github.com/ClickHouse/ClickHouse/pull/81174) ([larryluogit](https://github.com/larryluogit)).
  #* libxml2 を 2.14.3 にアップグレードしました。[#81187](https://github.com/ClickHouse/ClickHouse/pull/81187) ([larryluogit](https://github.com/larryluogit)).
* `MemoryResidentWithoutPageCache` は、サーバープロセスが使用している物理メモリ量からユーザー空間ページキャッシュを除いた値を、バイト単位で示します。これにより、ユーザー空間ページキャッシュが利用されている場合でも、実際のメモリ使用量をより正確に把握できます。ユーザー空間ページキャッシュが無効になっている場合、この値は MemoryResident と同じになります。 [#81233](https://github.com/ClickHouse/ClickHouse/pull/81233) ([Jayme Bird](https://github.com/jaymebrd))。
* クライアント、ローカルサーバー、Keeper クライアント、および Disks アプリで手動でログ出力された例外を、二重に記録されないよう「ログ済み」としてマークするようにしました。 [#81271](https://github.com/ClickHouse/ClickHouse/pull/81271) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* `use_skip_indexes_if_final` と `use_skip_indexes_if_final_exact_mode` の設定のデフォルト値が `True` になりました。`FINAL` 句を含むクエリは、（該当する場合）スキップインデックスを使用してグラニュールを絞り込み、さらに一致するプライマリキー範囲に対応する追加のグラニュールも読み取るようになりました。以前の、おおよそ／不正確な結果となる挙動が必要なユーザーは、慎重に評価したうえで `use_skip_indexes_if_final_exact_mode` を FALSE に設定できます。 [#81331](https://github.com/ClickHouse/ClickHouse/pull/81331) ([Shankar Iyer](https://github.com/shankar-iyer))。
  #* Web UI で複数のクエリがある場合、カーソル位置にあるクエリが実行されるようになりました。[#80977](https://github.com/ClickHouse/ClickHouse/issues/80977) の継続対応です。 [#81354](https://github.com/ClickHouse/ClickHouse/pull/81354) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* このPRでは、変換関数の単調性チェックにおける `is_strict` の実装上の問題に対処します。現在、一部の変換関数（toFloat64(UInt32) や toDate(UInt8) など）は、本来は true を返すべきにもかかわらず、誤って is&#95;strict を false として返しています。[#81359](https://github.com/ClickHouse/ClickHouse/pull/81359)（[zoomxi](https://github.com/zoomxi)）。
* `KeyCondition` が連続した範囲にマッチするかをチェックする際、キーが非厳密な関数チェーンでラップされている場合には、`Constraint::POINT` を `Constraint::RANGE` に変換する必要が生じることがあります。例えば、`toDate(event_time) = '2025-06-03'` は `event_time` に対して [&#39;2025-06-03 00:00:00&#39;, &#39;2025-06-04 00:00:00&#39;) という範囲を意味します。この PR はこの動作を修正します。[#81400](https://github.com/ClickHouse/ClickHouse/pull/81400) ([zoomxi](https://github.com/zoomxi))。
  #* `postgres` 16.9 を使用。[#81437](https://github.com/ClickHouse/ClickHouse/pull/81437) ([Konstantin Bogdanov](https://github.com/thevar1able))。
  #* `openssl` 3.2.4 を使用。[#81438](https://github.com/ClickHouse/ClickHouse/pull/81438) ([Konstantin Bogdanov](https://github.com/thevar1able))。
  #* `abseil-cpp` 2025-01-27 を使用。[#81440](https://github.com/ClickHouse/ClickHouse/pull/81440) ([Konstantin Bogdanov](https://github.com/thevar1able))。
  #* `mongo-c-driver` 1.30.4 を使用。[#81449](https://github.com/ClickHouse/ClickHouse/pull/81449) ([Konstantin Bogdanov](https://github.com/thevar1able))。
  #* `krb5` 1.21.3-final を使用。[#81453](https://github.com/ClickHouse/ClickHouse/pull/81453) ([Konstantin Bogdanov](https://github.com/thevar1able))。
  #* `orc` 2.1.2 を使用。[#81455](https://github.com/ClickHouse/ClickHouse/pull/81455) ([Konstantin Bogdanov](https://github.com/thevar1able))。
  #* `clickhouse-local` における `--database` 引数のサポートを追加しました。既に作成済みのデータベースに切り替えられます。これにより [#44115](https://github.com/ClickHouse/ClickHouse/issues/44115) がクローズされます。[#81465](https://github.com/ClickHouse/ClickHouse/pull/81465) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
  #* `clickhouse`/`ch` エイリアスは、`--host` または `--port` が指定されている場合、`clickhouse-local` ではなく `clickhouse-client` を起動します。[#79422](https://github.com/ClickHouse/ClickHouse/issues/79422) の継続です。[#65252](https://github.com/ClickHouse/ClickHouse/issues/65252) をクローズします。[#81509](https://github.com/ClickHouse/ClickHouse/pull/81509) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* keeper の応答時間分布データが得られたので、ヒストグラムのバケットを調整できるようになりました。 [#81516](https://github.com/ClickHouse/ClickHouse/pull/81516) ([Miсhael Stetsyuk](https://github.com/mstetsyuk))。
* Iceberg のマニフェストファイルの読み取りを、クエリの初回実行時まで遅延させます。 [#81619](https://github.com/ClickHouse/ClickHouse/pull/81619) ([Daniil Ivanik](https://github.com/divanik)).
  #* `grpc` 1.73.0 を使用します。 [#81629](https://github.com/ClickHouse/ClickHouse/pull/81629) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* `delta-kernel-rs` v0.12.1 を使用します。 [#81707](https://github.com/ClickHouse/ClickHouse/pull/81707) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* プロファイルイベント `PageCacheReadBytes` を追加。 [#81742](https://github.com/ClickHouse/ClickHouse/pull/81742) ([Kseniia Sumarokova](https://github.com/kssenii))。





## バグ修正（公式安定版リリースにおけるユーザーに影響する不具合） {#bug-fix-user-visible-misbehavior-in-an-official-stable-release}


* `SELECT EXCEPT` クエリを使用したパラメータ化ビューの問題を修正。 [#49447](https://github.com/ClickHouse/ClickHouse/issues/49447) をクローズ。 [#57380](https://github.com/ClickHouse/ClickHouse/pull/57380) （[Nikolay Degterinsky](https://github.com/evillique)）。
* Analyzer: join におけるカラム型の昇格後に、カラムの投影名を修正しました。[#63345](https://github.com/ClickHouse/ClickHouse/issues/63345) をクローズ。[#63519](https://github.com/ClickHouse/ClickHouse/pull/63519)（[Dmitry Novik](https://github.com/novikd)）。
* `MATERIALIZED VIEW` が、例えばそれにストリーミングする Kafka テーブルの作成よりも遅れて作成されるなどして、開始が遅くなることがありました。 [#72123](https://github.com/ClickHouse/ClickHouse/pull/72123) ([Ilya Golshtein](https://github.com/ilejn)).
* analyzer&#95;compatibility&#95;join&#95;using&#95;top&#95;level&#95;identifier が有効な場合に、カラム名が衝突するケースで発生していた論理エラーを修正しました。 [#75676](https://github.com/ClickHouse/ClickHouse/pull/75676) ([Vladimir Cherkasov](https://github.com/vdimir)).
* 複数の非同期（`alter_sync = 0`）な `RENAME COLUMN` および `ADD COLUMN` クエリを実行した後に、`MergeTree` テーブルからの読み取り時にまれに発生していたクラッシュを修正しました。 [#76346](https://github.com/ClickHouse/ClickHouse/pull/76346) ([Anton Popov](https://github.com/CurtizJ)).
* `VIEW` 作成時にアナライザー有効化時の `SELECT` クエリ書き換えを修正。[#75956](https://github.com/ClickHouse/ClickHouse/issues/75956) をクローズ。 [#76356](https://github.com/ClickHouse/ClickHouse/pull/76356)（[Dmitry Novik](https://github.com/novikd)）。
* `allow_push_predicate_ast_for_distributed_subqueries` が有効な場合に、プッシュダウンされた述語での CTE の利用を修正。 [#75647](https://github.com/ClickHouse/ClickHouse/issues/75647) を修正。 [#79672](https://github.com/ClickHouse/ClickHouse/issues/79672) を修正。 [#77316](https://github.com/ClickHouse/ClickHouse/pull/77316)（[Dmitry Novik](https://github.com/novikd)）。
* サーバーからの `async_insert` の適用（`apply_settings_from_server` 経由）方法を修正しました（以前はクライアント側で `Unknown packet 11 from server` エラーが発生していました）。[#77578](https://github.com/ClickHouse/ClickHouse/pull/77578)（[Azat Khuzhin](https://github.com/azat)）。
* レプリケートされたデータベースで、新たに追加されたレプリカ上では動作していなかった `refreshable materialized view` が正しく動作するよう修正しました。 [#77774](https://github.com/ClickHouse/ClickHouse/pull/77774) ([Michael Kolupaev](https://github.com/al13n321)).
* バックアップを壊していたリフレッシュ可能なマテリアライズドビューの問題を修正しました。 [#77893](https://github.com/ClickHouse/ClickHouse/pull/77893) ([Michael Kolupaev](https://github.com/al13n321)).
* `transform` における古い発火ロジックの誤りを修正。 [#78247](https://github.com/ClickHouse/ClickHouse/pull/78247) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* `SYSTEM SYNC REPLICA LIGHTWEIGHT 'foo'` が、指定されたレプリカが存在しない場合でも成功を報告してしまう問題を修正しました。コマンドは、同期を試みる前に、指定されたレプリカが Keeper 内に存在することを正しく検証するようになりました。 [#78405](https://github.com/ClickHouse/ClickHouse/pull/78405) ([Jayme Bird](https://github.com/jaymebrd)).
* analyzer 使用時にセカンダリインデックスが適用されないケースがいくつかあった問題を修正。[#65607](https://github.com/ClickHouse/ClickHouse/issues/65607) を修正、[#69373](https://github.com/ClickHouse/ClickHouse/issues/69373) を修正。[#78485](https://github.com/ClickHouse/ClickHouse/pull/78485) ([Nikolai Kochetov](https://github.com/KochetovNicolai))。
* 圧縮が有効な HTTP プロトコルにおけるプロファイルイベント（`NetworkSendElapsedMicroseconds` / `NetworkSendBytes`）のダンプを修正（誤差がバッファサイズを超えないようにする。通常は約 1MiB）。[#78516](https://github.com/ClickHouse/ClickHouse/pull/78516) ([Azat Khuzhin](https://github.com/azat)).
  #* ```sql CREATE TABLE t0 ( key Int32, value Int32 ) ENGINE=MergeTree() PRIMARY KEY key PARTITION BY key % 2;. [#78593](https://github.com/ClickHouse/ClickHouse/pull/78593) ([Vlad](https://github.com/codeworse)).
* `JOIN ... USING` に `ALIAS` 列が含まれている場合に `LOGICAL_ERROR` を発生させてしまう analyzer を修正し、代わりに適切なエラーを返すようにしました。 [#78618](https://github.com/ClickHouse/ClickHouse/pull/78618) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* アナライザーの不具合を修正：`SELECT` に位置引数が含まれている場合に `CREATE VIEW ... ON CLUSTER` が失敗する問題を修正。 [#78663](https://github.com/ClickHouse/ClickHouse/pull/78663) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* `SELECT` にスカラーサブクエリが含まれている場合、スキーマ推論を行うテーブル関数への `INSERT SELECT` で発生する `Block structure mismatch` エラーを修正。 [#78677](https://github.com/ClickHouse/ClickHouse/pull/78677) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* アナライザーを修正: Distributed テーブルに対する SELECT クエリで `prefer_global_in_and_join=1` が設定されている場合、`in` 関数は `globalIn` に置き換えられる必要があります。 [#78749](https://github.com/ClickHouse/ClickHouse/pull/78749) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* `MongoDB` エンジンのテーブル、または `mongodb` テーブル関数から読み取るいくつかの種類の `SELECT` クエリを修正しました。`WHERE` 句内での定数値の暗黙的な型変換を伴うクエリ（例: `WHERE datetime = '2025-03-10 00:00:00'`）や、`LIMIT` と `GROUP BY` を含むクエリが対象です。以前は誤った結果を返す可能性がありました。[#78777](https://github.com/ClickHouse/ClickHouse/pull/78777)（[Anton Popov](https://github.com/CurtizJ)）。
* 異なる JSON 型間の変換を修正しました。現在は、String への／からの変換を介した単純な `CAST` によって実行されます。効率は低下しますが、結果は常に正確です。 [#78807](https://github.com/ClickHouse/ClickHouse/pull/78807) ([Pavel Kruglov](https://github.com/Avogar)).
* Dynamic 型から Interval への変換時の論理エラーを修正しました。 [#78813](https://github.com/ClickHouse/ClickHouse/pull/78813) ([Pavel Kruglov](https://github.com/Avogar)).
* JSON パースエラー発生時のカラムのロールバック処理を修正しました。 [#78836](https://github.com/ClickHouse/ClickHouse/pull/78836) ([Pavel Kruglov](https://github.com/Avogar)).
* 定数エイリアス列を用いた `JOIN` で発生する「bad cast」エラーを修正しました。 [#78848](https://github.com/ClickHouse/ClickHouse/pull/78848) ([Vladimir Cherkasov](https://github.com/vdimir)).
* ビューとターゲットテーブルで型が異なる列を対象とするマテリアライズドビューでは `PREWHERE` を許可しないようにしました。 [#78889](https://github.com/ClickHouse/ClickHouse/pull/78889) ([Pavel Kruglov](https://github.com/Avogar)).
* Variant 列の不正なバイナリデータのパース時に発生する論理エラーを修正。 [#78982](https://github.com/ClickHouse/ClickHouse/pull/78982) ([Pavel Kruglov](https://github.com/Avogar)).
* parquet のバッチサイズが 0 に設定されている場合は例外をスローするようにしました。以前は `output_format_parquet_batch_size = 0` のときに ClickHouse がハングしていましたが、この動作は修正されました。 [#78991](https://github.com/ClickHouse/ClickHouse/pull/78991) ([daryawessely](https://github.com/daryawessely)).
* compact パーツにおける basic 形式での variant discriminator のデシリアライズを修正しました。この問題は [https://github.com/ClickHouse/ClickHouse/pull/55518](https://github.com/ClickHouse/ClickHouse/pull/55518) で導入されました。[#79000](https://github.com/ClickHouse/ClickHouse/pull/79000)（[Pavel Kruglov](https://github.com/Avogar)）。
* `complex_key_ssd_cache` 型の辞書では、`block_size` および `write_buffer_size` パラメータに 0 以下の値が指定された場合、それらを無効として拒否するようになりました（issue [#78314](https://github.com/ClickHouse/ClickHouse/issues/78314)）。 [#79028](https://github.com/ClickHouse/ClickHouse/pull/79028)（[Elmi Ahmadov](https://github.com/ahmadov)）。
* SummingMergeTree で非集約列に Field を使用することは避けてください。SummingMergeTree で Dynamic/Variant 型と組み合わせて使用すると、予期しないエラーが発生する可能性があります。 [#79051](https://github.com/ClickHouse/ClickHouse/pull/79051) ([Pavel Kruglov](https://github.com/Avogar)).
* `Distributed` な宛先テーブルを持ち、ヘッダーが異なる `Materialized View` からの読み取りを analyzer で修正。 [#79059](https://github.com/ClickHouse/ClickHouse/pull/79059) ([Pavel Kruglov](https://github.com/Avogar)).
* `ON CLUSTER` クエリの `CONSTRAINT` セクションで `currentDatabase` 関数が使用された、非常に限定的な状況におけるクラッシュを修正しました。 [#78100](https://github.com/ClickHouse/ClickHouse/issues/78100) をクローズ。 [#79070](https://github.com/ClickHouse/ClickHouse/pull/79070) ([pufit](https://github.com/pufit)).
* バッチ挿入が行われたテーブルで `arrayUnion()` が余分な（誤った）値を返していたバグを修正しました。 [#75057](https://github.com/ClickHouse/ClickHouse/issues/75057) を修正。 [#79079](https://github.com/ClickHouse/ClickHouse/pull/79079)（[Peter Nguyen](https://github.com/petern48)）。
  #* `OpenSSLInitializer` で発生していたセグメンテーションフォルトを修正しました。 [#79092](https://github.com/ClickHouse/ClickHouse/issues/79092) をクローズ。 [#79097](https://github.com/ClickHouse/ClickHouse/pull/79097)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* サーバー間クエリにおける外部ロールの受け渡しを修正。 [#79099](https://github.com/ClickHouse/ClickHouse/pull/79099) ([Andrey Zvonov](https://github.com/zvonand)).
* S3 の ListObject に対して常に prefix を設定するようにしました。 [#79114](https://github.com/ClickHouse/ClickHouse/pull/79114) ([Azat Khuzhin](https://github.com/azat)).
* `arrayUnion()` がバッチ挿入を行ったテーブルに対して余分な（誤った）値を返してしまうバグを修正。[#79157](https://github.com/ClickHouse/ClickHouse/issues/79157) を修正。[#79158](https://github.com/ClickHouse/ClickHouse/pull/79158)（[Peter Nguyen](https://github.com/petern48)）。
* フィルタープッシュダウン後に発生する論理エラーを修正。 [#79164](https://github.com/ClickHouse/ClickHouse/pull/79164) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* SingleValueDataGeneric では `Field` の代わりに `IColumn` を使用するようにしました。これにより、`Dynamic/Variant/JSON` 型に対する `argMax` などの一部の集約関数で発生していた誤った戻り値が修正されます。 [#79166](https://github.com/ClickHouse/ClickHouse/pull/79166) ([Pavel Kruglov](https://github.com/Avogar)).
* HTTP ベースのエンドポイントで delta-kernel 実装を使用する DeltaLake テーブルエンジンの問題を修正し、`NOSIGN` を修正。 [#78124](https://github.com/ClickHouse/ClickHouse/issues/78124) をクローズ。 [#79203](https://github.com/ClickHouse/ClickHouse/pull/79203)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* Keeper の修正: 失敗した multi リクエストで watch がトリガーされないようにしました。 [#79247](https://github.com/ClickHouse/ClickHouse/pull/79247) ([Antonio Andelic](https://github.com/antonio2368)).
* `IN` で Dynamic 型および JSON 型の使用を禁止しました。現在の `IN` の実装では、不正確な結果につながる可能性があるためです。`IN` でこれらの型を正しくサポートするのは複雑であり、将来的に対応される可能性があります。 [#79282](https://github.com/ClickHouse/ClickHouse/pull/79282) ([Pavel Kruglov](https://github.com/Avogar)).
* JSON 型パース時の重複パスチェックを修正。[#79317](https://github.com/ClickHouse/ClickHouse/pull/79317)（[Pavel Kruglov](https://github.com/Avogar)）。
* SecureStreamSocket の接続に関する問題を修正。 [#79383](https://github.com/ClickHouse/ClickHouse/pull/79383) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* データを含む plain&#95;rewritable ディスクの読み込み処理を修正。 [#79439](https://github.com/ClickHouse/ClickHouse/pull/79439) ([Julia Kartseva](https://github.com/jkartseva)).
* MergeTree の Wide パーツでの動的サブカラム検出時に発生していたクラッシュを修正。 [#79466](https://github.com/ClickHouse/ClickHouse/pull/79466) ([Pavel Kruglov](https://github.com/Avogar)).
* テーブル名の長さは、最初の CREATE クエリに対してのみ検証します。後方互換性の問題を避けるため、2 回目以降の CREATE については検証しません。 [#79488](https://github.com/ClickHouse/ClickHouse/pull/79488) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* スパースカラムを含むテーブルで、複数のケースで発生していた `Block structure mismatch` エラーを修正しました。 [#79491](https://github.com/ClickHouse/ClickHouse/pull/79491) ([Anton Popov](https://github.com/CurtizJ)).
* `Logical Error: Can't set alias of * of Asterisk on alias` が発生する 2 つのケースを修正。 [#79505](https://github.com/ClickHouse/ClickHouse/pull/79505) ([Raúl Marín](https://github.com/Algunenano)).
* `use&#95;native&#95;copy` および `allow&#95;azure&#95;native&#95;copy` 設定が Azure Blob Storage に対して正しく適用されるよう修正し、認証情報が一致する場合にのみネイティブコピーを使用するように更新しました。これにより [#78964](https://github.com/ClickHouse/ClickHouse/issues/78964) が解決されました。 [#79561](https://github.com/ClickHouse/ClickHouse/pull/79561) ([Smita Kulkarni](https://github.com/SmitaRKulkarni))。
* Atomic データベースの名前変更時に誤ったパスが使用される問題を修正。 [#79569](https://github.com/ClickHouse/ClickHouse/pull/79569) ([Tuan Pham Anh](https://github.com/tuanpach)).
* JSON 列と他の列を組み合わせた `ORDER BY` の問題を修正。 [#79591](https://github.com/ClickHouse/ClickHouse/pull/79591) ([Pavel Kruglov](https://github.com/Avogar)).
* `use_hedged_requests` と `allow_experimental_parallel_reading_from_replicas` がどちらも無効な場合に、リモート読み込みで結果が重複する問題を修正しました。 [#79599](https://github.com/ClickHouse/ClickHouse/pull/79599) ([Eduard Karacharov](https://github.com/korowa)).
* Unity Catalog 使用時における delta-kernel 実装のクラッシュを修正しました。 [#79677](https://github.com/ClickHouse/ClickHouse/pull/79677) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 自動検出クラスタ用のマクロを展開するようにしました。 [#79696](https://github.com/ClickHouse/ClickHouse/pull/79696) ([Anton Ivashkin](https://github.com/ianton-ru)).
* この列が相関しているかどうかをチェックする際に、列の由来スコープが不明な場合に発生していた論理エラーを修正。[#78183](https://github.com/ClickHouse/ClickHouse/issues/78183) を修正。[#79451](https://github.com/ClickHouse/ClickHouse/issues/79451) を修正。[#79727](https://github.com/ClickHouse/ClickHouse/pull/79727)（[Dmitry Novik](https://github.com/novikd)）。
* ColumnConst および Analyzer を使用した grouping sets で誤った結果が返される問題を修正。 [#79743](https://github.com/ClickHouse/ClickHouse/pull/79743) ([Andrey Zvonov](https://github.com/zvonand))。
* ローカルレプリカが古くなっている状態で分散テーブルから読み取る際に発生する、ローカルシャードの結果の重複を修正しました。 [#79761](https://github.com/ClickHouse/ClickHouse/pull/79761) ([Eduard Karacharov](https://github.com/korowa)).
* 誤って設定された `page_cache_limits` を適切に扱うようにしました。 [#79805](https://github.com/ClickHouse/ClickHouse/pull/79805) ([Bharat Nallan](https://github.com/bharatnc))。
* 可変長のフォーマッタ（例: `%W`、曜日の `Monday` や `Tuesday` など）の後に、複合フォーマッタ（例: アメリカ式の日付 `05/04/25` を表す `%D` のように、一度に複数の要素を出力するフォーマッタ）が続く場合の SQL 関数 `formatDateTime` の結果を修正しました。 [#79835](https://github.com/ClickHouse/ClickHouse/pull/79835) ([Robert Schulze](https://github.com/rschu1ze))。
* IcebergS3 は count の最適化をサポートしますが、IcebergS3Cluster はサポートしません。その結果、クラスターモードで返される count() の結果が、レプリカ数の倍数になる場合があります。 [#79844](https://github.com/ClickHouse/ClickHouse/pull/79844) ([wxybear](https://github.com/wxybear))。
* 負の符号ビットを持つ `NaN` の並び順を修正しました。 [#79847](https://github.com/ClickHouse/ClickHouse/pull/79847) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* `GROUP BY ALL` は `GROUPING` 部分を考慮しなくなりました。 [#79915](https://github.com/ClickHouse/ClickHouse/pull/79915) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* 遅延マテリアライゼーションにおいて、射影までクエリ実行で一切列が使用されない場合に発生する `AMBIGUOUS_COLUMN_NAME` エラーを修正しました。例: SELECT * FROM t ORDER BY rand() LIMIT 5。 [#79926](https://github.com/ClickHouse/ClickHouse/pull/79926)（[Igor Nikonov](https://github.com/devcrafter)）。
* `TopK` / `TopKWeighted` 関数において、容量を使い切っていない場合でも過大な誤差を引き起こしていた誤った状態マージ処理を修正しました。 [#79939](https://github.com/ClickHouse/ClickHouse/pull/79939) ([Joel Höner](https://github.com/athre0z)).
* クエリ `CREATE DATABASE datalake ENGINE = DataLakeCatalog(\'http://catalog:8181\', \'admin\', \'password\')` に含まれるパスワードを非表示にしました。 [#79941](https://github.com/ClickHouse/ClickHouse/pull/79941) ([Han Fei](https://github.com/hanfei1991)).
* `JOIN USING` でエイリアスを指定できるようにしました。列名が変更された場合（例: `ARRAY JOIN` によるリネームなど）に、このエイリアスを指定してください。[#73707](https://github.com/ClickHouse/ClickHouse/issues/73707) を修正しました。[#79942](https://github.com/ClickHouse/ClickHouse/pull/79942)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* `azure_blob_storage` オブジェクトストレージで `readonly` 設定が反映されるようにしました。 [#79954](https://github.com/ClickHouse/ClickHouse/pull/79954) ([Julia Kartseva](https://github.com/jkartseva)).
* `match(column, '^…')` でバックスラッシュでエスケープされた文字を使用した際に発生していた、誤ったクエリ結果およびメモリ不足によるクラッシュを修正しました。 [#79969](https://github.com/ClickHouse/ClickHouse/pull/79969) ([filimonov](https://github.com/filimonov)).
* データレイク向けの Hive パーティショニングを無効化。 [https://github.com/issues/assigned?issue=ClickHouse%7CClickHouse%7C79937](https://github.com/issues/assigned?issue=ClickHouse%7CClickHouse%7C79937) を一部対応。 [#80005](https://github.com/ClickHouse/ClickHouse/pull/80005)（[Daniil Ivanik](https://github.com/divanik)）。
* `lambda` 式を含む skip index が適用されない問題を修正しました。インデックス定義内の高レベル関数がクエリ内のものと完全に一致する場合に、そのインデックスが正しく適用されるようにしました。 [#80025](https://github.com/ClickHouse/ClickHouse/pull/80025) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* `UNION` を含むマテリアライズドビューが、新しいレプリカでも正しく動作するようにしました。 [#80037](https://github.com/ClickHouse/ClickHouse/pull/80037) ([Samay Sharma](https://github.com/samay-sharma)).
* レプリケーションログから `ATTACH_PART` コマンドを実行しているレプリカでパーツをアタッチする際のメタデータバージョンを修正しました。 [#80038](https://github.com/ClickHouse/ClickHouse/pull/80038) ([Aleksei Filatov](https://github.com/aalexfvk)).
* SQL 関数 `parseDateTime` のフォーマット指定子 `%e` は、以前はスペースでパディングされた値（例: ` 3`）のみを受け付けていましたが、現在は 1 桁の日付（例: `3`）も認識するようになりました。これにより、動作が MySQL と互換になりました。以前の動作を維持したい場合は、設定 `parsedatetime_e_requires_space_padding = 1` を有効にしてください。（issue [#78243](https://github.com/ClickHouse/ClickHouse/issues/78243)）。[#80057](https://github.com/ClickHouse/ClickHouse/pull/80057)（[Robert Schulze](https://github.com/rschu1ze)）。
* 他の関数とは異なり、Executable User Defined Functions (eUDF) の名前は `system.query_log` テーブルの `used_functions` 列に追加されません。この PR では、リクエストで eUDF が使用された場合に、その eUDF 名を追加するようにしました。 [#80073](https://github.com/ClickHouse/ClickHouse/pull/80073) ([Kyamran](https://github.com/nibblerenush))。
  #* ClickHouse のログに出力される `Cannot find 'kernel' in '[...]/memory.stat'` という警告を修正しました (issue [#77410](https://github.com/ClickHouse/ClickHouse/issues/77410))。 [#80129](https://github.com/ClickHouse/ClickHouse/pull/80129) ([Robert Schulze](https://github.com/rschu1ze))。
* LowCardinality(FixedString) を使用した Arrow フォーマットにおける論理エラーを修正。 [#80156](https://github.com/ClickHouse/ClickHouse/pull/80156) ([Pavel Kruglov](https://github.com/Avogar))。
* Merge エンジンからのサブカラムの読み取りを修正。 [#80158](https://github.com/ClickHouse/ClickHouse/pull/80158) ([Pavel Kruglov](https://github.com/Avogar)).
* `KeyCondition` における数値型の比較に関するバグを修正しました。 [#80207](https://github.com/ClickHouse/ClickHouse/pull/80207) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* 遅延マテリアライゼーションがプロジェクションを持つテーブルに適用された場合に発生する AMBIGUOUS&#95;COLUMN&#95;NAME エラーを修正。 [#80251](https://github.com/ClickHouse/ClickHouse/pull/80251) ([Igor Nikonov](https://github.com/devcrafter)).
* 暗黙の `projection` を使用している場合に、`LIKE 'ab\c%'` のような文字列プレフィックスフィルタに対する `count` の最適化が誤っていた問題を修正しました。これにより [#80250](https://github.com/ClickHouse/ClickHouse/issues/80250) が修正されました。[#80261](https://github.com/ClickHouse/ClickHouse/pull/80261)（[Amos Bird](https://github.com/amosbird)）。
* MongoDB ドキュメント内のネストされた数値フィールドが文字列として誤ってシリアル化される問題を修正しました。MongoDB から読み込むドキュメントに対する最大深さの制限を削除しました。 [#80289](https://github.com/ClickHouse/ClickHouse/pull/80289) ([Kirill Nikiforov](https://github.com/allmazz)).
* Replicated データベースにおける RMT のメタデータチェックを、より緩やかに行うようにしました。[#80296](https://github.com/ClickHouse/ClickHouse/issues/80296) をクローズしました。[#80298](https://github.com/ClickHouse/ClickHouse/pull/80298)（[Nikolay Degterinsky](https://github.com/evillique)）。
* PostgreSQL ストレージ向けの DateTime および DateTime64 のテキスト表現を修正。 [#80301](https://github.com/ClickHouse/ClickHouse/pull/80301) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* `StripeLog` テーブルでタイムゾーン付きの `DateTime` を許可。これにより [#44120](https://github.com/ClickHouse/ClickHouse/issues/44120) がクローズされました。 [#80304](https://github.com/ClickHouse/ClickHouse/pull/80304)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* クエリプランステップが行数を変更する場合、非決定的関数を含む述語に対するフィルタプッシュダウンを無効化します。 [#40273](https://github.com/ClickHouse/ClickHouse/issues/40273) を修正。 [#80329](https://github.com/ClickHouse/ClickHouse/pull/80329)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* サブカラムを含むプロジェクションで発生しうる論理エラーとクラッシュを修正しました。 [#80333](https://github.com/ClickHouse/ClickHouse/pull/80333) ([Pavel Kruglov](https://github.com/Avogar)).
* `ON` 式が単純な等価比較ではない場合に、論理 JOIN sep のフィルタープッシュダウン最適化によって発生する `NOT_FOUND_COLUMN_IN_BLOCK` エラーを修正。[#79647](https://github.com/ClickHouse/ClickHouse/issues/79647) を修正。[#77848](https://github.com/ClickHouse/ClickHouse/issues/77848) を修正。[#80360](https://github.com/ClickHouse/ClickHouse/pull/80360)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* パーティション化されたテーブルで、キーを逆順に読み取る際に誤った結果が返される問題を修正しました。これにより [#79987](https://github.com/ClickHouse/ClickHouse/issues/79987) が修正されます。 [#80448](https://github.com/ClickHouse/ClickHouse/pull/80448) ([Amos Bird](https://github.com/amosbird))。
* NULL 許容キーを持ち、`optimize_read_in_order` が有効なテーブルで発生していた誤ったソートを修正しました。 [#80515](https://github.com/ClickHouse/ClickHouse/pull/80515) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* `SYSTEM STOP REPLICATED VIEW` を使用してビューが一時停止されている場合に、refreshable materialized view の `DROP` がハングする問題を修正しました。 [#80543](https://github.com/ClickHouse/ClickHouse/pull/80543) ([Michael Kolupaev](https://github.com/al13n321)).
* 分散クエリで定数タプルを使用した際に発生する「Cannot find column」エラーを修正。 [#80596](https://github.com/ClickHouse/ClickHouse/pull/80596) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy))。
* `join_use_nulls` を使用する Distributed テーブルでの `shardNum` 関数を修正。 [#80612](https://github.com/ClickHouse/ClickHouse/pull/80612) ([János Benjamin Antal](https://github.com/antaljanosbenjamin)).
* Merge エンジンで、一部のテーブルにのみ存在するカラムを読み取る際に誤った結果が返される問題を修正。 [#80643](https://github.com/ClickHouse/ClickHouse/pull/80643) ([Pavel Kruglov](https://github.com/Avogar)).
* `iceberg_history` テーブル内の timestamp は、これで正しい値になっているはずです。 [#80711](https://github.com/ClickHouse/ClickHouse/pull/80711) ([Melvyn Peignon](https://github.com/melvynator))。
* オブジェクトストレージのテーブル関数における、要素が1つだけの enum グロブの処理を修正しました。 [#80716](https://github.com/ClickHouse/ClickHouse/pull/80716) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* Tuple(Dynamic) と String の比較関数で誤った結果型が返され、論理エラーを引き起こしていた問題を修正しました。 [#80728](https://github.com/ClickHouse/ClickHouse/pull/80728) ([Pavel Kruglov](https://github.com/Avogar)).
* Unity Catalog 向けに不足していたサポートデータ型 `timestamp_ntz` を追加。[#79535](https://github.com/ClickHouse/ClickHouse/issues/79535)、[#79875](https://github.com/ClickHouse/ClickHouse/issues/79875) を修正。[#80740](https://github.com/ClickHouse/ClickHouse/pull/80740)（[alesapin](https://github.com/alesapin)）。
* `IN cte` を含む分散クエリで発生する `THERE_IS_NO_COLUMN` エラーを修正。[#75032](https://github.com/ClickHouse/ClickHouse/issues/75032) を解決。[#80757](https://github.com/ClickHouse/ClickHouse/pull/80757)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* 外部 `ORDER BY` におけるファイル数の過多（過剰なメモリ使用量につながる）を修正。[#80777](https://github.com/ClickHouse/ClickHouse/pull/80777) ([Azat Khuzhin](https://github.com/azat))。
  #* この PR は [#80742](https://github.com/ClickHouse/ClickHouse/issues/80742) をクローズする可能性があります。[#80783](https://github.com/ClickHouse/ClickHouse/pull/80783) ([zoomxi](https://github.com/zoomxi))。
  #* Kafka において、get&#95;member&#95;id() が NULL から std::string を生成していたことに起因するクラッシュを修正（おそらく、ブローカーへの接続が失敗した場合にのみ発生していた問題）。[#80793](https://github.com/ClickHouse/ClickHouse/pull/80793) ([Azat Khuzhin](https://github.com/azat))。
* Kafka エンジンのコンシューマをシャットダウン前に正しく待機するようにしました（シャットダウン後もアクティブなコンシューマが残っていると、さまざまなデバッグアサーションがトリガーされたり、テーブルが drop/detach された後もバックグラウンドでブローカーからデータを読み込んでしまう可能性があります）。 [#80795](https://github.com/ClickHouse/ClickHouse/pull/80795) ([Azat Khuzhin](https://github.com/azat)).
* `predicate-push-down` 最適化によって発生する `NOT_FOUND_COLUMN_IN_BLOCK` を修正しました。 [#80443](https://github.com/ClickHouse/ClickHouse/issues/80443) を解決。 [#80834](https://github.com/ClickHouse/ClickHouse/pull/80834)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* `USING` を伴う `JOIN` 内の table function における `*` マッチャーの解決時の論理エラーを修正。 [#80894](https://github.com/ClickHouse/ClickHouse/pull/80894) ([Vladimir Cherkasov](https://github.com/vdimir)).
* Iceberg メタデータファイルキャッシュのメモリ使用量の計上を修正。 [#80904](https://github.com/ClickHouse/ClickHouse/pull/80904) ([Azat Khuzhin](https://github.com/azat)).
* nullable なパーティションキー使用時の誤ったパーティション分割を修正。 [#80913](https://github.com/ClickHouse/ClickHouse/pull/80913) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* プッシュダウンされた述語（`allow_push_predicate_ast_for_distributed_subqueries=1`）を使用する分散クエリで、ソーステーブルがイニシエータに存在しない場合に発生する `Table does not exist` エラーを修正しました。[#77281](https://github.com/ClickHouse/ClickHouse/issues/77281) を解決します。 [#80915](https://github.com/ClickHouse/ClickHouse/pull/80915)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* 名前付きウィンドウを使用したネストされた関数における論理エラーを修正しました。 [#80926](https://github.com/ClickHouse/ClickHouse/pull/80926) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* `Nullable` 列および浮動小数点列の `extremes` を修正。 [#80970](https://github.com/ClickHouse/ClickHouse/pull/80970) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* system.tables からのクエリ時に発生する可能性のあったクラッシュを修正（特にメモリプレッシャーが高い状況で発生しやすかった問題）。 [#80976](https://github.com/ClickHouse/ClickHouse/pull/80976) ([Azat Khuzhin](https://github.com/azat)).
* ファイル拡張子から圧縮形式を推論するファイルに対する、`truncate` を伴うアトミックな `rename` を修正。 [#80979](https://github.com/ClickHouse/ClickHouse/pull/80979) ([Pablo Marcos](https://github.com/pamarcos)).
  #* `ErrorCodes::getName` を修正。 [#81032](https://github.com/ClickHouse/ClickHouse/pull/81032) ([RinChanNOW](https://github.com/RinChanNOWWW)).
* Unity Catalog で、すべてのテーブルに対する権限がないとテーブル一覧を取得できなかったバグを修正しました。現在はすべてのテーブルが正しく一覧表示され、制限されたテーブルを読み取ろうとすると例外がスローされます。 [#81044](https://github.com/ClickHouse/ClickHouse/pull/81044) ([alesapin](https://github.com/alesapin)).
* `SHOW TABLES` クエリにおいて、ClickHouse はデータレイクカタログからのエラーや予期しないレスポンスを無視するようになりました。 [#79725](https://github.com/ClickHouse/ClickHouse/issues/79725) を修正。[#81046](https://github.com/ClickHouse/ClickHouse/pull/81046) ([alesapin](https://github.com/alesapin)).
* `JSONExtract` および `JSON` 型パースにおける、整数値からの `DateTime64` の解析を修正。[#81050](https://github.com/ClickHouse/ClickHouse/pull/81050) ([Pavel Kruglov](https://github.com/Avogar))。
* `date_time_input_format` 設定をスキーマ推論キャッシュに反映するようにしました。 [#81052](https://github.com/ClickHouse/ClickHouse/pull/81052) ([Pavel Kruglov](https://github.com/Avogar)).
* クエリの開始後、カラムが送信される前の段階でテーブルが `DROP` された場合に `INSERT` がクラッシュする問題を修正。 [#81053](https://github.com/ClickHouse/ClickHouse/pull/81053) ([Azat Khuzhin](https://github.com/azat)).
* quantileDeterministic における未初期化値の使用（use-of-uninitialized-value）を修正。 [#81062](https://github.com/ClickHouse/ClickHouse/pull/81062) ([Azat Khuzhin](https://github.com/azat)).
* `metadatastoragefromdisk` ディスクトランザクションにおけるハードリンク数の管理を修正し、テストを追加しました。 [#81066](https://github.com/ClickHouse/ClickHouse/pull/81066) ([Sema Checherinda](https://github.com/CheSema)).
* 他の関数とは異なり、User Defined Functions (UDF) の名前は `system.query_log` テーブルに追加されません。UDF がクエリ内で使用された場合に、その UDF 名を `used_executable_user_defined_functions` または `used_sql_user_defined_functions` のいずれかの列に追加するようにする対応を、この PR で実装しました。[#81101](https://github.com/ClickHouse/ClickHouse/pull/81101) ([Kyamran](https://github.com/nibblerenush))。
* `JSON` や `Values` などのテキストフォーマットを使用した HTTP プロトコル経由での挿入時に、`Enum` フィールドを省略した場合に発生する `Too large size ... passed to allocator` エラーや、クラッシュが起こりうる不具合を修正しました。 [#81145](https://github.com/ClickHouse/ClickHouse/pull/81145) ([Anton Popov](https://github.com/CurtizJ)).
* 非MTなマテリアライズドビューにプッシュされる INSERT ブロックに Sparse カラムが含まれている場合の LOGICAL&#95;ERROR を修正しました。 [#81161](https://github.com/ClickHouse/ClickHouse/pull/81161) ([Azat Khuzhin](https://github.com/azat)).
* クロスレプリケーション環境で `distributed_product_mode_local=local` を使用した際に発生する `Unknown table expression identifier` エラーを修正。 [#81162](https://github.com/ClickHouse/ClickHouse/pull/81162) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* フィルタリング後の `parquet` ファイルの行数を誤ってキャッシュしていた問題を修正しました。 [#81184](https://github.com/ClickHouse/ClickHouse/pull/81184) ([Michael Kolupaev](https://github.com/al13n321)).
* 相対キャッシュパスで使用された場合の fs cache の `max_size_to_total_space` 設定を修正しました。 [#81237](https://github.com/ClickHouse/ClickHouse/pull/81237) ([Kseniia Sumarokova](https://github.com/kssenii))。
* Parquet 形式で定数の `tuple` または `map` を出力する際に `clickhouse-local` がクラッシュする問題を修正しました。 [#81249](https://github.com/ClickHouse/ClickHouse/pull/81249) ([Michael Kolupaev](https://github.com/al13n321)).
* ネットワーク経由で受信した配列オフセットを検証するようにしました。 [#81269](https://github.com/ClickHouse/ClickHouse/pull/81269) ([Azat Khuzhin](https://github.com/azat)).
* 空のテーブルを結合し、ウィンドウ関数を使用するクエリにおける一部のコーナーケースを修正しました。このバグにより並列ストリーム数が爆発的に増加し、その結果 OOM が発生していました。 [#81299](https://github.com/ClickHouse/ClickHouse/pull/81299) ([Alexander Gololobov](https://github.com/davenger)).
* datalake Cluster 関数（`deltaLakeCluster`、`icebergCluster` など）に対する修正: (1) 旧 analyzer とともに `Cluster` 関数を使用した際に `DataLakeConfiguration` で発生し得たセグメンテーションフォールトを修正；(2) data lake メタデータ更新の重複（不要なオブジェクトストレージへのリクエスト）を解消；(3) フォーマットが明示的に指定されていない場合にオブジェクトストレージで発生していた冗長な listing を修正（これは非 cluster の data lake エンジンではすでに対応済みだったもの）。 [#81300](https://github.com/ClickHouse/ClickHouse/pull/81300) ([Kseniia Sumarokova](https://github.com/kssenii)).
* `force_restore_data` フラグで失われた Keeper メタデータを復旧できるようにしました。 [#81324](https://github.com/ClickHouse/ClickHouse/pull/81324) ([Raúl Marín](https://github.com/Algunenano)).
* delta-kernel における region エラーを修正。 [#79914](https://github.com/ClickHouse/ClickHouse/issues/79914) を解決。 [#81353](https://github.com/ClickHouse/ClickHouse/pull/81353)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* divideOrNull に対する誤った JIT を無効化。 [#81370](https://github.com/ClickHouse/ClickHouse/pull/81370) ([Raúl Marín](https://github.com/Algunenano))。
* MergeTree テーブルでパーティション列名が長い場合に発生していた挿入エラーを修正しました。 [#81390](https://github.com/ClickHouse/ClickHouse/pull/81390) ([hy123q](https://github.com/haoyangqian)).
* 複数の manifest ファイルの内容をメモリに格納しないようにしました。 [#81470](https://github.com/ClickHouse/ClickHouse/pull/81470) ([Daniil Ivanik](https://github.com/divanik)).
* バックグラウンドプールのシャットダウン時に発生する可能性のあったクラッシュを修正しました（`background_.*pool_size`）。[#81473](https://github.com/ClickHouse/ClickHouse/pull/81473)（[Azat Khuzhin](https://github.com/azat)）。
* `URL` エンジンを使用してテーブルに書き込む際に発生していた `Npy` フォーマットでの境界外読み取りを修正しました。これにより [#81356](https://github.com/ClickHouse/ClickHouse/issues/81356) が解決されました。[#81502](https://github.com/ClickHouse/ClickHouse/pull/81502)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* Web UI に `NaN%` が表示される場合があります（よくある JavaScript の問題）。[#81507](https://github.com/ClickHouse/ClickHouse/pull/81507)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `database_replicated_enforce_synchronous_settings=1` 設定時の `DatabaseReplicated` を修正。 [#81564](https://github.com/ClickHouse/ClickHouse/pull/81564) ([Azat Khuzhin](https://github.com/azat)).
* LowCardinality(Nullable(...)) 型のソート順序を修正しました。 [#81583](https://github.com/ClickHouse/ClickHouse/pull/81583) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* リクエストがソケットから最後まで読み込まれていない場合、サーバーが HTTP 接続を維持しないようにしました。 [#81595](https://github.com/ClickHouse/ClickHouse/pull/81595) ([Sema Checherinda](https://github.com/CheSema)).
* スカラー相関サブクエリが射影式の `Nullable` な結果を返すようにしました。相関サブクエリが空の結果セットを返す場合の不具合を修正しました。 [#81632](https://github.com/ClickHouse/ClickHouse/pull/81632) ([Dmitry Novik](https://github.com/novikd))。
* `ReplicatedMergeTree` への `ATTACH` 実行時に発生する `Unexpected relative path for a deduplicated part` エラーを修正。 [#81647](https://github.com/ClickHouse/ClickHouse/pull/81647) ([Azat Khuzhin](https://github.com/azat))。
* クエリ設定 `use_iceberg_partition_pruning` は、グローバルコンテキストを使用しておりクエリコンテキストを使用していないため、Iceberg ストレージでは有効になりません。ただし、デフォルト値が true であるため致命的ではありません。この PR で修正されます。 [#81673](https://github.com/ClickHouse/ClickHouse/pull/81673) ([Han Fei](https://github.com/hanfei1991))。
* MergeTree 設定 `merge_max_block_size` に対して、ゼロ以外であることを保証するバリデーションを追加。 [#81693](https://github.com/ClickHouse/ClickHouse/pull/81693) ([Bharat Nallan](https://github.com/bharatnc))。
* `DROP VIEW` クエリがハングする `clickhouse-local` の問題を修正。 [#81705](https://github.com/ClickHouse/ClickHouse/pull/81705) ([Bharat Nallan](https://github.com/bharatnc)).
* 一部のケースにおける StorageRedis の `JOIN` を修正。 [#81736](https://github.com/ClickHouse/ClickHouse/pull/81736) ([Pervakov Grigorii](https://github.com/GrigoryPervakov))。
* 空の `USING ()` と旧アナライザーが有効な場合に `ConcurrentHashJoin` で発生するクラッシュを修正。 [#81754](https://github.com/ClickHouse/ClickHouse/pull/81754) ([Nikita Taranov](https://github.com/nickitat))。
* Keeper の修正: ログに不正なエントリが存在する場合は、新しいログのコミットをブロックするようにしました。以前は、リーダーが一部のログを誤って適用していても、フォロワーがダイジェストの不整合を検出してアボートするにもかかわらず、新しいログのコミットを続行していました。 [#81780](https://github.com/ClickHouse/ClickHouse/pull/81780) ([Antonio Andelic](https://github.com/antonio2368))。