---
slug: /changelogs/25.6
title: 'v25.6 クラウド向けチェンジログ'
description: 'v25.6 の高速リリースチェンジログ'
keywords: ['changelog', 'cloud']
sidebar_label: '25.6'
sidebar_position: 2
doc_type: 'changelog'
---



## 後方互換性のない変更 {#backward-incompatible-change}

- 関数 `geoToH3()` は、入力を (lat, lon, res) の順序で受け付けるようになりました(これは幾何関数の標準的な順序です)。従来の結果順序 (lon, lat, res) を保持したい場合は、設定 `geotoh3_lon_lat_input_order = true` を指定できます。[#78852](https://github.com/ClickHouse/ClickHouse/pull/78852) ([Pratima Patel](https://github.com/pratimapatel2008))。
- `full_text` 型のインデックスは `gin` に名称変更されました。これは PostgreSQL や他のデータベースでより馴染みのある用語に従っています。既存の `full_text` 型のインデックスは読み込み可能ですが、検索で使用しようとすると例外がスローされます(代わりに `gin` インデックスの使用を提案します)。[#79024](https://github.com/ClickHouse/ClickHouse/pull/79024) ([Robert Schulze](https://github.com/rschu1ze))。
- ファイルシステムキャッシュの動的リサイズを許可するために、ファイルシステムキャッシュ設定 `allow_dynamic_cache_resize` を追加しました。デフォルトは `false` です。理由: 特定の環境(ClickHouse Cloud)では、すべてのスケーリングイベントがプロセスの再起動を通じて発生するため、動作をより制御し、安全対策として、この機能を明示的に無効にする必要があります。この PR は後方互換性がないとマークされています。なぜなら、古いバージョンでは動的キャッシュリサイズが特別な設定なしでデフォルトで動作していたためです。[#79148](https://github.com/ClickHouse/ClickHouse/pull/79148) ([Kseniia Sumarokova](https://github.com/kssenii))。
- レガシーインデックスタイプ `annoy` および `usearch` のサポートを削除しました。両方とも長い間スタブであり、つまりレガシーインデックスを使用しようとするたびにエラーが返されていました。まだ `annoy` および `usearch` インデックスをお持ちの場合は、削除してください。[#79802](https://github.com/ClickHouse/ClickHouse/pull/79802) ([Robert Schulze](https://github.com/rschu1ze))。#_ サーバー設定 `format_alter_commands_with_parentheses` を削除しました。この設定は 24.2 で導入され、デフォルトで無効化されていました。25.2 でデフォルトで有効化されました。新しい形式をサポートしない LTS バージョンが存在しないため、この設定を削除できます。[#79970](https://github.com/ClickHouse/ClickHouse/pull/79970) ([János Benjamin Antal](https://github.com/antaljanosbenjamin))。#_ マイナー: backup_threads および restore_threads サーバー設定を非ゼロに強制します。[#80224](https://github.com/ClickHouse/ClickHouse/pull/80224) ([Raúl Marín](https://github.com/Algunenano))。
- String に対する bitNot() がゼロ終端文字列を返すように修正しました。[#80791](https://github.com/ClickHouse/ClickHouse/pull/80791) ([Azat Khuzhin](https://github.com/azat))。


## 新機能 {#new-feature}


* MergeTree の `SETTINGS` に新しいオプションを追加し、`CREATE` クエリで対象カラムに対して圧縮コーデックが明示的に定義されていない場合に使用されるデフォルトの圧縮コーデックを指定できるようにしました。これにより [#42005](https://github.com/ClickHouse/ClickHouse/issues/42005) がクローズされました。 [#66394](https://github.com/ClickHouse/ClickHouse/pull/66394) ([gvoelfin](https://github.com/gvoelfin))。
* [https://github.com/ClickHouse/ClickHouse/pull/71943](https://github.com/ClickHouse/ClickHouse/pull/71943) のフォローアップ。この PR では `Time` / `Time64` データ型を実装しています。新しいデータ型として Time (HHH:MM:SS) および Time64 (HHH:MM:SS.`&lt;fractional&gt;`) を実装し、いくつかの基本的なキャスト関数と、他のデータ型と連携するための関数を追加しました。また、キャスト関数に `toTime` 関数が必要なため、既存の関数名 `toTime` を `toTimeWithFixedDate` に変更しました。 [#75735](https://github.com/ClickHouse/ClickHouse/pull/75735) ([Yarik Briukhovetsky](https://github.com/yariks5s))。
* `WHERE` 句における `EXISTS` 式の引数として相関サブクエリをサポートします。[#72459](https://github.com/ClickHouse/ClickHouse/issues/72459) をクローズ。[#76078](https://github.com/ClickHouse/ClickHouse/pull/76078)（[Dmitry Novik](https://github.com/novikd)）。
* Merge テーブルエンジンへの書き込みを許可。 [#77484](https://github.com/ClickHouse/ClickHouse/pull/77484) ([Anton Ivashkin](https://github.com/ianton-ru)).
* レプリケートされた MergeTree テーブルに対する分散 `INSERT SELECT` で、異なるノードごとに異なるデータを選択して独立に挿入することで、並列レプリカを効率的に活用して `INSERT` を並列化できるようになりました。 [#78041](https://github.com/ClickHouse/ClickHouse/pull/78041) ([Igor Nikonov](https://github.com/devcrafter))。
* `mapContainsValuesLike`／`mapContainsValues`／`mapExtractValuesLike` 関数を追加し、map の値に対するフィルタリングおよび Bloom filter ベースのインデックスでの利用を可能にしました。 [#78171](https://github.com/ClickHouse/ClickHouse/pull/78171) ([UnamedRus](https://github.com/UnamedRus))。
* `system.iceberg_history` テーブルを追加。 [#78244](https://github.com/ClickHouse/ClickHouse/pull/78244) ([Smita Kulkarni](https://github.com/SmitaRKulkarni))。
* ワークロード向けのクエリスロットスケジューリングを追加しました。詳細については [https://clickhouse.com/docs/operations/workload-scheduling#query&#95;scheduling](https://clickhouse.com/docs/operations/workload-scheduling#query_scheduling) を参照してください。 [#78415](https://github.com/ClickHouse/ClickHouse/pull/78415) ([Sergei Trifonov](https://github.com/serxa))。
* `getServerSetting` 関数と `getMergeTreeSetting` 関数を追加。 [https://github.com/clickhouse/clickhouse/issues/78318](https://github.com/clickhouse/clickhouse/issues/78318) をクローズ。 [#78439](https://github.com/ClickHouse/ClickHouse/pull/78439)（[NamNguyenHoai](https://github.com/NamHoaiNguyen)）。
* 設定制約のもとで、許可されていない値を扱えるようにしました。 [#78499](https://github.com/ClickHouse/ClickHouse/pull/78499) ([Bharat Nallan](https://github.com/bharatnc)).
* `version-hint.text` ファイルを活用するための新しい `iceberg_enable_version_hint` 設定を追加しました。 [#78594](https://github.com/ClickHouse/ClickHouse/pull/78594) ([Arnaud Briche](https://github.com/arnaudbriche)).
* `LIKE` キーワードによるフィルタリングを用いて、データベース内の特定のテーブルのみを切り詰められるようになりました。 [#78597](https://github.com/ClickHouse/ClickHouse/pull/78597) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* `clickhouse-local`（およびその短縮エイリアスである `ch`）は、処理対象の入力データがある場合に、暗黙の `FROM table` を使用するようになりました。これにより [#65023](https://github.com/ClickHouse/ClickHouse/issues/65023) が解決されました。さらに、通常のファイルを処理する際に `--input-format` が指定されていない場合、clickhouse-local でフォーマット推論が有効になります。[#79085](https://github.com/ClickHouse/ClickHouse/pull/79085)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* [`icebergHash`](https://iceberg.apache.org/spec/#appendix-b-32-bit-hash-requirements) 関数と [`icebergBucketTransform`](https://iceberg.apache.org/spec/#bucket-transform-details) 関数を追加。[`bucket transfom`](https://iceberg.apache.org/spec/#partitioning) でパーティション分割された `Iceberg` テーブルにおけるデータファイルの削除候補の絞り込み（プルーニング）をサポート。 [#79262](https://github.com/ClickHouse/ClickHouse/pull/79262) ([Daniil Ivanik](https://github.com/divanik))。
* Coalescing Merge Tree のサポートを追加しました。これにより [#78869](https://github.com/ClickHouse/ClickHouse/issues/78869) がクローズされます。[#79344](https://github.com/ClickHouse/ClickHouse/pull/79344)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* ランダムまたは暗号化されている可能性のあるデータを検索するための `stringBytesUniq` 関数と `stringBytesEntropy` 関数を追加しました。 [#79350](https://github.com/ClickHouse/ClickHouse/pull/79350) ([Sachin Kumar Singh](https://github.com/sachinkumarsingh092)).
* MergeTree ファミリーのテーブルで `_part_starting_offset` 仮想列をサポートしました。この列は、クエリ時点の現在のパート一覧に基づいて計算される、先行するすべてのパートの累積行数を表します。累積値はクエリ実行全体を通して保持され、パートのプルーニングが行われた後も有効なままです。この挙動をサポートするために、関連する内部ロジックがリファクタリングされました。 [#79417](https://github.com/ClickHouse/ClickHouse/pull/79417) ([Amos Bird](https://github.com/amosbird)).
* 単一のクエリ内のすべてのサブクエリで同じストレージスナップショットを共有できるようにする設定 `enable_shared_storage_snapshot_in_query` を追加しました。これにより、クエリ内で同じテーブルが複数回参照される場合でも、そのテーブルからの読み取り結果の一貫性が保証されます。 [#79471](https://github.com/ClickHouse/ClickHouse/pull/79471) ([Amos Bird](https://github.com/amosbird))。
* CH の JSON カラムを Parquet に書き込み、Parquet の JSON カラムを CH の JSON カラムとして直接読み取ることをサポート。 [#79649](https://github.com/ClickHouse/ClickHouse/pull/79649) ([Nihal Z. Miaji](https://github.com/nihalzp))。
* ClickHouse の一部として、ClickHouse 用の TUI インターフェイス（`top` のような）である [`chdig`](https://github.com/azat/chdig/) を同梱しました。[#79666](https://github.com/ClickHouse/ClickHouse/pull/79666)（[Azat Khuzhin](https://github.com/azat)）。
* `pointInPolygon` に `MultiPolygon` のサポートを追加しました。 [#79773](https://github.com/ClickHouse/ClickHouse/pull/79773) ([Nihal Z. Miaji](https://github.com/nihalzp)).
* Geo Parquet をサポートしました。これにより [#75317](https://github.com/ClickHouse/ClickHouse/issues/75317) がクローズされます。[#79777](https://github.com/ClickHouse/ClickHouse/pull/79777)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* `deltaLakeLocal` テーブル関数を使用して、ローカルファイルシステムにマウントされた Delta テーブルをクエリできるように対応を追加。 [#79781](https://github.com/ClickHouse/ClickHouse/pull/79781) ([roykim98](https://github.com/roykim98)).
* base32 のエンコード／デコード機能を追加しました。 [#79809](https://github.com/ClickHouse/ClickHouse/pull/79809) ([Joanna Hulboj](https://github.com/jh0x)).
* ClickHouse のベクトル検索は、プリフィルタリングとポストフィルタリングの両方をサポートし、より細かな制御のための関連設定も利用できるようになりました。(issue [#78161](https://github.com/ClickHouse/ClickHouse/issues/78161))。[#79854](https://github.com/ClickHouse/ClickHouse/pull/79854)（[Shankar Iyer](https://github.com/shankar-iyer)）。
* WKB フォーマットを読み取る関数をサポートしました。これにより、[#43941](https://github.com/ClickHouse/ClickHouse/issues/43941) が一部解決されます。 [#80139](https://github.com/ClickHouse/ClickHouse/pull/80139)（[Konstantin Vedernikov](https://github.com/scanhex12)）。
* `cast_string_to_date_time_mode` という新しい設定を追加しました。これにより、String からの CAST 時に DateTime のパースモードを選択できるようになります。 [#80210](https://github.com/ClickHouse/ClickHouse/pull/80210) ([Pavel Kruglov](https://github.com/Avogar))。
* `Bech32` および `Bech32m` のエンコード／デコード関数を追加しました（issue [#40381](https://github.com/ClickHouse/ClickHouse/issues/40381)）。[#80239](https://github.com/ClickHouse/ClickHouse/pull/80239)（[George Larionov](https://github.com/glarik)）。
* AtomicおよびOrdinaryデータベースエンジンで`disk`設定をサポートし、テーブルメタデータファイルを保存するディスクを指定できるようになりました。[#80546](https://github.com/ClickHouse/ClickHouse/pull/80546) ([Tuan Pham Anh](https://github.com/tuanpach))。
* MergeTree パーツを展開および比較するためのサポート関数を追加。 [#80573](https://github.com/ClickHouse/ClickHouse/pull/80573) ([Mikhail Artemenko](https://github.com/Michicosun)).
* `timeSeries*` ヘルパー関数により、時系列データを扱ういくつかのケースを高速化できるようになりました: - 指定した開始タイムスタンプ・終了タイムスタンプ・ステップを持つ時間グリッドへの再サンプリング - PromQL 風の `delta`、`rate`、`idelta` および `irate` の計算。 [#80590](https://github.com/ClickHouse/ClickHouse/pull/80590) ([Alexander Gololobov](https://github.com/davenger)).
* クエリで使用するパーツを、それらが存在するディスクによってフィルタリングできるようにしました。 [#80650](https://github.com/ClickHouse/ClickHouse/pull/80650) ([tanner-bruce](https://github.com/tanner-bruce)).
* 埋め込み Web ツールの一覧を表示するランディングページを追加しました。これはブラウザー類似のユーザーエージェントからリクエストされたときに開きます。 [#81129](https://github.com/ClickHouse/ClickHouse/pull/81129) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* `arrayFirst`、`arrayFirstIndex`、`arrayLast`、`arrayLastIndex` で `NULL` 値をフィルタリングできるようにしました。[#81113](https://github.com/ClickHouse/ClickHouse/issues/81113) を修正。[#81197](https://github.com/ClickHouse/ClickHouse/pull/81197)（[Lennard Eijsackers](https://github.com/Blokje5)）。





## 実験的機能 {#experimental-feature}

- Icebergデータレイク用のHiveメタストアカタログ。[#77677](https://github.com/ClickHouse/ClickHouse/pull/77677) ([Konstantin Vedernikov](https://github.com/scanhex12))。
- キーバリューペアによる明示的なパラメータがサポートされました。現在サポートされているパラメータは、必須の`tokenizer`と、オプションの`max_rows_per_postings_list`および`ngram_size`の2つです。[#80262](https://github.com/ClickHouse/ClickHouse/pull/80262) ([Elmi Ahmadov](https://github.com/ahmadov))。
- `gin`型の実験的インデックスは`text`に名称変更されました。既存の`gin`型インデックスは読み込み可能ですが、検索で使用しようとすると例外がスローされます(代わりに`text`インデックスの使用が推奨されます)。[#80855](https://github.com/ClickHouse/ClickHouse/pull/80855) ([Robert Schulze](https://github.com/rschu1ze))。


## パフォーマンスの向上 {#performance-improvement}


* 複数の granule に対してまとめて式を評価することで、セカンダリインデックスを高速化しました。 [#64109](https://github.com/ClickHouse/ClickHouse/pull/64109) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 右テーブルのサイズがしきい値未満の場合に `hash` アルゴリズムへフォールバックするためのしきい値（設定項目 `parallel_hash_join_threshold` で制御）を導入しました。 [#76185](https://github.com/ClickHouse/ClickHouse/pull/76185) ([Nikita Taranov](https://github.com/nickitat))。
* 既存の `Pipe::resize` の実装では、パイプラインのトポロジに単一の `Resize` または `StrictResize` ノードを挿入しており、このノードがすべての入力ストリーム（上流ノード）を、統一された出力ストリーム集合（下流ノード）に接続する中央ハブとして機能します。この設計により、特にコア数の多い環境では、パイプライングラフの実行中に `ExecutingGraph::Node::status_mutex` への競合が発生します。パイプラインが数十から数百のストリームにスケールすると、この競合により、次のような問題が発生します。 [#77562](https://github.com/ClickHouse/ClickHouse/pull/77562) ([Zhiguo Zhou](https://github.com/ZhiguoZh)).
* `S3Queue`/`AzureQueue` のパフォーマンスを向上しました。`parallel_inserts=true` というキュー設定により、`INSERT` データを並列で実行できるようになりました。以前の `S3Queue`/`AzureQueue` は、パイプラインの最初の部分（ダウンロード、パース）のみ並列化でき、`INSERT` はシングルスレッドでした。また、ほとんどの場合、この `INSERT` がボトルネックとなっていました。現在は `processing_threads_num` にほぼ線形にスケールします。 [#77671](https://github.com/ClickHouse/ClickHouse/pull/77671) ([Azat Khuzhin](https://github.com/azat))。
* コンパクトパーツ形式を変更し、各サブストリームのマークを保存して個々のサブカラムを読み取れるようにしました。従来のコンパクト形式は引き続き読み取りでサポートされており、MergeTree 設定 `write_marks_for_substreams_in_compact_parts` を使用することで書き込みでも有効にできます。コンパクトパーツのストレージ形式が変わるため、より安全にアップグレードできるよう、現時点ではデフォルトで無効になっています。今後のいずれかのリリースでデフォルトで有効になる予定です。 [#77940](https://github.com/ClickHouse/ClickHouse/pull/77940) ([Pavel Kruglov](https://github.com/Avogar))。
* 新しい設定 `use_skip_indexes_in_final_exact_mode` を導入しました。`ReplacingMergeTree` テーブルに対するクエリで `FINAL` 句が指定されている場合、スキップインデックスに基づいてテーブル範囲のみを読み取ると、結果が誤ってしまう可能性があります。この設定により、スキップインデックスによって返された主キー範囲と重複する、より新しいパーツをスキャンすることで、正しい結果が返されることを保証できます。0 に設定すると無効、1 に設定すると有効になります。[#78350](https://github.com/ClickHouse/ClickHouse/pull/78350)（[Shankar Iyer](https://github.com/shankar-iyer)）。
* 並列レプリカを有効にした読み取りにおけるタスクサイズの決定に、レプリカ数を用いるようにしました。これにより、読み取るデータ量があまり大きくない場合でも、レプリカ間での作業分散がより良くなります。 [#78695](https://github.com/ClickHouse/ClickHouse/pull/78695) ([Nikita Taranov](https://github.com/nickitat))。
* 分散集計の最終段階で `uniqExact` 状態を並列にマージできるようにしました。 [#78703](https://github.com/ClickHouse/ClickHouse/pull/78703) ([Nikita Taranov](https://github.com/nickitat))。
* キー付き集約における `uniqExact` 状態の並列マージで発生し得るパフォーマンス低下を修正。 [#78724](https://github.com/ClickHouse/ClickHouse/pull/78724) ([Nikita Taranov](https://github.com/nickitat)).
  #* `DELETE FROM ... WHERE 1` クエリを `TRUNCATE` に置き換え。 (後にリバート)。 [#78739](https://github.com/ClickHouse/ClickHouse/pull/78739) ([Konstantin Vedernikov](https://github.com/scanhex12)).
* Azure Storage に対する List Blobs API 呼び出し回数を削減。 [#78860](https://github.com/ClickHouse/ClickHouse/pull/78860) ([Julia Kartseva](https://github.com/jkartseva)).
* 可能な場合、フィルタークエリプランステップの等価条件を `JOIN` 条件に統合し、ハッシュテーブルのキーとして利用できるようにしました。[#78877](https://github.com/ClickHouse/ClickHouse/pull/78877) ([Dmitry Novik](https://github.com/novikd))。
* 正規表現の代わりに `extractKeyValuePairs` を使用することで、Hive パスの解析性能を向上しました。 [#79067](https://github.com/ClickHouse/ClickHouse/pull/79067) ([Arthur Passos](https://github.com/arthurpassos))。
* 並列レプリカを使用する分散 `INSERT SELECT` のパフォーマンスを改善しました。 [#79441](https://github.com/ClickHouse/ClickHouse/pull/79441) ([Azat Khuzhin](https://github.com/azat)).
* サブカラムを含む条件を `PREWHERE` に移動可能にしました。 [#79489](https://github.com/ClickHouse/ClickHouse/pull/79489) ([Pavel Kruglov](https://github.com/Avogar))。
* すべてのブルームフィルタータイプのパフォーマンスを改善。 [#79800](https://github.com/ClickHouse/ClickHouse/pull/79800) ([Delyan Kratunov](https://github.com/dkratunov)).
* `LogSeriesLimiter` の生成ごとにクリーンアップが実行されないようにし、高い同時実行性のシナリオにおけるロック競合とパフォーマンス低下を回避します。 [#79864](https://github.com/ClickHouse/ClickHouse/pull/79864) ([filimonov](https://github.com/filimonov)).
* `compile_expressions`（通常の式の一部を対象とする JIT コンパイラ）をデフォルトで有効にしました。これにより [#51264](https://github.com/ClickHouse/ClickHouse/issues/51264)、[#56386](https://github.com/ClickHouse/ClickHouse/issues/56386)、[#66486](https://github.com/ClickHouse/ClickHouse/issues/66486) がクローズされます。[#79907](https://github.com/ClickHouse/ClickHouse/pull/79907)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* トリビアルな COUNT 最適化によりクエリを高速化。 [#79945](https://github.com/ClickHouse/ClickHouse/pull/79945) ([Raúl Marín](https://github.com/Algunenano)).
* 一方の集合が空の場合に `UniqExactSet::merge` にハッピーパスを導入しました。さらに、左辺の集合が二段階構造で右辺が単一レベルの場合、右辺を二段階構造に変換しないようにしました。 [#79971](https://github.com/ClickHouse/ClickHouse/pull/79971) ([Nikita Taranov](https://github.com/nickitat))。
* `convertDecimalsImpl` に `__attribute__((always_inline))` を追加。 [#79999](https://github.com/ClickHouse/ClickHouse/pull/79999) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* `input_format_parquet_bloom_filter_push_down` をデフォルトで true に設定しました。また、設定変更履歴の誤りを修正しました。 [#80058](https://github.com/ClickHouse/ClickHouse/pull/80058) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* ログ出力をデフォルトで非同期にしました。`<logger>` セクション内で `<async>false</async>` を設定することで無効化できます。 [#80125](https://github.com/ClickHouse/ClickHouse/pull/80125) ([Raúl Marín](https://github.com/Algunenano)).
* 2 レベルハッシュテーブル使用時のメモリ再利用効率を向上し、ページフォールトを削減しました。 [#80245](https://github.com/ClickHouse/ClickHouse/pull/80245) ([Jiebin Sun](https://github.com/jiebinn)).
* `QueryConditionCache` において不要な更新を避け、ロック競合を軽減しました。 [#80247](https://github.com/ClickHouse/ClickHouse/pull/80247) ([Jiebin Sun](https://github.com/jiebinn)).
* `concatenateBlocks` の小規模な最適化。並列 Hash join に対して有効に働く可能性があります。 [#80328](https://github.com/ClickHouse/ClickHouse/pull/80328) ([李扬](https://github.com/taiyang-li)).
* 主キー範囲からマーク範囲を選択する際、主キーが関数でラップされている場合は二分探索を使用できませんでした。このPRにより、この制限が緩和されます。主キーが常に単調な関数のチェーンでラップされている場合、またはRPNに常に真となる要素が含まれている場合でも、二分探索を適用できるようになりました。このPRは [#45536](https://github.com/ClickHouse/ClickHouse/issues/45536) をクローズします。 [#80597](https://github.com/ClickHouse/ClickHouse/pull/80597) ([zoomxi](https://github.com/zoomxi))。
* Kafka エンジンのシャットダウン速度を向上しました（複数の Kafka テーブルがある場合に発生していた余分な 3 秒の遅延を削除）。 [#80796](https://github.com/ClickHouse/ClickHouse/pull/80796) ([Azat Khuzhin](https://github.com/azat)).
* 非同期インサートのメモリ使用量を削減し、INSERT クエリの性能を改善。 [#80972](https://github.com/ClickHouse/ClickHouse/pull/80972) ([Raúl Marín](https://github.com/Algunenano)).
* ログテーブルが無効な場合はプロセッサをプロファイルしないようにしました。 [#81256](https://github.com/ClickHouse/ClickHouse/pull/81256) ([Raúl Marín](https://github.com/Algunenano)).
* ソースが要求どおりの内容である場合に `toFixedString` を高速化しました。 [#81257](https://github.com/ClickHouse/ClickHouse/pull/81257) ([Raúl Marín](https://github.com/Algunenano))。
* ユーザーに制限がない場合はクオータ値を処理しないようにしました。 [#81549](https://github.com/ClickHouse/ClickHouse/pull/81549) ([Raúl Marín](https://github.com/Algunenano)).
* タスク間でファイルを開いたままにしておくために、ProcfsMetricsProvider を thread&#95;local にしました。 [#81576](https://github.com/ClickHouse/ClickHouse/pull/81576) ([Raúl Marín](https://github.com/Algunenano)).
* メモリトラッキングにおけるパフォーマンスの低下を修正しました。 [#81694](https://github.com/ClickHouse/ClickHouse/pull/81694) ([Michael Kolupaev](https://github.com/al13n321)).





## 改善 {#improvement}


#* `clickhouse-local` は `--path` コマンドライン引数を指定することで、再起動後もデータベースを保持するようになります。これにより以下の問題が解決されます: [#50647](https://github.com/ClickHouse/ClickHouse/issues/50647)。これにより以下の問題が解決されます: [#49947](https://github.com/ClickHouse/ClickHouse/issues/49947). [#71722](https://github.com/ClickHouse/ClickHouse/pull/71722) ([Alexey Milovidov](https://github.com/alexey-milovidov)).

* `EXPLAIN SYNTAX` は新しいアナライザを使用するようになりました。クエリツリーから構築された抽象構文木 (AST) を返します。クエリツリーを AST に変換する前に適用されるパスの回数を制御するためのオプション `query_tree_passes` を追加しました。[#74536](https://github.com/ClickHouse/ClickHouse/pull/74536) ([Vladimir Cherkasov](https://github.com/vdimir)).
  #* ファイルシステムキャッシュのデフォルトとして SLRU キャッシュポリシーを使用します。[#75072](https://github.com/ClickHouse/ClickHouse/pull/75072) ([Kseniia Sumarokova](https://github.com/kssenii)).
* ビューへのプッシュ処理ロジックをリファクタリングしました。 [#77309](https://github.com/ClickHouse/ClickHouse/pull/77309) ([Sema Checherinda](https://github.com/CheSema))。
* オブジェクトストレージクラスタテーブル関数（例: `s3Cluster`）では、キャッシュ局所性を向上させるために、コンシステントハッシュに基づいて読み取り対象のファイルをレプリカに割り当てるようになりました。 [#77326](https://github.com/ClickHouse/ClickHouse/pull/77326) ([Andrej Hoos](https://github.com/adikus))。
* エラー `AuthenticationRequired` 発生後に S3 クレデンシャルをリフレッシュするようにしました。 [#77353](https://github.com/ClickHouse/ClickHouse/pull/77353) ([Vitaly Baranov](https://github.com/vitlibar)).
* ビルダーを使用して、一部の HTTP バッファーにプロキシ設定を埋め込めるようにしました。 [#77693](https://github.com/ClickHouse/ClickHouse/pull/77693) ([Arthur Passos](https://github.com/arthurpassos)).
* `system.asynchronous_metrics` に辞書メトリクスを追加しました。`DictionaryMaxUpdateDelay` - 辞書更新の最大遅延時間（秒）。`DictionaryTotalFailedUpdates` - すべての辞書で、最後に正常にロードされてから発生したエラーの合計数。 [#78175](https://github.com/ClickHouse/ClickHouse/pull/78175) ([Vlad](https://github.com/codeworse)).
* 右側の引数がゼロの場合に NULL を返す `divideOrNull`、`moduloOrNull`、`intDivOrNull`、`positiveModuloOrNull` 関数を追加しました。 [#78276](https://github.com/ClickHouse/ClickHouse/pull/78276) ([kevinyhzou](https://github.com/KevinyhZou)).
* `isIPAddressInRange` 関数を String、IPv4、IPv6、Nullable(String)、Nullable(IPv4)、Nullable(IPv6) の各データ型で利用できるように拡張しました。 [#78364](https://github.com/ClickHouse/ClickHouse/pull/78364) ([YjyJeff](https://github.com/YjyJeff))。
* PostgreSQL エンジンのコネクションプーラー設定を動的に変更できるようになりました。 [#78414](https://github.com/ClickHouse/ClickHouse/pull/78414) ([Samay Sharma](https://github.com/samay-sharma)).
* 通常の projection で `_part_offset` を指定できるようにしました。これは projection index を構築するための第一歩です。[#58224](https://github.com/ClickHouse/ClickHouse/issues/58224) と組み合わせて使用でき、[https://github.com/ClickHouse/ClickHouse/pull/63207](https://github.com/ClickHouse/ClickHouse/pull/63207) の改善に役立ちます。[#78429](https://github.com/ClickHouse/ClickHouse/pull/78429)（[Amos Bird](https://github.com/amosbird)）。
* 分散クエリにおけるシャーディングキーの最適化を向上しました。 [#78452](https://github.com/ClickHouse/ClickHouse/pull/78452) ([fhw12345](https://github.com/fhw12345)).
* `system.named_collections` に新しいカラム（`create_query` と `source`）を追加しました。 [#78179](https://github.com/ClickHouse/ClickHouse/issues/78179) をクローズ。 [#78582](https://github.com/ClickHouse/ClickHouse/pull/78582)（[MikhailBurdukov](https://github.com/MikhailBurdukov)）。
* `system.query_condition_cache` システムテーブルに `condition` フィールドを追加しました。クエリ条件キャッシュでキーとして使用されるハッシュ値の元となる平文の条件を保持します。 [#78671](https://github.com/ClickHouse/ClickHouse/pull/78671) ([Robert Schulze](https://github.com/rschu1ze)).
* ClickHouse Keeper を使用して StorageKafka2 に対し、Kafka のリバランスに類似したロジックを実装しました。各レプリカでは 2 種類のパーティションロック（恒久ロックと一時ロック）をサポートします。レプリカは可能な限り恒久ロックを保持しようとしますが、任意の時点でレプリカ上の恒久ロック数は `all_topic_partitions / active_replicas_count`（ここで `all_topic_partitions` はすべてのパーティション数、`active_replicas_count` はアクティブなレプリカ数）を超えません。これを超えた場合、レプリカはいくつかのパーティションを解放します。いくつかのパーティションはレプリカによって一時的に保持されます。レプリカ上の一時ロックの最大数は動的に変化し、他のレプリカが一部のパーティションを恒久ロックとして取得できるようにします。一時ロックを更新する際、レプリカはそれらをすべて解放し、再度別のパーティションのロック取得を試みます。[#78726](https://github.com/ClickHouse/ClickHouse/pull/78726)（[Daria Fomina](https://github.com/sinfillo)）。
* `Kafka` テーブルエンジンに、SASL 構成および認証情報用のテーブル設定を追加しました。これにより、設定ファイルや名前付きコレクションを使用することなく、`CREATE TABLE` ステートメント内で直接、Kafka および Kafka 互換システムに対する SASL ベースの認証を設定できるようになります。 [#78810](https://github.com/ClickHouse/ClickHouse/pull/78810) ([Christoph Wurm](https://github.com/cwurm))。
* 破損したテーブルを保存するために作成された可能性のあるデータベースについて、警告を追加しました。 [#78841](https://github.com/ClickHouse/ClickHouse/pull/78841) ([János Benjamin Antal](https://github.com/antaljanosbenjamin)).
* `BFloat16` カラムに対してベクトル類似性インデックスを作成できるようになりました。 [#78850](https://github.com/ClickHouse/ClickHouse/pull/78850) ([Robert Schulze](https://github.com/rschu1ze))。
* `DateTime64` のベストエフォートパースで、小数部を持つ Unix タイムスタンプをサポート。 [#78908](https://github.com/ClickHouse/ClickHouse/pull/78908) ([Pavel Kruglov](https://github.com/Avogar)).
* ストレージ DeltaLake の delta-kernel 実装において columnMappingMode.name を修正し、スキーマ進化用のテストを追加。 [#78921](https://github.com/ClickHouse/ClickHouse/pull/78921) ([Kseniia Sumarokova](https://github.com/kssenii)).
* `Values` フォーマットでの `Variant` 列への挿入時に、値の変換処理を改善。 [#78923](https://github.com/ClickHouse/ClickHouse/pull/78923) ([Pavel Kruglov](https://github.com/Avogar)).
* `S3Queue` エンジンに `_time` 仮想カラムを追加。 [#78926](https://github.com/ClickHouse/ClickHouse/pull/78926) ([Anton Ivashkin](https://github.com/ianton-ru)).
* `tokens` 関数が拡張され、追加の「tokenizer」引数および tokenizer 固有の追加引数を受け取れるようになりました。 [#79001](https://github.com/ClickHouse/ClickHouse/pull/79001) ([Elmi Ahmadov](https://github.com/ahmadov)).
* `SHOW CLUSTER` ステートメントは、引数内のマクロ（存在する場合）を展開するようになりました。 [#79006](https://github.com/ClickHouse/ClickHouse/pull/79006) ([arf42](https://github.com/arf42))。
* ハッシュ関数が、配列、タプル、マップ内の `NULL` をサポートするようになりました（issue [#48365](https://github.com/ClickHouse/ClickHouse/issues/48365)、[#48623](https://github.com/ClickHouse/ClickHouse/issues/48623)）。[#79008](https://github.com/ClickHouse/ClickHouse/pull/79008)（[Michael Kolupaev](https://github.com/al13n321)）。
* 読み取り専用 MergeTree テーブルでのリフレッシュをサポート。 [#79033](https://github.com/ClickHouse/ClickHouse/pull/79033) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* cctz を 2025a に更新。 [#79043](https://github.com/ClickHouse/ClickHouse/pull/79043) ([Raúl Marín](https://github.com/Algunenano)).
* CPU 過負荷時の接続切断を制御する設定をホットリロード可能にしました。 [#79052](https://github.com/ClickHouse/ClickHouse/pull/79052) ([Alexey Katsman](https://github.com/alexkats))。
* ユーザーの利便性が向上します。 [#79066](https://github.com/ClickHouse/ClickHouse/pull/79066) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* クエリ条件キャッシュをデフォルトで有効にしました。 [#79080](https://github.com/ClickHouse/ClickHouse/pull/79080) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* Web UI でタブの操作を元に戻せるようにしました。これにより [#71284](https://github.com/ClickHouse/ClickHouse/issues/71284) がクローズされました。 [#79084](https://github.com/ClickHouse/ClickHouse/pull/79084) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `recoverLostReplica` 中の設定を、[https://github.com/ClickHouse/ClickHouse/pull/78637](https://github.com/ClickHouse/ClickHouse/pull/78637) と同様に削除しました。 [#79113](https://github.com/ClickHouse/ClickHouse/pull/79113)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* Parquet インデックスのプルーニングをプロファイルするために、ProfileEvents の `ParquetReadRowGroups` と `ParquetPrunedRowGroups` を追加しました。 [#79180](https://github.com/ClickHouse/ClickHouse/pull/79180) ([flynn](https://github.com/ucasfl))。
* Azure Blob Storage 上のプレーンディスクに対して `system.tables` で報告されるデータパスにコンテナプレフィックスを追加し、S3 および GCP と報告内容を整合させました。 [#79241](https://github.com/ClickHouse/ClickHouse/pull/79241) ([Julia Kartseva](https://github.com/jkartseva)).
* `ON CLUSTER` 付きのデータベースに対する `ALTER` をサポート。[#79242](https://github.com/ClickHouse/ClickHouse/pull/79242)（[Tuan Pham Anh](https://github.com/tuanpach)）。
* QueryMetricLog の統計収集で取りこぼした期間は明示的にスキップするようにしました。そうしないと、現在時刻に追いつくまでログに非常に長い時間がかかってしまいます。 [#79257](https://github.com/ClickHouse/ClickHouse/pull/79257) ([Mikhail Artemenko](https://github.com/Michicosun)).
* `lightweight_deletes_sync = 0`、`apply_mutations_on_fly = 1` の設定時に、ライトウェイト削除をオンザフライで適用できるようになりました。 [#79281](https://github.com/ClickHouse/ClickHouse/pull/79281) ([Anton Popov](https://github.com/CurtizJ)).
* すべての行を削除すべきパーツに対する `ALTER ... DELETE` ミューテーションを最適化しました。このような場合、ミューテーションを実行せずに、元のパーツの代わりに空のパーツが作成されるようになりました。 [#79307](https://github.com/ClickHouse/ClickHouse/pull/79307) ([Anton Popov](https://github.com/CurtizJ)).
* `CHColumnToArrowColumn` に対する細かな最適化。 [#79308](https://github.com/ClickHouse/ClickHouse/pull/79308) ([Bharat Nallan](https://github.com/bharatnc)).
* 設定 `allow_archive_path_syntax` は誤って experimental としてマークされていました。experimental な設定がデフォルトで有効になってしまわないようにするテストを追加しました。 [#79320](https://github.com/ClickHouse/ClickHouse/pull/79320) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* ページキャッシュ設定をクエリ単位で調整可能にしました。これにより、より高速な検証や、高スループットかつ低レイテンシーなクエリ向けのきめ細かなチューニングが可能になります。 [#79337](https://github.com/ClickHouse/ClickHouse/pull/79337) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* ほとんどの 64-bit ハッシュのように見える数値については、数値ヒントを見やすい形式では出力しないようにしました。これにより [#79334](https://github.com/ClickHouse/ClickHouse/issues/79334) が解決されました。[#79338](https://github.com/ClickHouse/ClickHouse/pull/79338)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* pretty フォーマットのデータがターミナルに表示され、その後続するブロックの列幅が同じであれば、カーソルを上に移動して前のブロックに続けて表示し、前のブロックとつなげて表示できます。これにより [#79333](https://github.com/ClickHouse/ClickHouse/issues/79333) が解決されました。この機能は新しい設定 `output_format_pretty_glue_chunks` によって制御されます。[#79339](https://github.com/ClickHouse/ClickHouse/pull/79339) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 詳細ダッシュボード上のグラフの色は、対応するクエリのハッシュ値から計算されます。これにより、ダッシュボードをスクロールしている際にグラフを覚えやすくなり、目的のグラフをすばやく見つけられます。 [#79341](https://github.com/ClickHouse/ClickHouse/pull/79341) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 非同期メトリクス `FilesystemCacheCapacity` を追加しました。`cache` 仮想ファイルシステムの総容量を表し、グローバルなインフラストラクチャ監視に役立ちます。 [#79348](https://github.com/ClickHouse/ClickHouse/pull/79348) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* system.parts へのアクセスを最適化（要求された場合にのみ列/インデックスのサイズを読み取るように）しました。 [#79352](https://github.com/ClickHouse/ClickHouse/pull/79352) ([Azat Khuzhin](https://github.com/azat)).
* クエリ `'SHOW CLUSTER <name>'` に対して、すべてのフィールドではなく重要なフィールドのみを選択するようにしました。 [#79368](https://github.com/ClickHouse/ClickHouse/pull/79368) ([Tuan Pham Anh](https://github.com/tuanpach)).
* `DatabaseCatalog` のストレージ設定を指定可能になりました。 [#79407](https://github.com/ClickHouse/ClickHouse/pull/79407) ([Kseniia Sumarokova](https://github.com/kssenii)).
* delta kernel でローカルストレージをサポートしました。 [#79416](https://github.com/ClickHouse/ClickHouse/pull/79416) ([Kseniia Sumarokova](https://github.com/kssenii)).
* クエリレベルで delta-kernel-rs を有効化するための設定 `allow_experimental_delta_kernel_rs` を追加しました。[#79418](https://github.com/ClickHouse/ClickHouse/pull/79418) ([Kseniia Sumarokova](https://github.com/kssenii)).
* Azure/S3 ブロブ ストレージからのブロブ一覧取得時に発生しうる無限ループを修正しました。 [#79425](https://github.com/ClickHouse/ClickHouse/pull/79425) ([Alexander Gololobov](https://github.com/davenger)).
* これにより、ClickHouse はクエリパラメータとして `param_<name>`（アンダースコア）だけでなく `param-<name>`（ダッシュ）も受け付けるようになりました。これにより [#63093](https://github.com/ClickHouse/ClickHouse/issues/63093) が解決されました。 [#79429](https://github.com/ClickHouse/ClickHouse/pull/79429)（[Engel Danila](https://github.com/aaaengel)）。
  #* ファイルシステムキャッシュ設定 `max_size_ratio_to_total_space` を追加しました。 [#79460](https://github.com/ClickHouse/ClickHouse/pull/79460)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* ローカルからリモートの S3 へチェックサムを有効にしてデータをコピーする際の帯域幅割引について、より詳細な警告メッセージを追加。 [#79464](https://github.com/ClickHouse/ClickHouse/pull/79464) ([VicoWu](https://github.com/VicoWu)).
* `clickhouse-benchmark` の `reconnect` オプションを再設定し、再接続の回数に応じて 0、1、または N を値として指定できるようにしました。[#79465](https://github.com/ClickHouse/ClickHouse/pull/79465)（[Sachin Kumar Singh](https://github.com/sachinkumarsingh092)）。
* `input_format_max_block_size_bytes` 設定を追加し、入力フォーマットで作成されるブロックのサイズをバイト単位で制限できるようにしました。これにより、行に大きな値が含まれている場合のデータインポート時のメモリ使用量の増大を抑えるのに役立ちます。 [#79495](https://github.com/ClickHouse/ClickHouse/pull/79495) ([Pavel Kruglov](https://github.com/Avogar)).
* sparseGrams の速度とメモリ使用量を向上。 [#79517](https://github.com/ClickHouse/ClickHouse/pull/79517) ([Konstantin Vedernikov](https://github.com/scanhex12)).
* 可能な場合、挿入時に Compact パートへのブロックの余分なコピーを行わないようにしました。 [#79536](https://github.com/ClickHouse/ClickHouse/pull/79536) ([Pavel Kruglov](https://github.com/Avogar))。
* `DeltaLake` ストレージの delta-kernel 実装をデフォルトで有効にしました。 [#79541](https://github.com/ClickHouse/ClickHouse/pull/79541) ([Kseniia Sumarokova](https://github.com/kssenii)).
* URL からの読み取りで複数回のリダイレクトが発生する場合、チェーン内のすべてのリダイレクトに対して `enable_url_encoding` の設定が正しく適用されるようになりました。 [#79563](https://github.com/ClickHouse/ClickHouse/pull/79563) ([Shankar Iyer](https://github.com/shankar-iyer)).
* 異なる plain&#95;rewritable ディスク上のテーブル間で `ALTER TABLE ... MOVE|REPLACE PARTITION` を実行できるようにしました。 [#79566](https://github.com/ClickHouse/ClickHouse/pull/79566) ([Julia Kartseva](https://github.com/jkartseva)).
* `WHERE` 句でのスカラー相関サブクエリをサポートしました。 [#6697](https://github.com/ClickHouse/ClickHouse/issues/6697) をクローズ。 [#79600](https://github.com/ClickHouse/ClickHouse/pull/79600) ([Dmitry Novik](https://github.com/novikd))。
* 以前は `input_format_parquet_max_block_size = 0` のときに ClickHouse がハングしていましたが、この問題は修正されました。これにより [#79394](https://github.com/ClickHouse/ClickHouse/issues/79394) がクローズされます。[#79601](https://github.com/ClickHouse/ClickHouse/pull/79601)（[abashkeev](https://github.com/abashkeev)）。
* startup&#95;scripts 向けに `throw_on_error` 設定を追加しました。`throw_on_error` が true の場合、すべてのクエリが正常に完了しない限りサーバーは起動しません。デフォルトでは `throw_on_error` は false であり、従来の動作が維持されます。 [#79732](https://github.com/ClickHouse/ClickHouse/pull/79732) ([Aleksandr Musorin](https://github.com/AVMusorin)).
* 参照ベクターが `Array(BFloat16)` 型の場合にも、ベクター類似度インデックスが利用されるようになりました。 [#79745](https://github.com/ClickHouse/ClickHouse/pull/79745) ([Shankar Iyer](https://github.com/shankar-iyer)).
* `system.error_log` テーブルに `last_error_message`、`last_error_trace`、`query_id` を追加。関連チケット [#75816](https://github.com/ClickHouse/ClickHouse/issues/75816)。[#79836](https://github.com/ClickHouse/ClickHouse/pull/79836)（[Andrei Tinikov](https://github.com/Dolso)）。
* システムテーブル `system.functions` に、各関数が最初に導入された ClickHouse バージョンが表示されるようになりました。 [#79839](https://github.com/ClickHouse/ClickHouse/pull/79839) ([Robert Schulze](https://github.com/rschu1ze))。
* `access_control_improvements.enable_user_name_access_type` 設定を追加しました。この設定により、[https://github.com/ClickHouse/ClickHouse/pull/72246](https://github.com/ClickHouse/ClickHouse/pull/72246) で導入された、ユーザー/ロールに対する厳密な権限付与（GRANT）の有効化/無効化が可能になります。25.1 より古いレプリカを含むクラスターがある場合には、この設定をオフにすることを検討してください。 [#79842](https://github.com/ClickHouse/ClickHouse/pull/79842) ([pufit](https://github.com/pufit))。
* `ASTSelectWithUnionQuery::clone()` メソッドの適切な実装において、`is_normalized` フィールドも考慮されるようになりました。これにより [#77569](https://github.com/ClickHouse/ClickHouse/issues/77569) の解決に役立つ可能性があります。 [#79909](https://github.com/ClickHouse/ClickHouse/pull/79909) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov)).
* 単純なケースで、SELECT 句の射影リスト内における相関サブクエリをサポート。 [#79925](https://github.com/ClickHouse/ClickHouse/pull/79925) ([Dmitry Novik](https://github.com/novikd))。
* `EXCEPT` 演算子を含む一部クエリの不整合なフォーマットを修正します。`EXCEPT` 演算子の左辺が `*` で終わる場合、フォーマット後のクエリからかっこが失われ、その結果 `EXCEPT` 修飾子付きの `*` としてパースされてしまいます。これらのクエリは fuzzer によって検出されたものであり、実際に利用される場面で見つかる可能性は低いと考えられます。この変更により [#79950](https://github.com/ClickHouse/ClickHouse/issues/79950) がクローズされました。 [#79952](https://github.com/ClickHouse/ClickHouse/pull/79952) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* あらゆる種類の `http_handlers` で `http_response_headers` を追加できるようになりました。 [#79975](https://github.com/ClickHouse/ClickHouse/pull/79975) ([Andrey Zvonov](https://github.com/zvonand)).
* バリアントのデシリアライズ順序をキャッシュすることで、`JSON` 型のパース処理をわずかに改善しました。 [#79984](https://github.com/ClickHouse/ClickHouse/pull/79984) ([Pavel Kruglov](https://github.com/Avogar)).
* 適用可能な場合に、`GLOBAL [NOT] IN` 述語を `PREWHERE` 句へ移動できるようにしました。 [#79996](https://github.com/ClickHouse/ClickHouse/pull/79996) ([Eduard Karacharov](https://github.com/korowa)).
* 設定 `s3_slow_all_threads_after_network_error` を追加。 [#80035](https://github.com/ClickHouse/ClickHouse/pull/80035) ([Vitaly Baranov](https://github.com/vitlibar)).
* マージ対象として選択されたパーツに関するログレベルが誤っていました（Information）。[#80061](https://github.com/ClickHouse/ClickHouse/issues/80061) をクローズしました。[#80062](https://github.com/ClickHouse/ClickHouse/pull/80062)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 関数 reverse が Tuple データ型をサポートするようになりました。 [#80053](https://github.com/ClickHouse/ClickHouse/issues/80053) をクローズ。 [#80083](https://github.com/ClickHouse/ClickHouse/pull/80083)（[flynn](https://github.com/ucasfl)）。
* `enble_url_encoding` 設定のデフォルト値が `False` に設定されました。 [#80088](https://github.com/ClickHouse/ClickHouse/pull/80088) ([Shankar Iyer](https://github.com/shankar-iyer)).
* この小さなパッチは [#75817](https://github.com/ClickHouse/ClickHouse/issues/75817) を解決し、`system.zookeeper` テーブルから `auxiliary_zookeepers` のデータを取得できるようにします。 [#80146](https://github.com/ClickHouse/ClickHouse/pull/80146)（[Nikolay Govorov](https://github.com/mrdimidium)）。
* ベクトル類似インデックスを使用したベクトル検索機能が、実験的機能からベータ版になりました。 [#80164](https://github.com/ClickHouse/ClickHouse/pull/80164) ([Robert Schulze](https://github.com/rschu1ze)).
* サーバーの TCP ソケットに関する非同期メトリクスを追加しました。これによりオブザーバビリティが向上します。[#80187](https://github.com/ClickHouse/ClickHouse/issues/80187) をクローズしました。[#80188](https://github.com/ClickHouse/ClickHouse/pull/80188)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 関数 `tokens` がトークナイザーとして `string` をサポートするようになりました。 [#80195](https://github.com/ClickHouse/ClickHouse/pull/80195) ([Robert Schulze](https://github.com/rschu1ze))。
* Parallel replicas: すべての読み取りタスクが他のレプリカに割り当て済みの場合、未使用の遅いレプリカを待たないようにしました。 [#80199](https://github.com/ClickHouse/ClickHouse/pull/80199) ([Igor Nikonov](https://github.com/devcrafter)).
* `simpleAggregateFunction` で `anylast_respect_nulls` と `any_respect_nulls` をサポートしました。 [#80219](https://github.com/ClickHouse/ClickHouse/pull/80219) ([Diskein](https://github.com/Diskein)).
* レプリケーテッドデータベースに対する不要な `adjustCreateQueryForBackup()` 呼び出しを削除しました。[#80282](https://github.com/ClickHouse/ClickHouse/pull/80282)（[Vitaly Baranov](https://github.com/vitlibar)）。
  #* `clickhouse-local` で、`-- --config.value='abc'` のように `--` の後ろに続く追加オプションを、等号なしでも指定できるようにしました。[#80292](https://github.com/ClickHouse/ClickHouse/issues/80292) をクローズ。[#80293](https://github.com/ClickHouse/ClickHouse/pull/80293)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `SHOW ... LIKE` クエリ内のメタ文字をハイライトします。これにより [#80275](https://github.com/ClickHouse/ClickHouse/issues/80275) がクローズされます。 [#80297](https://github.com/ClickHouse/ClickHouse/pull/80297)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
  #* `clickhouse-local` で SQL UDF を永続化します。既に作成済みの関数は起動時にロードされます。これにより [#80085](https://github.com/ClickHouse/ClickHouse/issues/80085) がクローズされます。 [#80300](https://github.com/ClickHouse/ClickHouse/pull/80300)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `Time`/`Time64` 間の比較に対応しました。 [#80327](https://github.com/ClickHouse/ClickHouse/pull/80327) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* 予備的な `DISTINCT` ステップに対する `EXPLAIN` プラン上の説明を修正しました。 [#80330](https://github.com/ClickHouse/ClickHouse/pull/80330) ([UnamedRus](https://github.com/UnamedRus)).
* ODBC/JDBC で名前付きコレクションを使用できるようにしました。 [#80334](https://github.com/ClickHouse/ClickHouse/pull/80334) ([Andrey Zvonov](https://github.com/zvonand))。
* 複数プロジェクションでのフィルタリングをサポートし、パートレベルのフィルタリングに複数のプロジェクションを使用できるようにしました。これは [#55525](https://github.com/ClickHouse/ClickHouse/issues/55525) への対応です。これは [#78429](https://github.com/ClickHouse/ClickHouse/issues/78429) に続く、プロジェクションインデックス実装の第 2 段階です。[#80343](https://github.com/ClickHouse/ClickHouse/pull/80343)（[Amos Bird](https://github.com/amosbird)）。
* 読み取り専用ディスクおよび破損ディスクの数を示すメトリクス。`DiskLocalCheckThread` の起動時にインジケーターをログ出力します。 [#80391](https://github.com/ClickHouse/ClickHouse/pull/80391) ([VicoWu](https://github.com/VicoWu)).
* `s3_plain_rewritable` ストレージでプロジェクションをサポートするようにしました。以前のバージョンでは、プロジェクションを参照している S3 上のメタデータオブジェクトは、移動時に更新されませんでした。[#70258](https://github.com/ClickHouse/ClickHouse/issues/70258) をクローズ。[#80393](https://github.com/ClickHouse/ClickHouse/pull/80393)（[Sav](https://github.com/sberss)）。
* Parallel replicas は専用の接続タイムアウトを使用します。`parallel_replicas_connect_timeout_ms` 設定を参照してください。以前は、parallel replicas クエリの接続タイムアウト値として `connect_timeout_with_failover_ms` / `connect_timeout_with_failover_secure_ms` 設定が使用されていました（デフォルトは 1 秒）。[#80421](https://github.com/ClickHouse/ClickHouse/pull/80421)（[Igor Nikonov](https://github.com/devcrafter)）。
* `SYSTEM UNFREEZE` コマンドは、readonly ディスクおよび write-once ディスク上のパーツを参照しようとしません。これにより [#80430](https://github.com/ClickHouse/ClickHouse/issues/80430) がクローズされました。[#80432](https://github.com/ClickHouse/ClickHouse/pull/80432)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* マージ済みパーツに関するメッセージのログレベルを INFO から TRACE に変更しました。 [#80476](https://github.com/ClickHouse/ClickHouse/pull/80476) ([Hans Krutzer](https://github.com/hkrutzer)).
* Native フォーマットにおいて Dynamic と JSON 用のフラットなシリアル化を実装し、Dynamic の shared variant や JSON の shared data のような特別な構造を使わずに Dynamic および JSON データをシリアル化／デシリアル化できるようにしました。このシリアル化は、`output_format_native_use_flattened_dynamic_and_json_serialization` を設定することで有効化できます。このシリアル化は、さまざまな言語で実装されたクライアントにおいて、TCP プロトコルで Dynamic および JSON をより簡単にサポートするために使用できます。[#80499](https://github.com/ClickHouse/ClickHouse/pull/80499)（[Pavel Kruglov](https://github.com/Avogar)）。
* Iceberg テーブルにおけるパーティションプルーニングのデフォルト動作を変更。 [#80583](https://github.com/ClickHouse/ClickHouse/pull/80583) ([Melvyn Peignon](https://github.com/melvynator)).
* インデックス検索アルゴリズムの可観測性を高めるため、`IndexBinarySearchAlgorithm` と `IndexGenericExclusionSearchAlgorithm` という 2 つの新しい ProfileEvents を追加しました。 [#80679](https://github.com/ClickHouse/ClickHouse/pull/80679) ([Pablo Marcos](https://github.com/pamarcos)).
* 古いカーネルで `MADV_POPULATE_WRITE` が未サポートであることについて、ログに警告を出さないようにしました（ログが不要に増えるのを防ぐため）。 [#80704](https://github.com/ClickHouse/ClickHouse/pull/80704) ([Robert Schulze](https://github.com/rschu1ze)).
* TTL での Date32 および DateTime64 のサポートを追加しました。 [#80710](https://github.com/ClickHouse/ClickHouse/pull/80710) ([Andrey Zvonov](https://github.com/zvonand)).
* `max_merge_delayed_streams_for_parallel_write` の互換性用の値を調整しました。 [#80760](https://github.com/ClickHouse/ClickHouse/pull/80760) ([Azat Khuzhin](https://github.com/azat)).
* クラッシュを修正: デストラクタ内で一時ファイル（ディスク上に一時データをスピルするために使用される）を削除しようとした際に例外がスローされると、プログラムが異常終了する可能性がある問題を修正しました。 [#80776](https://github.com/ClickHouse/ClickHouse/pull/80776) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `SYSTEM SYNC REPLICA` に `IF EXISTS` 修飾子を追加。 [#80810](https://github.com/ClickHouse/ClickHouse/pull/80810) ([Raúl Marín](https://github.com/Algunenano)).
* 「Having zero bytes, but read range is not finished...」という例外メッセージを拡張し、`system.filesystem_cache` に `finished_download_time` カラムを追加しました。 [#80849](https://github.com/ClickHouse/ClickHouse/pull/80849) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 以前は、フルテキストインデックスでは `packed` ストレージはサポートされていませんでした。これは、セグメント ID がディスク上の `.gin_sid` ファイルを読み書きすることでオンザフライに更新されていたためです。`packed` ストレージでは、コミット前のファイルから値を読み取ることがサポートされておらず、これが問題の原因となっていました。[#80852](https://github.com/ClickHouse/ClickHouse/pull/80852)（[Elmi Ahmadov](https://github.com/ahmadov)）。
* `indexes = 1` を指定して `EXPLAIN` を使用した場合の出力に、検索アルゴリズムのセクションを追加しました。これにより、「binary search」または「generic exclusion search」のどちらかが表示されます。 [#80881](https://github.com/ClickHouse/ClickHouse/pull/80881) ([Pablo Marcos](https://github.com/pamarcos))。
* 2024年の初めに、新しいアナライザーがデフォルトで有効になっていなかったため、MySQL handler では `prefer_column_name_to_alias` が True にハードコードされていました。現在は、そのハードコードが解除されています。 [#80916](https://github.com/ClickHouse/ClickHouse/pull/80916) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* 現在、`system.iceberg_history` は glue や iceberg REST などのカタログデータベースの履歴を表示します。また、一貫性のため、`system.iceberg_history` 内の `table_name` 列と `database_name` 列をそれぞれ `table` と `database` にリネームしました。 [#80975](https://github.com/ClickHouse/ClickHouse/pull/80975) ([alesapin](https://github.com/alesapin))。
* `merge` テーブル関数で読み取り専用モードを利用できるようにし、それを使用する際に `CREATE TEMPORARY TABLE` 権限が不要になるようにしました。 [#80981](https://github.com/ClickHouse/ClickHouse/pull/80981) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* インメモリキャッシュのインスペクションを改善し、不完全だった `system.asynchronouse_metrics` ではなく `system.metrics` でキャッシュに関する情報を公開するようにしました。インメモリキャッシュのサイズ（バイト単位）を `dashboard.html` に追加しました。`VectorSimilarityIndexCacheSize` / `IcebergMetadataFilesCacheSize` は `VectorSimilarityIndexCacheBytes` / `IcebergMetadataFilesCacheBytes` にリネームされました。[#81023](https://github.com/ClickHouse/ClickHouse/pull/81023)（[Azat Khuzhin](https://github.com/azat)）。
* system.rocksdb から読み込む際に、RocksDB テーブルを格納できないエンジンを使用するデータベースを無視するようにしました。 [#81083](https://github.com/ClickHouse/ClickHouse/pull/81083) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* `clickhouse-local` の設定ファイルで `filesystem_caches` と `named_collections` を使用できるようにしました。 [#81105](https://github.com/ClickHouse/ClickHouse/pull/81105) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `INSERT`クエリにおける`PARTITION BY`のハイライト表示を修正しました。以前のバージョンでは、`PARTITION BY`がキーワードとしてハイライト表示されていませんでした。[#81106](https://github.com/ClickHouse/ClickHouse/pull/81106) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
  #* Web UIの2つの小さな改善:`CREATE`、`INSERT`などの出力のないクエリを正しく処理するようになりました(最近まで、これらのクエリは無限スピナーを引き起こしていました);テーブルをダブルクリックすると、最上部までスクロールするようになりました。[#81131](https://github.com/ClickHouse/ClickHouse/pull/81131) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
  #* `c-ares`を`v1.34.5`に更新しました。[#81159](https://github.com/ClickHouse/ClickHouse/pull/81159) ([Konstantin Bogdanov](https://github.com/thevar1able))。
  #* CVE-2025-5025およびCVE-2025-4947に対処するため、curlを8.14にアップグレードしました。[#81171](https://github.com/ClickHouse/ClickHouse/pull/81171) ([larryluogit](https://github.com/larryluogit))。
  #* 以下の脆弱性に対処するため、libarchiveを3.7.9にアップグレードしました: CVE-2024-20696 CVE-2025-25724 CVE-2024-48958 CVE-2024-57970 CVE-2025-1632 CVE-2024-48957 CVE-2024-48615。[#81174](https://github.com/ClickHouse/ClickHouse/pull/81174) ([larryluogit](https://github.com/larryluogit))。
  #* libxml2を2.14.3にアップグレードしました。[#81187](https://github.com/ClickHouse/ClickHouse/pull/81187) ([larryluogit](https://github.com/larryluogit))。
* `MemoryResidentWithoutPageCache` は、サーバープロセスが使用している物理メモリ量からユーザースペースページキャッシュを除いた値を、バイト単位で示します。これにより、ユーザースペースページキャッシュが利用されている場合に、実際のメモリ使用量をより正確に把握できます。ユーザースペースページキャッシュが無効になっている場合、この値は MemoryResident と同じになります。 [#81233](https://github.com/ClickHouse/ClickHouse/pull/81233) ([Jayme Bird](https://github.com/jaymebrd))。
* クライアント、ローカルサーバー、Keeper クライアント、および Disks アプリで手動でログ出力された例外を「ログ済み」とマークし、二重にログが出力されないようにしました。 [#81271](https://github.com/ClickHouse/ClickHouse/pull/81271) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* `use_skip_indexes_if_final` と `use_skip_indexes_if_final_exact_mode` の設定のデフォルト値が `True` になりました。`FINAL` 句を含むクエリは（該当する場合）スキップインデックスを使用してグラニュールを絞り込み、さらに一致するプライマリキー範囲に対応する追加のグラニュールも読み取るようになります。以前の近似的 / 不正確な結果を返す従来の動作が必要なユーザーは、十分な評価を行ったうえで `use_skip_indexes_if_final_exact_mode` を FALSE に設定できます。[#81331](https://github.com/ClickHouse/ClickHouse/pull/81331)（[Shankar Iyer](https://github.com/shankar-iyer)）。
* このPRでは、変換関数の単調性チェックにおける `is_strict` の実装上の問題に対処しています。現在、toFloat64(UInt32) や toDate(UInt8) などの一部の変換関数は、本来 true を返すべきところで誤って is&#95;strict を false と返しています。 [#81359](https://github.com/ClickHouse/ClickHouse/pull/81359) ([zoomxi](https://github.com/zoomxi)).
  #* ジャーナル付きファイルシステムでは、`mkdir` はディスクに永続化されるファイルシステムのジャーナルに書き込まれます。ディスクが遅い場合、これに時間がかかることがあります。そのため、reserve lock のスコープの外に移動することには十分な意味があります。 [#81371](https://github.com/ClickHouse/ClickHouse/pull/81371) ([Kseniia Sumarokova](https://github.com/kssenii)).
* `KeyCondition` が連続した範囲にマッチするかをチェックする際に、キーが非厳密な関数チェーンでラップされている場合は、`Constraint::POINT` を `Constraint::RANGE` に変換する必要が生じることがあります。たとえば、`toDate(event_time) = '2025-06-03'` は `event_time` に対して [&#39;2025-06-03 00:00:00&#39;, &#39;2025-06-04 00:00:00&#39;) という範囲を意味します。この PR はこの動作を修正します。 [#81400](https://github.com/ClickHouse/ClickHouse/pull/81400) ([zoomxi](https://github.com/zoomxi)).
  #* `postgres` 16.9 を使用。 [#81437](https://github.com/ClickHouse/ClickHouse/pull/81437) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* `openssl` 3.2.4 を使用。 [#81438](https://github.com/ClickHouse/ClickHouse/pull/81438) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* `abseil-cpp` 2025-01-27 を使用。 [#81440](https://github.com/ClickHouse/ClickHouse/pull/81440) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* `mongo-c-driver` 1.30.4 を使用。 [#81449](https://github.com/ClickHouse/ClickHouse/pull/81449) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* `krb5` 1.21.3-final を使用。 [#81453](https://github.com/ClickHouse/ClickHouse/pull/81453) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* `orc` 2.1.2 を使用。 [#81455](https://github.com/ClickHouse/ClickHouse/pull/81455) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* `clickhouse-local` で `--database` 引数をサポートしました。既に作成済みのデータベースに切り替えることができます。これにより [#44115](https://github.com/ClickHouse/ClickHouse/issues/44115) がクローズされました。 [#81465](https://github.com/ClickHouse/ClickHouse/pull/81465) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
  #* `clickhouse` / `ch` エイリアスは、`--host` または `--port` が指定されている場合、`clickhouse-local` ではなく `clickhouse-client` を起動します。 [#79422](https://github.com/ClickHouse/ClickHouse/issues/79422) の継続です。 [#65252](https://github.com/ClickHouse/ClickHouse/issues/65252) をクローズします。 [#81509](https://github.com/ClickHouse/ClickHouse/pull/81509) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* keeper の応答時間分布データが取得できたので、ヒストグラムのバケットを調整できるようになりました。[#81516](https://github.com/ClickHouse/ClickHouse/pull/81516)（[Miсhael Stetsyuk](https://github.com/mstetsyuk)）。
* クエリが初めて読み込まれるまで、Iceberg のマニフェストファイルの読み取りを遅延させます。 [#81619](https://github.com/ClickHouse/ClickHouse/pull/81619) ([Daniil Ivanik](https://github.com/divanik)).
  #* `grpc` 1.73.0 を使用します。 [#81629](https://github.com/ClickHouse/ClickHouse/pull/81629) ([Konstantin Bogdanov](https://github.com/thevar1able)).
  #* `delta-kernel-rs` v0.12.1 を使用します。 [#81707](https://github.com/ClickHouse/ClickHouse/pull/81707) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* プロファイルイベント `PageCacheReadBytes` を追加。[#81742](https://github.com/ClickHouse/ClickHouse/pull/81742) ([Kseniia Sumarokova](https://github.com/kssenii))。





## バグ修正（公式安定版リリースにおけるユーザーに影響する不具合） {#bug-fix-user-visible-misbehavior-in-an-official-stable-release}


* `SELECT EXCEPT` クエリを使用するパラメータ化ビューを修正しました。[#49447](https://github.com/ClickHouse/ClickHouse/issues/49447) をクローズしました。[#57380](https://github.com/ClickHouse/ClickHouse/pull/57380)（[Nikolay Degterinsky](https://github.com/evillique)）。
* Analyzer: join における列型の昇格後に列プロジェクション名を修正。[#63345](https://github.com/ClickHouse/ClickHouse/issues/63345) をクローズ。[#63519](https://github.com/ClickHouse/ClickHouse/pull/63519)（[Dmitry Novik](https://github.com/novikd)）。
* マテリアライズドビューが、たとえばそれにデータをストリーミングする Kafka テーブルよりも遅れて起動してしまう場合がありました。 [#72123](https://github.com/ClickHouse/ClickHouse/pull/72123) ([Ilya Golshtein](https://github.com/ilejn)).
* analyzer&#95;compatibility&#95;join&#95;using&#95;top&#95;level&#95;identifier が有効な場合に発生する、カラム名の衝突に関する論理エラーを修正しました。 [#75676](https://github.com/ClickHouse/ClickHouse/pull/75676) ([Vladimir Cherkasov](https://github.com/vdimir)).
* 複数の非同期（`alter_sync = 0`）な `RENAME COLUMN` および `ADD COLUMN` クエリの実行後に、`MergeTree` テーブルから読み取る際にまれに発生していたクラッシュを修正しました。 [#76346](https://github.com/ClickHouse/ClickHouse/pull/76346) ([Anton Popov](https://github.com/CurtizJ)).
* アナライザー有効時の `VIEW` 作成における `SELECT` クエリの書き換えを修正しました。 [#75956](https://github.com/ClickHouse/ClickHouse/issues/75956) をクローズします。 [#76356](https://github.com/ClickHouse/ClickHouse/pull/76356)（[Dmitry Novik](https://github.com/novikd)）。
* `allow_push_predicate_ast_for_distributed_subqueries` が有効な場合の、プッシュダウンされた述語における CTE の扱いを修正しました。[#75647](https://github.com/ClickHouse/ClickHouse/issues/75647) を修正。 [#79672](https://github.com/ClickHouse/ClickHouse/issues/79672) を修正。 [#77316](https://github.com/ClickHouse/ClickHouse/pull/77316)（[Dmitry Novik](https://github.com/novikd)）。
* サーバーからの `async_insert` の適用（`apply_settings_from_server` 経由）の問題を修正（以前はクライアント側で `Unknown packet 11 from server` エラーが発生していた）。 [#77578](https://github.com/ClickHouse/ClickHouse/pull/77578) ([Azat Khuzhin](https://github.com/azat)).
* レプリケートされたデータベースで、新たに追加されたレプリカ上で動作しなかったリフレッシュ可能な固定マテリアライズドビューの問題を修正しました。 [#77774](https://github.com/ClickHouse/ClickHouse/pull/77774) ([Michael Kolupaev](https://github.com/al13n321)).
* バックアップを破損させていたリフレッシュ可能な固定マテリアライズドビューを修正。 [#77893](https://github.com/ClickHouse/ClickHouse/pull/77893) ([Michael Kolupaev](https://github.com/al13n321)).
* `transform` における古い firing のロジックエラーを修正しました。 [#78247](https://github.com/ClickHouse/ClickHouse/pull/78247) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* `SYSTEM SYNC REPLICA LIGHTWEIGHT 'foo'` が、指定されたレプリカが存在しない場合でも成功を報告してしまう問題を修正しました。現在このコマンドは、同期を試みる前にレプリカが Keeper 内に存在するかどうかを正しく検証します。[#78405](https://github.com/ClickHouse/ClickHouse/pull/78405) ([Jayme Bird](https://github.com/jaymebrd)).
* アナライザー使用時にセカンダリインデックスが適用されない一部のケースを修正しました。 [#65607](https://github.com/ClickHouse/ClickHouse/issues/65607) および [#69373](https://github.com/ClickHouse/ClickHouse/issues/69373) を修正しました。 [#78485](https://github.com/ClickHouse/ClickHouse/pull/78485)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* HTTP プロトコルで圧縮が有効な場合のプロファイルイベント（`NetworkSendElapsedMicroseconds`/`NetworkSendBytes`）のダンプ処理を修正（誤差はバッファサイズ、通常は約 1MiB を超えないようにする）。 [#78516](https://github.com/ClickHouse/ClickHouse/pull/78516) ([Azat Khuzhin](https://github.com/azat))。
* `JOIN ... USING` に `ALIAS` 列が含まれている場合に `LOGICAL_ERROR` を発生させてしまっていた analyzer を修正し、代わりに適切なエラーを出力するようにしました。 [#78618](https://github.com/ClickHouse/ClickHouse/pull/78618) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* アナライザーを修正: SELECT に位置引数が含まれている場合に `CREATE VIEW ... ON CLUSTER` が失敗する問題を修正しました。 [#78663](https://github.com/ClickHouse/ClickHouse/pull/78663) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* `SELECT` にスカラーサブクエリが含まれる場合、スキーマ推論を行うテーブル関数への `INSERT SELECT` で発生する `Block structure mismatch` エラーを修正。[#78677](https://github.com/ClickHouse/ClickHouse/pull/78677)（[Pervakov Grigorii](https://github.com/GrigoryPervakov)）。
* Analyzer を修正: Distributed テーブルに対する SELECT クエリで `prefer_global_in_and_join=1` が有効な場合、`in` 関数は `globalIn` に置き換えられる必要があります。 [#78749](https://github.com/ClickHouse/ClickHouse/pull/78749) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* `MongoDB` エンジンのテーブルまたは `mongodb` テーブル関数を読み取るいくつかの種類の `SELECT` クエリを修正しました。対象となるのは、`WHERE` 句内で定数値の暗黙的な型変換を行うクエリ（例: `WHERE datetime = '2025-03-10 00:00:00'`）や、`LIMIT` および `GROUP BY` を含むクエリです。これらのクエリは、以前は誤った結果を返すことがありました。[#78777](https://github.com/ClickHouse/ClickHouse/pull/78777)（[Anton Popov](https://github.com/CurtizJ)）。
* 異なる JSON 型間の変換方法を修正しました。現在は、String 型への／からの変換を介した単純なキャストによって実行されます。効率は低下しますが、結果は 100% 正確です。 [#78807](https://github.com/ClickHouse/ClickHouse/pull/78807) ([Pavel Kruglov](https://github.com/Avogar)).
* Dynamic 型から Interval 型への変換時に発生する論理エラーを修正。 [#78813](https://github.com/ClickHouse/ClickHouse/pull/78813) ([Pavel Kruglov](https://github.com/Avogar)).
* JSON パースエラー発生時のカラムのロールバック処理を修正。 [#78836](https://github.com/ClickHouse/ClickHouse/pull/78836) ([Pavel Kruglov](https://github.com/Avogar)).
* 定数エイリアス列を使用して `JOIN` した際に発生する `bad cast` エラーを修正しました。 [#78848](https://github.com/ClickHouse/ClickHouse/pull/78848) ([Vladimir Cherkasov](https://github.com/vdimir)).
* ビューと対象テーブルで型が異なる列を持つマテリアライズドビューでは、`PREWHERE` を使用できないようにしました。 [#78889](https://github.com/ClickHouse/ClickHouse/pull/78889) ([Pavel Kruglov](https://github.com/Avogar)).
* Variant 列の不正なバイナリデータの解析時に発生する論理エラーを修正。 [#78982](https://github.com/ClickHouse/ClickHouse/pull/78982) ([Pavel Kruglov](https://github.com/Avogar)).
* parquet のバッチサイズが 0 に設定されている場合に例外をスローするようになりました。これまでは `output_format_parquet_batch_size = 0` のとき、ClickHouse がハングしていましたが、現在はこの挙動が修正されています。[#78991](https://github.com/ClickHouse/ClickHouse/pull/78991)（[daryawessely](https://github.com/daryawessely)）。
* コンパクトパーツにおける basic フォーマットを用いた variant discriminator のデシリアライズ処理を修正しました。この問題は [https://github.com/ClickHouse/ClickHouse/pull/55518](https://github.com/ClickHouse/ClickHouse/pull/55518) で導入されました。[#79000](https://github.com/ClickHouse/ClickHouse/pull/79000)（[Pavel Kruglov](https://github.com/Avogar)）。
* `complex_key_ssd_cache` 型の辞書は、`block_size` および `write_buffer_size` パラメータに 0 以下の値が指定された場合、それらを無効として拒否するようになりました（issue [#78314](https://github.com/ClickHouse/ClickHouse/issues/78314)）。[#79028](https://github.com/ClickHouse/ClickHouse/pull/79028)（[Elmi Ahmadov](https://github.com/ahmadov)）。
* SummingMergeTree では、非集約列に Field を使用しないでください。SummingMergeTree で使用される Dynamic/Variant 型に対して、予期しないエラーが発生する可能性があります。 [#79051](https://github.com/ClickHouse/ClickHouse/pull/79051) ([Pavel Kruglov](https://github.com/Avogar)).
* analyzer において、分散先テーブルを持ち、ヘッダーが異なるマテリアライズドビューからの読み取り処理を修正しました。 [#79059](https://github.com/ClickHouse/ClickHouse/pull/79059) ([Pavel Kruglov](https://github.com/Avogar)).
* `currentDatabase` 関数が `ON CLUSTER` クエリの `CONSTRAINT` セクションで使用された、非常に限定的な状況で発生していたクラッシュを修正しました。[#78100](https://github.com/ClickHouse/ClickHouse/issues/78100) をクローズしました。[#79070](https://github.com/ClickHouse/ClickHouse/pull/79070)（[pufit](https://github.com/pufit)）。
* バッチ挿入が行われたテーブルで `arrayUnion()` が余分な（誤った）値を返すバグを修正しました。[#75057](https://github.com/ClickHouse/ClickHouse/issues/75057) を修正します。 [#79079](https://github.com/ClickHouse/ClickHouse/pull/79079)（[Peter Nguyen](https://github.com/petern48)）。
* サーバー間クエリにおける外部ロールの受け渡しを修正。 [#79099](https://github.com/ClickHouse/ClickHouse/pull/79099) ([Andrey Zvonov](https://github.com/zvonand))。
* S3 ListObject に対して常にプレフィックスを設定するようにしました。 [#79114](https://github.com/ClickHouse/ClickHouse/pull/79114) ([Azat Khuzhin](https://github.com/azat)).
* バッチ挿入を行ったテーブルで `arrayUnion()` が余分な（誤った）値を返していたバグを修正しました。[#79157](https://github.com/ClickHouse/ClickHouse/issues/79157) を修正。[#79158](https://github.com/ClickHouse/ClickHouse/pull/79158)（[Peter Nguyen](https://github.com/petern48)）。
* フィルタープッシュダウン後に発生する論理エラーを修正。 [#79164](https://github.com/ClickHouse/ClickHouse/pull/79164) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* SingleValueDataGeneric では Field の代わりに IColumn を使用するようにしました。これにより、`Dynamic/Variant/JSON` 型に対する `argMax` などの一部の集約関数で誤った戻り値が返される問題が修正されます。 [#79166](https://github.com/ClickHouse/ClickHouse/pull/79166) ([Pavel Kruglov](https://github.com/Avogar)).
* http ベースのエンドポイントで使用される delta-kernel 実装を利用した DeltaLake テーブルエンジンを修正し、NOSIGN を修正しました。[#78124](https://github.com/ClickHouse/ClickHouse/issues/78124) をクローズ。[#79203](https://github.com/ClickHouse/ClickHouse/pull/79203)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* Keeper の修正: 失敗した multi リクエストでウォッチが発火するのを回避。[#79247](https://github.com/ClickHouse/ClickHouse/pull/79247)（[Antonio Andelic](https://github.com/antonio2368)）。
* IN での Dynamic 型および JSON 型の使用を禁止。`IN` の現在の実装では、これらを使用すると誤った結果を返す可能性がある。`IN` でこれらの型を正しくサポートするのは複雑であり、将来的に対応される可能性がある。[#79282](https://github.com/ClickHouse/ClickHouse/pull/79282)（[Pavel Kruglov](https://github.com/Avogar)）。
* JSON 型のパース時の重複パスチェックを修正。 [#79317](https://github.com/ClickHouse/ClickHouse/pull/79317) ([Pavel Kruglov](https://github.com/Avogar)).
* SecureStreamSocket 接続の問題を修正。 [#79383](https://github.com/ClickHouse/ClickHouse/pull/79383) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* データを含む plain&#95;rewritable ディスクの読み込み処理を修正しました。 [#79439](https://github.com/ClickHouse/ClickHouse/pull/79439) ([Julia Kartseva](https://github.com/jkartseva)).
* MergeTree の Wide パーツにおける動的サブカラム検出で発生していたクラッシュを修正しました。 [#79466](https://github.com/ClickHouse/ClickHouse/pull/79466) ([Pavel Kruglov](https://github.com/Avogar)).
* テーブル名の長さは、初回の CREATE クエリに対してのみ検証します。後方互換性の問題を避けるため、2 回目以降の CREATE については検証しないでください。 [#79488](https://github.com/ClickHouse/ClickHouse/pull/79488) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* スパースカラムを持つテーブルで発生していた複数のケースの `Block structure mismatch` エラーを修正しました。 [#79491](https://github.com/ClickHouse/ClickHouse/pull/79491) ([Anton Popov](https://github.com/CurtizJ)).
* `Logical Error: Can't set alias of * of Asterisk on alias` が発生する 2 つのケースを修正。 [#79505](https://github.com/ClickHouse/ClickHouse/pull/79505) ([Raúl Marín](https://github.com/Algunenano)).
* Azure Blob Storage に対して use&#95;native&#95;copy および allow&#95;azure&#95;native&#95;copy の設定が正しく適用されるよう修正し、認証情報が一致する場合にのみネイティブコピーを使用するよう更新しました。これにより [#78964](https://github.com/ClickHouse/ClickHouse/issues/78964) が解決されました。 [#79561](https://github.com/ClickHouse/ClickHouse/pull/79561) ([Smita Kulkarni](https://github.com/SmitaRKulkarni)).
* Atomic データベースのリネーム時に誤ったパスを使用していた問題を修正。 [#79569](https://github.com/ClickHouse/ClickHouse/pull/79569) ([Tuan Pham Anh](https://github.com/tuanpach)).
* JSON カラムと他のカラムを組み合わせた `ORDER BY` の動作を修正。 [#79591](https://github.com/ClickHouse/ClickHouse/pull/79591) ([Pavel Kruglov](https://github.com/Avogar)).
* `use_hedged_requests` と `allow_experimental_parallel_reading_from_replicas` の両方が無効な場合に、remote からの読み取りで結果が重複する問題を修正しました。 [#79599](https://github.com/ClickHouse/ClickHouse/pull/79599) ([Eduard Karacharov](https://github.com/korowa)).
* unity catalog 使用時に delta-kernel 実装で発生していたクラッシュを修正しました。 [#79677](https://github.com/ClickHouse/ClickHouse/pull/79677) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 自動検出クラスタのマクロを解決するようにしました。 [#79696](https://github.com/ClickHouse/ClickHouse/pull/79696) ([Anton Ivashkin](https://github.com/ianton-ru)).
* このカラムが相関しているかどうかをチェックする際に発生していた、カラムの由来スコープが不明な場合に関する論理エラーを修正。 [#78183](https://github.com/ClickHouse/ClickHouse/issues/78183) を修正。 [#79451](https://github.com/ClickHouse/ClickHouse/issues/79451) を修正。 [#79727](https://github.com/ClickHouse/ClickHouse/pull/79727)（[Dmitry Novik](https://github.com/novikd)）。
* ColumnConst と Analyzer を使用した grouping sets で誤った結果が返される問題を修正。 [#79743](https://github.com/ClickHouse/ClickHouse/pull/79743) ([Andrey Zvonov](https://github.com/zvonand)).
* ローカルレプリカが古くなっている状態で分散テーブルから読み取る際に発生していた、ローカルシャードの結果が重複する問題を修正しました。 [#79761](https://github.com/ClickHouse/ClickHouse/pull/79761) ([Eduard Karacharov](https://github.com/korowa)).
* 誤って設定された `page_cache_limits` を適切に処理するようにしました。 [#79805](https://github.com/ClickHouse/ClickHouse/pull/79805) ([Bharat Nallan](https://github.com/bharatnc)).
* 可変長フォーマッタ（例: `%W`、曜日の `Monday` や `Tuesday` など）の後に、複合フォーマッタ（複数の要素を一度に出力するフォーマッタ。例: `%D`、アメリカ形式の日付 `05/04/25`）が続く場合の SQL 関数 `formatDateTime` の結果を修正しました。 [#79835](https://github.com/ClickHouse/ClickHouse/pull/79835) ([Robert Schulze](https://github.com/rschu1ze)).
* IcebergS3 は count 最適化をサポートしていますが、IcebergS3Cluster はサポートしていません。その結果、クラスターモードで返される `count()` の結果が、レプリカ数の倍数になる場合があります。 [#79844](https://github.com/ClickHouse/ClickHouse/pull/79844) ([wxybear](https://github.com/wxybear))。
* 負の符号ビットを持つ NaN のソート順を修正しました。 [#79847](https://github.com/ClickHouse/ClickHouse/pull/79847) ([Pervakov Grigorii](https://github.com/GrigoryPervakov))。
* `GROUP BY ALL` が `GROUPING` 句を考慮しなくなりました。 [#79915](https://github.com/ClickHouse/ClickHouse/pull/79915) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* 遅延マテリアライゼーションにおいて、射影が行われるまでクエリ実行にどの列も使用されない場合に発生する `AMBIGUOUS_COLUMN_NAME` エラーを修正しました。例: SELECT * FROM t ORDER BY rand() LIMIT 5。 [#79926](https://github.com/ClickHouse/ClickHouse/pull/79926) ([Igor Nikonov](https://github.com/devcrafter))。
* 容量が使い果たされていない場合でも過大な誤差を引き起こしていた `TopK` / `TopKWeighted` 関数の誤った状態マージ処理を修正しました。 [#79939](https://github.com/ClickHouse/ClickHouse/pull/79939) ([Joel Höner](https://github.com/athre0z)).
* クエリ `CREATE DATABASE datalake ENGINE = DataLakeCatalog(\'http://catalog:8181\', \'admin\', \'password\')` に含まれるパスワードを非表示にしました。 [#79941](https://github.com/ClickHouse/ClickHouse/pull/79941) ([Han Fei](https://github.com/hanfei1991)).
* `JOIN USING` でエイリアスを指定できるようにしました。カラム名が変更された場合（例: `ARRAY JOIN` による変更）には、このエイリアスを指定してください。 [#73707](https://github.com/ClickHouse/ClickHouse/issues/73707) を修正しました。 [#79942](https://github.com/ClickHouse/ClickHouse/pull/79942)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* `azure_blob_storage` オブジェクトストレージで `readonly` 設定を正しく反映するようにしました。 [#79954](https://github.com/ClickHouse/ClickHouse/pull/79954) ([Julia Kartseva](https://github.com/jkartseva)).
* バックスラッシュでエスケープされた文字を含む `match(column, '^…')` の使用時に発生していた、誤ったクエリ結果およびメモリ不足クラッシュを修正しました。 [#79969](https://github.com/ClickHouse/ClickHouse/pull/79969) ([filimonov](https://github.com/filimonov)).
* データレイクに対する Hive パーティショニングを無効化。 [https://github.com/issues/assigned?issue=ClickHouse%7CClickHouse%7C79937](https://github.com/issues/assigned?issue=ClickHouse%7CClickHouse%7C79937) を部分的に解決。 [#80005](https://github.com/ClickHouse/ClickHouse/pull/80005)（[Daniil Ivanik](https://github.com/divanik)）。
* ラムダ式を含むスキップインデックスが適用されない問題を修正しました。インデックス定義内の高レベル関数がクエリ内のものと完全に一致する場合に、スキップインデックスが正しく適用されるようにしました。 [#80025](https://github.com/ClickHouse/ClickHouse/pull/80025) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* `UNION` を含むマテリアライズドビューが新しいレプリカで正しく動作するようにしました。 [#80037](https://github.com/ClickHouse/ClickHouse/pull/80037) ([Samay Sharma](https://github.com/samay-sharma)).
* レプリカでレプリケーションログから `ATTACH_PART` コマンドを実行してパーツをアタッチする際に、メタデータのバージョンを修正しました。 [#80038](https://github.com/ClickHouse/ClickHouse/pull/80038) ([Aleksei Filatov](https://github.com/aalexfvk)).
* SQL 関数 `parseDateTime` における書式指定子 `%e` は、これまではスペースでパディングされた日（例: ` 3`）のみを受け付けていましたが、現在は 1 桁の日（例: `3`）も認識するようになりました。これにより、MySQL と動作が互換になります。以前の挙動を維持するには、設定 `parsedatetime_e_requires_space_padding = 1` を有効にしてください。(issue [#78243](https://github.com/ClickHouse/ClickHouse/issues/78243)). [#80057](https://github.com/ClickHouse/ClickHouse/pull/80057) ([Robert Schulze](https://github.com/rschu1ze)).
* 他の関数とは異なり、Executable User Defined Functions (eUDF) の名前は `system.query_log` テーブルの `used_functions` 列に追加されません。この PR では、リクエストで eUDF が使用された場合に、その eUDF 名を追加するように実装しています。[#80073](https://github.com/ClickHouse/ClickHouse/pull/80073) ([Kyamran](https://github.com/nibblerenush))。
  #* ClickHouse のログに出力される `Cannot find 'kernel' in '[...]/memory.stat'` という警告を修正します（issue [#77410](https://github.com/ClickHouse/ClickHouse/issues/77410)）。[#80129](https://github.com/ClickHouse/ClickHouse/pull/80129) ([Robert Schulze](https://github.com/rschu1ze))。
* LowCardinality(FixedString) を含む Arrow フォーマットでの論理エラーを修正。 [#80156](https://github.com/ClickHouse/ClickHouse/pull/80156) ([Pavel Kruglov](https://github.com/Avogar)).
* Merge エンジンからのサブカラムの読み取りを修正。 [#80158](https://github.com/ClickHouse/ClickHouse/pull/80158) ([Pavel Kruglov](https://github.com/Avogar)).
* `KeyCondition` における数値型の比較に関するバグを修正。 [#80207](https://github.com/ClickHouse/ClickHouse/pull/80207) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* 遅延マテリアライゼーションがプロジェクションを持つテーブルに適用された際に発生する AMBIGUOUS&#95;COLUMN&#95;NAME エラーを修正しました。 [#80251](https://github.com/ClickHouse/ClickHouse/pull/80251) ([Igor Nikonov](https://github.com/devcrafter)).
* 暗黙的プロジェクションを使用している場合に、LIKE &#39;ab&#95;c%&#39; のような文字列プレフィックスフィルターに対する `count` の不正な最適化を修正しました。これにより [#80250](https://github.com/ClickHouse/ClickHouse/issues/80250) が解決されます。 [#80261](https://github.com/ClickHouse/ClickHouse/pull/80261)（[Amos Bird](https://github.com/amosbird)）。
* MongoDB ドキュメント内で、ネストされた数値フィールドが文字列として誤ってシリアル化される問題を修正しました。MongoDB から取得したドキュメントに対する最大深さの制限を削除しました。 [#80289](https://github.com/ClickHouse/ClickHouse/pull/80289) ([Kirill Nikiforov](https://github.com/allmazz)).
* Replicated データベースにおける RMT のメタデータチェックを、より緩やかなものにしました。[#80296](https://github.com/ClickHouse/ClickHouse/issues/80296) をクローズ。[#80298](https://github.com/ClickHouse/ClickHouse/pull/80298)（[Nikolay Degterinsky](https://github.com/evillique)）。
* PostgreSQL ストレージ用の `DateTime` および `DateTime64` のテキスト表現を修正しました。 [#80301](https://github.com/ClickHouse/ClickHouse/pull/80301) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* `StripeLog` テーブルでタイムゾーン付きの `DateTime` を許可するようにしました。これにより [#44120](https://github.com/ClickHouse/ClickHouse/issues/44120) がクローズされます。[#80304](https://github.com/ClickHouse/ClickHouse/pull/80304)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* クエリプランのステップが行数を変更する場合には、非決定的関数を含む述語に対するフィルタプッシュダウンを無効化しました。[#40273](https://github.com/ClickHouse/ClickHouse/issues/40273) を修正。 [#80329](https://github.com/ClickHouse/ClickHouse/pull/80329)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* サブカラムを含むプロジェクションで発生し得る論理エラーやクラッシュを修正しました。 [#80333](https://github.com/ClickHouse/ClickHouse/pull/80333) ([Pavel Kruglov](https://github.com/Avogar)).
* `ON` 式が単純な等値条件ではない場合に、論理 JOIN sep のフィルタプッシュダウン最適化によって発生する `NOT_FOUND_COLUMN_IN_BLOCK` エラーを修正。[#79647](https://github.com/ClickHouse/ClickHouse/issues/79647) および [#77848](https://github.com/ClickHouse/ClickHouse/issues/77848) を修正。[#80360](https://github.com/ClickHouse/ClickHouse/pull/80360)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* パーティション分割されたテーブルでキーを逆順に読み取る際に誤った結果が返る問題を修正しました。これにより [#79987](https://github.com/ClickHouse/ClickHouse/issues/79987) が解決されました。[#80448](https://github.com/ClickHouse/ClickHouse/pull/80448)（[Amos Bird](https://github.com/amosbird)）。
* nullable なキーを持つテーブルで `optimize_read_in_order` が有効な場合に、ソート順が誤っていた問題を修正しました。 [#80515](https://github.com/ClickHouse/ClickHouse/pull/80515) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* `SYSTEM STOP REPLICATED VIEW` を使用してビューが一時停止されていた場合に、リフレッシュ可能なマテリアライズドビューの `DROP` がスタックする問題を修正しました。 [#80543](https://github.com/ClickHouse/ClickHouse/pull/80543) ([Michael Kolupaev](https://github.com/al13n321)).
* 分散クエリで定数タプルを使用した際に発生する「Cannot find column」エラーを修正しました。 [#80596](https://github.com/ClickHouse/ClickHouse/pull/80596) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* `join_use_nulls` を使用する Distributed テーブルでの `shardNum` 関数の動作を修正。 [#80612](https://github.com/ClickHouse/ClickHouse/pull/80612) ([János Benjamin Antal](https://github.com/antaljanosbenjamin))。
* Merge エンジンで、テーブルの一部にのみ存在するカラムを読み取る際に発生していた誤った結果を修正。 [#80643](https://github.com/ClickHouse/ClickHouse/pull/80643) ([Pavel Kruglov](https://github.com/Avogar)).
* `iceberg_history` テーブル内のタイムスタンプが、正しく表示されるようになりました。 [#80711](https://github.com/ClickHouse/ClickHouse/pull/80711) ([Melvyn Peignon](https://github.com/melvynator)).
* オブジェクトストレージのテーブル関数における、単一要素の enum グロブの処理を修正。 [#80716](https://github.com/ClickHouse/ClickHouse/pull/80716) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* Tuple(Dynamic) と String の比較関数で誤った結果型が返されていた問題を修正し、それによって発生していた論理エラーを解消しました。 [#80728](https://github.com/ClickHouse/ClickHouse/pull/80728) ([Pavel Kruglov](https://github.com/Avogar)).
* Unity Catalog 向けに不足していたサポート対象データ型 `timestamp_ntz` を追加しました。[#79535](https://github.com/ClickHouse/ClickHouse/issues/79535) を修正、[#79875](https://github.com/ClickHouse/ClickHouse/issues/79875) を修正。[#80740](https://github.com/ClickHouse/ClickHouse/pull/80740)（[alesapin](https://github.com/alesapin)）。
* `IN cte` を含む分散クエリで発生する `THERE_IS_NO_COLUMN` エラーを修正しました。 [#75032](https://github.com/ClickHouse/ClickHouse/issues/75032) を修正。 [#80757](https://github.com/ClickHouse/ClickHouse/pull/80757)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* 外部 `ORDER BY` におけるファイル数の過多（それに伴うメモリ使用量の過大）を修正。[#80777](https://github.com/ClickHouse/ClickHouse/pull/80777)（[Azat Khuzhin](https://github.com/azat)）。
  #* この PR により [#80742](https://github.com/ClickHouse/ClickHouse/issues/80742) がクローズされる可能性があります。[#80783](https://github.com/ClickHouse/ClickHouse/pull/80783)（[zoomxi](https://github.com/zoomxi)）。
  #* Kafka において、get&#95;member&#95;id() が NULL から std::string を生成していたことに起因するクラッシュを修正（ブローカーへの接続が失敗した場合にのみ発生していた可能性があります）。[#80793](https://github.com/ClickHouse/ClickHouse/pull/80793)（[Azat Khuzhin](https://github.com/azat)）。
* Kafka エンジンをシャットダウンする前にコンシューマの完了を正しく待機するようにしました（シャットダウン後にアクティブなコンシューマが残っていると、さまざまなデバッグアサーションがトリガーされる可能性があり、また、テーブルが drop/detach された後もバックグラウンドでブローカーからデータを読み取り続けてしまうことがあります）。 [#80795](https://github.com/ClickHouse/ClickHouse/pull/80795) ([Azat Khuzhin](https://github.com/azat)).
* `predicate-push-down` 最適化によって発生する `NOT_FOUND_COLUMN_IN_BLOCK` を修正。 [#80443](https://github.com/ClickHouse/ClickHouse/issues/80443) を解決。 [#80834](https://github.com/ClickHouse/ClickHouse/pull/80834)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* `USING` 付きの `JOIN` において、テーブル関数のスター（*）マッチャーを解決する際の論理エラーを修正。 [#80894](https://github.com/ClickHouse/ClickHouse/pull/80894) ([Vladimir Cherkasov](https://github.com/vdimir))。
* Iceberg メタデータファイルキャッシュのメモリ使用量の計上を修正。 [#80904](https://github.com/ClickHouse/ClickHouse/pull/80904) ([Azat Khuzhin](https://github.com/azat))。
* NULL 許容のパーティションキーにおける誤ったパーティション分割を修正しました。 [#80913](https://github.com/ClickHouse/ClickHouse/pull/80913) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* 述語プッシュダウン（`allow_push_predicate_ast_for_distributed_subqueries=1`）を有効にした分散クエリで、ソーステーブルがイニシエータ上に存在しない場合に発生する `Table does not exist` エラーを修正しました。[#77281](https://github.com/ClickHouse/ClickHouse/issues/77281) を修正します。[#80915](https://github.com/ClickHouse/ClickHouse/pull/80915)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* 名前付きウィンドウを使用したネストされた関数における論理エラーを修正しました。 [#80926](https://github.com/ClickHouse/ClickHouse/pull/80926) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* Nullable 列および浮動小数点列に対する `extremes` の挙動を修正しました。 [#80970](https://github.com/ClickHouse/ClickHouse/pull/80970) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* system.tables からのクエリ実行時に発生し得るクラッシュを修正しました（特にメモリプレッシャー下で発生する可能性が高い問題）。 [#80976](https://github.com/ClickHouse/ClickHouse/pull/80976) ([Azat Khuzhin](https://github.com/azat)).
* ファイル拡張子から圧縮方式が推測されるファイルに対して、truncate を伴うアトミックな rename の問題を修正。 [#80979](https://github.com/ClickHouse/ClickHouse/pull/80979) ([Pablo Marcos](https://github.com/pamarcos)).
  #* ErrorCodes::getName の不具合を修正。 [#81032](https://github.com/ClickHouse/ClickHouse/pull/81032) ([RinChanNOW](https://github.com/RinChanNOWWW)).
* ユーザーが、すべてのテーブルに対する権限を持っていない場合に Unity Catalog 内のテーブルを一覧できないバグを修正しました。現在はすべてのテーブルが正しく一覧表示され、制限されたテーブルから読み込もうとすると例外がスローされます。 [#81044](https://github.com/ClickHouse/ClickHouse/pull/81044) ([alesapin](https://github.com/alesapin)).
* これにより、ClickHouse は `SHOW TABLES` クエリにおいて、データレイクカタログからのエラーや想定外のレスポンスを無視するようになりました。[#79725](https://github.com/ClickHouse/ClickHouse/issues/79725) を修正。[#81046](https://github.com/ClickHouse/ClickHouse/pull/81046) ([alesapin](https://github.com/alesapin))。
* `JSONExtract` および `JSON` 型のパースにおいて、整数値からの `DateTime64` のパースを修正しました。 [#81050](https://github.com/ClickHouse/ClickHouse/pull/81050) ([Pavel Kruglov](https://github.com/Avogar))。
* スキーマ推論キャッシュに `date_time_input_format` 設定を反映するようにしました。[#81052](https://github.com/ClickHouse/ClickHouse/pull/81052)（[Pavel Kruglov](https://github.com/Avogar)）。
* クエリの開始後からカラム送信前の間にテーブルが `DROP` された場合に、`INSERT` がクラッシュする問題を修正しました。 [#81053](https://github.com/ClickHouse/ClickHouse/pull/81053) ([Azat Khuzhin](https://github.com/azat)).
* quantileDeterministic における use-of-uninitialized-value 問題を修正。 [#81062](https://github.com/ClickHouse/ClickHouse/pull/81062) ([Azat Khuzhin](https://github.com/azat)).
* metadatastoragefromdisk ディスクトランザクションにおけるハードリンク数の管理を修正。テストを追加。 [#81066](https://github.com/ClickHouse/ClickHouse/pull/81066) ([Sema Checherinda](https://github.com/CheSema))。
* 他の関数とは異なり、ユーザー定義関数 (UDF) の名前は `system.query_log` テーブルには追加されません。この PR では、リクエストで UDF が使用された場合に、その UDF 名を `used_executable_user_defined_functions` または `used_sql_user_defined_functions` の 2 つのカラムのいずれかに追加する機能を実装しています。 [#81101](https://github.com/ClickHouse/ClickHouse/pull/81101) ([Kyamran](https://github.com/nibblerenush))。
* `JSON` や `Values` などのテキスト形式を用いた HTTP プロトコル経由の挿入で、`Enum` フィールドが省略されている場合に発生する `Too large size ... passed to allocator` エラーや、クラッシュが起こり得る問題を修正しました。 [#81145](https://github.com/ClickHouse/ClickHouse/pull/81145) ([Anton Popov](https://github.com/CurtizJ)).
* スパースカラムを含む `INSERT` ブロックが非マルチスレッドのマテリアライズドビューに送られた場合に発生する `LOGICAL_ERROR` を修正。 [#81161](https://github.com/ClickHouse/ClickHouse/pull/81161) ([Azat Khuzhin](https://github.com/azat)).
* クロスレプリケーション環境で `distributed_product_mode_local=local` を使用した際に発生する `Unknown table expression identifier` エラーを修正しました。 [#81162](https://github.com/ClickHouse/ClickHouse/pull/81162) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* フィルタリング後の Parquet ファイルの行数を誤ってキャッシュしていた不具合を修正しました。 [#81184](https://github.com/ClickHouse/ClickHouse/pull/81184) ([Michael Kolupaev](https://github.com/al13n321)).
* 相対キャッシュパス使用時の fs キャッシュ `max_size_to_total_space` 設定の問題を修正しました。 [#81237](https://github.com/ClickHouse/ClickHouse/pull/81237) ([Kseniia Sumarokova](https://github.com/kssenii)).
* Parquet フォーマットで const のタプルまたはマップを出力する際に clickhouse-local がクラッシュする問題を修正しました。 [#81249](https://github.com/ClickHouse/ClickHouse/pull/81249) ([Michael Kolupaev](https://github.com/al13n321)).
* ネットワーク経由で受信した配列オフセットを検証します。 [#81269](https://github.com/ClickHouse/ClickHouse/pull/81269) ([Azat Khuzhin](https://github.com/azat)).
* 空のテーブルを結合し、ウィンドウ関数を使用するクエリにおける一部のコーナーケースを修正しました。このバグにより並列ストリーム数が爆発的に増加し、その結果 OOM が発生していました。 [#81299](https://github.com/ClickHouse/ClickHouse/pull/81299) ([Alexander Gololobov](https://github.com/davenger)).
* datalake の Cluster 関数（`deltaLakeCluster`、`icebergCluster` など）に対する修正: (1) 旧アナライザで `Cluster` 関数を使用した際に `DataLakeConfiguration` で発生し得たセグフォを修正；(2) 重複していた data lake メタデータ更新（不要なオブジェクトストレージへのリクエスト）を削除；(3) フォーマットが明示的に指定されていない場合のオブジェクトストレージでの冗長な listing を修正（非クラスタ data lake エンジンではすでに行われていた対応）。[#81300](https://github.com/ClickHouse/ClickHouse/pull/81300)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* `force_restore_data` フラグで失われた Keeper メタデータを復元できるようにしました。 [#81324](https://github.com/ClickHouse/ClickHouse/pull/81324) ([Raúl Marín](https://github.com/Algunenano)).
* delta-kernel におけるリージョンエラーを修正。[#79914](https://github.com/ClickHouse/ClickHouse/issues/79914) を解決。 [#81353](https://github.com/ClickHouse/ClickHouse/pull/81353)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* divideOrNull に対する不正な JIT を無効化しました。 [#81370](https://github.com/ClickHouse/ClickHouse/pull/81370) ([Raúl Marín](https://github.com/Algunenano)).
* MergeTree テーブルでパーティション列名が長い場合に発生していた挿入エラーを修正しました。 [#81390](https://github.com/ClickHouse/ClickHouse/pull/81390) ([hy123q](https://github.com/haoyangqian)).
* 複数のマニフェストファイルの内容をメモリに保持しないようにしました。 [#81470](https://github.com/ClickHouse/ClickHouse/pull/81470) ([Daniil Ivanik](https://github.com/divanik)).
* バックグラウンドプール（`background_.*pool_size`）のシャットダウン時に発生する可能性のあるクラッシュを修正しました。 [#81473](https://github.com/ClickHouse/ClickHouse/pull/81473) ([Azat Khuzhin](https://github.com/azat)).
* `URL` エンジンを使用してテーブルに書き込む際に発生していた `Npy` フォーマットでの範囲外読み取りを修正しました。これにより [#81356](https://github.com/ClickHouse/ClickHouse/issues/81356) がクローズされます。[#81502](https://github.com/ClickHouse/ClickHouse/pull/81502)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* Web UI が `NaN%` を表示してしまう場合があります（ありがちな JavaScript の問題）。[#81507](https://github.com/ClickHouse/ClickHouse/pull/81507)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `database_replicated_enforce_synchronous_settings=1` 設定時の `DatabaseReplicated` を修正。 [#81564](https://github.com/ClickHouse/ClickHouse/pull/81564) ([Azat Khuzhin](https://github.com/azat)).
* LowCardinality(Nullable(...)) 型のソート順を修正しました。 [#81583](https://github.com/ClickHouse/ClickHouse/pull/81583) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* サーバーは、ソケットからリクエストを最後まで読み取っていない場合、HTTP 接続を維持しないようにしました。 [#81595](https://github.com/ClickHouse/ClickHouse/pull/81595) ([Sema Checherinda](https://github.com/CheSema)).
* スカラー相関サブクエリが射影式の結果を `Nullable` として返すようにしました。相関サブクエリが空の結果セットを生成する場合の動作を修正しました。 [#81632](https://github.com/ClickHouse/ClickHouse/pull/81632) ([Dmitry Novik](https://github.com/novikd))。
* `ATTACH` で `ReplicatedMergeTree` に対して発生する `Unexpected relative path for a deduplicated part` エラーを修正。[#81647](https://github.com/ClickHouse/ClickHouse/pull/81647)（[Azat Khuzhin](https://github.com/azat)）。
* `use_iceberg_partition_pruning` クエリ設定は、クエリコンテキストではなくグローバルコンテキストを使用しているため、Iceberg ストレージでは有効になりません。デフォルト値が true であるため致命的ではありませんが、この PR により修正されます。 [#81673](https://github.com/ClickHouse/ClickHouse/pull/81673) ([Han Fei](https://github.com/hanfei1991))。
* マージツリー設定 `merge_max_block_size` に対して、ゼロではないことを保証する検証を追加しました。 [#81693](https://github.com/ClickHouse/ClickHouse/pull/81693) ([Bharat Nallan](https://github.com/bharatnc)).
* ハングした `DROP VIEW ` クエリに関連する `clickhouse-local` の問題を修正しました。[#81705](https://github.com/ClickHouse/ClickHouse/pull/81705)（[Bharat Nallan](https://github.com/bharatnc)）。
* 一部のケースにおける StorageRedis の `JOIN` を修正しました。 [#81736](https://github.com/ClickHouse/ClickHouse/pull/81736) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* `USING ()` が空で旧アナライザーが有効な場合に発生する `ConcurrentHashJoin` のクラッシュを修正。 [#81754](https://github.com/ClickHouse/ClickHouse/pull/81754) ([Nikita Taranov](https://github.com/nickitat)).
* Keeper の修正: ログ内に不正なエントリが存在する場合は、新しいログのコミットをブロックするようにしました。以前は、リーダーが一部のログを誤って適用しても、フォロワー側でダイジェストの不一致を検出してアボートしているにもかかわらず、新しいログのコミットを続けていました。 [#81780](https://github.com/ClickHouse/ClickHouse/pull/81780) ([Antonio Andelic](https://github.com/antonio2368)).