---
slug: /changelogs/24.8
title: 'v24.8 クラウド向け変更履歴'
description: 'Fast リリース v24.8 の変更履歴'
keywords: ['changelog', 'cloud']
sidebar_label: '24.8'
sidebar_position: 6
doc_type: 'changelog'
---

v24.8 リリースに基づく ClickHouse Cloud サービスの主な変更点。



## 後方互換性のない変更 {#backward-incompatible-change}

- Variantデータ型のバイナリシリアライゼーションを変更: 単一のバリアントまたはNULL値のみを持つグラニュールに対して同じ識別子を複数回書き込むことを避けるため、コンパクトモードを追加しました。デフォルトで有効化されるMergeTree設定use_compact_variant_discriminators_serializationを追加しました。Variant型はまだ実験的機能であり、シリアライゼーションにおける後方互換性のない変更は、サポートと協力してこの機能を早期に有効化していない限り、影響を受けることはありません。[#62774](https://github.com/ClickHouse/ClickHouse/pull/62774) (Kruglov Pavel)。

- ReplicatedデータベースでのCREATE MATERIALIZED VIEW ... ENGINE Replicated\*MergeTree POPULATE AS SELECT ...を禁止しました。この特定のPRは、ReplicatedMergeTreeをまだ使用しているユーザーにのみ適用されます。[#63963](https://github.com/ClickHouse/ClickHouse/pull/63963) (vdimir)。

- メトリックKeeperOutstandingRequetsをKeeperOutstandingRequestsに名称変更しました。これは[#66179](https://github.com/ClickHouse/ClickHouse/issues/66179)で報告されたタイプミスを修正するものです。[#66206](https://github.com/ClickHouse/ClickHouse/pull/66206) (Robert Schulze)。

- clickhouse-clientとclickhouse-localは、デフォルトでマルチクエリモード(シングルクエリモードではなく)になりました。例えば、clickhouse-client -q "SELECT 1; SELECT 2"が動作するようになり、以前はユーザーが--multiquery(または-n)を追加する必要がありました。--multiquery/-nスイッチは廃止されました。マルチクエリステートメント内のINSERTクエリは、FORMAT句に基づいて特別に処理されます: FORMATがVALUES(最も一般的なケース)の場合、INSERTステートメントの終わりはクエリの末尾のセミコロン;で表されます。その他すべてのFORMAT(例: CSVやJSONEachRow)の場合、INSERTステートメントの終わりはクエリの末尾の2つの改行\n\nで表されます。[#63898](https://github.com/ClickHouse/ClickHouse/pull/63898) (wxybear)。

- 以前のバージョンでは、データ型名にWithDictionaryを追加することで、LowCardinalityデータ型の代替構文を使用することが可能でした。これは初期の動作実装であり、文書化されたことも一般に公開されたこともありませんでした。現在、これは非推奨となっています。この構文を使用している場合は、テーブルをALTERしてデータ型をLowCardinalityに名称変更する必要があります。[#66842](https://github.com/ClickHouse/ClickHouse/pull/66842)(Alexey Milovidov)。

- 分散先テーブルと共に使用されるストレージBufferの論理エラーを修正しました。これは後方互換性のない変更です: 分散先テーブルと共にBufferを使用するクエリは、テーブルがクエリ内に複数回出現する場合(例: 自己結合)、動作しなくなる可能性があります。[#67015](https://github.com/vdimir) (vdimir)。

- 以前のバージョンでは、ガンマ関数に基づくランダム分布の関数(カイ二乗分布、t分布、F分布など)をゼロに近い負の引数で呼び出すと、長時間の計算または無限ループが発生していました。新しいバージョンでは、これらの関数をゼロまたは負の引数で呼び出すと例外が発生します。これにより[#67297](https://github.com/ClickHouse/ClickHouse/issues/67297)が解決されます。[#67326](https://github.com/ClickHouse/ClickHouse/pull/67326) (Alexey Milovidov)。

- 以前のバージョンでは、arrayWithConstantは非常に大きな配列の生成を要求された場合に遅くなることがありました。新しいバージョンでは、配列あたり1 GBに制限されています。これにより[#32754](https://github.com/ClickHouse/ClickHouse/issues/32754)が解決されます。[#67741](https://github.com/ClickHouse/ClickHouse/pull/67741) (Alexey Milovidov)。

- REPLACEモディファイアのフォーマットを修正しました(括弧の省略を禁止)。[#67774](https://github.com/ClickHouse/ClickHouse/pull/67774) (Azat Khuzhin)。


## 新機能 {#new-feature}

- クエリ内で名前付きタプルを構築するためにtuple関数を拡張しました。タプルから名前を抽出するtupleNames関数を導入しました。[#54881](https://github.com/ClickHouse/ClickHouse/pull/54881) (Amos Bird)。

- full_sorting_joinアルゴリズムに対するASOF JOINのサポート。[#54493](https://github.com/ClickHouse/ClickHouse/issues/54493)をクローズ。[#55051](https://github.com/ClickHouse/ClickHouse/pull/55051) (vdimir)。

- 新しいテーブル関数fuzzQueryが追加されました。この関数は、指定されたクエリ文字列にランダムなバリエーションを加えて変更することができます。例: SELECT query FROM fuzzQuery('SELECT 1');。[#62103](https://github.com/ClickHouse/ClickHouse/pull/62103) (pufit)。

- 新しいウィンドウ関数percent_rankを追加しました。[#62747](https://github.com/ClickHouse/ClickHouse/pull/62747) (lgbo)。

- clickhouse-clientでのJWT認証をサポートしました。[#62829](https://github.com/ClickHouse/ClickHouse/pull/62829) (Konstantin Bogdanov)。

- SQL関数changeYear、changeMonth、changeDay、changeHour、changeMinute、changeSecondを追加しました。例えば、SELECT changeMonth(toDate('2024-06-14'), 7)は日付2024-07-14を返します。[#63186](https://github.com/ClickHouse/ClickHouse/pull/63186) (cucumber95)。

- system.error_logを追加しました。これはsystem.errorsテーブルからのエラー値の履歴を含み、定期的にディスクにフラッシュされます。[#65381](https://github.com/ClickHouse/ClickHouse/pull/65381) (Pablo Marcos)。

- 集約関数groupConcatを追加しました。arrayStringConcat(groupArray(column), ',')とほぼ同じです。2つのパラメータを受け取ることができます:文字列区切り文字と処理する要素の数。[#65451](https://github.com/ClickHouse/ClickHouse/pull/65451) (Yarik Briukhovetskyi)。

- AzureQueueストレージを追加しました。[#65458](https://github.com/ClickHouse/ClickHouse/pull/65458) (Kseniia Sumarokova)。

- parquetファイルへのページインデックスの書き込みを無効化/有効化する新しい設定を追加しました。[#65475](https://github.com/ClickHouse/ClickHouse/pull/65475) (lgbo)。

- テーブル関数fileでディレクトリパスの末尾にワイルドカード\*を自動的に追加するようにしました。[#66019](https://github.com/ClickHouse/ClickHouse/pull/66019) (Zhidong (David) Guo)。

- 非対話モードのクライアントに--memory-usageオプションを追加しました。[#66393](https://github.com/ClickHouse/ClickHouse/pull/66393) (vdimir)。

- S3テーブルエンジンに\_etag仮想カラムを追加しました。[#65312](https://github.com/ClickHouse/ClickHouse/issues/65312)を修正。[#65386](https://github.com/ClickHouse/ClickHouse/pull/65386) (skyoct)

- このプルリクエストは、異なるエンジン(File、URL、S3、AzureBlobStorage、HDFS)に対してHiveスタイルのパーティショニングを導入します。Hiveスタイルのパーティショニングは、データをパーティション化されたサブディレクトリに整理し、大規模なデータセットのクエリと管理を効率化します。現在は、適切な名前とデータを持つ仮想カラムのみを作成します。後続のPRで適切なデータフィルタリング(パフォーマンスの高速化)が導入される予定です。[#65997](https://github.com/ClickHouse/ClickHouse/pull/65997) (Yarik Briukhovetskyi)。

- Spark互換性のためにprintf関数を追加しました。[#66257](https://github.com/ClickHouse/ClickHouse/pull/66257) (李扬)。

- readWKTLineString関数を使用してWKT形式のMULTILINESTRINGジオメトリを読み取るサポートを追加しました。[#67647](https://github.com/ClickHouse/ClickHouse/pull/67647) (Jacob Reckhard)。

- クエリキャッシュにタグ付け(名前空間)メカニズムを追加しました。異なるタグを持つ同じクエリは、クエリキャッシュによって異なるものとして扱われます。例: SELECT 1 SETTINGS use_query_cache = 1, query_cache_tag = 'abc'とSELECT 1 SETTINGS use_query_cache = 1, query_cache_tag = 'def'は、異なるクエリキャッシュエントリを作成するようになりました。[#68235](https://github.com/ClickHouse/ClickHouse/pull/68235)(sakulali)。
