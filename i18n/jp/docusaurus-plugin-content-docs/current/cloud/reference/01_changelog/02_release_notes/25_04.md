---
slug: /changelogs/25.4
title: 'v25.4 Cloud 向け変更履歴'
description: 'v25.4 の Fast リリース版変更履歴'
keywords: ['changelog', 'cloud']
sidebar_label: '25.4'
sidebar_position: 3
doc_type: 'changelog'
---



## 後方互換性のない変更 {#backward-incompatible-changes}


* Parquet 出力フォーマットは、Date および DateTime 列を、生の数値として書き出すのではなく、Parquet がサポートする日付／時刻型に変換します。DateTime は DateTime64(3)（従来は UInt32）になります。`output_format_parquet_datetime_as_uint32` を有効にすると、従来の動作に戻ります。Date は Date32（従来は UInt16）になります。[#70950](https://github.com/ClickHouse/ClickHouse/pull/70950)（[Michael Kolupaev](https://github.com/al13n321)）。
* デフォルトでは、ORDER BY および比較関数 `less/greater/equal/etc` で、JSON/Object/AggregateFunction などの比較可能な型を許可しません。 [#73276](https://github.com/ClickHouse/ClickHouse/pull/73276) ([Pavel Kruglov](https://github.com/Avogar))。
* `JSONEachRowWithProgress` は、進捗が発生するたびにその進捗を書き出します。以前のバージョンでは、結果の各ブロックの処理が終わるごとにしか進捗が表示されず、実用的ではありませんでした。進捗の表示方法を変更し、0 の値は表示されないようにしました。進捗は頻繁に発生する場合でも送信されることに注意してください。かなりのトラフィック量を生成する可能性があります。また、出力が圧縮されている場合、進捗情報はフラッシュされないことにも注意してください。これにより [#70800](https://github.com/ClickHouse/ClickHouse/issues/70800) が解決されました。[#73834](https://github.com/ClickHouse/ClickHouse/pull/73834)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `mysql` 辞書ソースは、今後は `SHOW TABLE STATUS` クエリを実行しません。これは、InnoDB テーブルについてはもちろん、近年の MySQL バージョンではこのクエリが有用な情報を提供しないためです。この変更により [#72636](https://github.com/ClickHouse/ClickHouse/issues/72636) がクローズされました。この変更には後方互換性がありますが、気づいてもらえるようにこのカテゴリに含めています。[#73914](https://github.com/ClickHouse/ClickHouse/pull/73914)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `Merge` テーブルは、列の和集合と共通の型を導出することで、基礎となるテーブルの構造を統一します。これにより [#64864](https://github.com/ClickHouse/ClickHouse/issues/64864) が解決され、[#35307](https://github.com/ClickHouse/ClickHouse/issues/35307) も解決されます。特定のケースでは、この変更は後方互換性がなくなる可能性があります。1 つの例として、テーブル間に共通の型は存在しないものの、最初のテーブルの型への変換は可能な場合が挙げられます。たとえば、UInt64 と Int64 の場合や、任意の数値型と String の場合です。以前の動作に戻したい場合は、`merge_table_max_tables_to_look_for_schema_inference` を `1` に設定するか、`compatibility` を `24.12` 以前に設定してください。[#73956](https://github.com/ClickHouse/ClickHouse/pull/73956)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `CHECK TABLE` クエリには、新たに専用の `CHECK` 権限が必要になりました。以前のバージョンでは、これらのクエリを実行するには `SHOW TABLES` 権限だけで十分でした。しかし、`CHECK TABLE` クエリは重くなる可能性があり、`SELECT` クエリに適用される通常のクエリの複雑さに関する制限が適用されませんでした。その結果、DoS のリスクがありました。[#74471](https://github.com/ClickHouse/ClickHouse/pull/74471)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `allow_materialized_view_with_bad_select` が `false` の場合、マテリアライズドビュー内のすべての列が対象テーブルと一致しているかどうかを検証します。 [#74481](https://github.com/ClickHouse/ClickHouse/pull/74481) ([Christoph Wurm](https://github.com/cwurm))。
* 関数 `h3ToGeo()` は、結果を `(lat, lon)`（幾何関数における標準的な順序）で返すようになりました。従来の結果順序 `(lon, lat)` を維持したい場合は、設定 `h3togeo_lon_lat_result_order = true` を有効にできます。[#74719](https://github.com/ClickHouse/ClickHouse/pull/74719)（[Manish Gill](https://github.com/mgill25)）。
* `JSONCompactEachRowWithProgress` と `JSONCompactStringsEachRowWithProgress` フォーマットを追加しました。これは [#69989](https://github.com/ClickHouse/ClickHouse/issues/69989) の続きです。`JSONCompactWithNames` および `JSONCompactWithNamesAndTypes` は、&quot;&quot;totals&quot;&quot; を出力しなくなりました。これは実装上の誤りだったと考えられます。[#75037](https://github.com/ClickHouse/ClickHouse/pull/75037)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `format_alter_operations_with_parentheses` のデフォルト値を true に変更し、alter コマンドのリストを明確にしました（[https://github.com/ClickHouse/ClickHouse/pull/59532](https://github.com/ClickHouse/ClickHouse/pull/59532) を参照）。これにより、バージョン 24.3 より前のクラスターとのレプリケーションは動作しなくなります。古いリリースを使用しているクラスターをアップグレードする場合は、サーバー設定でこの設定をオフにするか、先に 24.3 へアップグレードしてください。[#75302](https://github.com/ClickHouse/ClickHouse/pull/75302)（[Raúl Marín](https://github.com/Algunenano)）。
* レプリケートされたデータベースに対する `TRUNCATE DATABASE` を禁止。 [#76651](https://github.com/ClickHouse/ClickHouse/pull/76651) ([Bharat Nallan](https://github.com/bharatnc)).
* `compatibility` 設定に関係なく、analyzer が無効化されている場合はデフォルトで parallel replicas を無効にしました。この挙動は、`parallel_replicas_only_with_analyzer` を `false` に明示的に設定することで引き続き変更できます。 [#77115](https://github.com/ClickHouse/ClickHouse/pull/77115) ([Igor Nikonov](https://github.com/devcrafter)).
* 設定における浮動小数点値として `NaN` や `inf` を使用することはできなくなりました。 [#77546](https://github.com/ClickHouse/ClickHouse/pull/77546) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。
* `dateTrunc` が負の値を持つ date/datetime 引数とともに使用されている場合を修正します。 [#77622](https://github.com/ClickHouse/ClickHouse/pull/77622) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。
* レガシーな MongoDB 統合機能は削除されました。サーバー設定 `use_legacy_mongodb_integration` は廃止され、現在は何の効果もありません。[#77895](https://github.com/ClickHouse/ClickHouse/pull/77895)（[Robert Schulze](https://github.com/rschu1ze)）。
* `SummingMergeTree` の検証ロジックを強化し、パーティションキーまたはソートキーとして使用されている列については集約をスキップするようにしました。 [#78022](https://github.com/ClickHouse/ClickHouse/pull/78022) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).





## 新機能 {#new-features}


* デシリアライズされたスキッピングインデックスのグラニュール用にインメモリキャッシュを追加しました。これにより、スキッピングインデックスを使用する繰り返しクエリが高速化されます。この新しいキャッシュのサイズは、サーバー設定 `skipping_index_cache_size` および `skipping_index_cache_max_entries` によって制御されます。このキャッシュを導入した主な目的はベクトル類似度インデックスであり、これによりそれらは大幅に高速化されました。 [#70102](https://github.com/ClickHouse/ClickHouse/pull/70102) ([Robert Schulze](https://github.com/rschu1ze)).
* ユーザースペースページキャッシュの新しい実装。OS のページキャッシュに依存せず、プロセス内メモリにデータをキャッシュできるようにします。ローカルファイルシステムキャッシュを伴わずに、データがリモートの仮想ファイルシステム上に保存されている場合に有用です。[#70509](https://github.com/ClickHouse/ClickHouse/pull/70509)（[Michael Kolupaev](https://github.com/al13n321)）。
* 特定のタイムスタンプ時点における Iceberg テーブルをクエリするための設定を追加。 [#71072](https://github.com/ClickHouse/ClickHouse/pull/71072) ([Brett Hoerner](https://github.com/bretthoerner))。
* 時間関連の変換を伴うパーティション操作に対する Iceberg テーブルのパーティションプルーニングを実装しました。 [#72044](https://github.com/ClickHouse/ClickHouse/pull/72044) ([Daniil Ivanik](https://github.com/divanik)).
* MergeTree によって管理されるカラムに対して、デフォルトで min-max（スキッピング）インデックスを作成できるようにする設定 `enable_minmax_index_for_all_numeric_columns`（数値カラム用）および `enable_minmax_index_for_all_string_columns`（文字列カラム用）を追加しました。現時点では、両方の設定は無効になっているため、まだ既存の動作に変更はありません。 [#72090](https://github.com/ClickHouse/ClickHouse/pull/72090) ([Smita Kulkarni](https://github.com/SmitaRKulkarni))。
* 集約関数 `sequenceMatchEvents` を追加しました。この関数は、パターン内で最長のイベント連鎖に対して、一致したイベントのタイムスタンプを返します。 [#72349](https://github.com/ClickHouse/ClickHouse/pull/72349) ([UnamedRus](https://github.com/UnamedRus))。
* `SELECT` と `VIEW` ステートメントでエイリアスがサポートされるようになりました。例えば、`SELECT b FROM (SELECT number, number*2 FROM numbers(2)) AS x (a, b);` のように記述できます。これにより、TPC-H クエリ 15 を変更を加えずに実行できるようになりました。[#72480](https://github.com/ClickHouse/ClickHouse/pull/72480)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* 新しい設定 `enable_adaptive_memory_spill_scheduler` を追加しました。この設定により、同一クエリ内の複数の grace JOIN が、その合計メモリ使用量を監視し、MEMORY&#95;LIMIT&#95;EXCEEDED を防ぐために外部ストレージへのスピルを適応的にトリガーできるようになります。 [#72728](https://github.com/ClickHouse/ClickHouse/pull/72728) ([lgbo](https://github.com/lgbo-ustc))。
* 関数 `arrayNormalizedGini` を追加しました。 [#72823](https://github.com/ClickHouse/ClickHouse/pull/72823) ([flynn](https://github.com/ucasfl)).
* 低カーディナリティの Decimal データ型をサポートし、[#72256](https://github.com/ClickHouse/ClickHouse/issues/72256) を修正。 [#72833](https://github.com/ClickHouse/ClickHouse/pull/72833) ([zhanglistar](https://github.com/zhanglistar))。
* `min_age_to_force_merge_seconds` と `min_age_to_force_merge_on_partition_only` が両方有効になっている場合、パーツのマージ処理は最大バイト数の制限を無視します。 [#73656](https://github.com/ClickHouse/ClickHouse/pull/73656) ([Kai Zhu](https://github.com/nauu))。
* Apache Arrow/Parquet/ORC からの HALF&#95;FLOAT 値の読み取りをサポートしました（Float32 として読み込まれます）。これにより [#72960](https://github.com/ClickHouse/ClickHouse/issues/72960) が解決されます。IEEE-754 の half float は BFloat16 と同じではないことに注意してください。[#73835](https://github.com/ClickHouse/ClickHouse/issues/73835) をクローズします。[#73836](https://github.com/ClickHouse/ClickHouse/pull/73836)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `system.trace_log` テーブルに、シンボル化されたスタックトレースを含む 2 つの新しい列 `symbols` および `lines` が追加されます。これにより、プロファイル情報の収集およびエクスポートが容易になります。これはサーバー設定の `trace_log` セクション内にある `symbolize` によって制御され、デフォルトで有効になっています。[#73896](https://github.com/ClickHouse/ClickHouse/pull/73896)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* テーブル内で自動増分 ID を生成するために使用できる新しい関数 `generateSerialID` を追加しました。[kazalika](https://github.com/kazalika) による [#64310](https://github.com/ClickHouse/ClickHouse/issues/64310) の継続です。これにより [#62485](https://github.com/ClickHouse/ClickHouse/issues/62485) がクローズされました。[#73950](https://github.com/ClickHouse/ClickHouse/pull/73950)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `query1 PARALLEL WITH query2 PARALLEL WITH query3 ... PARALLEL WITH queryN` という構文が追加されました。これは、副問い合わせ `{query1, query2, ... queryN}` を互いに並列で実行でき（かつ、その方が望ましい）ことを意味します。 [#73983](https://github.com/ClickHouse/ClickHouse/pull/73983) ([Vitaly Baranov](https://github.com/vitlibar))。
* 現在、Play UI はクエリ実行中に進捗バーを表示し、クエリのキャンセルが可能になりました。総レコード数と、スループットに関する詳細情報を表示します。データが到着し次第、テーブルを段階的にレンダリングできます。HTTP 圧縮を有効にしました。テーブルのレンダリングがより高速になりました。テーブルヘッダーは固定表示（スティッキー）になりました。セルを選択し、矢印キーで移動できるようになりました。選択されたセルのアウトラインによってセルが小さくなってしまう問題を修正しました。セルはマウスホバーでは拡大せず、選択時のみ拡大されるようになりました。受信データのレンダリングを停止するタイミングは、サーバー側ではなくクライアント側で決定されます。数値の桁区切りを強調表示します。全体的なデザインを刷新し、より力強い印象になりました。サーバーに到達可能かどうかと認証情報の正しさを確認し、サーバーバージョンと稼働時間を表示します。クラウドアイコンは Safari を含むすべてのフォントで輪郭付きで表示されます。ネストされたデータ型内の大きな整数をより適切にレンダリングします。`inf` / `nan` を正しく表示します。列ヘッダー上にマウスカーソルを置いた際にデータ型を表示します。 [#74204](https://github.com/ClickHouse/ClickHouse/pull/74204) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* MergeTree によって管理されるカラムに対して、`add_minmax_index_for_numeric_columns`（数値カラム用）および `add_minmax_index_for_string_columns`（文字列カラム用）の設定を用いて、デフォルトで min-max（スキップ）インデックスを作成できる機能を追加しました。現在のところ両方の設定は無効化されているため、まだ動作の変更はありません。 [#74266](https://github.com/ClickHouse/ClickHouse/pull/74266) ([Smita Kulkarni](https://github.com/SmitaRKulkarni)).
* `system.query_log`、ネイティブプロトコルの ClientInfo、そしてサーバーログに `script_query_number` および `script_line_number` フィールドを追加しました。これにより [#67542](https://github.com/ClickHouse/ClickHouse/issues/67542) がクローズされました。この機能に以前から [#68133](https://github.com/ClickHouse/ClickHouse/issues/68133) で最初に着手してくれた [pinsvin00](https://github.com/pinsvin00) に感謝します。[#74477](https://github.com/ClickHouse/ClickHouse/pull/74477)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* DateTime64 に対する減算演算子のサポートを追加し、DateTime64 同士および DateTime との減算を可能にしました。 [#74482](https://github.com/ClickHouse/ClickHouse/pull/74482) ([Li Yin](https://github.com/liyinsg)).
* AzureBlobStorage 向け DeltaLake テーブルエンジンのサポートを追加。 [#68043](https://github.com/ClickHouse/ClickHouse/issues/68043) を修正。 [#74541](https://github.com/ClickHouse/ClickHouse/pull/74541)（[Smita Kulkarni](https://github.com/SmitaRKulkarni)）。
* clickhouse クライアント接続の送信元 IP アドレスを設定するための bind&#95;host 設定を追加しました。 [#74741](https://github.com/ClickHouse/ClickHouse/pull/74741) ([Todd Yocum](https://github.com/toddyocum))。
* `SELECT` クエリの実行中に、送信直後からバックグラウンド処理でまだマテリアライズされていない未完了の mutation をただちに適用できる機能を追加しました。これは `apply_mutations_on_fly` を設定することで有効化できます。 [#74877](https://github.com/ClickHouse/ClickHouse/pull/74877) ([Anton Popov](https://github.com/CurtizJ))。
* `toStartOfInterval` の datetime 引数が負の値の場合に、これまで想定されていなかったいくつかのケースを修正しました。`toStartOfIntervalAllowNegative` という新しい関数を実装することで対応しており、動作はほぼ同等ですが、戻り値は `Date32` / `DateTime64` のみに限定されます。 [#74933](https://github.com/ClickHouse/ClickHouse/pull/74933) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。
* 新しい関数 `initialQueryStartTime` が追加されました。現在のクエリの開始時刻を返します。分散クエリにおいては、この値はすべてのシャードで同一になります。 [#75087](https://github.com/ClickHouse/ClickHouse/pull/75087) ([Roman Lomonosov](https://github.com/lomik))。
* system.tables に parametrized&#95;view&#95;parameters を導入しました。関連する issue をクローズしました: [https://github.com/clickhouse/clickhouse/issues/66756](https://github.com/clickhouse/clickhouse/issues/66756)。[#75112](https://github.com/ClickHouse/ClickHouse/pull/75112)（[NamNguyenHoai](https://github.com/NamHoaiNguyen)）。
* データベースコメントを変更可能にしました。[#73351](https://github.com/ClickHouse/ClickHouse/issues/73351) をクローズ。### ユーザー向けの変更に関するドキュメントエントリ。[#75622](https://github.com/ClickHouse/ClickHouse/pull/75622)（[NamNguyenHoai](https://github.com/NamHoaiNguyen)）。
* データベース層を介さずにテーブルを ATTACH できる機能を追加（UUID ハックを回避）。 [#75788](https://github.com/ClickHouse/ClickHouse/pull/75788) ([Azat Khuzhin](https://github.com/azat)).
* 同時クエリ間での CPU スロットの分配方法を制御するサーバー設定 `concurrent_threads_scheduler` を追加しました。`round_robin`（従来の動作）または `fair_round_robin` を設定でき、INSERT と SELECT の間で生じる不公平な CPU 分配の問題に対処します。 [#75949](https://github.com/ClickHouse/ClickHouse/pull/75949) ([Sergei Trifonov](https://github.com/serxa))。
* ライセンス上の問題により v24.10 で削除されていた QPL コーデックを復元しました。 [#76021](https://github.com/ClickHouse/ClickHouse/pull/76021) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* 関数 `arraySymmetricDifference` を追加しました。これは複数の配列引数に対して、すべての引数に共通して含まれていない要素をすべて返します。例：`SELECT arraySymmetricDifference([1, 2], [2, 3])` は `[1, 3]` を返します。(issue [#61673](https://github.com/ClickHouse/ClickHouse/issues/61673))。[#76231](https://github.com/ClickHouse/ClickHouse/pull/76231) ([Filipp Abapolov](https://github.com/pheepa))。
* `estimatecompressionratio` 集約関数を追加しました — 詳細は [#70801](https://github.com/ClickHouse/ClickHouse/issues/70801) を参照してください。[#76661](https://github.com/ClickHouse/ClickHouse/pull/76661)（[Tariq Almawash](https://github.com/talmawash)）。
* `FilterTransformPassedRows` および `FilterTransformPassedBytes` プロファイルイベントで、クエリ実行中にフィルタ処理された行数およびバイト数が表示されます。 [#76662](https://github.com/ClickHouse/ClickHouse/pull/76662) ([Onkar Deshpande](https://github.com/onkar)).
* ブロックチェーンの実装、特に EVM ベースのシステムで一般的に使用される `keccak256` ハッシュ関数を追加しました。[#76669](https://github.com/ClickHouse/ClickHouse/pull/76669) ([Arnaud Briche](https://github.com/arnaudbriche))。
* SCRAM-SHA-256 および PostgreSQL ワイヤプロトコル認証を更新。 [#76839](https://github.com/ClickHouse/ClickHouse/pull/76839) ([scanhex12](https://github.com/scanhex12)).
* この機能により、クライアントリクエストのヘッダーのうち、外部 HTTP 認証器に転送するヘッダーの一覧を定義できるようになりました。 [#77054](https://github.com/ClickHouse/ClickHouse/pull/77054) ([inv2004](https://github.com/inv2004))。
* `IcebergMetadataFilesCache` をサポートしました。これにより、manifest ファイルおよびその一覧と metadata.json を単一のキャッシュに格納できます。 [#77156](https://github.com/ClickHouse/ClickHouse/pull/77156) ([Han Fei](https://github.com/hanfei1991)).
* 関数 `arrayLevenshteinDistance`、`arrayLevenshteinDistanceWeighted`、`arraySimilarity` を追加しました。 [#77187](https://github.com/ClickHouse/ClickHouse/pull/77187)（[Mikhail f. Shiryaev](https://github.com/Felixoid)）。
* 3つの新しい関数を追加しました。仕様に準拠した `icebergTruncate`（[https://iceberg.apache.org/spec/#truncate-transform-details](https://iceberg.apache.org/spec/#truncate-transform-details)）、`toYearNumSinceEpoch`、`toMonthNumSinceEpoch` です。`Iceberg` エンジンのパーティションプルーニングで `truncate` 変換をサポートしました。[#77403](https://github.com/ClickHouse/ClickHouse/pull/77403)（[alesapin](https://github.com/alesapin)）。
* ユーザーが、過去の任意の時点における Iceberg テーブルの状態をクエリできるようにしました。 [#77439](https://github.com/ClickHouse/ClickHouse/pull/77439) ([Daniil Ivanik](https://github.com/divanik)).
* ワークロード向けに CPU スロットのスケジューリングを追加しました。詳細は [https://clickhouse.com/docs/operations/workload-scheduling#cpu&#95;scheduling](https://clickhouse.com/docs/operations/workload-scheduling#cpu_scheduling) を参照してください。 [#77595](https://github.com/ClickHouse/ClickHouse/pull/77595)（[Sergei Trifonov](https://github.com/serxa)）。
* `hasAll()` 関数で、tokenbf&#95;v1 および ngrambf&#95;v1 の全文検索スキッピングインデックスを利用できるようになりました。[#77662](https://github.com/ClickHouse/ClickHouse/pull/77662) ([UnamedRus](https://github.com/UnamedRus))。
* `JSON` データ型は本番運用に対応しています。詳しくは [https://jsonbench.com/](https://jsonbench.com/) を参照してください。`Dynamic` と `Varaint` データ型も本番運用に対応しています。 [#77785](https://github.com/ClickHouse/ClickHouse/pull/77785)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 逆シリアル化済みのベクトル類似インデックス用のインメモリキャッシュを追加しました。これにより、繰り返し実行される近似最近傍 (ANN) 検索クエリの性能が向上します。新しいキャッシュのサイズは、サーバー設定 `vector_similarity_index_cache_size` および `vector_similarity_index_cache_max_entries` によって制御されます。この機能は、以前のリリースにおけるスキッピングインデックスキャッシュ機能に取って代わるものです。[#77905](https://github.com/ClickHouse/ClickHouse/pull/77905) ([Shankar Iyer](https://github.com/shankar-iyer)).
* `UTF-8` 対応版を `sparseGrams` 関数および `sparseGramsHashes` 関数に追加。作者: [scanhex12](https://github.com/scanhex12)。[#78176](https://github.com/ClickHouse/ClickHouse/pull/78176)（[Pervakov Grigorii](https://github.com/GrigoryPervakov)）。
* `toInterval` 関数を導入しました。この関数は2つの引数（値と単位）を受け取り、その値を指定された `Interval` 型に変換します。[#78723](https://github.com/ClickHouse/ClickHouse/pull/78723)（[Andrew Davis](https://github.com/pulpdrew)）。





## 実験的機能 {#experimental-features}

- 新しい設定 `enable_replacing_merge_with_cleanup_for_min_age_to_force_merge` により、設定可能なタイムアウト後にパーティション全体の自動クリーンアップマージが可能になります。[#76440](https://github.com/ClickHouse/ClickHouse/pull/76440) ([Christoph Wurm](https://github.com/cwurm))。
- AWS S3およびローカルファイルシステム上のDeltaLakeテーブルに対する[Unity Catalog](https://www.databricks.com/product/unity-catalog)のサポートを追加しました。[#76988](https://github.com/ClickHouse/ClickHouse/pull/76988) ([alesapin](https://github.com/alesapin))。
- IcebergテーブルのためのAWS Glueサービスカタログとの実験的統合を導入しました。[#77257](https://github.com/ClickHouse/ClickHouse/pull/77257) ([alesapin](https://github.com/alesapin))。


## パフォーマンスの向上 {#performance-improvements}


* 未使用列を読み取らずに済むよう、lazy projection によりパフォーマンスを最適化。 [#55518](https://github.com/ClickHouse/ClickHouse/pull/55518) ([Xiaozhe Yu](https://github.com/wudidapaopao)).
* 行を比較する際、最も値が異なりやすいカラムから優先的に比較を開始するようにしました。 [#63780](https://github.com/ClickHouse/ClickHouse/pull/63780) ([UnamedRus](https://github.com/UnamedRus)).
* RowBinary 入力フォーマットを最適化し、[#63805](https://github.com/ClickHouse/ClickHouse/issues/63805) をクローズ。[#65059](https://github.com/ClickHouse/ClickHouse/pull/65059)（[Pavel Kruglov](https://github.com/Avogar)）。
* いくつかの低レベルな最適化により、文字列のデシリアライズを高速化しました。 [#65948](https://github.com/ClickHouse/ClickHouse/pull/65948) ([Nikita Taranov](https://github.com/nickitat)).
* コードのいくつかの箇所で `preserve_most` 属性を適用しました。 [#67778](https://github.com/ClickHouse/ClickHouse/pull/67778) ([Nikita Taranov](https://github.com/nickitat)).
* クエリ条件キャッシュを実装し、同一条件を繰り返し利用するクエリのパフォーマンスを向上させます。条件を満たさないデータ範囲をメモリ上の一時インデックスとして記憶します。後続のクエリはこのインデックスを利用します。 [#67768](https://github.com/ClickHouse/ClickHouse/issues/67768) をクローズ。### ユーザー向け変更のドキュメント項目。 [#69236](https://github.com/ClickHouse/ClickHouse/pull/69236) ([zhongyuankai](https://github.com/zhongyuankai)).
* `NativeORCBlockInputFormat` に対して非同期 I/O プリフェッチのサポートを追加し、リモート I/O レイテンシを隠すことで全体的なパフォーマンスを向上させました。私のテストケースでは、速度向上率は最大 1.47 倍に達しました。 [#70534](https://github.com/ClickHouse/ClickHouse/pull/70534) ([李扬](https://github.com/taiyang-li))。
* 右側の結合テーブルをキーに基づいて再配置することで、Grace Hash Join のパフォーマンスを向上しました。 [#72237](https://github.com/ClickHouse/ClickHouse/pull/72237) ([kevinyhzou](https://github.com/KevinyhZou)).
* `materialize ttl` で `ttl_only_drop_parts` を再び考慮するようにし、TTL を再計算するために必要な列だけを読み込み、空のパーツに置き換えることでパーツを削除します。 [#72751](https://github.com/ClickHouse/ClickHouse/pull/72751) ([Andrey Zvonov](https://github.com/zvonand)).
* `arrayROCAUC` と `arrayAUCPR` で曲線全体のうち一部区間の面積を計算できるようにし、膨大なデータセットに対して計算を並列化できるようにしました。 [#72904](https://github.com/ClickHouse/ClickHouse/pull/72904) ([Emmanuel](https://github.com/emmanuelsdias)).
* 不要なアイドルスレッドが多数生成されないようにしました。 [#72920](https://github.com/ClickHouse/ClickHouse/pull/72920) ([Guo Wangyang](https://github.com/guowangy)).
* `parallel_hash` JOIN アルゴリズムのプローブフェーズにおける左テーブルブロックのハッシュ分割処理が削除されました。 [#73089](https://github.com/ClickHouse/ClickHouse/pull/73089) ([Nikita Taranov](https://github.com/nickitat)).
* テーブル関数で中括弧による展開のみを使用している場合は、BLOB ストレージのキーを列挙しないようにしました。[#73333](https://github.com/ClickHouse/ClickHouse/issues/73333) をクローズ。[#73518](https://github.com/ClickHouse/ClickHouse/pull/73518)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* [#70502](https://github.com/ClickHouse/ClickHouse/issues/70502) のテストに基づき、算術演算において Int256 および UInt256 を clang の組み込み型 i256 に置き換えました。[#73658](https://github.com/ClickHouse/ClickHouse/pull/73658)（[李扬](https://github.com/taiyang-li)）。
* すべての引数型が数値である関数に対して高速パスを追加します。[https://github.com/ClickHouse/ClickHouse/pull/72258](https://github.com/ClickHouse/ClickHouse/pull/72258) におけるパフォーマンス問題を修正します。 [#73820](https://github.com/ClickHouse/ClickHouse/pull/73820) ([李扬](https://github.com/taiyang-li))。
* `maskedExecute` を非関数カラムに適用しないようにし、ショートサーキット実行の性能を改善しました。 [#73965](https://github.com/ClickHouse/ClickHouse/pull/73965) ([lgbo](https://github.com/lgbo-ustc)).
* Kafka/NATS/RabbitMQ/FileLog のヘッダー検出を無効化し、パフォーマンスを向上させました。 [#74006](https://github.com/ClickHouse/ClickHouse/pull/74006) ([Azat Khuzhin](https://github.com/azat)).
* ログラッパーは値渡しで使用し、ヒープに割り当てないようにしました。 [#74034](https://github.com/ClickHouse/ClickHouse/pull/74034) ([Mikhail Artemenko](https://github.com/Michicosun)).
* グルーピングセットを使用した集約の後に、より高い並列度でパイプラインを実行できるようにしました。 [#74082](https://github.com/ClickHouse/ClickHouse/pull/74082) ([Nikita Taranov](https://github.com/nickitat)).
* `MergeTreeReadPool` のクリティカルセクションを縮小しました。[#74202](https://github.com/ClickHouse/ClickHouse/pull/74202)（[Guo Wangyang](https://github.com/guowangy)）。
* 関数 `indexHint` を最適化し、関数 `indexHint` の引数としてのみ使用される列はテーブルから読み込まれないようにしました。 [#74314](https://github.com/ClickHouse/ClickHouse/pull/74314) ([Anton Popov](https://github.com/CurtizJ)).
* 並列レプリカにおけるパフォーマンスが改善されました。並列レプリカプロトコルに関連しないパケットについては、クエリのイニシエータ側でのパケットのデシリアライズが、常にパイプラインスレッド内で実行されるようになりました。以前は、パイプラインのスケジューリングを担当するスレッドで実行される場合があり、これによりイニシエータの応答性が低下し、パイプラインの実行が遅延することがありました。[#74398](https://github.com/ClickHouse/ClickHouse/pull/74398)（[Igor Nikonov](https://github.com/devcrafter)）。
* `LowCardinality` 列のメモリ内でのサイズ計算を修正しました。 [#74688](https://github.com/ClickHouse/ClickHouse/pull/74688) ([Nikita Taranov](https://github.com/nickitat)).
* S3 上の Wide パーツにおける JSON カラム全体の読み取り性能を向上します。これは、サブカラム接頭辞のデシリアライズに対するプリフェッチの追加、デシリアライズ済み接頭辞のキャッシュ、およびサブカラム接頭辞の並列デシリアライズを行うことで実現しています。これにより、`SELECT data FROM table` のようなクエリでは S3 からの JSON カラムの読み取りが 4 倍、`SELECT data FROM table LIMIT 10` のようなクエリでは約 10 倍高速化されます。 [#74827](https://github.com/ClickHouse/ClickHouse/pull/74827) ([Pavel Kruglov](https://github.com/Avogar)).
* async insert で使用されるメモリを事前に割り当てることでパフォーマンスを向上しました。 [#74945](https://github.com/ClickHouse/ClickHouse/pull/74945) ([Ilya Golshtein](https://github.com/ilejn)).
* オプティマイザによって結合の両側が入れ替えられた場合に、`ConcurrentHashJoin` でメモリが二重に事前確保される問題を修正しました。 [#75149](https://github.com/ClickHouse/ClickHouse/pull/75149) ([Nikita Taranov](https://github.com/nickitat)).
* `max_rows_in_join = max_bytes_in_join = 0` の場合に `parallel_hash` で発生していた不要な競合を解消しました。 [#75155](https://github.com/ClickHouse/ClickHouse/pull/75155) ([Nikita Taranov](https://github.com/nickitat)).
* 一部の JOIN ケースでのわずかな性能改善: 出力行数をあらかじめ計算し、その分のメモリを予約するようにしました。 [#75376](https://github.com/ClickHouse/ClickHouse/pull/75376) ([Alexander Gololobov](https://github.com/davenger)).
* `plain_rewritable` メタデータファイルは小さいため、大きなデフォルトバッファは不要です。与えられたパスに適切に収まるサイズの書き込みバッファを使用することで、多数のアクティブパーツが存在する場合のメモリ使用効率が向上します。 ### ユーザー向け変更のドキュメント項目です。 [#75758](https://github.com/ClickHouse/ClickHouse/pull/75758) ([Julia Kartseva](https://github.com/jkartseva)).
* 場合によっては（例: 空の配列型カラム）、データパーツに空のファイルが含まれることがあります。テーブルがメタデータとオブジェクトストレージを分離した構成でディスク上に存在する場合、そのようなファイルについては ObjectStorage への空の BLOB の書き込みをスキップし、メタデータのみを保存できるようにしました。 [#75860](https://github.com/ClickHouse/ClickHouse/pull/75860) ([Alexander Gololobov](https://github.com/davenger))。
* 同時実行制御により、INSERT と SELECT 間で CPU の割り当てが不公平になる可能性があることが判明しました。すべての CPU スロットが、`max_threads` = 1 の INSERT に対して他と競合することなく割り当てられる一方で、高い `max_threads` 値を持つ SELECT は、実際には単一スレッドしか使用できず、パフォーマンスが低下していました。 [#75941](https://github.com/ClickHouse/ClickHouse/pull/75941)（[Sergei Trifonov](https://github.com/serxa)）。
* 不要な null map のアロケーションを回避するための `wrapInNullable` に対する軽微な最適化。 [#76489](https://github.com/ClickHouse/ClickHouse/pull/76489) ([李扬](https://github.com/taiyang-li))
* Decimal32/Decimal64/DateTime64 に対する min/max のパフォーマンスを改善しました。 [#76570](https://github.com/ClickHouse/ClickHouse/pull/76570) ([李扬](https://github.com/taiyang-li))。
* パーツ削除時にキャッシュからデータを積極的に削除するようにしました。キャッシュ対象のデータ量がそれ未満の場合には、キャッシュが最大サイズまで増加しないようにしました。 [#76641](https://github.com/ClickHouse/ClickHouse/pull/76641) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* クエリコンパイル（`compile_expressions` 設定）がマシンタイプを考慮するようになりました。これにより、そのようなクエリの実行速度が大幅に向上します。 [#76753](https://github.com/ClickHouse/ClickHouse/pull/76753) ([Robert Schulze](https://github.com/rschu1ze))。
* arraySort を最適化しました。 [#76850](https://github.com/ClickHouse/ClickHouse/pull/76850) ([李扬](https://github.com/taiyang-li))。
* `col->insertFrom()` への仮想関数呼び出しをデバーチャル化することで、JOIN 結果の構築を高速化しました。 [#77350](https://github.com/ClickHouse/ClickHouse/pull/77350) ([Alexander Gololobov](https://github.com/davenger)).
* 同一パーツのマークをマージし、一度にクエリ条件キャッシュへ書き込むことで、ロック取得のオーバーヘッドを削減しました。 [#77377](https://github.com/ClickHouse/ClickHouse/pull/77377) ([zhongyuankai](https://github.com/zhongyuankai)).
* Nullable な単一列または低カーディナリティ列での ORDER BY を最適化。 [#77789](https://github.com/ClickHouse/ClickHouse/pull/77789) ([李扬](https://github.com/taiyang-li)).
* キャッシュがマージなどの用途で受動的に使用される場合は、`filesystem_cache_prefer_bigger_buffer_size` を無効にします。[#77898](https://github.com/ClickHouse/ClickHouse/pull/77898)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* Iceberg に対して単純な count 用の最適化を実装しました。これにより、フィルタ条件を持たない `count()` クエリの実行がより高速になります。[#77639](https://github.com/ClickHouse/ClickHouse/issues/77639) をクローズしました。 [#78090](https://github.com/ClickHouse/ClickHouse/pull/78090) ([alesapin](https://github.com/alesapin))。
* 列の `lower_bound` および `upper_bound` 値に基づく Iceberg データプルーニングをサポートしました。[#77638](https://github.com/ClickHouse/ClickHouse/issues/77638) を修正。[#78242](https://github.com/ClickHouse/ClickHouse/pull/78242)（[alesapin](https://github.com/alesapin)）。
* NativeReader のメモリ使用を最適化。 [#78442](https://github.com/ClickHouse/ClickHouse/pull/78442) ([Azat Khuzhin](https://github.com/azat)).
* 軽微な最適化: `CAST` が必要な場合は `count(if())` を countIf に書き換えないようにしました。[#78564](https://github.com/ClickHouse/ClickHouse/issues/78564) をクローズしました。[#78565](https://github.com/ClickHouse/ClickHouse/pull/78565)（[李扬](https://github.com/taiyang-li)）。





## 改善点 {#improvements}


* `multiRead` が利用可能な箇所では単一の `get` リクエストを使用しないようにすることで、Keeper へのリクエスト数を削減しました。単一の `get` リクエストは、レプリカ数の増加に伴い Keeper に対する大きな負荷の原因となり得ました。[#56862](https://github.com/ClickHouse/ClickHouse/pull/56862)（[Nikolay Degterinsky](https://github.com/evillique)）。
* MySQL の named collections に対して SSL 認証のサポートを追加しました。[#59111](https://github.com/ClickHouse/ClickHouse/issues/59111) を解決。[#59452](https://github.com/ClickHouse/ClickHouse/pull/59452)（[Nikolay Degterinsky](https://github.com/evillique)）。
* `ConstantNode` 内で `Field` の代わりに `ColumnPtr` を保持することで、新しいアナライザーインフラストラクチャのパフォーマンスを改善。 [#62245](https://github.com/ClickHouse/ClickHouse/issues/62245) に関連。 [#63198](https://github.com/ClickHouse/ClickHouse/pull/63198)（[Dmitry Novik](https://github.com/novikd)）。
* サーバーが過負荷状態のときにクエリを拒否します。判断は、待ち時間（`OSCPUWaitMicroseconds`）とビジー時間（`OSCPUVirtualTimeMicroseconds`）の比率に基づいて行われます。この比率が `min_os_cpu_wait_time_ratio_to_throw` と `max_os_cpu_wait_time_ratio_to_throw` の間の値になった場合（これらはクエリレベルの設定です）、ある確率でクエリが破棄されます。 [#63206](https://github.com/ClickHouse/ClickHouse/pull/63206) ([Alexey Katsman](https://github.com/alexkats))。
* メモリ使用量を抑えるため、ブロックは可能な限り早い段階で破棄します。 [#65647](https://github.com/ClickHouse/ClickHouse/pull/65647) ([lgbo](https://github.com/lgbo-ustc)).
* `processors_profile_log` テーブルに、TTL 30 日のデフォルト構成が設定されました。 [#66139](https://github.com/ClickHouse/ClickHouse/pull/66139) ([Ilya Yatsishin](https://github.com/qoega)).
* DateTime64 型の列に対して `bloom_filter` インデックスを作成できるようにしました。 [#66416](https://github.com/ClickHouse/ClickHouse/pull/66416) ([Yutong Xiao](https://github.com/YutSean))。
* レイテンシーバケットを導入し、S3 リクエストに対するファーストバイトの読み取り/書き込みおよび接続までの時間を追跡できるようにします。これにより、収集したデータを用いてパーセンタイルのおおよその値を計算し、タイムアウトを調整できるようになります。 [#69783](https://github.com/ClickHouse/ClickHouse/pull/69783) ([Alexey Katsman](https://github.com/alexkats)).
* `Executable` ストレージに渡されるクエリは、単一スレッドでの実行に限定されなくなりました。 [#70084](https://github.com/ClickHouse/ClickHouse/pull/70084) ([yawnt](https://github.com/yawnt)).
* トレーサビリティ向上のため、OpenTelemetry の span logs テーブルに HTTP ヘッダーを追加。 [#70516](https://github.com/ClickHouse/ClickHouse/pull/70516) ([jonymohajanGmail](https://github.com/jonymohajanGmail)).
* ORC ファイルを書き込む際に、`GMT` タイムゾーンだけでなくカスタムタイムゾーンも使用できるようにしました。[#70615](https://github.com/ClickHouse/ClickHouse/pull/70615) ([kevinyhzou](https://github.com/KevinyhZou))。
* 並列レプリカが有効な場合は、テーブル関数を対応する `-Cluster` 版に置き換えるようにしました。[#65024](https://github.com/ClickHouse/ClickHouse/issues/65024) を修正。[#70659](https://github.com/ClickHouse/ClickHouse/pull/70659)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* クラウド間でバックアップを作成する際に I/O スケジューリング設定が尊重されるようにしました。 [#71093](https://github.com/ClickHouse/ClickHouse/pull/71093) ([János Benjamin Antal](https://github.com/antaljanosbenjamin)).
* 対応する辞書へのリクエストが遅延しないよう、MySQL および Postgres の辞書レプリカへの接続をバックグラウンドで再確立するようにしました。 [#71101](https://github.com/ClickHouse/ClickHouse/pull/71101) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* `system.asynchronous_metrics` にメトリックのエイリアス名を追加。 [#71164](https://github.com/ClickHouse/ClickHouse/pull/71164) ([megao](https://github.com/jetgm))。
* リフレッシュ可能なマテリアライズドビューのリフレッシュ処理が `system.query_log` に記録されるようになりました。 [#71333](https://github.com/ClickHouse/ClickHouse/pull/71333) ([Michael Kolupaev](https://github.com/al13n321)).
* Parquet の bloom filter と min/max index を合わせて評価するようにしました。これにより、データ = [1, 2, 4, 5] の場合に `x = 3 or x > 5` を正しくサポートできるようになります。 [#71383](https://github.com/ClickHouse/ClickHouse/pull/71383) ([Arthur Passos](https://github.com/arthurpassos))。
* インタラクティブメトリクスを改善。並列レプリカからのメトリクスが完全に表示されない問題を修正。メトリクスを最新の更新時刻順、その後に名前の辞書順で表示。古くなったメトリクスは表示しないように変更。 [#71631](https://github.com/ClickHouse/ClickHouse/pull/71631) ([Julia Kartseva](https://github.com/jkartseva))。
* 歴史的な経緯から、クエリ `ALTER TABLE MOVE PARTITION TO TABLE` は専用の `ALTER_MOVE_PARTITION` 権限ではなく、`SELECT` および `ALTER DELETE` 権限をチェックしていました。この PR では、このアクセス種別を使用するように変更しています。互換性維持のために、`SELECT` と `ALTER DELETE` が付与されている場合には、この権限も暗黙的に付与されますが、この挙動は今後のリリースで削除される予定です。[#16403](https://github.com/ClickHouse/ClickHouse/issues/16403) をクローズ。[#71632](https://github.com/ClickHouse/ClickHouse/pull/71632)（[pufit](https://github.com/pufit)）。
* デフォルトで `use_hive_partitioning` を有効にできるようにしました。 [#71636](https://github.com/ClickHouse/ClickHouse/pull/71636) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。
* ソートキー内の列をマテリアライズしようとした場合、ソート順が崩れるのを許容するのではなく、例外をスローするようにしました。ただし、これは [#71777](https://github.com/ClickHouse/ClickHouse/issues/71777) を解決するものではありません。[#71891](https://github.com/ClickHouse/ClickHouse/pull/71891)（[Peter Nguyen](https://github.com/petern48)）。
* ハッシュ結合アルゴリズムが有効な場合に、より汎用的な結合計画アルゴリズムを使用できるようにしました。 [#71926](https://github.com/ClickHouse/ClickHouse/pull/71926) ([János Benjamin Antal](https://github.com/antaljanosbenjamin))。
* `EXPLAIN QUERY TREE` でシークレットを非表示にしました。 [#72025](https://github.com/ClickHouse/ClickHouse/pull/72025) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy))。
* データベースおよびテーブルのメタデータファイルを保存するために、設定可能なディスクを使用できるようにしました。ディスク名は `database_disk.disk` 設定パラメータで指定できます。[#72027](https://github.com/ClickHouse/ClickHouse/pull/72027)（[Tuan Pham Anh](https://github.com/tuanpach)）。
* ネイティブリーダーで Parquet の整数論理型をサポート。 [#72105](https://github.com/ClickHouse/ClickHouse/pull/72105) ([Arthur Passos](https://github.com/arthurpassos))。
* JSON 出力フォーマットをデフォルトで整形表示にしました。これを制御する新しい設定 `output_format_json_pretty_print` を追加し、デフォルトで有効化しました。 [#72148](https://github.com/ClickHouse/ClickHouse/pull/72148) ([Pavel Kruglov](https://github.com/Avogar)).
* デフォルトユーザーにパスワードが必要な場合、ブラウザ上で対話的に認証情報を要求するようになりました。以前のバージョンではサーバーは HTTP 403 を返していましたが、現在は HTTP 401 を返します。 [#72198](https://github.com/ClickHouse/ClickHouse/pull/72198) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* このPRでは、アクセス種別 `CREATE_USER`、`ALTER_USER`、`DROP_USER`、`CREATE_ROLE`、`ALTER_ROLE`、`DROP_ROLE` をグローバルなものからパラメータ化されたものへ変更しました。これにより、ユーザーはアクセス管理に関する権限を、よりきめ細かく付与できるようになりました。[#72246](https://github.com/ClickHouse/ClickHouse/pull/72246) ([pufit](https://github.com/pufit))。
* クラスタ設定でシャード名を指定できるようにしました。 [#72276](https://github.com/ClickHouse/ClickHouse/pull/72276) ([MikhailBurdukov](https://github.com/MikhailBurdukov)).
* 異なるパラメータを持つ JSON 型間での CAST および ALTER をサポートしました。[#72303](https://github.com/ClickHouse/ClickHouse/pull/72303) ([Pavel Kruglov](https://github.com/Avogar)).
* `system.mutations` に `latest_fail_error_code_name` カラムを追加しました。このカラムは、停止した mutation に関する新しいメトリクスを導入し、クラウドで発生したエラーのグラフを作成するために使用します。また、必要に応じて、ノイズの少ない新しいアラートを追加するためにも利用されます。[#72398](https://github.com/ClickHouse/ClickHouse/pull/72398)（[Miсhael Stetsyuk](https://github.com/mstetsyuk)）。
* パーティションのアタッチ時に行われるメモリアロケーションの量を削減しました。 [#72583](https://github.com/ClickHouse/ClickHouse/pull/72583) ([Konstantin Morozov](https://github.com/k-morozov)).
* `max_bytes_before_external_sort` の制限をクエリ全体のメモリ消費量に基づくようにしました（以前は 1 つのソートスレッドにおけるソートブロック内のバイト数を意味していましたが、現在は `max_bytes_before_external_group_by` と同じ意味を持ち、全スレッドを合わせたクエリ全体のメモリ使用量に対する合計上限となります）。また、ディスク上のブロックサイズを制御するための新たな設定 `min_external_sort_block_bytes` が追加されました。[#72598](https://github.com/ClickHouse/ClickHouse/pull/72598) ([Azat Khuzhin](https://github.com/azat))。
* トレースコレクタではメモリ制限を無視するようにしました。 [#72606](https://github.com/ClickHouse/ClickHouse/pull/72606) ([Azat Khuzhin](https://github.com/azat)).
* MergeTree のソートキーおよびスキップインデックスでサブカラムのサポートを追加。[#72644](https://github.com/ClickHouse/ClickHouse/pull/72644) ([Pavel Kruglov](https://github.com/Avogar)).
* サーバー設定 `dictionaries_lazy_load` および `wait_dictionaries_load_at_startup` を `system.server_settings` に追加しました。 [#72664](https://github.com/ClickHouse/ClickHouse/pull/72664) ([Christoph Wurm](https://github.com/cwurm))。
* `max_backup_bandwidth` 設定を、`BACKUP`/`RESTORE` クエリの一部として指定可能な設定の一覧に追加しました。 [#72665](https://github.com/ClickHouse/ClickHouse/pull/72665) ([Christoph Wurm](https://github.com/cwurm))。
* Parallel replicas ではレプリカ選択を改善するためにレプリカの可用性に関する過去の情報を利用していましたが、接続が確立できない場合にそのレプリカのエラー数を更新していませんでした。この PR では、レプリカが利用不能な場合にそのレプリカのエラー数を更新するようにしました。 [#72666](https://github.com/ClickHouse/ClickHouse/pull/72666) ([zoomxi](https://github.com/zoomxi))。
* レプリケートクラスターで生成されるログ量を抑えるため、ReplicatedMergeTree エンジンで出現するレプリケートパーツに関するログレベルを引き下げました。 [#72876](https://github.com/ClickHouse/ClickHouse/pull/72876) ([mor-akamai](https://github.com/morkalfon)).
* 多くの新機能には、Iceberg メタデータに関するコードのより適切なカプセル化と、より洗練された抽象化が必要になります。 [#72941](https://github.com/ClickHouse/ClickHouse/pull/72941) ([Daniil Ivanik](https://github.com/divanik))。
* JSON カラム値の等値比較をサポート。 [#72991](https://github.com/ClickHouse/ClickHouse/pull/72991) ([Pavel Kruglov](https://github.com/Avogar)).
* JSON サブカラムを含む識別子のフォーマットを改善し、不要なバッククオートの使用を避けるようにしました。 [#73085](https://github.com/ClickHouse/ClickHouse/pull/73085) ([Pavel Kruglov](https://github.com/Avogar)).
* `Test` レベルで `PREWHERE` 条件をログに記録するようにしました。 [#73116](https://github.com/ClickHouse/ClickHouse/pull/73116) ([Vladimir Cherkasov](https://github.com/vdimir)).
* `ENGINE` を省略した `SETTINGS` と、エンジン設定とクエリ設定の混在をサポート。 [#73120](https://github.com/ClickHouse/ClickHouse/pull/73120) ([Raúl Marín](https://github.com/Algunenano)).
* `optimize_on_insert` が有効な場合、パーツをレベル 1 として書き込みます。これにより、新しく書き込まれたパーツに対する `FINAL` 付きクエリにいくつかの最適化を適用できるようになります。 [#73132](https://github.com/ClickHouse/ClickHouse/pull/73132) ([Anton Popov](https://github.com/CurtizJ)).
* `WHERE a<b AND b<c AND c<5` のようなクエリに対して、新たな比較条件（`a<5 AND b<5`）を生成できるようになり、フィルタリング能力が向上しました。 [#73164](https://github.com/ClickHouse/ClickHouse/pull/73164) ([Shichao Jin](https://github.com/jsc0218)).
* 論理和（OR）条件における共通部分式の抽出を改善しました。すべての OR 条件に共通する部分式が存在しない場合でも、結果として得られるフィルタ式を簡略化できるようにしました。[#71537](https://github.com/ClickHouse/ClickHouse/issues/71537) の継続です。[#73271](https://github.com/ClickHouse/ClickHouse/pull/73271)（[Dmitry Novik](https://github.com/novikd)）。
* Storage `S3(Azure)Queue` において、作成時に設定を指定していないテーブルにも設定を追加できるようにしました。 [#73283](https://github.com/ClickHouse/ClickHouse/pull/73283) ([Kseniia Sumarokova](https://github.com/kssenii)).
* clickhouse-client がクエリ終了の操作として Ctrl+D をサポートするようになりました。セミコロンを入力して Enter を押す代わりに Ctrl+D を使用できます。さらに、単一行モードでは Ctrl+D が Enter と同様に動作します。 [#73293](https://github.com/ClickHouse/ClickHouse/pull/73293) ([Xiaozhe Yu](https://github.com/wudidapaopao))。
* 設定 `least_greatest_legacy_null_behavior`（デフォルト: `false`）を導入しました。この設定は、関数 `least` と `greatest` が `NULL` 引数を受け取った際に、無条件に `NULL` を返す（`true` の場合）か、`NULL` 引数を無視する（`false` の場合）かを制御します。 [#73344](https://github.com/ClickHouse/ClickHouse/pull/73344)（[Robert Schulze](https://github.com/rschu1ze)）。
* ObjectStorageQueueMetadata のクリーンアップスレッドで Keeper のマルチリクエストを使用するようにしました。 [#73357](https://github.com/ClickHouse/ClickHouse/pull/73357) ([Antonio Andelic](https://github.com/antonio2368)).
* 新しい MongoDB ドライバーがデフォルトになりました。従来のドライバーを引き続き使用したいユーザーは、サーバー設定 `use_legacy_mongodb_integration` を true に設定できます。 [#73359](https://github.com/ClickHouse/ClickHouse/pull/73359) ([Robert Schulze](https://github.com/rschu1ze))。
* ClickHouse が cgroup 環境下で動作している場合でも、システム負荷、プロセススケジューリング、メモリなどに関連するシステム全体の非同期メトリクスの収集は継続されます。ClickHouse がホスト上で高いリソースを消費している唯一のプロセスである場合、これらは有用な指標を提供する可能性があります。[#73369](https://github.com/ClickHouse/ClickHouse/pull/73369) ([Nikita Taranov](https://github.com/nickitat))。
* ストレージ S3Queue において、24.6 より前に作成された古い ordered テーブルを、バケットを用いた新しい構造へ移行できるようになりました。 [#73467](https://github.com/ClickHouse/ClickHouse/pull/73467) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 既存の `system.s3queue` に類似した `system.azure_queue` を追加しました。 [#73477](https://github.com/ClickHouse/ClickHouse/pull/73477) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 修飾子付きの照合ロケールを使用した場合にエラーが発生していたリグレッションを修正しました。例として、`SELECT arrayJoin(['kk 50', 'KK 01', ' KK 2', ' KK 3', 'kk 1', 'x9y99', 'x9y100']) item ORDER BY item ASC COLLATE 'tr-u-kn-true-ka-shifted` が、今では正しく動作します。 [#73544](https://github.com/ClickHouse/ClickHouse/pull/73544)（[Robert Schulze](https://github.com/rschu1ze)）。
* Nullable(JSON) 型をサポートしました。 [#73556](https://github.com/ClickHouse/ClickHouse/pull/73556) ([Pavel Kruglov](https://github.com/Avogar)).
* 関数 `parseDateTime64`（およびその派生関数）は、1970年より前 / 2106年より後の日付の入力値に対して正しい結果を返すようになりました。例: `SELECT parseDateTime64InJodaSyntax('2200-01-01 00:00:00.000', 'yyyy-MM-dd HH:mm:ss.SSS')`。 [#73594](https://github.com/ClickHouse/ClickHouse/pull/73594)（[zhanglistar](https://github.com/zhanglistar)）。
* ユーザーから指摘されていた `clickhouse-disks` の使い勝手に関するいくつかの問題に対応しました。 [#67136](https://github.com/ClickHouse/ClickHouse/issues/67136) をクローズしました。 [#73616](https://github.com/ClickHouse/ClickHouse/pull/73616)（[Daniil Ivanik](https://github.com/divanik)）。
* storage S3(Azure)Queue においてコミット設定を変更できるようにしました（コミット設定: max&#95;processed&#95;files&#95;before&#95;commit、max&#95;processed&#95;rows&#95;before&#95;commit、max&#95;processed&#95;bytes&#95;before&#95;commit、max&#95;processing&#95;time&#95;sec&#95;before&#95;commit）。 [#73635](https://github.com/ClickHouse/ClickHouse/pull/73635) ([Kseniia Sumarokova](https://github.com/kssenii))。
* ストレージ S3(Azure)Queue において、コミット制限設定と比較できるよう、ソース間の進捗を集約するようにしました。 [#73641](https://github.com/ClickHouse/ClickHouse/pull/73641) ([Kseniia Sumarokova](https://github.com/kssenii)).
* `BACKUP`/`RESTORE` クエリでコア設定をサポート。 [#73650](https://github.com/ClickHouse/ClickHouse/pull/73650) ([Vitaly Baranov](https://github.com/vitlibar))。
* Parquet 出力で `output_format_compression_level` を読み取るようにしました。 [#73651](https://github.com/ClickHouse/ClickHouse/pull/73651) ([Arthur Passos](https://github.com/arthurpassos))。
* `arrow` の `fixed_size_list` を未サポート型として扱うのではなく、`Array` として読み込めるようにしました。 [#73654](https://github.com/ClickHouse/ClickHouse/pull/73654) ([Julian Meyers](https://github.com/J-Meyers)).
* このPRでは、バックアップエンジンとして `Memory`（現在のユーザーセッション内にバックアップを保持する）と `Null`（どこにもバックアップを保持しない）の2つを追加します。[#73690](https://github.com/ClickHouse/ClickHouse/pull/73690)（[Vitaly Baranov](https://github.com/vitlibar)）。
* `concurrent_threads_soft_limit_num` と `concurrent_threads_soft_limit_num_ratio_to_cores` はサーバーの再起動なしに変更できるようになりました。 [#73713](https://github.com/ClickHouse/ClickHouse/pull/73713) ([Sergei Trifonov](https://github.com/serxa)).
* formatReadable 関数に拡張数値型（Decimal、多倍長整数）のサポートを追加しました。 [#73765](https://github.com/ClickHouse/ClickHouse/pull/73765) ([Raúl Marín](https://github.com/Algunenano))。
* タプル列内のフィールドに対して、列名の大文字小文字を区別しないマッチングを正しく行うようにしました。 [https://github.com/apache/incubator-gluten/issues/8324](https://github.com/apache/incubator-gluten/issues/8324) をクローズ。 [#73780](https://github.com/ClickHouse/ClickHouse/pull/73780) ([李扬](https://github.com/taiyang-li)).
* Postgres ワイヤプロトコルでの TLS をサポートしました。 [#73812](https://github.com/ClickHouse/ClickHouse/pull/73812) ([scanhex12](https://github.com/scanhex12)).
* デフォルトで `LowCardinality(UUID)` を許可するようにしました。これは ClickHouse Cloud の顧客の間で実用的であることが確認されています。 [#73826](https://github.com/ClickHouse/ClickHouse/pull/73826) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* インストール時のメッセージを改善。 [#73827](https://github.com/ClickHouse/ClickHouse/pull/73827) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* ClickHouse Cloud のパスワードリセットに関するメッセージを改善しました。 [#73831](https://github.com/ClickHouse/ClickHouse/pull/73831) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* ファイルに追記できない File テーブル用のエラーメッセージを改善しました。 [#73832](https://github.com/ClickHouse/ClickHouse/pull/73832) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* ユーザーがターミナルで誤ってバイナリ形式（Native、Parquet、Avro など）の出力を要求した場合に確認を促すようにしました。これにより [#59524](https://github.com/ClickHouse/ClickHouse/issues/59524) がクローズされました。 [#73833](https://github.com/ClickHouse/ClickHouse/pull/73833) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* `BFloat16` データ型は本番環境で利用可能な状態になりました。 [#73840](https://github.com/ClickHouse/ClickHouse/pull/73840) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* ターミナルでの視認性を高めるため、Pretty および Vertical フォーマットで行末の空白文字をハイライト表示できるようにしました。これは `output_format_pretty_highlight_trailing_spaces` 設定で制御されます。初期実装は、[#72996](https://github.com/ClickHouse/ClickHouse/issues/72996) における [Braden Burns](https://github.com/bradenburns) によるものです。[#71590](https://github.com/ClickHouse/ClickHouse/issues/71590) をクローズします。[#73847](https://github.com/ClickHouse/ClickHouse/pull/73847)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `clickhouse-client` および `clickhouse-local` は、標準入力がファイルからリダイレクトされた場合、その圧縮形式を自動的に検出できるようになりました。これにより [#70865](https://github.com/ClickHouse/ClickHouse/issues/70865) が解決されました。[#73848](https://github.com/ClickHouse/ClickHouse/pull/73848)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* pretty 形式において、デフォルトで長すぎる列名を切り詰めるようにしました。これは `output_format_pretty_max_column_name_width_cut_to` および `output_format_pretty_max_column_name_width_min_chars_to_cut` の各設定によって制御されます。これは [#66502](https://github.com/ClickHouse/ClickHouse/issues/66502) における [tanmaydatta](https://github.com/tanmaydatta) の作業の継続です。この変更により [#65968](https://github.com/ClickHouse/ClickHouse/issues/65968) がクローズされました。[#73851](https://github.com/ClickHouse/ClickHouse/pull/73851)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `Pretty` フォーマットをより見栄えよくするため、前のブロックの出力からあまり時間が経過していない場合はブロックをまとめて出力するようにしました。これは新しい設定 `output_format_pretty_squash_consecutive_ms`（デフォルト 50 ms）および `output_format_pretty_squash_max_wait_ms`（デフォルト 1000 ms）で制御されます。[#49537](https://github.com/ClickHouse/ClickHouse/issues/49537) の継続です。この変更により [#49153](https://github.com/ClickHouse/ClickHouse/issues/49153) がクローズされました。[#73852](https://github.com/ClickHouse/ClickHouse/pull/73852)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* SQLite 向けの型マッピングを修正し、整数型を `int64` に、浮動小数点型を `float64` にマップするようにしました。 [#73853](https://github.com/ClickHouse/ClickHouse/pull/73853) ([Joanna Hulboj](https://github.com/jh0x))
* 現在マージ中のソースパーツ数を示すメトリクスを追加しました。これにより [#70809](https://github.com/ClickHouse/ClickHouse/issues/70809) がクローズされました。 [#73868](https://github.com/ClickHouse/ClickHouse/pull/73868)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 出力先がターミナルの場合、`Vertical` 形式で列をハイライト表示します。この挙動は `output_format_pretty_color` 設定で無効にできます。 [#73898](https://github.com/ClickHouse/ClickHouse/pull/73898) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* MySQL 互換性が強化され、現在では `mysqlsh`（Oracle 製の高機能な MySQL CLI）が ClickHouse に接続できるようになりました。これはテストを容易にするために必要です。 [#73912](https://github.com/ClickHouse/ClickHouse/pull/73912) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 出力レコード数が N = `output_format_pretty_max_rows` を超える場合、先頭の N 行のみを表示する代わりに、出力テーブルを途中で分割し、先頭 N/2 行と末尾 N/2 行を表示するようにしました。[#64200](https://github.com/ClickHouse/ClickHouse/issues/64200) の継続です。これにより [#59502](https://github.com/ClickHouse/ClickHouse/issues/59502) が解決されます。[#73929](https://github.com/ClickHouse/ClickHouse/pull/73929)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 関数 `isIPv4String` は、正しい IPv4 アドレスの後ろにゼロバイトが続いている場合に true を返していましたが、このケースでは false を返すべきでした。[#65387](https://github.com/ClickHouse/ClickHouse/issues/65387) の継続対応。[#73946](https://github.com/ClickHouse/ClickHouse/pull/73946)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* MySQL ワイヤープロトコルのエラーコードを MySQL と互換性のあるものにしました。[#56831](https://github.com/ClickHouse/ClickHouse/issues/56831) の続きです。[#50957](https://github.com/ClickHouse/ClickHouse/issues/50957) をクローズします。[#73948](https://github.com/ClickHouse/ClickHouse/pull/73948)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `IN`、`NOT IN` などの演算子における enum リテラルを enum 型に対して検証し、そのリテラルが有効な enum 値でない場合には例外をスローする設定 `validate_enum_literals_in_opearators` を追加しました。 [#73985](https://github.com/ClickHouse/ClickHouse/pull/73985) ([Vladimir Cherkasov](https://github.com/vdimir)).
* Storage `S3(Azure)Queue` では、コミット設定で定義された単一バッチに含まれるすべてのファイルを、1 つの Keeper トランザクションでコミットします。 [#73991](https://github.com/ClickHouse/ClickHouse/pull/73991) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 実行可能な UDF およびディクショナリに対するヘッダー検出を無効化しました（Function &#39;X&#39;: wrong result, expected Y row(s), actual Y-1 という問題につながる可能性がありました）。 [#73992](https://github.com/ClickHouse/ClickHouse/pull/73992) ([Azat Khuzhin](https://github.com/azat)).
* `EXPLAIN PLAN` に `distributed` オプションを追加しました。これにより、`EXPLAIN distributed=1 ...` は `ReadFromParallelRemote*` ステップにリモート側のプランを付加するようになりました。[#73994](https://github.com/ClickHouse/ClickHouse/pull/73994) ([Nikolai Kochetov](https://github.com/KochetovNicolai))。
* Dynamic 引数を取る not/xor に対して、正しい戻り値型を使用するようにしました。 [#74013](https://github.com/ClickHouse/ClickHouse/pull/74013) ([Pavel Kruglov](https://github.com/Avogar)).
* テーブルの作成後でも `add_implicit_sign_column_constraint_for_collapsing_engine` を変更できるようにしました。 [#74014](https://github.com/ClickHouse/ClickHouse/pull/74014) ([Christoph Wurm](https://github.com/cwurm)).
* マテリアライズドビューの `SELECT` クエリでサブカラムをサポートしました。 [#74030](https://github.com/ClickHouse/ClickHouse/pull/74030) ([Pavel Kruglov](https://github.com/Avogar)).
* Pretty 形式では、テーブルセル内で改行を含むフィールドを複数行で表示できるため、可読性が向上します。これはデフォルトで有効になっており、設定 `output_format_pretty_multiline_fields` で制御できます。[#64094](https://github.com/ClickHouse/ClickHouse/issues/64094) における [Volodyachan](https://github.com/Volodyachan) による作業の継続です。この変更により [#56912](https://github.com/ClickHouse/ClickHouse/issues/56912) が解決されました。[#74032](https://github.com/ClickHouse/ClickHouse/pull/74032)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `MergingAggregated` ステップに対して、クエリプランレベルでの `predicate-push-down` 最適化をサポートしました。これにより、新しいアナライザーを用いる一部のクエリでパフォーマンスが向上します。 [#74073](https://github.com/ClickHouse/ClickHouse/pull/74073) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* `clickhouse-client` でカスタムプロンプトを設定する簡単な方法が 3 つ追加されました。1. コマンドライン引数 `--prompt` を使用する方法、2. 設定ファイルで設定項目 `<prompt>[...]</prompt>` を使用する方法、3. 同じく設定ファイルで、接続ごとの設定 `<connections_credentials><prompt>[...]</prompt></connection_credentials>` を使用する方法です。[#74168](https://github.com/ClickHouse/ClickHouse/pull/74168)（[Christoph Wurm](https://github.com/cwurm)）。
* Prometheus の remote write レスポンスの成功ステータスを 200/OK から 204/NoContent に変更しました。 [#74170](https://github.com/ClickHouse/ClickHouse/pull/74170) ([Michael Dempsey](https://github.com/bluestealth)).
* ブラウザ内の JavaScript から `X-ClickHouse` HTTP ヘッダーを利用できるようにしました。これにより、アプリケーション開発がより容易になります。 [#74180](https://github.com/ClickHouse/ClickHouse/pull/74180) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* `JSONEachRowWithProgress` フォーマットには、メタデータを含むイベントに加えて、totals と extremes が含まれます。また、`rows_before_limit_at_least` および `rows_before_aggregation` も含まれます。このフォーマットは、部分結果が出力された後に発生した例外も正しく出力します。進捗情報には経過ナノ秒が含まれるようになりました。最後に 1 回、進捗イベントが終了時に送出されます。クエリ実行中の進捗情報は、`interactive_delay` 設定値で指定された頻度を超えては出力されません。 [#74181](https://github.com/ClickHouse/ClickHouse/pull/74181) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 砂時計が Play UI 上でスムーズに回転するようになりました。 [#74182](https://github.com/ClickHouse/ClickHouse/pull/74182) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* HTTP レスポンスが圧縮されている場合でも、パケットを受信し次第、即座に送信します。これにより、ブラウザは進捗状況を示すパケットと圧縮データを受信できるようになります。 [#74201](https://github.com/ClickHouse/ClickHouse/pull/74201) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* サーバーを再起動することなく、`max_remote_read_network_bandwidth_for_serve` と `max_remote_write_network_bandwidth_for_server` を動的に再読み込みできるようにしました。 [#74206](https://github.com/ClickHouse/ClickHouse/pull/74206) ([Kai Zhu](https://github.com/nauu)).
* ClickHouse Client でポート 9440 への接続に基づいてセキュアな接続を自動検出するようにしました。 [#74212](https://github.com/ClickHouse/ClickHouse/pull/74212) ([Christoph Wurm](https://github.com/cwurm)).
* http&#95;handlers でユーザー名のみでユーザーを認証できるようにしました（以前はパスワードの入力も必要でした）。 [#74221](https://github.com/ClickHouse/ClickHouse/pull/74221) ([Azat Khuzhin](https://github.com/azat)).
* 代替クエリ言語である PRQL および KQL のサポートは、実験的機能としてマークされました。これらを利用するには、設定 `allow_experimental_prql_dialect = 1` および `allow_experimental_kusto_dialect = 1` を指定してください。 [#74224](https://github.com/ClickHouse/ClickHouse/pull/74224) ([Robert Schulze](https://github.com/rschu1ze))。
* より多くの集約関数でデフォルトの `Enum` 型を返せるようにしました。 [#74272](https://github.com/ClickHouse/ClickHouse/pull/74272) ([Raúl Marín](https://github.com/Algunenano)).
* `OPTIMIZE TABLE` において、既存のキーワード `FINAL` に代わるキーワード `FORCE` を指定できるようになりました。 [#74342](https://github.com/ClickHouse/ClickHouse/pull/74342) ([Robert Schulze](https://github.com/rschu1ze)).
* マージツリーの設定 `materialize_skip_indexes_on_merge` が追加され、マージ時にスキップインデックスが作成されるのを抑制できるようになりました。これにより、スキップインデックスが作成されるタイミングを、`ALTER TABLE [..] MATERIALIZE INDEX [...]` を用いてユーザーが明示的に制御できます。これは、スキップインデックスの構築コストが高い場合（例：ベクトル類似性インデックス）に有用です。 [#74401](https://github.com/ClickHouse/ClickHouse/pull/74401) ([Robert Schulze](https://github.com/rschu1ze)).
* デフォルト式およびマテリアライズド式におけるサブカラムのサポート。 [#74403](https://github.com/ClickHouse/ClickHouse/pull/74403) ([Pavel Kruglov](https://github.com/Avogar)).
* Storage(S3/Azure)Queue の Keeper リクエストを最適化。 [#74410](https://github.com/ClickHouse/ClickHouse/pull/74410) ([Kseniia Sumarokova](https://github.com/kssenii)).
* サーバーのシャットダウン処理に時間がかかりすぎた場合にアラートをトリガーするために必要な `IsServerShuttingDown` メトリクスを追加しました。 [#74429](https://github.com/ClickHouse/ClickHouse/pull/74429) ([Miсhael Stetsyuk](https://github.com/mstetsyuk)).
* EXPLAIN に iceberg テーブルの名前を追加しました。[#74485](https://github.com/ClickHouse/ClickHouse/pull/74485) ([alekseev-maksim](https://github.com/alekseev-maksim)).
* デフォルトで最大 `1000` 個の parallel replicas を使用するようにしました。 [#74504](https://github.com/ClickHouse/ClickHouse/pull/74504) ([Konstantin Bogdanov](https://github.com/thevar1able))。
* 古いアナライザーで RECURSIVE CTE を使用した場合のエラーメッセージを改善しました。 [#74523](https://github.com/ClickHouse/ClickHouse/pull/74523) ([Raúl Marín](https://github.com/Algunenano)).
* Storage(S3/Azure)Queue における Keeper リクエストを最適化しました。 [#74538](https://github.com/ClickHouse/ClickHouse/pull/74538) ([Kseniia Sumarokova](https://github.com/kssenii)).
* S3 ディスクから読み取る際の HTTP セッション再利用を改善しました（[#72401](https://github.com/ClickHouse/ClickHouse/issues/72401)）。[#74548](https://github.com/ClickHouse/ClickHouse/pull/74548)（[Julian Maicher](https://github.com/jmaicher)）。
* 拡張されたエラーメッセージを `system.errors` に表示できるようにしました。 [#74574](https://github.com/ClickHouse/ClickHouse/pull/74574) ([Vitaly Baranov](https://github.com/vitlibar)).
* すべての種類のレプリケーションタスクに対してバックオフロジックを有効化しました。これにより、CPU 使用率、メモリ使用量、およびログファイルサイズを削減できるようになります。`max_postpone_time_for_failed_mutations_ms` と同様の新しい設定として、`max_postpone_time_for_failed_replicated_fetches_ms`、`max_postpone_time_for_failed_replicated_merges_ms`、`max_postpone_time_for_failed_replicated_tasks_ms` を追加しました。 [#74576](https://github.com/ClickHouse/ClickHouse/pull/74576) ([MikhailBurdukov](https://github.com/MikhailBurdukov)).
* `parallel_hash` JOIN アルゴリズムにおける `max_joined_block_size_rows` 設定の扱いをより正確にしました。これにより、`hash` アルゴリズムと比較してメモリ消費量が増加してしまうことを防ぎます。 [#74630](https://github.com/ClickHouse/ClickHouse/pull/74630) ([Nikita Taranov](https://github.com/nickitat)).
* libhdfs3 の `dfs.client.use.datanode.hostname` 設定オプションのサポートを追加しました。[#74635](https://github.com/ClickHouse/ClickHouse/pull/74635) ([Mikhail Tiukavkin](https://github.com/freshertm))。
* 修正（無効）: Codec &#39;snappy&#39; は圧縮レベルの設定をサポートしていません。 [#74659](https://github.com/ClickHouse/ClickHouse/pull/74659) ([Arthur Passos](https://github.com/arthurpassos)).
* clickhouse-keeper とのクライアント通信でパスワードを使用できるようにしました。この機能は、サーバーおよびクライアントの両方に適切な SSL 構成を設定している場合にはあまり有用ではありませんが、一部のケースでは依然として役立ちます。パスワードは 16 文字を超えることはできません。Keeper Auth モデルとは連動していません。 [#74673](https://github.com/ClickHouse/ClickHouse/pull/74673) ([alesapin](https://github.com/alesapin))。
* バックアップ作成時にチェックサムを計算するために BLOB パスを使用できるようにしました。 [#74729](https://github.com/ClickHouse/ClickHouse/pull/74729) ([Vitaly Baranov](https://github.com/vitlibar)).
* JOIN キーが両方のテーブルで PK のプレフィックスになっている場合は、JOIN に動的シャーディングを使用します。この最適化は `query_plan_join_shard_by_pk_ranges` 設定で有効にできます（デフォルトでは無効）。[#74733](https://github.com/ClickHouse/ClickHouse/pull/74733)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* Config reloader 向けのエラーコードを追加しました。 [#74746](https://github.com/ClickHouse/ClickHouse/pull/74746) ([Garrett Thomas](https://github.com/garrettthomaskth))。
* MySQL および PostgreSQL のテーブル関数とエンジンにおいて IPv6 アドレスのサポートを追加しました。 [#74796](https://github.com/ClickHouse/ClickHouse/pull/74796) ([Mikhail Koviazin](https://github.com/mkmkme)).
* Gorilla コーデックのパラメータは、`.sql` ファイル内のテーブルメタデータに常に保存されるようになりました。これにより [#70072](https://github.com/ClickHouse/ClickHouse/issues/70072) がクローズされました。[#74814](https://github.com/ClickHouse/ClickHouse/pull/74814)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* `divideDecimal` に対するショートサーキット最適化を実装しました。 [#74280](https://github.com/ClickHouse/ClickHouse/issues/74280) を修正しました。 [#74843](https://github.com/ClickHouse/ClickHouse/pull/74843)（[Kevin Mingtarja](https://github.com/kevinmingtarja)）。
* Keeper における大きなマルチリクエストの処理性能を改善しました。 [#74849](https://github.com/ClickHouse/ClickHouse/pull/74849) ([Antonio Andelic](https://github.com/antonio2368)).
* 起動スクリプト内でユーザーを指定できるようになりました。[#74894](https://github.com/ClickHouse/ClickHouse/pull/74894) ([pufit](https://github.com/pufit))
* ALTER TABLE FETCH PARTITION でパーツを並列にフェッチするようにしました（スレッド プールのサイズは `max_fetch_partition_thread_pool_size` で制御されます）。 [#74978](https://github.com/ClickHouse/ClickHouse/pull/74978) ([Azat Khuzhin](https://github.com/azat))。
* `system.query_cache` にクエリ ID 列を追加しました（issue [#68205](https://github.com/ClickHouse/ClickHouse/issues/68205)）。[#74982](https://github.com/ClickHouse/ClickHouse/pull/74982)（[NamNguyenHoai](https://github.com/NamHoaiNguyen)）。
* SSH プロトコルを再度有効にしました。いくつかの重大な脆弱性を修正し、カスタムページャーの使用や `server-logs-file` の指定ができないようにしました。デフォルトでは、環境変数を介してクライアントオプションを渡す機能を無効にしました（`config.xml` 内の `ssh-server.enable_client_options_passing` により引き続き利用可能です）。progress テーブル、クエリのキャンセル、補完、profile events の進捗、stdin および `send_logs_level` オプションをサポートしました。これにより次の Issue がクローズされます: [#74340](https://github.com/ClickHouse/ClickHouse/issues/74340)。[#74989](https://github.com/ClickHouse/ClickHouse/pull/74989)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* クエリ解釈中に発生した例外について、クエリで指定されたカスタムフォーマットで整形されるようにしました。以前のバージョンでは、クエリで指定されたフォーマットではなくデフォルトフォーマットで整形されていました。これにより [#55422](https://github.com/ClickHouse/ClickHouse/issues/55422) がクローズされました。 [#74994](https://github.com/ClickHouse/ClickHouse/pull/74994) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* パース機能を強化しました（シーケンス ID のパース: マニフェストファイル内のシーケンス識別子をパースする機能を追加、および Avro メタデータのパース: 将来の拡張が容易になるよう、Avro メタデータパーサーを拡張しやすい構造に再設計）。 [#75010](https://github.com/ClickHouse/ClickHouse/pull/75010) ([Daniil Ivanik](https://github.com/divanik))。
* `KILL QUERY` およびタイムアウト（`max_execution_time`）を使用して、`ALTER TABLE ... FREEZE ...` クエリをキャンセルできるようになりました。 [#75016](https://github.com/ClickHouse/ClickHouse/pull/75016) ([Kirill](https://github.com/kirillgarbar)).
* `groupUniqArrayArrayMap` を `SimpleAggregateFunction` としてサポートするようにしました。 [#75034](https://github.com/ClickHouse/ClickHouse/pull/75034) ([Miel Donkers](https://github.com/mdonkers))。
* Postgres ワイヤプロトコルでの prepared statement をサポートしました。 [#75035](https://github.com/ClickHouse/ClickHouse/pull/75035) ([scanhex12](https://github.com/scanhex12)).
* データベースエンジン `Iceberg` でカタログの認証情報設定を非表示化しました。 [#74559](https://github.com/ClickHouse/ClickHouse/issues/74559) をクローズしました。 [#75080](https://github.com/ClickHouse/ClickHouse/pull/75080)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* BuzzHouse に不足していた機能をいくつか追加しました：`ILIKE` および `REGEXP` 演算子、`<=>` および `IS NOT DISTINCT FROM`。 [#75168](https://github.com/ClickHouse/ClickHouse/pull/75168) ([Pedro Ferreira](https://github.com/PedroTadim)).
* 設定 `min_chunk_bytes_for_parallel_parsing` に 0 を指定することはできなくなりました。これにより次の問題が修正されます: [#71110](https://github.com/ClickHouse/ClickHouse/issues/71110)。[#75239](https://github.com/ClickHouse/ClickHouse/pull/75239)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* `intExp2` / `intExp10`: 未定義動作を明確化: 引数が小さすぎる場合は 0 を返し、引数が大きすぎる場合は `18446744073709551615` を返し、`nan` の場合は例外をスローします。 [#75312](https://github.com/ClickHouse/ClickHouse/pull/75312) ([Vitaly Baranov](https://github.com/vitlibar)).
* `DatabaseIceberg` のカタログ設定で `s3.endpoint` をネイティブにサポートしました。 [#74558](https://github.com/ClickHouse/ClickHouse/issues/74558) をクローズ。[#75375](https://github.com/ClickHouse/ClickHouse/pull/75375)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* `SYSTEM DROP REPLICA` を実行するユーザーに十分な権限がない場合、黙って失敗しないようにしました。 [#75377](https://github.com/ClickHouse/ClickHouse/pull/75377) ([Bharat Nallan](https://github.com/bharatnc)).
* 任意の system log がフラッシュに失敗した回数を記録する ProfileEvent を追加。 [#75466](https://github.com/ClickHouse/ClickHouse/pull/75466) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 復号および解凍処理のためのチェックとロギングを追加。 [#75471](https://github.com/ClickHouse/ClickHouse/pull/75471) ([Vitaly Baranov](https://github.com/vitlibar)).
* `parseTimeDelta` 関数でマイクロ記号 (U+00B5) をサポートしました。これにより、マイクロ記号 (U+00B5) とギリシャ文字ミュー (U+03BC) の両方がマイクロ秒を表す有効な表現として認識され、ClickHouse の動作が Go の実装と一致するようになりました（[time.go を参照](https://github.com/golang/go/blob/ad7b46ee4ac1cee5095d64b01e8cf7fcda8bee5e/src/time/time.go#L983C19-L983C20) および [time/format.go](https://github.com/golang/go/blob/ad7b46ee4ac1cee5095d64b01e8cf7fcda8bee5e/src/time/format.go#L1608-L1609)）。[#75472](https://github.com/ClickHouse/ClickHouse/pull/75472)（[Vitaly Orlov](https://github.com/orloffv)）。
* サーバー設定（`send_settings_to_client`）を、クライアント側のコード（例: INSERT データのパースやクエリ出力のフォーマット）がサーバーの `users.xml` およびユーザープロファイルの設定を使用するかどうかを制御するクライアント設定（`apply_settings_from_server`）に置き換えました。これを無効にした場合、クライアントのコマンドライン、セッション、およびクエリ内で指定された設定のみが使用されます。これはネイティブクライアントにのみ適用される点（HTTP などには適用されない）と、クエリ処理の大部分（サーバー側で実行される部分）には適用されない点に注意してください。 [#75478](https://github.com/ClickHouse/ClickHouse/pull/75478) ([Michael Kolupaev](https://github.com/al13n321)).
* Keeper の改善：パフォーマンス向上のため、インメモリストレージへのコミット時にはダイジェスト計算を無効化しました。`keeper_server.digest_enabled_on_commit` 設定で有効化できます。リクエストの前処理時には引き続きダイジェストが計算されます。 [#75490](https://github.com/ClickHouse/ClickHouse/pull/75490) ([Antonio Andelic](https://github.com/antonio2368)).
* 可能な場合には、JOIN の ON 句からフィルタ式をプッシュダウンするようにしました。[#75536](https://github.com/ClickHouse/ClickHouse/pull/75536) ([Vladimir Cherkasov](https://github.com/vdimir))。
* 構文エラー発生時のエラーメッセージを改善しました。これまでは、クエリが大きすぎて、長さが制限を超えるトークンが非常に大きな文字列リテラルである場合、その原因を説明するメッセージが、この非常に長いトークンの 2 つの例に挟まれて途中で失われていました。エラーメッセージ内で UTF-8 を含むクエリが不正に途中で切られてしまう問題を修正しました。クエリ断片に対する過剰なクオートも修正しました。これにより [#75473](https://github.com/ClickHouse/ClickHouse/issues/75473) がクローズされます。[#75561](https://github.com/ClickHouse/ClickHouse/pull/75561)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* ストレージ `S3(Azure)Queue` に ProfileEvents を追加。 [#75618](https://github.com/ClickHouse/ClickHouse/pull/75618) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 互換性のために、サーバーからクライアントへの設定送信（`send_settings_to_client=false`）を無効化しました。この機能は今後、使い勝手を高めるためにクライアント側の設定として再実装される予定です。 [#75648](https://github.com/ClickHouse/ClickHouse/pull/75648) ([Michael Kolupaev](https://github.com/al13n321)).
* バックグラウンドスレッドで定期的に読み取られる別の情報ソースの情報に基づいて内部メモリトラッカーを補正できるようにする設定 `memory_worker_correct_memory_tracker` を追加しました。 [#75714](https://github.com/ClickHouse/ClickHouse/pull/75714) ([Antonio Andelic](https://github.com/antonio2368))。
* PrometheusRemoteReadProtocol で Analyzer を使用するように変更しました。 [#75729](https://github.com/ClickHouse/ClickHouse/pull/75729) ([Dmitry Novik](https://github.com/novikd)).
* ゲージ型およびカウンター型のメトリクスはサポートされていますが、それだけでは一部のメトリクス（例：Keeper へのリクエストの応答時間）には不十分なため、ヒストグラム型メトリクスのサポートが必要です。このインターフェイスは Prometheus クライアントに非常によく似ており、値に対応するバケット内のカウンターを増加させるには、単に `observe(value)` を呼び出すだけです。ヒストグラムメトリクスは system.histogram&#95;metrics を介して公開されています。 [#75736](https://github.com/ClickHouse/ClickHouse/pull/75736) ([Miсhael Stetsyuk](https://github.com/mstetsyuk))。
* `system.processes` に `normalized_query_hash` 列を追加しました。注記: `normalizedQueryHash` 関数でその場で簡単に計算できますが、後続の変更に備えるために必要です。 [#75756](https://github.com/ClickHouse/ClickHouse/pull/75756) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* もはや存在しないデータベース上に作成された `Merge` テーブルがあっても、`system.tables` へのクエリは例外をスローしません。複雑な処理を行わせることは許可していないため、`Hive` テーブルから `getTotalRows` メソッドを削除しました。 [#75772](https://github.com/ClickHouse/ClickHouse/pull/75772) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* Web UI にインタラクティブなデータベースナビゲーション機能が追加されました。 [#75777](https://github.com/ClickHouse/ClickHouse/pull/75777) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* ストレージポリシーで、読み取り専用ディスクと読み書き可能ディスクを（複数ボリュームまたは複数ディスクとして）組み合わせて使用できるようにしました。これにより、ボリューム全体からデータを読み取れる一方で、挿入処理は書き込み可能なディスクが優先されます（いわゆる Copy-on-Write 型のストレージポリシー）。 [#75862](https://github.com/ClickHouse/ClickHouse/pull/75862) ([Azat Khuzhin](https://github.com/azat)).
* system.opentelemetry&#95;span&#95;log のデフォルトの ORDER BY 句から trace&#95;id を削除しました。 [#75907](https://github.com/ClickHouse/ClickHouse/pull/75907) ([Azat Khuzhin](https://github.com/azat)).
* 暗号化（XML 属性 `encrypted_by`）は、任意の設定ファイル（config.xml、users.xml、入れ子になった設定ファイル）に適用できるようになりました。これまで暗号化は、最上位の config.xml ファイルに対してのみ有効でした。[#75911](https://github.com/ClickHouse/ClickHouse/pull/75911)（[Mikhail Gorshkov](https://github.com/mgorshkov)）。
* バックアップの start&#95;time/end&#95;time をマイクロ秒単位で保存するようにしました。 [#75929](https://github.com/ClickHouse/ClickHouse/pull/75929) ([Aleksandr Musorin](https://github.com/AVMusorin)).
* RSS による補正が行われていない内部グローバルメモリトラッカーの値を示す `MemoryTrackingUncorrected` メトリクスを追加しました。 [#75935](https://github.com/ClickHouse/ClickHouse/pull/75935) ([Antonio Andelic](https://github.com/antonio2368)).
* MergeTree でカラムおよびインデックスのサイズを遅延的に計算するようにしました。 [#75938](https://github.com/ClickHouse/ClickHouse/pull/75938) ([Pavel Kruglov](https://github.com/Avogar))。
* 出力列が左テーブルにのみ結び付いている場合に、`JOIN` をサブクエリの `IN` へ変換する機能を追加。ただし、最初に一意性を確保するステップが必要なため、そのステップが後から追加されるまではデフォルトで無効化。 [#75942](https://github.com/ClickHouse/ClickHouse/pull/75942) ([Shichao Jin](https://github.com/jsc0218)).
* サーバー設定 `throw_on_unknown_workload` を追加しました。この設定により、`workload` 設定に未知の値が指定されたクエリに対する挙動を選択できます。無制限アクセスを許可する（デフォルト）か、`RESOURCE_ACCESS_DENIED` エラーをスローするかを指定できます。すべてのクエリで workload スケジューリングの利用を強制したい場合に有用です。 [#75999](https://github.com/ClickHouse/ClickHouse/pull/75999) ([Sergei Trifonov](https://github.com/serxa))。
* 新しい実験的な Kafka テーブルエンジンが Keeper の機能フラグを完全に遵守するようにしました。 [#76004](https://github.com/ClickHouse/ClickHouse/pull/76004) ([János Benjamin Antal](https://github.com/antaljanosbenjamin)).
* 不要な場合は、ARRAY JOIN においてサブカラムを `getSubcolumn` に書き換えないようにしました。 [#76018](https://github.com/ClickHouse/ClickHouse/pull/76018) ([Pavel Kruglov](https://github.com/Avogar)).
* テーブル読み込み時に発生したコーディネーションエラーを再試行するようにしました。 [#76020](https://github.com/ClickHouse/ClickHouse/pull/76020) ([Alexander Tokmakov](https://github.com/tavplubix)).
* `system.warnings` テーブルを改善し、追加・更新・削除可能な動的な警告メッセージをいくつか追加しました。 [#76029](https://github.com/ClickHouse/ClickHouse/pull/76029) ([Bharat Nallan](https://github.com/bharatnc))。
* `SYSTEM FLUSH LOGS` で個別のログをフラッシュできるようになりました。 [#76132](https://github.com/ClickHouse/ClickHouse/pull/76132) ([Raúl Marín](https://github.com/Algunenano)).
* `/binary` サーバーのページを改善しました。Morton 曲線の代わりに Hilbert 曲線を使用するようにしました。正方形内に 512 MB 分のアドレスを表示し、これにより正方形がよりよく埋まるようになりました（以前のバージョンでは、アドレスは正方形の半分しか埋めていませんでした）。関数名ではなくライブラリ名に近いアドレスを色分けするようにしました。領域の外側にも少し多めにスクロールできるようにしました。[#76192](https://github.com/ClickHouse/ClickHouse/pull/76192)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* このPRにより、`ALTER USER user1 ADD PROFILES a, DROP ALL PROFILES` というクエリは実行できなくなりました。すべての `DROP` 操作は順序上、先に指定されていなければならないためです。 [#76242](https://github.com/ClickHouse/ClickHouse/pull/76242) ([pufit](https://github.com/pufit)).
* SYNC REPLICA 向けの各種改善（エラーメッセージの明確化、テストの強化、サニティチェックの追加）。[#76307](https://github.com/ClickHouse/ClickHouse/pull/76307)（[Azat Khuzhin](https://github.com/azat)）。
* TOO&#95;MANY&#95;SIMULTANEOUS&#95;QUERIES が発生した場合に ON CLUSTER クエリを再試行するようにしました。 [#76352](https://github.com/ClickHouse/ClickHouse/pull/76352) ([Patrick Galbraith](https://github.com/CaptTofu)).
* `output_format_pretty_max_rows` のデフォルト値を 10000 から 1000 に変更しました。利便性の観点からより適切だと考えています。 [#76407](https://github.com/ClickHouse/ClickHouse/pull/76407) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* 読み取り専用の MergeTree テーブルでのリフレッシュをサポートしました。 [#76467](https://github.com/ClickHouse/ClickHouse/pull/76467) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* `Access Denied` によりバックアップ中の S3 へのマルチパートコピーが失敗した場合に、正しいフォールバック処理を行うようにしました。バケット間で異なる認証情報を用いてバックアップを行うと、マルチパートコピーで `Access Denied` エラーが発生することがあります。 [#76515](https://github.com/ClickHouse/ClickHouse/pull/76515) ([Antonio Andelic](https://github.com/antonio2368))。
* ClickHouse サーバーのシャットダウンを高速化（2.5 秒の遅延を解消）。 [#76550](https://github.com/ClickHouse/ClickHouse/pull/76550) ([Azat Khuzhin](https://github.com/azat)).
* system.errors に query&#95;id を追加。関連するチケット [#75815](https://github.com/ClickHouse/ClickHouse/issues/75815)。[#76581](https://github.com/ClickHouse/ClickHouse/pull/76581)（[Vladimir Baikov](https://github.com/bkvvldmr)）。
* librdkafka をバージョン 2.8.0 にアップグレードし、Kafka テーブルのシャットダウン処理を改善することで、テーブル削除およびサーバー再起動時の遅延を削減しました。`engine=Kafka` は、テーブルが削除された際にコンシューマグループから明示的に離脱しなくなりました。その代わり、コンシューマは非アクティブ状態が `session_timeout_ms`（デフォルト: 45 秒）続いた後に自動的に削除されるまでグループに残り続けます。[#76621](https://github.com/ClickHouse/ClickHouse/pull/76621)（[filimonov](https://github.com/filimonov)）。
* S3 リクエスト設定の検証処理を修正しました。 [#76658](https://github.com/ClickHouse/ClickHouse/pull/76658) ([Vitaly Baranov](https://github.com/vitlibar)).
* readbufferfroms3 およびその他のリモート読み取りバッファでの余分なメモリアロケーションを回避し、メモリ消費を半減しました。 [#76692](https://github.com/ClickHouse/ClickHouse/pull/76692) ([Sema Checherinda](https://github.com/CheSema)).
* ビューからの JSON 型およびサブカラムの読み取りをサポート。 [#76903](https://github.com/ClickHouse/ClickHouse/pull/76903) ([Pavel Kruglov](https://github.com/Avogar)).
* UInt128 から IPv6 への変換サポートを追加しました。これにより、IPv6 に対する `bitAnd` 演算や算術演算、および IPv6 への再変換が可能になります。[#76752](https://github.com/ClickHouse/ClickHouse/issues/76752) をクローズします。また、IPv6 に対する `bitAnd` 演算結果も IPv6 に再変換できるようになりました。参照: [https://github.com/ClickHouse/ClickHouse/pull/57707](https://github.com/ClickHouse/ClickHouse/pull/57707)。[#76928](https://github.com/ClickHouse/ClickHouse/pull/76928)（[Muzammil Abdul Rehman](https://github.com/muzammilar)）。
* `server_settings` や `settings` といったシステムテーブルには、`default` 値のカラムがあり便利です。`merge_tree_settings` と `replicated_merge_tree_settings` だけは、そのカラムが有効になっていません。[#76942](https://github.com/ClickHouse/ClickHouse/pull/76942) ([Diego Nieto](https://github.com/lesandie))。
* デフォルトでは、Variant 型内のテキスト形式において特殊な Bool 値はパースされません。設定 `allow_special_bool_values_inside_variant` を有効にすることでパースを許可できます。 [#76974](https://github.com/ClickHouse/ClickHouse/pull/76974) ([Pavel Kruglov](https://github.com/Avogar)).
* 低優先度クエリに対するタスク単位の待機時間を、セッションレベルおよびサーバーレベルで設定できるようにしました。 [#77013](https://github.com/ClickHouse/ClickHouse/pull/77013) ([VicoWu](https://github.com/VicoWu)).
* `CurrentMetrics::QueryPreempted` と同じロジックを持つ `ProfileEvents::QueryPreempted` を追加しました。 [#77015](https://github.com/ClickHouse/ClickHouse/pull/77015) ([VicoWu](https://github.com/VicoWu))。
* 以前のバージョンでは、Database Replicated がクエリで指定された認証情報をログに記録してしまうことがありました。この動作は修正されています。これにより次の Issue がクローズされました: [#77123](https://github.com/ClickHouse/ClickHouse/issues/77123)。 [#77133](https://github.com/ClickHouse/ClickHouse/pull/77133)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* zstd を 1.5.5 から 1.5.7 に更新しました。これは[大きな性能向上](https://github.com/facebook/zstd/releases/tag/v1.5.7)を含みます。 [#77137](https://github.com/ClickHouse/ClickHouse/pull/77137) ([Pradeep Chhetri](https://github.com/chhetripradeep))。
* plain&#95;rewritable ディスクで ALTER TABLE DROP PARTITION が可能に。[#77138](https://github.com/ClickHouse/ClickHouse/pull/77138)（[Julia Kartseva](https://github.com/jkartseva)）。
* ゼロコピー レプリケーションの場合に、マージ／ミューテーション実行前にパーツサイズとは無関係に最大500msまでランダムにスリープできる機能を追加しました。[#77165](https://github.com/ClickHouse/ClickHouse/pull/77165) ([Alexey Katsman](https://github.com/alexkats)).
* `TRUNCATE` が `INTO OUTFILE` と併用される場合にアトミックなリネームをサポートしました。 [#70323](https://github.com/ClickHouse/ClickHouse/issues/70323) を解決。 [#77181](https://github.com/ClickHouse/ClickHouse/pull/77181)（[Onkar Deshpande](https://github.com/onkar)）。
* PostgreSQL&#39;s CHARACTER、CHAR、BPCHAR 型には FixedString を使用します。 [#77304](https://github.com/ClickHouse/ClickHouse/pull/77304) ([Pablo Marcos](https://github.com/pamarcos)).
* storage/table 関数の設定項目 `iceberg_metadata_file_path` により、Iceberg が読み取るメタデータファイルを明示的に指定できるようにしました。 [#47412](https://github.com/ClickHouse/ClickHouse/issues/47412) を修正。 [#77318](https://github.com/ClickHouse/ClickHouse/pull/77318) ([alesapin](https://github.com/alesapin))。
* メタデータファイルを保存するために、データベースでリモートディスクを利用できるようにしました。 [#77365](https://github.com/ClickHouse/ClickHouse/pull/77365) ([Tuan Pham Anh](https://github.com/tuanpach))。
* JSON データ型の値の比較機能を実装しました。これにより、JSON オブジェクトを Map と同様に比較できるようになりました。[#77397](https://github.com/ClickHouse/ClickHouse/pull/77397) ([Pavel Kruglov](https://github.com/Avogar))。
* 変更を取り消しました。 [#77399](https://github.com/ClickHouse/ClickHouse/pull/77399) ([Yarik Briukhovetskyi](https://github.com/yariks5s))。
* バックアップ/リストア設定 `allow_s3_native_copy` は、現在 3 つの値をサポートします: - `False` - s3 ネイティブコピーは使用されません。- `True` (従来のデフォルト) - ClickHouse はまず s3 ネイティブコピーを試み、失敗した場合は読み取り＋書き込み方式にフォールバックします。- `'auto'` (新しいデフォルト) - ClickHouse はまずソースとデスティネーションの認証情報を比較します。同一であれば、ClickHouse は s3 ネイティブコピーを試み、その後読み取り＋書き込み方式にフォールバックする場合があります。異なる場合、ClickHouse は直接読み取り＋書き込み方式に進みます。 [#77401](https://github.com/ClickHouse/ClickHouse/pull/77401) ([Vitaly Baranov](https://github.com/vitlibar))。
* plain&#95;rewritable ディスクで `ALTER TABLE ... ATTACH|DETACH|MOVE|REPLACE PARTITION` が利用可能になりました。 [#77406](https://github.com/ClickHouse/ClickHouse/pull/77406) ([Julia Kartseva](https://github.com/jkartseva)).
* インデックスキャッシュのスキップを元に戻しました。 [#77447](https://github.com/ClickHouse/ClickHouse/pull/77447) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov)).
* Wide パーツ内の JSON 列をプリフェッチする際のメモリ使用量を削減。 [#77640](https://github.com/ClickHouse/ClickHouse/pull/77640) ([Pavel Kruglov](https://github.com/Avogar)).
* DeltaLake テーブルエンジン向けの delta kernel で、AWS セッショントークンおよび環境変数によるクレデンシャルの利用をサポートしました。 [#77661](https://github.com/ClickHouse/ClickHouse/pull/77661) ([Kseniia Sumarokova](https://github.com/kssenii)).
* `additional_table_filters` 設定内でクエリパラメータをサポートしました。この変更により、次のクエリは成功するようになります。 [#77680](https://github.com/ClickHouse/ClickHouse/pull/77680) ([wxybear](https://github.com/wxybear)).
* ユーザー定義関数 (UDF) は、その XML 定義内の新しいタグを使用して決定的 (deterministic) であるとマークできるようになりました。また、クエリキャッシュは、クエリ内で呼び出される UDF が決定的かどうかを確認し、決定的である場合にはクエリの結果をキャッシュします（Issue [#59988](https://github.com/ClickHouse/ClickHouse/issues/59988)）。[#77769](https://github.com/ClickHouse/ClickHouse/pull/77769)（[Jimmy Aguilar Mena](https://github.com/Ergus)）。
* Buffer テーブルエンジンのパラメータ検証機能を追加しました。 [#77840](https://github.com/ClickHouse/ClickHouse/pull/77840) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* HDFS の pread を有効または無効にするための設定 `enable_hdfs_pread` を追加しました。 [#77885](https://github.com/ClickHouse/ClickHouse/pull/77885) ([kevinyhzou](https://github.com/KevinyhZou))。
* ZooKeeper の &#39;multi&#39; 読み取りおよび書き込みリクエスト数を計測するプロファイルイベントを追加しました。 [#77888](https://github.com/ClickHouse/ClickHouse/pull/77888) ([JackyWoo](https://github.com/JackyWoo)).
* disable&#95;insertion&#95;and&#95;mutation が有効な場合でも、一時テーブルの作成および挿入を許可します。 [#77901](https://github.com/ClickHouse/ClickHouse/pull/77901) ([Xu Jia](https://github.com/XuJia0210))。
* max&#95;insert&#95;delayed&#95;streams&#95;for&#95;parallel&#95;write の設定値を 100 に減らしました。 [#77919](https://github.com/ClickHouse/ClickHouse/pull/77919) ([Azat Khuzhin](https://github.com/azat)).
* `max_merge_delayed_streams_for_parallel_write` を使用して、マージ処理が並列でフラッシュできる列数を設定できるようにしました（これにより、S3 への垂直マージ時のメモリ使用量がおよそ 25 分の 1 になります）。 [#77922](https://github.com/ClickHouse/ClickHouse/pull/77922) ([Azat Khuzhin](https://github.com/azat)).
* &#39;yyy&#39; のような Joda 構文における年の解析を修正しました。 [#77973](https://github.com/ClickHouse/ClickHouse/pull/77973) ([李扬](https://github.com/taiyang-li))。
* MergeTree テーブルのパーツのアタッチ処理はブロックの順序どおりに実行されるようになりました。これは ReplacingMergeTree などの特殊なマージアルゴリズムにとって重要です。これにより [#71009](https://github.com/ClickHouse/ClickHouse/issues/71009) が解決されました。[#77976](https://github.com/ClickHouse/ClickHouse/pull/77976)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* クエリマスキングルールは、一致が発生した場合に `LOGICAL_ERROR` をスローできるようになりました。これにより、あらかじめ定義したパスワードがログのどこかに漏洩していないかを確認しやすくなります。 [#78094](https://github.com/ClickHouse/ClickHouse/pull/78094) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov)).
* MySQL との互換性を高めるため、`information_schema.tables` に `index_length_column` 列を追加しました。 [#78119](https://github.com/ClickHouse/ClickHouse/pull/78119) ([Paweł Zakrzewski](https://github.com/KrzaQ)).
* 2 つの新しいメトリック `TotalMergeFailures` と `NonAbortedMergeFailures` を導入しました。これらのメトリックは、短時間に多数のマージ失敗が発生する状況を検出するためのものです。 [#78150](https://github.com/ClickHouse/ClickHouse/pull/78150) ([Miсhael Stetsyuk](https://github.com/mstetsyuk))。
* S3 のパススタイル利用時に key が指定されていない場合の URI の誤った解析を修正。 [#78185](https://github.com/ClickHouse/ClickHouse/pull/78185) ([Arthur Passos](https://github.com/arthurpassos)).
* `BlockActiveTime`、`BlockDiscardTime`、`BlockWriteTime`、`BlockQueueTime`、`BlockReadTime` の非同期メトリクスで誤った値が報告される問題を修正しました（この変更前は、1 秒が誤って 0.001 と報告されていました）。 [#78211](https://github.com/ClickHouse/ClickHouse/pull/78211) ([filimonov](https://github.com/filimonov))。
* StorageS3(Azure)Queue のマテリアライズドビューへのプッシュ中に発生するエラーに対して、`loading_retries` の上限を適用するようにしました。これ以前は、そのようなエラーは無制限に再試行されていました。 [#78313](https://github.com/ClickHouse/ClickHouse/pull/78313) ([Kseniia Sumarokova](https://github.com/kssenii)).
* delta-kernel-rs 実装を用いる StorageDeltaLake において、パフォーマンスとプログレスバーを修正しました。 [#78368](https://github.com/ClickHouse/ClickHouse/pull/78368) ([Kseniia Sumarokova](https://github.com/kssenii)).
* ベクトル類似性インデックスが、最大で 2 倍メインメモリを過剰に確保してしまう可能性がありました。この修正ではメモリ割り当て戦略を見直し、メモリ消費を削減するとともに、ベクトル類似性インデックスキャッシュの有効性を向上させています (issue [#78056](https://github.com/ClickHouse/ClickHouse/issues/78056))。[#78394](https://github.com/ClickHouse/ClickHouse/pull/78394) ([Shankar Iyer](https://github.com/shankar-iyer)).
* `schema_type` 設定を導入し、`system.metric_log` テーブルにスキーマ種別を指定できるようにします。利用可能なスキーマは 3 種類あります。`wide` — 現在のスキーマで、各メトリクス/イベントが別々のカラムに格納されます（個々のカラムの読み取りに最も効果的）。`transposed` — `system.asynchronous_metric_log` と類似しており、メトリクス/イベントが行として格納されます。そして最も興味深い `transposed_with_wide_view` — 実テーブルを `transposed` スキーマで作成しつつ、クエリを実テーブルに変換する `wide` スキーマのビューも導入します。`transposed_with_wide_view` では、ビューに対するサブ秒解像度はサポートされておらず、`event_time_microseconds` は後方互換性のためのエイリアスにすぎません。 [#78412](https://github.com/ClickHouse/ClickHouse/pull/78412) ([alesapin](https://github.com/alesapin)).
* ランタイムディスクで `include`、`from_env`、`from_zk` をサポートしました。[#78177](https://github.com/ClickHouse/ClickHouse/issues/78177) をクローズ。[#78470](https://github.com/ClickHouse/ClickHouse/pull/78470)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* iceberg テーブル関数およびエンジンで、ルート metadata.json ファイルを解決するためのいくつかの便利な方法を追加。 [#78455](https://github.com/ClickHouse/ClickHouse/issues/78455) をクローズ。 [#78475](https://github.com/ClickHouse/ClickHouse/pull/78475)（[Daniil Ivanik](https://github.com/divanik)）。
* Delta Lake のパーティションプルーニングをサポートしました。 [#78486](https://github.com/ClickHouse/ClickHouse/pull/78486) ([Kseniia Sumarokova](https://github.com/kssenii)).
* ClickHouse の SSH プロトコルでパスワードベースの認証をサポートしました。[#78586](https://github.com/ClickHouse/ClickHouse/pull/78586)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* 長時間実行中のミューテーション向けに、`system.warnings` テーブルに動的な警告を追加しました。 [#78658](https://github.com/ClickHouse/ClickHouse/pull/78658) ([Bharat Nallan](https://github.com/bharatnc))。
* CPU が著しく過負荷になっている場合に接続を切断します。この判断は、待ち時間 (`OSCPUWaitMicroseconds`) とビジー時間 (`OSCPUVirtualTimeMicroseconds`) の比率に基づいて行われます。この比率が `min_os_cpu_wait_time_ratio_to_drop_connection` と `max_os_cpu_wait_time_ratio_to_drop_connection` の間にある場合、クエリは一定の確率でドロップされます。 [#78778](https://github.com/ClickHouse/ClickHouse/pull/78778) ([Alexey Katsman](https://github.com/alexkats)).
* Hive パーティションで空値を許可。[#78816](https://github.com/ClickHouse/ClickHouse/pull/78816)（[Arthur Passos](https://github.com/arthurpassos)）。
* `BFloat16` の `IN` 句における型変換を修正しました（つまり、`SELECT toBFloat16(1) IN [1, 2, 3];` は現在 `1` を返します）。[#78754](https://github.com/ClickHouse/ClickHouse/issues/78754) をクローズ。[#78839](https://github.com/ClickHouse/ClickHouse/pull/78839)（[Raufs Dunamalijevs](https://github.com/rienath)）。
* `disk=` が設定されている場合は、MergeTree のパーツについて他のディスク上にあるものをチェックしないようにしました。 [#78855](https://github.com/ClickHouse/ClickHouse/pull/78855) ([Azat Khuzhin](https://github.com/azat)).
* `system.query_log` の `used_data_type_families` に含まれるデータ型を正準形に統一しました。 [#78972](https://github.com/ClickHouse/ClickHouse/pull/78972) ([Kseniia Sumarokova](https://github.com/kssenii)).





## バグ修正（公式安定版リリースにおけるユーザーに見える不具合） {#bug-fix}


* keeper-client で SEQUENTIAL ノードを作成できなかった問題を修正。 [#64177](https://github.com/ClickHouse/ClickHouse/pull/64177) ([Duc Canh Le](https://github.com/canhld94)).
* 親スコープにおける識別子の解決を修正しました。`WITH` 句内で式に対してエイリアスを使用できるようにしました。[#58994](https://github.com/ClickHouse/ClickHouse/issues/58994) を修正しました。[#62946](https://github.com/ClickHouse/ClickHouse/issues/62946) を修正しました。[#63239](https://github.com/ClickHouse/ClickHouse/issues/63239) を修正しました。[#65233](https://github.com/ClickHouse/ClickHouse/issues/65233) を修正しました。[#71659](https://github.com/ClickHouse/ClickHouse/issues/71659) を修正しました。[#71828](https://github.com/ClickHouse/ClickHouse/issues/71828) を修正しました。[#68749](https://github.com/ClickHouse/ClickHouse/issues/68749) を修正しました。[#66143](https://github.com/ClickHouse/ClickHouse/pull/66143)（[Dmitry Novik](https://github.com/novikd)）。
* PositionImpl::vectorVector における文字数カウントの誤りを修正。[#71003](https://github.com/ClickHouse/ClickHouse/pull/71003)（[思维](https://github.com/heymind)）。
* `negate` 関数の単調性を修正しました。以前のバージョンでは、主キーが `x` であるテーブルに対してクエリ `select * from a where -x = -42;` を実行すると、誤った結果が返される可能性がありました。 [#71440](https://github.com/ClickHouse/ClickHouse/pull/71440) ([Michael Kolupaev](https://github.com/al13n321))。
* `RESTORE` 操作が、部分的な権限の取り消しが正しく処理されていなかったために、アクセスエンティティに対して本来必要以上の権限を要求していました。この PR で問題を修正します。Closes [#71853](https://github.com/ClickHouse/ClickHouse/issues/71853). [#71958](https://github.com/ClickHouse/ClickHouse/pull/71958) ([pufit](https://github.com/pufit)).
* `ALTER TABLE REPLACE/MOVE PARTITION FROM/TO TABLE` 実行後に処理が一時停止しないようにしました。バックグラウンドタスクのスケジューリングに使用する設定が正しく取得されるようにしました。 [#72024](https://github.com/ClickHouse/ClickHouse/pull/72024) ([Aleksei Filatov](https://github.com/aalexfvk)).
* arrayIntersect における空タプルの扱いを修正。これにより [#72578](https://github.com/ClickHouse/ClickHouse/issues/72578) が解決されます。[#72581](https://github.com/ClickHouse/ClickHouse/pull/72581)（[Amos Bird](https://github.com/amosbird)）。
* 一部の入力および出力フォーマット（たとえば Parquet や Arrow）における空のタプルの処理を修正しました。 [#72616](https://github.com/ClickHouse/ClickHouse/pull/72616) ([Michael Kolupaev](https://github.com/al13n321)).
* ワイルドカードを含むデータベース／テーブルに対するカラムレベルの GRANT SELECT/INSERT ステートメントは、エラーを返すようになりました。 [#72646](https://github.com/ClickHouse/ClickHouse/pull/72646) ([Johann Gan](https://github.com/johanngan))。
* 対象のアクセスエンティティに暗黙的な権限付与が存在することが原因で、ユーザーが `REVOKE ALL ON *.*` を実行できない状況を修正しました。 [#72872](https://github.com/ClickHouse/ClickHouse/pull/72872) ([pufit](https://github.com/pufit)).
* 非同期分散 INSERT の保留バッチ処理中に、`No such file or directory` などが原因でハングしてしまう問題を修正しました。 [#72939](https://github.com/ClickHouse/ClickHouse/pull/72939) ([Azat Khuzhin](https://github.com/azat)).
* Azure SAS トークンのサポートを追加しました。 [#72959](https://github.com/ClickHouse/ClickHouse/pull/72959) ([Azat Khuzhin](https://github.com/azat)).
* formatDateTime スカラ関数における正のタイムゾーンの書式を修正しました。 [#73091](https://github.com/ClickHouse/ClickHouse/pull/73091) ([ollidraese](https://github.com/ollidraese))
* PROXYv1 経由で接続が確立され、`auth_use_forwarded_address` が有効な場合に、送信元ポートが正しく反映されるよう修正しました。以前はプロキシのポートが誤って使用されていました。`currentQueryID()` 関数を追加しました。[#73095](https://github.com/ClickHouse/ClickHouse/pull/73095)（[Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)）。
* TCPHandler 内の NativeWriter にもフォーマット設定を伝播し、`output_format_native_write_json_as_string` のような設定が正しく適用されるようにしました。 [#73179](https://github.com/ClickHouse/ClickHouse/pull/73179) ([Pavel Kruglov](https://github.com/Avogar)).
* 誤ったプレフィックスが付いた JSON サブオブジェクトのサブカラムを読み取る処理を修正しました。 [#73182](https://github.com/ClickHouse/ClickHouse/pull/73182) ([Pavel Kruglov](https://github.com/Avogar)).
* StorageObjectStorageQueue で発生するクラッシュを修正。 [#73274](https://github.com/ClickHouse/ClickHouse/pull/73274) ([Kseniia Sumarokova](https://github.com/kssenii)).
* サーバーのシャットダウン中に発生する、リフレッシュ可能なマテリアライズドビューのまれなクラッシュを修正しました。 [#73323](https://github.com/ClickHouse/ClickHouse/pull/73323) ([Michael Kolupaev](https://github.com/al13n321)).
* 関数 `formatDateTime` の `%f` プレースホルダは、常に 6 桁の（サブ秒）数値を生成するようになりました。これにより、MySQL の `DATE_FORMAT` 関数と動作の互換性が確保されます。以前の動作は、設定 `formatdatetime_f_prints_scale_number_of_digits = 1` を使用することで復元できます。[#73324](https://github.com/ClickHouse/ClickHouse/pull/73324) ([ollidraese](https://github.com/ollidraese))。
* 暗黙的な Date から DateTime への変換に対して飽和動作を強制することで、インデックス分析中の DateTime 変換を改善しました。これにより、DateTime の範囲制限に起因してインデックス分析が不正確になる可能性を解消します。この変更により [#73307](https://github.com/ClickHouse/ClickHouse/issues/73307) が修正されています。また、デフォルト値である `date_time_overflow_behavior = 'ignore'` の場合における明示的な `toDateTime` 変換も修正しました。[#73326](https://github.com/ClickHouse/ClickHouse/pull/73326) ([Amos Bird](https://github.com/amosbird))。
* `s3` ストレージおよびテーブル関数からの読み取り時における `_etag` 列によるフィルタリングを修正しました。 [#73353](https://github.com/ClickHouse/ClickHouse/pull/73353) ([Anton Popov](https://github.com/CurtizJ)).
* 旧アナライザーを使用している場合に、`JOIN ON` 式で `IN (subquery)` を使用すると発生する `Not-ready Set is passed as the second argument for function 'in'` エラーを修正。 [#73382](https://github.com/ClickHouse/ClickHouse/pull/73382) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* Dynamic 列および JSON 列に対する squash 処理の準備処理を修正しました。以前は、型やパスの上限に達していない場合でも、一部のケースで shared variant/shared data に新しい型を挿入できてしまうことがありました。 [#73388](https://github.com/ClickHouse/ClickHouse/pull/73388) ([Pavel Kruglov](https://github.com/Avogar)).
* 型のバイナリデコード時に不正なサイズを検査し、過大なメモリ確保を回避します。 [#73390](https://github.com/ClickHouse/ClickHouse/pull/73390) ([Pavel Kruglov](https://github.com/Avogar)).
* 並列レプリカを有効にした状態で単一レプリカのクラスタから読み取る際に発生していた論理エラーを修正しました。 [#73403](https://github.com/ClickHouse/ClickHouse/pull/73403) ([Michael Kolupaev](https://github.com/al13n321)).
* ZooKeeper および古い Keeper を使用する構成での ObjectStorageQueue の不具合を修正。 [#73420](https://github.com/ClickHouse/ClickHouse/pull/73420) ([Antonio Andelic](https://github.com/antonio2368))。
* Hive パーティショニングをデフォルトで有効にするために必要な修正を実装。 [#73479](https://github.com/ClickHouse/ClickHouse/pull/73479) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* ベクトル類似性インデックスの作成時に発生するデータレースを修正。 [#73517](https://github.com/ClickHouse/ClickHouse/pull/73517) ([Antonio Andelic](https://github.com/antonio2368)).
* 辞書のソースに誤ったデータを含む関数が存在する場合に発生していたセグメンテーションフォルトを修正しました。 [#73535](https://github.com/ClickHouse/ClickHouse/pull/73535) ([Yarik Briukhovetsky](https://github.com/yariks5s)).
* storage S3(Azure)Queue における挿入失敗時の再試行処理を修正。 [#70951](https://github.com/ClickHouse/ClickHouse/issues/70951) をクローズ。 [#73546](https://github.com/ClickHouse/ClickHouse/pull/73546) ([Kseniia Sumarokova](https://github.com/kssenii)).
* `LowCardinality` 要素を含むタプルに対して、設定 `optimize_functions_to_subcolumns` が有効な場合に一部のケースで発生する可能性のあった関数 `tupleElement` のエラーを修正しました。 [#73548](https://github.com/ClickHouse/ClickHouse/pull/73548) ([Anton Popov](https://github.com/CurtizJ)).
* enum のグロブの後に範囲が続く場合のパース処理を修正しました。[#73473](https://github.com/ClickHouse/ClickHouse/issues/73473) を修正します。[#73569](https://github.com/ClickHouse/ClickHouse/pull/73569)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* 非レプリケートテーブル向けのサブクエリ内で `parallel_replicas_for_non_replicated_merge_tree` が無視される問題を修正しました。 [#73584](https://github.com/ClickHouse/ClickHouse/pull/73584) ([Igor Nikonov](https://github.com/devcrafter)).
* タスクをスケジュールできない場合に `std::logical_error` がスローされる問題を修正。ストレステスト中に検出。スタックトレースの例: `2024.12.19 02:05:46.171833 [ 18190 ] {01f0daba-d3cc-4898-9e0e-c2c263306427} <Fatal> : Logical error: 'std::exception. Code: 1001, type: std::__1::future_error, e.what() = The associated promise has been destructed prior to the associated state becoming ready. (version 25.1.1.18724), Stack trace:.` [#73629](https://github.com/ClickHouse/ClickHouse/pull/73629) ([Alexander Gololobov](https://github.com/davenger))。
* 分散クエリで誤った処理ステージが使用されることによる論理エラーを避けるため、`EXPLAIN SYNTAX` でクエリを解釈しないようにしました。 [#65205](https://github.com/ClickHouse/ClickHouse/issues/65205) を修正。 [#73634](https://github.com/ClickHouse/ClickHouse/pull/73634)（[Dmitry Novik](https://github.com/novikd)）。
* Dynamic 列で発生し得るデータ不整合を修正しました。論理エラー `Nested columns sizes are inconsistent with local_discriminators column size` が発生する可能性を修正します。[#73644](https://github.com/ClickHouse/ClickHouse/pull/73644) ([Pavel Kruglov](https://github.com/Avogar))。
* `FINAL` および `SAMPLE` を含むクエリで発生していた `NOT_FOUND_COLUMN_IN_BLOCK` を修正しました。`CollapsingMergeTree` に対する `FINAL` 付きの SELECT 文で誤った結果が返される問題を修正し、`FINAL` に対する最適化を有効化しました。 [#73682](https://github.com/ClickHouse/ClickHouse/pull/73682) ([Anton Popov](https://github.com/CurtizJ)).
* LIMIT BY COLUMNS 使用時のクラッシュを修正。 [#73686](https://github.com/ClickHouse/ClickHouse/pull/73686) ([Raúl Marín](https://github.com/Algunenano))
* 通常のプロジェクションの使用が強制され、クエリが定義されたプロジェクションと完全に同一であるにもかかわらず、そのプロジェクションが選択されずにエラーが発生する不具合を修正しました。 [#73700](https://github.com/ClickHouse/ClickHouse/pull/73700) ([Shichao Jin](https://github.com/jsc0218)).
* Dynamic/Object 構造のデシリアライズを修正しました。これが原因で CANNOT&#95;READ&#95;ALL&#95;DATA 例外が発生する可能性がありました。 [#73767](https://github.com/ClickHouse/ClickHouse/pull/73767) ([Pavel Kruglov](https://github.com/Avogar)).
* バックアップからパーツを復元する際に `metadata_version.txt` をスキップするようにしました。 [#73768](https://github.com/ClickHouse/ClickHouse/pull/73768) ([Vitaly Baranov](https://github.com/vitlibar)).
* [#73737](https://github.com/ClickHouse/ClickHouse/issues/73737) を修正。[#73775](https://github.com/ClickHouse/ClickHouse/pull/73775)（[zhanglistar](https://github.com/zhanglistar)）。
* [#72078](https://github.com/ClickHouse/ClickHouse/issues/72078)（S3 Express サポートが動作しない問題）を修正。[#73777](https://github.com/ClickHouse/ClickHouse/pull/73777)（[Sameer Tamsekar](https://github.com/stamsekar)）。
* CollapsingMergeTree テーブルで、sign 列に無効な値を持つ行もマージできるようにしました。 [#73864](https://github.com/ClickHouse/ClickHouse/pull/73864) ([Christoph Wurm](https://github.com/cwurm)).
* 次のエラーを修正しました `Row 1: ────── hostname: c-test-wy-37-server-nlkyjyb-0.c-test-wy-37-server-headless.ns-test-wy-37.svc.cluster.local type: ExceptionWhileProcessing event_date: 2024-12-23 event_time: 2024-12-23 16:21:19 event_time_microseconds: 2024-12-23 16:21:19.824624 query_start_time: 2024-12-23 16:21:19 query_start_time_microseconds: 2024-12-23 16:21:19.747142 query_duration_ms: 77 read_rows: 1 read_bytes: 134 written_rows: 0 written_bytes: 0 result_rows: 0 result_bytes: 0 memory_usage: 7824 current_database: default query: CREATE DATABASE db0 formatted_query: normalized_query_hash: 7820917191074023511 -- 7.82 quintillion query_kind: Create databases: ['db0'] tables: [] columns: [] partitions: [] projections: [] views: [] exception_code: 170 exception: Code: 170. DB::Exception: Bad get: has Null, requested Int64: While executing DDLOnClusterQueryStatus. (BAD_GET) (version 25.1.1.19134 (official build)) stack_trace: 0. ./build_docker/./src/Common/Exception.cpp:107: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000da5e53b 1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x00000000088aca4c 2. DB::Exception::Exception<std::basic_string_view<char, std::char_traits<char>>, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, std::basic_string_view<char, std::char_traits<char>>&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x00000000088bae8b 3. auto& DB::Field::safeGet<long>() & @ 0x0000000008a3c748 4. ./src/Core/Field.h:484: DB::ColumnVector<long>::insert(DB::Field const&) @ 0x0000000012e44c0f 5. ./build_docker/./src/Interpreters/DDLOnClusterQueryStatusSource.cpp:53: DB::DDLOnClusterQueryStatusSource::generateChunkWithUnfinishedHosts() const @ 0x0000000012a40214 6. ./build_docker/./src/Interpreters/DDLOnClusterQueryStatusSource.cpp:104: DB::DDLOnClusterQueryStatusSource::handleTimeoutExceeded() @ 0x0000000012a41640 7. ./build_docker/./src/Interpreters/DDLOnClusterQueryStatusSource.cpp:109: DB::DDLOnClusterQueryStatusSource::stopWaitingOfflineHosts() @ 0x0000000012a41be9 8. ./build_docker/./src/Interpreters/DistributedQueryStatusSource.cpp:182: DB::DistributedQueryStatusSource::generate() @ 0x0000000011feb3bf 9. ./build_docker/./src/Processors/ISource.cpp:139: DB::ISource::tryGenerate() @ 0x0000000014148f5b 10. ./build_docker/./src/Processors/ISource.cpp:108: DB::ISource::work() @ 0x0000000014148c47 11. ./build_docker/./src/Processors/Executors/ExecutionThreadContext.cpp:49: DB::ExecutionThreadContext::executeTask() @ 0x0000000014164fc7 12. ./build_docker/./src/Processors/Executors/PipelineExecutor.cpp:290: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000141577e5`. [#73876](https://github.com/ClickHouse/ClickHouse/pull/73876) ([Tuan Pham Anh](https://github.com/tuanpach)).
* ネストされたタプルに対して明示的な名前（&#39;keys&#39;,&#39;values&#39;）を持たない `Map` を作成できていたために、`map()` 型の比較がときどき失敗する問題を修正しました。 [#73878](https://github.com/ClickHouse/ClickHouse/pull/73878) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* GROUP BY ALL 句の解決時にウィンドウ関数を無視するようにしました。[#73501](https://github.com/ClickHouse/ClickHouse/issues/73501) を修正。[#73916](https://github.com/ClickHouse/ClickHouse/pull/73916)（[Dmitry Novik](https://github.com/novikd)）。
* クライアントとサーバー間の通信で Native フォーマットの設定が正しく伝播されるようにしました。 [#73924](https://github.com/ClickHouse/ClickHouse/pull/73924) ([Pavel Kruglov](https://github.com/Avogar)).
* 暗黙的な権限を修正（以前はワイルドカードとして扱われていた）。 [#73932](https://github.com/ClickHouse/ClickHouse/pull/73932) ([Azat Khuzhin](https://github.com/azat)).
* ネストした `Map` を作成する際の過大なメモリ使用量を修正。 [#73982](https://github.com/ClickHouse/ClickHouse/pull/73982) ([Pavel Kruglov](https://github.com/Avogar)).
* 空キーを含む入れ子の JSON の解析を修正。 [#73993](https://github.com/ClickHouse/ClickHouse/pull/73993) ([Pavel Kruglov](https://github.com/Avogar)).
* 修正: あるエイリアスが別のエイリアスから参照されており、かつ逆順で選択されている場合に、そのエイリアスがプロジェクションに追加されないことがある問題を修正しました。 [#74033](https://github.com/ClickHouse/ClickHouse/pull/74033) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* plain&#95;rewritable メタデータを使用するディスクは、複数のサーバーインスタンス間で共有して使用できます。あるインスタンスがメタデータオブジェクトを読み込んでいる間に、別のインスタンスがそれを変更することが想定されています。S3 に対して実装されている動作と同様に、Azure ストレージで plain&#95;rewritable を初期化する際には、オブジェクトが見つからないエラーは無視されます。 [#74059](https://github.com/ClickHouse/ClickHouse/pull/74059) ([Julia Kartseva](https://github.com/jkartseva)).
* Enum 型および空テーブルに対する `any` および `anyLast` の動作を修正しました。 [#74061](https://github.com/ClickHouse/ClickHouse/pull/74061) ([Joanna Hulboj](https://github.com/jh0x)).
* kafka テーブルエンジンでユーザーがキーワード引数を指定した場合に発生する不具合を修正しました。 [#74064](https://github.com/ClickHouse/ClickHouse/pull/74064) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* Storage `S3Queue` の設定を、`s3queue_` プレフィックス付きからプレフィックスなし、またはその逆に変更する際の問題を修正しました。 [#74075](https://github.com/ClickHouse/ClickHouse/pull/74075) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 設定 `allow_push_predicate_ast_for_distributed_subqueries` を追加しました。これにより、analyzer を用いた分散クエリで AST ベースの述語プッシュダウンが行えるようになります。これは、クエリプランのシリアライズに対応した分散クエリがサポートされるまでの一時的なソリューションです。[#66878](https://github.com/ClickHouse/ClickHouse/issues/66878) [#69472](https://github.com/ClickHouse/ClickHouse/issues/69472) [#65638](https://github.com/ClickHouse/ClickHouse/issues/65638) [#68030](https://github.com/ClickHouse/ClickHouse/issues/68030) [#73718](https://github.com/ClickHouse/ClickHouse/issues/73718) をクローズします。 [#74085](https://github.com/ClickHouse/ClickHouse/pull/74085) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* [#73095](https://github.com/ClickHouse/ClickHouse/issues/73095) の影響で `forwarded_for` フィールドにポート番号が含まれる場合があり、その結果、ポート付きのホスト名を名前解決できなくなる問題を修正しました。 [#74116](https://github.com/ClickHouse/ClickHouse/pull/74116) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* `ALTER TABLE (DROP STATISTICS ...) (DROP STATISTICS ...)` の不正な書式設定を修正しました。 [#74126](https://github.com/ClickHouse/ClickHouse/pull/74126) ([Han Fei](https://github.com/hanfei1991)).
* 問題 [#66112](https://github.com/ClickHouse/ClickHouse/issues/66112) の修正。[#74128](https://github.com/ClickHouse/ClickHouse/pull/74128)（[Anton Ivashkin](https://github.com/ianton-ru)）。
* `CREATE TABLE` においてテーブルエンジンとして `Loop` を使用することはできなくなりました。この組み合わせは以前、セグメンテーションフォルトを引き起こしていました。[#74137](https://github.com/ClickHouse/ClickHouse/pull/74137)（[Yarik Briukhovetskyi](https://github.com/yariks5s)）。
* PostgreSQL および SQLite のテーブル関数における SQL インジェクションの脆弱性を修正。 [#74144](https://github.com/ClickHouse/ClickHouse/pull/74144) ([Pablo Marcos](https://github.com/pamarcos)).
* 圧縮された Memory エンジンのテーブルからサブカラムを読み取る際に発生するクラッシュを修正しました。 [#74009](https://github.com/ClickHouse/ClickHouse/issues/74009) の問題を解決します。 [#74161](https://github.com/ClickHouse/ClickHouse/pull/74161)（[Nikita Taranov](https://github.com/nickitat)）。
* system.detached&#95;tables へのクエリで発生していた無限ループを修正しました。 [#74190](https://github.com/ClickHouse/ClickHouse/pull/74190) ([Konstantin Morozov](https://github.com/k-morozov)).
* s3queue でファイルを失敗としてマークする際に発生していた論理エラーを修正しました。 [#74216](https://github.com/ClickHouse/ClickHouse/pull/74216) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 一部のストレージで未サポートの型を検出するチェックを追加しました。 [#74218](https://github.com/ClickHouse/ClickHouse/pull/74218) ([Pavel Kruglov](https://github.com/Avogar)).
* macOS 上の PostgreSQL インターフェース経由で実行した `INSERT INTO SELECT` クエリによって発生していたクラッシュを修正しました（issue [#72938](https://github.com/ClickHouse/ClickHouse/issues/72938)）。[#74231](https://github.com/ClickHouse/ClickHouse/pull/74231)（[Artem Yurov](https://github.com/ArtemYurov)）。
* ベースバックアップからの `RESTORE` 時のネイティブコピー設定（`allow_s3_native_copy` / `allow_azure_native_copy`）を修正しました。 [#74286](https://github.com/ClickHouse/ClickHouse/pull/74286) ([Azat Khuzhin](https://github.com/azat)).
* データベース内のデタッチされたテーブルの数が `max_block_size` の倍数になると発生していた問題を修正しました。[#74289](https://github.com/ClickHouse/ClickHouse/pull/74289) ([Konstantin Morozov](https://github.com/k-morozov))。
* ソースとデスティネーションで資格情報が異なる場合に、ObjectStorage（例: S3）経由のコピーが正しく行われない問題を修正しました。 [#74331](https://github.com/ClickHouse/ClickHouse/pull/74331) ([Azat Khuzhin](https://github.com/azat)).
* レプリケーテッドデータベースで初期化されていない `max_log_ptr` を修正。 [#74336](https://github.com/ClickHouse/ClickHouse/pull/74336) ([Konstantin Morozov](https://github.com/k-morozov)).
* GCS 上のネイティブコピーに対する「JSON API の Rewrite メソッドの使用」の検出を修正。 [#74338](https://github.com/ClickHouse/ClickHouse/pull/74338) ([Azat Khuzhin](https://github.com/azat)).
* INTERVAL 値を挿入する際に発生するクラッシュを修正（issue [#74299](https://github.com/ClickHouse/ClickHouse/issues/74299)）。[#74478](https://github.com/ClickHouse/ClickHouse/pull/74478)（[NamNguyenHoai](https://github.com/NamHoaiNguyen)）。
* `count(nullable)` が集約プロジェクションで使用されている場合に発生していた誤ったプロジェクション解析を修正しました。これにより [#74495](https://github.com/ClickHouse/ClickHouse/issues/74495) が解決されます。この PR では、プロジェクションがなぜ使用されるのか／されないのかを明確にするために、プロジェクション解析まわりのログ出力も追加しています。[#74498](https://github.com/ClickHouse/ClickHouse/pull/74498) ([Amos Bird](https://github.com/amosbird))。
* `BackgroundMergesAndMutationsPoolSize` の誤った計算を修正（実際の値の 2 倍として計算されていた）。 [#74509](https://github.com/ClickHouse/ClickHouse/pull/74509) ([alesapin](https://github.com/alesapin))。
* Cluster Discovery を有効にした際に keeper のウォッチがリークするバグを修正しました。 [#74521](https://github.com/ClickHouse/ClickHouse/pull/74521) ([RinChanNOW](https://github.com/RinChanNOWWW)).
* 定数 JSON リテラルの整形を修正しました。以前は、クエリを別のサーバーに送信する際に構文エラーを引き起こす可能性がありました。 [#74533](https://github.com/ClickHouse/ClickHouse/pull/74533) ([Pavel Kruglov](https://github.com/Avogar))。
* UBSan が報告したメモリアラインメント問題を修正しました [#74512](https://github.com/ClickHouse/ClickHouse/issues/74512)。 [#74534](https://github.com/ClickHouse/ClickHouse/pull/74534) ([Arthur Passos](https://github.com/arthurpassos))。
* テーブル作成中の KeeperMap の並行クリーンアップ処理を修正。 [#74568](https://github.com/ClickHouse/ClickHouse/pull/74568) ([Antonio Andelic](https://github.com/antonio2368)).
* 正しいクエリ結果を維持するため、`EXCEPT` または `INTERSECT` が存在する場合にはサブクエリ内の未使用の投影カラムを削除しないようにしました。 [#73930](https://github.com/ClickHouse/ClickHouse/issues/73930) を修正しました。 [#66465](https://github.com/ClickHouse/ClickHouse/issues/66465) を修正しました。 [#74577](https://github.com/ClickHouse/ClickHouse/pull/74577)（[Dmitry Novik](https://github.com/novikd)）。
* 暗黙的プロジェクションが有効な状態で定数パーティション式を使用すると不正になっていた CREATE クエリを修正しました。これにより [#74596](https://github.com/ClickHouse/ClickHouse/issues/74596) が解決されます。 [#74634](https://github.com/ClickHouse/ClickHouse/pull/74634) ([Amos Bird](https://github.com/amosbird)).
* `Tuple` 列を持ち、スパースシリアル化が有効になっているテーブル間での `INSERT SELECT` クエリの問題を修正しました。 [#74698](https://github.com/ClickHouse/ClickHouse/pull/74698) ([Anton Popov](https://github.com/CurtizJ)).
* 関数 `right` が const の負のオフセットに対して正しく動作していませんでした。 [#74701](https://github.com/ClickHouse/ClickHouse/pull/74701) ([Daniil Ivanik](https://github.com/divanik))。
* クライアント側の不完全な解凍処理により、gzip 圧縮データの挿入が失敗する場合がある問題を修正。 [#74707](https://github.com/ClickHouse/ClickHouse/pull/74707) ([siyuan](https://github.com/linkwk7)).
* `INSERT` が例外で終了した後に、接続が不正な状態のままにならないようにしました。 [#74740](https://github.com/ClickHouse/ClickHouse/pull/74740) ([Azat Khuzhin](https://github.com/azat))。
* 中間状態のまま残されていた接続は再利用しないようにしました。 [#74749](https://github.com/ClickHouse/ClickHouse/pull/74749) ([Azat Khuzhin](https://github.com/azat)).
* ワイルドカード付きの権限付与に対する部分的な権限取り消しにより、想定以上に多くの権限が削除される可能性がありました。[#74263](https://github.com/ClickHouse/ClickHouse/issues/74263) をクローズします。 [#74751](https://github.com/ClickHouse/ClickHouse/pull/74751) ([pufit](https://github.com/pufit))。
* 型名が大文字でない場合に JSON 型宣言の解析時に発生するクラッシュを修正。 [#74784](https://github.com/ClickHouse/ClickHouse/pull/74784) ([Pavel Kruglov](https://github.com/Avogar)).
* Keeper 修正: ディスクからのログエントリ読み取り処理を修正。 [#74785](https://github.com/ClickHouse/ClickHouse/pull/74785) ([Antonio Andelic](https://github.com/antonio2368)).
* SYSTEM REFRESH/START/STOP VIEW に対する権限チェックを修正しました。これにより、特定のビューに対してクエリを実行する際に `*.*` への権限を持つ必要がなくなり、そのビューに対する権限だけで十分になりました。 [#74789](https://github.com/ClickHouse/ClickHouse/pull/74789) ([Alexander Tokmakov](https://github.com/tavplubix)).
* `hasColumnInTable` 関数はエイリアス列を考慮していません。エイリアス列も扱えるように修正しました。 [#74841](https://github.com/ClickHouse/ClickHouse/pull/74841) ([Bharat Nallan](https://github.com/bharatnc))。
* Keeper: 接続が確立される前に切断された場合に発生する logical&#95;error を修正。 [#74844](https://github.com/ClickHouse/ClickHouse/pull/74844) ([Michael Kolupaev](https://github.com/al13n321)).
* `AzureBlobStorage` を使用するテーブルが存在するとサーバーが起動できない問題を修正しました。テーブルは Azure へのリクエストを送信することなく読み込まれるようになりました。 [#74880](https://github.com/ClickHouse/ClickHouse/pull/74880) ([Alexey Katsman](https://github.com/alexkats)).
* BACKUP および RESTORE 操作において、`query_log` 内の `used_privileges` および `missing_privileges` フィールドが欠落していた問題を修正しました。 [#74887](https://github.com/ClickHouse/ClickHouse/pull/74887) ([Alexey Katsman](https://github.com/alexkats)).
* Azure Blob Storage 上で空の列を含むテーブルのデータパーツのマージ中に発生する FILE&#95;DOESNT&#95;EXIST エラーを修正。 [#74892](https://github.com/ClickHouse/ClickHouse/pull/74892) ([Julia Kartseva](https://github.com/jkartseva)).
* 一時テーブルを `JOIN` する際のプロジェクション列名を修正し、[#68872](https://github.com/ClickHouse/ClickHouse/issues/68872) をクローズ。[#74897](https://github.com/ClickHouse/ClickHouse/pull/74897)（[Vladimir Cherkasov](https://github.com/vdimir)）。
* HDFS の SELECT リクエスト中に SASL エラーが発生した場合に Kerberos チケットを更新するようにしました。 [#74930](https://github.com/ClickHouse/ClickHouse/pull/74930) ([inv2004](https://github.com/inv2004)).
* startup&#95;scripts 内の Replicated データベースへのクエリを修正しました。 [#74942](https://github.com/ClickHouse/ClickHouse/pull/74942) ([Azat Khuzhin](https://github.com/azat))。
* `JOIN ON` 句で型エイリアスが付けられた式に対して NULL セーフ比較が使用されている場合の不具合を修正しました。 [#74970](https://github.com/ClickHouse/ClickHouse/pull/74970) ([Vladimir Cherkasov](https://github.com/vdimir)).
* remove 操作が失敗した場合、パーツの状態を `deleting` から `outdated` に戻すようにしました。 [#74985](https://github.com/ClickHouse/ClickHouse/pull/74985) ([Sema Checherinda](https://github.com/CheSema)).
* 以前のバージョンでは、スカラーサブクエリがある場合、データ形式の初期化中（HTTP ヘッダーが書き出される前）に、サブクエリ処理で蓄積された進捗情報の書き込みを開始していました。これにより、X-ClickHouse-QueryId や X-ClickHouse-Format、Content-Type などの HTTP ヘッダーが失われていました。 [#74991](https://github.com/ClickHouse/ClickHouse/pull/74991)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* `database_replicated_allow_replicated_engine_arguments=0` の場合の `CREATE TABLE AS...` クエリを修正。[#75000](https://github.com/ClickHouse/ClickHouse/pull/75000)（[Bharat Nallan](https://github.com/bharatnc)）。
* INSERT 例外発生後にクライアント側で接続が異常な状態のまま残ってしまう問題を修正。 [#75030](https://github.com/ClickHouse/ClickHouse/pull/75030) ([Azat Khuzhin](https://github.com/azat))。
* PSQL レプリケーションでキャッチされない例外により発生していたクラッシュを修正。 [#75062](https://github.com/ClickHouse/ClickHouse/pull/75062) ([Azat Khuzhin](https://github.com/azat)).
* SASL により任意の RPC 呼び出しが失敗する可能性があり、この修正により、krb5 チケットの有効期限が切れている場合に呼び出しを再試行できるようになりました。 [#75063](https://github.com/ClickHouse/ClickHouse/pull/75063) ([inv2004](https://github.com/inv2004))。
* `optimize_function_to_subcolumns` 設定が有効な場合の `Array`、`Map`、`Nullable(..)` 列に対するインデックス（プライマリおよびセカンダリ）の使用を修正しました。以前は、これらの列に対するインデックスが無視されることがありました。[#75081](https://github.com/ClickHouse/ClickHouse/pull/75081) ([Anton Popov](https://github.com/CurtizJ)).
* 内部テーブルを持つマテリアライズドビューを作成する際には、`flatten_nested` を無効にしてください。これは、その方法でフラット化されたカラムを使用できなくなるためです。 [#75085](https://github.com/ClickHouse/ClickHouse/pull/75085) ([Christoph Wurm](https://github.com/cwurm))。
* 一部の IPv6 アドレス（::ffff:1.1.1.1 など）が `forwarded_for` フィールドで誤って解釈され、その結果、例外発生とともにクライアントが切断されていた問題を修正。 [#75133](https://github.com/ClickHouse/ClickHouse/pull/75133) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* Nullable な LowCardinality データ型に対する null セーフ JOIN の処理を修正しました。これまで `IS NOT DISTINCT FROM`、`<=>`、`a IS NULL AND b IS NULL OR a == b` のような null セーフな比較を含む JOIN ON 句は、LowCardinality カラムに対して正しく動作していませんでした。 [#75143](https://github.com/ClickHouse/ClickHouse/pull/75143)（[Vladimir Cherkasov](https://github.com/vdimir)）。
* 新しい analyzer を使用して、未使用の補間を含むクエリを修正できるようにしました。 [#75173](https://github.com/ClickHouse/ClickHouse/pull/75173) ([János Benjamin Antal](https://github.com/antaljanosbenjamin)).
* CTE と INSERT の併用時に発生していたクラッシュバグを修正しました。 [#75188](https://github.com/ClickHouse/ClickHouse/pull/75188) ([Shichao Jin](https://github.com/jsc0218)).
* Keeper の修正: ログをロールバックする際に、壊れた changelog に書き込んでしまうことを防止しました。 [#75197](https://github.com/ClickHouse/ClickHouse/pull/75197) ([Antonio Andelic](https://github.com/antonio2368)).
* 適切な箇所では `BFloat16` を上位型として使用するようにしました。これにより次の issue がクローズされました: [#74404](https://github.com/ClickHouse/ClickHouse/issues/74404)。[#75236](https://github.com/ClickHouse/ClickHouse/pull/75236)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* any&#95;join&#95;distinct&#95;right&#95;table&#95;keys と JOIN の ON 句で OR を使用した場合の結合結果において、予期せぬデフォルト値が入る問題を修正。 [#75262](https://github.com/ClickHouse/ClickHouse/pull/75262) ([Vladimir Cherkasov](https://github.com/vdimir)).
* azureblobstorage テーブルエンジンの認証情報をマスクするようにしました。 [#75319](https://github.com/ClickHouse/ClickHouse/pull/75319) ([Garrett Thomas](https://github.com/garrettthomaskth)).
* ClickHouse が PostgreSQL、MySQL、SQLite などの外部データベースに対して誤ってフィルタープッシュダウンを行ってしまう可能性があった不具合を修正しました。これにより次の issue がクローズされました: [#71423](https://github.com/ClickHouse/ClickHouse/issues/71423)。[#75320](https://github.com/ClickHouse/ClickHouse/pull/75320)（[Nikita Mikhaylov](https://github.com/nikitamikhaylov)）。
* Protobuf 形式での出力中に、並列クエリ `SYSTEM DROP FORMAT SCHEMA CACHE` を実行した場合に発生しうる Protobuf スキーマキャッシュのクラッシュを修正しました。 [#75357](https://github.com/ClickHouse/ClickHouse/pull/75357) ([Pavel Kruglov](https://github.com/Avogar)).
* `HAVING` からのフィルタが並列レプリカにプッシュダウンされる場合に発生する可能性のある論理エラーまたは未初期化メモリの問題を修正しました。 [#75363](https://github.com/ClickHouse/ClickHouse/pull/75363) ([Vladimir Cherkasov](https://github.com/vdimir))。
* `icebergS3` および `icebergAzure` のテーブル関数とテーブルエンジンで、機密情報を非表示にしました。 [#75378](https://github.com/ClickHouse/ClickHouse/pull/75378) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 計算によって空文字列となるトリム文字を指定した `TRIM` 関数が正しく処理されるようになりました。例: `SELECT TRIM(LEADING concat('') FROM 'foo')`（Issue [#69922](https://github.com/ClickHouse/ClickHouse/issues/69922)）。[#75399](https://github.com/ClickHouse/ClickHouse/pull/75399)（[Manish Gill](https://github.com/mgill25)）。
* IOutputFormat のデータレースを修正。 [#75448](https://github.com/ClickHouse/ClickHouse/pull/75448) ([Pavel Kruglov](https://github.com/Avogar))。
* 分散テーブル上での JOIN で Array 型の JSON サブカラムを使用する際に発生する可能性のあるエラー `Elements ... and ... of Nested data structure ... (Array columns) have different array sizes` を修正しました。[#75512](https://github.com/ClickHouse/ClickHouse/pull/75512) ([Pavel Kruglov](https://github.com/Avogar)).
* 不正な結果バッファサイズの計算を修正しました。 [#70031](https://github.com/ClickHouse/ClickHouse/issues/70031) をクローズ。 [#75548](https://github.com/ClickHouse/ClickHouse/pull/75548)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* allow&#95;feature&#95;tier と compatibility mergetree 設定間の動作を修正しました。 [#75635](https://github.com/ClickHouse/ClickHouse/pull/75635) ([Raúl Marín](https://github.com/Algunenano)).
* 再試行されたファイルに対して `system.s3queue_log` に記録される `processed_rows` の値が誤っていた問題を修正。 [#75666](https://github.com/ClickHouse/ClickHouse/pull/75666) ([Kseniia Sumarokova](https://github.com/kssenii)).
* マテリアライズドビューが URL エンジンに書き込みを行う際に接続障害が発生した場合、`materialized_views_ignore_errors` の設定が反映されるようにしました。 [#75679](https://github.com/ClickHouse/ClickHouse/pull/75679) ([Christoph Wurm](https://github.com/cwurm)).
* 異なる型の列間で複数の非同期 `RENAME` クエリ（`alter_sync = 0`）を実行した後に、`MergeTree` テーブルから読み取る際にまれに発生していたクラッシュを修正しました。 [#75693](https://github.com/ClickHouse/ClickHouse/pull/75693) ([Anton Popov](https://github.com/CurtizJ)).
* 一部の `UNION ALL` を含むクエリで発生していた `Block structure mismatch in QueryPipeline stream` エラーを修正しました。 [#75715](https://github.com/ClickHouse/ClickHouse/pull/75715) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* PK 列を `ALTER MODIFY` で変更した際に、対応するプロジェクションを再構築するようにしました。以前は、プロジェクションの PK に使用されている列を `ALTER MODIFY` した後の `SELECT` クエリ実行時に、`CANNOT_READ_ALL_DATA` エラーが発生することがありました。 [#75720](https://github.com/ClickHouse/ClickHouse/pull/75720) ([Pavel Kruglov](https://github.com/Avogar)).
* スカラーサブクエリに対する `ARRAY JOIN` の誤った結果を修正（analyzer 使用時）。[#75732](https://github.com/ClickHouse/ClickHouse/pull/75732)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* `DistinctSortedStreamTransform` におけるヌルポインタ参照の問題を修正しました。 [#75734](https://github.com/ClickHouse/ClickHouse/pull/75734) ([Nikita Taranov](https://github.com/nickitat)).
* `allow_suspicious_ttl_expressions` の挙動を修正。 [#75771](https://github.com/ClickHouse/ClickHouse/pull/75771) ([Aleksei Filatov](https://github.com/aalexfvk)).
* `translate` 関数における未初期化メモリの読み取りを修正しました。これにより [#75592](https://github.com/ClickHouse/ClickHouse/issues/75592) が解消されます。[#75794](https://github.com/ClickHouse/ClickHouse/pull/75794)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* Native フォーマットで JSON を文字列表現として出力する際にも、フォーマット設定が適用されるようにしました。 [#75832](https://github.com/ClickHouse/ClickHouse/pull/75832) ([Pavel Kruglov](https://github.com/Avogar)).
* 設定変更履歴に、v24.12 で JOIN アルゴリズムとして parallel hash がデフォルトで有効化されたことを記録しました。これは、互換レベルとして v24.12 より前のバージョンが設定されている場合、ClickHouse は引き続き非並列のハッシュ結合を用いて JOIN を実行することを意味します。 [#75870](https://github.com/ClickHouse/ClickHouse/pull/75870) ([Robert Schulze](https://github.com/rschu1ze)).
* 暗黙的に追加された min-max インデックスを持つテーブルを新しいテーブルにコピーできなかったバグを修正しました（issue [#75677](https://github.com/ClickHouse/ClickHouse/issues/75677)）。[#75877](https://github.com/ClickHouse/ClickHouse/pull/75877)（[Smita Kulkarni](https://github.com/SmitaRKulkarni)）。
* `clickhouse-library-bridge` はファイルシステムから任意のライブラリを開くことができるため、安全に運用するには分離された環境内でのみ実行する必要があります。`clickhouse-server` と同じ環境で実行される場合に生じる脆弱性を防ぐため、ライブラリのパスを設定で指定された場所に制限します。この脆弱性は **Arseniy Dugin** によって [ClickHouse Bug Bounty Program](https://github.com/ClickHouse/ClickHouse/issues/38986) を通じて発見されました。[#75954](https://github.com/ClickHouse/ClickHouse/pull/75954)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* 一部のメタデータのシリアライズに JSON を使用していたのですが、これは誤りでした。JSON は、ゼロバイトを含むバイナリデータを文字列リテラル内でサポートしていないためです。SQL クエリにはバイナリデータや不正な UTF-8 が含まれる可能性があるため、メタデータファイル側でもそれをサポートする必要があります。一方で、ClickHouse の `JSONEachRow` や同様のフォーマットは、バイナリデータの完全なラウンドトリップを優先して JSON 標準から意図的に逸脱することで、この問題を回避しています。その背景については、こちらを参照してください: [https://github.com/ClickHouse/ClickHouse/pull/73668#issuecomment-2560501790](https://github.com/ClickHouse/ClickHouse/pull/73668#issuecomment-2560501790)。解決策は、`Poco::JSON` ライブラリを ClickHouse における JSON 形式のシリアライゼーションと整合させることです。これにより [#73668](https://github.com/ClickHouse/ClickHouse/issues/73668) がクローズされました。[#75963](https://github.com/ClickHouse/ClickHouse/pull/75963)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* DETACH PART 中に発生する `Part <...> does not contain in snapshot of previous virtual parts. (PART_IS_TEMPORARILY_LOCKED)` エラーを修正。 [#76039](https://github.com/ClickHouse/ClickHouse/pull/76039) ([Aleksei Filatov](https://github.com/aalexfvk)).
* ストレージ `S3Queue` におけるコミット上限チェックを修正。[#76104](https://github.com/ClickHouse/ClickHouse/pull/76104)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* 自動インデックス（`add_minmax_index_for_numeric_columns` / `add_minmax_index_for_string_columns`）を持つ MergeTree テーブルの ATTACH 動作を修正しました。 [#76139](https://github.com/ClickHouse/ClickHouse/pull/76139) ([Azat Khuzhin](https://github.com/azat)).
* ジョブの親スレッドからのスタックトレース（`enable_job_stack_trace` 設定）が出力されない問題を修正しました。`enable_job_stack_trace` 設定がスレッドに正しく伝播されず、その結果スタックトレースの内容が常にこの設定を反映しない問題を修正しました。 [#76191](https://github.com/ClickHouse/ClickHouse/pull/76191) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* ビッグエンディアンアーキテクチャにおける FixedString を対象とした reinterpretAs を修正。 [#76253](https://github.com/ClickHouse/ClickHouse/pull/76253) ([Azat Khuzhin](https://github.com/azat)).
* UUID とテーブル名の間のレースコンディションに起因するあらゆる種類のバグを修正しました（たとえば、`RENAME` と `RESTART REPLICA` の間のレースを修正します。`SYSTEM RESTART REPLICA` を伴う `RENAME` が並行して実行されると、誤ったレプリカを再起動してしまったり、テーブルの一つが `Table X is being restarted` 状態のまま残ってしまう可能性がありました）。[#76308](https://github.com/ClickHouse/ClickHouse/pull/76308)（[Azat Khuzhin](https://github.com/azat)）。
* シグナルハンドラ内でのメモリ割り当て処理を削除しました。 [#76446](https://github.com/ClickHouse/ClickHouse/pull/76446) ([Nikita Taranov](https://github.com/nickitat)).
* 動的ファイルシステムキャッシュのリサイズ時に、削除処理中に予期しないエラーが発生した場合のハンドリングを修正。 [#76466](https://github.com/ClickHouse/ClickHouse/pull/76466) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 並列ハッシュにおける `used_flag` の初期化を修正しました。これによりサーバーがクラッシュする可能性がありました。[#76580](https://github.com/ClickHouse/ClickHouse/pull/76580)（[Nikita Taranov](https://github.com/nickitat)）。
* `defaultProfiles()` 関数をプロジェクション内で呼び出した際に発生する論理エラーを修正。 [#76627](https://github.com/ClickHouse/ClickHouse/pull/76627) ([pufit](https://github.com/pufit))
* Web UI でブラウザーにインタラクティブなベーシック認証を要求しないようにしました。 [#76319](https://github.com/ClickHouse/ClickHouse/issues/76319) をクローズしました。 [#76637](https://github.com/ClickHouse/ClickHouse/pull/76637) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* 分散テーブルに対するクエリでブールリテラルを選択した際に発生していた THERE&#95;IS&#95;NO&#95;COLUMN 例外を修正しました。 [#76656](https://github.com/ClickHouse/ClickHouse/pull/76656) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* テーブルディレクトリ内のサブパスは、より高度な方法で選択されるようになりました。 [#76681](https://github.com/ClickHouse/ClickHouse/pull/76681) ([Daniil Ivanik](https://github.com/divanik))。
* サブカラムを含む主キーを持つテーブルを変更した後に発生する `Not found column in block` エラーを修正しました。[https://github.com/ClickHouse/ClickHouse/pull/72644](https://github.com/ClickHouse/ClickHouse/pull/72644) の以降、この修正には [https://github.com/ClickHouse/ClickHouse/pull/74403](https://github.com/ClickHouse/ClickHouse/pull/74403) が必要です。[#76686](https://github.com/ClickHouse/ClickHouse/pull/76686)（[Nikolai Kochetov](https://github.com/KochetovNicolai)）。
* NULL ショートサーキット向けのパフォーマンステストを追加し、バグを修正。 [#76708](https://github.com/ClickHouse/ClickHouse/pull/76708) ([李扬](https://github.com/taiyang-li)).
* 出力の書き込みバッファを finalize 処理の前にフラッシュするようにしました。一部の出力フォーマット（例：`JSONEachRowWithProgressRowOutputFormat`）の finalize 処理中に発生していた `LOGICAL_ERROR` を修正しました。 [#76726](https://github.com/ClickHouse/ClickHouse/pull/76726) ([Antonio Andelic](https://github.com/antonio2368)).
* MongoDB バイナリ UUID のサポートを追加しました（[#74452](https://github.com/ClickHouse/ClickHouse/issues/74452)）。- テーブル関数使用時の MongoDB への WHERE 句プッシュダウンを修正しました（[#72210](https://github.com/ClickHouse/ClickHouse/issues/72210)）。- MongoDB のバイナリ UUID が ClickHouse の UUID にのみパースされるように、MongoDB - ClickHouse 型マッピングを変更しました。これにより、将来的な曖昧さや予期せぬ挙動を回避できるはずです。- 従来との互換性を維持しつつ、OID マッピングを修正しました。[#76762](https://github.com/ClickHouse/ClickHouse/pull/76762)（[Kirill Nikiforov](https://github.com/allmazz)）。
* JSON サブカラムの並列プレフィックスデシリアライズ時の例外処理を修正。 [#76809](https://github.com/ClickHouse/ClickHouse/pull/76809) ([Pavel Kruglov](https://github.com/Avogar)).
* 負の整数に対する lgamma 関数の動作を修正しました。 [#76840](https://github.com/ClickHouse/ClickHouse/pull/76840) ([Ilya Kataev](https://github.com/IlyaKataev)).
* 明示的に定義されたプライマリキーに対するリバースキー解析を修正。[#76654](https://github.com/ClickHouse/ClickHouse/issues/76654) と同様。[#76846](https://github.com/ClickHouse/ClickHouse/pull/76846)（[Amos Bird](https://github.com/amosbird)）。
* JSON 形式における Bool 値の整形表示を修正。 [#76905](https://github.com/ClickHouse/ClickHouse/pull/76905) ([Pavel Kruglov](https://github.com/Avogar)).
* 非同期インサート中のエラー時に、不正な JSON カラムのロールバックが原因でクラッシュが発生する可能性があった問題を修正しました。 [#76908](https://github.com/ClickHouse/ClickHouse/pull/76908) ([Pavel Kruglov](https://github.com/Avogar)).
* 以前は、`multi_if` がプランニング段階と本実行時で異なる型のカラムを返す可能性がありました。これにより、C++ の観点では未定義動作を引き起こすコードが生成されていました。[#76914](https://github.com/ClickHouse/ClickHouse/pull/76914)（[Nikita Taranov](https://github.com/nickitat)）。
* MergeTree における定数 Nullable キーの誤ったシリアライゼーションを修正しました。これにより [#76939](https://github.com/ClickHouse/ClickHouse/issues/76939) が解決されます。[#76985](https://github.com/ClickHouse/ClickHouse/pull/76985)（[Amos Bird](https://github.com/amosbird)）。
* `BFloat16` 値のソート処理を修正しました。これにより [#75487](https://github.com/ClickHouse/ClickHouse/issues/75487) がクローズされます。これにより [#75669](https://github.com/ClickHouse/ClickHouse/issues/75669) がクローズされます。[#77000](https://github.com/ClickHouse/ClickHouse/pull/77000)（[Alexey Milovidov](https://github.com/alexey-milovidov)）。
* パート整合性チェックで一時的なサブカラムをスキップするための検査を追加し、`JSON` の `Variant` サブカラムに関するバグを修正しました。 [#72187](https://github.com/ClickHouse/ClickHouse/issues/72187)。 [#77034](https://github.com/ClickHouse/ClickHouse/pull/77034) ([Smita Kulkarni](https://github.com/SmitaRKulkarni))。
* 型の不一致が発生した場合に Values 形式でのテンプレートのパース時にクラッシュする不具合を修正。 [#77071](https://github.com/ClickHouse/ClickHouse/pull/77071) ([Pavel Kruglov](https://github.com/Avogar)).
* 主キーにサブカラムを含む EmbeddedRocksDB テーブルは作成できないようにしました。以前はそのようなテーブルを作成すること自体は可能でしたが、`SELECT` クエリが失敗していました。 [#77074](https://github.com/ClickHouse/ClickHouse/pull/77074) ([Pavel Kruglov](https://github.com/Avogar))。
* 分散クエリにおいて、述語をリモートにプッシュダウンする際にリテラルの型が正しく考慮されないことにより発生していた不正な比較を修正しました。 [#77093](https://github.com/ClickHouse/ClickHouse/pull/77093) ([Duc Canh Le](https://github.com/canhld94)).
* Kafka テーブル作成時に例外が発生するとクラッシュする問題を修正しました。 [#77121](https://github.com/ClickHouse/ClickHouse/pull/77121) ([Pavel Kruglov](https://github.com/Avogar)).
* Kafka および RabbitMQ エンジンで新しい JSON とサブカラムをサポートしました。 [#77122](https://github.com/ClickHouse/ClickHouse/pull/77122) ([Pavel Kruglov](https://github.com/Avogar)).
* MacOS における例外スタックアンワインド処理を修正。 [#77126](https://github.com/ClickHouse/ClickHouse/pull/77126) ([Eduard Karacharov](https://github.com/korowa)).
* getSubcolumn 関数における &#39;null&#39; サブカラムの読み取り処理を修正。 [#77163](https://github.com/ClickHouse/ClickHouse/pull/77163) ([Pavel Kruglov](https://github.com/Avogar)).
* アナライザーでリテラルを含む式を使用した skip インデックスが動作していなかった問題を修正し、インデックス解析時に自明なキャストを削除しました。 [#77229](https://github.com/ClickHouse/ClickHouse/pull/77229) ([Pavel Kruglov](https://github.com/Avogar)).
* Array 型やサポートされていない関数を使用した際の Bloom filter インデックスの問題を修正しました。 [#77271](https://github.com/ClickHouse/ClickHouse/pull/77271) ([Pavel Kruglov](https://github.com/Avogar)).
* テーブル数に関する制限チェックは、初回の `CREATE` クエリ実行時にのみ行うようにしました。 [#77274](https://github.com/ClickHouse/ClickHouse/pull/77274) ([Nikolay Degterinsky](https://github.com/evillique)).
* `SELECT toBFloat16(-0.0) == toBFloat16(0.0)` は、以前は `false` を返していましたが、現在は正しく `true` を返すようになりました。これにより、`Float32` および `Float64` における動作と整合的になります。 [#77290](https://github.com/ClickHouse/ClickHouse/pull/77290) ([Shankar Iyer](https://github.com/shankar-iyer)).
* 初期化されていない key&#95;index 変数への誤った参照が行われる可能性のある問題を修正しました。これはデバッグビルドではクラッシュを引き起こす可能性がありますが、その後のコードがエラーをスローする可能性が高いため、リリースビルドでは問題になりません。 ### ユーザー向け変更点のドキュメント項目。 [#77305](https://github.com/ClickHouse/ClickHouse/pull/77305) ([wxybear](https://github.com/wxybear)).
* リバートしました。 [#77307](https://github.com/ClickHouse/ClickHouse/pull/77307) ([Nikolai Kochetov](https://github.com/KochetovNicolai)).
* Bool 型の値を含むパーティションの名前付けを修正しました。これは [https://github.com/ClickHouse/ClickHouse/pull/74533](https://github.com/ClickHouse/ClickHouse/pull/74533) によって壊れていました。[#77319](https://github.com/ClickHouse/ClickHouse/pull/77319)（[Pavel Kruglov](https://github.com/Avogar)）。
* Nullable 要素を含むタプルと文字列との比較を修正しました。たとえば、この変更以前は、タプル `(1, null)` と文字列 `'(1,null)'` の比較はエラーになっていました。別の例としては、タプル `(1, a)`（ここで `a` は Nullable 列）と文字列 `'(1, 2)'` との比較があります。この変更により、これらの問題が解消されました。 [#77323](https://github.com/ClickHouse/ClickHouse/pull/77323) ([Alexey Katsman](https://github.com/alexkats)).
* ObjectStorageQueueSource のクラッシュを修正。これは [https://github.com/ClickHouse/ClickHouse/pull/76358](https://github.com/ClickHouse/ClickHouse/pull/76358) で導入された不具合。 [#77325](https://github.com/ClickHouse/ClickHouse/pull/77325) （[Pavel Kruglov](https://github.com/Avogar)）。
* `close_session` クエリパラメータがまったく効かず、名前付きセッションが `session_timeout` 経過後にのみ終了していたバグを修正しました。 [#77336](https://github.com/ClickHouse/ClickHouse/pull/77336) ([Alexey Katsman](https://github.com/alexkats))。
* `input()` 使用時の `async_insert` の問題を修正。 [#77340](https://github.com/ClickHouse/ClickHouse/pull/77340) ([Azat Khuzhin](https://github.com/azat)).
* 修正: プランナーがソート列を削除した場合に、`WITH FILL` が `NOT_FOUND_COLUMN_IN_BLOCK` で失敗することがある問題を修正しました。`INTERPOLATE` 式に対して計算される DAG が一貫しないことによる類似の問題も修正しました。 [#77343](https://github.com/ClickHouse/ClickHouse/pull/77343) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* 元に戻しました。 [#77390](https://github.com/ClickHouse/ClickHouse/pull/77390) ([Vladimir Cherkasov](https://github.com/vdimir)).
* 付随する MV のない状態で NATS サーバーからメッセージを受信してしまう問題を修正しました。 [#77392](https://github.com/ClickHouse/ClickHouse/pull/77392) ([Dmitry Novikov](https://github.com/dmitry-sles-novikov)).
* 空の `FileLog` から `merge` テーブル関数経由で読み込む際の論理エラーを修正し、[#75575](https://github.com/ClickHouse/ClickHouse/issues/75575) をクローズ。[#77441](https://github.com/ClickHouse/ClickHouse/pull/77441)（[Vladimir Cherkasov](https://github.com/vdimir)）。
* 無効な AST ノードに対してエイリアスを設定する際に発生していた複数の `LOGICAL_ERROR` を修正。[#77445](https://github.com/ClickHouse/ClickHouse/pull/77445)（[Raúl Marín](https://github.com/Algunenano)）。
* ファイルシステムキャッシュの実装において、ファイルセグメント書き込み時のエラー処理を修正しました。 [#77471](https://github.com/ClickHouse/ClickHouse/pull/77471) ([Kseniia Sumarokova](https://github.com/kssenii)).
* DatabaseIceberg がカタログで提供される正しいメタデータファイルを使用するよう修正。 [#75187](https://github.com/ClickHouse/ClickHouse/issues/75187) をクローズ。 [#77486](https://github.com/ClickHouse/ClickHouse/pull/77486)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* 共有バリアントからの Dynamic serialization でデフォルトのフォーマット設定を使用するように変更しました。 [#77572](https://github.com/ClickHouse/ClickHouse/pull/77572) ([Pavel Kruglov](https://github.com/Avogar))。
* 「スカラーサブクエリの実行で `toAST()` を回避する」変更をリバート。 [#77584](https://github.com/ClickHouse/ClickHouse/pull/77584) ([Raúl Marín](https://github.com/Algunenano)).
* ローカルディスク上のテーブルデータパスの存在チェック処理を修正しました。 [#77608](https://github.com/ClickHouse/ClickHouse/pull/77608) ([Tuan Pham Anh](https://github.com/tuanpach))。
* クエリキャッシュは、UDF を非決定的であるとみなすようになりました。これに伴い、UDF を含むクエリの結果はキャッシュされなくなりました。以前は、ユーザーが非決定的な UDF を定義できており、その結果が誤ってキャッシュされていました（issue [#77553](https://github.com/ClickHouse/ClickHouse/issues/77553)）。[#77633](https://github.com/ClickHouse/ClickHouse/pull/77633)（[Jimmy Aguilar Mena](https://github.com/Ergus)）。
* 一部の型において、定数値をリモートに送信する際の処理を修正。 [#77634](https://github.com/ClickHouse/ClickHouse/pull/77634) ([Pavel Kruglov](https://github.com/Avogar))。
* `enable_filesystem_cache_log` 設定が有効な場合にのみ動作していた system.filesystem&#95;cache&#95;log の問題を修正しました。 [#77650](https://github.com/ClickHouse/ClickHouse/pull/77650) ([Kseniia Sumarokova](https://github.com/kssenii)).
* `defaultRoles()` 関数をプロジェクション内で呼び出した際に発生する論理エラーを修正。[#76627](https://github.com/ClickHouse/ClickHouse/issues/76627) へのフォローアップ。[#77667](https://github.com/ClickHouse/ClickHouse/pull/77667)（[pufit](https://github.com/pufit)）。
* StorageS3(Azure)Queue において、有効期限切れのコンテキストが原因となっていたクラッシュを修正しました。 [#77720](https://github.com/ClickHouse/ClickHouse/pull/77720) ([Kseniia Sumarokova](https://github.com/kssenii)).
* 関数 `arrayResize` の第 2 引数として `Nullable` 型を使用することはできなくなりました。以前は、第 2 引数に `Nullable` を指定すると、エラー発生から誤った結果の出力まで、さまざまな問題が起こる可能性がありました（issue [#48398](https://github.com/ClickHouse/ClickHouse/issues/48398)）。[#77724](https://github.com/ClickHouse/ClickHouse/pull/77724)（[Manish Gill](https://github.com/mgill25)）。
* RabbitMQ、Nats、Redis、AzureQueue テーブルエンジンで認証情報を非表示にするようにしました。 [#77755](https://github.com/ClickHouse/ClickHouse/pull/77755) ([Kseniia Sumarokova](https://github.com/kssenii)).
* ArgMin/ArgMax における NaN 比較時の未定義の挙動を修正。 [#77756](https://github.com/ClickHouse/ClickHouse/pull/77756) ([Raúl Marín](https://github.com/Algunenano))。
* 書き込むブロックが生成されない場合でも、マージとミューテーションがキャンセルされていないかを定期的に確認するようにしました。 [#77766](https://github.com/ClickHouse/ClickHouse/pull/77766) ([János Benjamin Antal](https://github.com/antaljanosbenjamin)).
* リバートしました。 [#77843](https://github.com/ClickHouse/ClickHouse/pull/77843) ([Vladimir Cherkasov](https://github.com/vdimir)).
* `NOT_FOUND_COLUMN_IN_BLOCK` エラー発生時にクラッシュが起こり得る問題を修正。 [#77854](https://github.com/ClickHouse/ClickHouse/pull/77854) ([Vladimir Cherkasov](https://github.com/vdimir)).
* `StorageSystemObjectStorageQueueSettings` でデータを埋める際に発生していたクラッシュを修正。 [#77878](https://github.com/ClickHouse/ClickHouse/pull/77878) ([Bharat Nallan](https://github.com/bharatnc))。
* SSH サーバーでの履歴に対するあいまい検索を無効化（skim を必要とするため）。 [#78002](https://github.com/ClickHouse/ClickHouse/pull/78002) ([Azat Khuzhin](https://github.com/azat)).
* 同じテーブル内の別のベクトル列にベクトル類似性インデックスが定義されている場合に、インデックスが作成されていない列に対するベクトル検索クエリが誤った結果を返していたバグを修正しました（Issue [#77978](https://github.com/ClickHouse/ClickHouse/issues/77978)）。[#78069](https://github.com/ClickHouse/ClickHouse/pull/78069)（[Shankar Iyer](https://github.com/shankar-iyer)）。
* `The requested output format {} is binary... Do you want to output it anyway? [y/N]` プロンプトを修正しました。 [#78095](https://github.com/ClickHouse/ClickHouse/pull/78095) ([Azat Khuzhin](https://github.com/azat)).
* `toStartOfInterval` の origin 引数が 0 の場合に発生していたバグを修正しました。[#78096](https://github.com/ClickHouse/ClickHouse/pull/78096) ([Yarik Briukhovetskyi](https://github.com/yariks5s)).
* HTTP インターフェースで空の `session_id` クエリパラメータを指定できないようにしました。 [#78098](https://github.com/ClickHouse/ClickHouse/pull/78098) ([Alexey Katsman](https://github.com/alexkats))。
* `ALTER` クエリの直後に実行された `RENAME` クエリが原因で `Database Replicated` でメタデータが上書きされてしまう可能性があった問題を修正。[#78107](https://github.com/ClickHouse/ClickHouse/pull/78107)（[Nikolay Degterinsky](https://github.com/evillique)）。
* NATS エンジンのクラッシュを修正。 [#78108](https://github.com/ClickHouse/ClickHouse/pull/78108) ([Dmitry Novikov](https://github.com/dmitry-sles-novikov)).
* SSH 用の埋め込みクライアントにおいて `history_file` を作成しようとしないようにしました。 [#78112](https://github.com/ClickHouse/ClickHouse/pull/78112) ([Azat Khuzhin](https://github.com/azat)).
* RENAME DATABASE または DROP TABLE クエリの後に `system.detached_tables` が誤った情報を表示する不具合を修正しました。 [#78126](https://github.com/ClickHouse/ClickHouse/pull/78126) ([Nikolay Degterinsky](https://github.com/evillique)).
* [https://github.com/ClickHouse/ClickHouse/pull/77274](https://github.com/ClickHouse/ClickHouse/pull/77274) 以降に導入された、DatabaseReplicated でテーブルが多すぎる場合のチェック処理を修正しました。また、RMT や KeeperMap の場合に ZooKeeper に未カウントのノードが作成されるのを防ぐため、ストレージを作成する前にこのチェックを実行するようにしました。[#78127](https://github.com/ClickHouse/ClickHouse/pull/78127)（[Nikolay Degterinsky](https://github.com/evillique)）。
* 並行して行われる S3Queue メタデータ初期化に起因する可能性のあるクラッシュを修正。 [#78131](https://github.com/ClickHouse/ClickHouse/pull/78131) ([Azat Khuzhin](https://github.com/azat)).
* `groupArray*` 関数は、これまではそのまま実行を試みていた `max_size` 引数の Int 型 0 値に対しても、UInt 型と同様に BAD&#95;ARGUMENTS エラーを発生させるようになりました。 [#78140](https://github.com/ClickHouse/ClickHouse/pull/78140) ([Eduard Karacharov](https://github.com/korowa))。
* `recoverLostReplica` において、ローカルテーブルがデタッチされる前に削除された場合にクラッシュする問題を防止しました。 [#78173](https://github.com/ClickHouse/ClickHouse/pull/78173) ([Raúl Marín](https://github.com/Algunenano))。
* `system.s3_queue_settings` テーブルの `alterable` 列の値が常に `false` になっていた問題を修正。[#78187](https://github.com/ClickHouse/ClickHouse/pull/78187)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* ユーザーやログから見えないように Azure access signature をマスクしました。 [#78189](https://github.com/ClickHouse/ClickHouse/pull/78189) ([Kseniia Sumarokova](https://github.com/kssenii)).
* Wide パーツにおいて、プレフィックスを持つサブストリームのプリフェッチ処理を修正。 [#78205](https://github.com/ClickHouse/ClickHouse/pull/78205) ([Pavel Kruglov](https://github.com/Avogar))。
* `LowCardinality(Nullable)` 型のキー配列に対する `mapFromArrays` のクラッシュおよび誤った結果が発生する問題を修正しました。 [#78240](https://github.com/ClickHouse/ClickHouse/pull/78240) ([Eduard Karacharov](https://github.com/korowa)).
* delta-kernel の認証オプションを修正。[#78255](https://github.com/ClickHouse/ClickHouse/pull/78255)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* レプリカの `disable_insertion_and_mutation` が true の場合、RefreshMV タスクをスケジュールしないようにしました。タスクは挿入処理を行うものであり、`disable_insertion_and_mutation` が true の場合は失敗してしまうためです。 [#78277](https://github.com/ClickHouse/ClickHouse/pull/78277) ([Xu Jia](https://github.com/XuJia0210))。
* Merge エンジンで基になるテーブルへのアクセスを検証するようにしました。 [#78339](https://github.com/ClickHouse/ClickHouse/pull/78339) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* `Distributed` エンジンのテーブルで `FINAL` 修飾子が失われることがありました。[#78428](https://github.com/ClickHouse/ClickHouse/pull/78428) ([Yakov Olkhovskiy](https://github.com/yakov-olkhovskiy)).
* `Bitmapmin` は、ビットマップが `empty(uint64_max when input type >= 8bits)` の場合、uint32&#95;max を返します。これは、空の `roaring_bitmap` の `minimum()` の動作と一致します。 [#78444](https://github.com/ClickHouse/ClickHouse/pull/78444) ([wxybear](https://github.com/wxybear)).
* クラッシュを引き起こす可能性があるため、コード内の一部に `preserve_most` 属性を適用した変更を差し戻しました。 [#78449](https://github.com/ClickHouse/ClickHouse/pull/78449) ([Azat Khuzhin](https://github.com/azat)).
* INFILE のスキーマ推論で挿入列を使用。 [#78490](https://github.com/ClickHouse/ClickHouse/pull/78490) ([Pervakov Grigorii](https://github.com/GrigoryPervakov)).
* `distributed_aggregation_memory_efficient` が有効な場合、`FROM` 句を読み取った直後のクエリ処理の並列化を無効化しました。論理エラーを引き起こす可能性があるためです。[#76934](https://github.com/ClickHouse/ClickHouse/issues/76934) をクローズ。[#78500](https://github.com/ClickHouse/ClickHouse/pull/78500)（[flynn](https://github.com/ucasfl)）。
* `max_streams_to_max_threads_ratio` 設定を適用した結果、予定されるストリーム数が 0 になってしまう場合に備え、少なくとも 1 つの読み取りストリームが確保されるようにしました。 [#78505](https://github.com/ClickHouse/ClickHouse/pull/78505) ([Eduard Karacharov](https://github.com/korowa)).
* storage S3Queue における論理エラー「Cannot unregister: table uuid is not registered」を修正しました。[#78285](https://github.com/ClickHouse/ClickHouse/issues/78285) をクローズしました。[#78541](https://github.com/ClickHouse/ClickHouse/pull/78541)（[Kseniia Sumarokova](https://github.com/kssenii)）。
* ClickHouse は、cgroup v1 と v2 の両方が有効になっているシステムで、自身の cgroup v2 を特定できるようになりました。 [#78566](https://github.com/ClickHouse/ClickHouse/pull/78566) ([Grigory Korolev](https://github.com/gkorolev)).
* ObjectStorage クラスターテーブル関数がテーブルレベルの設定と併用した場合に失敗する問題がありました。 [#78587](https://github.com/ClickHouse/ClickHouse/pull/78587) ([Daniil Ivanik](https://github.com/divanik))。
* より厳密なトランザクションチェックは、ReplicatedMergeTree の `INSERT` ではサポートされません。[#78633](https://github.com/ClickHouse/ClickHouse/pull/78633)（[Azat Khuzhin](https://github.com/azat)）。
* アタッチ時にクエリ設定を適用します。 [#78637](https://github.com/ClickHouse/ClickHouse/pull/78637) ([Raúl Marín](https://github.com/Algunenano)).
* `iceberg_metadata_file_path` に無効なパスが指定された場合にクラッシュする不具合を修正しました。 [#78688](https://github.com/ClickHouse/ClickHouse/pull/78688) ([alesapin](https://github.com/alesapin)).
* DeltaLake テーブルエンジンの delta-kernel 実装において、読み取りスキーマがテーブルスキーマと異なり、かつパーティション列が存在する場合に「列が見つからない」エラーが発生していた問題を修正しました。 [#78690](https://github.com/ClickHouse/ClickHouse/pull/78690) ([Kseniia Sumarokova](https://github.com/kssenii)).
* この更新では、同じ名前を持つセッションで、新しい名前付きセッションが古いセッションのタイムアウトが切れる前に作成された場合に、新しいセッションが誤って古いセッションの予定終了時刻に終了してしまう不具合を修正しています。 [#78698](https://github.com/ClickHouse/ClickHouse/pull/78698) ([Alexey Katsman](https://github.com/alexkats)).
* CHECK TABLE の実行中にテーブルのシャットダウン処理がブロックされないようにしました。 [#78782](https://github.com/ClickHouse/ClickHouse/pull/78782) ([Raúl Marín](https://github.com/Algunenano)).
* Keeper の修正: すべてのケースで ephemeral カウントが正しく計上されるように修正。 [#78799](https://github.com/ClickHouse/ClickHouse/pull/78799) ([Antonio Andelic](https://github.com/antonio2368)).
* `view()` 以外のテーブル関数使用時に `StorageDistributed` で発生していた誤ったキャストを修正。 [#78464](https://github.com/ClickHouse/ClickHouse/issues/78464) をクローズ。 [#78828](https://github.com/ClickHouse/ClickHouse/pull/78828) ([Konstantin Bogdanov](https://github.com/thevar1able))。
* `tupleElement(*, 1)` の書式を修正しました。 [#78639](https://github.com/ClickHouse/ClickHouse/issues/78639) をクローズしました。 [#78832](https://github.com/ClickHouse/ClickHouse/pull/78832)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* `ssd_cache` 型の辞書では、`block_size` および `write_buffer_size` パラメータに 0 または負の値が指定された場合に拒否されるようになりました（issue [#78314](https://github.com/ClickHouse/ClickHouse/issues/78314)）。[#78854](https://github.com/ClickHouse/ClickHouse/pull/78854)（[Elmi Ahmadov](https://github.com/ahmadov)）。
* 異常終了後に `ALTER` が実行された場合に発生する REFRESHABLE MV のクラッシュを修正。[#78858](https://github.com/ClickHouse/ClickHouse/pull/78858)（[Azat Khuzhin](https://github.com/azat)）。
* CSV 形式での不正な DateTime 値の解析を修正しました。 [#78919](https://github.com/ClickHouse/ClickHouse/pull/78919) ([Pavel Kruglov](https://github.com/Avogar)).





## ビルド/テスト/パッケージングの改善 {#build-testing-packaging-improvement}


* 内部で依存している LLVM のバージョンが 16 から 18 に更新されました。 [#66053](https://github.com/ClickHouse/ClickHouse/pull/66053) ([Nikita Mikhaylov](https://github.com/nikitamikhaylov))。
* 削除されていた nats のインテグレーションテストを復元し、エラーを修正しました。- nats エンジンにおけるいくつかの競合状態を修正しました - 接続喪失時に nats へデータをストリーミングする際に発生していたデータ損失を修正しました - nats からのストリーミング終了時に最後のデータチャンクの受信がフリーズする問題を修正しました - `nats_max_reconnect` は非推奨となり、もはや効果を持ちません。再接続は `nats_reconnect_wait` タイムアウトを用いて継続的に実行されます。 [#69772](https://github.com/ClickHouse/ClickHouse/pull/69772) ([Dmitry Novikov](https://github.com/dmitry-sles-novikov)).
* contrib の OpenSSL の asm ファイルが生成されない問題を修正。 [#72622](https://github.com/ClickHouse/ClickHouse/pull/72622) ([RinChanNOW](https://github.com/RinChanNOWWW)).
* テスト 03210&#95;variant&#95;with&#95;aggregate&#95;function&#95;type の安定性を改善。[#74012](https://github.com/ClickHouse/ClickHouse/pull/74012)（[Anton Ivashkin](https://github.com/ianton-ru)）。
* ARM および Intel Mac の両方での HDFS ビルドをサポート。 [#74244](https://github.com/ClickHouse/ClickHouse/pull/74244) ([Yan Xin](https://github.com/yxheartipp)).
* 汎用インストールスクリプトは、macOS 上でもインストールを提案するようになりました。 [#74339](https://github.com/ClickHouse/ClickHouse/pull/74339) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* Kerberos が無効な場合のビルドを修正。 [#74771](https://github.com/ClickHouse/ClickHouse/pull/74771) ([flynn](https://github.com/ucasfl)).
* 組み込みLLVMを19に更新。 [#75148](https://github.com/ClickHouse/ClickHouse/pull/75148) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* *潜在的な非互換変更*: さらに厳格なデフォルト設定への改善です。現在のデフォルト設定はすでに安全です。ユーザーはポートを公開するためにオプションを明示的に指定する必要があります。ただし、`CLICKHOUSE_PASSWORD` 環境変数でパスワードが設定されておらず、かつ/または `CLICKHOUSE_USER` 環境変数でユーザー名が変更されていない `default` ユーザーについては、追加の保護レベルとしてローカルシステム上からのみアクセス可能であるべきです。[#75259](https://github.com/ClickHouse/ClickHouse/pull/75259)（[Mikhail f. Shiryaev](https://github.com/Felixoid)）。
* Integration tests の並列テスト 1 バッチあたりのタイムアウトは 1 時間です。このタイムアウトに達すると、`pytest` は一部のログが出力されないまま強制終了されます。セッションから結果を出力し、外部のタイムアウトシグナルが発生しないようにするため、内部の pytest タイムアウトは 55 分に設定されています。[#75532](https://github.com/ClickHouse/ClickHouse/issues/75532) をクローズしました。[#75533](https://github.com/ClickHouse/ClickHouse/pull/75533)（[Ilya Yatsishin](https://github.com/qoega)）。
* すべての clickhouse-server 関連の処理を 1 つの関数としてまとめ、`entrypoint.sh` でデフォルトのバイナリを起動する際にのみ実行するようにしました。長らく先送りされていた改善が [#50724](https://github.com/ClickHouse/ClickHouse/issues/50724) にて提案されました。`users.xml` から設定値を取得するために、`clickhouse-extract-from-config` にオプション `--users` を追加しました。[#75643](https://github.com/ClickHouse/ClickHouse/pull/75643)（[Mikhail f. Shiryaev](https://github.com/Felixoid)）。
* ストレステストにおいて、gdb を用いてスタックトレースを収集している間にサーバーが終了しなかった場合、`Possible deadlock on shutdown (see gdb.log)` の検出によるノイズを減らすために追加の待機時間を設けました。これはテストが正常に完了しなかった場合にのみ遅延が発生します。 [#75668](https://github.com/ClickHouse/ClickHouse/pull/75668) ([Ilya Yatsishin](https://github.com/qoega))。
* 削除されていた nats の統合テストを復元し、エラーを修正しました。- nats エンジンにおけるいくつかの競合状態を修正 - 接続喪失時に nats へデータをストリーミングする際のデータ損失を修正 - nats からのストリーミング終了時に最後のデータチャンクの受信がフリーズする問題を修正 - `nats_max_reconnect` は非推奨となり、もはや効果はありません。再接続は `nats_reconnect_wait` のタイムアウト値を用いて継続的に実行されます。 [#75850](https://github.com/ClickHouse/ClickHouse/pull/75850) ([Dmitry Novikov](https://github.com/dmitry-sles-novikov))。
* Darwin 向けにクロスコンパイルする際に ICU と GRPC を有効にしました。[#75922](https://github.com/ClickHouse/ClickHouse/pull/75922) ([Raúl Marín](https://github.com/Algunenano)).
* プロセスグループ終了中の `sleep` によって発生していた splitting テストの出力が乱れる問題を修正しました。 [#76090](https://github.com/ClickHouse/ClickHouse/pull/76090) ([Mikhail f. Shiryaev](https://github.com/Felixoid)).
* スクリプトが途中で強制終了されることが多いため、実行の最後に `docker-compose` のログを収集しないでください。代わりに、バックグラウンドでログを収集してください。 [#76140](https://github.com/ClickHouse/ClickHouse/pull/76140) ([Mikhail f. Shiryaev](https://github.com/Felixoid)).
* Kafka ストレージ用のテストを複数のファイルに分割しました。[#69452](https://github.com/ClickHouse/ClickHouse/issues/69452) を修正しました。[#76208](https://github.com/ClickHouse/ClickHouse/pull/76208)（[Mikhail f. Shiryaev](https://github.com/Felixoid)）。
* `clickhouse-odbc-bridge` と `clickhouse-library-bridge` は、別リポジトリ [https://github.com/ClickHouse/odbc-bridge/](https://github.com/ClickHouse/odbc-bridge/) に移動されました。 [#76225](https://github.com/ClickHouse/ClickHouse/pull/76225) ([Alexey Milovidov](https://github.com/alexey-milovidov))。
* バイナリから約 20MB のデッドコードを削除しました。 [#76226](https://github.com/ClickHouse/ClickHouse/pull/76226) ([Alexey Milovidov](https://github.com/alexey-milovidov)).
* `block()` の導入に伴い、最低必要な CMake バージョンを 3.25 に引き上げました。 [#76316](https://github.com/ClickHouse/ClickHouse/pull/76316) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* fmt を 11.1.3 に更新。 [#76547](https://github.com/ClickHouse/ClickHouse/pull/76547) ([Raúl Marín](https://github.com/Algunenano)).
* `lz4` を `1.10.0` に更新。[#76571](https://github.com/ClickHouse/ClickHouse/pull/76571)（[Konstantin Bogdanov](https://github.com/thevar1able)）。
* `curl` を `8.12.1` に更新。 [#76572](https://github.com/ClickHouse/ClickHouse/pull/76572) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* `libcpuid` をバージョン `0.7.1` に更新。[#76573](https://github.com/ClickHouse/ClickHouse/pull/76573) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* pytest の結果を解析するために機械可読な形式を使用するように変更。 [#76910](https://github.com/ClickHouse/ClickHouse/pull/76910) ([Mikhail f. Shiryaev](https://github.com/Felixoid)).
* Rust のクロスコンパイル対応を修正し、Rust を完全に無効化できるようにしました。 [#76921](https://github.com/ClickHouse/ClickHouse/pull/76921) ([Raúl Marín](https://github.com/Algunenano)).
* プロジェクトのビルドには clang 19 が必要です。 [#76945](https://github.com/ClickHouse/ClickHouse/pull/76945) ([Raúl Marín](https://github.com/Algunenano)).
* このテストはシリアルモードで 10 秒以上実行されます。高速テストとしては時間がかかりすぎます。[#76948](https://github.com/ClickHouse/ClickHouse/pull/76948)（[Mikhail f. Shiryaev](https://github.com/Felixoid)）。
* `sccache` を `0.10.0` に更新。 [#77580](https://github.com/ClickHouse/ClickHouse/pull/77580) ([Konstantin Bogdanov](https://github.com/thevar1able)).
* Rust において CPU のターゲット機能を考慮し、すべてのクレートで LTO を有効化しました。 [#78590](https://github.com/ClickHouse/ClickHouse/pull/78590) ([Raúl Marín](https://github.com/Algunenano)).
* `minizip-ng` を `4.0.9` に更新。 [#78917](https://github.com/ClickHouse/ClickHouse/pull/78917) ([Konstantin Bogdanov](https://github.com/thevar1able)).
