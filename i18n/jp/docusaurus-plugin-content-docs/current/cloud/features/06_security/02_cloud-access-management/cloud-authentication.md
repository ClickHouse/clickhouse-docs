---
'sidebar_label': 'クラウド認証'
'slug': '/cloud/security/cloud-authentication'
'title': 'クラウド認証'
'description': 'このガイドでは、認証の設定に関する良いプラクティスを説明します。'
'doc_type': 'guide'
---

import ScalePlanFeatureBadge from '@theme/badges/ScalePlanFeatureBadge'
import EnterprisePlanFeatureBadge from '@theme/badges/EnterprisePlanFeatureBadge'


# クラウド認証

ClickHouse Cloud は、認証のためのいくつかの方法を提供します。このガイドでは、認証の構成に関する良いプラクティスを説明します。認証方法を選択する際は、常にセキュリティチームに確認してください。

## パスワード設定 {#password-settings}

現在、私たちのコンソールおよびサービス (データベース) の最小パスワード設定は、[NIST 800-63B](https://pages.nist.gov/800-63-3/sp800-63b.html#sec4) 認証者保証レベル 1 に準拠しています：
- 最低12文字
- 次の4つの項目のうち、3つを含む必要があります：
  - 1つの大文字
  - 1つの小文字
  - 1つの数字
  - 1つの特殊文字

## 電子メールとパスワード {#email--password}

ClickHouse Cloud では、電子メールアドレスとパスワードを使用して認証できます。この方法を使用する場合、ClickHouse アカウントを保護する最良の方法は、強力なパスワードを使用することです。覚えやすいパスワードを考案するためのオンラインリソースは多数あります。あるいは、ランダムなパスワードジェネレーターを使用して、パスワードマネージャーにパスワードを保存し、セキュリティを向上させることもできます。

## Google または Microsoft 社のソーシャル認証による SSO {#sso-using-google-or-microsoft-social-authentication}

会社が Google Workspace または Microsoft 365 を使用している場合、ClickHouse Cloud 内で現在のシングルサインオン設定を活用できます。これを行うには、会社のメールアドレスを使用してサインアップし、他のユーザーを会社のメールアドレスで招待します。この結果、ユーザーは ClickHouse Cloud に認証する前に、ID プロバイダーまたは直接 Google または Microsoft 認証を介して、会社のログインフローを使用してログインする必要があります。

## 多要素認証 {#multi-factor-authentication}

電子メール + パスワードまたはソーシャル認証を使用しているユーザーは、多要素認証 (MFA) を使用してアカウントをさらに保護できます。MFA を設定するには：
1. [console.clickhouse.cloud](https://console.clickhouse.cloud/) にログインします
2. 左上の ClickHouse ロゴの隣にあるイニシャルをクリックします
3. プロフィールを選択します
4. 左側のセキュリティを選択します
5. 認証アプリタイルの「セットアップ」をクリックします
6. Authy、1Password、Google Authenticator などの認証アプリを使用してQRコードをスキャンします
7. 確認のためにコードを入力します
8. 次の画面で、リカバリーコードをコピーして安全な場所に保管します
9. `このコードを安全に記録した` の隣のチェックボックスを確認します
10. 続行をクリックします

## アカウント回復 {#account-recovery}

<details> 
   <summary>リカバリーコードを取得</summary>

   以前に MFA に登録していて、リカバリーコードを作成していないか、失くしてしまった場合は、新しいリカバリーコードを取得するために次の手順を実行してください：
   1. https://console.clickhouse.cloud に移動します
   2. 認証情報と MFA でサインインします
   3. 左上のプロフィールに移動します
   4. 左のセキュリティをクリックします
   5. 認証アプリの隣にあるゴミ箱をクリックします
   6. 認証アプリを削除をクリックします
   7. コードを入力し、続行をクリックします
   8. 「認証アプリのセットアップ」をクリックします
   9. QRコードをスキャンし、新しいコードを入力します
   10. リカバリーコードをコピーして安全な場所に保管します
   11. `このコードを安全に記録した` の隣のチェックボックスを確認します
   12. 続行をクリックします
   
</details>
<details>
   <summary>パスワードを忘れた</summary>

   パスワードを忘れた場合、セルフサービスリカバリーのために次の手順を実行してください：
   1. https://console.clickhouse.cloud に移動します
   2. 電子メールアドレスを入力して、続行をクリックします
   3. パスワードを忘れましたか？をクリックします
   4. パスワードリセットリンクを送信をクリックします
   5. メールをチェックし、メールのリセットパスワードをクリックします
   6. 新しいパスワードを入力し、パスワードを確認して更新パスワードをクリックします
   7. サインインに戻るをクリックします
   8. 新しいパスワードで通常通りサインインします
            
</details>
<details>
   <summary>MFA デバイスまたはトークンを紛失した</summary>

   MFA デバイスを失くしたり、トークンを削除した場合は、次の手順を実行して復元し、新しいトークンを作成します：
   1. https://console.clickhouse.cloud に移動します
   2. 認証情報を入力し、続行をクリックします
   3. 多要素認証画面でキャンセルをクリックします
   4. リカバリーコードをクリックします
   5. コードを入力し、続行を押します
   6. 新しいリカバリーコードをコピーして、安全な場所に保管します
   7. `このコードを安全に記録した` の隣のチェックボックスをクリックし、続行をクリックします
   8. サインイン後、左上のプロフィールに移動します
   9. 左上のセキュリティをクリックします
   10. 認証アプリの隣のゴミ箱アイコンをクリックして古い認証を削除します
   11. 認証アプリを削除をクリックします
   12. 多要素認証のプロンプトが表示されたら、キャンセルをクリックします
   13. リカバリーコードをクリックします
   14. リカバリーコードを入力し (これはステップ7で生成された新しいコードです) 続行をクリックします
   15. 新しいリカバリーコードをコピーして、安全な場所に保管します - これは削除プロセス中に画面を離れた場合のフェイルセーフです
   16. `このコードを安全に記録した` の隣のチェックボックスをクリックし、続行をクリックします
   17. 上記のプロセスに従って新しい MFA 要素を設定します
       
</details>
<details>
   <summary>MFA とリカバリーコードを紛失した</summary>

   MFA デバイスとリカバリーコードの両方を失った、または MFA デバイスを失くしてリカバリーコードを取得していない場合は、リセットをリクエストするために次の手順を実行してください：

   **チケットを提出する**: 他の管理ユーザーがいる組織に所属している場合、たとえ単一ユーザー組織にアクセスしようとしている場合でも、Admin ロールに割り当てられた組織のメンバーにお願いして、組織にサインインし、サポートチケットを提出してもらってください。リクエストが認証されたことを確認したら、MFA をリセットし、管理者に通知します。MFA なしで通常通りサインインし、必要に応じてプロフィール設定に移動して新しい要素を登録します。

   **メールを介してリセット**: 組織に唯一のユーザーである場合、アカウントに関連付けられた電子メールアドレスを使用して、電子メール (support@clickhouse.com) でサポートケースを提出してください。正しいメールからのリクエストであることを確認したら、MFA とパスワードをリセットします。パスワードリセットリンクにアクセスするためにメールを確認してください。新しいパスワードを設定し、その後プロフィール設定に移動して新しい要素を登録します。
   
</details>

## SAML SSO {#saml-sso}

<EnterprisePlanFeatureBadge feature="SAML SSO"/>

ClickHouse Cloud は、セキュリティアサーションマークアップ言語 (SAML) によるシングルサインオン (SSO) もサポートしています。詳細については、[SAML SSO 設定](/cloud/security/saml-setup) を参照してください。

## データベースユーザー ID とパスワード {#database-user-id--password}

パスワードを保護するために、[ユーザーアカウントを作成](/sql-reference/statements/create/user.md) の際には SHA256_hash メソッドを使用してください。

**ヒント:** 管理者権限のないユーザーは自分のパスワードを設定できないため、ユーザーに生成器を使用して自分のパスワードをハッシュ化するよう依頼してから、管理者にアカウント設定のために提供してください。パスワードは、上記の[要件](#password-settings) に従う必要があります。

```sql
CREATE USER userName IDENTIFIED WITH sha256_hash BY 'hash';
```
