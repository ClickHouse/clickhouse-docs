---
sidebar_label: クラウド認証
slug: /cloud/security/cloud-authentication
title: クラウド認証
---

import ScalePlanFeatureBadge from '@theme/badges/ScalePlanFeatureBadge'
import EnterprisePlanFeatureBadge from '@theme/badges/EnterprisePlanFeatureBadge'


# クラウド認証

ClickHouse Cloudは、認証方法を複数提供しています。このガイドでは、認証を設定するための良いプラクティスを説明します。認証方法を選択する際は、必ずセキュリティチームに確認してください。

## パスワード設定 {#password-settings}

現在、コンソールとサービス（データベース）の最小パスワード設定は、[NIST 800-63B](https://pages.nist.gov/800-63-3/sp800-63b.html#sec4) 認証者保証レベル1に準拠しています：
- 最小12文字
- 次の4項目のうち3つを含むこと：
   - 1つの大文字
   - 1つの小文字
   - 1つの数字
   - 1つの特殊文字

## メール + パスワード {#email--password}

ClickHouse Cloudでは、メールアドレスとパスワードで認証することができます。この方法を使用する場合、ClickHouseアカウントを保護する最善の方法は強力なパスワードを使用することです。覚えやすいパスワードを考案するためのオンラインリソースが多数あります。代わりに、ランダムパスワードジェネレーターを使用し、パスワードマネージャーに保存してセキュリティを高めることができます。

## GoogleまたはMicrosoftのソーシャル認証を使用したSSO {#sso-using-google-or-microsoft-social-authentication}

会社でGoogle WorkspaceまたはMicrosoft 365を使用している場合、ClickHouse Cloudの現在のシングルサインオン設定を活用できます。これを行うには、会社のメールアドレスを使用してサインアップし、他のユーザーを会社のメールで招待してください。その結果、ユーザーはClickHouse Cloudに認証する前に、アイデンティティプロバイダーまたはGoogleまたはMicrosoft認証を通じて、会社のログインフローを使用してログインする必要があります。

## 多要素認証 {#multi-factor-authentication}

メール + パスワードまたはソーシャル認証のユーザーは、多要素認証（MFA）を使用してさらにアカウントを保護できます。MFAを設定するには：
1. console.clickhouse.cloudにログインする
2. ClickHouseロゴの横にある左上のイニシャルをクリックする
3. プロファイルを選択する
4. 左のセキュリティを選択する
5. 認証アプリタイルの「セットアップ」をクリックする
6. Authy、1Password、またはGoogle Authenticatorなどの認証アプリを使用してQRコードをスキャンする
7. コードを入力して確認する
8. 次の画面で、復旧コードをコピーし、安全な場所に保存する
9. `I have safely recorded this code` の横のボックスにチェックを入れる
10. 続行をクリックする

## アカウント回復 {#account-recovery}

<details> 
   <summary>復旧コードを取得</summary>

   以前にMFAに登録していたが、復旧コードを作成しなかった場合、または復旧コードを紛失した場合は、以下の手順に従って新しい復旧コードを取得してください：
   1. https://console.clickhouse.cloudに移動
   2. 認証情報とMFAでサインインする
   3. 左上のプロファイルに移動
   4. 左のセキュリティをクリック
   5. 認証アプリの横にあるゴミ箱をクリック
   6. 認証アプリを削除をクリック
   7. コードを入力して続行をクリック
   8. 認証アプリセクションでセットアップをクリック
   9. QRコードをスキャンし、新しいコードを入力
   10. 復旧コードをコピーし、安全な場所に保存
   11. `I have safely recorded this code` の横のボックスにチェックを入れる
   12. 続行をクリック

</details>
<details>
   <summary>パスワードを忘れた</summary>

   パスワードを忘れた場合、セルフサービスの回復手順は以下の通りです：
   1. https://console.clickhouse.cloudに移動
   2. メールアドレスを入力し、続行をクリック
   3. パスワードをお忘れですか？をクリック
   4. パスワードリセットリンクを送信をクリック
   5. メールを確認し、メールのパスワードをリセットをクリック
   6. 新しいパスワードを入力し、確認してパスワードを更新をクリック
   7. サインイン画面に戻るをクリック
   8. 新しいパスワードで通常通りサインインする
            
</details>
<details>
   <summary>MFAデバイスまたはトークンを紛失した</summary>

   MFAデバイスを紛失したりトークンを削除したりした場合、新しいトークンを回復して作成する手順は以下の通りです：
   1. https://console.clickhouse.cloudに移動
   2. 認証情報を入力し、続行をクリック
   3. 多要素認証画面でキャンセルをクリック
   4. 復旧コードをクリック
   5. コードを入力して続行を押す
   6. 新しい復旧コードをコピーし、安全な場所に保存
   7. `I have safely recorded this code` の横のボックスにチェックを入れ、続行をクリック
   8. サインイン後、左上のプロファイルに移動
   9. 左上のセキュリティをクリック
   10. 認証アプリの横にあるゴミ箱アイコンをクリックして古い認証を削除
   11. 認証アプリを削除をクリック
   12. 多要素認証のプロンプトが表示されたら、キャンセルをクリック
   13. 復旧コードをクリック
   14. 復旧コードを入力（これはステップ7で生成された新しいコードです）し、続行をクリック
   15. 新しい復旧コードをコピーし、安全な場所に保存 - これは削除プロセス中に画面を離れた場合のフェイルセーフです
   16. `I have safely recorded this code` の横のボックスにチェックを入れ、続行をクリック
   17. 上記のプロセスに従って新しいMFA要素を設定します
       
</details>
<details>
   <summary>MFAおよび復旧コードを紛失した</summary>

   MFAデバイスと復旧コードの両方を紛失した場合、またはMFAデバイスを紛失し復旧コードを取得していない場合は、リセットをリクエストする手順は以下の通りです：

   **チケットを提出**: 他の管理ユーザーがいる組織に所属している場合、たとえ単一ユーザーの組織にアクセスしようとしていても、Admin役割が割り当てられている組織のメンバーにログインし、MFAをリセットするためのサポートチケットを提出してもらってください。リクエストが認証されると確認でき次第、MFAをリセットし、Adminに通知します。通常通りサインインし、希望すれば新しい要素を登録するためにプロファイル設定に移動してください。

   **メールによるリセット**: あなたが組織内の唯一のユーザーの場合、あなたのアカウントに関連付けられたメールアドレスを使用してメール（support@clickhouse.com）経由でサポートケースを提出してください。リクエストが正しいメールからのものであることを確認でき次第、MFAとパスワードの両方をリセットします。メールにアクセスしてパスワードリセットリンクを取得し、新しいパスワードを設定してください。その後、希望すれば新しい要素を登録するためにプロファイル設定に移動してください。

</details>

## SAML SSO {#saml-sso}

<EnterprisePlanFeatureBadge feature="SAML SSO"/>

ClickHouse Cloudは、セキュリティアサーションマークアップ言語（SAML）シングルサインオン（SSO）もサポートしています。詳細については、[SAML SSOの設定](/cloud/security/saml-setup)を参照してください。

## データベースユーザーID + パスワード {#database-user-id--password}

パスワードを保護するために、[ユーザーアカウントを作成する際](/sql-reference/statements/create/user.md)にSHA256_hashメソッドを使用してください。

**ヒント:** 管理者権限を持たないユーザーは自分のパスワードを設定できないため、ユーザーにハッシュジェネレーターを使用してパスワードをハッシュするよう依頼してください。
その後、管理者がアカウントを設定するためにそのハッシュを提供します。パスワードは上記の[要件](#password-settings)に従う必要があります。

```sql
CREATE USER userName IDENTIFIED WITH sha256_hash BY 'hash';
```
